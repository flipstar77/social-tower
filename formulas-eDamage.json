{
  "formulas": {
    "C2": "IF(AG3=\"Farming\",\"'Master Sheet'\", \"'MS Tourney'\")",
    "L3": "\" ↓ Damage UW PATH  ↓\"",
    "M3": "'eDamage UW'!D39:I150",
    "S3": "\" ↓ Damage Coin PATH  ↓\"",
    "T3": "IF( ISBLANK('eDamage Coins'!D42), \"Put a 1 on Workshop Enhancements Lab to enable WS+\", 'eDamage Coins'!D39:I150)",
    "AA4": "FORMAT_TIME_YEAR(SUM(D2:D150))&IF(J150=\"\",\"\",\"+\")",
    "AE4": "IFERROR(INDIRECT($C$2 & \"!$AQ$7\"), 1)",
    "D5": "RIGHT($K$5,LEN($K$5)-1)",
    "AI5": "'Master Sheet'!C16",
    "AJ5": "'Master Sheet'!E16",
    "AK5": "1+(2%*AI5)",
    "AL5": "MAX('Master Sheet'!I2:J2)",
    "AN5": "FORMAT_NUMBER(VLOOKUP(AL5, WSValues!A:B, 2, FALSE))",
    "AO5": "'Master Sheet'!O2",
    "AQ5": "1+(AO5*0.01)",
    "AR5": "'Master Sheet'!AM4",
    "AS5": "'Master Sheet'!AX2",
    "AT5": "FORMAT_NUMBER(AU5)",
    "AU5": "LET(\n  WSDamage, VLOOKUP($AL$5, WSValues!$A:$B, 2, FALSE),\n  LabDamage, $AK$5,\n  WSPlus, $AQ$5,\n  CardDamage, IF(AND($BA$5,$BA$3),$AZ$5,1),\n  CardDamageMastery, IF(AND($BA$5,$BA$3, $BA$17),1+CI5*0.4,1),\n  CardBerserk, IF(AND($BA$7,$BA$3),$AZ$7,1),\n  RelicDamage, (1+$AR$5),\n  VaultDamage, (1+$AS$5),\n  Cannon, $AE$4,\n  Perk5050, IF(AND($BA$26,$BA$31),0.5,1), \n\nWSDamage * LabDamage * CardDamage * CardDamageMastery * CardBerserk * RelicDamage * VaultDamage * WSPlus * IF(AND(BA26,BA28),(1+0.15*AY28)*(1+(AI24/100)),1) * IF(AND(BA26,BA30),1.5*(1+AK25),1) * Perk5050 * Cannon)",
    "AY5": "'Master Sheet'!AB2",
    "AZ5": "SWITCH(AY5,\n  1, 1.5,\n  2, 2,\n  3, 2.4,\n  4, 2.8,\n  5, 3.2,\n  6, 3.6,\n  7, 4,\n\"-\")",
    "BT5": "AI5+1",
    "BU5": "AI6+1",
    "BV5": "AI7+1",
    "BW5": "AI9+1",
    "BX5": "AI10+1",
    "BY5": "AI17+1",
    "BZ5": "AI18+1",
    "CA5": "AI23+1",
    "CB5": "AI19+1",
    "CC5": "IF(AK36 = 20, 1, INDEX($BM$5:$BM150,AK36, 1))",
    "CD5": "AI24+1",
    "CE5": "AI25+1",
    "CF5": "AI26+1",
    "CG5": "AI27+1",
    "CH5": "AI29+1",
    "CI5": "IF(BA17, 'Master Sheet'!C143+1, 0)",
    "CJ5": "IF(BA18, 'Master Sheet'!C144+1, 0)",
    "CK5": "IF(BA19, 'Master Sheet'!C151+1, 0)",
    "CL5": "IF(BA20, 'Master Sheet'!C147+1, 0)",
    "CM5": "IF(BA21, 'Master Sheet'!C165+1, 0)",
    "CN5": "IF(BA22, 'Master Sheet'!C171+1, 0)",
    "CO5": "IF(BA23, 'Master Sheet'!C167+1, 0)",
    "CS5": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI5,1)",
    "CT5": "INDEX($BD$5:$BD150,BT5)",
    "CU5": "INDEX($BN$5:$BN150,CD5)",
    "CV5": "INDEX($BO$5:$BO150,CE5)",
    "CW5": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG5)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX5": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO5, 1)",
    "CY5": "LET(\n  Base, $CR$6,\n  Damage, $CT5,\n  DamageMastery, $CS5,\n  DemonMastery, $CX5,\n  SPB, $CU5,\n  ITO, $CV5,\n  Shock, $CW5,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ5": "MIN(100%, DA5)",
    "DA5": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK5*1%, 0)",
    "DB5": "LET(\n  Lab, 1+INDEX($BF$5:$BF150,BV5),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC5": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK5*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI150,BY5) + CardCritMastery)",
    "DD5": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK5*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ150,BZ5) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE5": "LET(\n  CF, $DB5,\n  CC, $CZ5,\n  SCM, $DD5,\n  SCC, $DC5,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF5": "LET(\n  CF, $DB5,\n  CC, $DA5,\n  SCM, $DD5,\n  SCC, $DC5,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG5": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH5)), 0)",
    "DH5": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ5*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE150,BU5),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI5": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG150, BW5), 1) + $AE$9)",
    "DJ5": "LET(\n  DpmLab, INDEX($BH$5:$BH150,BX5),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL5, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK5": "(1+$DI5*$DJ5*$AQ$9)",
    "DL5": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK150,CA5),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM5*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM5": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK150,CA5),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM5*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN5": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL150,CB5)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO5": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH5,\n  Rapid, DG5,\n  RDPM, DK5,\n  SuperTower, $DL5,\n  Rend, $DN5,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP5": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ5": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK5),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR5": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP5),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF5-1))",
    "DS5": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG5, DH5),0))",
    "DT5": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP5),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV5, $AR$29), 0))",
    "DU5": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK5),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM150,CC5), $DV5, $AR$29), 0))",
    "DV5": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH5), $AO$29)",
    "DW5": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM5,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, $DQ5,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX5": "CY5*(DE5*DO5*DQ5+DW5*DF5)",
    "DZ5": "IF(INDEX($BD$6:$BD150,BT5)=\"\", \"\", INDEX($BD$5:$BD150,BT5+1))",
    "EA5": "IF(OR($AO$25, INDEX($BE$6:$BE150,BU5)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ5)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE150,BU5+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI5*$DJ5*$AQ$9),\n  SuperTower, $DL5,\n  Rend, $DN5,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, $DQ5,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\nCY5*(DE5*OtherDamage*SL+UwDamage*DF5)))",
    "EB5": "IF(INDEX($BF$6:$BF150,BV5)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF150,BV5+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ5,\n  CCUW, $DA5,\n  SCM, $DD5,\n  SCC, $DC5,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, CF), 1),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, $DQ5,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\nCY5 * (Critical * DO5 * SL + UwDamage * UWCritical)))",
    "EC5": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG150,BW5)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH5,\n  Rapid, DG5,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG150, BW5+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ5*$AQ$9),\n  SuperTower, $DL5,\n  Rend, $DN5,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM150,CC5), $DV5, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM5,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY5*(DE5*OtherDamage*SL+UWDamage*DF5)))",
    "ED5": "IF(OR($AO$25, INDEX($BH$6:$BH150,BX5)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH150,BX5+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL5, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI5*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM150,CC5), $DV5, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH5,\n  Rapid, DG5,\n  SuperTower, $DL5,\n  Rend, $DN5,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM5,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY5*(DE5*OtherDamage*SL+UWDamage*DF5)))",
    "EE5": "IF(INDEX($BI$6:$BI150,BY5)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK5, 0),\n  CF, $DB5,\n  CC, $CZ5,\n  CCUW, $DA5,\n  SCM, $DD5,\n  SCC, $AV$17+INDEX($BI$5:$BI150,BY5+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY5 * (Critical*DO5*$DQ5+DW5*UWCritical)))",
    "EF5": "IF(INDEX($BJ$6:$BJ150,BZ5)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK5*1%, 1),\n  CF, $DB5,\n  CC, $CZ5,\n  CCUW, $DA5,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ150,BZ5+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC5,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY5*(Critical*DO5*$DQ5+DW5*UWCritical)))",
    "EG5": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK150,CA5)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH5,\n  Rapid, DG5,\n  DPM, (1+$DI5*$DJ5*$AQ$9),\n  Rend, $DN5,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK150,CA5+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM5*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK150,CA5+1)-1))/(45-CM5*3),1),\n\n  SL, $DQ5,\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY5*(DE5*OtherDamage*SL+UwDamage*DF5)))",
    "EH5": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL150,CB5+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL150,CB5)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH5,\n  Rapid, DG5,\n  DPM, (1+$DI5*$DJ5*$AQ$9),\n  SuperTower, $DL5,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL150,CB5+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY5*(DE5*OtherDamage*$DQ5+DW5*DF5)))",
    "EI5": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM150,CC5)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK5),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV5, $AR$29), 0),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n  SL, $DQ5,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\nCY5*(DE5*DO5*SL+UwDamage*DF5)))",
    "EJ5": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN150,CD5)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT5,\n  DamageMastery, $CS5,\n  DemonMastery, $CX5,\n  SPB, INDEX($BN$5:$BN150,CD5+1),\n  ITO, $CV5,\n  Shock, $CW5,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE5*DO5*$DQ5+DW5*DF5)))",
    "EK5": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO150,CE5)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT5,\n  DamageMastery, $CS5,\n  DemonMastery, $CX5,\n  SPB, $CU5,\n  ITO, INDEX($BO$5:$BO150,CE5+1),\n  Shock, $CW5,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE5*DO5*$DQ5+DW5*DF5)))",
    "EL5": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP150,CF5)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP5),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF5),\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, $DQ5,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\nCY5*(DE5*DO5*SL+UwDamage*DF5)))",
    "EM5": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ150,CG5)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG5+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN5": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR150,CH5)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH5+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP5),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK5),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM150,CC5), SMHeat, $AR$29), 0),\n\n  DW, $DR5,\n  CL, $DS5,\n  SL, $DQ5,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\nCY5*(DE5*DO5*SL+UwDamage*DF5)))",
    "EO5": "IF(OR(CI5 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI5+1))",
    "EP5": "IF(OR($AO$25, CJ5 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ5+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE150,BU5),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI5*$DJ5*$AQ$9),\n  SuperTower, $DL5,\n  Rend, $DN5,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, $DQ5,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\nCY5*(DE5*OtherDamage*SL+UwDamage*DF5)))",
    "EQ5": "IF(OR(CK5 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK5+1)*1%, 1),\n  CF, $DB5,\n  CC, MIN(100%, $CZ5 + 1%),\n  CCUW, DA5 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ150,BZ5) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC5 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, $DQ5,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\nCY5 * (Critical*DO5*SL+UwDamage*UWCritical)))",
    "ER5": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL5 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH150,BX5),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL5+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI5*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM150,CC5), $DV5, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH5,\n  Rapid, DG5,\n  SuperTower, $DL5,\n  Rend, $DN5,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM5,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY5*(DE5*OtherDamage*SL+UWDamage*DF5)))",
    "ES5": "IF(OR(CM5 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH5,\n  Rapid, DG5,\n  RDPM, (1+$DI5*$DJ5*$AQ$9),\n  Rend, $DN5,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK150,CA5),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM5+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY5*(DE5*OtherDamage*SL+UwDamage*DF5)))",
    "ET5": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN5 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM5,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5+1, $DB5), 1),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, $DQ5,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY5*(DE5*DO5*SL+UWDamage*DF5)))",
    "EU5": "IF(OR(NOT($BA$3), NOT($BA$23), $CO5 > $BA$15), \"\", 1 + 0.5*(CO5+1))",
    "EW5": "IF(DZ5=\"\", \"\", LET(\n  Now, CT5,\n  Next, DZ5,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT5),\nFactor/Cost))",
    "EX5": "IF(EA5=\"\",\"\",(EA5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU5))",
    "EY5": "IF(EB5=\"\",\"\",(EB5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV5))",
    "EZ5": "IF(EC5=\"\",\"\",(EC5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW5))",
    "FA5": "IF(ED5=\"\",\"\",(ED5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX5))",
    "FB5": "IF(EE5=\"\",\"\",(EE5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY5))",
    "FC5": "IF(EF5=\"\",\"\",(EF5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ5))",
    "FD5": "IF(EG5=\"\",\"\",(EG5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA5))",
    "FE5": "IF(EH5=\"\",\"\",(EH5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB5))",
    "FF5": "IF(EI5=\"\",\"\",(EI5/$DX5-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC5+1, 1, CC5))))",
    "FG5": "IF(EJ5=\"\",\"\",(EJ5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD5))",
    "FH5": "IF(EK5=\"\",\"\",(EK5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE5))",
    "FI5": "IF(EL5=\"\",\"\",(EL5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF5))",
    "FJ5": "IF(EM5=\"\", \"\", LET(\n  Now, CW5,\n  Next, EM5,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG5),\nFactor/Cost))",
    "FK5": "IF(EN5=\"\",\"\",(EN5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH5))",
    "FL5": "IF(EO5=\"\", \"\", LET(\n  Now, CS5,\n  Next, EO5,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI5),\nFactor/Cost))",
    "FM5": "IF(EP5=\"\",\"\",(EP5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ5))",
    "FN5": "IF(EQ5=\"\",\"\",(EQ5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK5))",
    "FO5": "IF(ER5=\"\",\"\",(ER5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL5))",
    "FP5": "IF(ES5=\"\",\"\",(ES5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM5))",
    "FQ5": "IF(ET5=\"\",\"\",(ET5/$DX5-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN5))",
    "FR5": "IF(EU5=\"\", \"\", LET(\n  Now, CX5,\n  Next, EU5,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO5),\nFactor/Cost))",
    "FT5": "IF(COLUMN(EW5:FR5) = MIN(IF(EW5:FR5=MAX(EW5:FR5), COLUMN(EW5:FR5))), 1, \"\")",
    "D6": "IF(SUM(FT5:GP5),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F6)),\"Card Mastery\",F6),G6)/$D$5,\"\")",
    "F6": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT5:GP5),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT5:GP5=1)),)\"),\"Critical Factor\")",
    "G6": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT5:GP5),ARRAYFORMULA(FILTER(BT5:CP5 , FT5:GP5=1)),\"\"\"\")\"),1.0)",
    "H6": "FORMAT_TIME(D6:D150)",
    "I6": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT5:GP5),ARRAYFORMULA(FILTER(EW5:FS5 , FT5:GP5=1))*D$5,\"\"\"\")\"),183.81769705548373)",
    "J6": "IF(ISBLANK(F6:F150), \"\", FORMAT_NUMBER(DX6:DX150))",
    "K6": "IF(H6<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D6)),)",
    "AA6": "FORMAT_NUMBER(DX5)",
    "AD6": "IF(EQ(AE6, 5), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE6=0, 0.3, AE6=0.3, 0.5, AE6=0.5, 0.7, AE6=0.7, 1, AE6=1, 3, AE6=3, 5), Common, 0.3, Rare, 0.5, Epic, 0.7, Legendary, 1, Mythic, 3, Ancestral, 5), 0),\n\n  BaseDMG, CY5,\n\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ5*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE150,BU5),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n\n  BaseOther, $CR$9,\n  Bounce, $CR10,\n  Rapid, $DG$5,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+Planner)*WsPlusAspd*RelicAspd),\n  RDPM, DK5,\n  SuperTower, $DL5,\n  Rend, $DN5,\n  OtherDMG, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, BaseDMG*(DE5*OtherDMG*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE6": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC6,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AI6": "'Master Sheet'!C1750",
    "AJ6": "'Master Sheet'!E17",
    "AK6": "1+(2%*AI6)",
    "AL6": "MAX('Master Sheet'!I3:J3)",
    "AN6": "1+0.05*AL6",
    "AO6": "'Master Sheet'!O7",
    "AQ6": "1+(AO6*0.01)",
    "AR6": "'Master Sheet'!AM6",
    "AT6": "AU6",
    "AU6": "LET(\n  WsAspd, AN6,\n  LabAspd, AK6,\n  CardAspd, IF(AND(BA3,BA6),AZ6,1),\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+0.03*CJ5,1),\n  SubstatAspd, AE6,\n  WsPlusAspd, AQ6,\n  RelicAspd, 1+AR6,\n(WsAspd * LabAspd * CardAspd * CardAspdMastery + SubstatAspd) * WsPlusAspd * RelicAspd\n)",
    "AV6": "AN6*IF(AND(BA3,BA6),AZ6,1)",
    "AY6": "'Master Sheet'!AB3",
    "AZ6": "1.1 + RIGHT(AY6,1) * 0.15",
    "BC6": "BC5+1",
    "BD6": "BD5+BD$3",
    "BE6": "BE5+BE$3",
    "BF6": "BF5+BF$3",
    "BG6": "BG5+BG$3",
    "BH6": "BH5+BH$3",
    "BI6": "BI5+BI$3",
    "BJ6": "BJ5+BJ$3",
    "BK6": "BK5+BK$3",
    "BL6": "BL5+BL$3",
    "BM6": "BM5+BM$3",
    "BN6": "BN5+BN$3",
    "BO6": "BO5+BO$3",
    "BP6": "BP5+BP$3",
    "BQ6": "BQ5+BQ$3",
    "BR6": "BR5+BR$3",
    "BT6": "BT5+FT5",
    "BU6": "BU5+FU5",
    "BV6": "BV5+FV5",
    "BW6": "BW5+FW5",
    "BX6": "BX5+FX5",
    "BY6": "BY5+FY5",
    "BZ6": "BZ5+FZ5",
    "CA6": "CA5+GA5",
    "CB6": "CB5+GB5",
    "CC6": "CC5+GC5",
    "CD6": "CD5+GD5",
    "CE6": "CE5+GE5",
    "CF6": "CF5+GF5",
    "CG6": "CG5+GG5",
    "CH6": "CH5+GH5",
    "CI6": "CI5+GI5",
    "CJ6": "CJ5+GJ5",
    "CK6": "CK5+GK5",
    "CL6": "CL5+GL5",
    "CM6": "CM5+GM5",
    "CN6": "CN5+GN5",
    "CO6": "CO5+GO5",
    "CR6": "LET(\n  WSDamage, VLOOKUP($AL$5, WSValues!$A:$B, 2, FALSE),\n  WSPlus, $AQ$5,\n  CardDamage, IF(AND($BA$5,$BA$3),$AZ$5,1),\n  CardBerserk, IF(AND($BA$7,$BA$3),$AZ$7,1),\n  RelicDamage, (1+$AR$5),\n  VaultDamage, (1+$AS$5),\n  Cannon, $AE$4,\n  Perk5050, IF(AND($BA$26,$BA$31),0.5,1), \nWSDamage*CardDamage*CardBerserk*RelicDamage*VaultDamage*WSPlus*Cannon*Perk5050)",
    "CS6": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI6,1)",
    "CT6": "INDEX($BD$5:$BD151,BT6)",
    "CU6": "INDEX($BN$5:$BN151,CD6)",
    "CV6": "INDEX($BO$5:$BO151,CE6)",
    "CW6": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG6)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX6": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO6, 1)",
    "CY6": "LET(\n  Base, $CR$6,\n  Damage, $CT6,\n  DamageMastery, $CS6,\n  DemonMastery, $CX6,\n  SPB, $CU6,\n  ITO, $CV6,\n  Shock, $CW6,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ6": "MIN(100%, DA6)",
    "DA6": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK6*1%, 0)",
    "DB6": "LET(\n  Lab, 1+INDEX($BF$5:$BF151,BV6),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC6": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK6*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI151,BY6) + CardCritMastery)",
    "DD6": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK6*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ151,BZ6) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE6": "LET(\n  CF, $DB6,\n  CC, $CZ6,\n  SCM, $DD6,\n  SCC, $DC6,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF6": "LET(\n  CF, $DB6,\n  CC, $DA6,\n  SCM, $DD6,\n  SCC, $DC6,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG6": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH6)), 0)",
    "DH6": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ6*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE151,BU6),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI6": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG151, BW6), 1) + $AE$9)",
    "DJ6": "LET(\n  DpmLab, INDEX($BH$5:$BH151,BX6),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL6, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK6": "(1+$DI6*$DJ6*$AQ$9)",
    "DL6": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK151,CA6),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM6*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM6": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK151,CA6),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM6*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN6": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL151,CB6)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO6": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH6,\n  Rapid, DG6,\n  RDPM, DK6,\n  SuperTower, $DL6,\n  Rend, $DN6,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP6": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ6": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK6),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR6": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP6),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF6-1))",
    "DS6": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG6, DH6),0))",
    "DT6": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP6),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV6, $AR$29), 0))",
    "DU6": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK6),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM151,CC6), $DV6, $AR$29), 0))",
    "DV6": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH6), $AO$29)",
    "DW6": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM6,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6, $DB6), 1),\n\n  DW, $DR6,\n  CL, $DS6,\n  SM, $DT6,\n  SLM, $DU6,\n  SL, $DQ6,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX6": "CY6*(DE6*DO6*DQ6+DW6*DF6)",
    "DZ6": "IF(INDEX($BD$6:$BD151,BT6)=\"\", \"\", INDEX($BD$5:$BD151,BT6+1))",
    "EA6": "IF(OR($AO$25, INDEX($BE$6:$BE151,BU6)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ6)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE151,BU6+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI6*$DJ6*$AQ$9),\n  SuperTower, $DL6,\n  Rend, $DN6,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6, $DB6), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR6,\n  SM, $DT6,\n  SLM, $DU6,\n  SL, $DQ6,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM6, UltCritCard),\n\nCY6*(DE6*OtherDamage*SL+UwDamage*DF6)))",
    "EB6": "IF(INDEX($BF$6:$BF151,BV6)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF151,BV6+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ6,\n  CCUW, $DA6,\n  SCM, $DD6,\n  SCC, $DC6,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6, CF), 1),\n\n  DW, $DR6,\n  CL, $DS6,\n  SM, $DT6,\n  SLM, $DU6,\n  SL, $DQ6,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM6, UltCritCard),\n\nCY6 * (Critical * DO6 * SL + UwDamage * UWCritical)))",
    "EC6": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG151,BW6)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH6,\n  Rapid, DG6,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG151, BW6+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ6*$AQ$9),\n  SuperTower, $DL6,\n  Rend, $DN6,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM151,CC6), $DV6, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM6,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6, $DB6), 1),\n\n  DW, $DR6,\n  CL, $DS6,\n  SM, $DT6,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY6*(DE6*OtherDamage*SL+UWDamage*DF6)))",
    "ED6": "IF(OR($AO$25, INDEX($BH$6:$BH151,BX6)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH151,BX6+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL6, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI6*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM151,CC6), $DV6, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH6,\n  Rapid, DG6,\n  SuperTower, $DL6,\n  Rend, $DN6,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM6,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6, $DB6), 1),\n\n  DW, $DR6,\n  CL, $DS6,\n  SM, $DT6,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY6*(DE6*OtherDamage*SL+UWDamage*DF6)))",
    "EE6": "IF(INDEX($BI$6:$BI151,BY6)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK6, 0),\n  CF, $DB6,\n  CC, $CZ6,\n  CCUW, $DA6,\n  SCM, $DD6,\n  SCC, $AV$17+INDEX($BI$5:$BI151,BY6+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY6 * (Critical*DO6*$DQ6+DW6*UWCritical)))",
    "EF6": "IF(INDEX($BJ$6:$BJ151,BZ6)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK6*1%, 1),\n  CF, $DB6,\n  CC, $CZ6,\n  CCUW, $DA6,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ151,BZ6+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC6,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY6*(Critical*DO6*$DQ6+DW6*UWCritical)))",
    "EG6": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK151,CA6)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH6,\n  Rapid, DG6,\n  DPM, (1+$DI6*$DJ6*$AQ$9),\n  Rend, $DN6,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK151,CA6+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM6*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6, $DB6), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK151,CA6+1)-1))/(45-CM6*3),1),\n\n  SL, $DQ6,\n  DW, $DR6,\n  CL, $DS6,\n  SM, $DT6,\n  SLM, $DU6,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY6*(DE6*OtherDamage*SL+UwDamage*DF6)))",
    "EH6": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL151,CB6+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL151,CB6)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH6,\n  Rapid, DG6,\n  DPM, (1+$DI6*$DJ6*$AQ$9),\n  SuperTower, $DL6,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL151,CB6+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY6*(DE6*OtherDamage*$DQ6+DW6*DF6)))",
    "EI6": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM151,CC6)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6, $DB6), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK6),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV6, $AR$29), 0),\n\n  DW, $DR6,\n  CL, $DS6,\n  SM, $DT6,\n  SL, $DQ6,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM6, UltCritCard),\nCY6*(DE6*DO6*SL+UwDamage*DF6)))",
    "EJ6": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN151,CD6)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT6,\n  DamageMastery, $CS6,\n  DemonMastery, $CX6,\n  SPB, INDEX($BN$5:$BN151,CD6+1),\n  ITO, $CV6,\n  Shock, $CW6,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE6*DO6*$DQ6+DW6*DF6)))",
    "EK6": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO151,CE6)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT6,\n  DamageMastery, $CS6,\n  DemonMastery, $CX6,\n  SPB, $CU6,\n  ITO, INDEX($BO$5:$BO151,CE6+1),\n  Shock, $CW6,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE6*DO6*$DQ6+DW6*DF6)))",
    "EL6": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP151,CF6)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6, $DB6), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP6),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF6),\n  CL, $DS6,\n  SM, $DT6,\n  SLM, $DU6,\n  SL, $DQ6,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM6, UltCritCard),\nCY6*(DE6*DO6*SL+UwDamage*DF6)))",
    "EM6": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ151,CG6)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG6+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN6": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR151,CH6)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6, $DB6), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH6+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP6),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK6),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM151,CC6), SMHeat, $AR$29), 0),\n\n  DW, $DR6,\n  CL, $DS6,\n  SL, $DQ6,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM6, UltCritCard),\nCY6*(DE6*DO6*SL+UwDamage*DF6)))",
    "EO6": "IF(OR(CI6 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI6+1))",
    "EP6": "IF(OR($AO$25, CJ6 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ6+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE150,BU6),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL6, 1),\n  DPM, (1+$DI6*CardRangeMastery*$DJ6*$AQ$9),\n  SuperTower, $DL6,\n  Rend, $DN6,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6, $DB6), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR6,\n  SM, $DT6,\n  SLM, $DU6,\n  SL, $DQ6,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM6, UltCritCard),\n\nCY6*(DE6*OtherDamage*SL+UwDamage*DF6)))",
    "EQ6": "IF(OR(CK6 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK6+1)*1%, 1),\n  CF, $DB6,\n  CC, MIN(100%, $CZ6 + 1%),\n  CCUW, DA6 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ151,BZ6) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC6 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR6,\n  CL, $DS6,\n  SM, $DT6,\n  SLM, $DU6,\n  SL, $DQ6,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM6, UltCritCard),\n\nCY6 * (Critical*DO6*SL+UwDamage*UWCritical)))",
    "ER6": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL6 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH151,BX6),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL6+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI6*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM151,CC6), $DV6, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH6,\n  Rapid, DG6,\n  SuperTower, $DL6,\n  Rend, $DN6,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM6,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6, $DB6), 1),\n\n  DW, $DR6,\n  CL, $DS6,\n  SM, $DT6,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY6*(DE6*OtherDamage*SL+UWDamage*DF6)))",
    "ES6": "IF(OR(CM6 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH6,\n  Rapid, DG6,\n  RDPM, (1+$DI6*$DJ6*$AQ$9),\n  Rend, $DN6,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK151,CA6),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM6+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6, $DB6), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR6,\n  CL, $DS6,\n  SM, $DT6,\n  SLM, $DU6,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY6*(DE6*OtherDamage*SL+UwDamage*DF6)))",
    "ET6": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN6 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM6,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN6+1, $DB6), 1),\n\n  DW, $DR6,\n  CL, $DS6,\n  SM, $DT6,\n  SLM, $DU6,\n  SL, $DQ6,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY6*(DE6*DO6*SL+UWDamage*DF6)))",
    "EU6": "IF(OR(NOT($BA$3), NOT($BA$23), $CO6 > $BA$15), \"\", 1 + 0.5*(CO6+1))",
    "EW6": "IF(DZ6=\"\", \"\", LET(\n  Now, CT6,\n  Next, DZ6,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT6),\nFactor/Cost))",
    "EX6": "IF(EA6=\"\",\"\",(EA6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU6))",
    "EY6": "IF(EB6=\"\",\"\",(EB6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV6))",
    "EZ6": "IF(EC6=\"\",\"\",(EC6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW6))",
    "FA6": "IF(ED6=\"\",\"\",(ED6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX6))",
    "FB6": "IF(EE6=\"\",\"\",(EE6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY6))",
    "FC6": "IF(EF6=\"\",\"\",(EF6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ6))",
    "FD6": "IF(EG6=\"\",\"\",(EG6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA6))",
    "FE6": "IF(EH6=\"\",\"\",(EH6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB6))",
    "FF6": "IF(EI6=\"\",\"\",(EI6/$DX6-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC6+1, 1, CC6))))",
    "FG6": "IF(EJ6=\"\",\"\",(EJ6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD6))",
    "FH6": "IF(EK6=\"\",\"\",(EK6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE6))",
    "FI6": "IF(EL6=\"\",\"\",(EL6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF6))",
    "FJ6": "IF(EM6=\"\", \"\", LET(\n  Now, CW6,\n  Next, EM6,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG6),\nFactor/Cost))",
    "FK6": "IF(EN6=\"\",\"\",(EN6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH6))",
    "FL6": "IF(EO6=\"\", \"\", LET(\n  Now, CS6,\n  Next, EO6,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI6),\nFactor/Cost))",
    "FM6": "IF(EP6=\"\",\"\",(EP6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ6))",
    "FN6": "IF(EQ6=\"\",\"\",(EQ6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK6))",
    "FO6": "IF(ER6=\"\",\"\",(ER6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL6))",
    "FP6": "IF(ES6=\"\",\"\",(ES6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM6))",
    "FQ6": "IF(ET6=\"\",\"\",(ET6/$DX6-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN6))",
    "FR6": "IF(EU6=\"\", \"\", LET(\n  Now, CX6,\n  Next, EU6,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO6),\nFactor/Cost))",
    "FT6": "IF(COLUMN(EW6:FR6) = MIN(IF(EW6:FR6=MAX(EW6:FR6), COLUMN(EW6:FR6))), 1, \"\")",
    "D7": "IF(SUM(FT6:GP6),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F7)),\"Card Mastery\",F7),G7)/$D$5,\"\")",
    "F7": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT6:GP6),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT6:GP6=1)),)\"),\"Attack Speed\")",
    "G7": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT6:GP6),ARRAYFORMULA(FILTER(BT6:CP6 , FT6:GP6=1)),\"\"\"\")\"),1.0)",
    "I7": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT6:GP6),ARRAYFORMULA(FILTER(EW6:FS6 , FT6:GP6=1))*D$5,\"\"\"\")\"),125.31013387381351)",
    "K7": "IF(H7<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D7)),)",
    "AD7": "IF(EQ(AE7, 10%), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE7=0, 2%, AE7=2%, 3%, AE7=3%, 4%, AE7=4%, 6%, AE7=6%, 8%, AE7=8%, 10%), Common, 2%, Rare, 3%, Epic, 4%, Legendary, 6%, Mythic, 8%, Ancestral, 10%), 0),\n\n  CF, $DB5,\n  CCUW, AN8 + IF(AND(BA8,BA3),AZ8,0) + Planner + AR8 + IF(AND($BA$3,$BA$8,$BA$19), CK5*1%, 0),\n  CC, MIN(100%, CCUW),\n  SCC, $DC5,\n  SCM, $DD5,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  eDMG, CY5 * (Critical*DO5*DQ5+DW5*UWCritical),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE7": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC7,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AI7": "'Master Sheet'!C18",
    "AJ7": "'Master Sheet'!E18",
    "AK7": "1+(3%*AI7)",
    "AL7": "MAX('Master Sheet'!I5:J5)",
    "AN7": " (1.2+(0.1*AL7))",
    "AO7": "'Master Sheet'!O4",
    "AQ7": "1+(AO7*0.01)",
    "AR7": "'Master Sheet'!AM8",
    "AT7": "AU7",
    "AU7": "LET(\n  Lab, AK7,\n  Substat, AE8,\n  Relics, 1+AR7,\n  WSPlus, AQ7,\n\n(AV7 * Lab + Substat) * Relics * WSPlus)",
    "AV7": "AN7",
    "AY7": "'Master Sheet'!AB29",
    "BC7": "BC6+1",
    "BD7": "BD6+BD$3",
    "BE7": "BE6+BE$3",
    "BF7": "BF6+BF$3",
    "BG7": "BG6+BG$3",
    "BH7": "BH6+BH$3",
    "BI7": "BI6+BI$3",
    "BJ7": "BJ6+BJ$3",
    "BK7": "BK6+BK$3",
    "BL7": "BL6+BL$3",
    "BM7": "BM6+BM$3",
    "BN7": "BN6+BN$3",
    "BO7": "BO6+BO$3",
    "BP7": "BP6+BP$3",
    "BQ7": "BQ6+BQ$3",
    "BR7": "BR6+BR$3",
    "BT7": "BT6+FT6",
    "BU7": "BU6+FU6",
    "BV7": "BV6+FV6",
    "BW7": "BW6+FW6",
    "BX7": "BX6+FX6",
    "BY7": "BY6+FY6",
    "BZ7": "BZ6+FZ6",
    "CA7": "CA6+GA6",
    "CB7": "CB6+GB6",
    "CC7": "CC6+GC6",
    "CD7": "CD6+GD6",
    "CE7": "CE6+GE6",
    "CF7": "CF6+GF6",
    "CG7": "CG6+GG6",
    "CH7": "CH6+GH6",
    "CI7": "CI6+GI6",
    "CJ7": "CJ6+GJ6",
    "CK7": "CK6+GK6",
    "CL7": "CL6+GL6",
    "CM7": "CM6+GM6",
    "CN7": "CN6+GN6",
    "CO7": "CO6+GO6",
    "CS7": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI7,1)",
    "CT7": "INDEX($BD$5:$BD152,BT7)",
    "CU7": "INDEX($BN$5:$BN152,CD7)",
    "CV7": "INDEX($BO$5:$BO152,CE7)",
    "CW7": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG7)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX7": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO7, 1)",
    "CY7": "LET(\n  Base, $CR$6,\n  Damage, $CT7,\n  DamageMastery, $CS7,\n  DemonMastery, $CX7,\n  SPB, $CU7,\n  ITO, $CV7,\n  Shock, $CW7,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ7": "MIN(100%, DA7)",
    "DA7": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK7*1%, 0)",
    "DB7": "LET(\n  Lab, 1+INDEX($BF$5:$BF152,BV7),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC7": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK7*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI152,BY7) + CardCritMastery)",
    "DD7": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK7*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ152,BZ7) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE7": "LET(\n  CF, $DB7,\n  CC, $CZ7,\n  SCM, $DD7,\n  SCC, $DC7,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF7": "LET(\n  CF, $DB7,\n  CC, $DA7,\n  SCM, $DD7,\n  SCC, $DC7,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG7": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH7)), 0)",
    "DH7": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ7*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE152,BU7),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI7": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG152, BW7), 1) + $AE$9)",
    "DJ7": "LET(\n  DpmLab, INDEX($BH$5:$BH152,BX7),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL7, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK7": "(1+$DI7*$DJ7*$AQ$9)",
    "DL7": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK152,CA7),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM7*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM7": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK152,CA7),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM7*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN7": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL152,CB7)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO7": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH7,\n  Rapid, DG7,\n  RDPM, DK7,\n  SuperTower, $DL7,\n  Rend, $DN7,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP7": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ7": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK7),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR7": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP7),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF7-1))",
    "DS7": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG7, DH7),0))",
    "DT7": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP7),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV7, $AR$29), 0))",
    "DU7": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK7),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM152,CC7), $DV7, $AR$29), 0))",
    "DV7": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH7), $AO$29)",
    "DW7": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM7,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7, $DB7), 1),\n\n  DW, $DR7,\n  CL, $DS7,\n  SM, $DT7,\n  SLM, $DU7,\n  SL, $DQ7,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX7": "CY7*(DE7*DO7*DQ7+DW7*DF7)",
    "DZ7": "IF(INDEX($BD$6:$BD152,BT7)=\"\", \"\", INDEX($BD$5:$BD152,BT7+1))",
    "EA7": "IF(OR($AO$25, INDEX($BE$6:$BE152,BU7)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ7)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE152,BU7+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI7*$DJ7*$AQ$9),\n  SuperTower, $DL7,\n  Rend, $DN7,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7, $DB7), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR7,\n  SM, $DT7,\n  SLM, $DU7,\n  SL, $DQ7,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM7, UltCritCard),\n\nCY7*(DE7*OtherDamage*SL+UwDamage*DF7)))",
    "EB7": "IF(INDEX($BF$6:$BF152,BV7)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF152,BV7+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ7,\n  CCUW, $DA7,\n  SCM, $DD7,\n  SCC, $DC7,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7, CF), 1),\n\n  DW, $DR7,\n  CL, $DS7,\n  SM, $DT7,\n  SLM, $DU7,\n  SL, $DQ7,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM7, UltCritCard),\n\nCY7 * (Critical * DO7 * SL + UwDamage * UWCritical)))",
    "EC7": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG152,BW7)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH7,\n  Rapid, DG7,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG152, BW7+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ7*$AQ$9),\n  SuperTower, $DL7,\n  Rend, $DN7,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM152,CC7), $DV7, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM7,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7, $DB7), 1),\n\n  DW, $DR7,\n  CL, $DS7,\n  SM, $DT7,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY7*(DE7*OtherDamage*SL+UWDamage*DF7)))",
    "ED7": "IF(OR($AO$25, INDEX($BH$6:$BH152,BX7)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH152,BX7+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL7, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI7*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM152,CC7), $DV7, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH7,\n  Rapid, DG7,\n  SuperTower, $DL7,\n  Rend, $DN7,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM7,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7, $DB7), 1),\n\n  DW, $DR7,\n  CL, $DS7,\n  SM, $DT7,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY7*(DE7*OtherDamage*SL+UWDamage*DF7)))",
    "EE7": "IF(INDEX($BI$6:$BI152,BY7)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK7, 0),\n  CF, $DB7,\n  CC, $CZ7,\n  CCUW, $DA7,\n  SCM, $DD7,\n  SCC, $AV$17+INDEX($BI$5:$BI152,BY7+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY7 * (Critical*DO7*$DQ7+DW7*UWCritical)))",
    "EF7": "IF(INDEX($BJ$6:$BJ152,BZ7)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK7*1%, 1),\n  CF, $DB7,\n  CC, $CZ7,\n  CCUW, $DA7,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ152,BZ7+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC7,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY7*(Critical*DO7*$DQ7+DW7*UWCritical)))",
    "EG7": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK152,CA7)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH7,\n  Rapid, DG7,\n  DPM, (1+$DI7*$DJ7*$AQ$9),\n  Rend, $DN7,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK152,CA7+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM7*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7, $DB7), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK152,CA7+1)-1))/(45-CM7*3),1),\n\n  SL, $DQ7,\n  DW, $DR7,\n  CL, $DS7,\n  SM, $DT7,\n  SLM, $DU7,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY7*(DE7*OtherDamage*SL+UwDamage*DF7)))",
    "EH7": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL152,CB7+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL152,CB7)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH7,\n  Rapid, DG7,\n  DPM, (1+$DI7*$DJ7*$AQ$9),\n  SuperTower, $DL7,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL152,CB7+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY7*(DE7*OtherDamage*$DQ7+DW7*DF7)))",
    "EI7": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM152,CC7)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7, $DB7), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK7),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV7, $AR$29), 0),\n\n  DW, $DR7,\n  CL, $DS7,\n  SM, $DT7,\n  SL, $DQ7,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM7, UltCritCard),\nCY7*(DE7*DO7*SL+UwDamage*DF7)))",
    "EJ7": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN152,CD7)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT7,\n  DamageMastery, $CS7,\n  DemonMastery, $CX7,\n  SPB, INDEX($BN$5:$BN152,CD7+1),\n  ITO, $CV7,\n  Shock, $CW7,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE7*DO7*$DQ7+DW7*DF7)))",
    "EK7": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO152,CE7)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT7,\n  DamageMastery, $CS7,\n  DemonMastery, $CX7,\n  SPB, $CU7,\n  ITO, INDEX($BO$5:$BO152,CE7+1),\n  Shock, $CW7,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE7*DO7*$DQ7+DW7*DF7)))",
    "EL7": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP152,CF7)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7, $DB7), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP7),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF7),\n  CL, $DS7,\n  SM, $DT7,\n  SLM, $DU7,\n  SL, $DQ7,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM7, UltCritCard),\nCY7*(DE7*DO7*SL+UwDamage*DF7)))",
    "EM7": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ152,CG7)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG7+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN7": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR152,CH7)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7, $DB7), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH7+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP7),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK7),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM152,CC7), SMHeat, $AR$29), 0),\n\n  DW, $DR7,\n  CL, $DS7,\n  SL, $DQ7,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM7, UltCritCard),\nCY7*(DE7*DO7*SL+UwDamage*DF7)))",
    "EO7": "IF(OR(CI7 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI7+1))",
    "EP7": "IF(OR($AO$25, CJ7 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ7+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE151,BU7),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL7, 1),\n  DPM, (1+$DI7*CardRangeMastery*$DJ7*$AQ$9),\n  SuperTower, $DL7,\n  Rend, $DN7,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7, $DB7), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR7,\n  SM, $DT7,\n  SLM, $DU7,\n  SL, $DQ7,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM7, UltCritCard),\n\nCY7*(DE7*OtherDamage*SL+UwDamage*DF7)))",
    "EQ7": "IF(OR(CK7 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK7+1)*1%, 1),\n  CF, $DB7,\n  CC, MIN(100%, $CZ7 + 1%),\n  CCUW, DA7 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ152,BZ7) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC7 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR7,\n  CL, $DS7,\n  SM, $DT7,\n  SLM, $DU7,\n  SL, $DQ7,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM7, UltCritCard),\n\nCY7 * (Critical*DO7*SL+UwDamage*UWCritical)))",
    "ER7": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL7 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH152,BX7),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL7+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI7*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM152,CC7), $DV7, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH7,\n  Rapid, DG7,\n  SuperTower, $DL7,\n  Rend, $DN7,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM7,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7, $DB7), 1),\n\n  DW, $DR7,\n  CL, $DS7,\n  SM, $DT7,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY7*(DE7*OtherDamage*SL+UWDamage*DF7)))",
    "ES7": "IF(OR(CM7 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH7,\n  Rapid, DG7,\n  RDPM, (1+$DI7*$DJ7*$AQ$9),\n  Rend, $DN7,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK152,CA7),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM7+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7, $DB7), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR7,\n  CL, $DS7,\n  SM, $DT7,\n  SLM, $DU7,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY7*(DE7*OtherDamage*SL+UwDamage*DF7)))",
    "ET7": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN7 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM7,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN7+1, $DB7), 1),\n\n  DW, $DR7,\n  CL, $DS7,\n  SM, $DT7,\n  SLM, $DU7,\n  SL, $DQ7,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY7*(DE7*DO7*SL+UWDamage*DF7)))",
    "EU7": "IF(OR(NOT($BA$3), NOT($BA$23), $CO7 > $BA$15), \"\", 1 + 0.5*(CO7+1))",
    "EW7": "IF(DZ7=\"\", \"\", LET(\n  Now, CT7,\n  Next, DZ7,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT7),\nFactor/Cost))",
    "EX7": "IF(EA7=\"\",\"\",(EA7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU7))",
    "EY7": "IF(EB7=\"\",\"\",(EB7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV7))",
    "EZ7": "IF(EC7=\"\",\"\",(EC7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW7))",
    "FA7": "IF(ED7=\"\",\"\",(ED7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX7))",
    "FB7": "IF(EE7=\"\",\"\",(EE7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY7))",
    "FC7": "IF(EF7=\"\",\"\",(EF7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ7))",
    "FD7": "IF(EG7=\"\",\"\",(EG7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA7))",
    "FE7": "IF(EH7=\"\",\"\",(EH7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB7))",
    "FF7": "IF(EI7=\"\",\"\",(EI7/$DX7-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC7+1, 1, CC7))))",
    "FG7": "IF(EJ7=\"\",\"\",(EJ7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD7))",
    "FH7": "IF(EK7=\"\",\"\",(EK7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE7))",
    "FI7": "IF(EL7=\"\",\"\",(EL7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF7))",
    "FJ7": "IF(EM7=\"\", \"\", LET(\n  Now, CW7,\n  Next, EM7,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG7),\nFactor/Cost))",
    "FK7": "IF(EN7=\"\",\"\",(EN7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH7))",
    "FL7": "IF(EO7=\"\", \"\", LET(\n  Now, CS7,\n  Next, EO7,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI7),\nFactor/Cost))",
    "FM7": "IF(EP7=\"\",\"\",(EP7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ7))",
    "FN7": "IF(EQ7=\"\",\"\",(EQ7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK7))",
    "FO7": "IF(ER7=\"\",\"\",(ER7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL7))",
    "FP7": "IF(ES7=\"\",\"\",(ES7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM7))",
    "FQ7": "IF(ET7=\"\",\"\",(ET7/$DX7-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN7))",
    "FR7": "IF(EU7=\"\", \"\", LET(\n  Now, CX7,\n  Next, EU7,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO7),\nFactor/Cost))",
    "FT7": "IF(COLUMN(EW7:FR7) = MIN(IF(EW7:FR7=MAX(EW7:FR7), COLUMN(EW7:FR7))), 1, \"\")",
    "D8": "IF(SUM(FT7:GP7),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F8)),\"Card Mastery\",F8),G8)/$D$5,\"\")",
    "F8": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT7:GP7),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT7:GP7=1)),)\"),\"Damage\")",
    "G8": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT7:GP7),ARRAYFORMULA(FILTER(BT7:CP7 , FT7:GP7=1)),\"\"\"\")\"),1.0)",
    "I8": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT7:GP7),ARRAYFORMULA(FILTER(EW7:FS7 , FT7:GP7=1))*D$5,\"\"\"\")\"),123.42857142857154)",
    "K8": "IF(H8<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D8)),)",
    "AD8": "IF(EQ(AE8, 15), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE8=0, 2, AE8=2, 4, AE8=4, 6, AE8=6, 8, AE8=8, 12, AE8=12, 15), Common, 2, Rare, 4, Epic, 6, Legendary, 8, Mythic, 12, Ancestral, 15), 0),\n\n  Lab, 1+INDEX($BF$5:$BF150,BV5),\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Planner) * Relics * WSPlus,\n  CC, MIN(100%, $CZ5),\n  CCUW, $DA5,\n  SCC, $DC5,\n  SCM, $DD5,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, CF), 1),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5 * (Critical*DO5*SL+UwDamage*UWCritical),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE8": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC8,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AL8": "MAX('Master Sheet'!I4:J4)",
    "AN8": "(1%+(1%*AL8))",
    "AR8": "'Master Sheet'!AM7",
    "AS8": "'Master Sheet'!AX4",
    "AT8": "IF(AU8<=100%, AU8, 100%)",
    "AU8": "AV8 + IF(AND($BA$3,$BA$8,$BA$19), CK5*1%, 0)",
    "AV8": "AN8 + IF(AND(BA8,BA3),AZ8,0) + AE7 + AR8 + AS8",
    "AY8": "'Master Sheet'!AB10",
    "AZ8": "0.04+0.01*AY8",
    "BC8": "BC7+1",
    "BD8": "BD7+BD$3",
    "BE8": "BE7+BE$3",
    "BF8": "BF7+BF$3",
    "BG8": "BG7+BG$3",
    "BH8": "BH7+BH$3",
    "BI8": "BI7+BI$3",
    "BJ8": "BJ7+BJ$3",
    "BK8": "BK7+BK$3",
    "BL8": "BL7+BL$3",
    "BM8": "BM7+BM$3",
    "BN8": "BN7+BN$3",
    "BO8": "BO7+BO$3",
    "BP8": "BP7+BP$3",
    "BQ8": "BQ7+BQ$3",
    "BR8": "BR7+BR$3",
    "BT8": "BT7+FT7",
    "BU8": "BU7+FU7",
    "BV8": "BV7+FV7",
    "BW8": "BW7+FW7",
    "BX8": "BX7+FX7",
    "BY8": "BY7+FY7",
    "BZ8": "BZ7+FZ7",
    "CA8": "CA7+GA7",
    "CB8": "CB7+GB7",
    "CC8": "CC7+GC7",
    "CD8": "CD7+GD7",
    "CE8": "CE7+GE7",
    "CF8": "CF7+GF7",
    "CG8": "CG7+GG7",
    "CH8": "CH7+GH7",
    "CI8": "CI7+GI7",
    "CJ8": "CJ7+GJ7",
    "CK8": "CK7+GK7",
    "CL8": "CL7+GL7",
    "CM8": "CM7+GM7",
    "CN8": "CN7+GN7",
    "CO8": "CO7+GO7",
    "CS8": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI8,1)",
    "CT8": "INDEX($BD$5:$BD153,BT8)",
    "CU8": "INDEX($BN$5:$BN153,CD8)",
    "CV8": "INDEX($BO$5:$BO153,CE8)",
    "CW8": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG8)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX8": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO8, 1)",
    "CY8": "LET(\n  Base, $CR$6,\n  Damage, $CT8,\n  DamageMastery, $CS8,\n  DemonMastery, $CX8,\n  SPB, $CU8,\n  ITO, $CV8,\n  Shock, $CW8,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ8": "MIN(100%, DA8)",
    "DA8": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK8*1%, 0)",
    "DB8": "LET(\n  Lab, 1+INDEX($BF$5:$BF153,BV8),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC8": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK8*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI153,BY8) + CardCritMastery)",
    "DD8": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK8*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ153,BZ8) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE8": "LET(\n  CF, $DB8,\n  CC, $CZ8,\n  SCM, $DD8,\n  SCC, $DC8,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF8": "LET(\n  CF, $DB8,\n  CC, $DA8,\n  SCM, $DD8,\n  SCC, $DC8,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG8": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH8)), 0)",
    "DH8": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ8*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE153,BU8),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI8": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG153, BW8), 1) + $AE$9)",
    "DJ8": "LET(\n  DpmLab, INDEX($BH$5:$BH153,BX8),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL8, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK8": "(1+$DI8*$DJ8*$AQ$9)",
    "DL8": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK153,CA8),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM8*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM8": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK153,CA8),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM8*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN8": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL153,CB8)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO8": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH8,\n  Rapid, DG8,\n  RDPM, DK8,\n  SuperTower, $DL8,\n  Rend, $DN8,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP8": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ8": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK8),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR8": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP8),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF8-1))",
    "DS8": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG8, DH8),0))",
    "DT8": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP8),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV8, $AR$29), 0))",
    "DU8": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK8),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM153,CC8), $DV8, $AR$29), 0))",
    "DV8": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH8), $AO$29)",
    "DW8": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM8,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8, $DB8), 1),\n\n  DW, $DR8,\n  CL, $DS8,\n  SM, $DT8,\n  SLM, $DU8,\n  SL, $DQ8,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX8": "CY8*(DE8*DO8*DQ8+DW8*DF8)",
    "DZ8": "IF(INDEX($BD$6:$BD153,BT8)=\"\", \"\", INDEX($BD$5:$BD153,BT8+1))",
    "EA8": "IF(OR($AO$25, INDEX($BE$6:$BE153,BU8)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ8)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE153,BU8+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI8*$DJ8*$AQ$9),\n  SuperTower, $DL8,\n  Rend, $DN8,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8, $DB8), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR8,\n  SM, $DT8,\n  SLM, $DU8,\n  SL, $DQ8,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM8, UltCritCard),\n\nCY8*(DE8*OtherDamage*SL+UwDamage*DF8)))",
    "EB8": "IF(INDEX($BF$6:$BF153,BV8)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF153,BV8+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ8,\n  CCUW, $DA8,\n  SCM, $DD8,\n  SCC, $DC8,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8, CF), 1),\n\n  DW, $DR8,\n  CL, $DS8,\n  SM, $DT8,\n  SLM, $DU8,\n  SL, $DQ8,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM8, UltCritCard),\n\nCY8 * (Critical * DO8 * SL + UwDamage * UWCritical)))",
    "EC8": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG153,BW8)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH8,\n  Rapid, DG8,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG153, BW8+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ8*$AQ$9),\n  SuperTower, $DL8,\n  Rend, $DN8,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM153,CC8), $DV8, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM8,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8, $DB8), 1),\n\n  DW, $DR8,\n  CL, $DS8,\n  SM, $DT8,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY8*(DE8*OtherDamage*SL+UWDamage*DF8)))",
    "ED8": "IF(OR($AO$25, INDEX($BH$6:$BH153,BX8)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH153,BX8+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL8, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI8*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM153,CC8), $DV8, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH8,\n  Rapid, DG8,\n  SuperTower, $DL8,\n  Rend, $DN8,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM8,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8, $DB8), 1),\n\n  DW, $DR8,\n  CL, $DS8,\n  SM, $DT8,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY8*(DE8*OtherDamage*SL+UWDamage*DF8)))",
    "EE8": "IF(INDEX($BI$6:$BI153,BY8)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK8, 0),\n  CF, $DB8,\n  CC, $CZ8,\n  CCUW, $DA8,\n  SCM, $DD8,\n  SCC, $AV$17+INDEX($BI$5:$BI153,BY8+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY8 * (Critical*DO8*$DQ8+DW8*UWCritical)))",
    "EF8": "IF(INDEX($BJ$6:$BJ153,BZ8)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK8*1%, 1),\n  CF, $DB8,\n  CC, $CZ8,\n  CCUW, $DA8,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ153,BZ8+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC8,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY8*(Critical*DO8*$DQ8+DW8*UWCritical)))",
    "EG8": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK153,CA8)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH8,\n  Rapid, DG8,\n  DPM, (1+$DI8*$DJ8*$AQ$9),\n  Rend, $DN8,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK153,CA8+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM8*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8, $DB8), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK153,CA8+1)-1))/(45-CM8*3),1),\n\n  SL, $DQ8,\n  DW, $DR8,\n  CL, $DS8,\n  SM, $DT8,\n  SLM, $DU8,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY8*(DE8*OtherDamage*SL+UwDamage*DF8)))",
    "EH8": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL153,CB8+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL153,CB8)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH8,\n  Rapid, DG8,\n  DPM, (1+$DI8*$DJ8*$AQ$9),\n  SuperTower, $DL8,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL153,CB8+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY8*(DE8*OtherDamage*$DQ8+DW8*DF8)))",
    "EI8": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM153,CC8)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8, $DB8), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK8),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV8, $AR$29), 0),\n\n  DW, $DR8,\n  CL, $DS8,\n  SM, $DT8,\n  SL, $DQ8,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM8, UltCritCard),\nCY8*(DE8*DO8*SL+UwDamage*DF8)))",
    "EJ8": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN153,CD8)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT8,\n  DamageMastery, $CS8,\n  DemonMastery, $CX8,\n  SPB, INDEX($BN$5:$BN153,CD8+1),\n  ITO, $CV8,\n  Shock, $CW8,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE8*DO8*$DQ8+DW8*DF8)))",
    "EK8": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO153,CE8)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT8,\n  DamageMastery, $CS8,\n  DemonMastery, $CX8,\n  SPB, $CU8,\n  ITO, INDEX($BO$5:$BO153,CE8+1),\n  Shock, $CW8,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE8*DO8*$DQ8+DW8*DF8)))",
    "EL8": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP153,CF8)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8, $DB8), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP8),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF8),\n  CL, $DS8,\n  SM, $DT8,\n  SLM, $DU8,\n  SL, $DQ8,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM8, UltCritCard),\nCY8*(DE8*DO8*SL+UwDamage*DF8)))",
    "EM8": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ153,CG8)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG8+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN8": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR153,CH8)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8, $DB8), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH8+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP8),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK8),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM153,CC8), SMHeat, $AR$29), 0),\n\n  DW, $DR8,\n  CL, $DS8,\n  SL, $DQ8,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM8, UltCritCard),\nCY8*(DE8*DO8*SL+UwDamage*DF8)))",
    "EO8": "IF(OR(CI8 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI8+1))",
    "EP8": "IF(OR($AO$25, CJ8 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ8+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE152,BU8),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL8, 1),\n  DPM, (1+$DI8*CardRangeMastery*$DJ8*$AQ$9),\n  SuperTower, $DL8,\n  Rend, $DN8,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8, $DB8), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR8,\n  SM, $DT8,\n  SLM, $DU8,\n  SL, $DQ8,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM8, UltCritCard),\n\nCY8*(DE8*OtherDamage*SL+UwDamage*DF8)))",
    "EQ8": "IF(OR(CK8 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK8+1)*1%, 1),\n  CF, $DB8,\n  CC, MIN(100%, $CZ8 + 1%),\n  CCUW, DA8 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ153,BZ8) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC8 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR8,\n  CL, $DS8,\n  SM, $DT8,\n  SLM, $DU8,\n  SL, $DQ8,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM8, UltCritCard),\n\nCY8 * (Critical*DO8*SL+UwDamage*UWCritical)))",
    "ER8": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL8 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH153,BX8),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL8+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI8*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM153,CC8), $DV8, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH8,\n  Rapid, DG8,\n  SuperTower, $DL8,\n  Rend, $DN8,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM8,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8, $DB8), 1),\n\n  DW, $DR8,\n  CL, $DS8,\n  SM, $DT8,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY8*(DE8*OtherDamage*SL+UWDamage*DF8)))",
    "ES8": "IF(OR(CM8 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH8,\n  Rapid, DG8,\n  RDPM, (1+$DI8*$DJ8*$AQ$9),\n  Rend, $DN8,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK153,CA8),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM8+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8, $DB8), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR8,\n  CL, $DS8,\n  SM, $DT8,\n  SLM, $DU8,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY8*(DE8*OtherDamage*SL+UwDamage*DF8)))",
    "ET8": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN8 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM8,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN8+1, $DB8), 1),\n\n  DW, $DR8,\n  CL, $DS8,\n  SM, $DT8,\n  SLM, $DU8,\n  SL, $DQ8,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY8*(DE8*DO8*SL+UWDamage*DF8)))",
    "EU8": "IF(OR(NOT($BA$3), NOT($BA$23), $CO8 > $BA$15), \"\", 1 + 0.5*(CO8+1))",
    "EW8": "IF(DZ8=\"\", \"\", LET(\n  Now, CT8,\n  Next, DZ8,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT8),\nFactor/Cost))",
    "EX8": "IF(EA8=\"\",\"\",(EA8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU8))",
    "EY8": "IF(EB8=\"\",\"\",(EB8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV8))",
    "EZ8": "IF(EC8=\"\",\"\",(EC8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW8))",
    "FA8": "IF(ED8=\"\",\"\",(ED8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX8))",
    "FB8": "IF(EE8=\"\",\"\",(EE8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY8))",
    "FC8": "IF(EF8=\"\",\"\",(EF8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ8))",
    "FD8": "IF(EG8=\"\",\"\",(EG8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA8))",
    "FE8": "IF(EH8=\"\",\"\",(EH8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB8))",
    "FF8": "IF(EI8=\"\",\"\",(EI8/$DX8-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC8+1, 1, CC8))))",
    "FG8": "IF(EJ8=\"\",\"\",(EJ8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD8))",
    "FH8": "IF(EK8=\"\",\"\",(EK8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE8))",
    "FI8": "IF(EL8=\"\",\"\",(EL8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF8))",
    "FJ8": "IF(EM8=\"\", \"\", LET(\n  Now, CW8,\n  Next, EM8,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG8),\nFactor/Cost))",
    "FK8": "IF(EN8=\"\",\"\",(EN8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH8))",
    "FL8": "IF(EO8=\"\", \"\", LET(\n  Now, CS8,\n  Next, EO8,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI8),\nFactor/Cost))",
    "FM8": "IF(EP8=\"\",\"\",(EP8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ8))",
    "FN8": "IF(EQ8=\"\",\"\",(EQ8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK8))",
    "FO8": "IF(ER8=\"\",\"\",(ER8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL8))",
    "FP8": "IF(ES8=\"\",\"\",(ES8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM8))",
    "FQ8": "IF(ET8=\"\",\"\",(ET8/$DX8-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN8))",
    "FR8": "IF(EU8=\"\", \"\", LET(\n  Now, CX8,\n  Next, EU8,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO8),\nFactor/Cost))",
    "FT8": "IF(COLUMN(EW8:FR8) = MIN(IF(EW8:FR8=MAX(EW8:FR8), COLUMN(EW8:FR8))), 1, \"\")",
    "D9": "IF(SUM(FT8:GP8),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F9)),\"Card Mastery\",F9),G9)/$D$5,\"\")",
    "F9": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT8:GP8),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT8:GP8=1)),)\"),\"Damage / Meter\")",
    "G9": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT8:GP8),ARRAYFORMULA(FILTER(BT8:CP8 , FT8:GP8=1)),\"\"\"\")\"),1.0)",
    "I9": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT8:GP8),ARRAYFORMULA(FILTER(EW8:FS8 , FT8:GP8=1))*D$5,\"\"\"\")\"),47.65685636859135)",
    "K9": "IF(H9<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D9)),)",
    "AD9": "IF(EQ(AE9, 30), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE9=0, 2, AE9=2, 4, AE9=4, 8, AE9=8, 12, AE9=12, 20, AE9=20, 30), Common, 2, Rare, 4, Epic, 8, Legendary, 12, Mythic, 20, Ancestral, 30), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR10,\n  AtkSpeed, $DH5,\n  Rapid, $DG$5,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG150, BW5+1), 1) + Planner),\n  RDPM, (1+Range*$DJ5*$AQ$9),\n  SuperTower, $DL5,\n  Rend, $DN5,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM150,CC5), $DV5, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM5,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  eDMG, CY5*(DE5*OtherDamage*SL+UWDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE9": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC9,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AI9": "'Master Sheet'!C19",
    "AK9": "(1+(2%*IF(AH9,AI9,0)))",
    "AL9": "MAX('Master Sheet'!I6:J6)",
    "AN9": "30+(0.5*AL9)",
    "AT9": "ROUND(AU9,1) & \" m\"",
    "AU9": "(AV9 * AK9 + AE9)",
    "AV9": "(AN9 * IF(AND(BA3,BA9),AZ9,1))",
    "AY9": "'Master Sheet'!AB6",
    "AZ9": "1.1 + RIGHT(AY9,1) * 0.05",
    "BC9": "BC8+1",
    "BD9": "BD8+BD$3",
    "BE9": "BE8+BE$3",
    "BF9": "BF8+BF$3",
    "BG9": "BG8+BG$3",
    "BH9": "BH8+BH$3",
    "BI9": "BI8+BI$3",
    "BJ9": "BJ8+BJ$3",
    "BK9": "BK8+BK$3",
    "BL9": "BL8+BL$3",
    "BM9": "BM8+BM$3",
    "BN9": "BN8+BN$3",
    "BO9": "BO8+BO$3",
    "BP9": "BP8+BP$3",
    "BQ9": "BQ8+BQ$3",
    "BR9": "BR8+BR$3",
    "BT9": "BT8+FT8",
    "BU9": "BU8+FU8",
    "BV9": "BV8+FV8",
    "BW9": "BW8+FW8",
    "BX9": "BX8+FX8",
    "BY9": "BY8+FY8",
    "BZ9": "BZ8+FZ8",
    "CA9": "CA8+GA8",
    "CB9": "CB8+GB8",
    "CC9": "CC8+GC8",
    "CD9": "CD8+GD8",
    "CE9": "CE8+GE8",
    "CF9": "CF8+GF8",
    "CG9": "CG8+GG8",
    "CH9": "CH8+GH8",
    "CI9": "CI8+GI8",
    "CJ9": "CJ8+GJ8",
    "CK9": "CK8+GK8",
    "CL9": "CL8+GL8",
    "CM9": "CM8+GM8",
    "CN9": "CN8+GN8",
    "CO9": "CO8+GO8",
    "CR9": "(1+$AT$11*($AT$12-1))",
    "CS9": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI9,1)",
    "CT9": "INDEX($BD$5:$BD154,BT9)",
    "CU9": "INDEX($BN$5:$BN154,CD9)",
    "CV9": "INDEX($BO$5:$BO154,CE9)",
    "CW9": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG9)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX9": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO9, 1)",
    "CY9": "LET(\n  Base, $CR$6,\n  Damage, $CT9,\n  DamageMastery, $CS9,\n  DemonMastery, $CX9,\n  SPB, $CU9,\n  ITO, $CV9,\n  Shock, $CW9,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ9": "MIN(100%, DA9)",
    "DA9": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK9*1%, 0)",
    "DB9": "LET(\n  Lab, 1+INDEX($BF$5:$BF154,BV9),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC9": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK9*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI154,BY9) + CardCritMastery)",
    "DD9": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK9*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ154,BZ9) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE9": "LET(\n  CF, $DB9,\n  CC, $CZ9,\n  SCM, $DD9,\n  SCC, $DC9,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF9": "LET(\n  CF, $DB9,\n  CC, $DA9,\n  SCM, $DD9,\n  SCC, $DC9,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG9": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH9)), 0)",
    "DH9": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ9*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE154,BU9),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI9": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG154, BW9), 1) + $AE$9)",
    "DJ9": "LET(\n  DpmLab, INDEX($BH$5:$BH154,BX9),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL9, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK9": "(1+$DI9*$DJ9*$AQ$9)",
    "DL9": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK154,CA9),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM9*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM9": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK154,CA9),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM9*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN9": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL154,CB9)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO9": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH9,\n  Rapid, DG9,\n  RDPM, DK9,\n  SuperTower, $DL9,\n  Rend, $DN9,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP9": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ9": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK9),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR9": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP9),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF9-1))",
    "DS9": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG9, DH9),0))",
    "DT9": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP9),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV9, $AR$29), 0))",
    "DU9": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK9),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM154,CC9), $DV9, $AR$29), 0))",
    "DV9": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH9), $AO$29)",
    "DW9": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM9,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9, $DB9), 1),\n\n  DW, $DR9,\n  CL, $DS9,\n  SM, $DT9,\n  SLM, $DU9,\n  SL, $DQ9,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX9": "CY9*(DE9*DO9*DQ9+DW9*DF9)",
    "DZ9": "IF(INDEX($BD$6:$BD154,BT9)=\"\", \"\", INDEX($BD$5:$BD154,BT9+1))",
    "EA9": "IF(OR($AO$25, INDEX($BE$6:$BE154,BU9)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ9)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE154,BU9+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI9*$DJ9*$AQ$9),\n  SuperTower, $DL9,\n  Rend, $DN9,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9, $DB9), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR9,\n  SM, $DT9,\n  SLM, $DU9,\n  SL, $DQ9,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM9, UltCritCard),\n\nCY9*(DE9*OtherDamage*SL+UwDamage*DF9)))",
    "EB9": "IF(INDEX($BF$6:$BF154,BV9)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF154,BV9+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ9,\n  CCUW, $DA9,\n  SCM, $DD9,\n  SCC, $DC9,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9, CF), 1),\n\n  DW, $DR9,\n  CL, $DS9,\n  SM, $DT9,\n  SLM, $DU9,\n  SL, $DQ9,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM9, UltCritCard),\n\nCY9 * (Critical * DO9 * SL + UwDamage * UWCritical)))",
    "EC9": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG154,BW9)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH9,\n  Rapid, DG9,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG154, BW9+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ9*$AQ$9),\n  SuperTower, $DL9,\n  Rend, $DN9,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM154,CC9), $DV9, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM9,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9, $DB9), 1),\n\n  DW, $DR9,\n  CL, $DS9,\n  SM, $DT9,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY9*(DE9*OtherDamage*SL+UWDamage*DF9)))",
    "ED9": "IF(OR($AO$25, INDEX($BH$6:$BH154,BX9)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH154,BX9+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL9, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI9*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM154,CC9), $DV9, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH9,\n  Rapid, DG9,\n  SuperTower, $DL9,\n  Rend, $DN9,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM9,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9, $DB9), 1),\n\n  DW, $DR9,\n  CL, $DS9,\n  SM, $DT9,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY9*(DE9*OtherDamage*SL+UWDamage*DF9)))",
    "EE9": "IF(INDEX($BI$6:$BI154,BY9)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK9, 0),\n  CF, $DB9,\n  CC, $CZ9,\n  CCUW, $DA9,\n  SCM, $DD9,\n  SCC, $AV$17+INDEX($BI$5:$BI154,BY9+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY9 * (Critical*DO9*$DQ9+DW9*UWCritical)))",
    "EF9": "IF(INDEX($BJ$6:$BJ154,BZ9)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK9*1%, 1),\n  CF, $DB9,\n  CC, $CZ9,\n  CCUW, $DA9,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ154,BZ9+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC9,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY9*(Critical*DO9*$DQ9+DW9*UWCritical)))",
    "EG9": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK154,CA9)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH9,\n  Rapid, DG9,\n  DPM, (1+$DI9*$DJ9*$AQ$9),\n  Rend, $DN9,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK154,CA9+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM9*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9, $DB9), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK154,CA9+1)-1))/(45-CM9*3),1),\n\n  SL, $DQ9,\n  DW, $DR9,\n  CL, $DS9,\n  SM, $DT9,\n  SLM, $DU9,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY9*(DE9*OtherDamage*SL+UwDamage*DF9)))",
    "EH9": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL154,CB9+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL154,CB9)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH9,\n  Rapid, DG9,\n  DPM, (1+$DI9*$DJ9*$AQ$9),\n  SuperTower, $DL9,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL154,CB9+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY9*(DE9*OtherDamage*$DQ9+DW9*DF9)))",
    "EI9": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM154,CC9)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9, $DB9), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK9),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV9, $AR$29), 0),\n\n  DW, $DR9,\n  CL, $DS9,\n  SM, $DT9,\n  SL, $DQ9,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM9, UltCritCard),\nCY9*(DE9*DO9*SL+UwDamage*DF9)))",
    "EJ9": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN154,CD9)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT9,\n  DamageMastery, $CS9,\n  DemonMastery, $CX9,\n  SPB, INDEX($BN$5:$BN154,CD9+1),\n  ITO, $CV9,\n  Shock, $CW9,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE9*DO9*$DQ9+DW9*DF9)))",
    "EK9": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO154,CE9)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT9,\n  DamageMastery, $CS9,\n  DemonMastery, $CX9,\n  SPB, $CU9,\n  ITO, INDEX($BO$5:$BO154,CE9+1),\n  Shock, $CW9,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE9*DO9*$DQ9+DW9*DF9)))",
    "EL9": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP154,CF9)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9, $DB9), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP9),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF9),\n  CL, $DS9,\n  SM, $DT9,\n  SLM, $DU9,\n  SL, $DQ9,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM9, UltCritCard),\nCY9*(DE9*DO9*SL+UwDamage*DF9)))",
    "EM9": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ154,CG9)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG9+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN9": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR154,CH9)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9, $DB9), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH9+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP9),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK9),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM154,CC9), SMHeat, $AR$29), 0),\n\n  DW, $DR9,\n  CL, $DS9,\n  SL, $DQ9,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM9, UltCritCard),\nCY9*(DE9*DO9*SL+UwDamage*DF9)))",
    "EO9": "IF(OR(CI9 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI9+1))",
    "EP9": "IF(OR($AO$25, CJ9 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ9+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE153,BU9),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL9, 1),\n  DPM, (1+$DI9*CardRangeMastery*$DJ9*$AQ$9),\n  SuperTower, $DL9,\n  Rend, $DN9,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9, $DB9), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR9,\n  SM, $DT9,\n  SLM, $DU9,\n  SL, $DQ9,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM9, UltCritCard),\n\nCY9*(DE9*OtherDamage*SL+UwDamage*DF9)))",
    "EQ9": "IF(OR(CK9 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK9+1)*1%, 1),\n  CF, $DB9,\n  CC, MIN(100%, $CZ9 + 1%),\n  CCUW, DA9 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ154,BZ9) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC9 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR9,\n  CL, $DS9,\n  SM, $DT9,\n  SLM, $DU9,\n  SL, $DQ9,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM9, UltCritCard),\n\nCY9 * (Critical*DO9*SL+UwDamage*UWCritical)))",
    "ER9": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL9 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH154,BX9),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL9+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI9*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM154,CC9), $DV9, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH9,\n  Rapid, DG9,\n  SuperTower, $DL9,\n  Rend, $DN9,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM9,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9, $DB9), 1),\n\n  DW, $DR9,\n  CL, $DS9,\n  SM, $DT9,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY9*(DE9*OtherDamage*SL+UWDamage*DF9)))",
    "ES9": "IF(OR(CM9 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH9,\n  Rapid, DG9,\n  RDPM, (1+$DI9*$DJ9*$AQ$9),\n  Rend, $DN9,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK154,CA9),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM9+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9, $DB9), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR9,\n  CL, $DS9,\n  SM, $DT9,\n  SLM, $DU9,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY9*(DE9*OtherDamage*SL+UwDamage*DF9)))",
    "ET9": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN9 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM9,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN9+1, $DB9), 1),\n\n  DW, $DR9,\n  CL, $DS9,\n  SM, $DT9,\n  SLM, $DU9,\n  SL, $DQ9,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY9*(DE9*DO9*SL+UWDamage*DF9)))",
    "EU9": "IF(OR(NOT($BA$3), NOT($BA$23), $CO9 > $BA$15), \"\", 1 + 0.5*(CO9+1))",
    "EW9": "IF(DZ9=\"\", \"\", LET(\n  Now, CT9,\n  Next, DZ9,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT9),\nFactor/Cost))",
    "EX9": "IF(EA9=\"\",\"\",(EA9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU9))",
    "EY9": "IF(EB9=\"\",\"\",(EB9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV9))",
    "EZ9": "IF(EC9=\"\",\"\",(EC9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW9))",
    "FA9": "IF(ED9=\"\",\"\",(ED9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX9))",
    "FB9": "IF(EE9=\"\",\"\",(EE9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY9))",
    "FC9": "IF(EF9=\"\",\"\",(EF9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ9))",
    "FD9": "IF(EG9=\"\",\"\",(EG9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA9))",
    "FE9": "IF(EH9=\"\",\"\",(EH9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB9))",
    "FF9": "IF(EI9=\"\",\"\",(EI9/$DX9-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC9+1, 1, CC9))))",
    "FG9": "IF(EJ9=\"\",\"\",(EJ9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD9))",
    "FH9": "IF(EK9=\"\",\"\",(EK9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE9))",
    "FI9": "IF(EL9=\"\",\"\",(EL9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF9))",
    "FJ9": "IF(EM9=\"\", \"\", LET(\n  Now, CW9,\n  Next, EM9,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG9),\nFactor/Cost))",
    "FK9": "IF(EN9=\"\",\"\",(EN9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH9))",
    "FL9": "IF(EO9=\"\", \"\", LET(\n  Now, CS9,\n  Next, EO9,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI9),\nFactor/Cost))",
    "FM9": "IF(EP9=\"\",\"\",(EP9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ9))",
    "FN9": "IF(EQ9=\"\",\"\",(EQ9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK9))",
    "FO9": "IF(ER9=\"\",\"\",(ER9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL9))",
    "FP9": "IF(ES9=\"\",\"\",(ES9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM9))",
    "FQ9": "IF(ET9=\"\",\"\",(ET9/$DX9-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN9))",
    "FR9": "IF(EU9=\"\", \"\", LET(\n  Now, CX9,\n  Next, EU9,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO9),\nFactor/Cost))",
    "FT9": "IF(COLUMN(EW9:FR9) = MIN(IF(EW9:FR9=MAX(EW9:FR9), COLUMN(EW9:FR9))), 1, \"\")",
    "D10": "IF(SUM(FT9:GP9),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F10)),\"Card Mastery\",F10),G10)/$D$5,\"\")",
    "F10": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT9:GP9),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT9:GP9=1)),)\"),\"Critical Factor\")",
    "G10": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT9:GP9),ARRAYFORMULA(FILTER(BT9:CP9 , FT9:GP9=1)),\"\"\"\")\"),2.0)",
    "I10": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT9:GP9),ARRAYFORMULA(FILTER(EW9:FS9 , FT9:GP9=1))*D$5,\"\"\"\")\"),6.512406756394712)",
    "K10": "IF(H10<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D10)),)",
    "AD10": "IF(EQ(AE10, 0.15), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE10=0, 0.005, AE10=0.005, 0.01, AE10=0.01, 0.025, AE10=0.025, 0.04, AE10=0.04, 0.075, AE10=0.075, 0.15), Common, 0.005, Rare, 0.01, Epic, 0.025, Legendary, 0.04, Mythic, 0.075, Ancestral, 0.15), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR10,\n  AtkSpeed, $DH5,\n  Rapid, $DG$5,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL5, 1),\n  DamageMeter, (($AN$10 * INDEX($BH$5:$BH150,BX5) + Planner) * (1+$AR$10) * $AQ$10 * (1+$AS$10)),\n  RDPM, (1+$DI5*CardRangeMastery*DamageMeter*$AQ$9),\n  SuperTower, $DL5,\n  Rend, $DN5,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM150,CC5), $DV5, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM5,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  eDMG, CY5*(DE5*OtherDamage*SL+UWDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE10": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC10,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AI10": "'Master Sheet'!C20",
    "AK10": "1+(2%*AI10)",
    "AL10": "MAX('Master Sheet'!I7:J7)",
    "AN10": "VLOOKUP(AL10, WSValues!I:J, 2, FALSE)/1000",
    "AO10": "'Master Sheet'!O5",
    "AQ10": "1+(AO10*0.01)",
    "AR10": "'Master Sheet'!AM10",
    "AS10": "'Master Sheet'!AX6",
    "AT10": "AU10",
    "AU10": "(AN10 * AK10 + AE10) * (1+AR10) * AQ10 * (1+AS10)",
    "AY10": "'Master Sheet'!AB24",
    "AZ10": "2.1 + RIGHT(AY10,1) * 0.4 + IF(AY10=\"Lvl 7\",0.1,0)",
    "BC10": "BC9+1",
    "BD10": "BD9+BD$3",
    "BE10": "BE9+BE$3",
    "BF10": "BF9+BF$3",
    "BG10": "BG9+BG$3",
    "BH10": "BH9+BH$3",
    "BI10": "BI9+BI$3",
    "BJ10": "BJ9+BJ$3",
    "BK10": "BK9+BK$3",
    "BL10": "BL9+BL$3",
    "BM10": "BM9+BM$3",
    "BN10": "BN9+BN$3",
    "BO10": "BO9+BO$3",
    "BP10": "BP9+BP$3",
    "BQ10": "BQ9+BQ$3",
    "BR10": "BR9+BR$3",
    "BT10": "BT9+FT9",
    "BU10": "BU9+FU9",
    "BV10": "BV9+FV9",
    "BW10": "BW9+FW9",
    "BX10": "BX9+FX9",
    "BY10": "BY9+FY9",
    "BZ10": "BZ9+FZ9",
    "CA10": "CA9+GA9",
    "CB10": "CB9+GB9",
    "CC10": "CC9+GC9",
    "CD10": "CD9+GD9",
    "CE10": "CE9+GE9",
    "CF10": "CF9+GF9",
    "CG10": "CG9+GG9",
    "CH10": "CH9+GH9",
    "CI10": "CI9+GI9",
    "CJ10": "CJ9+GJ9",
    "CK10": "CK9+GK9",
    "CL10": "CL9+GL9",
    "CM10": "CM9+GM9",
    "CN10": "CN9+GN9",
    "CO10": "CO9+GO9",
    "CR10": "(1 + SUM($AT$15^(SEQUENCE($AT$16, 1, 1, 1)) * (1+$AQ$15)^SEQUENCE($AT$16, 1, 1, 1)))",
    "CS10": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI10,1)",
    "CT10": "INDEX($BD$5:$BD155,BT10)",
    "CU10": "INDEX($BN$5:$BN155,CD10)",
    "CV10": "INDEX($BO$5:$BO155,CE10)",
    "CW10": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG10)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX10": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO10, 1)",
    "CY10": "LET(\n  Base, $CR$6,\n  Damage, $CT10,\n  DamageMastery, $CS10,\n  DemonMastery, $CX10,\n  SPB, $CU10,\n  ITO, $CV10,\n  Shock, $CW10,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ10": "MIN(100%, DA10)",
    "DA10": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK10*1%, 0)",
    "DB10": "LET(\n  Lab, 1+INDEX($BF$5:$BF155,BV10),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC10": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK10*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI155,BY10) + CardCritMastery)",
    "DD10": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK10*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ155,BZ10) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE10": "LET(\n  CF, $DB10,\n  CC, $CZ10,\n  SCM, $DD10,\n  SCC, $DC10,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF10": "LET(\n  CF, $DB10,\n  CC, $DA10,\n  SCM, $DD10,\n  SCC, $DC10,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG10": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH10)), 0)",
    "DH10": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ10*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE155,BU10),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI10": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG155, BW10), 1) + $AE$9)",
    "DJ10": "LET(\n  DpmLab, INDEX($BH$5:$BH155,BX10),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL10, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK10": "(1+$DI10*$DJ10*$AQ$9)",
    "DL10": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK155,CA10),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM10*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM10": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK155,CA10),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM10*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN10": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL155,CB10)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO10": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH10,\n  Rapid, DG10,\n  RDPM, DK10,\n  SuperTower, $DL10,\n  Rend, $DN10,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP10": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ10": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK10),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR10": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP10),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF10-1))",
    "DS10": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG10, DH10),0))",
    "DT10": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP10),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV10, $AR$29), 0))",
    "DU10": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK10),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM155,CC10), $DV10, $AR$29), 0))",
    "DV10": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH10), $AO$29)",
    "DW10": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM10,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10, $DB10), 1),\n\n  DW, $DR10,\n  CL, $DS10,\n  SM, $DT10,\n  SLM, $DU10,\n  SL, $DQ10,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX10": "CY10*(DE10*DO10*DQ10+DW10*DF10)",
    "DZ10": "IF(INDEX($BD$6:$BD155,BT10)=\"\", \"\", INDEX($BD$5:$BD155,BT10+1))",
    "EA10": "IF(OR($AO$25, INDEX($BE$6:$BE155,BU10)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ10)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE155,BU10+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI10*$DJ10*$AQ$9),\n  SuperTower, $DL10,\n  Rend, $DN10,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10, $DB10), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR10,\n  SM, $DT10,\n  SLM, $DU10,\n  SL, $DQ10,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM10, UltCritCard),\n\nCY10*(DE10*OtherDamage*SL+UwDamage*DF10)))",
    "EB10": "IF(INDEX($BF$6:$BF155,BV10)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF155,BV10+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ10,\n  CCUW, $DA10,\n  SCM, $DD10,\n  SCC, $DC10,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10, CF), 1),\n\n  DW, $DR10,\n  CL, $DS10,\n  SM, $DT10,\n  SLM, $DU10,\n  SL, $DQ10,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM10, UltCritCard),\n\nCY10 * (Critical * DO10 * SL + UwDamage * UWCritical)))",
    "EC10": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG155,BW10)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH10,\n  Rapid, DG10,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG155, BW10+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ10*$AQ$9),\n  SuperTower, $DL10,\n  Rend, $DN10,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM155,CC10), $DV10, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM10,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10, $DB10), 1),\n\n  DW, $DR10,\n  CL, $DS10,\n  SM, $DT10,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY10*(DE10*OtherDamage*SL+UWDamage*DF10)))",
    "ED10": "IF(OR($AO$25, INDEX($BH$6:$BH155,BX10)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH155,BX10+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL10, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI10*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM155,CC10), $DV10, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH10,\n  Rapid, DG10,\n  SuperTower, $DL10,\n  Rend, $DN10,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM10,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10, $DB10), 1),\n\n  DW, $DR10,\n  CL, $DS10,\n  SM, $DT10,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY10*(DE10*OtherDamage*SL+UWDamage*DF10)))",
    "EE10": "IF(INDEX($BI$6:$BI155,BY10)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK10, 0),\n  CF, $DB10,\n  CC, $CZ10,\n  CCUW, $DA10,\n  SCM, $DD10,\n  SCC, $AV$17+INDEX($BI$5:$BI155,BY10+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY10 * (Critical*DO10*$DQ10+DW10*UWCritical)))",
    "EF10": "IF(INDEX($BJ$6:$BJ155,BZ10)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK10*1%, 1),\n  CF, $DB10,\n  CC, $CZ10,\n  CCUW, $DA10,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ155,BZ10+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC10,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY10*(Critical*DO10*$DQ10+DW10*UWCritical)))",
    "EG10": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK155,CA10)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH10,\n  Rapid, DG10,\n  DPM, (1+$DI10*$DJ10*$AQ$9),\n  Rend, $DN10,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK155,CA10+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM10*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10, $DB10), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK155,CA10+1)-1))/(45-CM10*3),1),\n\n  SL, $DQ10,\n  DW, $DR10,\n  CL, $DS10,\n  SM, $DT10,\n  SLM, $DU10,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY10*(DE10*OtherDamage*SL+UwDamage*DF10)))",
    "EH10": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL155,CB10+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL155,CB10)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH10,\n  Rapid, DG10,\n  DPM, (1+$DI10*$DJ10*$AQ$9),\n  SuperTower, $DL10,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL155,CB10+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY10*(DE10*OtherDamage*$DQ10+DW10*DF10)))",
    "EI10": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM155,CC10)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10, $DB10), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK10),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV10, $AR$29), 0),\n\n  DW, $DR10,\n  CL, $DS10,\n  SM, $DT10,\n  SL, $DQ10,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM10, UltCritCard),\nCY10*(DE10*DO10*SL+UwDamage*DF10)))",
    "EJ10": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN155,CD10)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT10,\n  DamageMastery, $CS10,\n  DemonMastery, $CX10,\n  SPB, INDEX($BN$5:$BN155,CD10+1),\n  ITO, $CV10,\n  Shock, $CW10,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE10*DO10*$DQ10+DW10*DF10)))",
    "EK10": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO155,CE10)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT10,\n  DamageMastery, $CS10,\n  DemonMastery, $CX10,\n  SPB, $CU10,\n  ITO, INDEX($BO$5:$BO155,CE10+1),\n  Shock, $CW10,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE10*DO10*$DQ10+DW10*DF10)))",
    "EL10": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP155,CF10)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10, $DB10), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP10),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF10),\n  CL, $DS10,\n  SM, $DT10,\n  SLM, $DU10,\n  SL, $DQ10,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM10, UltCritCard),\nCY10*(DE10*DO10*SL+UwDamage*DF10)))",
    "EM10": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ155,CG10)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG10+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN10": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR155,CH10)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10, $DB10), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH10+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP10),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK10),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM155,CC10), SMHeat, $AR$29), 0),\n\n  DW, $DR10,\n  CL, $DS10,\n  SL, $DQ10,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM10, UltCritCard),\nCY10*(DE10*DO10*SL+UwDamage*DF10)))",
    "EO10": "IF(OR(CI10 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI10+1))",
    "EP10": "IF(OR($AO$25, CJ10 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ10+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE154,BU10),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL10, 1),\n  DPM, (1+$DI10*CardRangeMastery*$DJ10*$AQ$9),\n  SuperTower, $DL10,\n  Rend, $DN10,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10, $DB10), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR10,\n  SM, $DT10,\n  SLM, $DU10,\n  SL, $DQ10,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM10, UltCritCard),\n\nCY10*(DE10*OtherDamage*SL+UwDamage*DF10)))",
    "EQ10": "IF(OR(CK10 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK10+1)*1%, 1),\n  CF, $DB10,\n  CC, MIN(100%, $CZ10 + 1%),\n  CCUW, DA10 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ155,BZ10) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC10 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR10,\n  CL, $DS10,\n  SM, $DT10,\n  SLM, $DU10,\n  SL, $DQ10,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM10, UltCritCard),\n\nCY10 * (Critical*DO10*SL+UwDamage*UWCritical)))",
    "ER10": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL10 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH155,BX10),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL10+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI10*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM155,CC10), $DV10, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH10,\n  Rapid, DG10,\n  SuperTower, $DL10,\n  Rend, $DN10,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM10,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10, $DB10), 1),\n\n  DW, $DR10,\n  CL, $DS10,\n  SM, $DT10,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY10*(DE10*OtherDamage*SL+UWDamage*DF10)))",
    "ES10": "IF(OR(CM10 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH10,\n  Rapid, DG10,\n  RDPM, (1+$DI10*$DJ10*$AQ$9),\n  Rend, $DN10,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK155,CA10),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM10+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10, $DB10), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR10,\n  CL, $DS10,\n  SM, $DT10,\n  SLM, $DU10,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY10*(DE10*OtherDamage*SL+UwDamage*DF10)))",
    "ET10": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN10 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM10,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN10+1, $DB10), 1),\n\n  DW, $DR10,\n  CL, $DS10,\n  SM, $DT10,\n  SLM, $DU10,\n  SL, $DQ10,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY10*(DE10*DO10*SL+UWDamage*DF10)))",
    "EU10": "IF(OR(NOT($BA$3), NOT($BA$23), $CO10 > $BA$15), \"\", 1 + 0.5*(CO10+1))",
    "EW10": "IF(DZ10=\"\", \"\", LET(\n  Now, CT10,\n  Next, DZ10,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT10),\nFactor/Cost))",
    "EX10": "IF(EA10=\"\",\"\",(EA10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU10))",
    "EY10": "IF(EB10=\"\",\"\",(EB10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV10))",
    "EZ10": "IF(EC10=\"\",\"\",(EC10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW10))",
    "FA10": "IF(ED10=\"\",\"\",(ED10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX10))",
    "FB10": "IF(EE10=\"\",\"\",(EE10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY10))",
    "FC10": "IF(EF10=\"\",\"\",(EF10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ10))",
    "FD10": "IF(EG10=\"\",\"\",(EG10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA10))",
    "FE10": "IF(EH10=\"\",\"\",(EH10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB10))",
    "FF10": "IF(EI10=\"\",\"\",(EI10/$DX10-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC10+1, 1, CC10))))",
    "FG10": "IF(EJ10=\"\",\"\",(EJ10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD10))",
    "FH10": "IF(EK10=\"\",\"\",(EK10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE10))",
    "FI10": "IF(EL10=\"\",\"\",(EL10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF10))",
    "FJ10": "IF(EM10=\"\", \"\", LET(\n  Now, CW10,\n  Next, EM10,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG10),\nFactor/Cost))",
    "FK10": "IF(EN10=\"\",\"\",(EN10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH10))",
    "FL10": "IF(EO10=\"\", \"\", LET(\n  Now, CS10,\n  Next, EO10,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI10),\nFactor/Cost))",
    "FM10": "IF(EP10=\"\",\"\",(EP10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ10))",
    "FN10": "IF(EQ10=\"\",\"\",(EQ10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK10))",
    "FO10": "IF(ER10=\"\",\"\",(ER10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL10))",
    "FP10": "IF(ES10=\"\",\"\",(ES10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM10))",
    "FQ10": "IF(ET10=\"\",\"\",(ET10/$DX10-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN10))",
    "FR10": "IF(EU10=\"\", \"\", LET(\n  Now, CX10,\n  Next, EU10,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO10),\nFactor/Cost))",
    "FT10": "IF(COLUMN(EW10:FR10) = MIN(IF(EW10:FR10=MAX(EW10:FR10), COLUMN(EW10:FR10))), 1, \"\")",
    "D11": "IF(SUM(FT10:GP10),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F11)),\"Card Mastery\",F11),G11)/$D$5,\"\")",
    "F11": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT10:GP10),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT10:GP10=1)),)\"),\"Attack Speed\")",
    "G11": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT10:GP10),ARRAYFORMULA(FILTER(BT10:CP10 , FT10:GP10=1)),\"\"\"\")\"),2.0)",
    "I11": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT10:GP10),ARRAYFORMULA(FILTER(EW10:FS10 , FT10:GP10=1))*D$5,\"\"\"\")\"),4.472646207971154)",
    "K11": "IF(H11<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D11)),)",
    "AD11": "IF(EQ(AE11, 10%), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE11=0, 3%, AE11=3%, 5%, AE11=5%, 7%, AE11=7%, 10%), Epic, 3%, Legendary, 5%, Mythic, 7%, Ancestral, 10%), 0),\n\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK5, 0),\n\n  CF, $DB5,\n  CC, MIN(100%, $CZ5),\n  CCUW, $DA5,\n  SCC, AN17 + Planner +INDEX($BI$5:$BI150,BY5) + CardCritMastery,\n  SCM, $DD5,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  eDMG, CY5 * (Critical*DO5*DQ5+DW5*UWCritical),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE11": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC11,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AL11": "MAX('Master Sheet'!I8:J8)",
    "AN11": "AL11*0.5%",
    "AT11": "AN11+AE14",
    "AY11": "'Master Sheet'!AB30",
    "AZ11": "FLOOR(200/3 + RIGHT(AY11,1) * 100/3,1)/10000",
    "BC11": "BC10+1",
    "BD11": "BD10+BD$3",
    "BE11": "BE10+BE$3",
    "BF11": "BF10+BF$3",
    "BG11": "BG10+BG$3",
    "BH11": "BH10+BH$3",
    "BI11": "BI10+BI$3",
    "BJ11": "BJ10+BJ$3",
    "BK11": "BK10+BK$3",
    "BL11": "BL10+BL$3",
    "BM11": "BM10+BM$3",
    "BN11": "BN10+BN$3",
    "BO11": "BO10+BO$3",
    "BP11": "BP10+BP$3",
    "BQ11": "BQ10+BQ$3",
    "BR11": "BR10+BR$3",
    "BT11": "BT10+FT10",
    "BU11": "BU10+FU10",
    "BV11": "BV10+FV10",
    "BW11": "BW10+FW10",
    "BX11": "BX10+FX10",
    "BY11": "BY10+FY10",
    "BZ11": "BZ10+FZ10",
    "CA11": "CA10+GA10",
    "CB11": "CB10+GB10",
    "CC11": "CC10+GC10",
    "CD11": "CD10+GD10",
    "CE11": "CE10+GE10",
    "CF11": "CF10+GF10",
    "CG11": "CG10+GG10",
    "CH11": "CH10+GH10",
    "CI11": "CI10+GI10",
    "CJ11": "CJ10+GJ10",
    "CK11": "CK10+GK10",
    "CL11": "CL10+GL10",
    "CM11": "CM10+GM10",
    "CN11": "CN10+GN10",
    "CO11": "CO10+GO10",
    "CR11": "(1 + SUM($AT$15^(SEQUENCE($AT$16, 1, 1, 1)) * 1^SEQUENCE($AT$16, 1, 1, 1)))",
    "CS11": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI11,1)",
    "CT11": "INDEX($BD$5:$BD156,BT11)",
    "CU11": "INDEX($BN$5:$BN156,CD11)",
    "CV11": "INDEX($BO$5:$BO156,CE11)",
    "CW11": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG11)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX11": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO11, 1)",
    "CY11": "LET(\n  Base, $CR$6,\n  Damage, $CT11,\n  DamageMastery, $CS11,\n  DemonMastery, $CX11,\n  SPB, $CU11,\n  ITO, $CV11,\n  Shock, $CW11,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ11": "MIN(100%, DA11)",
    "DA11": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK11*1%, 0)",
    "DB11": "LET(\n  Lab, 1+INDEX($BF$5:$BF156,BV11),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC11": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK11*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI156,BY11) + CardCritMastery)",
    "DD11": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK11*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ156,BZ11) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE11": "LET(\n  CF, $DB11,\n  CC, $CZ11,\n  SCM, $DD11,\n  SCC, $DC11,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF11": "LET(\n  CF, $DB11,\n  CC, $DA11,\n  SCM, $DD11,\n  SCC, $DC11,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG11": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH11)), 0)",
    "DH11": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ11*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE156,BU11),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI11": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG156, BW11), 1) + $AE$9)",
    "DJ11": "LET(\n  DpmLab, INDEX($BH$5:$BH156,BX11),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL11, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK11": "(1+$DI11*$DJ11*$AQ$9)",
    "DL11": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK156,CA11),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM11*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM11": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK156,CA11),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM11*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN11": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL156,CB11)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO11": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH11,\n  Rapid, DG11,\n  RDPM, DK11,\n  SuperTower, $DL11,\n  Rend, $DN11,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP11": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ11": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK11),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR11": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP11),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF11-1))",
    "DS11": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG11, DH11),0))",
    "DT11": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP11),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV11, $AR$29), 0))",
    "DU11": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK11),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM156,CC11), $DV11, $AR$29), 0))",
    "DV11": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH11), $AO$29)",
    "DW11": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM11,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11, $DB11), 1),\n\n  DW, $DR11,\n  CL, $DS11,\n  SM, $DT11,\n  SLM, $DU11,\n  SL, $DQ11,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX11": "CY11*(DE11*DO11*DQ11+DW11*DF11)",
    "DZ11": "IF(INDEX($BD$6:$BD156,BT11)=\"\", \"\", INDEX($BD$5:$BD156,BT11+1))",
    "EA11": "IF(OR($AO$25, INDEX($BE$6:$BE156,BU11)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ11)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE156,BU11+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI11*$DJ11*$AQ$9),\n  SuperTower, $DL11,\n  Rend, $DN11,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11, $DB11), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR11,\n  SM, $DT11,\n  SLM, $DU11,\n  SL, $DQ11,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM11, UltCritCard),\n\nCY11*(DE11*OtherDamage*SL+UwDamage*DF11)))",
    "EB11": "IF(INDEX($BF$6:$BF156,BV11)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF156,BV11+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ11,\n  CCUW, $DA11,\n  SCM, $DD11,\n  SCC, $DC11,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11, CF), 1),\n\n  DW, $DR11,\n  CL, $DS11,\n  SM, $DT11,\n  SLM, $DU11,\n  SL, $DQ11,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM11, UltCritCard),\n\nCY11 * (Critical * DO11 * SL + UwDamage * UWCritical)))",
    "EC11": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG156,BW11)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH11,\n  Rapid, DG11,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG156, BW11+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ11*$AQ$9),\n  SuperTower, $DL11,\n  Rend, $DN11,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM156,CC11), $DV11, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM11,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11, $DB11), 1),\n\n  DW, $DR11,\n  CL, $DS11,\n  SM, $DT11,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY11*(DE11*OtherDamage*SL+UWDamage*DF11)))",
    "ED11": "IF(OR($AO$25, INDEX($BH$6:$BH156,BX11)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH156,BX11+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL11, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI11*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM156,CC11), $DV11, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH11,\n  Rapid, DG11,\n  SuperTower, $DL11,\n  Rend, $DN11,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM11,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11, $DB11), 1),\n\n  DW, $DR11,\n  CL, $DS11,\n  SM, $DT11,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY11*(DE11*OtherDamage*SL+UWDamage*DF11)))",
    "EE11": "IF(INDEX($BI$6:$BI156,BY11)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK11, 0),\n  CF, $DB11,\n  CC, $CZ11,\n  CCUW, $DA11,\n  SCM, $DD11,\n  SCC, $AV$17+INDEX($BI$5:$BI156,BY11+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY11 * (Critical*DO11*$DQ11+DW11*UWCritical)))",
    "EF11": "IF(INDEX($BJ$6:$BJ156,BZ11)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK11*1%, 1),\n  CF, $DB11,\n  CC, $CZ11,\n  CCUW, $DA11,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ156,BZ11+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC11,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY11*(Critical*DO11*$DQ11+DW11*UWCritical)))",
    "EG11": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK156,CA11)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH11,\n  Rapid, DG11,\n  DPM, (1+$DI11*$DJ11*$AQ$9),\n  Rend, $DN11,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK156,CA11+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM11*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11, $DB11), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK156,CA11+1)-1))/(45-CM11*3),1),\n\n  SL, $DQ11,\n  DW, $DR11,\n  CL, $DS11,\n  SM, $DT11,\n  SLM, $DU11,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY11*(DE11*OtherDamage*SL+UwDamage*DF11)))",
    "EH11": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL156,CB11+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL156,CB11)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH11,\n  Rapid, DG11,\n  DPM, (1+$DI11*$DJ11*$AQ$9),\n  SuperTower, $DL11,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL156,CB11+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY11*(DE11*OtherDamage*$DQ11+DW11*DF11)))",
    "EI11": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM156,CC11)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11, $DB11), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK11),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV11, $AR$29), 0),\n\n  DW, $DR11,\n  CL, $DS11,\n  SM, $DT11,\n  SL, $DQ11,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM11, UltCritCard),\nCY11*(DE11*DO11*SL+UwDamage*DF11)))",
    "EJ11": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN156,CD11)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT11,\n  DamageMastery, $CS11,\n  DemonMastery, $CX11,\n  SPB, INDEX($BN$5:$BN156,CD11+1),\n  ITO, $CV11,\n  Shock, $CW11,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE11*DO11*$DQ11+DW11*DF11)))",
    "EK11": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO156,CE11)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT11,\n  DamageMastery, $CS11,\n  DemonMastery, $CX11,\n  SPB, $CU11,\n  ITO, INDEX($BO$5:$BO156,CE11+1),\n  Shock, $CW11,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE11*DO11*$DQ11+DW11*DF11)))",
    "EL11": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP156,CF11)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11, $DB11), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP11),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF11),\n  CL, $DS11,\n  SM, $DT11,\n  SLM, $DU11,\n  SL, $DQ11,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM11, UltCritCard),\nCY11*(DE11*DO11*SL+UwDamage*DF11)))",
    "EM11": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ156,CG11)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG11+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN11": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR156,CH11)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11, $DB11), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH11+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP11),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK11),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM156,CC11), SMHeat, $AR$29), 0),\n\n  DW, $DR11,\n  CL, $DS11,\n  SL, $DQ11,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM11, UltCritCard),\nCY11*(DE11*DO11*SL+UwDamage*DF11)))",
    "EO11": "IF(OR(CI11 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI11+1))",
    "EP11": "IF(OR($AO$25, CJ11 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ11+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE155,BU11),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL11, 1),\n  DPM, (1+$DI11*CardRangeMastery*$DJ11*$AQ$9),\n  SuperTower, $DL11,\n  Rend, $DN11,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11, $DB11), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR11,\n  SM, $DT11,\n  SLM, $DU11,\n  SL, $DQ11,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM11, UltCritCard),\n\nCY11*(DE11*OtherDamage*SL+UwDamage*DF11)))",
    "EQ11": "IF(OR(CK11 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK11+1)*1%, 1),\n  CF, $DB11,\n  CC, MIN(100%, $CZ11 + 1%),\n  CCUW, DA11 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ156,BZ11) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC11 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR11,\n  CL, $DS11,\n  SM, $DT11,\n  SLM, $DU11,\n  SL, $DQ11,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM11, UltCritCard),\n\nCY11 * (Critical*DO11*SL+UwDamage*UWCritical)))",
    "ER11": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL11 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH156,BX11),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL11+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI11*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM156,CC11), $DV11, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH11,\n  Rapid, DG11,\n  SuperTower, $DL11,\n  Rend, $DN11,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM11,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11, $DB11), 1),\n\n  DW, $DR11,\n  CL, $DS11,\n  SM, $DT11,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY11*(DE11*OtherDamage*SL+UWDamage*DF11)))",
    "ES11": "IF(OR(CM11 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH11,\n  Rapid, DG11,\n  RDPM, (1+$DI11*$DJ11*$AQ$9),\n  Rend, $DN11,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK156,CA11),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM11+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11, $DB11), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR11,\n  CL, $DS11,\n  SM, $DT11,\n  SLM, $DU11,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY11*(DE11*OtherDamage*SL+UwDamage*DF11)))",
    "ET11": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN11 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM11,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN11+1, $DB11), 1),\n\n  DW, $DR11,\n  CL, $DS11,\n  SM, $DT11,\n  SLM, $DU11,\n  SL, $DQ11,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY11*(DE11*DO11*SL+UWDamage*DF11)))",
    "EU11": "IF(OR(NOT($BA$3), NOT($BA$23), $CO11 > $BA$15), \"\", 1 + 0.5*(CO11+1))",
    "EW11": "IF(DZ11=\"\", \"\", LET(\n  Now, CT11,\n  Next, DZ11,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT11),\nFactor/Cost))",
    "EX11": "IF(EA11=\"\",\"\",(EA11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU11))",
    "EY11": "IF(EB11=\"\",\"\",(EB11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV11))",
    "EZ11": "IF(EC11=\"\",\"\",(EC11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW11))",
    "FA11": "IF(ED11=\"\",\"\",(ED11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX11))",
    "FB11": "IF(EE11=\"\",\"\",(EE11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY11))",
    "FC11": "IF(EF11=\"\",\"\",(EF11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ11))",
    "FD11": "IF(EG11=\"\",\"\",(EG11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA11))",
    "FE11": "IF(EH11=\"\",\"\",(EH11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB11))",
    "FF11": "IF(EI11=\"\",\"\",(EI11/$DX11-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC11+1, 1, CC11))))",
    "FG11": "IF(EJ11=\"\",\"\",(EJ11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD11))",
    "FH11": "IF(EK11=\"\",\"\",(EK11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE11))",
    "FI11": "IF(EL11=\"\",\"\",(EL11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF11))",
    "FJ11": "IF(EM11=\"\", \"\", LET(\n  Now, CW11,\n  Next, EM11,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG11),\nFactor/Cost))",
    "FK11": "IF(EN11=\"\",\"\",(EN11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH11))",
    "FL11": "IF(EO11=\"\", \"\", LET(\n  Now, CS11,\n  Next, EO11,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI11),\nFactor/Cost))",
    "FM11": "IF(EP11=\"\",\"\",(EP11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ11))",
    "FN11": "IF(EQ11=\"\",\"\",(EQ11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK11))",
    "FO11": "IF(ER11=\"\",\"\",(ER11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL11))",
    "FP11": "IF(ES11=\"\",\"\",(ES11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM11))",
    "FQ11": "IF(ET11=\"\",\"\",(ET11/$DX11-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN11))",
    "FR11": "IF(EU11=\"\", \"\", LET(\n  Now, CX11,\n  Next, EU11,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO11),\nFactor/Cost))",
    "FT11": "IF(COLUMN(EW11:FR11) = MIN(IF(EW11:FR11=MAX(EW11:FR11), COLUMN(EW11:FR11))), 1, \"\")",
    "D12": "IF(SUM(FT11:GP11),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F12)),\"Card Mastery\",F12),G12)/$D$5,\"\")",
    "F12": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT11:GP11),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT11:GP11=1)),)\"),\"Damage\")",
    "G12": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT11:GP11),ARRAYFORMULA(FILTER(BT11:CP11 , FT11:GP11=1)),\"\"\"\")\"),2.0)",
    "I12": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT11:GP11),ARRAYFORMULA(FILTER(EW11:FS11 , FT11:GP11=1))*D$5,\"\"\"\")\"),4.411764705882337)",
    "K12": "IF(H12<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D12)),)",
    "AD12": "IF(EQ(AE12, 7), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE12=0, 2, AE12=2, 3, AE12=3, 5, AE12=5, 7), Epic, 2, Legendary, 3, Mythic, 5, Ancestral, 7), 0),\n\n\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK5*1%, 1),\n\n  CF, $DB5,\n  CC, $CZ5,\n  CCUW, $DA5,\n  SCC, $DC5,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ150,BZ5) + Planner) * $AQ$18) * (CardCritMastery),\n\n\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  eDMG, CY5 * (Critical*DO5*DQ5+DW5*UWCritical),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE12": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC12,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AL12": "MAX('Master Sheet'!I9:J9)",
    "AN12": "2+AL12",
    "AT12": "AN12+AE15",
    "AY12": "'Master Sheet'!AB21",
    "AZ12": "12% + RIGHT(AY12,1) * 3%",
    "BC12": "BC11+1",
    "BD12": "BD11+BD$3",
    "BE12": "BE11+BE$3",
    "BF12": "BF11+BF$3",
    "BG12": "BG11+BG$3",
    "BH12": "BH11+BH$3",
    "BI12": "BI11+BI$3",
    "BJ12": "BJ11+BJ$3",
    "BK12": "BK11+BK$3",
    "BL12": "BL11+BL$3",
    "BM12": "BM11+BM$3",
    "BN12": "BN11+BN$3",
    "BO12": "BO11+BO$3",
    "BP12": "BP11+BP$3",
    "BQ12": "BQ11+BQ$3",
    "BR12": "BR11+BR$3",
    "BT12": "BT11+FT11",
    "BU12": "BU11+FU11",
    "BV12": "BV11+FV11",
    "BW12": "BW11+FW11",
    "BX12": "BX11+FX11",
    "BY12": "BY11+FY11",
    "BZ12": "BZ11+FZ11",
    "CA12": "CA11+GA11",
    "CB12": "CB11+GB11",
    "CC12": "CC11+GC11",
    "CD12": "CD11+GD11",
    "CE12": "CE11+GE11",
    "CF12": "CF11+GF11",
    "CG12": "CG11+GG11",
    "CH12": "CH11+GH11",
    "CI12": "CI11+GI11",
    "CJ12": "CJ11+GJ11",
    "CK12": "CK11+GK11",
    "CL12": "CL11+GL11",
    "CM12": "CM11+GM11",
    "CN12": "CN11+GN11",
    "CO12": "CO11+GO11",
    "CS12": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI12,1)",
    "CT12": "INDEX($BD$5:$BD157,BT12)",
    "CU12": "INDEX($BN$5:$BN157,CD12)",
    "CV12": "INDEX($BO$5:$BO157,CE12)",
    "CW12": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG12)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX12": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO12, 1)",
    "CY12": "LET(\n  Base, $CR$6,\n  Damage, $CT12,\n  DamageMastery, $CS12,\n  DemonMastery, $CX12,\n  SPB, $CU12,\n  ITO, $CV12,\n  Shock, $CW12,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ12": "MIN(100%, DA12)",
    "DA12": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK12*1%, 0)",
    "DB12": "LET(\n  Lab, 1+INDEX($BF$5:$BF157,BV12),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC12": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK12*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI157,BY12) + CardCritMastery)",
    "DD12": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK12*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ157,BZ12) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE12": "LET(\n  CF, $DB12,\n  CC, $CZ12,\n  SCM, $DD12,\n  SCC, $DC12,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF12": "LET(\n  CF, $DB12,\n  CC, $DA12,\n  SCM, $DD12,\n  SCC, $DC12,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG12": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH12)), 0)",
    "DH12": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ12*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE157,BU12),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI12": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG157, BW12), 1) + $AE$9)",
    "DJ12": "LET(\n  DpmLab, INDEX($BH$5:$BH157,BX12),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL12, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK12": "(1+$DI12*$DJ12*$AQ$9)",
    "DL12": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK157,CA12),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM12*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM12": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK157,CA12),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM12*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN12": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL157,CB12)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO12": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH12,\n  Rapid, DG12,\n  RDPM, DK12,\n  SuperTower, $DL12,\n  Rend, $DN12,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP12": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ12": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK12),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR12": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP12),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF12-1))",
    "DS12": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG12, DH12),0))",
    "DT12": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP12),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV12, $AR$29), 0))",
    "DU12": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK12),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM157,CC12), $DV12, $AR$29), 0))",
    "DV12": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH12), $AO$29)",
    "DW12": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM12,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12, $DB12), 1),\n\n  DW, $DR12,\n  CL, $DS12,\n  SM, $DT12,\n  SLM, $DU12,\n  SL, $DQ12,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX12": "CY12*(DE12*DO12*DQ12+DW12*DF12)",
    "DZ12": "IF(INDEX($BD$6:$BD157,BT12)=\"\", \"\", INDEX($BD$5:$BD157,BT12+1))",
    "EA12": "IF(OR($AO$25, INDEX($BE$6:$BE157,BU12)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ12)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE157,BU12+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI12*$DJ12*$AQ$9),\n  SuperTower, $DL12,\n  Rend, $DN12,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12, $DB12), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR12,\n  SM, $DT12,\n  SLM, $DU12,\n  SL, $DQ12,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM12, UltCritCard),\n\nCY12*(DE12*OtherDamage*SL+UwDamage*DF12)))",
    "EB12": "IF(INDEX($BF$6:$BF157,BV12)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF157,BV12+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ12,\n  CCUW, $DA12,\n  SCM, $DD12,\n  SCC, $DC12,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12, CF), 1),\n\n  DW, $DR12,\n  CL, $DS12,\n  SM, $DT12,\n  SLM, $DU12,\n  SL, $DQ12,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM12, UltCritCard),\n\nCY12 * (Critical * DO12 * SL + UwDamage * UWCritical)))",
    "EC12": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG157,BW12)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH12,\n  Rapid, DG12,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG157, BW12+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ12*$AQ$9),\n  SuperTower, $DL12,\n  Rend, $DN12,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM157,CC12), $DV12, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM12,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12, $DB12), 1),\n\n  DW, $DR12,\n  CL, $DS12,\n  SM, $DT12,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY12*(DE12*OtherDamage*SL+UWDamage*DF12)))",
    "ED12": "IF(OR($AO$25, INDEX($BH$6:$BH157,BX12)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH157,BX12+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL12, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI12*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM157,CC12), $DV12, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH12,\n  Rapid, DG12,\n  SuperTower, $DL12,\n  Rend, $DN12,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM12,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12, $DB12), 1),\n\n  DW, $DR12,\n  CL, $DS12,\n  SM, $DT12,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY12*(DE12*OtherDamage*SL+UWDamage*DF12)))",
    "EE12": "IF(INDEX($BI$6:$BI157,BY12)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK12, 0),\n  CF, $DB12,\n  CC, $CZ12,\n  CCUW, $DA12,\n  SCM, $DD12,\n  SCC, $AV$17+INDEX($BI$5:$BI157,BY12+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY12 * (Critical*DO12*$DQ12+DW12*UWCritical)))",
    "EF12": "IF(INDEX($BJ$6:$BJ157,BZ12)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK12*1%, 1),\n  CF, $DB12,\n  CC, $CZ12,\n  CCUW, $DA12,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ157,BZ12+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC12,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY12*(Critical*DO12*$DQ12+DW12*UWCritical)))",
    "EG12": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK157,CA12)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH12,\n  Rapid, DG12,\n  DPM, (1+$DI12*$DJ12*$AQ$9),\n  Rend, $DN12,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK157,CA12+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM12*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12, $DB12), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK157,CA12+1)-1))/(45-CM12*3),1),\n\n  SL, $DQ12,\n  DW, $DR12,\n  CL, $DS12,\n  SM, $DT12,\n  SLM, $DU12,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY12*(DE12*OtherDamage*SL+UwDamage*DF12)))",
    "EH12": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL157,CB12+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL157,CB12)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH12,\n  Rapid, DG12,\n  DPM, (1+$DI12*$DJ12*$AQ$9),\n  SuperTower, $DL12,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL157,CB12+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY12*(DE12*OtherDamage*$DQ12+DW12*DF12)))",
    "EI12": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM157,CC12)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12, $DB12), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK12),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV12, $AR$29), 0),\n\n  DW, $DR12,\n  CL, $DS12,\n  SM, $DT12,\n  SL, $DQ12,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM12, UltCritCard),\nCY12*(DE12*DO12*SL+UwDamage*DF12)))",
    "EJ12": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN157,CD12)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT12,\n  DamageMastery, $CS12,\n  DemonMastery, $CX12,\n  SPB, INDEX($BN$5:$BN157,CD12+1),\n  ITO, $CV12,\n  Shock, $CW12,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE12*DO12*$DQ12+DW12*DF12)))",
    "EK12": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO157,CE12)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT12,\n  DamageMastery, $CS12,\n  DemonMastery, $CX12,\n  SPB, $CU12,\n  ITO, INDEX($BO$5:$BO157,CE12+1),\n  Shock, $CW12,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE12*DO12*$DQ12+DW12*DF12)))",
    "EL12": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP157,CF12)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12, $DB12), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP12),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF12),\n  CL, $DS12,\n  SM, $DT12,\n  SLM, $DU12,\n  SL, $DQ12,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM12, UltCritCard),\nCY12*(DE12*DO12*SL+UwDamage*DF12)))",
    "EM12": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ157,CG12)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG12+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN12": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR157,CH12)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12, $DB12), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH12+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP12),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK12),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM157,CC12), SMHeat, $AR$29), 0),\n\n  DW, $DR12,\n  CL, $DS12,\n  SL, $DQ12,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM12, UltCritCard),\nCY12*(DE12*DO12*SL+UwDamage*DF12)))",
    "EO12": "IF(OR(CI12 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI12+1))",
    "EP12": "IF(OR($AO$25, CJ12 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ12+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE156,BU12),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL12, 1),\n  DPM, (1+$DI12*CardRangeMastery*$DJ12*$AQ$9),\n  SuperTower, $DL12,\n  Rend, $DN12,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12, $DB12), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR12,\n  SM, $DT12,\n  SLM, $DU12,\n  SL, $DQ12,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM12, UltCritCard),\n\nCY12*(DE12*OtherDamage*SL+UwDamage*DF12)))",
    "EQ12": "IF(OR(CK12 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK12+1)*1%, 1),\n  CF, $DB12,\n  CC, MIN(100%, $CZ12 + 1%),\n  CCUW, DA12 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ157,BZ12) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC12 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR12,\n  CL, $DS12,\n  SM, $DT12,\n  SLM, $DU12,\n  SL, $DQ12,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM12, UltCritCard),\n\nCY12 * (Critical*DO12*SL+UwDamage*UWCritical)))",
    "ER12": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL12 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH157,BX12),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL12+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI12*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM157,CC12), $DV12, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH12,\n  Rapid, DG12,\n  SuperTower, $DL12,\n  Rend, $DN12,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM12,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12, $DB12), 1),\n\n  DW, $DR12,\n  CL, $DS12,\n  SM, $DT12,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY12*(DE12*OtherDamage*SL+UWDamage*DF12)))",
    "ES12": "IF(OR(CM12 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH12,\n  Rapid, DG12,\n  RDPM, (1+$DI12*$DJ12*$AQ$9),\n  Rend, $DN12,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK157,CA12),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM12+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12, $DB12), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR12,\n  CL, $DS12,\n  SM, $DT12,\n  SLM, $DU12,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY12*(DE12*OtherDamage*SL+UwDamage*DF12)))",
    "ET12": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN12 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM12,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN12+1, $DB12), 1),\n\n  DW, $DR12,\n  CL, $DS12,\n  SM, $DT12,\n  SLM, $DU12,\n  SL, $DQ12,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY12*(DE12*DO12*SL+UWDamage*DF12)))",
    "EU12": "IF(OR(NOT($BA$3), NOT($BA$23), $CO12 > $BA$15), \"\", 1 + 0.5*(CO12+1))",
    "EW12": "IF(DZ12=\"\", \"\", LET(\n  Now, CT12,\n  Next, DZ12,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT12),\nFactor/Cost))",
    "EX12": "IF(EA12=\"\",\"\",(EA12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU12))",
    "EY12": "IF(EB12=\"\",\"\",(EB12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV12))",
    "EZ12": "IF(EC12=\"\",\"\",(EC12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW12))",
    "FA12": "IF(ED12=\"\",\"\",(ED12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX12))",
    "FB12": "IF(EE12=\"\",\"\",(EE12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY12))",
    "FC12": "IF(EF12=\"\",\"\",(EF12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ12))",
    "FD12": "IF(EG12=\"\",\"\",(EG12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA12))",
    "FE12": "IF(EH12=\"\",\"\",(EH12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB12))",
    "FF12": "IF(EI12=\"\",\"\",(EI12/$DX12-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC12+1, 1, CC12))))",
    "FG12": "IF(EJ12=\"\",\"\",(EJ12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD12))",
    "FH12": "IF(EK12=\"\",\"\",(EK12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE12))",
    "FI12": "IF(EL12=\"\",\"\",(EL12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF12))",
    "FJ12": "IF(EM12=\"\", \"\", LET(\n  Now, CW12,\n  Next, EM12,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG12),\nFactor/Cost))",
    "FK12": "IF(EN12=\"\",\"\",(EN12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH12))",
    "FL12": "IF(EO12=\"\", \"\", LET(\n  Now, CS12,\n  Next, EO12,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI12),\nFactor/Cost))",
    "FM12": "IF(EP12=\"\",\"\",(EP12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ12))",
    "FN12": "IF(EQ12=\"\",\"\",(EQ12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK12))",
    "FO12": "IF(ER12=\"\",\"\",(ER12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL12))",
    "FP12": "IF(ES12=\"\",\"\",(ES12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM12))",
    "FQ12": "IF(ET12=\"\",\"\",(ET12/$DX12-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN12))",
    "FR12": "IF(EU12=\"\", \"\", LET(\n  Now, CX12,\n  Next, EU12,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO12),\nFactor/Cost))",
    "FT12": "IF(COLUMN(EW12:FR12) = MIN(IF(EW12:FR12=MAX(EW12:FR12), COLUMN(EW12:FR12))), 1, \"\")",
    "D13": "IF(SUM(FT12:GP12),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F13)),\"Card Mastery\",F13),G13)/$D$5,\"\")",
    "F13": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT12:GP12),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT12:GP12=1)),)\"),\"Critical Factor\")",
    "G13": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT12:GP12),ARRAYFORMULA(FILTER(BT12:CP12 , FT12:GP12=1)),\"\"\"\")\"),3.0)",
    "I13": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT12:GP12),ARRAYFORMULA(FILTER(EW12:FS12 , FT12:GP12=1))*D$5,\"\"\"\")\"),2.4717108584846184)",
    "K13": "IF(H13<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D13)),)",
    "AD13": "IF(EQ(AE13, 5), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE13=0, 2, AE13=2, 3, AE13=3, 5), Legendary, 2, Mythic, 3, Ancestral, 5), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR10,\n  AtkSpeed, $DH5,\n  Rapid, $DG$5,\n  RDPM, DK5,\n  SuperTower, $DL5,\n  Rend, IF($AH$19, (Planner+INDEX($BL$5:$BL150,CB5)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * CappedRend,\n  \n  eDMG, CY5*(DE5*OtherDamage*DQ5+DW5*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE13": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC13,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AL13": "MAX('Master Sheet'!I10:J10)",
    "AN13": "AL13*0.4%",
    "AT13": "AN13+AE16",
    "AY13": "'Master Sheet'!AB28",
    "AZ13": "26% + RIGHT(AY13,1) * 4%",
    "BC13": "BC12+1",
    "BD13": "BD12+BD$3",
    "BE13": "BE12+BE$3",
    "BF13": "BF12+BF$3",
    "BG13": "BG12+BG$3",
    "BH13": "BH12+BH$3",
    "BI13": "BI12+BI$3",
    "BJ13": "BJ12+BJ$3",
    "BK13": "BK12+BK$3",
    "BL13": "BL12+BL$3",
    "BM13": "BM12+BM$3",
    "BN13": "BN12+BN$3",
    "BO13": "BO12+BO$3",
    "BP13": "BP12+BP$3",
    "BQ13": "BQ12+BQ$3",
    "BR13": "BR12+BR$3",
    "BT13": "BT12+FT12",
    "BU13": "BU12+FU12",
    "BV13": "BV12+FV12",
    "BW13": "BW12+FW12",
    "BX13": "BX12+FX12",
    "BY13": "BY12+FY12",
    "BZ13": "BZ12+FZ12",
    "CA13": "CA12+GA12",
    "CB13": "CB12+GB12",
    "CC13": "CC12+GC12",
    "CD13": "CD12+GD12",
    "CE13": "CE12+GE12",
    "CF13": "CF12+GF12",
    "CG13": "CG12+GG12",
    "CH13": "CH12+GH12",
    "CI13": "CI12+GI12",
    "CJ13": "CJ12+GJ12",
    "CK13": "CK12+GK12",
    "CL13": "CL12+GL12",
    "CM13": "CM12+GM12",
    "CN13": "CN12+GN12",
    "CO13": "CO12+GO12",
    "CS13": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI13,1)",
    "CT13": "INDEX($BD$5:$BD158,BT13)",
    "CU13": "INDEX($BN$5:$BN158,CD13)",
    "CV13": "INDEX($BO$5:$BO158,CE13)",
    "CW13": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG13)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX13": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO13, 1)",
    "CY13": "LET(\n  Base, $CR$6,\n  Damage, $CT13,\n  DamageMastery, $CS13,\n  DemonMastery, $CX13,\n  SPB, $CU13,\n  ITO, $CV13,\n  Shock, $CW13,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ13": "MIN(100%, DA13)",
    "DA13": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK13*1%, 0)",
    "DB13": "LET(\n  Lab, 1+INDEX($BF$5:$BF158,BV13),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC13": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK13*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI158,BY13) + CardCritMastery)",
    "DD13": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK13*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ158,BZ13) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE13": "LET(\n  CF, $DB13,\n  CC, $CZ13,\n  SCM, $DD13,\n  SCC, $DC13,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF13": "LET(\n  CF, $DB13,\n  CC, $DA13,\n  SCM, $DD13,\n  SCC, $DC13,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG13": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH13)), 0)",
    "DH13": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ13*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE158,BU13),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI13": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG158, BW13), 1) + $AE$9)",
    "DJ13": "LET(\n  DpmLab, INDEX($BH$5:$BH158,BX13),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL13, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK13": "(1+$DI13*$DJ13*$AQ$9)",
    "DL13": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK158,CA13),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM13*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM13": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK158,CA13),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM13*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN13": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL158,CB13)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO13": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH13,\n  Rapid, DG13,\n  RDPM, DK13,\n  SuperTower, $DL13,\n  Rend, $DN13,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP13": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ13": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK13),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR13": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP13),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF13-1))",
    "DS13": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG13, DH13),0))",
    "DT13": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP13),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV13, $AR$29), 0))",
    "DU13": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK13),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM158,CC13), $DV13, $AR$29), 0))",
    "DV13": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH13), $AO$29)",
    "DW13": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM13,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13, $DB13), 1),\n\n  DW, $DR13,\n  CL, $DS13,\n  SM, $DT13,\n  SLM, $DU13,\n  SL, $DQ13,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX13": "CY13*(DE13*DO13*DQ13+DW13*DF13)",
    "DZ13": "IF(INDEX($BD$6:$BD158,BT13)=\"\", \"\", INDEX($BD$5:$BD158,BT13+1))",
    "EA13": "IF(OR($AO$25, INDEX($BE$6:$BE158,BU13)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ13)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE158,BU13+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI13*$DJ13*$AQ$9),\n  SuperTower, $DL13,\n  Rend, $DN13,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13, $DB13), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR13,\n  SM, $DT13,\n  SLM, $DU13,\n  SL, $DQ13,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM13, UltCritCard),\n\nCY13*(DE13*OtherDamage*SL+UwDamage*DF13)))",
    "EB13": "IF(INDEX($BF$6:$BF158,BV13)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF158,BV13+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ13,\n  CCUW, $DA13,\n  SCM, $DD13,\n  SCC, $DC13,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13, CF), 1),\n\n  DW, $DR13,\n  CL, $DS13,\n  SM, $DT13,\n  SLM, $DU13,\n  SL, $DQ13,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM13, UltCritCard),\n\nCY13 * (Critical * DO13 * SL + UwDamage * UWCritical)))",
    "EC13": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG158,BW13)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH13,\n  Rapid, DG13,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG158, BW13+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ13*$AQ$9),\n  SuperTower, $DL13,\n  Rend, $DN13,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM158,CC13), $DV13, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM13,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13, $DB13), 1),\n\n  DW, $DR13,\n  CL, $DS13,\n  SM, $DT13,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY13*(DE13*OtherDamage*SL+UWDamage*DF13)))",
    "ED13": "IF(OR($AO$25, INDEX($BH$6:$BH158,BX13)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH158,BX13+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL13, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI13*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM158,CC13), $DV13, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH13,\n  Rapid, DG13,\n  SuperTower, $DL13,\n  Rend, $DN13,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM13,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13, $DB13), 1),\n\n  DW, $DR13,\n  CL, $DS13,\n  SM, $DT13,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY13*(DE13*OtherDamage*SL+UWDamage*DF13)))",
    "EE13": "IF(INDEX($BI$6:$BI158,BY13)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK13, 0),\n  CF, $DB13,\n  CC, $CZ13,\n  CCUW, $DA13,\n  SCM, $DD13,\n  SCC, $AV$17+INDEX($BI$5:$BI158,BY13+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY13 * (Critical*DO13*$DQ13+DW13*UWCritical)))",
    "EF13": "IF(INDEX($BJ$6:$BJ158,BZ13)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK13*1%, 1),\n  CF, $DB13,\n  CC, $CZ13,\n  CCUW, $DA13,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ158,BZ13+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC13,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY13*(Critical*DO13*$DQ13+DW13*UWCritical)))",
    "EG13": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK158,CA13)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH13,\n  Rapid, DG13,\n  DPM, (1+$DI13*$DJ13*$AQ$9),\n  Rend, $DN13,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK158,CA13+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM13*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13, $DB13), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK158,CA13+1)-1))/(45-CM13*3),1),\n\n  SL, $DQ13,\n  DW, $DR13,\n  CL, $DS13,\n  SM, $DT13,\n  SLM, $DU13,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY13*(DE13*OtherDamage*SL+UwDamage*DF13)))",
    "EH13": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL158,CB13+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL158,CB13)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH13,\n  Rapid, DG13,\n  DPM, (1+$DI13*$DJ13*$AQ$9),\n  SuperTower, $DL13,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL158,CB13+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY13*(DE13*OtherDamage*$DQ13+DW13*DF13)))",
    "EI13": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM158,CC13)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13, $DB13), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK13),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV13, $AR$29), 0),\n\n  DW, $DR13,\n  CL, $DS13,\n  SM, $DT13,\n  SL, $DQ13,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM13, UltCritCard),\nCY13*(DE13*DO13*SL+UwDamage*DF13)))",
    "EJ13": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN158,CD13)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT13,\n  DamageMastery, $CS13,\n  DemonMastery, $CX13,\n  SPB, INDEX($BN$5:$BN158,CD13+1),\n  ITO, $CV13,\n  Shock, $CW13,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE13*DO13*$DQ13+DW13*DF13)))",
    "EK13": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO158,CE13)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT13,\n  DamageMastery, $CS13,\n  DemonMastery, $CX13,\n  SPB, $CU13,\n  ITO, INDEX($BO$5:$BO158,CE13+1),\n  Shock, $CW13,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE13*DO13*$DQ13+DW13*DF13)))",
    "EL13": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP158,CF13)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13, $DB13), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP13),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF13),\n  CL, $DS13,\n  SM, $DT13,\n  SLM, $DU13,\n  SL, $DQ13,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM13, UltCritCard),\nCY13*(DE13*DO13*SL+UwDamage*DF13)))",
    "EM13": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ158,CG13)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG13+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN13": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR158,CH13)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13, $DB13), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH13+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP13),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK13),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM158,CC13), SMHeat, $AR$29), 0),\n\n  DW, $DR13,\n  CL, $DS13,\n  SL, $DQ13,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM13, UltCritCard),\nCY13*(DE13*DO13*SL+UwDamage*DF13)))",
    "EO13": "IF(OR(CI13 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI13+1))",
    "EP13": "IF(OR($AO$25, CJ13 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ13+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE157,BU13),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL13, 1),\n  DPM, (1+$DI13*CardRangeMastery*$DJ13*$AQ$9),\n  SuperTower, $DL13,\n  Rend, $DN13,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13, $DB13), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR13,\n  SM, $DT13,\n  SLM, $DU13,\n  SL, $DQ13,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM13, UltCritCard),\n\nCY13*(DE13*OtherDamage*SL+UwDamage*DF13)))",
    "EQ13": "IF(OR(CK13 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK13+1)*1%, 1),\n  CF, $DB13,\n  CC, MIN(100%, $CZ13 + 1%),\n  CCUW, DA13 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ158,BZ13) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC13 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR13,\n  CL, $DS13,\n  SM, $DT13,\n  SLM, $DU13,\n  SL, $DQ13,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM13, UltCritCard),\n\nCY13 * (Critical*DO13*SL+UwDamage*UWCritical)))",
    "ER13": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL13 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH158,BX13),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL13+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI13*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM158,CC13), $DV13, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH13,\n  Rapid, DG13,\n  SuperTower, $DL13,\n  Rend, $DN13,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM13,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13, $DB13), 1),\n\n  DW, $DR13,\n  CL, $DS13,\n  SM, $DT13,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY13*(DE13*OtherDamage*SL+UWDamage*DF13)))",
    "ES13": "IF(OR(CM13 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH13,\n  Rapid, DG13,\n  RDPM, (1+$DI13*$DJ13*$AQ$9),\n  Rend, $DN13,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK158,CA13),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM13+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13, $DB13), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR13,\n  CL, $DS13,\n  SM, $DT13,\n  SLM, $DU13,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY13*(DE13*OtherDamage*SL+UwDamage*DF13)))",
    "ET13": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN13 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM13,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN13+1, $DB13), 1),\n\n  DW, $DR13,\n  CL, $DS13,\n  SM, $DT13,\n  SLM, $DU13,\n  SL, $DQ13,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY13*(DE13*DO13*SL+UWDamage*DF13)))",
    "EU13": "IF(OR(NOT($BA$3), NOT($BA$23), $CO13 > $BA$15), \"\", 1 + 0.5*(CO13+1))",
    "EW13": "IF(DZ13=\"\", \"\", LET(\n  Now, CT13,\n  Next, DZ13,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT13),\nFactor/Cost))",
    "EX13": "IF(EA13=\"\",\"\",(EA13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU13))",
    "EY13": "IF(EB13=\"\",\"\",(EB13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV13))",
    "EZ13": "IF(EC13=\"\",\"\",(EC13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW13))",
    "FA13": "IF(ED13=\"\",\"\",(ED13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX13))",
    "FB13": "IF(EE13=\"\",\"\",(EE13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY13))",
    "FC13": "IF(EF13=\"\",\"\",(EF13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ13))",
    "FD13": "IF(EG13=\"\",\"\",(EG13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA13))",
    "FE13": "IF(EH13=\"\",\"\",(EH13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB13))",
    "FF13": "IF(EI13=\"\",\"\",(EI13/$DX13-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC13+1, 1, CC13))))",
    "FG13": "IF(EJ13=\"\",\"\",(EJ13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD13))",
    "FH13": "IF(EK13=\"\",\"\",(EK13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE13))",
    "FI13": "IF(EL13=\"\",\"\",(EL13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF13))",
    "FJ13": "IF(EM13=\"\", \"\", LET(\n  Now, CW13,\n  Next, EM13,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG13),\nFactor/Cost))",
    "FK13": "IF(EN13=\"\",\"\",(EN13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH13))",
    "FL13": "IF(EO13=\"\", \"\", LET(\n  Now, CS13,\n  Next, EO13,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI13),\nFactor/Cost))",
    "FM13": "IF(EP13=\"\",\"\",(EP13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ13))",
    "FN13": "IF(EQ13=\"\",\"\",(EQ13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK13))",
    "FO13": "IF(ER13=\"\",\"\",(ER13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL13))",
    "FP13": "IF(ES13=\"\",\"\",(ES13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM13))",
    "FQ13": "IF(ET13=\"\",\"\",(ET13/$DX13-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN13))",
    "FR13": "IF(EU13=\"\", \"\", LET(\n  Now, CX13,\n  Next, EU13,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO13),\nFactor/Cost))",
    "FT13": "IF(COLUMN(EW13:FR13) = MIN(IF(EW13:FR13=MAX(EW13:FR13), COLUMN(EW13:FR13))), 1, \"\")",
    "D14": "IF(SUM(FT13:GP13),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F14)),\"Card Mastery\",F14),G14)/$D$5,\"\")",
    "F14": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT13:GP13),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT13:GP13=1)),)\"),\"Damage / Meter\")",
    "G14": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT13:GP13),ARRAYFORMULA(FILTER(BT13:CP13 , FT13:GP13=1)),\"\"\"\")\"),2.0)",
    "I14": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT13:GP13),ARRAYFORMULA(FILTER(EW13:FS13 , FT13:GP13=1))*D$5,\"\"\"\")\"),1.7239050927419508)",
    "K14": "IF(H14<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D14)),)",
    "AD14": "IF(EQ(AE14, 13%), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE14=0, 3%, AE14=3%, 5%, AE14=5%, 7%, AE14=7%, 10%, AE14=10%, 13%), Rare, 3%, Epic, 5%, Legendary, 7%, Mythic, 10%, Ancestral, 13%), 0),\n\n  BaseOther, (1+(AN11+Planner)*($AT$12-1)),\n  Bounce, $CR10,\n  AtkSpeed, $DH5,\n  Rapid, $DG$5,\n  RDPM, DK5,\n  SuperTower, $DL5,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL150,CB5)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * CappedRend,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*OtherDamage*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE14": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC14,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AL14": "MAX('Master Sheet'!I11:J11)",
    "AN14": "0.6+AL14*0.05",
    "AT14": "AN14+AE17",
    "BC14": "BC13+1",
    "BD14": "BD13+BD$3",
    "BE14": "BE13+BE$3",
    "BF14": "BF13+BF$3",
    "BG14": "BG13+BG$3",
    "BH14": "BH13+BH$3",
    "BI14": "BI13+BI$3",
    "BJ14": "BJ13+BJ$3",
    "BK14": "BK13+BK$3",
    "BL14": "BL13+BL$3",
    "BM14": "BM13+BM$3",
    "BN14": "BN13+BN$3",
    "BO14": "BO13+BO$3",
    "BP14": "BP13+BP$3",
    "BQ14": "BQ13+BQ$3",
    "BR14": "BR13+BR$3",
    "BT14": "BT13+FT13",
    "BU14": "BU13+FU13",
    "BV14": "BV13+FV13",
    "BW14": "BW13+FW13",
    "BX14": "BX13+FX13",
    "BY14": "BY13+FY13",
    "BZ14": "BZ13+FZ13",
    "CA14": "CA13+GA13",
    "CB14": "CB13+GB13",
    "CC14": "CC13+GC13",
    "CD14": "CD13+GD13",
    "CE14": "CE13+GE13",
    "CF14": "CF13+GF13",
    "CG14": "CG13+GG13",
    "CH14": "CH13+GH13",
    "CI14": "CI13+GI13",
    "CJ14": "CJ13+GJ13",
    "CK14": "CK13+GK13",
    "CL14": "CL13+GL13",
    "CM14": "CM13+GM13",
    "CN14": "CN13+GN13",
    "CO14": "CO13+GO13",
    "CR14": "LET(\n  ModUwDamage, $AE$20,\n  RelicUwDamage, 1+$AR$31,\n  VaultUwDamage, 1+$AS$31,\nModUwDamage * RelicUwDamage * VaultUwDamage)",
    "CS14": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI14,1)",
    "CT14": "INDEX($BD$5:$BD159,BT14)",
    "CU14": "INDEX($BN$5:$BN159,CD14)",
    "CV14": "INDEX($BO$5:$BO159,CE14)",
    "CW14": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG14)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX14": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO14, 1)",
    "CY14": "LET(\n  Base, $CR$6,\n  Damage, $CT14,\n  DamageMastery, $CS14,\n  DemonMastery, $CX14,\n  SPB, $CU14,\n  ITO, $CV14,\n  Shock, $CW14,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ14": "MIN(100%, DA14)",
    "DA14": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK14*1%, 0)",
    "DB14": "LET(\n  Lab, 1+INDEX($BF$5:$BF159,BV14),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC14": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK14*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI159,BY14) + CardCritMastery)",
    "DD14": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK14*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ159,BZ14) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE14": "LET(\n  CF, $DB14,\n  CC, $CZ14,\n  SCM, $DD14,\n  SCC, $DC14,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF14": "LET(\n  CF, $DB14,\n  CC, $DA14,\n  SCM, $DD14,\n  SCC, $DC14,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG14": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH14)), 0)",
    "DH14": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ14*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE159,BU14),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI14": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG159, BW14), 1) + $AE$9)",
    "DJ14": "LET(\n  DpmLab, INDEX($BH$5:$BH159,BX14),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL14, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK14": "(1+$DI14*$DJ14*$AQ$9)",
    "DL14": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK159,CA14),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM14*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM14": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK159,CA14),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM14*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN14": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL159,CB14)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO14": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH14,\n  Rapid, DG14,\n  RDPM, DK14,\n  SuperTower, $DL14,\n  Rend, $DN14,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP14": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ14": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK14),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR14": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP14),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF14-1))",
    "DS14": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG14, DH14),0))",
    "DT14": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP14),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV14, $AR$29), 0))",
    "DU14": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK14),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM159,CC14), $DV14, $AR$29), 0))",
    "DV14": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH14), $AO$29)",
    "DW14": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14, $DB14), 1),\n\n  DW, $DR14,\n  CL, $DS14,\n  SM, $DT14,\n  SLM, $DU14,\n  SL, $DQ14,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX14": "CY14*(DE14*DO14*DQ14+DW14*DF14)",
    "DZ14": "IF(INDEX($BD$6:$BD159,BT14)=\"\", \"\", INDEX($BD$5:$BD159,BT14+1))",
    "EA14": "IF(OR($AO$25, INDEX($BE$6:$BE159,BU14)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ14)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE159,BU14+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI14*$DJ14*$AQ$9),\n  SuperTower, $DL14,\n  Rend, $DN14,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14, $DB14), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR14,\n  SM, $DT14,\n  SLM, $DU14,\n  SL, $DQ14,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM14, UltCritCard),\n\nCY14*(DE14*OtherDamage*SL+UwDamage*DF14)))",
    "EB14": "IF(INDEX($BF$6:$BF159,BV14)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF159,BV14+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ14,\n  CCUW, $DA14,\n  SCM, $DD14,\n  SCC, $DC14,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14, CF), 1),\n\n  DW, $DR14,\n  CL, $DS14,\n  SM, $DT14,\n  SLM, $DU14,\n  SL, $DQ14,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM14, UltCritCard),\n\nCY14 * (Critical * DO14 * SL + UwDamage * UWCritical)))",
    "EC14": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG159,BW14)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH14,\n  Rapid, DG14,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG159, BW14+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ14*$AQ$9),\n  SuperTower, $DL14,\n  Rend, $DN14,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM159,CC14), $DV14, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14, $DB14), 1),\n\n  DW, $DR14,\n  CL, $DS14,\n  SM, $DT14,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY14*(DE14*OtherDamage*SL+UWDamage*DF14)))",
    "ED14": "IF(OR($AO$25, INDEX($BH$6:$BH159,BX14)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH159,BX14+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL14, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI14*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM159,CC14), $DV14, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH14,\n  Rapid, DG14,\n  SuperTower, $DL14,\n  Rend, $DN14,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14, $DB14), 1),\n\n  DW, $DR14,\n  CL, $DS14,\n  SM, $DT14,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY14*(DE14*OtherDamage*SL+UWDamage*DF14)))",
    "EE14": "IF(INDEX($BI$6:$BI159,BY14)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK14, 0),\n  CF, $DB14,\n  CC, $CZ14,\n  CCUW, $DA14,\n  SCM, $DD14,\n  SCC, $AV$17+INDEX($BI$5:$BI159,BY14+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY14 * (Critical*DO14*$DQ14+DW14*UWCritical)))",
    "EF14": "IF(INDEX($BJ$6:$BJ159,BZ14)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK14*1%, 1),\n  CF, $DB14,\n  CC, $CZ14,\n  CCUW, $DA14,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ159,BZ14+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC14,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY14*(Critical*DO14*$DQ14+DW14*UWCritical)))",
    "EG14": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK159,CA14)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH14,\n  Rapid, DG14,\n  DPM, (1+$DI14*$DJ14*$AQ$9),\n  Rend, $DN14,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK159,CA14+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM14*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14, $DB14), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK159,CA14+1)-1))/(45-CM14*3),1),\n\n  SL, $DQ14,\n  DW, $DR14,\n  CL, $DS14,\n  SM, $DT14,\n  SLM, $DU14,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY14*(DE14*OtherDamage*SL+UwDamage*DF14)))",
    "EH14": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL159,CB14+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL159,CB14)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH14,\n  Rapid, DG14,\n  DPM, (1+$DI14*$DJ14*$AQ$9),\n  SuperTower, $DL14,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL159,CB14+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY14*(DE14*OtherDamage*$DQ14+DW14*DF14)))",
    "EI14": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM159,CC14)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14, $DB14), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK14),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV14, $AR$29), 0),\n\n  DW, $DR14,\n  CL, $DS14,\n  SM, $DT14,\n  SL, $DQ14,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM14, UltCritCard),\nCY14*(DE14*DO14*SL+UwDamage*DF14)))",
    "EJ14": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN159,CD14)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT14,\n  DamageMastery, $CS14,\n  DemonMastery, $CX14,\n  SPB, INDEX($BN$5:$BN159,CD14+1),\n  ITO, $CV14,\n  Shock, $CW14,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE14*DO14*$DQ14+DW14*DF14)))",
    "EK14": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO159,CE14)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT14,\n  DamageMastery, $CS14,\n  DemonMastery, $CX14,\n  SPB, $CU14,\n  ITO, INDEX($BO$5:$BO159,CE14+1),\n  Shock, $CW14,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE14*DO14*$DQ14+DW14*DF14)))",
    "EL14": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP159,CF14)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14, $DB14), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP14),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF14),\n  CL, $DS14,\n  SM, $DT14,\n  SLM, $DU14,\n  SL, $DQ14,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM14, UltCritCard),\nCY14*(DE14*DO14*SL+UwDamage*DF14)))",
    "EM14": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ159,CG14)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG14+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN14": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR159,CH14)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14, $DB14), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH14+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP14),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK14),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM159,CC14), SMHeat, $AR$29), 0),\n\n  DW, $DR14,\n  CL, $DS14,\n  SL, $DQ14,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM14, UltCritCard),\nCY14*(DE14*DO14*SL+UwDamage*DF14)))",
    "EO14": "IF(OR(CI14 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI14+1))",
    "EP14": "IF(OR($AO$25, CJ14 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ14+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE158,BU14),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL14, 1),\n  DPM, (1+$DI14*CardRangeMastery*$DJ14*$AQ$9),\n  SuperTower, $DL14,\n  Rend, $DN14,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14, $DB14), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR14,\n  SM, $DT14,\n  SLM, $DU14,\n  SL, $DQ14,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM14, UltCritCard),\n\nCY14*(DE14*OtherDamage*SL+UwDamage*DF14)))",
    "EQ14": "IF(OR(CK14 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK14+1)*1%, 1),\n  CF, $DB14,\n  CC, MIN(100%, $CZ14 + 1%),\n  CCUW, DA14 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ159,BZ14) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC14 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR14,\n  CL, $DS14,\n  SM, $DT14,\n  SLM, $DU14,\n  SL, $DQ14,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM14, UltCritCard),\n\nCY14 * (Critical*DO14*SL+UwDamage*UWCritical)))",
    "ER14": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL14 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH159,BX14),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL14+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI14*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM159,CC14), $DV14, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH14,\n  Rapid, DG14,\n  SuperTower, $DL14,\n  Rend, $DN14,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14, $DB14), 1),\n\n  DW, $DR14,\n  CL, $DS14,\n  SM, $DT14,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY14*(DE14*OtherDamage*SL+UWDamage*DF14)))",
    "ES14": "IF(OR(CM14 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH14,\n  Rapid, DG14,\n  RDPM, (1+$DI14*$DJ14*$AQ$9),\n  Rend, $DN14,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK159,CA14),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM14+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14, $DB14), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR14,\n  CL, $DS14,\n  SM, $DT14,\n  SLM, $DU14,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY14*(DE14*OtherDamage*SL+UwDamage*DF14)))",
    "ET14": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN14 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN14+1, $DB14), 1),\n\n  DW, $DR14,\n  CL, $DS14,\n  SM, $DT14,\n  SLM, $DU14,\n  SL, $DQ14,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY14*(DE14*DO14*SL+UWDamage*DF14)))",
    "EU14": "IF(OR(NOT($BA$3), NOT($BA$23), $CO14 > $BA$15), \"\", 1 + 0.5*(CO14+1))",
    "EW14": "IF(DZ14=\"\", \"\", LET(\n  Now, CT14,\n  Next, DZ14,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT14),\nFactor/Cost))",
    "EX14": "IF(EA14=\"\",\"\",(EA14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU14))",
    "EY14": "IF(EB14=\"\",\"\",(EB14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV14))",
    "EZ14": "IF(EC14=\"\",\"\",(EC14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW14))",
    "FA14": "IF(ED14=\"\",\"\",(ED14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX14))",
    "FB14": "IF(EE14=\"\",\"\",(EE14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY14))",
    "FC14": "IF(EF14=\"\",\"\",(EF14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ14))",
    "FD14": "IF(EG14=\"\",\"\",(EG14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA14))",
    "FE14": "IF(EH14=\"\",\"\",(EH14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB14))",
    "FF14": "IF(EI14=\"\",\"\",(EI14/$DX14-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC14+1, 1, CC14))))",
    "FG14": "IF(EJ14=\"\",\"\",(EJ14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD14))",
    "FH14": "IF(EK14=\"\",\"\",(EK14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE14))",
    "FI14": "IF(EL14=\"\",\"\",(EL14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF14))",
    "FJ14": "IF(EM14=\"\", \"\", LET(\n  Now, CW14,\n  Next, EM14,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG14),\nFactor/Cost))",
    "FK14": "IF(EN14=\"\",\"\",(EN14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH14))",
    "FL14": "IF(EO14=\"\", \"\", LET(\n  Now, CS14,\n  Next, EO14,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI14),\nFactor/Cost))",
    "FM14": "IF(EP14=\"\",\"\",(EP14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ14))",
    "FN14": "IF(EQ14=\"\",\"\",(EQ14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK14))",
    "FO14": "IF(ER14=\"\",\"\",(ER14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL14))",
    "FP14": "IF(ES14=\"\",\"\",(ES14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM14))",
    "FQ14": "IF(ET14=\"\",\"\",(ET14/$DX14-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN14))",
    "FR14": "IF(EU14=\"\", \"\", LET(\n  Now, CX14,\n  Next, EU14,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO14),\nFactor/Cost))",
    "FT14": "IF(COLUMN(EW14:FR14) = MIN(IF(EW14:FR14=MAX(EW14:FR14), COLUMN(EW14:FR14))), 1, \"\")",
    "D15": "IF(SUM(FT14:GP14),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F15)),\"Card Mastery\",F15),G15)/$D$5,\"\")",
    "F15": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT14:GP14),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT14:GP14=1)),)\"),\"Attack Speed\")",
    "G15": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT14:GP14),ARRAYFORMULA(FILTER(BT14:CP14 , FT14:GP14=1)),\"\"\"\")\"),3.0)",
    "I15": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT14:GP14),ARRAYFORMULA(FILTER(EW14:FS14 , FT14:GP14=1))*D$5,\"\"\"\")\"),1.7094490105342122)",
    "K15": "IF(D6,FORMAT_TIME_YEAR(SUM($D$6:$D15)),)",
    "AD15": "IF(EQ(AE15, 4), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE15=0, 1, AE15=1, 2, AE15=2, 3, AE15=3, 4), Epic, 1, Legendary, 2, Mythic, 3, Ancestral, 4), 0),\n\n  BaseOther, (1+AT11*((AN12+Planner)-1)),\n  Bounce, $CR10,\n  AtkSpeed, $DH5,\n  Rapid, $DG$5,\n  RDPM, DK5,\n  SuperTower, $DL5,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL150,CB5)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * CappedRend,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*OtherDamage*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE15": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC15,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AL15": "MAX('Master Sheet'!I12:J12)",
    "AN15": "AL15*0.8%",
    "AQ15": "IFERROR(__xludf.DUMMYFUNCTION(\"LET(\n  ModName, INDIRECT($C$2 & \"\"!AQ4\"\"),\n  ModRarity, INDIRECT($C$2 & \"\"!AQ5\"\"),\n  IF(ModName = AO15, \n    IFS(\n      REGEXMATCH(ModRarity, \"\"Epic\"\"), 20%, \n      REGEXMATCH(ModRarity, \"\"Legendary\"\"), 40%, \n      REGEXMATCH(ModRarity, \"\"Mythic\"\"), 60%, \"&\"\n      REGEXMATCH(ModRarity, \"\"Ancestral\"\"), 80%,\n      TRUE, 0\n    ),\n  0)\n)\n\"),0.0)",
    "AT15": "AN15+AE18",
    "BC15": "BC14+1",
    "BD15": "BD14+BD$3",
    "BE15": "BE14+BE$3",
    "BF15": "BF14+BF$3",
    "BG15": "BG14+BG$3",
    "BH15": "BH14+BH$3",
    "BI15": "BI14+BI$3",
    "BJ15": "BJ14+BJ$3",
    "BK15": "BK14+BK$3",
    "BL15": "BL14+BL$3",
    "BM15": "BM14+BM$3",
    "BN15": "BN14+BN$3",
    "BO15": "BO14+BO$3",
    "BP15": "BP14+BP$3",
    "BQ15": "BQ14+BQ$3",
    "BR15": "BR14+BR$3",
    "BT15": "BT14+FT14",
    "BU15": "BU14+FU14",
    "BV15": "BV14+FV14",
    "BW15": "BW14+FW14",
    "BX15": "BX14+FX14",
    "BY15": "BY14+FY14",
    "BZ15": "BZ14+FZ14",
    "CA15": "CA14+GA14",
    "CB15": "CB14+GB14",
    "CC15": "CC14+GC14",
    "CD15": "CD14+GD14",
    "CE15": "CE14+GE14",
    "CF15": "CF14+GF14",
    "CG15": "CG14+GG14",
    "CH15": "CH14+GH14",
    "CI15": "CI14+GI14",
    "CJ15": "CJ14+GJ14",
    "CK15": "CK14+GK14",
    "CL15": "CL14+GL14",
    "CM15": "CM14+GM14",
    "CN15": "CN14+GN14",
    "CO15": "CO14+GO14",
    "CR15": "26+9*IF(AND(BA3,BA13),1-AZ13,1)",
    "CS15": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI15,1)",
    "CT15": "INDEX($BD$5:$BD160,BT15)",
    "CU15": "INDEX($BN$5:$BN160,CD15)",
    "CV15": "INDEX($BO$5:$BO160,CE15)",
    "CW15": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG15)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX15": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO15, 1)",
    "CY15": "LET(\n  Base, $CR$6,\n  Damage, $CT15,\n  DamageMastery, $CS15,\n  DemonMastery, $CX15,\n  SPB, $CU15,\n  ITO, $CV15,\n  Shock, $CW15,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ15": "MIN(100%, DA15)",
    "DA15": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK15*1%, 0)",
    "DB15": "LET(\n  Lab, 1+INDEX($BF$5:$BF160,BV15),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC15": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK15*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI160,BY15) + CardCritMastery)",
    "DD15": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK15*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ160,BZ15) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE15": "LET(\n  CF, $DB15,\n  CC, $CZ15,\n  SCM, $DD15,\n  SCC, $DC15,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF15": "LET(\n  CF, $DB15,\n  CC, $DA15,\n  SCM, $DD15,\n  SCC, $DC15,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG15": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH15)), 0)",
    "DH15": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ15*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE160,BU15),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI15": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG160, BW15), 1) + $AE$9)",
    "DJ15": "LET(\n  DpmLab, INDEX($BH$5:$BH160,BX15),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL15, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK15": "(1+$DI15*$DJ15*$AQ$9)",
    "DL15": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK160,CA15),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM15*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM15": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK160,CA15),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM15*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN15": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL160,CB15)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO15": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH15,\n  Rapid, DG15,\n  RDPM, DK15,\n  SuperTower, $DL15,\n  Rend, $DN15,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP15": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ15": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK15),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR15": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP15),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF15-1))",
    "DS15": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG15, DH15),0))",
    "DT15": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP15),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV15, $AR$29), 0))",
    "DU15": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK15),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM160,CC15), $DV15, $AR$29), 0))",
    "DV15": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH15), $AO$29)",
    "DW15": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM15,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15, $DB15), 1),\n\n  DW, $DR15,\n  CL, $DS15,\n  SM, $DT15,\n  SLM, $DU15,\n  SL, $DQ15,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX15": "CY15*(DE15*DO15*DQ15+DW15*DF15)",
    "DZ15": "IF(INDEX($BD$6:$BD160,BT15)=\"\", \"\", INDEX($BD$5:$BD160,BT15+1))",
    "EA15": "IF(OR($AO$25, INDEX($BE$6:$BE160,BU15)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ15)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE160,BU15+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI15*$DJ15*$AQ$9),\n  SuperTower, $DL15,\n  Rend, $DN15,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15, $DB15), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR15,\n  SM, $DT15,\n  SLM, $DU15,\n  SL, $DQ15,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM15, UltCritCard),\n\nCY15*(DE15*OtherDamage*SL+UwDamage*DF15)))",
    "EB15": "IF(INDEX($BF$6:$BF160,BV15)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF160,BV15+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ15,\n  CCUW, $DA15,\n  SCM, $DD15,\n  SCC, $DC15,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15, CF), 1),\n\n  DW, $DR15,\n  CL, $DS15,\n  SM, $DT15,\n  SLM, $DU15,\n  SL, $DQ15,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM15, UltCritCard),\n\nCY15 * (Critical * DO15 * SL + UwDamage * UWCritical)))",
    "EC15": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG160,BW15)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH15,\n  Rapid, DG15,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG160, BW15+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ15*$AQ$9),\n  SuperTower, $DL15,\n  Rend, $DN15,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM160,CC15), $DV15, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM15,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15, $DB15), 1),\n\n  DW, $DR15,\n  CL, $DS15,\n  SM, $DT15,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY15*(DE15*OtherDamage*SL+UWDamage*DF15)))",
    "ED15": "IF(OR($AO$25, INDEX($BH$6:$BH160,BX15)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH160,BX15+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL15, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI15*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM160,CC15), $DV15, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH15,\n  Rapid, DG15,\n  SuperTower, $DL15,\n  Rend, $DN15,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM15,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15, $DB15), 1),\n\n  DW, $DR15,\n  CL, $DS15,\n  SM, $DT15,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY15*(DE15*OtherDamage*SL+UWDamage*DF15)))",
    "EE15": "IF(INDEX($BI$6:$BI160,BY15)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK15, 0),\n  CF, $DB15,\n  CC, $CZ15,\n  CCUW, $DA15,\n  SCM, $DD15,\n  SCC, $AV$17+INDEX($BI$5:$BI160,BY15+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY15 * (Critical*DO15*$DQ15+DW15*UWCritical)))",
    "EF15": "IF(INDEX($BJ$6:$BJ160,BZ15)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK15*1%, 1),\n  CF, $DB15,\n  CC, $CZ15,\n  CCUW, $DA15,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ160,BZ15+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC15,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY15*(Critical*DO15*$DQ15+DW15*UWCritical)))",
    "EG15": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK160,CA15)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH15,\n  Rapid, DG15,\n  DPM, (1+$DI15*$DJ15*$AQ$9),\n  Rend, $DN15,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK160,CA15+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM15*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15, $DB15), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK160,CA15+1)-1))/(45-CM15*3),1),\n\n  SL, $DQ15,\n  DW, $DR15,\n  CL, $DS15,\n  SM, $DT15,\n  SLM, $DU15,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY15*(DE15*OtherDamage*SL+UwDamage*DF15)))",
    "EH15": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL160,CB15+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL160,CB15)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH15,\n  Rapid, DG15,\n  DPM, (1+$DI15*$DJ15*$AQ$9),\n  SuperTower, $DL15,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL160,CB15+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY15*(DE15*OtherDamage*$DQ15+DW15*DF15)))",
    "EI15": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM160,CC15)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15, $DB15), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK15),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV15, $AR$29), 0),\n\n  DW, $DR15,\n  CL, $DS15,\n  SM, $DT15,\n  SL, $DQ15,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM15, UltCritCard),\nCY15*(DE15*DO15*SL+UwDamage*DF15)))",
    "EJ15": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN160,CD15)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT15,\n  DamageMastery, $CS15,\n  DemonMastery, $CX15,\n  SPB, INDEX($BN$5:$BN160,CD15+1),\n  ITO, $CV15,\n  Shock, $CW15,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE15*DO15*$DQ15+DW15*DF15)))",
    "EK15": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO160,CE15)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT15,\n  DamageMastery, $CS15,\n  DemonMastery, $CX15,\n  SPB, $CU15,\n  ITO, INDEX($BO$5:$BO160,CE15+1),\n  Shock, $CW15,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE15*DO15*$DQ15+DW15*DF15)))",
    "EL15": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP160,CF15)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15, $DB15), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP15),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF15),\n  CL, $DS15,\n  SM, $DT15,\n  SLM, $DU15,\n  SL, $DQ15,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM15, UltCritCard),\nCY15*(DE15*DO15*SL+UwDamage*DF15)))",
    "EM15": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ160,CG15)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG15+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN15": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR160,CH15)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15, $DB15), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH15+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP15),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK15),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM160,CC15), SMHeat, $AR$29), 0),\n\n  DW, $DR15,\n  CL, $DS15,\n  SL, $DQ15,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM15, UltCritCard),\nCY15*(DE15*DO15*SL+UwDamage*DF15)))",
    "EO15": "IF(OR(CI15 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI15+1))",
    "EP15": "IF(OR($AO$25, CJ15 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ15+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE159,BU15),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL15, 1),\n  DPM, (1+$DI15*CardRangeMastery*$DJ15*$AQ$9),\n  SuperTower, $DL15,\n  Rend, $DN15,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15, $DB15), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR15,\n  SM, $DT15,\n  SLM, $DU15,\n  SL, $DQ15,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM15, UltCritCard),\n\nCY15*(DE15*OtherDamage*SL+UwDamage*DF15)))",
    "EQ15": "IF(OR(CK15 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK15+1)*1%, 1),\n  CF, $DB15,\n  CC, MIN(100%, $CZ15 + 1%),\n  CCUW, DA15 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ160,BZ15) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC15 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR15,\n  CL, $DS15,\n  SM, $DT15,\n  SLM, $DU15,\n  SL, $DQ15,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM15, UltCritCard),\n\nCY15 * (Critical*DO15*SL+UwDamage*UWCritical)))",
    "ER15": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL15 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH160,BX15),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL15+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI15*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM160,CC15), $DV15, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH15,\n  Rapid, DG15,\n  SuperTower, $DL15,\n  Rend, $DN15,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM15,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15, $DB15), 1),\n\n  DW, $DR15,\n  CL, $DS15,\n  SM, $DT15,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY15*(DE15*OtherDamage*SL+UWDamage*DF15)))",
    "ES15": "IF(OR(CM15 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH15,\n  Rapid, DG15,\n  RDPM, (1+$DI15*$DJ15*$AQ$9),\n  Rend, $DN15,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK160,CA15),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM15+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15, $DB15), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR15,\n  CL, $DS15,\n  SM, $DT15,\n  SLM, $DU15,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY15*(DE15*OtherDamage*SL+UwDamage*DF15)))",
    "ET15": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN15 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM15,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN15+1, $DB15), 1),\n\n  DW, $DR15,\n  CL, $DS15,\n  SM, $DT15,\n  SLM, $DU15,\n  SL, $DQ15,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY15*(DE15*DO15*SL+UWDamage*DF15)))",
    "EU15": "IF(OR(NOT($BA$3), NOT($BA$23), $CO15 > $BA$15), \"\", 1 + 0.5*(CO15+1))",
    "EW15": "IF(DZ15=\"\", \"\", LET(\n  Now, CT15,\n  Next, DZ15,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT15),\nFactor/Cost))",
    "EX15": "IF(EA15=\"\",\"\",(EA15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU15))",
    "EY15": "IF(EB15=\"\",\"\",(EB15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV15))",
    "EZ15": "IF(EC15=\"\",\"\",(EC15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW15))",
    "FA15": "IF(ED15=\"\",\"\",(ED15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX15))",
    "FB15": "IF(EE15=\"\",\"\",(EE15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY15))",
    "FC15": "IF(EF15=\"\",\"\",(EF15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ15))",
    "FD15": "IF(EG15=\"\",\"\",(EG15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA15))",
    "FE15": "IF(EH15=\"\",\"\",(EH15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB15))",
    "FF15": "IF(EI15=\"\",\"\",(EI15/$DX15-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC15+1, 1, CC15))))",
    "FG15": "IF(EJ15=\"\",\"\",(EJ15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD15))",
    "FH15": "IF(EK15=\"\",\"\",(EK15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE15))",
    "FI15": "IF(EL15=\"\",\"\",(EL15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF15))",
    "FJ15": "IF(EM15=\"\", \"\", LET(\n  Now, CW15,\n  Next, EM15,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG15),\nFactor/Cost))",
    "FK15": "IF(EN15=\"\",\"\",(EN15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH15))",
    "FL15": "IF(EO15=\"\", \"\", LET(\n  Now, CS15,\n  Next, EO15,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI15),\nFactor/Cost))",
    "FM15": "IF(EP15=\"\",\"\",(EP15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ15))",
    "FN15": "IF(EQ15=\"\",\"\",(EQ15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK15))",
    "FO15": "IF(ER15=\"\",\"\",(ER15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL15))",
    "FP15": "IF(ES15=\"\",\"\",(ES15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM15))",
    "FQ15": "IF(ET15=\"\",\"\",(ET15/$DX15-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN15))",
    "FR15": "IF(EU15=\"\", \"\", LET(\n  Now, CX15,\n  Next, EU15,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO15),\nFactor/Cost))",
    "FT15": "IF(COLUMN(EW15:FR15) = MIN(IF(EW15:FR15=MAX(EW15:FR15), COLUMN(EW15:FR15))), 1, \"\")",
    "D16": "IF(SUM(FT15:GP15),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F16)),\"Card Mastery\",F16),G16)/$D$5,\"\")",
    "F16": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT15:GP15),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT15:GP15=1)),)\"),\"Damage\")",
    "G16": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT15:GP15),ARRAYFORMULA(FILTER(BT15:CP15 , FT15:GP15=1)),\"\"\"\")\"),3.0)",
    "I16": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT15:GP15),ARRAYFORMULA(FILTER(EW15:FS15 , FT15:GP15=1))*D$5,\"\"\"\")\"),1.6885553470919263)",
    "K16": "IF(H16<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D16)),)",
    "AD16": "IF(EQ(AE16, 12%), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE16=0, 2%, AE16=2%, 4%, AE16=4%, 6%, AE16=6%, 9%, AE16=9%, 12%), Rare, 2%, Epic, 4%, Legendary, 6%, Mythic, 9%, Ancestral, 12%), 0),\n\n  BaseOther, (1+AT11*($AT$12-1)),\n  Bounce, $CR10,\n  AtkSpeed, $DH5,\n  RapidChance, AN13+Planner,\n  Rapid, 1-RapidChance+IF(RapidChance>0, 4*RapidChance*AT14/(AT14+1/(RapidChance*DH5)), 0),\n  RDPM, DK5,\n  SuperTower, $DL5,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL150,CB5)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * CappedRend,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*OtherDamage*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE16": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC16,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AL16": "MAX('Master Sheet'!I13:J13)",
    "AN16": "1+AL16",
    "AT16": "AN16+IF(AND(BA26,BA29),AZ29,0)+AE19",
    "BC16": "BC15+1",
    "BD16": "BD15+BD$3",
    "BE16": "BE15+BE$3",
    "BF16": "BF15+BF$3",
    "BG16": "BG15+BG$3",
    "BH16": "BH15+BH$3",
    "BI16": "BI15+BI$3",
    "BJ16": "BJ15+BJ$3",
    "BK16": "BK15+BK$3",
    "BL16": "BL15+BL$3",
    "BM16": "BM15+BM$3",
    "BN16": "BN15+BN$3",
    "BP16": "BP15+BP$3",
    "BQ16": "BQ15+BQ$3",
    "BR16": "BR15+BR$3",
    "BT16": "BT15+FT15",
    "BU16": "BU15+FU15",
    "BV16": "BV15+FV15",
    "BW16": "BW15+FW15",
    "BX16": "BX15+FX15",
    "BY16": "BY15+FY15",
    "BZ16": "BZ15+FZ15",
    "CA16": "CA15+GA15",
    "CB16": "CB15+GB15",
    "CC16": "CC15+GC15",
    "CD16": "CD15+GD15",
    "CE16": "CE15+GE15",
    "CF16": "CF15+GF15",
    "CG16": "CG15+GG15",
    "CH16": "CH15+GH15",
    "CI16": "CI15+GI15",
    "CJ16": "CJ15+GJ15",
    "CK16": "CK15+GK15",
    "CL16": "CL15+GL15",
    "CM16": "CM15+GM15",
    "CN16": "CN15+GN15",
    "CO16": "CO15+GO15",
    "CS16": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI16,1)",
    "CT16": "INDEX($BD$5:$BD161,BT16)",
    "CU16": "INDEX($BN$5:$BN161,CD16)",
    "CV16": "INDEX($BO$5:$BO161,CE16)",
    "CW16": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG16)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX16": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO16, 1)",
    "CY16": "LET(\n  Base, $CR$6,\n  Damage, $CT16,\n  DamageMastery, $CS16,\n  DemonMastery, $CX16,\n  SPB, $CU16,\n  ITO, $CV16,\n  Shock, $CW16,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ16": "MIN(100%, DA16)",
    "DA16": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK16*1%, 0)",
    "DB16": "LET(\n  Lab, 1+INDEX($BF$5:$BF161,BV16),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC16": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK16*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI161,BY16) + CardCritMastery)",
    "DD16": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK16*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ161,BZ16) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE16": "LET(\n  CF, $DB16,\n  CC, $CZ16,\n  SCM, $DD16,\n  SCC, $DC16,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF16": "LET(\n  CF, $DB16,\n  CC, $DA16,\n  SCM, $DD16,\n  SCC, $DC16,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG16": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH16)), 0)",
    "DH16": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ16*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE161,BU16),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI16": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG161, BW16), 1) + $AE$9)",
    "DJ16": "LET(\n  DpmLab, INDEX($BH$5:$BH161,BX16),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL16, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK16": "(1+$DI16*$DJ16*$AQ$9)",
    "DL16": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK161,CA16),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM16*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM16": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK161,CA16),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM16*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN16": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL161,CB16)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO16": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH16,\n  Rapid, DG16,\n  RDPM, DK16,\n  SuperTower, $DL16,\n  Rend, $DN16,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP16": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ16": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK16),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR16": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP16),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF16-1))",
    "DS16": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG16, DH16),0))",
    "DT16": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP16),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV16, $AR$29), 0))",
    "DU16": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK16),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM161,CC16), $DV16, $AR$29), 0))",
    "DV16": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH16), $AO$29)",
    "DW16": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM16,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16, $DB16), 1),\n\n  DW, $DR16,\n  CL, $DS16,\n  SM, $DT16,\n  SLM, $DU16,\n  SL, $DQ16,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX16": "CY16*(DE16*DO16*DQ16+DW16*DF16)",
    "DZ16": "IF(INDEX($BD$6:$BD161,BT16)=\"\", \"\", INDEX($BD$5:$BD161,BT16+1))",
    "EA16": "IF(OR($AO$25, INDEX($BE$6:$BE161,BU16)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ16)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE161,BU16+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI16*$DJ16*$AQ$9),\n  SuperTower, $DL16,\n  Rend, $DN16,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16, $DB16), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR16,\n  SM, $DT16,\n  SLM, $DU16,\n  SL, $DQ16,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM16, UltCritCard),\n\nCY16*(DE16*OtherDamage*SL+UwDamage*DF16)))",
    "EB16": "IF(INDEX($BF$6:$BF161,BV16)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF161,BV16+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ16,\n  CCUW, $DA16,\n  SCM, $DD16,\n  SCC, $DC16,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16, CF), 1),\n\n  DW, $DR16,\n  CL, $DS16,\n  SM, $DT16,\n  SLM, $DU16,\n  SL, $DQ16,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM16, UltCritCard),\n\nCY16 * (Critical * DO16 * SL + UwDamage * UWCritical)))",
    "EC16": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG161,BW16)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH16,\n  Rapid, DG16,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG161, BW16+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ16*$AQ$9),\n  SuperTower, $DL16,\n  Rend, $DN16,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM161,CC16), $DV16, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM16,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16, $DB16), 1),\n\n  DW, $DR16,\n  CL, $DS16,\n  SM, $DT16,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY16*(DE16*OtherDamage*SL+UWDamage*DF16)))",
    "ED16": "IF(OR($AO$25, INDEX($BH$6:$BH161,BX16)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH161,BX16+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL16, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI16*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM161,CC16), $DV16, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH16,\n  Rapid, DG16,\n  SuperTower, $DL16,\n  Rend, $DN16,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM16,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16, $DB16), 1),\n\n  DW, $DR16,\n  CL, $DS16,\n  SM, $DT16,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY16*(DE16*OtherDamage*SL+UWDamage*DF16)))",
    "EE16": "IF(INDEX($BI$6:$BI161,BY16)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK16, 0),\n  CF, $DB16,\n  CC, $CZ16,\n  CCUW, $DA16,\n  SCM, $DD16,\n  SCC, $AV$17+INDEX($BI$5:$BI161,BY16+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY16 * (Critical*DO16*$DQ16+DW16*UWCritical)))",
    "EF16": "IF(INDEX($BJ$6:$BJ161,BZ16)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK16*1%, 1),\n  CF, $DB16,\n  CC, $CZ16,\n  CCUW, $DA16,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ161,BZ16+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC16,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY16*(Critical*DO16*$DQ16+DW16*UWCritical)))",
    "EG16": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK161,CA16)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH16,\n  Rapid, DG16,\n  DPM, (1+$DI16*$DJ16*$AQ$9),\n  Rend, $DN16,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK161,CA16+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM16*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16, $DB16), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK161,CA16+1)-1))/(45-CM16*3),1),\n\n  SL, $DQ16,\n  DW, $DR16,\n  CL, $DS16,\n  SM, $DT16,\n  SLM, $DU16,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY16*(DE16*OtherDamage*SL+UwDamage*DF16)))",
    "EH16": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL161,CB16+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL161,CB16)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH16,\n  Rapid, DG16,\n  DPM, (1+$DI16*$DJ16*$AQ$9),\n  SuperTower, $DL16,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL161,CB16+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY16*(DE16*OtherDamage*$DQ16+DW16*DF16)))",
    "EI16": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM161,CC16)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16, $DB16), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK16),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV16, $AR$29), 0),\n\n  DW, $DR16,\n  CL, $DS16,\n  SM, $DT16,\n  SL, $DQ16,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM16, UltCritCard),\nCY16*(DE16*DO16*SL+UwDamage*DF16)))",
    "EJ16": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN161,CD16)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT16,\n  DamageMastery, $CS16,\n  DemonMastery, $CX16,\n  SPB, INDEX($BN$5:$BN161,CD16+1),\n  ITO, $CV16,\n  Shock, $CW16,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE16*DO16*$DQ16+DW16*DF16)))",
    "EK16": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO161,CE16)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT16,\n  DamageMastery, $CS16,\n  DemonMastery, $CX16,\n  SPB, $CU16,\n  ITO, INDEX($BO$5:$BO161,CE16+1),\n  Shock, $CW16,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE16*DO16*$DQ16+DW16*DF16)))",
    "EL16": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP161,CF16)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16, $DB16), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP16),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF16),\n  CL, $DS16,\n  SM, $DT16,\n  SLM, $DU16,\n  SL, $DQ16,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM16, UltCritCard),\nCY16*(DE16*DO16*SL+UwDamage*DF16)))",
    "EM16": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ161,CG16)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG16+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN16": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR161,CH16)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16, $DB16), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH16+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP16),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK16),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM161,CC16), SMHeat, $AR$29), 0),\n\n  DW, $DR16,\n  CL, $DS16,\n  SL, $DQ16,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM16, UltCritCard),\nCY16*(DE16*DO16*SL+UwDamage*DF16)))",
    "EO16": "IF(OR(CI16 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI16+1))",
    "EP16": "IF(OR($AO$25, CJ16 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ16+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE160,BU16),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL16, 1),\n  DPM, (1+$DI16*CardRangeMastery*$DJ16*$AQ$9),\n  SuperTower, $DL16,\n  Rend, $DN16,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16, $DB16), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR16,\n  SM, $DT16,\n  SLM, $DU16,\n  SL, $DQ16,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM16, UltCritCard),\n\nCY16*(DE16*OtherDamage*SL+UwDamage*DF16)))",
    "EQ16": "IF(OR(CK16 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK16+1)*1%, 1),\n  CF, $DB16,\n  CC, MIN(100%, $CZ16 + 1%),\n  CCUW, DA16 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ161,BZ16) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC16 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR16,\n  CL, $DS16,\n  SM, $DT16,\n  SLM, $DU16,\n  SL, $DQ16,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM16, UltCritCard),\n\nCY16 * (Critical*DO16*SL+UwDamage*UWCritical)))",
    "ER16": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL16 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH161,BX16),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL16+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI16*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM161,CC16), $DV16, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH16,\n  Rapid, DG16,\n  SuperTower, $DL16,\n  Rend, $DN16,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM16,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16, $DB16), 1),\n\n  DW, $DR16,\n  CL, $DS16,\n  SM, $DT16,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY16*(DE16*OtherDamage*SL+UWDamage*DF16)))",
    "ES16": "IF(OR(CM16 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH16,\n  Rapid, DG16,\n  RDPM, (1+$DI16*$DJ16*$AQ$9),\n  Rend, $DN16,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK161,CA16),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM16+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16, $DB16), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR16,\n  CL, $DS16,\n  SM, $DT16,\n  SLM, $DU16,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY16*(DE16*OtherDamage*SL+UwDamage*DF16)))",
    "ET16": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN16 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM16,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN16+1, $DB16), 1),\n\n  DW, $DR16,\n  CL, $DS16,\n  SM, $DT16,\n  SLM, $DU16,\n  SL, $DQ16,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY16*(DE16*DO16*SL+UWDamage*DF16)))",
    "EU16": "IF(OR(NOT($BA$3), NOT($BA$23), $CO16 > $BA$15), \"\", 1 + 0.5*(CO16+1))",
    "EW16": "IF(DZ16=\"\", \"\", LET(\n  Now, CT16,\n  Next, DZ16,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT16),\nFactor/Cost))",
    "EX16": "IF(EA16=\"\",\"\",(EA16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU16))",
    "EY16": "IF(EB16=\"\",\"\",(EB16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV16))",
    "EZ16": "IF(EC16=\"\",\"\",(EC16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW16))",
    "FA16": "IF(ED16=\"\",\"\",(ED16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX16))",
    "FB16": "IF(EE16=\"\",\"\",(EE16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY16))",
    "FC16": "IF(EF16=\"\",\"\",(EF16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ16))",
    "FD16": "IF(EG16=\"\",\"\",(EG16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA16))",
    "FE16": "IF(EH16=\"\",\"\",(EH16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB16))",
    "FF16": "IF(EI16=\"\",\"\",(EI16/$DX16-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC16+1, 1, CC16))))",
    "FG16": "IF(EJ16=\"\",\"\",(EJ16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD16))",
    "FH16": "IF(EK16=\"\",\"\",(EK16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE16))",
    "FI16": "IF(EL16=\"\",\"\",(EL16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF16))",
    "FJ16": "IF(EM16=\"\", \"\", LET(\n  Now, CW16,\n  Next, EM16,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG16),\nFactor/Cost))",
    "FK16": "IF(EN16=\"\",\"\",(EN16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH16))",
    "FL16": "IF(EO16=\"\", \"\", LET(\n  Now, CS16,\n  Next, EO16,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI16),\nFactor/Cost))",
    "FM16": "IF(EP16=\"\",\"\",(EP16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ16))",
    "FN16": "IF(EQ16=\"\",\"\",(EQ16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK16))",
    "FO16": "IF(ER16=\"\",\"\",(ER16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL16))",
    "FP16": "IF(ES16=\"\",\"\",(ES16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM16))",
    "FQ16": "IF(ET16=\"\",\"\",(ET16/$DX16-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN16))",
    "FR16": "IF(EU16=\"\", \"\", LET(\n  Now, CX16,\n  Next, EU16,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO16),\nFactor/Cost))",
    "FT16": "IF(COLUMN(EW16:FR16) = MIN(IF(EW16:FR16=MAX(EW16:FR16), COLUMN(EW16:FR16))), 1, \"\")",
    "D17": "IF(SUM(FT16:GP16),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F17)),\"Card Mastery\",F17),G17)/$D$5,\"\")",
    "F17": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT16:GP16),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT16:GP16=1)),)\"),\"Critical Factor\")",
    "G17": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT16:GP16),ARRAYFORMULA(FILTER(BT16:CP16 , FT16:GP16=1)),\"\"\"\")\"),4.0)",
    "I17": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT16:GP16),ARRAYFORMULA(FILTER(EW16:FS16 , FT16:GP16=1))*D$5,\"\"\"\")\"),1.2511580519761984)",
    "K17": "IF(H17<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D17)),)",
    "AD17": "IF(EQ(AE17, 3.5), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE17=0, 0.4, AE17=0.4, 0.8, AE17=0.8, 1.4, AE17=1.4, 2.5, AE17=2.5, 3.5), Rare, 0.4, Epic, 0.8, Legendary, 1.4, Mythic, 2.5, Ancestral, 3.5), 0),\n\n  BaseOther, (1+AT11*($AT$12-1)),\n  Bounce, $CR10,\n  AtkSpeed, $DH5,\n  RapidDur, AN14+Planner,\n  Rapid, 1-AT13+IF(AT13>0, 4*AT13*RapidDur/(RapidDur+1/(AT13*DH5)), 0),\n  RDPM, DK5,\n  SuperTower, $DL5,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL150,CB5)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * CappedRend,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$10,1), CN5, $DB5), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*OtherDamage*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE17": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC17,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AI17": "'Master Sheet'!C21",
    "AJ17": "'Master Sheet'!E21",
    "AK17": "(0.1%*AI17)",
    "AL17": "MAX('Master Sheet'!I15:J15)",
    "AN17": "(0.2%*AL17)",
    "AR17": "'Master Sheet'!AM9",
    "AS17": "'Master Sheet'!AX7",
    "AT17": "AU17",
    "AU17": "AV17+AK17",
    "AV17": "AN17 + AE11 + AR17 + AS17",
    "AY17": "1+0.4*(1+'Master Sheet'!C143)",
    "AZ17": "IF(BA17,\"Owned\" ,0.4/750)",
    "BA17": "'Master Sheet'!AC2",
    "BC17": "BC16+1",
    "BD17": "BD16+BD$3",
    "BE17": "BE16+BE$3",
    "BF17": "BF16+BF$3",
    "BG17": "BG16+BG$3",
    "BH17": "BH16+BH$3",
    "BI17": "BI16+BI$3",
    "BJ17": "BJ16+BJ$3",
    "BK17": "BK16+BK$3",
    "BL17": "BL16+BL$3",
    "BM17": "BM16+BM$3",
    "BN17": "BN16+BN$3",
    "BP17": "BP16+BP$3",
    "BQ17": "BQ16+BQ$3",
    "BR17": "BR16+BR$3",
    "BT17": "BT16+FT16",
    "BU17": "BU16+FU16",
    "BV17": "BV16+FV16",
    "BW17": "BW16+FW16",
    "BX17": "BX16+FX16",
    "BY17": "BY16+FY16",
    "BZ17": "BZ16+FZ16",
    "CA17": "CA16+GA16",
    "CB17": "CB16+GB16",
    "CC17": "CC16+GC16",
    "CD17": "CD16+GD16",
    "CE17": "CE16+GE16",
    "CF17": "CF16+GF16",
    "CG17": "CG16+GG16",
    "CH17": "CH16+GH16",
    "CI17": "CI16+GI16",
    "CJ17": "CJ16+GJ16",
    "CK17": "CK16+GK16",
    "CL17": "CL16+GL16",
    "CM17": "CM16+GM16",
    "CN17": "CN16+GN16",
    "CO17": "CO16+GO16",
    "CS17": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI17,1)",
    "CT17": "INDEX($BD$5:$BD162,BT17)",
    "CU17": "INDEX($BN$5:$BN162,CD17)",
    "CV17": "INDEX($BO$5:$BO162,CE17)",
    "CW17": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG17)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX17": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO17, 1)",
    "CY17": "LET(\n  Base, $CR$6,\n  Damage, $CT17,\n  DamageMastery, $CS17,\n  DemonMastery, $CX17,\n  SPB, $CU17,\n  ITO, $CV17,\n  Shock, $CW17,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ17": "MIN(100%, DA17)",
    "DA17": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK17*1%, 0)",
    "DB17": "LET(\n  Lab, 1+INDEX($BF$5:$BF162,BV17),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC17": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK17*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI162,BY17) + CardCritMastery)",
    "DD17": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK17*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ162,BZ17) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE17": "LET(\n  CF, $DB17,\n  CC, $CZ17,\n  SCM, $DD17,\n  SCC, $DC17,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF17": "LET(\n  CF, $DB17,\n  CC, $DA17,\n  SCM, $DD17,\n  SCC, $DC17,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG17": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH17)), 0)",
    "DH17": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ17*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE162,BU17),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI17": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG162, BW17), 1) + $AE$9)",
    "DJ17": "LET(\n  DpmLab, INDEX($BH$5:$BH162,BX17),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL17, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK17": "(1+$DI17*$DJ17*$AQ$9)",
    "DL17": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK162,CA17),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM17*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM17": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK162,CA17),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM17*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN17": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL162,CB17)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO17": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH17,\n  Rapid, DG17,\n  RDPM, DK17,\n  SuperTower, $DL17,\n  Rend, $DN17,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP17": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ17": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK17),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR17": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP17),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF17-1))",
    "DS17": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG17, DH17),0))",
    "DT17": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP17),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV17, $AR$29), 0))",
    "DU17": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK17),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM162,CC17), $DV17, $AR$29), 0))",
    "DV17": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH17), $AO$29)",
    "DW17": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM17,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17, $DB17), 1),\n\n  DW, $DR17,\n  CL, $DS17,\n  SM, $DT17,\n  SLM, $DU17,\n  SL, $DQ17,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX17": "CY17*(DE17*DO17*DQ17+DW17*DF17)",
    "DZ17": "IF(INDEX($BD$6:$BD162,BT17)=\"\", \"\", INDEX($BD$5:$BD162,BT17+1))",
    "EA17": "IF(OR($AO$25, INDEX($BE$6:$BE162,BU17)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ17)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE162,BU17+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI17*$DJ17*$AQ$9),\n  SuperTower, $DL17,\n  Rend, $DN17,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17, $DB17), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR17,\n  SM, $DT17,\n  SLM, $DU17,\n  SL, $DQ17,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM17, UltCritCard),\n\nCY17*(DE17*OtherDamage*SL+UwDamage*DF17)))",
    "EB17": "IF(INDEX($BF$6:$BF162,BV17)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF162,BV17+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ17,\n  CCUW, $DA17,\n  SCM, $DD17,\n  SCC, $DC17,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17, CF), 1),\n\n  DW, $DR17,\n  CL, $DS17,\n  SM, $DT17,\n  SLM, $DU17,\n  SL, $DQ17,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM17, UltCritCard),\n\nCY17 * (Critical * DO17 * SL + UwDamage * UWCritical)))",
    "EC17": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG162,BW17)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH17,\n  Rapid, DG17,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG162, BW17+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ17*$AQ$9),\n  SuperTower, $DL17,\n  Rend, $DN17,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM162,CC17), $DV17, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM17,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17, $DB17), 1),\n\n  DW, $DR17,\n  CL, $DS17,\n  SM, $DT17,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY17*(DE17*OtherDamage*SL+UWDamage*DF17)))",
    "ED17": "IF(OR($AO$25, INDEX($BH$6:$BH162,BX17)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH162,BX17+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL17, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI17*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM162,CC17), $DV17, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH17,\n  Rapid, DG17,\n  SuperTower, $DL17,\n  Rend, $DN17,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM17,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17, $DB17), 1),\n\n  DW, $DR17,\n  CL, $DS17,\n  SM, $DT17,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY17*(DE17*OtherDamage*SL+UWDamage*DF17)))",
    "EE17": "IF(INDEX($BI$6:$BI162,BY17)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK17, 0),\n  CF, $DB17,\n  CC, $CZ17,\n  CCUW, $DA17,\n  SCM, $DD17,\n  SCC, $AV$17+INDEX($BI$5:$BI162,BY17+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY17 * (Critical*DO17*$DQ17+DW17*UWCritical)))",
    "EF17": "IF(INDEX($BJ$6:$BJ162,BZ17)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK17*1%, 1),\n  CF, $DB17,\n  CC, $CZ17,\n  CCUW, $DA17,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ162,BZ17+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC17,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY17*(Critical*DO17*$DQ17+DW17*UWCritical)))",
    "EG17": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK162,CA17)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH17,\n  Rapid, DG17,\n  DPM, (1+$DI17*$DJ17*$AQ$9),\n  Rend, $DN17,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK162,CA17+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM17*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17, $DB17), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK162,CA17+1)-1))/(45-CM17*3),1),\n\n  SL, $DQ17,\n  DW, $DR17,\n  CL, $DS17,\n  SM, $DT17,\n  SLM, $DU17,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY17*(DE17*OtherDamage*SL+UwDamage*DF17)))",
    "EH17": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL162,CB17+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL162,CB17)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH17,\n  Rapid, DG17,\n  DPM, (1+$DI17*$DJ17*$AQ$9),\n  SuperTower, $DL17,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL162,CB17+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY17*(DE17*OtherDamage*$DQ17+DW17*DF17)))",
    "EI17": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM162,CC17)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17, $DB17), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK17),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV17, $AR$29), 0),\n\n  DW, $DR17,\n  CL, $DS17,\n  SM, $DT17,\n  SL, $DQ17,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM17, UltCritCard),\nCY17*(DE17*DO17*SL+UwDamage*DF17)))",
    "EJ17": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN162,CD17)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT17,\n  DamageMastery, $CS17,\n  DemonMastery, $CX17,\n  SPB, INDEX($BN$5:$BN162,CD17+1),\n  ITO, $CV17,\n  Shock, $CW17,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE17*DO17*$DQ17+DW17*DF17)))",
    "EK17": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO162,CE17)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT17,\n  DamageMastery, $CS17,\n  DemonMastery, $CX17,\n  SPB, $CU17,\n  ITO, INDEX($BO$5:$BO162,CE17+1),\n  Shock, $CW17,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE17*DO17*$DQ17+DW17*DF17)))",
    "EL17": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP162,CF17)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17, $DB17), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP17),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF17),\n  CL, $DS17,\n  SM, $DT17,\n  SLM, $DU17,\n  SL, $DQ17,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM17, UltCritCard),\nCY17*(DE17*DO17*SL+UwDamage*DF17)))",
    "EM17": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ162,CG17)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG17+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN17": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR162,CH17)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17, $DB17), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH17+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP17),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK17),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM162,CC17), SMHeat, $AR$29), 0),\n\n  DW, $DR17,\n  CL, $DS17,\n  SL, $DQ17,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM17, UltCritCard),\nCY17*(DE17*DO17*SL+UwDamage*DF17)))",
    "EO17": "IF(OR(CI17 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI17+1))",
    "EP17": "IF(OR($AO$25, CJ17 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ17+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE161,BU17),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL17, 1),\n  DPM, (1+$DI17*CardRangeMastery*$DJ17*$AQ$9),\n  SuperTower, $DL17,\n  Rend, $DN17,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17, $DB17), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR17,\n  SM, $DT17,\n  SLM, $DU17,\n  SL, $DQ17,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM17, UltCritCard),\n\nCY17*(DE17*OtherDamage*SL+UwDamage*DF17)))",
    "EQ17": "IF(OR(CK17 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK17+1)*1%, 1),\n  CF, $DB17,\n  CC, MIN(100%, $CZ17 + 1%),\n  CCUW, DA17 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ162,BZ17) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC17 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR17,\n  CL, $DS17,\n  SM, $DT17,\n  SLM, $DU17,\n  SL, $DQ17,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM17, UltCritCard),\n\nCY17 * (Critical*DO17*SL+UwDamage*UWCritical)))",
    "ER17": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL17 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH162,BX17),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL17+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI17*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM162,CC17), $DV17, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH17,\n  Rapid, DG17,\n  SuperTower, $DL17,\n  Rend, $DN17,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM17,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17, $DB17), 1),\n\n  DW, $DR17,\n  CL, $DS17,\n  SM, $DT17,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY17*(DE17*OtherDamage*SL+UWDamage*DF17)))",
    "ES17": "IF(OR(CM17 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH17,\n  Rapid, DG17,\n  RDPM, (1+$DI17*$DJ17*$AQ$9),\n  Rend, $DN17,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK162,CA17),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM17+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17, $DB17), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR17,\n  CL, $DS17,\n  SM, $DT17,\n  SLM, $DU17,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY17*(DE17*OtherDamage*SL+UwDamage*DF17)))",
    "ET17": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN17 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM17,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN17+1, $DB17), 1),\n\n  DW, $DR17,\n  CL, $DS17,\n  SM, $DT17,\n  SLM, $DU17,\n  SL, $DQ17,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY17*(DE17*DO17*SL+UWDamage*DF17)))",
    "EU17": "IF(OR(NOT($BA$3), NOT($BA$23), $CO17 > $BA$15), \"\", 1 + 0.5*(CO17+1))",
    "EW17": "IF(DZ17=\"\", \"\", LET(\n  Now, CT17,\n  Next, DZ17,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT17),\nFactor/Cost))",
    "EX17": "IF(EA17=\"\",\"\",(EA17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU17))",
    "EY17": "IF(EB17=\"\",\"\",(EB17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV17))",
    "EZ17": "IF(EC17=\"\",\"\",(EC17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW17))",
    "FA17": "IF(ED17=\"\",\"\",(ED17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX17))",
    "FB17": "IF(EE17=\"\",\"\",(EE17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY17))",
    "FC17": "IF(EF17=\"\",\"\",(EF17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ17))",
    "FD17": "IF(EG17=\"\",\"\",(EG17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA17))",
    "FE17": "IF(EH17=\"\",\"\",(EH17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB17))",
    "FF17": "IF(EI17=\"\",\"\",(EI17/$DX17-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC17+1, 1, CC17))))",
    "FG17": "IF(EJ17=\"\",\"\",(EJ17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD17))",
    "FH17": "IF(EK17=\"\",\"\",(EK17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE17))",
    "FI17": "IF(EL17=\"\",\"\",(EL17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF17))",
    "FJ17": "IF(EM17=\"\", \"\", LET(\n  Now, CW17,\n  Next, EM17,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG17),\nFactor/Cost))",
    "FK17": "IF(EN17=\"\",\"\",(EN17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH17))",
    "FL17": "IF(EO17=\"\", \"\", LET(\n  Now, CS17,\n  Next, EO17,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI17),\nFactor/Cost))",
    "FM17": "IF(EP17=\"\",\"\",(EP17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ17))",
    "FN17": "IF(EQ17=\"\",\"\",(EQ17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK17))",
    "FO17": "IF(ER17=\"\",\"\",(ER17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL17))",
    "FP17": "IF(ES17=\"\",\"\",(ES17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM17))",
    "FQ17": "IF(ET17=\"\",\"\",(ET17/$DX17-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN17))",
    "FR17": "IF(EU17=\"\", \"\", LET(\n  Now, CX17,\n  Next, EU17,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO17),\nFactor/Cost))",
    "FT17": "IF(COLUMN(EW17:FR17) = MIN(IF(EW17:FR17=MAX(EW17:FR17), COLUMN(EW17:FR17))), 1, \"\")",
    "D18": "IF(SUM(FT17:GP17),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F18)),\"Card Mastery\",F18),G18)/$D$5,\"\")",
    "F18": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT17:GP17),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT17:GP17=1)),)\"),\"Attack Speed\")",
    "G18": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT17:GP17),ARRAYFORMULA(FILTER(BT17:CP17 , FT17:GP17=1)),\"\"\"\")\"),4.0)",
    "I18": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT17:GP17),ARRAYFORMULA(FILTER(EW17:FS17 , FT17:GP17=1))*D$5,\"\"\"\")\"),0.871058848742966)",
    "K18": "IF(H18<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D18)),)",
    "AD18": "IF(EQ(AE18, 12%), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE18=0, 2%, AE18=2%, 3%, AE18=3%, 5%, AE18=5%, 9%, AE18=9%, 12%), Rare, 2%, Epic, 3%, Legendary, 5%, Mythic, 9%, Ancestral, 12%), 0),\n\n  BaseDMG, CY5,\n\n\n  BaseOther, $CR$9,\n  BounceChance, AN15+Planner,\n  Bounce, (1 + SUM(BounceChance^(SEQUENCE($AT$16, 1, 1, 1)) * (1+$AQ$15)^SEQUENCE($AT$16, 1, 1, 1))),\n  BSnoBA, (1 + SUM(BounceChance^(SEQUENCE($AT$16, 1, 1, 1)) * 1^SEQUENCE($AT$16, 1, 1, 1))),\n  AtkSpeed, $DH5,\n  Rapid, $DG$5,\n  RDPM, DK5,\n  SuperTower, $DL5,\n  Rend, $DN5,\n  OtherDMG, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*BSnoBA*Rapid, AtkSpeed),0),\n\n  DW, $DR5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, BaseDMG*(DE5*OtherDMG*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE18": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC18,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AI18": "'Master Sheet'!C22",
    "AJ18": "'Master Sheet'!E22",
    "AK18": "(1+(2%*AI18))",
    "AL18": "MAX('Master Sheet'!I16:J16)",
    "AN18": "(1.2+(0.1*AL18))",
    "AO18": "'Master Sheet'!O6",
    "AQ18": "1+(AO18*0.01)",
    "AT18": "\"x\" & ROUND(AU18,2)",
    "AU18": "(AN18 * AK18 + AE12) * AQ18 * IF(AND($BA$3,$BA$8,$BA$19), 1+$AY$19, 1)",
    "AV18": "(AN18 + AE12) * AQ18",
    "AY18": "1+0.03*(1+'Master Sheet'!C144)",
    "AZ18": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, 1.03,\n  LabAspd, 1+INDEX($BE$5:$BE150,BU5),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, $DG$5,\n  RDPM, DK5,\n  SuperTower, $DL5,\n  Rend, $DN5,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  Old, $DX$5,\n  New, CY5*(DE5*OtherDamage*SL+UwDamage*DF5),\n\nIF(BA18,\"Owned\" ,(New/Old-1)/750))",
    "BA18": "'Master Sheet'!AC3",
    "BC18": "BC17+1",
    "BD18": "BD17+BD$3",
    "BE18": "BE17+BE$3",
    "BF18": "BF17+BF$3",
    "BG18": "BG17+BG$3",
    "BH18": "BH17+BH$3",
    "BI18": "BI17+BI$3",
    "BJ18": "BJ17+BJ$3",
    "BK18": "BK17+BK$3",
    "BL18": "BL17+BL$3",
    "BM18": "BM17+BM$3",
    "BN18": "BN17+BN$3",
    "BP18": "BP17+BP$3",
    "BQ18": "BQ17+BQ$3",
    "BR18": "BR17+BR$3",
    "BT18": "BT17+FT17",
    "BU18": "BU17+FU17",
    "BV18": "BV17+FV17",
    "BW18": "BW17+FW17",
    "BX18": "BX17+FX17",
    "BY18": "BY17+FY17",
    "BZ18": "BZ17+FZ17",
    "CA18": "CA17+GA17",
    "CB18": "CB17+GB17",
    "CC18": "CC17+GC17",
    "CD18": "CD17+GD17",
    "CE18": "CE17+GE17",
    "CF18": "CF17+GF17",
    "CG18": "CG17+GG17",
    "CH18": "CH17+GH17",
    "CI18": "CI17+GI17",
    "CJ18": "CJ17+GJ17",
    "CK18": "CK17+GK17",
    "CL18": "CL17+GL17",
    "CM18": "CM17+GM17",
    "CN18": "CN17+GN17",
    "CO18": "CO17+GO17",
    "CS18": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI18,1)",
    "CT18": "INDEX($BD$5:$BD163,BT18)",
    "CU18": "INDEX($BN$5:$BN163,CD18)",
    "CV18": "INDEX($BO$5:$BO163,CE18)",
    "CW18": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG18)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX18": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO18, 1)",
    "CY18": "LET(\n  Base, $CR$6,\n  Damage, $CT18,\n  DamageMastery, $CS18,\n  DemonMastery, $CX18,\n  SPB, $CU18,\n  ITO, $CV18,\n  Shock, $CW18,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ18": "MIN(100%, DA18)",
    "DA18": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK18*1%, 0)",
    "DB18": "LET(\n  Lab, 1+INDEX($BF$5:$BF163,BV18),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC18": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK18*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI163,BY18) + CardCritMastery)",
    "DD18": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK18*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ163,BZ18) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE18": "LET(\n  CF, $DB18,\n  CC, $CZ18,\n  SCM, $DD18,\n  SCC, $DC18,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF18": "LET(\n  CF, $DB18,\n  CC, $DA18,\n  SCM, $DD18,\n  SCC, $DC18,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG18": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH18)), 0)",
    "DH18": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ18*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE163,BU18),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI18": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG163, BW18), 1) + $AE$9)",
    "DJ18": "LET(\n  DpmLab, INDEX($BH$5:$BH163,BX18),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL18, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK18": "(1+$DI18*$DJ18*$AQ$9)",
    "DL18": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK163,CA18),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM18*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM18": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK163,CA18),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM18*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN18": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL163,CB18)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO18": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH18,\n  Rapid, DG18,\n  RDPM, DK18,\n  SuperTower, $DL18,\n  Rend, $DN18,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP18": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ18": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK18),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR18": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP18),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF18-1))",
    "DS18": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG18, DH18),0))",
    "DT18": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP18),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV18, $AR$29), 0))",
    "DU18": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK18),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM163,CC18), $DV18, $AR$29), 0))",
    "DV18": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH18), $AO$29)",
    "DW18": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM18,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18, $DB18), 1),\n\n  DW, $DR18,\n  CL, $DS18,\n  SM, $DT18,\n  SLM, $DU18,\n  SL, $DQ18,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX18": "CY18*(DE18*DO18*DQ18+DW18*DF18)",
    "DZ18": "IF(INDEX($BD$6:$BD163,BT18)=\"\", \"\", INDEX($BD$5:$BD163,BT18+1))",
    "EA18": "IF(OR($AO$25, INDEX($BE$6:$BE163,BU18)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ18)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE163,BU18+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI18*$DJ18*$AQ$9),\n  SuperTower, $DL18,\n  Rend, $DN18,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18, $DB18), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR18,\n  SM, $DT18,\n  SLM, $DU18,\n  SL, $DQ18,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM18, UltCritCard),\n\nCY18*(DE18*OtherDamage*SL+UwDamage*DF18)))",
    "EB18": "IF(INDEX($BF$6:$BF163,BV18)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF163,BV18+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ18,\n  CCUW, $DA18,\n  SCM, $DD18,\n  SCC, $DC18,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18, CF), 1),\n\n  DW, $DR18,\n  CL, $DS18,\n  SM, $DT18,\n  SLM, $DU18,\n  SL, $DQ18,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM18, UltCritCard),\n\nCY18 * (Critical * DO18 * SL + UwDamage * UWCritical)))",
    "EC18": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG163,BW18)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH18,\n  Rapid, DG18,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG163, BW18+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ18*$AQ$9),\n  SuperTower, $DL18,\n  Rend, $DN18,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM163,CC18), $DV18, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM18,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18, $DB18), 1),\n\n  DW, $DR18,\n  CL, $DS18,\n  SM, $DT18,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY18*(DE18*OtherDamage*SL+UWDamage*DF18)))",
    "ED18": "IF(OR($AO$25, INDEX($BH$6:$BH163,BX18)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH163,BX18+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL18, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI18*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM163,CC18), $DV18, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH18,\n  Rapid, DG18,\n  SuperTower, $DL18,\n  Rend, $DN18,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM18,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18, $DB18), 1),\n\n  DW, $DR18,\n  CL, $DS18,\n  SM, $DT18,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY18*(DE18*OtherDamage*SL+UWDamage*DF18)))",
    "EE18": "IF(INDEX($BI$6:$BI163,BY18)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK18, 0),\n  CF, $DB18,\n  CC, $CZ18,\n  CCUW, $DA18,\n  SCM, $DD18,\n  SCC, $AV$17+INDEX($BI$5:$BI163,BY18+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY18 * (Critical*DO18*$DQ18+DW18*UWCritical)))",
    "EF18": "IF(INDEX($BJ$6:$BJ163,BZ18)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK18*1%, 1),\n  CF, $DB18,\n  CC, $CZ18,\n  CCUW, $DA18,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ163,BZ18+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC18,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY18*(Critical*DO18*$DQ18+DW18*UWCritical)))",
    "EG18": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK163,CA18)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH18,\n  Rapid, DG18,\n  DPM, (1+$DI18*$DJ18*$AQ$9),\n  Rend, $DN18,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK163,CA18+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM18*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18, $DB18), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK163,CA18+1)-1))/(45-CM18*3),1),\n\n  SL, $DQ18,\n  DW, $DR18,\n  CL, $DS18,\n  SM, $DT18,\n  SLM, $DU18,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY18*(DE18*OtherDamage*SL+UwDamage*DF18)))",
    "EH18": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL163,CB18+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL163,CB18)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH18,\n  Rapid, DG18,\n  DPM, (1+$DI18*$DJ18*$AQ$9),\n  SuperTower, $DL18,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL163,CB18+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY18*(DE18*OtherDamage*$DQ18+DW18*DF18)))",
    "EI18": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM163,CC18)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18, $DB18), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK18),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV18, $AR$29), 0),\n\n  DW, $DR18,\n  CL, $DS18,\n  SM, $DT18,\n  SL, $DQ18,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM18, UltCritCard),\nCY18*(DE18*DO18*SL+UwDamage*DF18)))",
    "EJ18": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN163,CD18)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT18,\n  DamageMastery, $CS18,\n  DemonMastery, $CX18,\n  SPB, INDEX($BN$5:$BN163,CD18+1),\n  ITO, $CV18,\n  Shock, $CW18,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE18*DO18*$DQ18+DW18*DF18)))",
    "EK18": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO163,CE18)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT18,\n  DamageMastery, $CS18,\n  DemonMastery, $CX18,\n  SPB, $CU18,\n  ITO, INDEX($BO$5:$BO163,CE18+1),\n  Shock, $CW18,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE18*DO18*$DQ18+DW18*DF18)))",
    "EL18": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP163,CF18)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18, $DB18), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP18),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF18),\n  CL, $DS18,\n  SM, $DT18,\n  SLM, $DU18,\n  SL, $DQ18,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM18, UltCritCard),\nCY18*(DE18*DO18*SL+UwDamage*DF18)))",
    "EM18": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ163,CG18)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG18+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN18": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR163,CH18)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18, $DB18), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH18+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP18),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK18),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM163,CC18), SMHeat, $AR$29), 0),\n\n  DW, $DR18,\n  CL, $DS18,\n  SL, $DQ18,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM18, UltCritCard),\nCY18*(DE18*DO18*SL+UwDamage*DF18)))",
    "EO18": "IF(OR(CI18 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI18+1))",
    "EP18": "IF(OR($AO$25, CJ18 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ18+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE162,BU18),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL18, 1),\n  DPM, (1+$DI18*CardRangeMastery*$DJ18*$AQ$9),\n  SuperTower, $DL18,\n  Rend, $DN18,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18, $DB18), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR18,\n  SM, $DT18,\n  SLM, $DU18,\n  SL, $DQ18,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM18, UltCritCard),\n\nCY18*(DE18*OtherDamage*SL+UwDamage*DF18)))",
    "EQ18": "IF(OR(CK18 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK18+1)*1%, 1),\n  CF, $DB18,\n  CC, MIN(100%, $CZ18 + 1%),\n  CCUW, DA18 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ163,BZ18) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC18 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR18,\n  CL, $DS18,\n  SM, $DT18,\n  SLM, $DU18,\n  SL, $DQ18,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM18, UltCritCard),\n\nCY18 * (Critical*DO18*SL+UwDamage*UWCritical)))",
    "ER18": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL18 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH163,BX18),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL18+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI18*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM163,CC18), $DV18, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH18,\n  Rapid, DG18,\n  SuperTower, $DL18,\n  Rend, $DN18,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM18,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18, $DB18), 1),\n\n  DW, $DR18,\n  CL, $DS18,\n  SM, $DT18,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY18*(DE18*OtherDamage*SL+UWDamage*DF18)))",
    "ES18": "IF(OR(CM18 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH18,\n  Rapid, DG18,\n  RDPM, (1+$DI18*$DJ18*$AQ$9),\n  Rend, $DN18,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK163,CA18),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM18+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18, $DB18), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR18,\n  CL, $DS18,\n  SM, $DT18,\n  SLM, $DU18,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY18*(DE18*OtherDamage*SL+UwDamage*DF18)))",
    "ET18": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN18 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM18,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN18+1, $DB18), 1),\n\n  DW, $DR18,\n  CL, $DS18,\n  SM, $DT18,\n  SLM, $DU18,\n  SL, $DQ18,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY18*(DE18*DO18*SL+UWDamage*DF18)))",
    "EU18": "IF(OR(NOT($BA$3), NOT($BA$23), $CO18 > $BA$15), \"\", 1 + 0.5*(CO18+1))",
    "EW18": "IF(DZ18=\"\", \"\", LET(\n  Now, CT18,\n  Next, DZ18,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT18),\nFactor/Cost))",
    "EX18": "IF(EA18=\"\",\"\",(EA18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU18))",
    "EY18": "IF(EB18=\"\",\"\",(EB18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV18))",
    "EZ18": "IF(EC18=\"\",\"\",(EC18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW18))",
    "FA18": "IF(ED18=\"\",\"\",(ED18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX18))",
    "FB18": "IF(EE18=\"\",\"\",(EE18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY18))",
    "FC18": "IF(EF18=\"\",\"\",(EF18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ18))",
    "FD18": "IF(EG18=\"\",\"\",(EG18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA18))",
    "FE18": "IF(EH18=\"\",\"\",(EH18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB18))",
    "FF18": "IF(EI18=\"\",\"\",(EI18/$DX18-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC18+1, 1, CC18))))",
    "FG18": "IF(EJ18=\"\",\"\",(EJ18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD18))",
    "FH18": "IF(EK18=\"\",\"\",(EK18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE18))",
    "FI18": "IF(EL18=\"\",\"\",(EL18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF18))",
    "FJ18": "IF(EM18=\"\", \"\", LET(\n  Now, CW18,\n  Next, EM18,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG18),\nFactor/Cost))",
    "FK18": "IF(EN18=\"\",\"\",(EN18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH18))",
    "FL18": "IF(EO18=\"\", \"\", LET(\n  Now, CS18,\n  Next, EO18,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI18),\nFactor/Cost))",
    "FM18": "IF(EP18=\"\",\"\",(EP18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ18))",
    "FN18": "IF(EQ18=\"\",\"\",(EQ18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK18))",
    "FO18": "IF(ER18=\"\",\"\",(ER18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL18))",
    "FP18": "IF(ES18=\"\",\"\",(ES18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM18))",
    "FQ18": "IF(ET18=\"\",\"\",(ET18/$DX18-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN18))",
    "FR18": "IF(EU18=\"\", \"\", LET(\n  Now, CX18,\n  Next, EU18,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO18),\nFactor/Cost))",
    "FT18": "IF(COLUMN(EW18:FR18) = MIN(IF(EW18:FR18=MAX(EW18:FR18), COLUMN(EW18:FR18))), 1, \"\")",
    "D19": "IF(SUM(FT18:GP18),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F19)),\"Card Mastery\",F19),G19)/$D$5,\"\")",
    "F19": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT18:GP18),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT18:GP18=1)),)\"),\"Damage\")",
    "G19": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT18:GP18),ARRAYFORMULA(FILTER(BT18:CP18 , FT18:GP18=1)),\"\"\"\")\"),4.0)",
    "I19": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT18:GP18),ARRAYFORMULA(FILTER(EW18:FS18 , FT18:GP18=1))*D$5,\"\"\"\")\"),0.8616219234911642)",
    "K19": "IF(H19<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D19)),)",
    "AD19": "IF(EQ(AE19, 4), \"-\", LET(\n  Next, EQ($AE$5, \"Next Tier\"),\n  Common, EQ($AE$5, \"Common\"),\n  Rare, EQ($AE$5, \"Rare\"),\n  Epic, EQ($AE$5, \"Epic\"),\n  Legendary, EQ($AE$5, \"Legendary\"),\n  Mythic, EQ($AE$5, \"Mythic\"),\n  Ancestral, EQ($AE$5, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE19=0, 1, AE19=1, 2, AE19=2, 3, AE19=3, 4), Epic, 1, Legendary, 2, Mythic, 3, Ancestral, 4), 0),\n\n  BaseDMG, CY5,\n\n  BaseOther, $CR$9,\n  BounceTargets, AN16+IF(AND(BA26,BA29),AZ29,0)+Planner,\n  Bounce, (1 + SUM($AT$15^(SEQUENCE(BounceTargets, 1, 1, 1)) * (1+$AQ$15)^SEQUENCE(BounceTargets, 1, 1, 1))),\n  BSnoBA, (1 + SUM($AT$15^(SEQUENCE(BounceTargets, 1, 1, 1)) * 1^SEQUENCE(BounceTargets, 1, 1, 1))),\n  AtkSpeed, $DH5,\n  Rapid, $DG$5,\n  RDPM, DK5,\n  SuperTower, $DL5,\n  Rend, $DN5,\n  OtherDMG, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*BSnoBA*Rapid, AtkSpeed),0),\n\n  DW, $DR5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, BaseDMG*(DE5*OtherDMG*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE19": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$2:$AU$7\"), MATCH(AC19,INDIRECT($C$2 & \"!$AR$2:$AR$7\"), 0)),0)",
    "AH19": "'Master Sheet'!G17",
    "AI19": "'Master Sheet'!C23",
    "AJ19": "'Master Sheet'!E23",
    "AK19": "8+AI19*0.25",
    "AO19": "'Master Sheet'!O3",
    "AQ19": "1+(AO19*0.01)",
    "AT19": "AU19",
    "AU19": "(AK19+AE13)*AQ19",
    "AY19": "1%*(1+'Master Sheet'!C151)",
    "AZ19": "LET(\n  CardCritMastery, 1+(CK5+1)*1%,\n  CF, $DB5,\n  CCUW, $AV$8 + 1%,\n  CC, MIN(100%, CCUW),\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ150,BZ5) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC5 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  Old, $DX$5,\n  New, CY5 * (Critical*DO5*SL+UwDamage*UWCritical),\n\nIF(BA19,\"Owned\" ,(New/Old-1)/750))",
    "BA19": "'Master Sheet'!AC10",
    "BC19": "BC18+1",
    "BD19": "BD18+BD$3",
    "BE19": "BE18+BE$3",
    "BF19": "BF18+BF$3",
    "BG19": "BG18+BG$3",
    "BH19": "BH18+BH$3",
    "BI19": "BI18+BI$3",
    "BJ19": "BJ18+BJ$3",
    "BK19": "BK18+BK$3",
    "BL19": "BL18+BL$3",
    "BM19": "BM18+BM$3",
    "BN19": "BN18+BN$3",
    "BP19": "BP18+BP$3",
    "BQ19": "BQ18+BQ$3",
    "BR19": "BR18+BR$3",
    "BT19": "BT18+FT18",
    "BU19": "BU18+FU18",
    "BV19": "BV18+FV18",
    "BW19": "BW18+FW18",
    "BX19": "BX18+FX18",
    "BY19": "BY18+FY18",
    "BZ19": "BZ18+FZ18",
    "CA19": "CA18+GA18",
    "CB19": "CB18+GB18",
    "CC19": "CC18+GC18",
    "CD19": "CD18+GD18",
    "CE19": "CE18+GE18",
    "CF19": "CF18+GF18",
    "CG19": "CG18+GG18",
    "CH19": "CH18+GH18",
    "CI19": "CI18+GI18",
    "CJ19": "CJ18+GJ18",
    "CK19": "CK18+GK18",
    "CL19": "CL18+GL18",
    "CM19": "CM18+GM18",
    "CN19": "CN18+GN18",
    "CO19": "CO18+GO18",
    "CS19": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI19,1)",
    "CT19": "INDEX($BD$5:$BD164,BT19)",
    "CU19": "INDEX($BN$5:$BN164,CD19)",
    "CV19": "INDEX($BO$5:$BO164,CE19)",
    "CW19": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG19)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX19": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO19, 1)",
    "CY19": "LET(\n  Base, $CR$6,\n  Damage, $CT19,\n  DamageMastery, $CS19,\n  DemonMastery, $CX19,\n  SPB, $CU19,\n  ITO, $CV19,\n  Shock, $CW19,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ19": "MIN(100%, DA19)",
    "DA19": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK19*1%, 0)",
    "DB19": "LET(\n  Lab, 1+INDEX($BF$5:$BF164,BV19),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC19": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK19*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI164,BY19) + CardCritMastery)",
    "DD19": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK19*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ164,BZ19) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE19": "LET(\n  CF, $DB19,\n  CC, $CZ19,\n  SCM, $DD19,\n  SCC, $DC19,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF19": "LET(\n  CF, $DB19,\n  CC, $DA19,\n  SCM, $DD19,\n  SCC, $DC19,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG19": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH19)), 0)",
    "DH19": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ19*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE164,BU19),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI19": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG164, BW19), 1) + $AE$9)",
    "DJ19": "LET(\n  DpmLab, INDEX($BH$5:$BH164,BX19),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL19, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK19": "(1+$DI19*$DJ19*$AQ$9)",
    "DL19": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK164,CA19),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM19*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM19": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK164,CA19),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM19*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN19": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL164,CB19)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO19": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH19,\n  Rapid, DG19,\n  RDPM, DK19,\n  SuperTower, $DL19,\n  Rend, $DN19,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP19": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ19": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK19),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR19": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP19),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF19-1))",
    "DS19": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG19, DH19),0))",
    "DT19": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP19),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV19, $AR$29), 0))",
    "DU19": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK19),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM164,CC19), $DV19, $AR$29), 0))",
    "DV19": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH19), $AO$29)",
    "DW19": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM19,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19, $DB19), 1),\n\n  DW, $DR19,\n  CL, $DS19,\n  SM, $DT19,\n  SLM, $DU19,\n  SL, $DQ19,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX19": "CY19*(DE19*DO19*DQ19+DW19*DF19)",
    "DZ19": "IF(INDEX($BD$6:$BD164,BT19)=\"\", \"\", INDEX($BD$5:$BD164,BT19+1))",
    "EA19": "IF(OR($AO$25, INDEX($BE$6:$BE164,BU19)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ19)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE164,BU19+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI19*$DJ19*$AQ$9),\n  SuperTower, $DL19,\n  Rend, $DN19,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19, $DB19), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR19,\n  SM, $DT19,\n  SLM, $DU19,\n  SL, $DQ19,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM19, UltCritCard),\n\nCY19*(DE19*OtherDamage*SL+UwDamage*DF19)))",
    "EB19": "IF(INDEX($BF$6:$BF164,BV19)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF164,BV19+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ19,\n  CCUW, $DA19,\n  SCM, $DD19,\n  SCC, $DC19,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19, CF), 1),\n\n  DW, $DR19,\n  CL, $DS19,\n  SM, $DT19,\n  SLM, $DU19,\n  SL, $DQ19,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM19, UltCritCard),\n\nCY19 * (Critical * DO19 * SL + UwDamage * UWCritical)))",
    "EC19": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG164,BW19)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH19,\n  Rapid, DG19,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG164, BW19+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ19*$AQ$9),\n  SuperTower, $DL19,\n  Rend, $DN19,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM164,CC19), $DV19, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM19,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19, $DB19), 1),\n\n  DW, $DR19,\n  CL, $DS19,\n  SM, $DT19,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY19*(DE19*OtherDamage*SL+UWDamage*DF19)))",
    "ED19": "IF(OR($AO$25, INDEX($BH$6:$BH164,BX19)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH164,BX19+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL19, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI19*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM164,CC19), $DV19, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH19,\n  Rapid, DG19,\n  SuperTower, $DL19,\n  Rend, $DN19,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM19,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19, $DB19), 1),\n\n  DW, $DR19,\n  CL, $DS19,\n  SM, $DT19,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY19*(DE19*OtherDamage*SL+UWDamage*DF19)))",
    "EE19": "IF(INDEX($BI$6:$BI164,BY19)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK19, 0),\n  CF, $DB19,\n  CC, $CZ19,\n  CCUW, $DA19,\n  SCM, $DD19,\n  SCC, $AV$17+INDEX($BI$5:$BI164,BY19+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY19 * (Critical*DO19*$DQ19+DW19*UWCritical)))",
    "EF19": "IF(INDEX($BJ$6:$BJ164,BZ19)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK19*1%, 1),\n  CF, $DB19,\n  CC, $CZ19,\n  CCUW, $DA19,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ164,BZ19+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC19,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY19*(Critical*DO19*$DQ19+DW19*UWCritical)))",
    "EG19": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK164,CA19)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH19,\n  Rapid, DG19,\n  DPM, (1+$DI19*$DJ19*$AQ$9),\n  Rend, $DN19,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK164,CA19+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM19*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19, $DB19), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK164,CA19+1)-1))/(45-CM19*3),1),\n\n  SL, $DQ19,\n  DW, $DR19,\n  CL, $DS19,\n  SM, $DT19,\n  SLM, $DU19,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY19*(DE19*OtherDamage*SL+UwDamage*DF19)))",
    "EH19": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL164,CB19+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL164,CB19)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH19,\n  Rapid, DG19,\n  DPM, (1+$DI19*$DJ19*$AQ$9),\n  SuperTower, $DL19,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL164,CB19+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY19*(DE19*OtherDamage*$DQ19+DW19*DF19)))",
    "EI19": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM164,CC19)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19, $DB19), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK19),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV19, $AR$29), 0),\n\n  DW, $DR19,\n  CL, $DS19,\n  SM, $DT19,\n  SL, $DQ19,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM19, UltCritCard),\nCY19*(DE19*DO19*SL+UwDamage*DF19)))",
    "EJ19": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN164,CD19)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT19,\n  DamageMastery, $CS19,\n  DemonMastery, $CX19,\n  SPB, INDEX($BN$5:$BN164,CD19+1),\n  ITO, $CV19,\n  Shock, $CW19,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE19*DO19*$DQ19+DW19*DF19)))",
    "EK19": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO164,CE19)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT19,\n  DamageMastery, $CS19,\n  DemonMastery, $CX19,\n  SPB, $CU19,\n  ITO, INDEX($BO$5:$BO164,CE19+1),\n  Shock, $CW19,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE19*DO19*$DQ19+DW19*DF19)))",
    "EL19": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP164,CF19)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19, $DB19), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP19),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF19),\n  CL, $DS19,\n  SM, $DT19,\n  SLM, $DU19,\n  SL, $DQ19,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM19, UltCritCard),\nCY19*(DE19*DO19*SL+UwDamage*DF19)))",
    "EM19": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ164,CG19)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG19+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN19": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR164,CH19)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19, $DB19), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH19+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP19),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK19),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM164,CC19), SMHeat, $AR$29), 0),\n\n  DW, $DR19,\n  CL, $DS19,\n  SL, $DQ19,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM19, UltCritCard),\nCY19*(DE19*DO19*SL+UwDamage*DF19)))",
    "EO19": "IF(OR(CI19 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI19+1))",
    "EP19": "IF(OR($AO$25, CJ19 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ19+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE163,BU19),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL19, 1),\n  DPM, (1+$DI19*CardRangeMastery*$DJ19*$AQ$9),\n  SuperTower, $DL19,\n  Rend, $DN19,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19, $DB19), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR19,\n  SM, $DT19,\n  SLM, $DU19,\n  SL, $DQ19,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM19, UltCritCard),\n\nCY19*(DE19*OtherDamage*SL+UwDamage*DF19)))",
    "EQ19": "IF(OR(CK19 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK19+1)*1%, 1),\n  CF, $DB19,\n  CC, MIN(100%, $CZ19 + 1%),\n  CCUW, DA19 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ164,BZ19) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC19 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR19,\n  CL, $DS19,\n  SM, $DT19,\n  SLM, $DU19,\n  SL, $DQ19,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM19, UltCritCard),\n\nCY19 * (Critical*DO19*SL+UwDamage*UWCritical)))",
    "ER19": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL19 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH164,BX19),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL19+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI19*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM164,CC19), $DV19, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH19,\n  Rapid, DG19,\n  SuperTower, $DL19,\n  Rend, $DN19,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM19,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19, $DB19), 1),\n\n  DW, $DR19,\n  CL, $DS19,\n  SM, $DT19,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY19*(DE19*OtherDamage*SL+UWDamage*DF19)))",
    "ES19": "IF(OR(CM19 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH19,\n  Rapid, DG19,\n  RDPM, (1+$DI19*$DJ19*$AQ$9),\n  Rend, $DN19,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK164,CA19),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM19+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19, $DB19), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR19,\n  CL, $DS19,\n  SM, $DT19,\n  SLM, $DU19,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY19*(DE19*OtherDamage*SL+UwDamage*DF19)))",
    "ET19": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN19 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM19,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN19+1, $DB19), 1),\n\n  DW, $DR19,\n  CL, $DS19,\n  SM, $DT19,\n  SLM, $DU19,\n  SL, $DQ19,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY19*(DE19*DO19*SL+UWDamage*DF19)))",
    "EU19": "IF(OR(NOT($BA$3), NOT($BA$23), $CO19 > $BA$15), \"\", 1 + 0.5*(CO19+1))",
    "EW19": "IF(DZ19=\"\", \"\", LET(\n  Now, CT19,\n  Next, DZ19,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT19),\nFactor/Cost))",
    "EX19": "IF(EA19=\"\",\"\",(EA19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU19))",
    "EY19": "IF(EB19=\"\",\"\",(EB19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV19))",
    "EZ19": "IF(EC19=\"\",\"\",(EC19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW19))",
    "FA19": "IF(ED19=\"\",\"\",(ED19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX19))",
    "FB19": "IF(EE19=\"\",\"\",(EE19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY19))",
    "FC19": "IF(EF19=\"\",\"\",(EF19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ19))",
    "FD19": "IF(EG19=\"\",\"\",(EG19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA19))",
    "FE19": "IF(EH19=\"\",\"\",(EH19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB19))",
    "FF19": "IF(EI19=\"\",\"\",(EI19/$DX19-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC19+1, 1, CC19))))",
    "FG19": "IF(EJ19=\"\",\"\",(EJ19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD19))",
    "FH19": "IF(EK19=\"\",\"\",(EK19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE19))",
    "FI19": "IF(EL19=\"\",\"\",(EL19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF19))",
    "FJ19": "IF(EM19=\"\", \"\", LET(\n  Now, CW19,\n  Next, EM19,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG19),\nFactor/Cost))",
    "FK19": "IF(EN19=\"\",\"\",(EN19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH19))",
    "FL19": "IF(EO19=\"\", \"\", LET(\n  Now, CS19,\n  Next, EO19,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI19),\nFactor/Cost))",
    "FM19": "IF(EP19=\"\",\"\",(EP19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ19))",
    "FN19": "IF(EQ19=\"\",\"\",(EQ19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK19))",
    "FO19": "IF(ER19=\"\",\"\",(ER19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL19))",
    "FP19": "IF(ES19=\"\",\"\",(ES19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM19))",
    "FQ19": "IF(ET19=\"\",\"\",(ET19/$DX19-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN19))",
    "FR19": "IF(EU19=\"\", \"\", LET(\n  Now, CX19,\n  Next, EU19,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO19),\nFactor/Cost))",
    "FT19": "IF(COLUMN(EW19:FR19) = MIN(IF(EW19:FR19=MAX(EW19:FR19), COLUMN(EW19:FR19))), 1, \"\")",
    "D20": "IF(SUM(FT19:GP19),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F20)),\"Card Mastery\",F20),G20)/$D$5,\"\")",
    "F20": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT19:GP19),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT19:GP19=1)),)\"),\"Critical Factor\")",
    "G20": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT19:GP19),ARRAYFORMULA(FILTER(BT19:CP19 , FT19:GP19=1)),\"\"\"\")\"),5.0)",
    "I20": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT19:GP19),ARRAYFORMULA(FILTER(EW19:FS19 , FT19:GP19=1))*D$5,\"\"\"\")\"),0.7285000885185529)",
    "K20": "IF(H20<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D20)),)",
    "AE20": "IFERROR(INDIRECT($C$2 & \"!$AQ$25\"), 1)",
    "AI20": "'Master Sheet'!C50",
    "AK20": "AI20*0.2%",
    "AL20": "MAX('Master Sheet'!I47:J47)",
    "AN20": "6%+0.4%*AL20",
    "AT20": "AU20",
    "AU20": "AV20+AK20",
    "AV20": "AN20+IF(AND(BA3,BA12),AZ12,0)+AE36",
    "AY20": "1+0.2*(1+'Master Sheet'!C147)",
    "AZ20": "LET(\n  BaseOther, $CR$9,\n  Bounce, $CR10,\n  AtkSpeed, $DH5,\n  Rapid, $DG$5,\n  Range, DI5,\n  CardRangeMastery, 1.2,\n  RDPM, (1+Range*CardRangeMastery*$DJ5*$AQ$9),\n  SuperTower, $DL5,\n  Rend, $DN5,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM150,CC5), $DV5, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM5,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  Old, $DX$5,\n  New, CY5*(DE5*OtherDamage*DQ5+UWDamage*DF5),\nIF(BA20,\"Owned\" ,(New/Old-1)/750))",
    "BA20": "'Master Sheet'!AC6",
    "BC20": "BC19+1",
    "BD20": "BD19+BD$3",
    "BE20": "BE19+BE$3",
    "BF20": "BF19+BF$3",
    "BG20": "BG19+BG$3",
    "BH20": "BH19+BH$3",
    "BI20": "BI19+BI$3",
    "BJ20": "BJ19+BJ$3",
    "BK20": "BK19+BK$3",
    "BL20": "BL19+BL$3",
    "BM20": "BM19+BM$3",
    "BN20": "BN19+BN$3",
    "BP20": "BP19+BP$3",
    "BR20": "BR19+BR$3",
    "BT20": "BT19+FT19",
    "BU20": "BU19+FU19",
    "BV20": "BV19+FV19",
    "BW20": "BW19+FW19",
    "BX20": "BX19+FX19",
    "BY20": "BY19+FY19",
    "BZ20": "BZ19+FZ19",
    "CA20": "CA19+GA19",
    "CB20": "CB19+GB19",
    "CC20": "CC19+GC19",
    "CD20": "CD19+GD19",
    "CE20": "CE19+GE19",
    "CF20": "CF19+GF19",
    "CG20": "CG19+GG19",
    "CH20": "CH19+GH19",
    "CI20": "CI19+GI19",
    "CJ20": "CJ19+GJ19",
    "CK20": "CK19+GK19",
    "CL20": "CL19+GL19",
    "CM20": "CM19+GM19",
    "CN20": "CN19+GN19",
    "CO20": "CO19+GO19",
    "CS20": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI20,1)",
    "CT20": "INDEX($BD$5:$BD165,BT20)",
    "CU20": "INDEX($BN$5:$BN165,CD20)",
    "CV20": "INDEX($BO$5:$BO165,CE20)",
    "CW20": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG20)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX20": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO20, 1)",
    "CY20": "LET(\n  Base, $CR$6,\n  Damage, $CT20,\n  DamageMastery, $CS20,\n  DemonMastery, $CX20,\n  SPB, $CU20,\n  ITO, $CV20,\n  Shock, $CW20,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ20": "MIN(100%, DA20)",
    "DA20": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK20*1%, 0)",
    "DB20": "LET(\n  Lab, 1+INDEX($BF$5:$BF165,BV20),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC20": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK20*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI165,BY20) + CardCritMastery)",
    "DD20": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK20*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ165,BZ20) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE20": "LET(\n  CF, $DB20,\n  CC, $CZ20,\n  SCM, $DD20,\n  SCC, $DC20,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF20": "LET(\n  CF, $DB20,\n  CC, $DA20,\n  SCM, $DD20,\n  SCC, $DC20,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG20": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH20)), 0)",
    "DH20": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ20*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE165,BU20),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI20": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG165, BW20), 1) + $AE$9)",
    "DJ20": "LET(\n  DpmLab, INDEX($BH$5:$BH165,BX20),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL20, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK20": "(1+$DI20*$DJ20*$AQ$9)",
    "DL20": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK165,CA20),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM20*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM20": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK165,CA20),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM20*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN20": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL165,CB20)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO20": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH20,\n  Rapid, DG20,\n  RDPM, DK20,\n  SuperTower, $DL20,\n  Rend, $DN20,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP20": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ20": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK20),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR20": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP20),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF20-1))",
    "DS20": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG20, DH20),0))",
    "DT20": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP20),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV20, $AR$29), 0))",
    "DU20": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK20),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM165,CC20), $DV20, $AR$29), 0))",
    "DV20": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH20), $AO$29)",
    "DW20": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM20,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20, $DB20), 1),\n\n  DW, $DR20,\n  CL, $DS20,\n  SM, $DT20,\n  SLM, $DU20,\n  SL, $DQ20,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX20": "CY20*(DE20*DO20*DQ20+DW20*DF20)",
    "DZ20": "IF(INDEX($BD$6:$BD165,BT20)=\"\", \"\", INDEX($BD$5:$BD165,BT20+1))",
    "EA20": "IF(OR($AO$25, INDEX($BE$6:$BE165,BU20)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ20)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE165,BU20+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI20*$DJ20*$AQ$9),\n  SuperTower, $DL20,\n  Rend, $DN20,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20, $DB20), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR20,\n  SM, $DT20,\n  SLM, $DU20,\n  SL, $DQ20,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM20, UltCritCard),\n\nCY20*(DE20*OtherDamage*SL+UwDamage*DF20)))",
    "EB20": "IF(INDEX($BF$6:$BF165,BV20)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF165,BV20+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ20,\n  CCUW, $DA20,\n  SCM, $DD20,\n  SCC, $DC20,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20, CF), 1),\n\n  DW, $DR20,\n  CL, $DS20,\n  SM, $DT20,\n  SLM, $DU20,\n  SL, $DQ20,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM20, UltCritCard),\n\nCY20 * (Critical * DO20 * SL + UwDamage * UWCritical)))",
    "EC20": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG165,BW20)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH20,\n  Rapid, DG20,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG165, BW20+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ20*$AQ$9),\n  SuperTower, $DL20,\n  Rend, $DN20,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM165,CC20), $DV20, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM20,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20, $DB20), 1),\n\n  DW, $DR20,\n  CL, $DS20,\n  SM, $DT20,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY20*(DE20*OtherDamage*SL+UWDamage*DF20)))",
    "ED20": "IF(OR($AO$25, INDEX($BH$6:$BH165,BX20)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH165,BX20+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL20, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI20*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM165,CC20), $DV20, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH20,\n  Rapid, DG20,\n  SuperTower, $DL20,\n  Rend, $DN20,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM20,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20, $DB20), 1),\n\n  DW, $DR20,\n  CL, $DS20,\n  SM, $DT20,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY20*(DE20*OtherDamage*SL+UWDamage*DF20)))",
    "EE20": "IF(INDEX($BI$6:$BI165,BY20)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK20, 0),\n  CF, $DB20,\n  CC, $CZ20,\n  CCUW, $DA20,\n  SCM, $DD20,\n  SCC, $AV$17+INDEX($BI$5:$BI165,BY20+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY20 * (Critical*DO20*$DQ20+DW20*UWCritical)))",
    "EF20": "IF(INDEX($BJ$6:$BJ165,BZ20)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK20*1%, 1),\n  CF, $DB20,\n  CC, $CZ20,\n  CCUW, $DA20,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ165,BZ20+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC20,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY20*(Critical*DO20*$DQ20+DW20*UWCritical)))",
    "EG20": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK165,CA20)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH20,\n  Rapid, DG20,\n  DPM, (1+$DI20*$DJ20*$AQ$9),\n  Rend, $DN20,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK165,CA20+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM20*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20, $DB20), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK165,CA20+1)-1))/(45-CM20*3),1),\n\n  SL, $DQ20,\n  DW, $DR20,\n  CL, $DS20,\n  SM, $DT20,\n  SLM, $DU20,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY20*(DE20*OtherDamage*SL+UwDamage*DF20)))",
    "EH20": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL165,CB20+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL165,CB20)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH20,\n  Rapid, DG20,\n  DPM, (1+$DI20*$DJ20*$AQ$9),\n  SuperTower, $DL20,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL165,CB20+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY20*(DE20*OtherDamage*$DQ20+DW20*DF20)))",
    "EI20": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM165,CC20)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20, $DB20), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK20),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV20, $AR$29), 0),\n\n  DW, $DR20,\n  CL, $DS20,\n  SM, $DT20,\n  SL, $DQ20,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM20, UltCritCard),\nCY20*(DE20*DO20*SL+UwDamage*DF20)))",
    "EJ20": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN165,CD20)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT20,\n  DamageMastery, $CS20,\n  DemonMastery, $CX20,\n  SPB, INDEX($BN$5:$BN165,CD20+1),\n  ITO, $CV20,\n  Shock, $CW20,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE20*DO20*$DQ20+DW20*DF20)))",
    "EK20": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO165,CE20)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT20,\n  DamageMastery, $CS20,\n  DemonMastery, $CX20,\n  SPB, $CU20,\n  ITO, INDEX($BO$5:$BO165,CE20+1),\n  Shock, $CW20,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE20*DO20*$DQ20+DW20*DF20)))",
    "EL20": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP165,CF20)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20, $DB20), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP20),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF20),\n  CL, $DS20,\n  SM, $DT20,\n  SLM, $DU20,\n  SL, $DQ20,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM20, UltCritCard),\nCY20*(DE20*DO20*SL+UwDamage*DF20)))",
    "EM20": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ165,CG20)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG20+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN20": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR165,CH20)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20, $DB20), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH20+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP20),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK20),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM165,CC20), SMHeat, $AR$29), 0),\n\n  DW, $DR20,\n  CL, $DS20,\n  SL, $DQ20,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM20, UltCritCard),\nCY20*(DE20*DO20*SL+UwDamage*DF20)))",
    "EO20": "IF(OR(CI20 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI20+1))",
    "EP20": "IF(OR($AO$25, CJ20 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ20+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE164,BU20),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL20, 1),\n  DPM, (1+$DI20*CardRangeMastery*$DJ20*$AQ$9),\n  SuperTower, $DL20,\n  Rend, $DN20,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20, $DB20), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR20,\n  SM, $DT20,\n  SLM, $DU20,\n  SL, $DQ20,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM20, UltCritCard),\n\nCY20*(DE20*OtherDamage*SL+UwDamage*DF20)))",
    "EQ20": "IF(OR(CK20 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK20+1)*1%, 1),\n  CF, $DB20,\n  CC, MIN(100%, $CZ20 + 1%),\n  CCUW, DA20 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ165,BZ20) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC20 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR20,\n  CL, $DS20,\n  SM, $DT20,\n  SLM, $DU20,\n  SL, $DQ20,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM20, UltCritCard),\n\nCY20 * (Critical*DO20*SL+UwDamage*UWCritical)))",
    "ER20": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL20 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH165,BX20),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL20+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI20*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM165,CC20), $DV20, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH20,\n  Rapid, DG20,\n  SuperTower, $DL20,\n  Rend, $DN20,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM20,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20, $DB20), 1),\n\n  DW, $DR20,\n  CL, $DS20,\n  SM, $DT20,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY20*(DE20*OtherDamage*SL+UWDamage*DF20)))",
    "ES20": "IF(OR(CM20 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH20,\n  Rapid, DG20,\n  RDPM, (1+$DI20*$DJ20*$AQ$9),\n  Rend, $DN20,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK165,CA20),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM20+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20, $DB20), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR20,\n  CL, $DS20,\n  SM, $DT20,\n  SLM, $DU20,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY20*(DE20*OtherDamage*SL+UwDamage*DF20)))",
    "ET20": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN20 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM20,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN20+1, $DB20), 1),\n\n  DW, $DR20,\n  CL, $DS20,\n  SM, $DT20,\n  SLM, $DU20,\n  SL, $DQ20,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY20*(DE20*DO20*SL+UWDamage*DF20)))",
    "EU20": "IF(OR(NOT($BA$3), NOT($BA$23), $CO20 > $BA$15), \"\", 1 + 0.5*(CO20+1))",
    "EW20": "IF(DZ20=\"\", \"\", LET(\n  Now, CT20,\n  Next, DZ20,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT20),\nFactor/Cost))",
    "EX20": "IF(EA20=\"\",\"\",(EA20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU20))",
    "EY20": "IF(EB20=\"\",\"\",(EB20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV20))",
    "EZ20": "IF(EC20=\"\",\"\",(EC20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW20))",
    "FA20": "IF(ED20=\"\",\"\",(ED20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX20))",
    "FB20": "IF(EE20=\"\",\"\",(EE20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY20))",
    "FC20": "IF(EF20=\"\",\"\",(EF20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ20))",
    "FD20": "IF(EG20=\"\",\"\",(EG20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA20))",
    "FE20": "IF(EH20=\"\",\"\",(EH20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB20))",
    "FF20": "IF(EI20=\"\",\"\",(EI20/$DX20-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC20+1, 1, CC20))))",
    "FG20": "IF(EJ20=\"\",\"\",(EJ20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD20))",
    "FH20": "IF(EK20=\"\",\"\",(EK20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE20))",
    "FI20": "IF(EL20=\"\",\"\",(EL20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF20))",
    "FJ20": "IF(EM20=\"\", \"\", LET(\n  Now, CW20,\n  Next, EM20,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG20),\nFactor/Cost))",
    "FK20": "IF(EN20=\"\",\"\",(EN20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH20))",
    "FL20": "IF(EO20=\"\", \"\", LET(\n  Now, CS20,\n  Next, EO20,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI20),\nFactor/Cost))",
    "FM20": "IF(EP20=\"\",\"\",(EP20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ20))",
    "FN20": "IF(EQ20=\"\",\"\",(EQ20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK20))",
    "FO20": "IF(ER20=\"\",\"\",(ER20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL20))",
    "FP20": "IF(ES20=\"\",\"\",(ES20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM20))",
    "FQ20": "IF(ET20=\"\",\"\",(ET20/$DX20-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN20))",
    "FR20": "IF(EU20=\"\", \"\", LET(\n  Now, CX20,\n  Next, EU20,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO20),\nFactor/Cost))",
    "FT20": "IF(COLUMN(EW20:FR20) = MIN(IF(EW20:FR20=MAX(EW20:FR20), COLUMN(EW20:FR20))), 1, \"\")",
    "D21": "IF(SUM(FT20:GP20),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F21)),\"Card Mastery\",F21),G21)/$D$5,\"\")",
    "F21": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT20:GP20),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT20:GP20=1)),)\"),\"Damage / Meter\")",
    "G21": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT20:GP20),ARRAYFORMULA(FILTER(BT20:CP20 , FT20:GP20=1)),\"\"\"\")\"),3.0)",
    "I21": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT20:GP20),ARRAYFORMULA(FILTER(EW20:FS20 , FT20:GP20=1))*D$5,\"\"\"\")\"),0.6675079329618882)",
    "K21": "IF(H21<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D21)),)",
    "AI21": "'Master Sheet'!C47",
    "AU21": "(AU20*($AQ21-1)+100%)/$AQ21",
    "AV21": "(AV20*($AQ21-1)+100%)/$AQ21",
    "AY21": "3*(1+'Master Sheet'!C165)",
    "AZ21": "LET(\n  BaseOther, $CR$9,\n  Bounce, $CR10,\n  AtkSpeed, $DH5,\n  Rapid, $DG$5,\n  RDPM, DK5,\n  SuperTower, IF(AND($BA$3,$BA$10),1+(15 * $AZ$10 * INDEX($BK$5:$BK150,CA5) -1)/(45-3),1),\n  Rend, $DN5,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$10,1), CN5, $DB5), 1),\n  CardStUwMastery, 1+(15 * 35%*$AZ$10*INDEX($BK$5:$BK150,CA5)-1)/(45-3),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, CardStUwMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\n\n  Old, $DX$5,\n  New, CY5*(DE5*OtherDamage*SL+UwDamage*DF5),\n\nIF($BA$21,\"Owned\" ,(New/Old-1)/1000))",
    "BA21": "'Master Sheet'!AC24",
    "BC21": "BC20+1",
    "BD21": "BD20+BD$3",
    "BE21": "BE20+BE$3",
    "BF21": "BF20+BF$3",
    "BG21": "BG20+BG$3",
    "BH21": "BH20+BH$3",
    "BI21": "BI20+BI$3",
    "BJ21": "BJ20+BJ$3",
    "BK21": "BK20+BK$3",
    "BL21": "BL20+BL$3",
    "BM21": "BM20+BM$3",
    "BN21": "BN20+BN$3",
    "BP21": "BP20+BP$3",
    "BR21": "BR20+BR$3",
    "BT21": "BT20+FT20",
    "BU21": "BU20+FU20",
    "BV21": "BV20+FV20",
    "BW21": "BW20+FW20",
    "BX21": "BX20+FX20",
    "BY21": "BY20+FY20",
    "BZ21": "BZ20+FZ20",
    "CA21": "CA20+GA20",
    "CB21": "CB20+GB20",
    "CC21": "CC20+GC20",
    "CD21": "CD20+GD20",
    "CE21": "CE20+GE20",
    "CF21": "CF20+GF20",
    "CG21": "CG20+GG20",
    "CH21": "CH20+GH20",
    "CI21": "CI20+GI20",
    "CJ21": "CJ20+GJ20",
    "CK21": "CK20+GK20",
    "CL21": "CL20+GL20",
    "CM21": "CM20+GM20",
    "CN21": "CN20+GN20",
    "CO21": "CO20+GO20",
    "CS21": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI21,1)",
    "CT21": "INDEX($BD$5:$BD166,BT21)",
    "CU21": "INDEX($BN$5:$BN166,CD21)",
    "CV21": "INDEX($BO$5:$BO166,CE21)",
    "CW21": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG21)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX21": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO21, 1)",
    "CY21": "LET(\n  Base, $CR$6,\n  Damage, $CT21,\n  DamageMastery, $CS21,\n  DemonMastery, $CX21,\n  SPB, $CU21,\n  ITO, $CV21,\n  Shock, $CW21,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ21": "MIN(100%, DA21)",
    "DA21": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK21*1%, 0)",
    "DB21": "LET(\n  Lab, 1+INDEX($BF$5:$BF166,BV21),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC21": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK21*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI166,BY21) + CardCritMastery)",
    "DD21": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK21*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ166,BZ21) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE21": "LET(\n  CF, $DB21,\n  CC, $CZ21,\n  SCM, $DD21,\n  SCC, $DC21,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF21": "LET(\n  CF, $DB21,\n  CC, $DA21,\n  SCM, $DD21,\n  SCC, $DC21,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG21": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH21)), 0)",
    "DH21": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ21*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE166,BU21),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI21": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG166, BW21), 1) + $AE$9)",
    "DJ21": "LET(\n  DpmLab, INDEX($BH$5:$BH166,BX21),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL21, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK21": "(1+$DI21*$DJ21*$AQ$9)",
    "DL21": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK166,CA21),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM21*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM21": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK166,CA21),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM21*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN21": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL166,CB21)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO21": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH21,\n  Rapid, DG21,\n  RDPM, DK21,\n  SuperTower, $DL21,\n  Rend, $DN21,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP21": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ21": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK21),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR21": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP21),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF21-1))",
    "DS21": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG21, DH21),0))",
    "DT21": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP21),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV21, $AR$29), 0))",
    "DU21": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK21),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM166,CC21), $DV21, $AR$29), 0))",
    "DV21": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH21), $AO$29)",
    "DW21": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM21,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21, $DB21), 1),\n\n  DW, $DR21,\n  CL, $DS21,\n  SM, $DT21,\n  SLM, $DU21,\n  SL, $DQ21,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX21": "CY21*(DE21*DO21*DQ21+DW21*DF21)",
    "DZ21": "IF(INDEX($BD$6:$BD166,BT21)=\"\", \"\", INDEX($BD$5:$BD166,BT21+1))",
    "EA21": "IF(OR($AO$25, INDEX($BE$6:$BE166,BU21)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ21)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE166,BU21+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI21*$DJ21*$AQ$9),\n  SuperTower, $DL21,\n  Rend, $DN21,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21, $DB21), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR21,\n  SM, $DT21,\n  SLM, $DU21,\n  SL, $DQ21,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM21, UltCritCard),\n\nCY21*(DE21*OtherDamage*SL+UwDamage*DF21)))",
    "EB21": "IF(INDEX($BF$6:$BF166,BV21)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF166,BV21+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ21,\n  CCUW, $DA21,\n  SCM, $DD21,\n  SCC, $DC21,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21, CF), 1),\n\n  DW, $DR21,\n  CL, $DS21,\n  SM, $DT21,\n  SLM, $DU21,\n  SL, $DQ21,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM21, UltCritCard),\n\nCY21 * (Critical * DO21 * SL + UwDamage * UWCritical)))",
    "EC21": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG166,BW21)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH21,\n  Rapid, DG21,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG166, BW21+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ21*$AQ$9),\n  SuperTower, $DL21,\n  Rend, $DN21,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM166,CC21), $DV21, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM21,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21, $DB21), 1),\n\n  DW, $DR21,\n  CL, $DS21,\n  SM, $DT21,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY21*(DE21*OtherDamage*SL+UWDamage*DF21)))",
    "ED21": "IF(OR($AO$25, INDEX($BH$6:$BH166,BX21)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH166,BX21+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL21, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI21*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM166,CC21), $DV21, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH21,\n  Rapid, DG21,\n  SuperTower, $DL21,\n  Rend, $DN21,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM21,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21, $DB21), 1),\n\n  DW, $DR21,\n  CL, $DS21,\n  SM, $DT21,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY21*(DE21*OtherDamage*SL+UWDamage*DF21)))",
    "EE21": "IF(INDEX($BI$6:$BI166,BY21)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK21, 0),\n  CF, $DB21,\n  CC, $CZ21,\n  CCUW, $DA21,\n  SCM, $DD21,\n  SCC, $AV$17+INDEX($BI$5:$BI166,BY21+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY21 * (Critical*DO21*$DQ21+DW21*UWCritical)))",
    "EF21": "IF(INDEX($BJ$6:$BJ166,BZ21)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK21*1%, 1),\n  CF, $DB21,\n  CC, $CZ21,\n  CCUW, $DA21,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ166,BZ21+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC21,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY21*(Critical*DO21*$DQ21+DW21*UWCritical)))",
    "EG21": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK166,CA21)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH21,\n  Rapid, DG21,\n  DPM, (1+$DI21*$DJ21*$AQ$9),\n  Rend, $DN21,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK166,CA21+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM21*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21, $DB21), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK166,CA21+1)-1))/(45-CM21*3),1),\n\n  SL, $DQ21,\n  DW, $DR21,\n  CL, $DS21,\n  SM, $DT21,\n  SLM, $DU21,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY21*(DE21*OtherDamage*SL+UwDamage*DF21)))",
    "EH21": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL166,CB21+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL166,CB21)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH21,\n  Rapid, DG21,\n  DPM, (1+$DI21*$DJ21*$AQ$9),\n  SuperTower, $DL21,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL166,CB21+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY21*(DE21*OtherDamage*$DQ21+DW21*DF21)))",
    "EI21": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM166,CC21)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21, $DB21), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK21),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV21, $AR$29), 0),\n\n  DW, $DR21,\n  CL, $DS21,\n  SM, $DT21,\n  SL, $DQ21,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM21, UltCritCard),\nCY21*(DE21*DO21*SL+UwDamage*DF21)))",
    "EJ21": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN166,CD21)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT21,\n  DamageMastery, $CS21,\n  DemonMastery, $CX21,\n  SPB, INDEX($BN$5:$BN166,CD21+1),\n  ITO, $CV21,\n  Shock, $CW21,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE21*DO21*$DQ21+DW21*DF21)))",
    "EK21": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO166,CE21)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT21,\n  DamageMastery, $CS21,\n  DemonMastery, $CX21,\n  SPB, $CU21,\n  ITO, INDEX($BO$5:$BO166,CE21+1),\n  Shock, $CW21,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE21*DO21*$DQ21+DW21*DF21)))",
    "EL21": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP166,CF21)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21, $DB21), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP21),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF21),\n  CL, $DS21,\n  SM, $DT21,\n  SLM, $DU21,\n  SL, $DQ21,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM21, UltCritCard),\nCY21*(DE21*DO21*SL+UwDamage*DF21)))",
    "EM21": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ166,CG21)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG21+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN21": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR166,CH21)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21, $DB21), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH21+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP21),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK21),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM166,CC21), SMHeat, $AR$29), 0),\n\n  DW, $DR21,\n  CL, $DS21,\n  SL, $DQ21,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM21, UltCritCard),\nCY21*(DE21*DO21*SL+UwDamage*DF21)))",
    "EO21": "IF(OR(CI21 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI21+1))",
    "EP21": "IF(OR($AO$25, CJ21 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ21+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE165,BU21),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL21, 1),\n  DPM, (1+$DI21*CardRangeMastery*$DJ21*$AQ$9),\n  SuperTower, $DL21,\n  Rend, $DN21,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21, $DB21), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR21,\n  SM, $DT21,\n  SLM, $DU21,\n  SL, $DQ21,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM21, UltCritCard),\n\nCY21*(DE21*OtherDamage*SL+UwDamage*DF21)))",
    "EQ21": "IF(OR(CK21 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK21+1)*1%, 1),\n  CF, $DB21,\n  CC, MIN(100%, $CZ21 + 1%),\n  CCUW, DA21 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ166,BZ21) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC21 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR21,\n  CL, $DS21,\n  SM, $DT21,\n  SLM, $DU21,\n  SL, $DQ21,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM21, UltCritCard),\n\nCY21 * (Critical*DO21*SL+UwDamage*UWCritical)))",
    "ER21": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL21 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH166,BX21),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL21+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI21*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM166,CC21), $DV21, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH21,\n  Rapid, DG21,\n  SuperTower, $DL21,\n  Rend, $DN21,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM21,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21, $DB21), 1),\n\n  DW, $DR21,\n  CL, $DS21,\n  SM, $DT21,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY21*(DE21*OtherDamage*SL+UWDamage*DF21)))",
    "ES21": "IF(OR(CM21 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH21,\n  Rapid, DG21,\n  RDPM, (1+$DI21*$DJ21*$AQ$9),\n  Rend, $DN21,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK166,CA21),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM21+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21, $DB21), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR21,\n  CL, $DS21,\n  SM, $DT21,\n  SLM, $DU21,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY21*(DE21*OtherDamage*SL+UwDamage*DF21)))",
    "ET21": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN21 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM21,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN21+1, $DB21), 1),\n\n  DW, $DR21,\n  CL, $DS21,\n  SM, $DT21,\n  SLM, $DU21,\n  SL, $DQ21,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY21*(DE21*DO21*SL+UWDamage*DF21)))",
    "EU21": "IF(OR(NOT($BA$3), NOT($BA$23), $CO21 > $BA$15), \"\", 1 + 0.5*(CO21+1))",
    "EW21": "IF(DZ21=\"\", \"\", LET(\n  Now, CT21,\n  Next, DZ21,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT21),\nFactor/Cost))",
    "EX21": "IF(EA21=\"\",\"\",(EA21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU21))",
    "EY21": "IF(EB21=\"\",\"\",(EB21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV21))",
    "EZ21": "IF(EC21=\"\",\"\",(EC21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW21))",
    "FA21": "IF(ED21=\"\",\"\",(ED21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX21))",
    "FB21": "IF(EE21=\"\",\"\",(EE21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY21))",
    "FC21": "IF(EF21=\"\",\"\",(EF21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ21))",
    "FD21": "IF(EG21=\"\",\"\",(EG21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA21))",
    "FE21": "IF(EH21=\"\",\"\",(EH21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB21))",
    "FF21": "IF(EI21=\"\",\"\",(EI21/$DX21-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC21+1, 1, CC21))))",
    "FG21": "IF(EJ21=\"\",\"\",(EJ21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD21))",
    "FH21": "IF(EK21=\"\",\"\",(EK21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE21))",
    "FI21": "IF(EL21=\"\",\"\",(EL21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF21))",
    "FJ21": "IF(EM21=\"\", \"\", LET(\n  Now, CW21,\n  Next, EM21,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG21),\nFactor/Cost))",
    "FK21": "IF(EN21=\"\",\"\",(EN21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH21))",
    "FL21": "IF(EO21=\"\", \"\", LET(\n  Now, CS21,\n  Next, EO21,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI21),\nFactor/Cost))",
    "FM21": "IF(EP21=\"\",\"\",(EP21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ21))",
    "FN21": "IF(EQ21=\"\",\"\",(EQ21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK21))",
    "FO21": "IF(ER21=\"\",\"\",(ER21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL21))",
    "FP21": "IF(ES21=\"\",\"\",(ES21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM21))",
    "FQ21": "IF(ET21=\"\",\"\",(ET21/$DX21-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN21))",
    "FR21": "IF(EU21=\"\", \"\", LET(\n  Now, CX21,\n  Next, EU21,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO21),\nFactor/Cost))",
    "FT21": "IF(COLUMN(EW21:FR21) = MIN(IF(EW21:FR21=MAX(EW21:FR21), COLUMN(EW21:FR21))), 1, \"\")",
    "D22": "IF(SUM(FT21:GP21),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F22)),\"Card Mastery\",F22),G22)/$D$5,\"\")",
    "F22": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT21:GP21),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT21:GP21=1)),)\"),\"Attack Speed\")",
    "G22": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT21:GP21),ARRAYFORMULA(FILTER(BT21:CP21 , FT21:GP21=1)),\"\"\"\")\"),5.0)",
    "I22": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT21:GP21),ARRAYFORMULA(FILTER(EW21:FS21 , FT21:GP21=1))*D$5,\"\"\"\")\"),0.5103627138458919)",
    "K22": "IF(H22<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D22)),)",
    "AD22": "IF(EQ(AE22, 250), \"-\", LET(\n  Next, EQ($AE$21, \"Next Tier\"),\n  Common, EQ($AE$21, \"Common\"),\n  Rare, EQ($AE$21, \"Rare\"),\n  Epic, EQ($AE$21, \"Epic\"),\n  Legendary, EQ($AE$21, \"Legendary\"),\n  Mythic, EQ($AE$21, \"Mythic\"),\n  Ancestral, EQ($AE$21, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE22=0, 8, AE22=8, 15, AE22=15, 25, AE22=25, 50, AE22=50, 100, AE22=100, 250), Common, 8, Rare, 15, Epic, 25, Legendary, 50, Mythic, 100, Ancestral, 250), 0),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, Planner),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP5),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DwQuant, DWCooldown, CF5-1),\n\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*DO5*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE22": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$20:$AU$25\"), MATCH(AC22,INDIRECT($C$2 & \"!$AR$20:$AR$25\"), 0)),0)",
    "AL22": "MAX('Master Sheet'!I30:J30)",
    "AN22": "20-(0.15*AL22) & \" Sec\"",
    "AT22": "AU22 & \" Sec\"",
    "AU22": "LEFT(AN22, LEN(AN22) - 4)+AE16",
    "AY22": "0.33%*(1+'Master Sheet'!C171)",
    "AZ22": "LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5+1, $DB5), 1),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  Old, $DX$5,\n  New, CY5*(DE5*DO5*SL+UwDamage*DF5),\n\nIF(BA22,\"Owned\" ,(New/Old-1)/750))",
    "BA22": "'Master Sheet'!AC30",
    "BC22": "BC21+1",
    "BD22": "BD21+BD$3",
    "BE22": "BE21+BE$3",
    "BF22": "BF21+BF$3",
    "BG22": "BG21+BG$3",
    "BH22": "BH21+BH$3",
    "BI22": "BI21+BI$3",
    "BJ22": "BJ21+BJ$3",
    "BK22": "BK21+BK$3",
    "BL22": "BL21+BL$3",
    "BM22": "BM21+BM$3",
    "BN22": "BN21+BN$3",
    "BP22": "BP21+BP$3",
    "BR22": "BR21+BR$3",
    "BT22": "BT21+FT21",
    "BU22": "BU21+FU21",
    "BV22": "BV21+FV21",
    "BW22": "BW21+FW21",
    "BX22": "BX21+FX21",
    "BY22": "BY21+FY21",
    "BZ22": "BZ21+FZ21",
    "CA22": "CA21+GA21",
    "CB22": "CB21+GB21",
    "CC22": "CC21+GC21",
    "CD22": "CD21+GD21",
    "CE22": "CE21+GE21",
    "CF22": "CF21+GF21",
    "CG22": "CG21+GG21",
    "CH22": "CH21+GH21",
    "CI22": "CI21+GI21",
    "CJ22": "CJ21+GJ21",
    "CK22": "CK21+GK21",
    "CL22": "CL21+GL21",
    "CM22": "CM21+GM21",
    "CN22": "CN21+GN21",
    "CO22": "CO21+GO21",
    "CS22": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI22,1)",
    "CT22": "INDEX($BD$5:$BD167,BT22)",
    "CU22": "INDEX($BN$5:$BN167,CD22)",
    "CV22": "INDEX($BO$5:$BO167,CE22)",
    "CW22": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG22)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX22": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO22, 1)",
    "CY22": "LET(\n  Base, $CR$6,\n  Damage, $CT22,\n  DamageMastery, $CS22,\n  DemonMastery, $CX22,\n  SPB, $CU22,\n  ITO, $CV22,\n  Shock, $CW22,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ22": "MIN(100%, DA22)",
    "DA22": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK22*1%, 0)",
    "DB22": "LET(\n  Lab, 1+INDEX($BF$5:$BF167,BV22),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC22": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK22*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI167,BY22) + CardCritMastery)",
    "DD22": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK22*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ167,BZ22) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE22": "LET(\n  CF, $DB22,\n  CC, $CZ22,\n  SCM, $DD22,\n  SCC, $DC22,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF22": "LET(\n  CF, $DB22,\n  CC, $DA22,\n  SCM, $DD22,\n  SCC, $DC22,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG22": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH22)), 0)",
    "DH22": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ22*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE167,BU22),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI22": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG167, BW22), 1) + $AE$9)",
    "DJ22": "LET(\n  DpmLab, INDEX($BH$5:$BH167,BX22),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL22, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK22": "(1+$DI22*$DJ22*$AQ$9)",
    "DL22": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK167,CA22),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM22*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM22": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK167,CA22),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM22*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN22": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL167,CB22)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO22": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH22,\n  Rapid, DG22,\n  RDPM, DK22,\n  SuperTower, $DL22,\n  Rend, $DN22,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP22": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ22": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK22),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR22": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP22),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF22-1))",
    "DS22": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG22, DH22),0))",
    "DT22": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP22),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV22, $AR$29), 0))",
    "DU22": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK22),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM167,CC22), $DV22, $AR$29), 0))",
    "DV22": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH22), $AO$29)",
    "DW22": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM22,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22, $DB22), 1),\n\n  DW, $DR22,\n  CL, $DS22,\n  SM, $DT22,\n  SLM, $DU22,\n  SL, $DQ22,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX22": "CY22*(DE22*DO22*DQ22+DW22*DF22)",
    "DZ22": "IF(INDEX($BD$6:$BD167,BT22)=\"\", \"\", INDEX($BD$5:$BD167,BT22+1))",
    "EA22": "IF(OR($AO$25, INDEX($BE$6:$BE167,BU22)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ22)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE167,BU22+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI22*$DJ22*$AQ$9),\n  SuperTower, $DL22,\n  Rend, $DN22,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22, $DB22), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR22,\n  SM, $DT22,\n  SLM, $DU22,\n  SL, $DQ22,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM22, UltCritCard),\n\nCY22*(DE22*OtherDamage*SL+UwDamage*DF22)))",
    "EB22": "IF(INDEX($BF$6:$BF167,BV22)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF167,BV22+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ22,\n  CCUW, $DA22,\n  SCM, $DD22,\n  SCC, $DC22,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22, CF), 1),\n\n  DW, $DR22,\n  CL, $DS22,\n  SM, $DT22,\n  SLM, $DU22,\n  SL, $DQ22,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM22, UltCritCard),\n\nCY22 * (Critical * DO22 * SL + UwDamage * UWCritical)))",
    "EC22": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG167,BW22)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH22,\n  Rapid, DG22,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG167, BW22+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ22*$AQ$9),\n  SuperTower, $DL22,\n  Rend, $DN22,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM167,CC22), $DV22, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM22,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22, $DB22), 1),\n\n  DW, $DR22,\n  CL, $DS22,\n  SM, $DT22,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY22*(DE22*OtherDamage*SL+UWDamage*DF22)))",
    "ED22": "IF(OR($AO$25, INDEX($BH$6:$BH167,BX22)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH167,BX22+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL22, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI22*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM167,CC22), $DV22, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH22,\n  Rapid, DG22,\n  SuperTower, $DL22,\n  Rend, $DN22,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM22,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22, $DB22), 1),\n\n  DW, $DR22,\n  CL, $DS22,\n  SM, $DT22,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY22*(DE22*OtherDamage*SL+UWDamage*DF22)))",
    "EE22": "IF(INDEX($BI$6:$BI167,BY22)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK22, 0),\n  CF, $DB22,\n  CC, $CZ22,\n  CCUW, $DA22,\n  SCM, $DD22,\n  SCC, $AV$17+INDEX($BI$5:$BI167,BY22+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY22 * (Critical*DO22*$DQ22+DW22*UWCritical)))",
    "EF22": "IF(INDEX($BJ$6:$BJ167,BZ22)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK22*1%, 1),\n  CF, $DB22,\n  CC, $CZ22,\n  CCUW, $DA22,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ167,BZ22+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC22,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY22*(Critical*DO22*$DQ22+DW22*UWCritical)))",
    "EG22": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK167,CA22)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH22,\n  Rapid, DG22,\n  DPM, (1+$DI22*$DJ22*$AQ$9),\n  Rend, $DN22,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK167,CA22+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM22*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22, $DB22), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK167,CA22+1)-1))/(45-CM22*3),1),\n\n  SL, $DQ22,\n  DW, $DR22,\n  CL, $DS22,\n  SM, $DT22,\n  SLM, $DU22,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY22*(DE22*OtherDamage*SL+UwDamage*DF22)))",
    "EH22": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL167,CB22+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL167,CB22)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH22,\n  Rapid, DG22,\n  DPM, (1+$DI22*$DJ22*$AQ$9),\n  SuperTower, $DL22,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL167,CB22+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY22*(DE22*OtherDamage*$DQ22+DW22*DF22)))",
    "EI22": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM167,CC22)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22, $DB22), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK22),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV22, $AR$29), 0),\n\n  DW, $DR22,\n  CL, $DS22,\n  SM, $DT22,\n  SL, $DQ22,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM22, UltCritCard),\nCY22*(DE22*DO22*SL+UwDamage*DF22)))",
    "EJ22": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN167,CD22)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT22,\n  DamageMastery, $CS22,\n  DemonMastery, $CX22,\n  SPB, INDEX($BN$5:$BN167,CD22+1),\n  ITO, $CV22,\n  Shock, $CW22,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE22*DO22*$DQ22+DW22*DF22)))",
    "EK22": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO167,CE22)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT22,\n  DamageMastery, $CS22,\n  DemonMastery, $CX22,\n  SPB, $CU22,\n  ITO, INDEX($BO$5:$BO167,CE22+1),\n  Shock, $CW22,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE22*DO22*$DQ22+DW22*DF22)))",
    "EL22": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP167,CF22)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22, $DB22), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP22),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF22),\n  CL, $DS22,\n  SM, $DT22,\n  SLM, $DU22,\n  SL, $DQ22,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM22, UltCritCard),\nCY22*(DE22*DO22*SL+UwDamage*DF22)))",
    "EM22": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ167,CG22)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG22+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN22": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR167,CH22)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22, $DB22), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH22+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP22),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK22),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM167,CC22), SMHeat, $AR$29), 0),\n\n  DW, $DR22,\n  CL, $DS22,\n  SL, $DQ22,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM22, UltCritCard),\nCY22*(DE22*DO22*SL+UwDamage*DF22)))",
    "EO22": "IF(OR(CI22 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI22+1))",
    "EP22": "IF(OR($AO$25, CJ22 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ22+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE166,BU22),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL22, 1),\n  DPM, (1+$DI22*CardRangeMastery*$DJ22*$AQ$9),\n  SuperTower, $DL22,\n  Rend, $DN22,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22, $DB22), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR22,\n  SM, $DT22,\n  SLM, $DU22,\n  SL, $DQ22,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM22, UltCritCard),\n\nCY22*(DE22*OtherDamage*SL+UwDamage*DF22)))",
    "EQ22": "IF(OR(CK22 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK22+1)*1%, 1),\n  CF, $DB22,\n  CC, MIN(100%, $CZ22 + 1%),\n  CCUW, DA22 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ167,BZ22) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC22 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR22,\n  CL, $DS22,\n  SM, $DT22,\n  SLM, $DU22,\n  SL, $DQ22,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM22, UltCritCard),\n\nCY22 * (Critical*DO22*SL+UwDamage*UWCritical)))",
    "ER22": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL22 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH167,BX22),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL22+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI22*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM167,CC22), $DV22, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH22,\n  Rapid, DG22,\n  SuperTower, $DL22,\n  Rend, $DN22,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM22,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22, $DB22), 1),\n\n  DW, $DR22,\n  CL, $DS22,\n  SM, $DT22,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY22*(DE22*OtherDamage*SL+UWDamage*DF22)))",
    "ES22": "IF(OR(CM22 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH22,\n  Rapid, DG22,\n  RDPM, (1+$DI22*$DJ22*$AQ$9),\n  Rend, $DN22,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK167,CA22),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM22+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22, $DB22), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR22,\n  CL, $DS22,\n  SM, $DT22,\n  SLM, $DU22,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY22*(DE22*OtherDamage*SL+UwDamage*DF22)))",
    "ET22": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN22 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM22,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN22+1, $DB22), 1),\n\n  DW, $DR22,\n  CL, $DS22,\n  SM, $DT22,\n  SLM, $DU22,\n  SL, $DQ22,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY22*(DE22*DO22*SL+UWDamage*DF22)))",
    "EU22": "IF(OR(NOT($BA$3), NOT($BA$23), $CO22 > $BA$15), \"\", 1 + 0.5*(CO22+1))",
    "EW22": "IF(DZ22=\"\", \"\", LET(\n  Now, CT22,\n  Next, DZ22,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT22),\nFactor/Cost))",
    "EX22": "IF(EA22=\"\",\"\",(EA22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU22))",
    "EY22": "IF(EB22=\"\",\"\",(EB22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV22))",
    "EZ22": "IF(EC22=\"\",\"\",(EC22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW22))",
    "FA22": "IF(ED22=\"\",\"\",(ED22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX22))",
    "FB22": "IF(EE22=\"\",\"\",(EE22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY22))",
    "FC22": "IF(EF22=\"\",\"\",(EF22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ22))",
    "FD22": "IF(EG22=\"\",\"\",(EG22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA22))",
    "FE22": "IF(EH22=\"\",\"\",(EH22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB22))",
    "FF22": "IF(EI22=\"\",\"\",(EI22/$DX22-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC22+1, 1, CC22))))",
    "FG22": "IF(EJ22=\"\",\"\",(EJ22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD22))",
    "FH22": "IF(EK22=\"\",\"\",(EK22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE22))",
    "FI22": "IF(EL22=\"\",\"\",(EL22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF22))",
    "FJ22": "IF(EM22=\"\", \"\", LET(\n  Now, CW22,\n  Next, EM22,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG22),\nFactor/Cost))",
    "FK22": "IF(EN22=\"\",\"\",(EN22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH22))",
    "FL22": "IF(EO22=\"\", \"\", LET(\n  Now, CS22,\n  Next, EO22,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI22),\nFactor/Cost))",
    "FM22": "IF(EP22=\"\",\"\",(EP22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ22))",
    "FN22": "IF(EQ22=\"\",\"\",(EQ22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK22))",
    "FO22": "IF(ER22=\"\",\"\",(ER22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL22))",
    "FP22": "IF(ES22=\"\",\"\",(ES22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM22))",
    "FQ22": "IF(ET22=\"\",\"\",(ET22/$DX22-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN22))",
    "FR22": "IF(EU22=\"\", \"\", LET(\n  Now, CX22,\n  Next, EU22,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO22),\nFactor/Cost))",
    "FT22": "IF(COLUMN(EW22:FR22) = MIN(IF(EW22:FR22=MAX(EW22:FR22), COLUMN(EW22:FR22))), 1, \"\")",
    "D23": "IF(SUM(FT22:GP22),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F23)),\"Card Mastery\",F23),G23)/$D$5,\"\")",
    "F23": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT22:GP22),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT22:GP22=1)),)\"),\"Damage\")",
    "G23": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT22:GP22),ARRAYFORMULA(FILTER(BT22:CP22 , FT22:GP22=1)),\"\"\"\")\"),5.0)",
    "I23": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT22:GP22),ARRAYFORMULA(FILTER(EW22:FS22 , FT22:GP22=1))*D$5,\"\"\"\")\"),0.505529225908375)",
    "K23": "IF(H23<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D23)),)",
    "AD23": "IF(EQ(AE23, 3), \"-\", LET(\n  Next, EQ($AE$21, \"Next Tier\"),\n  Common, EQ($AE$21, \"Common\"),\n  Rare, EQ($AE$21, \"Rare\"),\n  Epic, EQ($AE$21, \"Epic\"),\n  Legendary, EQ($AE$21, \"Legendary\"),\n  Mythic, EQ($AE$21, \"Mythic\"),\n  Ancestral, EQ($AE$21, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE23=0, 1, AE23=1, 2, AE23=2, 3), Legendary, 1, Mythic, 2, Ancestral, 3), 0),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, Planner, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP5),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DwQuant, DWCooldown, CF5-1),\n\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*DO5*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE23": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$20:$AU$25\"), MATCH(AC23,INDIRECT($C$2 & \"!$AR$20:$AR$25\"), 0)),0)",
    "AI23": "'Master Sheet'!C96",
    "AJ23": "'Master Sheet'!E96",
    "AK23": "1+AI23*3%",
    "AY23": "1+0.5*(1+'Master Sheet'!C167)",
    "AZ23": "IF(BA23,\"Owned\" ,0.5/1000)",
    "BA23": "'Master Sheet'!AC26",
    "BC23": "BC22+1",
    "BD23": "BD22+BD$3",
    "BE23": "BE22+BE$3",
    "BF23": "BF22+BF$3",
    "BG23": "BG22+BG$3",
    "BH23": "BH22+BH$3",
    "BI23": "BI22+BI$3",
    "BJ23": "BJ22+BJ$3",
    "BK23": "BK22+BK$3",
    "BL23": "BL22+BL$3",
    "BM23": "BM22+BM$3",
    "BN23": "BN22+BN$3",
    "BP23": "BP22+BP$3",
    "BR23": "BR22+BR$3",
    "BT23": "BT22+FT22",
    "BU23": "BU22+FU22",
    "BV23": "BV22+FV22",
    "BW23": "BW22+FW22",
    "BX23": "BX22+FX22",
    "BY23": "BY22+FY22",
    "BZ23": "BZ22+FZ22",
    "CA23": "CA22+GA22",
    "CB23": "CB22+GB22",
    "CC23": "CC22+GC22",
    "CD23": "CD22+GD22",
    "CE23": "CE22+GE22",
    "CF23": "CF22+GF22",
    "CG23": "CG22+GG22",
    "CH23": "CH22+GH22",
    "CI23": "CI22+GI22",
    "CJ23": "CJ22+GJ22",
    "CK23": "CK22+GK22",
    "CL23": "CL22+GL22",
    "CM23": "CM22+GM22",
    "CN23": "CN22+GN22",
    "CO23": "CO22+GO22",
    "CS23": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI23,1)",
    "CT23": "INDEX($BD$5:$BD168,BT23)",
    "CU23": "INDEX($BN$5:$BN168,CD23)",
    "CV23": "INDEX($BO$5:$BO168,CE23)",
    "CW23": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG23)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX23": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO23, 1)",
    "CY23": "LET(\n  Base, $CR$6,\n  Damage, $CT23,\n  DamageMastery, $CS23,\n  DemonMastery, $CX23,\n  SPB, $CU23,\n  ITO, $CV23,\n  Shock, $CW23,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ23": "MIN(100%, DA23)",
    "DA23": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK23*1%, 0)",
    "DB23": "LET(\n  Lab, 1+INDEX($BF$5:$BF168,BV23),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC23": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK23*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI168,BY23) + CardCritMastery)",
    "DD23": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK23*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ168,BZ23) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE23": "LET(\n  CF, $DB23,\n  CC, $CZ23,\n  SCM, $DD23,\n  SCC, $DC23,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF23": "LET(\n  CF, $DB23,\n  CC, $DA23,\n  SCM, $DD23,\n  SCC, $DC23,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG23": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH23)), 0)",
    "DH23": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ23*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE168,BU23),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI23": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG168, BW23), 1) + $AE$9)",
    "DJ23": "LET(\n  DpmLab, INDEX($BH$5:$BH168,BX23),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL23, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK23": "(1+$DI23*$DJ23*$AQ$9)",
    "DL23": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK168,CA23),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM23*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM23": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK168,CA23),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM23*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN23": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL168,CB23)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO23": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH23,\n  Rapid, DG23,\n  RDPM, DK23,\n  SuperTower, $DL23,\n  Rend, $DN23,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP23": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ23": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK23),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR23": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP23),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF23-1))",
    "DS23": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG23, DH23),0))",
    "DT23": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP23),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV23, $AR$29), 0))",
    "DU23": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK23),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM168,CC23), $DV23, $AR$29), 0))",
    "DV23": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH23), $AO$29)",
    "DW23": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM23,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23, $DB23), 1),\n\n  DW, $DR23,\n  CL, $DS23,\n  SM, $DT23,\n  SLM, $DU23,\n  SL, $DQ23,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX23": "CY23*(DE23*DO23*DQ23+DW23*DF23)",
    "DZ23": "IF(INDEX($BD$6:$BD168,BT23)=\"\", \"\", INDEX($BD$5:$BD168,BT23+1))",
    "EA23": "IF(OR($AO$25, INDEX($BE$6:$BE168,BU23)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ23)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE168,BU23+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI23*$DJ23*$AQ$9),\n  SuperTower, $DL23,\n  Rend, $DN23,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23, $DB23), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR23,\n  SM, $DT23,\n  SLM, $DU23,\n  SL, $DQ23,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM23, UltCritCard),\n\nCY23*(DE23*OtherDamage*SL+UwDamage*DF23)))",
    "EB23": "IF(INDEX($BF$6:$BF168,BV23)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF168,BV23+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ23,\n  CCUW, $DA23,\n  SCM, $DD23,\n  SCC, $DC23,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23, CF), 1),\n\n  DW, $DR23,\n  CL, $DS23,\n  SM, $DT23,\n  SLM, $DU23,\n  SL, $DQ23,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM23, UltCritCard),\n\nCY23 * (Critical * DO23 * SL + UwDamage * UWCritical)))",
    "EC23": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG168,BW23)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH23,\n  Rapid, DG23,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG168, BW23+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ23*$AQ$9),\n  SuperTower, $DL23,\n  Rend, $DN23,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM168,CC23), $DV23, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM23,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23, $DB23), 1),\n\n  DW, $DR23,\n  CL, $DS23,\n  SM, $DT23,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY23*(DE23*OtherDamage*SL+UWDamage*DF23)))",
    "ED23": "IF(OR($AO$25, INDEX($BH$6:$BH168,BX23)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH168,BX23+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL23, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI23*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM168,CC23), $DV23, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH23,\n  Rapid, DG23,\n  SuperTower, $DL23,\n  Rend, $DN23,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM23,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23, $DB23), 1),\n\n  DW, $DR23,\n  CL, $DS23,\n  SM, $DT23,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY23*(DE23*OtherDamage*SL+UWDamage*DF23)))",
    "EE23": "IF(INDEX($BI$6:$BI168,BY23)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK23, 0),\n  CF, $DB23,\n  CC, $CZ23,\n  CCUW, $DA23,\n  SCM, $DD23,\n  SCC, $AV$17+INDEX($BI$5:$BI168,BY23+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY23 * (Critical*DO23*$DQ23+DW23*UWCritical)))",
    "EF23": "IF(INDEX($BJ$6:$BJ168,BZ23)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK23*1%, 1),\n  CF, $DB23,\n  CC, $CZ23,\n  CCUW, $DA23,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ168,BZ23+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC23,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY23*(Critical*DO23*$DQ23+DW23*UWCritical)))",
    "EG23": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK168,CA23)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH23,\n  Rapid, DG23,\n  DPM, (1+$DI23*$DJ23*$AQ$9),\n  Rend, $DN23,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK168,CA23+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM23*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23, $DB23), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK168,CA23+1)-1))/(45-CM23*3),1),\n\n  SL, $DQ23,\n  DW, $DR23,\n  CL, $DS23,\n  SM, $DT23,\n  SLM, $DU23,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY23*(DE23*OtherDamage*SL+UwDamage*DF23)))",
    "EH23": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL168,CB23+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL168,CB23)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH23,\n  Rapid, DG23,\n  DPM, (1+$DI23*$DJ23*$AQ$9),\n  SuperTower, $DL23,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL168,CB23+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY23*(DE23*OtherDamage*$DQ23+DW23*DF23)))",
    "EI23": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM168,CC23)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23, $DB23), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK23),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV23, $AR$29), 0),\n\n  DW, $DR23,\n  CL, $DS23,\n  SM, $DT23,\n  SL, $DQ23,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM23, UltCritCard),\nCY23*(DE23*DO23*SL+UwDamage*DF23)))",
    "EJ23": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN168,CD23)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT23,\n  DamageMastery, $CS23,\n  DemonMastery, $CX23,\n  SPB, INDEX($BN$5:$BN168,CD23+1),\n  ITO, $CV23,\n  Shock, $CW23,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE23*DO23*$DQ23+DW23*DF23)))",
    "EK23": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO168,CE23)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT23,\n  DamageMastery, $CS23,\n  DemonMastery, $CX23,\n  SPB, $CU23,\n  ITO, INDEX($BO$5:$BO168,CE23+1),\n  Shock, $CW23,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE23*DO23*$DQ23+DW23*DF23)))",
    "EL23": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP168,CF23)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23, $DB23), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP23),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF23),\n  CL, $DS23,\n  SM, $DT23,\n  SLM, $DU23,\n  SL, $DQ23,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM23, UltCritCard),\nCY23*(DE23*DO23*SL+UwDamage*DF23)))",
    "EM23": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ168,CG23)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG23+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN23": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR168,CH23)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23, $DB23), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH23+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP23),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK23),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM168,CC23), SMHeat, $AR$29), 0),\n\n  DW, $DR23,\n  CL, $DS23,\n  SL, $DQ23,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM23, UltCritCard),\nCY23*(DE23*DO23*SL+UwDamage*DF23)))",
    "EO23": "IF(OR(CI23 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI23+1))",
    "EP23": "IF(OR($AO$25, CJ23 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ23+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE167,BU23),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL23, 1),\n  DPM, (1+$DI23*CardRangeMastery*$DJ23*$AQ$9),\n  SuperTower, $DL23,\n  Rend, $DN23,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23, $DB23), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR23,\n  SM, $DT23,\n  SLM, $DU23,\n  SL, $DQ23,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM23, UltCritCard),\n\nCY23*(DE23*OtherDamage*SL+UwDamage*DF23)))",
    "EQ23": "IF(OR(CK23 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK23+1)*1%, 1),\n  CF, $DB23,\n  CC, MIN(100%, $CZ23 + 1%),\n  CCUW, DA23 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ168,BZ23) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC23 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR23,\n  CL, $DS23,\n  SM, $DT23,\n  SLM, $DU23,\n  SL, $DQ23,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM23, UltCritCard),\n\nCY23 * (Critical*DO23*SL+UwDamage*UWCritical)))",
    "ER23": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL23 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH168,BX23),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL23+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI23*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM168,CC23), $DV23, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH23,\n  Rapid, DG23,\n  SuperTower, $DL23,\n  Rend, $DN23,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM23,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23, $DB23), 1),\n\n  DW, $DR23,\n  CL, $DS23,\n  SM, $DT23,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY23*(DE23*OtherDamage*SL+UWDamage*DF23)))",
    "ES23": "IF(OR(CM23 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH23,\n  Rapid, DG23,\n  RDPM, (1+$DI23*$DJ23*$AQ$9),\n  Rend, $DN23,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK168,CA23),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM23+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23, $DB23), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR23,\n  CL, $DS23,\n  SM, $DT23,\n  SLM, $DU23,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY23*(DE23*OtherDamage*SL+UwDamage*DF23)))",
    "ET23": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN23 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM23,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN23+1, $DB23), 1),\n\n  DW, $DR23,\n  CL, $DS23,\n  SM, $DT23,\n  SLM, $DU23,\n  SL, $DQ23,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY23*(DE23*DO23*SL+UWDamage*DF23)))",
    "EU23": "IF(OR(NOT($BA$3), NOT($BA$23), $CO23 > $BA$15), \"\", 1 + 0.5*(CO23+1))",
    "EW23": "IF(DZ23=\"\", \"\", LET(\n  Now, CT23,\n  Next, DZ23,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT23),\nFactor/Cost))",
    "EX23": "IF(EA23=\"\",\"\",(EA23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU23))",
    "EY23": "IF(EB23=\"\",\"\",(EB23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV23))",
    "EZ23": "IF(EC23=\"\",\"\",(EC23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW23))",
    "FA23": "IF(ED23=\"\",\"\",(ED23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX23))",
    "FB23": "IF(EE23=\"\",\"\",(EE23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY23))",
    "FC23": "IF(EF23=\"\",\"\",(EF23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ23))",
    "FD23": "IF(EG23=\"\",\"\",(EG23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA23))",
    "FE23": "IF(EH23=\"\",\"\",(EH23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB23))",
    "FF23": "IF(EI23=\"\",\"\",(EI23/$DX23-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC23+1, 1, CC23))))",
    "FG23": "IF(EJ23=\"\",\"\",(EJ23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD23))",
    "FH23": "IF(EK23=\"\",\"\",(EK23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE23))",
    "FI23": "IF(EL23=\"\",\"\",(EL23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF23))",
    "FJ23": "IF(EM23=\"\", \"\", LET(\n  Now, CW23,\n  Next, EM23,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG23),\nFactor/Cost))",
    "FK23": "IF(EN23=\"\",\"\",(EN23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH23))",
    "FL23": "IF(EO23=\"\", \"\", LET(\n  Now, CS23,\n  Next, EO23,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI23),\nFactor/Cost))",
    "FM23": "IF(EP23=\"\",\"\",(EP23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ23))",
    "FN23": "IF(EQ23=\"\",\"\",(EQ23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK23))",
    "FO23": "IF(ER23=\"\",\"\",(ER23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL23))",
    "FP23": "IF(ES23=\"\",\"\",(ES23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM23))",
    "FQ23": "IF(ET23=\"\",\"\",(ET23/$DX23-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN23))",
    "FR23": "IF(EU23=\"\", \"\", LET(\n  Now, CX23,\n  Next, EU23,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO23),\nFactor/Cost))",
    "FT23": "IF(COLUMN(EW23:FR23) = MIN(IF(EW23:FR23=MAX(EW23:FR23), COLUMN(EW23:FR23))), 1, \"\")",
    "D24": "IF(SUM(FT23:GP23),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F24)),\"Card Mastery\",F24),G24)/$D$5,\"\")",
    "F24": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT23:GP23),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT23:GP23=1)),)\"),\"Critical Factor\")",
    "G24": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT23:GP23),ARRAYFORMULA(FILTER(BT23:CP23 , FT23:GP23=1)),\"\"\"\")\"),6.0)",
    "I24": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT23:GP23),ARRAYFORMULA(FILTER(EW23:FS23 , FT23:GP23=1))*D$5,\"\"\"\")\"),0.4681819902396427)",
    "K24": "IF(H24<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D24)),)",
    "AD24": "IF(EQ(AE24, -13), \"-\", LET(\n  Next, EQ($AE$21, \"Next Tier\"),\n  Common, EQ($AE$21, \"Common\"),\n  Rare, EQ($AE$21, \"Rare\"),\n  Epic, EQ($AE$21, \"Epic\"),\n  Legendary, EQ($AE$21, \"Legendary\"),\n  Mythic, EQ($AE$21, \"Mythic\"),\n  Ancestral, EQ($AE$21, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE24=0, -6, AE24=-6, -10, AE24=-10, -13), Legendary, -6, Mythic, -10, Ancestral, -13), 0),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, Planner, $DP5),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DwQuant, DWCooldown, CF5-1),\n\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n  SL, DQ5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*DO5*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE24": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$20:$AU$25\"), MATCH(AC24,INDIRECT($C$2 & \"!$AR$20:$AR$25\"), 0)),0)",
    "AI24": "'Master Sheet'!C103",
    "AJ24": "'Master Sheet'!E103",
    "AK24": "(1%*AI24)",
    "BA24": "'Master Sheet'!AC28",
    "BC24": "BC23+1",
    "BD24": "BD23+BD$3",
    "BE24": "BE23+BE$3",
    "BF24": "BF23+BF$3",
    "BG24": "BG23+BG$3",
    "BH24": "BH23+BH$3",
    "BI24": "BI23+BI$3",
    "BJ24": "BJ23+BJ$3",
    "BK24": "BK23+BK$3",
    "BL24": "BL23+BL$3",
    "BN24": "BN23+BN$3",
    "BP24": "BP23+BP$3",
    "BR24": "BR23+BR$3",
    "BT24": "BT23+FT23",
    "BU24": "BU23+FU23",
    "BV24": "BV23+FV23",
    "BW24": "BW23+FW23",
    "BX24": "BX23+FX23",
    "BY24": "BY23+FY23",
    "BZ24": "BZ23+FZ23",
    "CA24": "CA23+GA23",
    "CB24": "CB23+GB23",
    "CC24": "CC23+GC23",
    "CD24": "CD23+GD23",
    "CE24": "CE23+GE23",
    "CF24": "CF23+GF23",
    "CG24": "CG23+GG23",
    "CH24": "CH23+GH23",
    "CI24": "CI23+GI23",
    "CJ24": "CJ23+GJ23",
    "CK24": "CK23+GK23",
    "CL24": "CL23+GL23",
    "CM24": "CM23+GM23",
    "CN24": "CN23+GN23",
    "CO24": "CO23+GO23",
    "CS24": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI24,1)",
    "CT24": "INDEX($BD$5:$BD169,BT24)",
    "CU24": "INDEX($BN$5:$BN169,CD24)",
    "CV24": "INDEX($BO$5:$BO169,CE24)",
    "CW24": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG24)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX24": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO24, 1)",
    "CY24": "LET(\n  Base, $CR$6,\n  Damage, $CT24,\n  DamageMastery, $CS24,\n  DemonMastery, $CX24,\n  SPB, $CU24,\n  ITO, $CV24,\n  Shock, $CW24,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ24": "MIN(100%, DA24)",
    "DA24": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK24*1%, 0)",
    "DB24": "LET(\n  Lab, 1+INDEX($BF$5:$BF169,BV24),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC24": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK24*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI169,BY24) + CardCritMastery)",
    "DD24": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK24*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ169,BZ24) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE24": "LET(\n  CF, $DB24,\n  CC, $CZ24,\n  SCM, $DD24,\n  SCC, $DC24,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF24": "LET(\n  CF, $DB24,\n  CC, $DA24,\n  SCM, $DD24,\n  SCC, $DC24,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG24": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH24)), 0)",
    "DH24": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ24*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE169,BU24),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI24": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG169, BW24), 1) + $AE$9)",
    "DJ24": "LET(\n  DpmLab, INDEX($BH$5:$BH169,BX24),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL24, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK24": "(1+$DI24*$DJ24*$AQ$9)",
    "DL24": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK169,CA24),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM24*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM24": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK169,CA24),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM24*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN24": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL169,CB24)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO24": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH24,\n  Rapid, DG24,\n  RDPM, DK24,\n  SuperTower, $DL24,\n  Rend, $DN24,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP24": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ24": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK24),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR24": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP24),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF24-1))",
    "DS24": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG24, DH24),0))",
    "DT24": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP24),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV24, $AR$29), 0))",
    "DU24": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK24),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM169,CC24), $DV24, $AR$29), 0))",
    "DV24": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH24), $AO$29)",
    "DW24": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM24,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24, $DB24), 1),\n\n  DW, $DR24,\n  CL, $DS24,\n  SM, $DT24,\n  SLM, $DU24,\n  SL, $DQ24,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX24": "CY24*(DE24*DO24*DQ24+DW24*DF24)",
    "DZ24": "IF(INDEX($BD$6:$BD169,BT24)=\"\", \"\", INDEX($BD$5:$BD169,BT24+1))",
    "EA24": "IF(OR($AO$25, INDEX($BE$6:$BE169,BU24)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ24)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE169,BU24+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI24*$DJ24*$AQ$9),\n  SuperTower, $DL24,\n  Rend, $DN24,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24, $DB24), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR24,\n  SM, $DT24,\n  SLM, $DU24,\n  SL, $DQ24,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM24, UltCritCard),\n\nCY24*(DE24*OtherDamage*SL+UwDamage*DF24)))",
    "EB24": "IF(INDEX($BF$6:$BF169,BV24)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF169,BV24+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ24,\n  CCUW, $DA24,\n  SCM, $DD24,\n  SCC, $DC24,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24, CF), 1),\n\n  DW, $DR24,\n  CL, $DS24,\n  SM, $DT24,\n  SLM, $DU24,\n  SL, $DQ24,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM24, UltCritCard),\n\nCY24 * (Critical * DO24 * SL + UwDamage * UWCritical)))",
    "EC24": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG169,BW24)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH24,\n  Rapid, DG24,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG169, BW24+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ24*$AQ$9),\n  SuperTower, $DL24,\n  Rend, $DN24,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM169,CC24), $DV24, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM24,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24, $DB24), 1),\n\n  DW, $DR24,\n  CL, $DS24,\n  SM, $DT24,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY24*(DE24*OtherDamage*SL+UWDamage*DF24)))",
    "ED24": "IF(OR($AO$25, INDEX($BH$6:$BH169,BX24)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH169,BX24+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL24, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI24*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM169,CC24), $DV24, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH24,\n  Rapid, DG24,\n  SuperTower, $DL24,\n  Rend, $DN24,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM24,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24, $DB24), 1),\n\n  DW, $DR24,\n  CL, $DS24,\n  SM, $DT24,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY24*(DE24*OtherDamage*SL+UWDamage*DF24)))",
    "EE24": "IF(INDEX($BI$6:$BI169,BY24)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK24, 0),\n  CF, $DB24,\n  CC, $CZ24,\n  CCUW, $DA24,\n  SCM, $DD24,\n  SCC, $AV$17+INDEX($BI$5:$BI169,BY24+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY24 * (Critical*DO24*$DQ24+DW24*UWCritical)))",
    "EF24": "IF(INDEX($BJ$6:$BJ169,BZ24)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK24*1%, 1),\n  CF, $DB24,\n  CC, $CZ24,\n  CCUW, $DA24,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ169,BZ24+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC24,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY24*(Critical*DO24*$DQ24+DW24*UWCritical)))",
    "EG24": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK169,CA24)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH24,\n  Rapid, DG24,\n  DPM, (1+$DI24*$DJ24*$AQ$9),\n  Rend, $DN24,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK169,CA24+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM24*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24, $DB24), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK169,CA24+1)-1))/(45-CM24*3),1),\n\n  SL, $DQ24,\n  DW, $DR24,\n  CL, $DS24,\n  SM, $DT24,\n  SLM, $DU24,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY24*(DE24*OtherDamage*SL+UwDamage*DF24)))",
    "EH24": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL169,CB24+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL169,CB24)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH24,\n  Rapid, DG24,\n  DPM, (1+$DI24*$DJ24*$AQ$9),\n  SuperTower, $DL24,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL169,CB24+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY24*(DE24*OtherDamage*$DQ24+DW24*DF24)))",
    "EI24": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM169,CC24)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24, $DB24), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK24),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV24, $AR$29), 0),\n\n  DW, $DR24,\n  CL, $DS24,\n  SM, $DT24,\n  SL, $DQ24,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM24, UltCritCard),\nCY24*(DE24*DO24*SL+UwDamage*DF24)))",
    "EJ24": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN169,CD24)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT24,\n  DamageMastery, $CS24,\n  DemonMastery, $CX24,\n  SPB, INDEX($BN$5:$BN169,CD24+1),\n  ITO, $CV24,\n  Shock, $CW24,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE24*DO24*$DQ24+DW24*DF24)))",
    "EK24": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO169,CE24)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT24,\n  DamageMastery, $CS24,\n  DemonMastery, $CX24,\n  SPB, $CU24,\n  ITO, INDEX($BO$5:$BO169,CE24+1),\n  Shock, $CW24,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE24*DO24*$DQ24+DW24*DF24)))",
    "EL24": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP169,CF24)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24, $DB24), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP24),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF24),\n  CL, $DS24,\n  SM, $DT24,\n  SLM, $DU24,\n  SL, $DQ24,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM24, UltCritCard),\nCY24*(DE24*DO24*SL+UwDamage*DF24)))",
    "EM24": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ169,CG24)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG24+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN24": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR169,CH24)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24, $DB24), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH24+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP24),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK24),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM169,CC24), SMHeat, $AR$29), 0),\n\n  DW, $DR24,\n  CL, $DS24,\n  SL, $DQ24,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM24, UltCritCard),\nCY24*(DE24*DO24*SL+UwDamage*DF24)))",
    "EO24": "IF(OR(CI24 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI24+1))",
    "EP24": "IF(OR($AO$25, CJ24 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ24+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE168,BU24),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL24, 1),\n  DPM, (1+$DI24*CardRangeMastery*$DJ24*$AQ$9),\n  SuperTower, $DL24,\n  Rend, $DN24,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24, $DB24), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR24,\n  SM, $DT24,\n  SLM, $DU24,\n  SL, $DQ24,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM24, UltCritCard),\n\nCY24*(DE24*OtherDamage*SL+UwDamage*DF24)))",
    "EQ24": "IF(OR(CK24 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK24+1)*1%, 1),\n  CF, $DB24,\n  CC, MIN(100%, $CZ24 + 1%),\n  CCUW, DA24 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ169,BZ24) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC24 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR24,\n  CL, $DS24,\n  SM, $DT24,\n  SLM, $DU24,\n  SL, $DQ24,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM24, UltCritCard),\n\nCY24 * (Critical*DO24*SL+UwDamage*UWCritical)))",
    "ER24": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL24 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH169,BX24),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL24+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI24*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM169,CC24), $DV24, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH24,\n  Rapid, DG24,\n  SuperTower, $DL24,\n  Rend, $DN24,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM24,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24, $DB24), 1),\n\n  DW, $DR24,\n  CL, $DS24,\n  SM, $DT24,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY24*(DE24*OtherDamage*SL+UWDamage*DF24)))",
    "ES24": "IF(OR(CM24 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH24,\n  Rapid, DG24,\n  RDPM, (1+$DI24*$DJ24*$AQ$9),\n  Rend, $DN24,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK169,CA24),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM24+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24, $DB24), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR24,\n  CL, $DS24,\n  SM, $DT24,\n  SLM, $DU24,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY24*(DE24*OtherDamage*SL+UwDamage*DF24)))",
    "ET24": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN24 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM24,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN24+1, $DB24), 1),\n\n  DW, $DR24,\n  CL, $DS24,\n  SM, $DT24,\n  SLM, $DU24,\n  SL, $DQ24,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY24*(DE24*DO24*SL+UWDamage*DF24)))",
    "EU24": "IF(OR(NOT($BA$3), NOT($BA$23), $CO24 > $BA$15), \"\", 1 + 0.5*(CO24+1))",
    "EW24": "IF(DZ24=\"\", \"\", LET(\n  Now, CT24,\n  Next, DZ24,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT24),\nFactor/Cost))",
    "EX24": "IF(EA24=\"\",\"\",(EA24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU24))",
    "EY24": "IF(EB24=\"\",\"\",(EB24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV24))",
    "EZ24": "IF(EC24=\"\",\"\",(EC24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW24))",
    "FA24": "IF(ED24=\"\",\"\",(ED24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX24))",
    "FB24": "IF(EE24=\"\",\"\",(EE24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY24))",
    "FC24": "IF(EF24=\"\",\"\",(EF24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ24))",
    "FD24": "IF(EG24=\"\",\"\",(EG24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA24))",
    "FE24": "IF(EH24=\"\",\"\",(EH24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB24))",
    "FF24": "IF(EI24=\"\",\"\",(EI24/$DX24-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC24+1, 1, CC24))))",
    "FG24": "IF(EJ24=\"\",\"\",(EJ24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD24))",
    "FH24": "IF(EK24=\"\",\"\",(EK24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE24))",
    "FI24": "IF(EL24=\"\",\"\",(EL24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF24))",
    "FJ24": "IF(EM24=\"\", \"\", LET(\n  Now, CW24,\n  Next, EM24,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG24),\nFactor/Cost))",
    "FK24": "IF(EN24=\"\",\"\",(EN24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH24))",
    "FL24": "IF(EO24=\"\", \"\", LET(\n  Now, CS24,\n  Next, EO24,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI24),\nFactor/Cost))",
    "FM24": "IF(EP24=\"\",\"\",(EP24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ24))",
    "FN24": "IF(EQ24=\"\",\"\",(EQ24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK24))",
    "FO24": "IF(ER24=\"\",\"\",(ER24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL24))",
    "FP24": "IF(ES24=\"\",\"\",(ES24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM24))",
    "FQ24": "IF(ET24=\"\",\"\",(ET24/$DX24-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN24))",
    "FR24": "IF(EU24=\"\", \"\", LET(\n  Now, CX24,\n  Next, EU24,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO24),\nFactor/Cost))",
    "FT24": "IF(COLUMN(EW24:FR24) = MIN(IF(EW24:FR24=MAX(EW24:FR24), COLUMN(EW24:FR24))), 1, \"\")",
    "D25": "IF(SUM(FT24:GP24),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F25)),\"Card Mastery\",F25),G25)/$D$5,\"\")",
    "F25": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT24:GP24),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT24:GP24=1)),)\"),\"Damage / Meter\")",
    "G25": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT24:GP24),ARRAYFORMULA(FILTER(BT24:CP24 , FT24:GP24=1)),\"\"\"\")\"),4.0)",
    "I25": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT24:GP24),ARRAYFORMULA(FILTER(EW24:FS24 , FT24:GP24=1))*D$5,\"\"\"\")\"),0.3445038275019639)",
    "K25": "IF(D16,FORMAT_TIME_YEAR(SUM($D$6:$D25)),)",
    "AD25": "IF(EQ(AE25, 20), \"-\", LET(\n  Next, EQ($AE$21, \"Next Tier\"),\n  Common, EQ($AE$21, \"Common\"),\n  Rare, EQ($AE$21, \"Rare\"),\n  Epic, EQ($AE$21, \"Epic\"),\n  Legendary, EQ($AE$21, \"Legendary\"),\n  Mythic, EQ($AE$21, \"Mythic\"),\n  Ancestral, EQ($AE$21, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE25=0, 1.2, AE25=1.2, 2.5, AE25=2.5, 3.5, AE25=3.5, 10, AE25=10, 15, AE25=15, 20), Common, 1.2, Rare, 2.5, Epic, 3.5, Legendary, 10, Mythic, 15, Ancestral, 20), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM5,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK5),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, Planner, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM150,CC5), $DV5, $AR$29), 0),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*DO5*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE25": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$20:$AU$25\"), MATCH(AC25,INDIRECT($C$2 & \"!$AR$20:$AR$25\"), 0)),0)",
    "AI25": "'Master Sheet'!C107",
    "AJ25": "'Master Sheet'!E107",
    "AK25": "(1%*AI25)",
    "BC25": "BC24+1",
    "BD25": "BD24+BD$3",
    "BE25": "BE24+BE$3",
    "BF25": "BF24+BF$3",
    "BG25": "BG24+BG$3",
    "BH25": "BH24+BH$3",
    "BI25": "BI24+BI$3",
    "BJ25": "BJ24+BJ$3",
    "BK25": "BK24+BK$3",
    "BL25": "BL24+BL$3",
    "BN25": "BN24+BN$3",
    "BP25": "BP24+BP$3",
    "BR25": "BR24+BR$3",
    "BT25": "BT24+FT24",
    "BU25": "BU24+FU24",
    "BV25": "BV24+FV24",
    "BW25": "BW24+FW24",
    "BX25": "BX24+FX24",
    "BY25": "BY24+FY24",
    "BZ25": "BZ24+FZ24",
    "CA25": "CA24+GA24",
    "CB25": "CB24+GB24",
    "CC25": "CC24+GC24",
    "CD25": "CD24+GD24",
    "CE25": "CE24+GE24",
    "CF25": "CF24+GF24",
    "CG25": "CG24+GG24",
    "CH25": "CH24+GH24",
    "CI25": "CI24+GI24",
    "CJ25": "CJ24+GJ24",
    "CK25": "CK24+GK24",
    "CL25": "CL24+GL24",
    "CM25": "CM24+GM24",
    "CN25": "CN24+GN24",
    "CO25": "CO24+GO24",
    "CS25": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI25,1)",
    "CT25": "INDEX($BD$5:$BD170,BT25)",
    "CU25": "INDEX($BN$5:$BN170,CD25)",
    "CV25": "INDEX($BO$5:$BO170,CE25)",
    "CW25": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG25)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX25": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO25, 1)",
    "CY25": "LET(\n  Base, $CR$6,\n  Damage, $CT25,\n  DamageMastery, $CS25,\n  DemonMastery, $CX25,\n  SPB, $CU25,\n  ITO, $CV25,\n  Shock, $CW25,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ25": "MIN(100%, DA25)",
    "DA25": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK25*1%, 0)",
    "DB25": "LET(\n  Lab, 1+INDEX($BF$5:$BF170,BV25),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC25": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK25*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI170,BY25) + CardCritMastery)",
    "DD25": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK25*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ170,BZ25) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE25": "LET(\n  CF, $DB25,\n  CC, $CZ25,\n  SCM, $DD25,\n  SCC, $DC25,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF25": "LET(\n  CF, $DB25,\n  CC, $DA25,\n  SCM, $DD25,\n  SCC, $DC25,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG25": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH25)), 0)",
    "DH25": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ25*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE170,BU25),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI25": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG170, BW25), 1) + $AE$9)",
    "DJ25": "LET(\n  DpmLab, INDEX($BH$5:$BH170,BX25),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL25, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK25": "(1+$DI25*$DJ25*$AQ$9)",
    "DL25": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK170,CA25),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM25*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM25": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK170,CA25),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM25*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN25": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL170,CB25)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO25": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH25,\n  Rapid, DG25,\n  RDPM, DK25,\n  SuperTower, $DL25,\n  Rend, $DN25,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP25": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ25": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK25),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR25": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP25),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF25-1))",
    "DS25": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG25, DH25),0))",
    "DT25": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP25),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV25, $AR$29), 0))",
    "DU25": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK25),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM170,CC25), $DV25, $AR$29), 0))",
    "DV25": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH25), $AO$29)",
    "DW25": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM25,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25, $DB25), 1),\n\n  DW, $DR25,\n  CL, $DS25,\n  SM, $DT25,\n  SLM, $DU25,\n  SL, $DQ25,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX25": "CY25*(DE25*DO25*DQ25+DW25*DF25)",
    "DZ25": "IF(INDEX($BD$6:$BD170,BT25)=\"\", \"\", INDEX($BD$5:$BD170,BT25+1))",
    "EA25": "IF(OR($AO$25, INDEX($BE$6:$BE170,BU25)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ25)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE170,BU25+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI25*$DJ25*$AQ$9),\n  SuperTower, $DL25,\n  Rend, $DN25,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25, $DB25), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR25,\n  SM, $DT25,\n  SLM, $DU25,\n  SL, $DQ25,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM25, UltCritCard),\n\nCY25*(DE25*OtherDamage*SL+UwDamage*DF25)))",
    "EB25": "IF(INDEX($BF$6:$BF170,BV25)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF170,BV25+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ25,\n  CCUW, $DA25,\n  SCM, $DD25,\n  SCC, $DC25,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25, CF), 1),\n\n  DW, $DR25,\n  CL, $DS25,\n  SM, $DT25,\n  SLM, $DU25,\n  SL, $DQ25,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM25, UltCritCard),\n\nCY25 * (Critical * DO25 * SL + UwDamage * UWCritical)))",
    "EC25": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG170,BW25)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH25,\n  Rapid, DG25,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG170, BW25+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ25*$AQ$9),\n  SuperTower, $DL25,\n  Rend, $DN25,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM170,CC25), $DV25, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM25,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25, $DB25), 1),\n\n  DW, $DR25,\n  CL, $DS25,\n  SM, $DT25,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY25*(DE25*OtherDamage*SL+UWDamage*DF25)))",
    "ED25": "IF(OR($AO$25, INDEX($BH$6:$BH170,BX25)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH170,BX25+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL25, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI25*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM170,CC25), $DV25, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH25,\n  Rapid, DG25,\n  SuperTower, $DL25,\n  Rend, $DN25,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM25,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25, $DB25), 1),\n\n  DW, $DR25,\n  CL, $DS25,\n  SM, $DT25,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY25*(DE25*OtherDamage*SL+UWDamage*DF25)))",
    "EE25": "IF(INDEX($BI$6:$BI170,BY25)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK25, 0),\n  CF, $DB25,\n  CC, $CZ25,\n  CCUW, $DA25,\n  SCM, $DD25,\n  SCC, $AV$17+INDEX($BI$5:$BI170,BY25+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY25 * (Critical*DO25*$DQ25+DW25*UWCritical)))",
    "EF25": "IF(INDEX($BJ$6:$BJ170,BZ25)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK25*1%, 1),\n  CF, $DB25,\n  CC, $CZ25,\n  CCUW, $DA25,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ170,BZ25+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC25,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY25*(Critical*DO25*$DQ25+DW25*UWCritical)))",
    "EG25": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK170,CA25)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH25,\n  Rapid, DG25,\n  DPM, (1+$DI25*$DJ25*$AQ$9),\n  Rend, $DN25,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK170,CA25+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM25*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25, $DB25), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK170,CA25+1)-1))/(45-CM25*3),1),\n\n  SL, $DQ25,\n  DW, $DR25,\n  CL, $DS25,\n  SM, $DT25,\n  SLM, $DU25,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY25*(DE25*OtherDamage*SL+UwDamage*DF25)))",
    "EH25": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL170,CB25+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL170,CB25)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH25,\n  Rapid, DG25,\n  DPM, (1+$DI25*$DJ25*$AQ$9),\n  SuperTower, $DL25,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL170,CB25+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY25*(DE25*OtherDamage*$DQ25+DW25*DF25)))",
    "EI25": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM170,CC25)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25, $DB25), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK25),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV25, $AR$29), 0),\n\n  DW, $DR25,\n  CL, $DS25,\n  SM, $DT25,\n  SL, $DQ25,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM25, UltCritCard),\nCY25*(DE25*DO25*SL+UwDamage*DF25)))",
    "EJ25": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN170,CD25)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT25,\n  DamageMastery, $CS25,\n  DemonMastery, $CX25,\n  SPB, INDEX($BN$5:$BN170,CD25+1),\n  ITO, $CV25,\n  Shock, $CW25,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE25*DO25*$DQ25+DW25*DF25)))",
    "EK25": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO170,CE25)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT25,\n  DamageMastery, $CS25,\n  DemonMastery, $CX25,\n  SPB, $CU25,\n  ITO, INDEX($BO$5:$BO170,CE25+1),\n  Shock, $CW25,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE25*DO25*$DQ25+DW25*DF25)))",
    "EL25": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP170,CF25)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25, $DB25), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP25),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF25),\n  CL, $DS25,\n  SM, $DT25,\n  SLM, $DU25,\n  SL, $DQ25,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM25, UltCritCard),\nCY25*(DE25*DO25*SL+UwDamage*DF25)))",
    "EM25": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ170,CG25)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG25+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN25": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR170,CH25)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25, $DB25), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH25+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP25),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK25),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM170,CC25), SMHeat, $AR$29), 0),\n\n  DW, $DR25,\n  CL, $DS25,\n  SL, $DQ25,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM25, UltCritCard),\nCY25*(DE25*DO25*SL+UwDamage*DF25)))",
    "EO25": "IF(OR(CI25 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI25+1))",
    "EP25": "IF(OR($AO$25, CJ25 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ25+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE169,BU25),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL25, 1),\n  DPM, (1+$DI25*CardRangeMastery*$DJ25*$AQ$9),\n  SuperTower, $DL25,\n  Rend, $DN25,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25, $DB25), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR25,\n  SM, $DT25,\n  SLM, $DU25,\n  SL, $DQ25,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM25, UltCritCard),\n\nCY25*(DE25*OtherDamage*SL+UwDamage*DF25)))",
    "EQ25": "IF(OR(CK25 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK25+1)*1%, 1),\n  CF, $DB25,\n  CC, MIN(100%, $CZ25 + 1%),\n  CCUW, DA25 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ170,BZ25) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC25 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR25,\n  CL, $DS25,\n  SM, $DT25,\n  SLM, $DU25,\n  SL, $DQ25,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM25, UltCritCard),\n\nCY25 * (Critical*DO25*SL+UwDamage*UWCritical)))",
    "ER25": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL25 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH170,BX25),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL25+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI25*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM170,CC25), $DV25, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH25,\n  Rapid, DG25,\n  SuperTower, $DL25,\n  Rend, $DN25,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM25,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25, $DB25), 1),\n\n  DW, $DR25,\n  CL, $DS25,\n  SM, $DT25,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY25*(DE25*OtherDamage*SL+UWDamage*DF25)))",
    "ES25": "IF(OR(CM25 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH25,\n  Rapid, DG25,\n  RDPM, (1+$DI25*$DJ25*$AQ$9),\n  Rend, $DN25,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK170,CA25),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM25+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25, $DB25), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR25,\n  CL, $DS25,\n  SM, $DT25,\n  SLM, $DU25,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY25*(DE25*OtherDamage*SL+UwDamage*DF25)))",
    "ET25": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN25 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM25,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN25+1, $DB25), 1),\n\n  DW, $DR25,\n  CL, $DS25,\n  SM, $DT25,\n  SLM, $DU25,\n  SL, $DQ25,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY25*(DE25*DO25*SL+UWDamage*DF25)))",
    "EU25": "IF(OR(NOT($BA$3), NOT($BA$23), $CO25 > $BA$15), \"\", 1 + 0.5*(CO25+1))",
    "EW25": "IF(DZ25=\"\", \"\", LET(\n  Now, CT25,\n  Next, DZ25,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT25),\nFactor/Cost))",
    "EX25": "IF(EA25=\"\",\"\",(EA25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU25))",
    "EY25": "IF(EB25=\"\",\"\",(EB25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV25))",
    "EZ25": "IF(EC25=\"\",\"\",(EC25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW25))",
    "FA25": "IF(ED25=\"\",\"\",(ED25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX25))",
    "FB25": "IF(EE25=\"\",\"\",(EE25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY25))",
    "FC25": "IF(EF25=\"\",\"\",(EF25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ25))",
    "FD25": "IF(EG25=\"\",\"\",(EG25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA25))",
    "FE25": "IF(EH25=\"\",\"\",(EH25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB25))",
    "FF25": "IF(EI25=\"\",\"\",(EI25/$DX25-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC25+1, 1, CC25))))",
    "FG25": "IF(EJ25=\"\",\"\",(EJ25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD25))",
    "FH25": "IF(EK25=\"\",\"\",(EK25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE25))",
    "FI25": "IF(EL25=\"\",\"\",(EL25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF25))",
    "FJ25": "IF(EM25=\"\", \"\", LET(\n  Now, CW25,\n  Next, EM25,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG25),\nFactor/Cost))",
    "FK25": "IF(EN25=\"\",\"\",(EN25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH25))",
    "FL25": "IF(EO25=\"\", \"\", LET(\n  Now, CS25,\n  Next, EO25,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI25),\nFactor/Cost))",
    "FM25": "IF(EP25=\"\",\"\",(EP25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ25))",
    "FN25": "IF(EQ25=\"\",\"\",(EQ25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK25))",
    "FO25": "IF(ER25=\"\",\"\",(ER25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL25))",
    "FP25": "IF(ES25=\"\",\"\",(ES25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM25))",
    "FQ25": "IF(ET25=\"\",\"\",(ET25/$DX25-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN25))",
    "FR25": "IF(EU25=\"\", \"\", LET(\n  Now, CX25,\n  Next, EU25,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO25),\nFactor/Cost))",
    "FT25": "IF(COLUMN(EW25:FR25) = MIN(IF(EW25:FR25=MAX(EW25:FR25), COLUMN(EW25:FR25))), 1, \"\")",
    "D26": "IF(SUM(FT25:GP25),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F26)),\"Card Mastery\",F26),G26)/$D$5,\"\")",
    "F26": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT25:GP25),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT25:GP25=1)),)\"),\"Attack Speed\")",
    "G26": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT25:GP25),ARRAYFORMULA(FILTER(BT25:CP25 , FT25:GP25=1)),\"\"\"\")\"),6.0)",
    "I26": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT25:GP25),ARRAYFORMULA(FILTER(EW25:FS25 , FT25:GP25=1))*D$5,\"\"\"\")\"),0.3299518473706078)",
    "K26": "IF(H26<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D26)),)",
    "AD26": "IF(EQ(AE26, 15), \"-\", LET(\n  Next, EQ($AE$21, \"Next Tier\"),\n  Common, EQ($AE$21, \"Common\"),\n  Rare, EQ($AE$21, \"Rare\"),\n  Epic, EQ($AE$21, \"Epic\"),\n  Legendary, EQ($AE$21, \"Legendary\"),\n  Mythic, EQ($AE$21, \"Mythic\"),\n  Ancestral, EQ($AE$21, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE26=0, 3, AE26=3, 6, AE26=6, 11, AE26=11, 15), Epic, 3, Legendary, 6, Mythic, 11, Ancestral, 15), 0),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, Planner),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK5),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR5,\n  CL, $DS5,\n  SM, $DT5,\n  SLM, $DU5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*DO5*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE26": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$20:$AU$25\"), MATCH(AC26,INDIRECT($C$2 & \"!$AR$20:$AR$25\"), 0)),0)",
    "AI26": "'Master Sheet'!C89",
    "AK26": "5+AI26*1.5",
    "BA26": "NOT(EQ(AG3, \"Tourney\"))",
    "BC26": "BC25+1",
    "BD26": "BD25+BD$3",
    "BE26": "BE25+BE$3",
    "BF26": "BF25+BF$3",
    "BG26": "BG25+BG$3",
    "BH26": "BH25+BH$3",
    "BI26": "BI25+BI$3",
    "BJ26": "BJ25+BJ$3",
    "BK26": "BK25+BK$3",
    "BL26": "BL25+BL$3",
    "BN26": "BN25+BN$3",
    "BP26": "BP25+BP$3",
    "BR26": "BR25+BR$3",
    "BT26": "BT25+FT25",
    "BU26": "BU25+FU25",
    "BV26": "BV25+FV25",
    "BW26": "BW25+FW25",
    "BX26": "BX25+FX25",
    "BY26": "BY25+FY25",
    "BZ26": "BZ25+FZ25",
    "CA26": "CA25+GA25",
    "CB26": "CB25+GB25",
    "CC26": "CC25+GC25",
    "CD26": "CD25+GD25",
    "CE26": "CE25+GE25",
    "CF26": "CF25+GF25",
    "CG26": "CG25+GG25",
    "CH26": "CH25+GH25",
    "CI26": "CI25+GI25",
    "CJ26": "CJ25+GJ25",
    "CK26": "CK25+GK25",
    "CL26": "CL25+GL25",
    "CM26": "CM25+GM25",
    "CN26": "CN25+GN25",
    "CO26": "CO25+GO25",
    "CS26": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI26,1)",
    "CT26": "INDEX($BD$5:$BD171,BT26)",
    "CU26": "INDEX($BN$5:$BN171,CD26)",
    "CV26": "INDEX($BO$5:$BO171,CE26)",
    "CW26": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG26)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX26": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO26, 1)",
    "CY26": "LET(\n  Base, $CR$6,\n  Damage, $CT26,\n  DamageMastery, $CS26,\n  DemonMastery, $CX26,\n  SPB, $CU26,\n  ITO, $CV26,\n  Shock, $CW26,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ26": "MIN(100%, DA26)",
    "DA26": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK26*1%, 0)",
    "DB26": "LET(\n  Lab, 1+INDEX($BF$5:$BF171,BV26),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC26": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK26*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI171,BY26) + CardCritMastery)",
    "DD26": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK26*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ171,BZ26) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE26": "LET(\n  CF, $DB26,\n  CC, $CZ26,\n  SCM, $DD26,\n  SCC, $DC26,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF26": "LET(\n  CF, $DB26,\n  CC, $DA26,\n  SCM, $DD26,\n  SCC, $DC26,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG26": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH26)), 0)",
    "DH26": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ26*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE171,BU26),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI26": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG171, BW26), 1) + $AE$9)",
    "DJ26": "LET(\n  DpmLab, INDEX($BH$5:$BH171,BX26),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL26, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK26": "(1+$DI26*$DJ26*$AQ$9)",
    "DL26": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK171,CA26),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM26*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM26": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK171,CA26),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM26*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN26": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL171,CB26)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO26": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH26,\n  Rapid, DG26,\n  RDPM, DK26,\n  SuperTower, $DL26,\n  Rend, $DN26,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP26": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ26": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK26),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR26": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP26),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF26-1))",
    "DS26": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG26, DH26),0))",
    "DT26": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP26),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV26, $AR$29), 0))",
    "DU26": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK26),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM171,CC26), $DV26, $AR$29), 0))",
    "DV26": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH26), $AO$29)",
    "DW26": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM26,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26, $DB26), 1),\n\n  DW, $DR26,\n  CL, $DS26,\n  SM, $DT26,\n  SLM, $DU26,\n  SL, $DQ26,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX26": "CY26*(DE26*DO26*DQ26+DW26*DF26)",
    "DZ26": "IF(INDEX($BD$6:$BD171,BT26)=\"\", \"\", INDEX($BD$5:$BD171,BT26+1))",
    "EA26": "IF(OR($AO$25, INDEX($BE$6:$BE171,BU26)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ26)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE171,BU26+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI26*$DJ26*$AQ$9),\n  SuperTower, $DL26,\n  Rend, $DN26,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26, $DB26), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR26,\n  SM, $DT26,\n  SLM, $DU26,\n  SL, $DQ26,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM26, UltCritCard),\n\nCY26*(DE26*OtherDamage*SL+UwDamage*DF26)))",
    "EB26": "IF(INDEX($BF$6:$BF171,BV26)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF171,BV26+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ26,\n  CCUW, $DA26,\n  SCM, $DD26,\n  SCC, $DC26,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26, CF), 1),\n\n  DW, $DR26,\n  CL, $DS26,\n  SM, $DT26,\n  SLM, $DU26,\n  SL, $DQ26,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM26, UltCritCard),\n\nCY26 * (Critical * DO26 * SL + UwDamage * UWCritical)))",
    "EC26": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG171,BW26)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH26,\n  Rapid, DG26,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG171, BW26+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ26*$AQ$9),\n  SuperTower, $DL26,\n  Rend, $DN26,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM171,CC26), $DV26, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM26,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26, $DB26), 1),\n\n  DW, $DR26,\n  CL, $DS26,\n  SM, $DT26,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY26*(DE26*OtherDamage*SL+UWDamage*DF26)))",
    "ED26": "IF(OR($AO$25, INDEX($BH$6:$BH171,BX26)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH171,BX26+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL26, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI26*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM171,CC26), $DV26, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH26,\n  Rapid, DG26,\n  SuperTower, $DL26,\n  Rend, $DN26,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM26,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26, $DB26), 1),\n\n  DW, $DR26,\n  CL, $DS26,\n  SM, $DT26,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY26*(DE26*OtherDamage*SL+UWDamage*DF26)))",
    "EE26": "IF(INDEX($BI$6:$BI171,BY26)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK26, 0),\n  CF, $DB26,\n  CC, $CZ26,\n  CCUW, $DA26,\n  SCM, $DD26,\n  SCC, $AV$17+INDEX($BI$5:$BI171,BY26+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY26 * (Critical*DO26*$DQ26+DW26*UWCritical)))",
    "EF26": "IF(INDEX($BJ$6:$BJ171,BZ26)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK26*1%, 1),\n  CF, $DB26,\n  CC, $CZ26,\n  CCUW, $DA26,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ171,BZ26+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC26,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY26*(Critical*DO26*$DQ26+DW26*UWCritical)))",
    "EG26": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK171,CA26)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH26,\n  Rapid, DG26,\n  DPM, (1+$DI26*$DJ26*$AQ$9),\n  Rend, $DN26,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK171,CA26+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM26*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26, $DB26), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK171,CA26+1)-1))/(45-CM26*3),1),\n\n  SL, $DQ26,\n  DW, $DR26,\n  CL, $DS26,\n  SM, $DT26,\n  SLM, $DU26,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY26*(DE26*OtherDamage*SL+UwDamage*DF26)))",
    "EH26": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL171,CB26+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL171,CB26)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH26,\n  Rapid, DG26,\n  DPM, (1+$DI26*$DJ26*$AQ$9),\n  SuperTower, $DL26,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL171,CB26+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY26*(DE26*OtherDamage*$DQ26+DW26*DF26)))",
    "EI26": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM171,CC26)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26, $DB26), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK26),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV26, $AR$29), 0),\n\n  DW, $DR26,\n  CL, $DS26,\n  SM, $DT26,\n  SL, $DQ26,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM26, UltCritCard),\nCY26*(DE26*DO26*SL+UwDamage*DF26)))",
    "EJ26": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN171,CD26)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT26,\n  DamageMastery, $CS26,\n  DemonMastery, $CX26,\n  SPB, INDEX($BN$5:$BN171,CD26+1),\n  ITO, $CV26,\n  Shock, $CW26,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE26*DO26*$DQ26+DW26*DF26)))",
    "EK26": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO171,CE26)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT26,\n  DamageMastery, $CS26,\n  DemonMastery, $CX26,\n  SPB, $CU26,\n  ITO, INDEX($BO$5:$BO171,CE26+1),\n  Shock, $CW26,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE26*DO26*$DQ26+DW26*DF26)))",
    "EL26": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP171,CF26)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26, $DB26), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP26),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF26),\n  CL, $DS26,\n  SM, $DT26,\n  SLM, $DU26,\n  SL, $DQ26,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM26, UltCritCard),\nCY26*(DE26*DO26*SL+UwDamage*DF26)))",
    "EM26": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ171,CG26)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG26+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN26": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR171,CH26)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26, $DB26), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH26+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP26),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK26),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM171,CC26), SMHeat, $AR$29), 0),\n\n  DW, $DR26,\n  CL, $DS26,\n  SL, $DQ26,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM26, UltCritCard),\nCY26*(DE26*DO26*SL+UwDamage*DF26)))",
    "EO26": "IF(OR(CI26 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI26+1))",
    "EP26": "IF(OR($AO$25, CJ26 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ26+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE170,BU26),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL26, 1),\n  DPM, (1+$DI26*CardRangeMastery*$DJ26*$AQ$9),\n  SuperTower, $DL26,\n  Rend, $DN26,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26, $DB26), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR26,\n  SM, $DT26,\n  SLM, $DU26,\n  SL, $DQ26,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM26, UltCritCard),\n\nCY26*(DE26*OtherDamage*SL+UwDamage*DF26)))",
    "EQ26": "IF(OR(CK26 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK26+1)*1%, 1),\n  CF, $DB26,\n  CC, MIN(100%, $CZ26 + 1%),\n  CCUW, DA26 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ171,BZ26) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC26 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR26,\n  CL, $DS26,\n  SM, $DT26,\n  SLM, $DU26,\n  SL, $DQ26,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM26, UltCritCard),\n\nCY26 * (Critical*DO26*SL+UwDamage*UWCritical)))",
    "ER26": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL26 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH171,BX26),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL26+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI26*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM171,CC26), $DV26, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH26,\n  Rapid, DG26,\n  SuperTower, $DL26,\n  Rend, $DN26,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM26,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26, $DB26), 1),\n\n  DW, $DR26,\n  CL, $DS26,\n  SM, $DT26,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY26*(DE26*OtherDamage*SL+UWDamage*DF26)))",
    "ES26": "IF(OR(CM26 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH26,\n  Rapid, DG26,\n  RDPM, (1+$DI26*$DJ26*$AQ$9),\n  Rend, $DN26,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK171,CA26),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM26+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26, $DB26), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR26,\n  CL, $DS26,\n  SM, $DT26,\n  SLM, $DU26,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY26*(DE26*OtherDamage*SL+UwDamage*DF26)))",
    "ET26": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN26 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM26,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN26+1, $DB26), 1),\n\n  DW, $DR26,\n  CL, $DS26,\n  SM, $DT26,\n  SLM, $DU26,\n  SL, $DQ26,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY26*(DE26*DO26*SL+UWDamage*DF26)))",
    "EU26": "IF(OR(NOT($BA$3), NOT($BA$23), $CO26 > $BA$15), \"\", 1 + 0.5*(CO26+1))",
    "EW26": "IF(DZ26=\"\", \"\", LET(\n  Now, CT26,\n  Next, DZ26,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT26),\nFactor/Cost))",
    "EX26": "IF(EA26=\"\",\"\",(EA26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU26))",
    "EY26": "IF(EB26=\"\",\"\",(EB26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV26))",
    "EZ26": "IF(EC26=\"\",\"\",(EC26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW26))",
    "FA26": "IF(ED26=\"\",\"\",(ED26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX26))",
    "FB26": "IF(EE26=\"\",\"\",(EE26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY26))",
    "FC26": "IF(EF26=\"\",\"\",(EF26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ26))",
    "FD26": "IF(EG26=\"\",\"\",(EG26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA26))",
    "FE26": "IF(EH26=\"\",\"\",(EH26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB26))",
    "FF26": "IF(EI26=\"\",\"\",(EI26/$DX26-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC26+1, 1, CC26))))",
    "FG26": "IF(EJ26=\"\",\"\",(EJ26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD26))",
    "FH26": "IF(EK26=\"\",\"\",(EK26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE26))",
    "FI26": "IF(EL26=\"\",\"\",(EL26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF26))",
    "FJ26": "IF(EM26=\"\", \"\", LET(\n  Now, CW26,\n  Next, EM26,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG26),\nFactor/Cost))",
    "FK26": "IF(EN26=\"\",\"\",(EN26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH26))",
    "FL26": "IF(EO26=\"\", \"\", LET(\n  Now, CS26,\n  Next, EO26,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI26),\nFactor/Cost))",
    "FM26": "IF(EP26=\"\",\"\",(EP26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ26))",
    "FN26": "IF(EQ26=\"\",\"\",(EQ26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK26))",
    "FO26": "IF(ER26=\"\",\"\",(ER26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL26))",
    "FP26": "IF(ES26=\"\",\"\",(ES26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM26))",
    "FQ26": "IF(ET26=\"\",\"\",(ET26/$DX26-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN26))",
    "FR26": "IF(EU26=\"\", \"\", LET(\n  Now, CX26,\n  Next, EU26,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO26),\nFactor/Cost))",
    "FT26": "IF(COLUMN(EW26:FR26) = MIN(IF(EW26:FR26=MAX(EW26:FR26), COLUMN(EW26:FR26))), 1, \"\")",
    "D27": "IF(SUM(FT26:GP26),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F27)),\"Card Mastery\",F27),G27)/$D$5,\"\")",
    "F27": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT26:GP26),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT26:GP26=1)),)\"),\"Damage\")",
    "G27": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT26:GP26),ARRAYFORMULA(FILTER(BT26:CP26 , FT26:GP26=1)),\"\"\"\")\"),6.0)",
    "I27": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT26:GP26),ARRAYFORMULA(FILTER(EW26:FS26 , FT26:GP26=1))*D$5,\"\"\"\")\"),0.3272727272727294)",
    "K27": "IF(H27<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D27)),)",
    "AD27": "IF(EQ(AE27, 250), \"-\", LET(\n  Next, EQ($AE$21, \"Next Tier\"),\n  Common, EQ($AE$21, \"Common\"),\n  Rare, EQ($AE$21, \"Rare\"),\n  Epic, EQ($AE$21, \"Epic\"),\n  Legendary, EQ($AE$21, \"Legendary\"),\n  Mythic, EQ($AE$21, \"Mythic\"),\n  Ancestral, EQ($AE$21, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE27=0, 8, AE27=8, 15, AE27=15, 25, AE27=25, 50, AE27=50, 100, AE27=100, 250), Common, 8, Rare, 15, Epic, 25, Legendary, 50, Mythic, 100, Ancestral, 250), 0),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  SLQuant, $AK$37,\n  SlAngle, $AJ$37+$AE$26,\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, Planner, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, MIN(100%, SLQuant*SlAngle/360),\n  StMastery, DM5,\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), Planner),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP5),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV5, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, 1+DJ5),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM150,CC5), $DV5, $AR$29), 0),\n\n  DW, $DR5,\n  CL, $DS5,\n  SL, DQ5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*DO5*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE27": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$20:$AU$25\"), MATCH(AC27,INDIRECT($C$2 & \"!$AR$20:$AR$25\"), 0)),0)",
    "AI27": "'Master Sheet'!C67",
    "AK27": "IF(AN27>0, 2, 1)*(AI27*0.04+0.1)+1",
    "AN27": "IFERROR(__xludf.DUMMYFUNCTION(\"LET(\n  ModName, INDIRECT($C$2 & \"\"!AQ22\"\"),\n  ModRarity, INDIRECT($C$2 & \"\"!AQ23\"\"),\n  IF(ModName = AL27, \n    IFS(\n      REGEXMATCH(ModRarity, \"\"Epic\"\"), 5, \n      REGEXMATCH(ModRarity, \"\"Legendary\"\"), 10, \n      REGEXMATCH(ModRarity, \"\"Mythic\"\"), 15, \n \"&\"     REGEXMATCH(ModRarity, \"\"Ancestral\"\"), 20,\n      TRUE, 0\n    ),\n  0)\n)\n\"),0.0)",
    "BC27": "BC26+1",
    "BD27": "BD26+BD$3",
    "BE27": "BE26+BE$3",
    "BF27": "BF26+BF$3",
    "BG27": "BG26+BG$3",
    "BH27": "BH26+BH$3",
    "BI27": "BI26+BI$3",
    "BJ27": "BJ26+BJ$3",
    "BK27": "BK26+BK$3",
    "BL27": "BL26+BL$3",
    "BN27": "BN26+BN$3",
    "BP27": "BP26+BP$3",
    "BR27": "BR26+BR$3",
    "BT27": "BT26+FT26",
    "BU27": "BU26+FU26",
    "BV27": "BV26+FV26",
    "BW27": "BW26+FW26",
    "BX27": "BX26+FX26",
    "BY27": "BY26+FY26",
    "BZ27": "BZ26+FZ26",
    "CA27": "CA26+GA26",
    "CB27": "CB26+GB26",
    "CC27": "CC26+GC26",
    "CD27": "CD26+GD26",
    "CE27": "CE26+GE26",
    "CF27": "CF26+GF26",
    "CG27": "CG26+GG26",
    "CH27": "CH26+GH26",
    "CI27": "CI26+GI26",
    "CJ27": "CJ26+GJ26",
    "CK27": "CK26+GK26",
    "CL27": "CL26+GL26",
    "CM27": "CM26+GM26",
    "CN27": "CN26+GN26",
    "CO27": "CO26+GO26",
    "CS27": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI27,1)",
    "CT27": "INDEX($BD$5:$BD172,BT27)",
    "CU27": "INDEX($BN$5:$BN172,CD27)",
    "CV27": "INDEX($BO$5:$BO172,CE27)",
    "CW27": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG27)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX27": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO27, 1)",
    "CY27": "LET(\n  Base, $CR$6,\n  Damage, $CT27,\n  DamageMastery, $CS27,\n  DemonMastery, $CX27,\n  SPB, $CU27,\n  ITO, $CV27,\n  Shock, $CW27,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ27": "MIN(100%, DA27)",
    "DA27": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK27*1%, 0)",
    "DB27": "LET(\n  Lab, 1+INDEX($BF$5:$BF172,BV27),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC27": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK27*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI172,BY27) + CardCritMastery)",
    "DD27": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK27*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ172,BZ27) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE27": "LET(\n  CF, $DB27,\n  CC, $CZ27,\n  SCM, $DD27,\n  SCC, $DC27,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF27": "LET(\n  CF, $DB27,\n  CC, $DA27,\n  SCM, $DD27,\n  SCC, $DC27,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG27": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH27)), 0)",
    "DH27": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ27*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE172,BU27),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI27": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG172, BW27), 1) + $AE$9)",
    "DJ27": "LET(\n  DpmLab, INDEX($BH$5:$BH172,BX27),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL27, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK27": "(1+$DI27*$DJ27*$AQ$9)",
    "DL27": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK172,CA27),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM27*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM27": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK172,CA27),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM27*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN27": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL172,CB27)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO27": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH27,\n  Rapid, DG27,\n  RDPM, DK27,\n  SuperTower, $DL27,\n  Rend, $DN27,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP27": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ27": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK27),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR27": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP27),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF27-1))",
    "DS27": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG27, DH27),0))",
    "DT27": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP27),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV27, $AR$29), 0))",
    "DU27": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK27),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM172,CC27), $DV27, $AR$29), 0))",
    "DV27": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH27), $AO$29)",
    "DW27": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM27,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27, $DB27), 1),\n\n  DW, $DR27,\n  CL, $DS27,\n  SM, $DT27,\n  SLM, $DU27,\n  SL, $DQ27,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX27": "CY27*(DE27*DO27*DQ27+DW27*DF27)",
    "DZ27": "IF(INDEX($BD$6:$BD172,BT27)=\"\", \"\", INDEX($BD$5:$BD172,BT27+1))",
    "EA27": "IF(OR($AO$25, INDEX($BE$6:$BE172,BU27)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ27)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE172,BU27+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI27*$DJ27*$AQ$9),\n  SuperTower, $DL27,\n  Rend, $DN27,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27, $DB27), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR27,\n  SM, $DT27,\n  SLM, $DU27,\n  SL, $DQ27,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM27, UltCritCard),\n\nCY27*(DE27*OtherDamage*SL+UwDamage*DF27)))",
    "EB27": "IF(INDEX($BF$6:$BF172,BV27)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF172,BV27+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ27,\n  CCUW, $DA27,\n  SCM, $DD27,\n  SCC, $DC27,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27, CF), 1),\n\n  DW, $DR27,\n  CL, $DS27,\n  SM, $DT27,\n  SLM, $DU27,\n  SL, $DQ27,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM27, UltCritCard),\n\nCY27 * (Critical * DO27 * SL + UwDamage * UWCritical)))",
    "EC27": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG172,BW27)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH27,\n  Rapid, DG27,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG172, BW27+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ27*$AQ$9),\n  SuperTower, $DL27,\n  Rend, $DN27,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM172,CC27), $DV27, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM27,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27, $DB27), 1),\n\n  DW, $DR27,\n  CL, $DS27,\n  SM, $DT27,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY27*(DE27*OtherDamage*SL+UWDamage*DF27)))",
    "ED27": "IF(OR($AO$25, INDEX($BH$6:$BH172,BX27)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH172,BX27+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL27, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI27*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM172,CC27), $DV27, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH27,\n  Rapid, DG27,\n  SuperTower, $DL27,\n  Rend, $DN27,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM27,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27, $DB27), 1),\n\n  DW, $DR27,\n  CL, $DS27,\n  SM, $DT27,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY27*(DE27*OtherDamage*SL+UWDamage*DF27)))",
    "EE27": "IF(INDEX($BI$6:$BI172,BY27)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK27, 0),\n  CF, $DB27,\n  CC, $CZ27,\n  CCUW, $DA27,\n  SCM, $DD27,\n  SCC, $AV$17+INDEX($BI$5:$BI172,BY27+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY27 * (Critical*DO27*$DQ27+DW27*UWCritical)))",
    "EF27": "IF(INDEX($BJ$6:$BJ172,BZ27)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK27*1%, 1),\n  CF, $DB27,\n  CC, $CZ27,\n  CCUW, $DA27,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ172,BZ27+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC27,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY27*(Critical*DO27*$DQ27+DW27*UWCritical)))",
    "EG27": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK172,CA27)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH27,\n  Rapid, DG27,\n  DPM, (1+$DI27*$DJ27*$AQ$9),\n  Rend, $DN27,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK172,CA27+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM27*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27, $DB27), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK172,CA27+1)-1))/(45-CM27*3),1),\n\n  SL, $DQ27,\n  DW, $DR27,\n  CL, $DS27,\n  SM, $DT27,\n  SLM, $DU27,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY27*(DE27*OtherDamage*SL+UwDamage*DF27)))",
    "EH27": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL172,CB27+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL172,CB27)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH27,\n  Rapid, DG27,\n  DPM, (1+$DI27*$DJ27*$AQ$9),\n  SuperTower, $DL27,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL172,CB27+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY27*(DE27*OtherDamage*$DQ27+DW27*DF27)))",
    "EI27": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM172,CC27)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27, $DB27), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK27),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV27, $AR$29), 0),\n\n  DW, $DR27,\n  CL, $DS27,\n  SM, $DT27,\n  SL, $DQ27,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM27, UltCritCard),\nCY27*(DE27*DO27*SL+UwDamage*DF27)))",
    "EJ27": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN172,CD27)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT27,\n  DamageMastery, $CS27,\n  DemonMastery, $CX27,\n  SPB, INDEX($BN$5:$BN172,CD27+1),\n  ITO, $CV27,\n  Shock, $CW27,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE27*DO27*$DQ27+DW27*DF27)))",
    "EK27": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO172,CE27)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT27,\n  DamageMastery, $CS27,\n  DemonMastery, $CX27,\n  SPB, $CU27,\n  ITO, INDEX($BO$5:$BO172,CE27+1),\n  Shock, $CW27,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE27*DO27*$DQ27+DW27*DF27)))",
    "EL27": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP172,CF27)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27, $DB27), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP27),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF27),\n  CL, $DS27,\n  SM, $DT27,\n  SLM, $DU27,\n  SL, $DQ27,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM27, UltCritCard),\nCY27*(DE27*DO27*SL+UwDamage*DF27)))",
    "EM27": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ172,CG27)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG27+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN27": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR172,CH27)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27, $DB27), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH27+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP27),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK27),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM172,CC27), SMHeat, $AR$29), 0),\n\n  DW, $DR27,\n  CL, $DS27,\n  SL, $DQ27,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM27, UltCritCard),\nCY27*(DE27*DO27*SL+UwDamage*DF27)))",
    "EO27": "IF(OR(CI27 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI27+1))",
    "EP27": "IF(OR($AO$25, CJ27 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ27+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE171,BU27),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL27, 1),\n  DPM, (1+$DI27*CardRangeMastery*$DJ27*$AQ$9),\n  SuperTower, $DL27,\n  Rend, $DN27,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27, $DB27), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR27,\n  SM, $DT27,\n  SLM, $DU27,\n  SL, $DQ27,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM27, UltCritCard),\n\nCY27*(DE27*OtherDamage*SL+UwDamage*DF27)))",
    "EQ27": "IF(OR(CK27 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK27+1)*1%, 1),\n  CF, $DB27,\n  CC, MIN(100%, $CZ27 + 1%),\n  CCUW, DA27 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ172,BZ27) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC27 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR27,\n  CL, $DS27,\n  SM, $DT27,\n  SLM, $DU27,\n  SL, $DQ27,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM27, UltCritCard),\n\nCY27 * (Critical*DO27*SL+UwDamage*UWCritical)))",
    "ER27": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL27 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH172,BX27),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL27+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI27*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM172,CC27), $DV27, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH27,\n  Rapid, DG27,\n  SuperTower, $DL27,\n  Rend, $DN27,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM27,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27, $DB27), 1),\n\n  DW, $DR27,\n  CL, $DS27,\n  SM, $DT27,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY27*(DE27*OtherDamage*SL+UWDamage*DF27)))",
    "ES27": "IF(OR(CM27 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH27,\n  Rapid, DG27,\n  RDPM, (1+$DI27*$DJ27*$AQ$9),\n  Rend, $DN27,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK172,CA27),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM27+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27, $DB27), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR27,\n  CL, $DS27,\n  SM, $DT27,\n  SLM, $DU27,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY27*(DE27*OtherDamage*SL+UwDamage*DF27)))",
    "ET27": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN27 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM27,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN27+1, $DB27), 1),\n\n  DW, $DR27,\n  CL, $DS27,\n  SM, $DT27,\n  SLM, $DU27,\n  SL, $DQ27,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY27*(DE27*DO27*SL+UWDamage*DF27)))",
    "EU27": "IF(OR(NOT($BA$3), NOT($BA$23), $CO27 > $BA$15), \"\", 1 + 0.5*(CO27+1))",
    "EW27": "IF(DZ27=\"\", \"\", LET(\n  Now, CT27,\n  Next, DZ27,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT27),\nFactor/Cost))",
    "EX27": "IF(EA27=\"\",\"\",(EA27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU27))",
    "EY27": "IF(EB27=\"\",\"\",(EB27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV27))",
    "EZ27": "IF(EC27=\"\",\"\",(EC27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW27))",
    "FA27": "IF(ED27=\"\",\"\",(ED27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX27))",
    "FB27": "IF(EE27=\"\",\"\",(EE27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY27))",
    "FC27": "IF(EF27=\"\",\"\",(EF27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ27))",
    "FD27": "IF(EG27=\"\",\"\",(EG27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA27))",
    "FE27": "IF(EH27=\"\",\"\",(EH27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB27))",
    "FF27": "IF(EI27=\"\",\"\",(EI27/$DX27-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC27+1, 1, CC27))))",
    "FG27": "IF(EJ27=\"\",\"\",(EJ27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD27))",
    "FH27": "IF(EK27=\"\",\"\",(EK27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE27))",
    "FI27": "IF(EL27=\"\",\"\",(EL27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF27))",
    "FJ27": "IF(EM27=\"\", \"\", LET(\n  Now, CW27,\n  Next, EM27,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG27),\nFactor/Cost))",
    "FK27": "IF(EN27=\"\",\"\",(EN27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH27))",
    "FL27": "IF(EO27=\"\", \"\", LET(\n  Now, CS27,\n  Next, EO27,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI27),\nFactor/Cost))",
    "FM27": "IF(EP27=\"\",\"\",(EP27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ27))",
    "FN27": "IF(EQ27=\"\",\"\",(EQ27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK27))",
    "FO27": "IF(ER27=\"\",\"\",(ER27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL27))",
    "FP27": "IF(ES27=\"\",\"\",(ES27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM27))",
    "FQ27": "IF(ET27=\"\",\"\",(ET27/$DX27-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN27))",
    "FR27": "IF(EU27=\"\", \"\", LET(\n  Now, CX27,\n  Next, EU27,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO27),\nFactor/Cost))",
    "FT27": "IF(COLUMN(EW27:FR27) = MIN(IF(EW27:FR27=MAX(EW27:FR27), COLUMN(EW27:FR27))), 1, \"\")",
    "D28": "IF(SUM(FT27:GP27),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F28)),\"Card Mastery\",F28),G28)/$D$5,\"\")",
    "F28": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT27:GP27),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT27:GP27=1)),)\"),\"Critical Factor\")",
    "G28": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT27:GP27),ARRAYFORMULA(FILTER(BT27:CP27 , FT27:GP27=1)),\"\"\"\")\"),7.0)",
    "I28": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT27:GP27),ARRAYFORMULA(FILTER(EW27:FS27 , FT27:GP27=1))*D$5,\"\"\"\")\"),0.31490626101572494)",
    "K28": "IF(H28<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D28)),)",
    "AD28": "IF(EQ(AE28, 5), \"-\", LET(\n  Next, EQ($AE$21, \"Next Tier\"),\n  Common, EQ($AE$21, \"Common\"),\n  Rare, EQ($AE$21, \"Rare\"),\n  Epic, EQ($AE$21, \"Epic\"),\n  Legendary, EQ($AE$21, \"Legendary\"),\n  Mythic, EQ($AE$21, \"Mythic\"),\n  Ancestral, EQ($AE$21, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE28=0, 1, AE28=1, 2, AE28=2, 4, AE28=4, 5), Epic, 1, Legendary, 2, Mythic, 4, Ancestral, 5), 0),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  SLQuant, $AK$37,\n  SlAngle, $AJ$37+$AE$26,\n  SlBonus, ($AI$37+Planner)*(1+$AR$31),\n  SlCoverage, MIN(100%, SLQuant*SlAngle/360),\n  PerkSL, IF(AND($BA$26,$BA$33),1.5,1),\n  StMastery, DM5,\n\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, Planner, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP5),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV5, $AR$29), 0),\n\n  DW, $DR5,\n  CL, $DS5,\n  SL, DQ5,\n  SLM, $DU$5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*DO5*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE28": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$20:$AU$25\"), MATCH(AC28,INDIRECT($C$2 & \"!$AR$20:$AR$25\"), 0)),0)",
    "AI28": "'Master Sheet'!C66",
    "AK28": "(AI28*0.5%+2.5%)*IF(AN27>0, 2, 1)",
    "AO28": "LET(\n  CLChance, AK34 + AE32,\n  ShockChance, AK28,\n  CLQuant, AJ34 + IF(GT(AN27, 0), 0.6, 0),\n  DC, IF(GT(AN27, 0),AN27,1),\nIF(AH27 ,1/(CLChance*ShockChance)/CLQuant*DC, \"N/A\"\n))",
    "AZ28": "(1+0.15*AY28)*(1+AK24)",
    "BC28": "BC27+1",
    "BD28": "BD27+BD$3",
    "BE28": "BE27+BE$3",
    "BF28": "BF27+BF$3",
    "BG28": "BG27+BG$3",
    "BH28": "BH27+BH$3",
    "BI28": "BI27+BI$3",
    "BJ28": "BJ27+BJ$3",
    "BK28": "BK27+BK$3",
    "BL28": "BL27+BL$3",
    "BN28": "BN27+BN$3",
    "BP28": "BP27+BP$3",
    "BR28": "BR27+BR$3",
    "BT28": "BT27+FT27",
    "BU28": "BU27+FU27",
    "BV28": "BV27+FV27",
    "BW28": "BW27+FW27",
    "BX28": "BX27+FX27",
    "BY28": "BY27+FY27",
    "BZ28": "BZ27+FZ27",
    "CA28": "CA27+GA27",
    "CB28": "CB27+GB27",
    "CC28": "CC27+GC27",
    "CD28": "CD27+GD27",
    "CE28": "CE27+GE27",
    "CF28": "CF27+GF27",
    "CG28": "CG27+GG27",
    "CH28": "CH27+GH27",
    "CI28": "CI27+GI27",
    "CJ28": "CJ27+GJ27",
    "CK28": "CK27+GK27",
    "CL28": "CL27+GL27",
    "CM28": "CM27+GM27",
    "CN28": "CN27+GN27",
    "CO28": "CO27+GO27",
    "CS28": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI28,1)",
    "CT28": "INDEX($BD$5:$BD173,BT28)",
    "CU28": "INDEX($BN$5:$BN173,CD28)",
    "CV28": "INDEX($BO$5:$BO173,CE28)",
    "CW28": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG28)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX28": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO28, 1)",
    "CY28": "LET(\n  Base, $CR$6,\n  Damage, $CT28,\n  DamageMastery, $CS28,\n  DemonMastery, $CX28,\n  SPB, $CU28,\n  ITO, $CV28,\n  Shock, $CW28,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ28": "MIN(100%, DA28)",
    "DA28": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK28*1%, 0)",
    "DB28": "LET(\n  Lab, 1+INDEX($BF$5:$BF173,BV28),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC28": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK28*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI173,BY28) + CardCritMastery)",
    "DD28": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK28*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ173,BZ28) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE28": "LET(\n  CF, $DB28,\n  CC, $CZ28,\n  SCM, $DD28,\n  SCC, $DC28,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF28": "LET(\n  CF, $DB28,\n  CC, $DA28,\n  SCM, $DD28,\n  SCC, $DC28,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG28": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH28)), 0)",
    "DH28": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ28*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE173,BU28),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI28": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG173, BW28), 1) + $AE$9)",
    "DJ28": "LET(\n  DpmLab, INDEX($BH$5:$BH173,BX28),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL28, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK28": "(1+$DI28*$DJ28*$AQ$9)",
    "DL28": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK173,CA28),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM28*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM28": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK173,CA28),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM28*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN28": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL173,CB28)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO28": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH28,\n  Rapid, DG28,\n  RDPM, DK28,\n  SuperTower, $DL28,\n  Rend, $DN28,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP28": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ28": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK28),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR28": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP28),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF28-1))",
    "DS28": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG28, DH28),0))",
    "DT28": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP28),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV28, $AR$29), 0))",
    "DU28": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK28),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM173,CC28), $DV28, $AR$29), 0))",
    "DV28": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH28), $AO$29)",
    "DW28": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM28,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28, $DB28), 1),\n\n  DW, $DR28,\n  CL, $DS28,\n  SM, $DT28,\n  SLM, $DU28,\n  SL, $DQ28,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX28": "CY28*(DE28*DO28*DQ28+DW28*DF28)",
    "DZ28": "IF(INDEX($BD$6:$BD173,BT28)=\"\", \"\", INDEX($BD$5:$BD173,BT28+1))",
    "EA28": "IF(OR($AO$25, INDEX($BE$6:$BE173,BU28)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ28)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE173,BU28+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI28*$DJ28*$AQ$9),\n  SuperTower, $DL28,\n  Rend, $DN28,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28, $DB28), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR28,\n  SM, $DT28,\n  SLM, $DU28,\n  SL, $DQ28,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM28, UltCritCard),\n\nCY28*(DE28*OtherDamage*SL+UwDamage*DF28)))",
    "EB28": "IF(INDEX($BF$6:$BF173,BV28)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF173,BV28+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ28,\n  CCUW, $DA28,\n  SCM, $DD28,\n  SCC, $DC28,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28, CF), 1),\n\n  DW, $DR28,\n  CL, $DS28,\n  SM, $DT28,\n  SLM, $DU28,\n  SL, $DQ28,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM28, UltCritCard),\n\nCY28 * (Critical * DO28 * SL + UwDamage * UWCritical)))",
    "EC28": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG173,BW28)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH28,\n  Rapid, DG28,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG173, BW28+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ28*$AQ$9),\n  SuperTower, $DL28,\n  Rend, $DN28,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM173,CC28), $DV28, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM28,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28, $DB28), 1),\n\n  DW, $DR28,\n  CL, $DS28,\n  SM, $DT28,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY28*(DE28*OtherDamage*SL+UWDamage*DF28)))",
    "ED28": "IF(OR($AO$25, INDEX($BH$6:$BH173,BX28)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH173,BX28+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL28, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI28*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM173,CC28), $DV28, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH28,\n  Rapid, DG28,\n  SuperTower, $DL28,\n  Rend, $DN28,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM28,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28, $DB28), 1),\n\n  DW, $DR28,\n  CL, $DS28,\n  SM, $DT28,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY28*(DE28*OtherDamage*SL+UWDamage*DF28)))",
    "EE28": "IF(INDEX($BI$6:$BI173,BY28)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK28, 0),\n  CF, $DB28,\n  CC, $CZ28,\n  CCUW, $DA28,\n  SCM, $DD28,\n  SCC, $AV$17+INDEX($BI$5:$BI173,BY28+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY28 * (Critical*DO28*$DQ28+DW28*UWCritical)))",
    "EF28": "IF(INDEX($BJ$6:$BJ173,BZ28)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK28*1%, 1),\n  CF, $DB28,\n  CC, $CZ28,\n  CCUW, $DA28,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ173,BZ28+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC28,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY28*(Critical*DO28*$DQ28+DW28*UWCritical)))",
    "EG28": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK173,CA28)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH28,\n  Rapid, DG28,\n  DPM, (1+$DI28*$DJ28*$AQ$9),\n  Rend, $DN28,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK173,CA28+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM28*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28, $DB28), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK173,CA28+1)-1))/(45-CM28*3),1),\n\n  SL, $DQ28,\n  DW, $DR28,\n  CL, $DS28,\n  SM, $DT28,\n  SLM, $DU28,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY28*(DE28*OtherDamage*SL+UwDamage*DF28)))",
    "EH28": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL173,CB28+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL173,CB28)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH28,\n  Rapid, DG28,\n  DPM, (1+$DI28*$DJ28*$AQ$9),\n  SuperTower, $DL28,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL173,CB28+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY28*(DE28*OtherDamage*$DQ28+DW28*DF28)))",
    "EI28": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM173,CC28)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28, $DB28), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK28),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV28, $AR$29), 0),\n\n  DW, $DR28,\n  CL, $DS28,\n  SM, $DT28,\n  SL, $DQ28,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM28, UltCritCard),\nCY28*(DE28*DO28*SL+UwDamage*DF28)))",
    "EJ28": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN173,CD28)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT28,\n  DamageMastery, $CS28,\n  DemonMastery, $CX28,\n  SPB, INDEX($BN$5:$BN173,CD28+1),\n  ITO, $CV28,\n  Shock, $CW28,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE28*DO28*$DQ28+DW28*DF28)))",
    "EK28": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO173,CE28)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT28,\n  DamageMastery, $CS28,\n  DemonMastery, $CX28,\n  SPB, $CU28,\n  ITO, INDEX($BO$5:$BO173,CE28+1),\n  Shock, $CW28,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE28*DO28*$DQ28+DW28*DF28)))",
    "EL28": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP173,CF28)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28, $DB28), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP28),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF28),\n  CL, $DS28,\n  SM, $DT28,\n  SLM, $DU28,\n  SL, $DQ28,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM28, UltCritCard),\nCY28*(DE28*DO28*SL+UwDamage*DF28)))",
    "EM28": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ173,CG28)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG28+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN28": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR173,CH28)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28, $DB28), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH28+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP28),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK28),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM173,CC28), SMHeat, $AR$29), 0),\n\n  DW, $DR28,\n  CL, $DS28,\n  SL, $DQ28,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM28, UltCritCard),\nCY28*(DE28*DO28*SL+UwDamage*DF28)))",
    "EO28": "IF(OR(CI28 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI28+1))",
    "EP28": "IF(OR($AO$25, CJ28 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ28+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE172,BU28),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL28, 1),\n  DPM, (1+$DI28*CardRangeMastery*$DJ28*$AQ$9),\n  SuperTower, $DL28,\n  Rend, $DN28,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28, $DB28), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR28,\n  SM, $DT28,\n  SLM, $DU28,\n  SL, $DQ28,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM28, UltCritCard),\n\nCY28*(DE28*OtherDamage*SL+UwDamage*DF28)))",
    "EQ28": "IF(OR(CK28 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK28+1)*1%, 1),\n  CF, $DB28,\n  CC, MIN(100%, $CZ28 + 1%),\n  CCUW, DA28 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ173,BZ28) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC28 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR28,\n  CL, $DS28,\n  SM, $DT28,\n  SLM, $DU28,\n  SL, $DQ28,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM28, UltCritCard),\n\nCY28 * (Critical*DO28*SL+UwDamage*UWCritical)))",
    "ER28": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL28 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH173,BX28),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL28+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI28*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM173,CC28), $DV28, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH28,\n  Rapid, DG28,\n  SuperTower, $DL28,\n  Rend, $DN28,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM28,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28, $DB28), 1),\n\n  DW, $DR28,\n  CL, $DS28,\n  SM, $DT28,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY28*(DE28*OtherDamage*SL+UWDamage*DF28)))",
    "ES28": "IF(OR(CM28 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH28,\n  Rapid, DG28,\n  RDPM, (1+$DI28*$DJ28*$AQ$9),\n  Rend, $DN28,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK173,CA28),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM28+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28, $DB28), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR28,\n  CL, $DS28,\n  SM, $DT28,\n  SLM, $DU28,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY28*(DE28*OtherDamage*SL+UwDamage*DF28)))",
    "ET28": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN28 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM28,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN28+1, $DB28), 1),\n\n  DW, $DR28,\n  CL, $DS28,\n  SM, $DT28,\n  SLM, $DU28,\n  SL, $DQ28,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY28*(DE28*DO28*SL+UWDamage*DF28)))",
    "EU28": "IF(OR(NOT($BA$3), NOT($BA$23), $CO28 > $BA$15), \"\", 1 + 0.5*(CO28+1))",
    "EW28": "IF(DZ28=\"\", \"\", LET(\n  Now, CT28,\n  Next, DZ28,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT28),\nFactor/Cost))",
    "EX28": "IF(EA28=\"\",\"\",(EA28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU28))",
    "EY28": "IF(EB28=\"\",\"\",(EB28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV28))",
    "EZ28": "IF(EC28=\"\",\"\",(EC28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW28))",
    "FA28": "IF(ED28=\"\",\"\",(ED28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX28))",
    "FB28": "IF(EE28=\"\",\"\",(EE28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY28))",
    "FC28": "IF(EF28=\"\",\"\",(EF28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ28))",
    "FD28": "IF(EG28=\"\",\"\",(EG28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA28))",
    "FE28": "IF(EH28=\"\",\"\",(EH28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB28))",
    "FF28": "IF(EI28=\"\",\"\",(EI28/$DX28-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC28+1, 1, CC28))))",
    "FG28": "IF(EJ28=\"\",\"\",(EJ28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD28))",
    "FH28": "IF(EK28=\"\",\"\",(EK28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE28))",
    "FI28": "IF(EL28=\"\",\"\",(EL28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF28))",
    "FJ28": "IF(EM28=\"\", \"\", LET(\n  Now, CW28,\n  Next, EM28,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG28),\nFactor/Cost))",
    "FK28": "IF(EN28=\"\",\"\",(EN28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH28))",
    "FL28": "IF(EO28=\"\", \"\", LET(\n  Now, CS28,\n  Next, EO28,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI28),\nFactor/Cost))",
    "FM28": "IF(EP28=\"\",\"\",(EP28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ28))",
    "FN28": "IF(EQ28=\"\",\"\",(EQ28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK28))",
    "FO28": "IF(ER28=\"\",\"\",(ER28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL28))",
    "FP28": "IF(ES28=\"\",\"\",(ES28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM28))",
    "FQ28": "IF(ET28=\"\",\"\",(ET28/$DX28-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN28))",
    "FR28": "IF(EU28=\"\", \"\", LET(\n  Now, CX28,\n  Next, EU28,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO28),\nFactor/Cost))",
    "FT28": "IF(COLUMN(EW28:FR28) = MIN(IF(EW28:FR28=MAX(EW28:FR28), COLUMN(EW28:FR28))), 1, \"\")",
    "D29": "IF(SUM(FT28:GP28),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F29)),\"Card Mastery\",F29),G29)/$D$5,\"\")",
    "F29": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT28:GP28),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT28:GP28=1)),)\"),\"Critical Factor\")",
    "G29": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT28:GP28),ARRAYFORMULA(FILTER(BT28:CP28 , FT28:GP28=1)),\"\"\"\")\"),8.0)",
    "I29": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT28:GP28),ARRAYFORMULA(FILTER(EW28:FS28 , FT28:GP28=1))*D$5,\"\"\"\")\"),0.22421589600115566)",
    "K29": "IF(H29<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D29)),)",
    "AD29": "IF(EQ(AE29, -6), \"-\", LET(\n  Next, EQ($AE$21, \"Next Tier\"),\n  Common, EQ($AE$21, \"Common\"),\n  Rare, EQ($AE$21, \"Rare\"),\n  Epic, EQ($AE$21, \"Epic\"),\n  Legendary, EQ($AE$21, \"Legendary\"),\n  Mythic, EQ($AE$21, \"Mythic\"),\n  Ancestral, EQ($AE$21, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE29=0, -2, AE29=-2, -4, AE29=-4, -6), Legendary, -2, Mythic, -4, Ancestral, -6), 0),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  SLQuant, $AK$37,\n  SlAngle, $AJ$37+$AE$26,\n  SlBonus, ($AI$37+Planner)*(1+$AR$31),\n  SlCoverage, MIN(100%, SLQuant*SlAngle/360),\n  PerkSL, IF(AND($BA$26,$BA$33),1.5,1),\n  StMastery, DM5,\n\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, Planner, $DP5),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV5, $AR$29), 0),\n\n  DW, $DR5,\n  CL, $DS5,\n  SL, DQ5,\n  SLM, $DU$5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*DO5*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE29": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$20:$AU$25\"), MATCH(AC29,INDIRECT($C$2 & \"!$AR$20:$AR$25\"), 0)),0)",
    "AI29": "'Master Sheet'!C73",
    "AK29": "1+AI29*1.5",
    "AZ29": "2*AY29",
    "BC29": "BC28+1",
    "BD29": "BD28+BD$3",
    "BE29": "BE28+BE$3",
    "BF29": "BF28+BF$3",
    "BG29": "BG28+BG$3",
    "BH29": "BH28+BH$3",
    "BI29": "BI28+BI$3",
    "BJ29": "BJ28+BJ$3",
    "BK29": "BK28+BK$3",
    "BL29": "BL28+BL$3",
    "BN29": "BN28+BN$3",
    "BP29": "BP28+BP$3",
    "BR29": "BR28+BR$3",
    "BT29": "BT28+FT28",
    "BU29": "BU28+FU28",
    "BV29": "BV28+FV28",
    "BW29": "BW28+FW28",
    "BX29": "BX28+FX28",
    "BY29": "BY28+FY28",
    "BZ29": "BZ28+FZ28",
    "CA29": "CA28+GA28",
    "CB29": "CB28+GB28",
    "CC29": "CC28+GC28",
    "CD29": "CD28+GD28",
    "CE29": "CE28+GE28",
    "CF29": "CF28+GF28",
    "CG29": "CG28+GG28",
    "CH29": "CH28+GH28",
    "CI29": "CI28+GI28",
    "CJ29": "CJ28+GJ28",
    "CK29": "CK28+GK28",
    "CL29": "CL28+GL28",
    "CM29": "CM28+GM28",
    "CN29": "CN28+GN28",
    "CO29": "CO28+GO28",
    "CS29": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI29,1)",
    "CT29": "INDEX($BD$5:$BD174,BT29)",
    "CU29": "INDEX($BN$5:$BN174,CD29)",
    "CV29": "INDEX($BO$5:$BO174,CE29)",
    "CW29": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG29)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX29": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO29, 1)",
    "CY29": "LET(\n  Base, $CR$6,\n  Damage, $CT29,\n  DamageMastery, $CS29,\n  DemonMastery, $CX29,\n  SPB, $CU29,\n  ITO, $CV29,\n  Shock, $CW29,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ29": "MIN(100%, DA29)",
    "DA29": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK29*1%, 0)",
    "DB29": "LET(\n  Lab, 1+INDEX($BF$5:$BF174,BV29),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC29": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK29*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI174,BY29) + CardCritMastery)",
    "DD29": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK29*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ174,BZ29) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE29": "LET(\n  CF, $DB29,\n  CC, $CZ29,\n  SCM, $DD29,\n  SCC, $DC29,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF29": "LET(\n  CF, $DB29,\n  CC, $DA29,\n  SCM, $DD29,\n  SCC, $DC29,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG29": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH29)), 0)",
    "DH29": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ29*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE174,BU29),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI29": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG174, BW29), 1) + $AE$9)",
    "DJ29": "LET(\n  DpmLab, INDEX($BH$5:$BH174,BX29),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL29, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK29": "(1+$DI29*$DJ29*$AQ$9)",
    "DL29": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK174,CA29),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM29*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM29": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK174,CA29),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM29*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN29": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL174,CB29)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO29": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH29,\n  Rapid, DG29,\n  RDPM, DK29,\n  SuperTower, $DL29,\n  Rend, $DN29,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP29": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ29": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK29),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR29": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP29),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF29-1))",
    "DS29": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG29, DH29),0))",
    "DT29": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP29),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV29, $AR$29), 0))",
    "DU29": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK29),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM174,CC29), $DV29, $AR$29), 0))",
    "DV29": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH29), $AO$29)",
    "DW29": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM29,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29, $DB29), 1),\n\n  DW, $DR29,\n  CL, $DS29,\n  SM, $DT29,\n  SLM, $DU29,\n  SL, $DQ29,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX29": "CY29*(DE29*DO29*DQ29+DW29*DF29)",
    "DZ29": "IF(INDEX($BD$6:$BD174,BT29)=\"\", \"\", INDEX($BD$5:$BD174,BT29+1))",
    "EA29": "IF(OR($AO$25, INDEX($BE$6:$BE174,BU29)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ29)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE174,BU29+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI29*$DJ29*$AQ$9),\n  SuperTower, $DL29,\n  Rend, $DN29,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29, $DB29), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR29,\n  SM, $DT29,\n  SLM, $DU29,\n  SL, $DQ29,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM29, UltCritCard),\n\nCY29*(DE29*OtherDamage*SL+UwDamage*DF29)))",
    "EB29": "IF(INDEX($BF$6:$BF174,BV29)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF174,BV29+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ29,\n  CCUW, $DA29,\n  SCM, $DD29,\n  SCC, $DC29,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29, CF), 1),\n\n  DW, $DR29,\n  CL, $DS29,\n  SM, $DT29,\n  SLM, $DU29,\n  SL, $DQ29,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM29, UltCritCard),\n\nCY29 * (Critical * DO29 * SL + UwDamage * UWCritical)))",
    "EC29": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG174,BW29)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH29,\n  Rapid, DG29,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG174, BW29+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ29*$AQ$9),\n  SuperTower, $DL29,\n  Rend, $DN29,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM174,CC29), $DV29, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM29,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29, $DB29), 1),\n\n  DW, $DR29,\n  CL, $DS29,\n  SM, $DT29,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY29*(DE29*OtherDamage*SL+UWDamage*DF29)))",
    "ED29": "IF(OR($AO$25, INDEX($BH$6:$BH174,BX29)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH174,BX29+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL29, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI29*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM174,CC29), $DV29, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH29,\n  Rapid, DG29,\n  SuperTower, $DL29,\n  Rend, $DN29,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM29,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29, $DB29), 1),\n\n  DW, $DR29,\n  CL, $DS29,\n  SM, $DT29,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY29*(DE29*OtherDamage*SL+UWDamage*DF29)))",
    "EE29": "IF(INDEX($BI$6:$BI174,BY29)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK29, 0),\n  CF, $DB29,\n  CC, $CZ29,\n  CCUW, $DA29,\n  SCM, $DD29,\n  SCC, $AV$17+INDEX($BI$5:$BI174,BY29+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY29 * (Critical*DO29*$DQ29+DW29*UWCritical)))",
    "EF29": "IF(INDEX($BJ$6:$BJ174,BZ29)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK29*1%, 1),\n  CF, $DB29,\n  CC, $CZ29,\n  CCUW, $DA29,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ174,BZ29+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC29,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY29*(Critical*DO29*$DQ29+DW29*UWCritical)))",
    "EG29": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK174,CA29)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH29,\n  Rapid, DG29,\n  DPM, (1+$DI29*$DJ29*$AQ$9),\n  Rend, $DN29,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK174,CA29+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM29*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29, $DB29), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK174,CA29+1)-1))/(45-CM29*3),1),\n\n  SL, $DQ29,\n  DW, $DR29,\n  CL, $DS29,\n  SM, $DT29,\n  SLM, $DU29,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY29*(DE29*OtherDamage*SL+UwDamage*DF29)))",
    "EH29": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL174,CB29+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL174,CB29)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH29,\n  Rapid, DG29,\n  DPM, (1+$DI29*$DJ29*$AQ$9),\n  SuperTower, $DL29,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL174,CB29+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY29*(DE29*OtherDamage*$DQ29+DW29*DF29)))",
    "EI29": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM174,CC29)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29, $DB29), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK29),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV29, $AR$29), 0),\n\n  DW, $DR29,\n  CL, $DS29,\n  SM, $DT29,\n  SL, $DQ29,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM29, UltCritCard),\nCY29*(DE29*DO29*SL+UwDamage*DF29)))",
    "EJ29": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN174,CD29)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT29,\n  DamageMastery, $CS29,\n  DemonMastery, $CX29,\n  SPB, INDEX($BN$5:$BN174,CD29+1),\n  ITO, $CV29,\n  Shock, $CW29,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE29*DO29*$DQ29+DW29*DF29)))",
    "EK29": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO174,CE29)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT29,\n  DamageMastery, $CS29,\n  DemonMastery, $CX29,\n  SPB, $CU29,\n  ITO, INDEX($BO$5:$BO174,CE29+1),\n  Shock, $CW29,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE29*DO29*$DQ29+DW29*DF29)))",
    "EL29": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP174,CF29)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29, $DB29), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP29),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF29),\n  CL, $DS29,\n  SM, $DT29,\n  SLM, $DU29,\n  SL, $DQ29,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM29, UltCritCard),\nCY29*(DE29*DO29*SL+UwDamage*DF29)))",
    "EM29": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ174,CG29)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG29+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN29": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR174,CH29)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29, $DB29), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH29+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP29),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK29),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM174,CC29), SMHeat, $AR$29), 0),\n\n  DW, $DR29,\n  CL, $DS29,\n  SL, $DQ29,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM29, UltCritCard),\nCY29*(DE29*DO29*SL+UwDamage*DF29)))",
    "EO29": "IF(OR(CI29 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI29+1))",
    "EP29": "IF(OR($AO$25, CJ29 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ29+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE173,BU29),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL29, 1),\n  DPM, (1+$DI29*CardRangeMastery*$DJ29*$AQ$9),\n  SuperTower, $DL29,\n  Rend, $DN29,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29, $DB29), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR29,\n  SM, $DT29,\n  SLM, $DU29,\n  SL, $DQ29,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM29, UltCritCard),\n\nCY29*(DE29*OtherDamage*SL+UwDamage*DF29)))",
    "EQ29": "IF(OR(CK29 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK29+1)*1%, 1),\n  CF, $DB29,\n  CC, MIN(100%, $CZ29 + 1%),\n  CCUW, DA29 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ174,BZ29) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC29 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR29,\n  CL, $DS29,\n  SM, $DT29,\n  SLM, $DU29,\n  SL, $DQ29,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM29, UltCritCard),\n\nCY29 * (Critical*DO29*SL+UwDamage*UWCritical)))",
    "ER29": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL29 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH174,BX29),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL29+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI29*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM174,CC29), $DV29, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH29,\n  Rapid, DG29,\n  SuperTower, $DL29,\n  Rend, $DN29,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM29,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29, $DB29), 1),\n\n  DW, $DR29,\n  CL, $DS29,\n  SM, $DT29,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY29*(DE29*OtherDamage*SL+UWDamage*DF29)))",
    "ES29": "IF(OR(CM29 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH29,\n  Rapid, DG29,\n  RDPM, (1+$DI29*$DJ29*$AQ$9),\n  Rend, $DN29,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK174,CA29),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM29+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29, $DB29), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR29,\n  CL, $DS29,\n  SM, $DT29,\n  SLM, $DU29,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY29*(DE29*OtherDamage*SL+UwDamage*DF29)))",
    "ET29": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN29 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM29,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN29+1, $DB29), 1),\n\n  DW, $DR29,\n  CL, $DS29,\n  SM, $DT29,\n  SLM, $DU29,\n  SL, $DQ29,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY29*(DE29*DO29*SL+UWDamage*DF29)))",
    "EU29": "IF(OR(NOT($BA$3), NOT($BA$23), $CO29 > $BA$15), \"\", 1 + 0.5*(CO29+1))",
    "EW29": "IF(DZ29=\"\", \"\", LET(\n  Now, CT29,\n  Next, DZ29,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT29),\nFactor/Cost))",
    "EX29": "IF(EA29=\"\",\"\",(EA29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU29))",
    "EY29": "IF(EB29=\"\",\"\",(EB29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV29))",
    "EZ29": "IF(EC29=\"\",\"\",(EC29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW29))",
    "FA29": "IF(ED29=\"\",\"\",(ED29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX29))",
    "FB29": "IF(EE29=\"\",\"\",(EE29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY29))",
    "FC29": "IF(EF29=\"\",\"\",(EF29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ29))",
    "FD29": "IF(EG29=\"\",\"\",(EG29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA29))",
    "FE29": "IF(EH29=\"\",\"\",(EH29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB29))",
    "FF29": "IF(EI29=\"\",\"\",(EI29/$DX29-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC29+1, 1, CC29))))",
    "FG29": "IF(EJ29=\"\",\"\",(EJ29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD29))",
    "FH29": "IF(EK29=\"\",\"\",(EK29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE29))",
    "FI29": "IF(EL29=\"\",\"\",(EL29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF29))",
    "FJ29": "IF(EM29=\"\", \"\", LET(\n  Now, CW29,\n  Next, EM29,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG29),\nFactor/Cost))",
    "FK29": "IF(EN29=\"\",\"\",(EN29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH29))",
    "FL29": "IF(EO29=\"\", \"\", LET(\n  Now, CS29,\n  Next, EO29,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI29),\nFactor/Cost))",
    "FM29": "IF(EP29=\"\",\"\",(EP29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ29))",
    "FN29": "IF(EQ29=\"\",\"\",(EQ29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK29))",
    "FO29": "IF(ER29=\"\",\"\",(ER29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL29))",
    "FP29": "IF(ES29=\"\",\"\",(ES29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM29))",
    "FQ29": "IF(ET29=\"\",\"\",(ET29/$DX29-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN29))",
    "FR29": "IF(EU29=\"\", \"\", LET(\n  Now, CX29,\n  Next, EU29,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO29),\nFactor/Cost))",
    "FT29": "IF(COLUMN(EW29:FR29) = MIN(IF(EW29:FR29=MAX(EW29:FR29), COLUMN(EW29:FR29))), 1, \"\")",
    "D30": "IF(SUM(FT29:GP29),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F30)),\"Card Mastery\",F30),G30)/$D$5,\"\")",
    "F30": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT29:GP29),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT29:GP29=1)),)\"),\"Attack Speed\")",
    "G30": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT29:GP29),ARRAYFORMULA(FILTER(BT29:CP29 , FT29:GP29=1)),\"\"\"\")\"),7.0)",
    "I30": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT29:GP29),ARRAYFORMULA(FILTER(EW29:FS29 , FT29:GP29=1))*D$5,\"\"\"\")\"),0.22318526945660935)",
    "K30": "IF(H30<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D30)),)",
    "AD30": "IF(EQ(AE30, 250), \"-\", LET(\n  Next, EQ($AE$21, \"Next Tier\"),\n  Common, EQ($AE$21, \"Common\"),\n  Rare, EQ($AE$21, \"Rare\"),\n  Epic, EQ($AE$21, \"Epic\"),\n  Legendary, EQ($AE$21, \"Legendary\"),\n  Mythic, EQ($AE$21, \"Mythic\"),\n  Ancestral, EQ($AE$21, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE30=0, 8, AE30=8, 15, AE30=15, 25, AE30=25, 50, AE30=50, 100, AE30=100, 250), Common, 8, Rare, 15, Epic, 25, Legendary, 50, Mythic, 100, Ancestral, 250), 0),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  SLQuant, $AK$37,\n  SlAngle, $AJ$37+$AE$26,\n  SlBonus, ($AI$37+Planner)*(1+$AR$31),\n  SlCoverage, MIN(100%, SLQuant*SlAngle/360),\n  PerkSL, IF(AND($BA$26,$BA$33),1.5,1),\n  StMastery, DM5,\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, Planner, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, CR$9*CR$11*$DG$5, DH5),0),\n\n  DW, $DR5,\n  SL, DQ5,\n  SM, $DT5,\n  SLM, $DU5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*DO5*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE30": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$20:$AU$25\"), MATCH(AC30,INDIRECT($C$2 & \"!$AR$20:$AR$25\"), 0)),0)",
    "AX30": "\"x\" &AZ30  & \" Damage / Boss Health x8\"",
    "AZ30": "1.5*(1+AK25)",
    "BC30": "BC29+1",
    "BD30": "BD29+BD$3",
    "BE30": "BE29+BE$3",
    "BF30": "BF29+BF$3",
    "BG30": "BG29+BG$3",
    "BH30": "BH29+BH$3",
    "BI30": "BI29+BI$3",
    "BJ30": "BJ29+BJ$3",
    "BK30": "BK29+BK$3",
    "BL30": "BL29+BL$3",
    "BN30": "BN29+BN$3",
    "BP30": "BP29+BP$3",
    "BR30": "BR29+BR$3",
    "BT30": "BT29+FT29",
    "BU30": "BU29+FU29",
    "BV30": "BV29+FV29",
    "BW30": "BW29+FW29",
    "BX30": "BX29+FX29",
    "BY30": "BY29+FY29",
    "BZ30": "BZ29+FZ29",
    "CA30": "CA29+GA29",
    "CB30": "CB29+GB29",
    "CC30": "CC29+GC29",
    "CD30": "CD29+GD29",
    "CE30": "CE29+GE29",
    "CF30": "CF29+GF29",
    "CG30": "CG29+GG29",
    "CH30": "CH29+GH29",
    "CI30": "CI29+GI29",
    "CJ30": "CJ29+GJ29",
    "CK30": "CK29+GK29",
    "CL30": "CL29+GL29",
    "CM30": "CM29+GM29",
    "CN30": "CN29+GN29",
    "CO30": "CO29+GO29",
    "CS30": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI30,1)",
    "CT30": "INDEX($BD$5:$BD175,BT30)",
    "CU30": "INDEX($BN$5:$BN175,CD30)",
    "CV30": "INDEX($BO$5:$BO175,CE30)",
    "CW30": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG30)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX30": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO30, 1)",
    "CY30": "LET(\n  Base, $CR$6,\n  Damage, $CT30,\n  DamageMastery, $CS30,\n  DemonMastery, $CX30,\n  SPB, $CU30,\n  ITO, $CV30,\n  Shock, $CW30,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ30": "MIN(100%, DA30)",
    "DA30": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK30*1%, 0)",
    "DB30": "LET(\n  Lab, 1+INDEX($BF$5:$BF175,BV30),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC30": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK30*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI175,BY30) + CardCritMastery)",
    "DD30": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK30*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ175,BZ30) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE30": "LET(\n  CF, $DB30,\n  CC, $CZ30,\n  SCM, $DD30,\n  SCC, $DC30,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF30": "LET(\n  CF, $DB30,\n  CC, $DA30,\n  SCM, $DD30,\n  SCC, $DC30,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG30": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH30)), 0)",
    "DH30": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ30*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE175,BU30),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI30": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG175, BW30), 1) + $AE$9)",
    "DJ30": "LET(\n  DpmLab, INDEX($BH$5:$BH175,BX30),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL30, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK30": "(1+$DI30*$DJ30*$AQ$9)",
    "DL30": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK175,CA30),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM30*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM30": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK175,CA30),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM30*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN30": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL175,CB30)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO30": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH30,\n  Rapid, DG30,\n  RDPM, DK30,\n  SuperTower, $DL30,\n  Rend, $DN30,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP30": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ30": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK30),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR30": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP30),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF30-1))",
    "DS30": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG30, DH30),0))",
    "DT30": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP30),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV30, $AR$29), 0))",
    "DU30": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK30),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM175,CC30), $DV30, $AR$29), 0))",
    "DV30": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH30), $AO$29)",
    "DW30": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM30,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30, $DB30), 1),\n\n  DW, $DR30,\n  CL, $DS30,\n  SM, $DT30,\n  SLM, $DU30,\n  SL, $DQ30,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX30": "CY30*(DE30*DO30*DQ30+DW30*DF30)",
    "DZ30": "IF(INDEX($BD$6:$BD175,BT30)=\"\", \"\", INDEX($BD$5:$BD175,BT30+1))",
    "EA30": "IF(OR($AO$25, INDEX($BE$6:$BE175,BU30)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ30)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE175,BU30+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI30*$DJ30*$AQ$9),\n  SuperTower, $DL30,\n  Rend, $DN30,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30, $DB30), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR30,\n  SM, $DT30,\n  SLM, $DU30,\n  SL, $DQ30,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM30, UltCritCard),\n\nCY30*(DE30*OtherDamage*SL+UwDamage*DF30)))",
    "EB30": "IF(INDEX($BF$6:$BF175,BV30)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF175,BV30+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ30,\n  CCUW, $DA30,\n  SCM, $DD30,\n  SCC, $DC30,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30, CF), 1),\n\n  DW, $DR30,\n  CL, $DS30,\n  SM, $DT30,\n  SLM, $DU30,\n  SL, $DQ30,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM30, UltCritCard),\n\nCY30 * (Critical * DO30 * SL + UwDamage * UWCritical)))",
    "EC30": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG175,BW30)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH30,\n  Rapid, DG30,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG175, BW30+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ30*$AQ$9),\n  SuperTower, $DL30,\n  Rend, $DN30,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM175,CC30), $DV30, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM30,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30, $DB30), 1),\n\n  DW, $DR30,\n  CL, $DS30,\n  SM, $DT30,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY30*(DE30*OtherDamage*SL+UWDamage*DF30)))",
    "ED30": "IF(OR($AO$25, INDEX($BH$6:$BH175,BX30)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH175,BX30+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL30, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI30*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM175,CC30), $DV30, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH30,\n  Rapid, DG30,\n  SuperTower, $DL30,\n  Rend, $DN30,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM30,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30, $DB30), 1),\n\n  DW, $DR30,\n  CL, $DS30,\n  SM, $DT30,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY30*(DE30*OtherDamage*SL+UWDamage*DF30)))",
    "EE30": "IF(INDEX($BI$6:$BI175,BY30)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK30, 0),\n  CF, $DB30,\n  CC, $CZ30,\n  CCUW, $DA30,\n  SCM, $DD30,\n  SCC, $AV$17+INDEX($BI$5:$BI175,BY30+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY30 * (Critical*DO30*$DQ30+DW30*UWCritical)))",
    "EF30": "IF(INDEX($BJ$6:$BJ175,BZ30)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK30*1%, 1),\n  CF, $DB30,\n  CC, $CZ30,\n  CCUW, $DA30,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ175,BZ30+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC30,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY30*(Critical*DO30*$DQ30+DW30*UWCritical)))",
    "EG30": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK175,CA30)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH30,\n  Rapid, DG30,\n  DPM, (1+$DI30*$DJ30*$AQ$9),\n  Rend, $DN30,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK175,CA30+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM30*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30, $DB30), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK175,CA30+1)-1))/(45-CM30*3),1),\n\n  SL, $DQ30,\n  DW, $DR30,\n  CL, $DS30,\n  SM, $DT30,\n  SLM, $DU30,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY30*(DE30*OtherDamage*SL+UwDamage*DF30)))",
    "EH30": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL175,CB30+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL175,CB30)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH30,\n  Rapid, DG30,\n  DPM, (1+$DI30*$DJ30*$AQ$9),\n  SuperTower, $DL30,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL175,CB30+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY30*(DE30*OtherDamage*$DQ30+DW30*DF30)))",
    "EI30": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM175,CC30)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30, $DB30), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK30),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV30, $AR$29), 0),\n\n  DW, $DR30,\n  CL, $DS30,\n  SM, $DT30,\n  SL, $DQ30,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM30, UltCritCard),\nCY30*(DE30*DO30*SL+UwDamage*DF30)))",
    "EJ30": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN175,CD30)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT30,\n  DamageMastery, $CS30,\n  DemonMastery, $CX30,\n  SPB, INDEX($BN$5:$BN175,CD30+1),\n  ITO, $CV30,\n  Shock, $CW30,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE30*DO30*$DQ30+DW30*DF30)))",
    "EK30": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO175,CE30)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT30,\n  DamageMastery, $CS30,\n  DemonMastery, $CX30,\n  SPB, $CU30,\n  ITO, INDEX($BO$5:$BO175,CE30+1),\n  Shock, $CW30,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE30*DO30*$DQ30+DW30*DF30)))",
    "EL30": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP175,CF30)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30, $DB30), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP30),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF30),\n  CL, $DS30,\n  SM, $DT30,\n  SLM, $DU30,\n  SL, $DQ30,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM30, UltCritCard),\nCY30*(DE30*DO30*SL+UwDamage*DF30)))",
    "EM30": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ175,CG30)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG30+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN30": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR175,CH30)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30, $DB30), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH30+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP30),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK30),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM175,CC30), SMHeat, $AR$29), 0),\n\n  DW, $DR30,\n  CL, $DS30,\n  SL, $DQ30,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM30, UltCritCard),\nCY30*(DE30*DO30*SL+UwDamage*DF30)))",
    "EO30": "IF(OR(CI30 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI30+1))",
    "EP30": "IF(OR($AO$25, CJ30 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ30+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE174,BU30),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL30, 1),\n  DPM, (1+$DI30*CardRangeMastery*$DJ30*$AQ$9),\n  SuperTower, $DL30,\n  Rend, $DN30,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30, $DB30), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR30,\n  SM, $DT30,\n  SLM, $DU30,\n  SL, $DQ30,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM30, UltCritCard),\n\nCY30*(DE30*OtherDamage*SL+UwDamage*DF30)))",
    "EQ30": "IF(OR(CK30 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK30+1)*1%, 1),\n  CF, $DB30,\n  CC, MIN(100%, $CZ30 + 1%),\n  CCUW, DA30 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ175,BZ30) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC30 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR30,\n  CL, $DS30,\n  SM, $DT30,\n  SLM, $DU30,\n  SL, $DQ30,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM30, UltCritCard),\n\nCY30 * (Critical*DO30*SL+UwDamage*UWCritical)))",
    "ER30": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL30 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH175,BX30),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL30+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI30*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM175,CC30), $DV30, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH30,\n  Rapid, DG30,\n  SuperTower, $DL30,\n  Rend, $DN30,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM30,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30, $DB30), 1),\n\n  DW, $DR30,\n  CL, $DS30,\n  SM, $DT30,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY30*(DE30*OtherDamage*SL+UWDamage*DF30)))",
    "ES30": "IF(OR(CM30 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH30,\n  Rapid, DG30,\n  RDPM, (1+$DI30*$DJ30*$AQ$9),\n  Rend, $DN30,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK175,CA30),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM30+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30, $DB30), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR30,\n  CL, $DS30,\n  SM, $DT30,\n  SLM, $DU30,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY30*(DE30*OtherDamage*SL+UwDamage*DF30)))",
    "ET30": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN30 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM30,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN30+1, $DB30), 1),\n\n  DW, $DR30,\n  CL, $DS30,\n  SM, $DT30,\n  SLM, $DU30,\n  SL, $DQ30,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY30*(DE30*DO30*SL+UWDamage*DF30)))",
    "EU30": "IF(OR(NOT($BA$3), NOT($BA$23), $CO30 > $BA$15), \"\", 1 + 0.5*(CO30+1))",
    "EW30": "IF(DZ30=\"\", \"\", LET(\n  Now, CT30,\n  Next, DZ30,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT30),\nFactor/Cost))",
    "EX30": "IF(EA30=\"\",\"\",(EA30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU30))",
    "EY30": "IF(EB30=\"\",\"\",(EB30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV30))",
    "EZ30": "IF(EC30=\"\",\"\",(EC30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW30))",
    "FA30": "IF(ED30=\"\",\"\",(ED30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX30))",
    "FB30": "IF(EE30=\"\",\"\",(EE30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY30))",
    "FC30": "IF(EF30=\"\",\"\",(EF30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ30))",
    "FD30": "IF(EG30=\"\",\"\",(EG30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA30))",
    "FE30": "IF(EH30=\"\",\"\",(EH30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB30))",
    "FF30": "IF(EI30=\"\",\"\",(EI30/$DX30-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC30+1, 1, CC30))))",
    "FG30": "IF(EJ30=\"\",\"\",(EJ30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD30))",
    "FH30": "IF(EK30=\"\",\"\",(EK30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE30))",
    "FI30": "IF(EL30=\"\",\"\",(EL30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF30))",
    "FJ30": "IF(EM30=\"\", \"\", LET(\n  Now, CW30,\n  Next, EM30,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG30),\nFactor/Cost))",
    "FK30": "IF(EN30=\"\",\"\",(EN30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH30))",
    "FL30": "IF(EO30=\"\", \"\", LET(\n  Now, CS30,\n  Next, EO30,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI30),\nFactor/Cost))",
    "FM30": "IF(EP30=\"\",\"\",(EP30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ30))",
    "FN30": "IF(EQ30=\"\",\"\",(EQ30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK30))",
    "FO30": "IF(ER30=\"\",\"\",(ER30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL30))",
    "FP30": "IF(ES30=\"\",\"\",(ES30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM30))",
    "FQ30": "IF(ET30=\"\",\"\",(ET30/$DX30-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN30))",
    "FR30": "IF(EU30=\"\", \"\", LET(\n  Now, CX30,\n  Next, EU30,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO30),\nFactor/Cost))",
    "FT30": "IF(COLUMN(EW30:FR30) = MIN(IF(EW30:FR30=MAX(EW30:FR30), COLUMN(EW30:FR30))), 1, \"\")",
    "D31": "IF(SUM(FT30:GP30),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F31)),\"Card Mastery\",F31),G31)/$D$5,\"\")",
    "F31": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT30:GP30),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT30:GP30=1)),)\"),\"Damage\")",
    "G31": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT30:GP30),ARRAYFORMULA(FILTER(BT30:CP30 , FT30:GP30=1)),\"\"\"\")\"),7.0)",
    "I31": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT30:GP30),ARRAYFORMULA(FILTER(EW30:FS30 , FT30:GP30=1))*D$5,\"\"\"\")\"),0.22167487684728984)",
    "K31": "IF(H31<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D31)),)",
    "AD31": "IF(EQ(AE31, 4), \"-\", LET(\n  Next, EQ($AE$21, \"Next Tier\"),\n  Common, EQ($AE$21, \"Common\"),\n  Rare, EQ($AE$21, \"Rare\"),\n  Epic, EQ($AE$21, \"Epic\"),\n  Legendary, EQ($AE$21, \"Legendary\"),\n  Mythic, EQ($AE$21, \"Mythic\"),\n  Ancestral, EQ($AE$21, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE31=0, 1, AE31=1, 2, AE31=2, 3, AE31=3, 4), Epic, 1, Legendary, 2, Mythic, 3, Ancestral, 4), 0),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  SLQuant, $AK$37,\n  SlAngle, $AJ$37+$AE$26,\n  SlBonus, ($AI$37+Planner)*(1+$AR$31),\n  SlCoverage, MIN(100%, SLQuant*SlAngle/360),\n  PerkSL, IF(AND($BA$26,$BA$33),1.5,1),\n  StMastery, DM5,\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, Planner, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, CR$9*CR$11*$DG$5, DH5),0),\n\n  DW, $DR5,\n  SL, DQ5,\n  SM, $DT5,\n  SLM, $DU5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*DO5*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE31": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$20:$AU$25\"), MATCH(AC31,INDIRECT($C$2 & \"!$AR$20:$AR$25\"), 0)),0)",
    "AH31": "CY5*(DE5*DO5*DQ5)/DX5",
    "AR31": "'Master Sheet'!AM5",
    "AS31": "'Master Sheet'!AX26",
    "AX31": "\"E. Dmg \" & ROUND(AZ31*100,0)  & \"% / Dmg -50%\"",
    "AZ31": "(50%*(1+AK25))*-1",
    "BC31": "BC30+1",
    "BD31": "BD30+BD$3",
    "BE31": "BE30+BE$3",
    "BF31": "BF30+BF$3",
    "BG31": "BG30+BG$3",
    "BH31": "BH30+BH$3",
    "BI31": "BI30+BI$3",
    "BJ31": "BJ30+BJ$3",
    "BK31": "BK30+BK$3",
    "BL31": "BL30+BL$3",
    "BP31": "BP30+BP$3",
    "BT31": "BT30+FT30",
    "BU31": "BU30+FU30",
    "BV31": "BV30+FV30",
    "BW31": "BW30+FW30",
    "BX31": "BX30+FX30",
    "BY31": "BY30+FY30",
    "BZ31": "BZ30+FZ30",
    "CA31": "CA30+GA30",
    "CB31": "CB30+GB30",
    "CC31": "CC30+GC30",
    "CD31": "CD30+GD30",
    "CE31": "CE30+GE30",
    "CF31": "CF30+GF30",
    "CG31": "CG30+GG30",
    "CH31": "CH30+GH30",
    "CI31": "CI30+GI30",
    "CJ31": "CJ30+GJ30",
    "CK31": "CK30+GK30",
    "CL31": "CL30+GL30",
    "CM31": "CM30+GM30",
    "CN31": "CN30+GN30",
    "CO31": "CO30+GO30",
    "CS31": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI31,1)",
    "CT31": "INDEX($BD$5:$BD176,BT31)",
    "CU31": "INDEX($BN$5:$BN176,CD31)",
    "CV31": "INDEX($BO$5:$BO176,CE31)",
    "CW31": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG31)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX31": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO31, 1)",
    "CY31": "LET(\n  Base, $CR$6,\n  Damage, $CT31,\n  DamageMastery, $CS31,\n  DemonMastery, $CX31,\n  SPB, $CU31,\n  ITO, $CV31,\n  Shock, $CW31,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ31": "MIN(100%, DA31)",
    "DA31": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK31*1%, 0)",
    "DB31": "LET(\n  Lab, 1+INDEX($BF$5:$BF176,BV31),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC31": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK31*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI176,BY31) + CardCritMastery)",
    "DD31": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK31*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ176,BZ31) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE31": "LET(\n  CF, $DB31,\n  CC, $CZ31,\n  SCM, $DD31,\n  SCC, $DC31,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF31": "LET(\n  CF, $DB31,\n  CC, $DA31,\n  SCM, $DD31,\n  SCC, $DC31,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG31": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH31)), 0)",
    "DH31": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ31*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE176,BU31),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI31": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG176, BW31), 1) + $AE$9)",
    "DJ31": "LET(\n  DpmLab, INDEX($BH$5:$BH176,BX31),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL31, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK31": "(1+$DI31*$DJ31*$AQ$9)",
    "DL31": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK176,CA31),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM31*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM31": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK176,CA31),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM31*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN31": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL176,CB31)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO31": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH31,\n  Rapid, DG31,\n  RDPM, DK31,\n  SuperTower, $DL31,\n  Rend, $DN31,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP31": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ31": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK31),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR31": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP31),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF31-1))",
    "DS31": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG31, DH31),0))",
    "DT31": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP31),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV31, $AR$29), 0))",
    "DU31": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK31),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM176,CC31), $DV31, $AR$29), 0))",
    "DV31": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH31), $AO$29)",
    "DW31": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM31,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31, $DB31), 1),\n\n  DW, $DR31,\n  CL, $DS31,\n  SM, $DT31,\n  SLM, $DU31,\n  SL, $DQ31,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX31": "CY31*(DE31*DO31*DQ31+DW31*DF31)",
    "DZ31": "IF(INDEX($BD$6:$BD176,BT31)=\"\", \"\", INDEX($BD$5:$BD176,BT31+1))",
    "EA31": "IF(OR($AO$25, INDEX($BE$6:$BE176,BU31)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ31)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE176,BU31+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI31*$DJ31*$AQ$9),\n  SuperTower, $DL31,\n  Rend, $DN31,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31, $DB31), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR31,\n  SM, $DT31,\n  SLM, $DU31,\n  SL, $DQ31,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM31, UltCritCard),\n\nCY31*(DE31*OtherDamage*SL+UwDamage*DF31)))",
    "EB31": "IF(INDEX($BF$6:$BF176,BV31)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF176,BV31+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ31,\n  CCUW, $DA31,\n  SCM, $DD31,\n  SCC, $DC31,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31, CF), 1),\n\n  DW, $DR31,\n  CL, $DS31,\n  SM, $DT31,\n  SLM, $DU31,\n  SL, $DQ31,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM31, UltCritCard),\n\nCY31 * (Critical * DO31 * SL + UwDamage * UWCritical)))",
    "EC31": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG176,BW31)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH31,\n  Rapid, DG31,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG176, BW31+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ31*$AQ$9),\n  SuperTower, $DL31,\n  Rend, $DN31,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM176,CC31), $DV31, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM31,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31, $DB31), 1),\n\n  DW, $DR31,\n  CL, $DS31,\n  SM, $DT31,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY31*(DE31*OtherDamage*SL+UWDamage*DF31)))",
    "ED31": "IF(OR($AO$25, INDEX($BH$6:$BH176,BX31)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH176,BX31+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL31, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI31*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM176,CC31), $DV31, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH31,\n  Rapid, DG31,\n  SuperTower, $DL31,\n  Rend, $DN31,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM31,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31, $DB31), 1),\n\n  DW, $DR31,\n  CL, $DS31,\n  SM, $DT31,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY31*(DE31*OtherDamage*SL+UWDamage*DF31)))",
    "EE31": "IF(INDEX($BI$6:$BI176,BY31)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK31, 0),\n  CF, $DB31,\n  CC, $CZ31,\n  CCUW, $DA31,\n  SCM, $DD31,\n  SCC, $AV$17+INDEX($BI$5:$BI176,BY31+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY31 * (Critical*DO31*$DQ31+DW31*UWCritical)))",
    "EF31": "IF(INDEX($BJ$6:$BJ176,BZ31)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK31*1%, 1),\n  CF, $DB31,\n  CC, $CZ31,\n  CCUW, $DA31,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ176,BZ31+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC31,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY31*(Critical*DO31*$DQ31+DW31*UWCritical)))",
    "EG31": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK176,CA31)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH31,\n  Rapid, DG31,\n  DPM, (1+$DI31*$DJ31*$AQ$9),\n  Rend, $DN31,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK176,CA31+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM31*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31, $DB31), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK176,CA31+1)-1))/(45-CM31*3),1),\n\n  SL, $DQ31,\n  DW, $DR31,\n  CL, $DS31,\n  SM, $DT31,\n  SLM, $DU31,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY31*(DE31*OtherDamage*SL+UwDamage*DF31)))",
    "EH31": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL176,CB31+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL176,CB31)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH31,\n  Rapid, DG31,\n  DPM, (1+$DI31*$DJ31*$AQ$9),\n  SuperTower, $DL31,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL176,CB31+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY31*(DE31*OtherDamage*$DQ31+DW31*DF31)))",
    "EI31": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM176,CC31)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31, $DB31), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK31),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV31, $AR$29), 0),\n\n  DW, $DR31,\n  CL, $DS31,\n  SM, $DT31,\n  SL, $DQ31,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM31, UltCritCard),\nCY31*(DE31*DO31*SL+UwDamage*DF31)))",
    "EJ31": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN176,CD31)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT31,\n  DamageMastery, $CS31,\n  DemonMastery, $CX31,\n  SPB, INDEX($BN$5:$BN176,CD31+1),\n  ITO, $CV31,\n  Shock, $CW31,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE31*DO31*$DQ31+DW31*DF31)))",
    "EK31": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO176,CE31)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT31,\n  DamageMastery, $CS31,\n  DemonMastery, $CX31,\n  SPB, $CU31,\n  ITO, INDEX($BO$5:$BO176,CE31+1),\n  Shock, $CW31,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE31*DO31*$DQ31+DW31*DF31)))",
    "EL31": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP176,CF31)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31, $DB31), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP31),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF31),\n  CL, $DS31,\n  SM, $DT31,\n  SLM, $DU31,\n  SL, $DQ31,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM31, UltCritCard),\nCY31*(DE31*DO31*SL+UwDamage*DF31)))",
    "EM31": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ176,CG31)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG31+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN31": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR176,CH31)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31, $DB31), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH31+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP31),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK31),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM176,CC31), SMHeat, $AR$29), 0),\n\n  DW, $DR31,\n  CL, $DS31,\n  SL, $DQ31,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM31, UltCritCard),\nCY31*(DE31*DO31*SL+UwDamage*DF31)))",
    "EO31": "IF(OR(CI31 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI31+1))",
    "EP31": "IF(OR($AO$25, CJ31 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ31+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE175,BU31),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL31, 1),\n  DPM, (1+$DI31*CardRangeMastery*$DJ31*$AQ$9),\n  SuperTower, $DL31,\n  Rend, $DN31,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31, $DB31), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR31,\n  SM, $DT31,\n  SLM, $DU31,\n  SL, $DQ31,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM31, UltCritCard),\n\nCY31*(DE31*OtherDamage*SL+UwDamage*DF31)))",
    "EQ31": "IF(OR(CK31 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK31+1)*1%, 1),\n  CF, $DB31,\n  CC, MIN(100%, $CZ31 + 1%),\n  CCUW, DA31 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ176,BZ31) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC31 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR31,\n  CL, $DS31,\n  SM, $DT31,\n  SLM, $DU31,\n  SL, $DQ31,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM31, UltCritCard),\n\nCY31 * (Critical*DO31*SL+UwDamage*UWCritical)))",
    "ER31": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL31 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH176,BX31),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL31+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI31*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM176,CC31), $DV31, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH31,\n  Rapid, DG31,\n  SuperTower, $DL31,\n  Rend, $DN31,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM31,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31, $DB31), 1),\n\n  DW, $DR31,\n  CL, $DS31,\n  SM, $DT31,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY31*(DE31*OtherDamage*SL+UWDamage*DF31)))",
    "ES31": "IF(OR(CM31 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH31,\n  Rapid, DG31,\n  RDPM, (1+$DI31*$DJ31*$AQ$9),\n  Rend, $DN31,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK176,CA31),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM31+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31, $DB31), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR31,\n  CL, $DS31,\n  SM, $DT31,\n  SLM, $DU31,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY31*(DE31*OtherDamage*SL+UwDamage*DF31)))",
    "ET31": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN31 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM31,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN31+1, $DB31), 1),\n\n  DW, $DR31,\n  CL, $DS31,\n  SM, $DT31,\n  SLM, $DU31,\n  SL, $DQ31,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY31*(DE31*DO31*SL+UWDamage*DF31)))",
    "EU31": "IF(OR(NOT($BA$3), NOT($BA$23), $CO31 > $BA$15), \"\", 1 + 0.5*(CO31+1))",
    "EW31": "IF(DZ31=\"\", \"\", LET(\n  Now, CT31,\n  Next, DZ31,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT31),\nFactor/Cost))",
    "EX31": "IF(EA31=\"\",\"\",(EA31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU31))",
    "EY31": "IF(EB31=\"\",\"\",(EB31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV31))",
    "EZ31": "IF(EC31=\"\",\"\",(EC31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW31))",
    "FA31": "IF(ED31=\"\",\"\",(ED31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX31))",
    "FB31": "IF(EE31=\"\",\"\",(EE31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY31))",
    "FC31": "IF(EF31=\"\",\"\",(EF31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ31))",
    "FD31": "IF(EG31=\"\",\"\",(EG31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA31))",
    "FE31": "IF(EH31=\"\",\"\",(EH31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB31))",
    "FF31": "IF(EI31=\"\",\"\",(EI31/$DX31-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC31+1, 1, CC31))))",
    "FG31": "IF(EJ31=\"\",\"\",(EJ31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD31))",
    "FH31": "IF(EK31=\"\",\"\",(EK31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE31))",
    "FI31": "IF(EL31=\"\",\"\",(EL31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF31))",
    "FJ31": "IF(EM31=\"\", \"\", LET(\n  Now, CW31,\n  Next, EM31,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG31),\nFactor/Cost))",
    "FK31": "IF(EN31=\"\",\"\",(EN31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH31))",
    "FL31": "IF(EO31=\"\", \"\", LET(\n  Now, CS31,\n  Next, EO31,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI31),\nFactor/Cost))",
    "FM31": "IF(EP31=\"\",\"\",(EP31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ31))",
    "FN31": "IF(EQ31=\"\",\"\",(EQ31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK31))",
    "FO31": "IF(ER31=\"\",\"\",(ER31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL31))",
    "FP31": "IF(ES31=\"\",\"\",(ES31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM31))",
    "FQ31": "IF(ET31=\"\",\"\",(ET31/$DX31-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN31))",
    "FR31": "IF(EU31=\"\", \"\", LET(\n  Now, CX31,\n  Next, EU31,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO31),\nFactor/Cost))",
    "FT31": "IF(COLUMN(EW31:FR31) = MIN(IF(EW31:FR31=MAX(EW31:FR31), COLUMN(EW31:FR31))), 1, \"\")",
    "D32": "IF(SUM(FT31:GP31),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F32)),\"Card Mastery\",F32),G32)/$D$5,\"\")",
    "F32": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT31:GP31),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT31:GP31=1)),)\"),\"Damage / Meter\")",
    "G32": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT31:GP31),ARRAYFORMULA(FILTER(BT31:CP31 , FT31:GP31=1)),\"\"\"\")\"),5.0)",
    "I32": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT31:GP31),ARRAYFORMULA(FILTER(EW31:FS31 , FT31:GP31=1))*D$5,\"\"\"\")\"),0.20402499845221675)",
    "K32": "IF(H32<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D32)),)",
    "AD32": "IF(EQ(AE32, 15%), \"-\", LET(\n  Next, EQ($AE$21, \"Next Tier\"),\n  Common, EQ($AE$21, \"Common\"),\n  Rare, EQ($AE$21, \"Rare\"),\n  Epic, EQ($AE$21, \"Epic\"),\n  Legendary, EQ($AE$21, \"Legendary\"),\n  Mythic, EQ($AE$21, \"Mythic\"),\n  Ancestral, EQ($AE$21, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE32=0, 2%, AE32=2%, 4%, AE32=4%, 6%, AE32=6%, 9%, AE32=9%, 12%, AE32=12%, 15%), Common, 2%, Rare, 4%, Epic, 6%, Legendary, 9%, Mythic, 12%, Ancestral, 15%), 0),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  SLQuant, $AK$37,\n  SlAngle, $AJ$37+$AE$26,\n  SlBonus, ($AI$37+Planner)*(1+$AR$31),\n  SlCoverage, MIN(100%, SLQuant*SlAngle/360),\n  PerkSL, IF(AND($BA$26,$BA$33),1.5,1),\n  StMastery, DM5,\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, Planner),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, CR$9*CR$11*$DG$5, DH5),0),\n\n  DW, $DR5,\n  SL, DQ5,\n  SM, $DT5,\n  SLM, $DU5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*DO5*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE32": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$20:$AU$25\"), MATCH(AC32,INDIRECT($C$2 & \"!$AR$20:$AR$25\"), 0)),0)",
    "AH32": "1-AH31",
    "BC32": "BC31+1",
    "BD32": "BD31+BD$3",
    "BE32": "BE31+BE$3",
    "BF32": "BF31+BF$3",
    "BG32": "BG31+BG$3",
    "BH32": "BH31+BH$3",
    "BI32": "BI31+BI$3",
    "BJ32": "BJ31+BJ$3",
    "BK32": "BK31+BK$3",
    "BL32": "BL31+BL$3",
    "BP32": "BP31+BP$3",
    "BT32": "BT31+FT31",
    "BU32": "BU31+FU31",
    "BV32": "BV31+FV31",
    "BW32": "BW31+FW31",
    "BX32": "BX31+FX31",
    "BY32": "BY31+FY31",
    "BZ32": "BZ31+FZ31",
    "CA32": "CA31+GA31",
    "CB32": "CB31+GB31",
    "CC32": "CC31+GC31",
    "CD32": "CD31+GD31",
    "CE32": "CE31+GE31",
    "CF32": "CF31+GF31",
    "CG32": "CG31+GG31",
    "CH32": "CH31+GH31",
    "CI32": "CI31+GI31",
    "CJ32": "CJ31+GJ31",
    "CK32": "CK31+GK31",
    "CL32": "CL31+GL31",
    "CM32": "CM31+GM31",
    "CN32": "CN31+GN31",
    "CO32": "CO31+GO31",
    "CS32": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI32,1)",
    "CT32": "INDEX($BD$5:$BD177,BT32)",
    "CU32": "INDEX($BN$5:$BN177,CD32)",
    "CV32": "INDEX($BO$5:$BO177,CE32)",
    "CW32": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG32)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX32": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO32, 1)",
    "CY32": "LET(\n  Base, $CR$6,\n  Damage, $CT32,\n  DamageMastery, $CS32,\n  DemonMastery, $CX32,\n  SPB, $CU32,\n  ITO, $CV32,\n  Shock, $CW32,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ32": "MIN(100%, DA32)",
    "DA32": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK32*1%, 0)",
    "DB32": "LET(\n  Lab, 1+INDEX($BF$5:$BF177,BV32),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC32": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK32*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI177,BY32) + CardCritMastery)",
    "DD32": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK32*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ177,BZ32) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE32": "LET(\n  CF, $DB32,\n  CC, $CZ32,\n  SCM, $DD32,\n  SCC, $DC32,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF32": "LET(\n  CF, $DB32,\n  CC, $DA32,\n  SCM, $DD32,\n  SCC, $DC32,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG32": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH32)), 0)",
    "DH32": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ32*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE177,BU32),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI32": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG177, BW32), 1) + $AE$9)",
    "DJ32": "LET(\n  DpmLab, INDEX($BH$5:$BH177,BX32),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL32, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK32": "(1+$DI32*$DJ32*$AQ$9)",
    "DL32": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK177,CA32),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM32*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM32": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK177,CA32),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM32*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN32": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL177,CB32)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO32": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH32,\n  Rapid, DG32,\n  RDPM, DK32,\n  SuperTower, $DL32,\n  Rend, $DN32,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP32": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ32": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK32),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR32": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP32),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF32-1))",
    "DS32": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG32, DH32),0))",
    "DT32": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP32),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV32, $AR$29), 0))",
    "DU32": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK32),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM177,CC32), $DV32, $AR$29), 0))",
    "DV32": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH32), $AO$29)",
    "DW32": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM32,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32, $DB32), 1),\n\n  DW, $DR32,\n  CL, $DS32,\n  SM, $DT32,\n  SLM, $DU32,\n  SL, $DQ32,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX32": "CY32*(DE32*DO32*DQ32+DW32*DF32)",
    "DZ32": "IF(INDEX($BD$6:$BD177,BT32)=\"\", \"\", INDEX($BD$5:$BD177,BT32+1))",
    "EA32": "IF(OR($AO$25, INDEX($BE$6:$BE177,BU32)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ32)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE177,BU32+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI32*$DJ32*$AQ$9),\n  SuperTower, $DL32,\n  Rend, $DN32,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32, $DB32), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR32,\n  SM, $DT32,\n  SLM, $DU32,\n  SL, $DQ32,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM32, UltCritCard),\n\nCY32*(DE32*OtherDamage*SL+UwDamage*DF32)))",
    "EB32": "IF(INDEX($BF$6:$BF177,BV32)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF177,BV32+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ32,\n  CCUW, $DA32,\n  SCM, $DD32,\n  SCC, $DC32,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32, CF), 1),\n\n  DW, $DR32,\n  CL, $DS32,\n  SM, $DT32,\n  SLM, $DU32,\n  SL, $DQ32,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM32, UltCritCard),\n\nCY32 * (Critical * DO32 * SL + UwDamage * UWCritical)))",
    "EC32": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG177,BW32)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH32,\n  Rapid, DG32,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG177, BW32+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ32*$AQ$9),\n  SuperTower, $DL32,\n  Rend, $DN32,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM177,CC32), $DV32, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM32,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32, $DB32), 1),\n\n  DW, $DR32,\n  CL, $DS32,\n  SM, $DT32,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY32*(DE32*OtherDamage*SL+UWDamage*DF32)))",
    "ED32": "IF(OR($AO$25, INDEX($BH$6:$BH177,BX32)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH177,BX32+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL32, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI32*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM177,CC32), $DV32, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH32,\n  Rapid, DG32,\n  SuperTower, $DL32,\n  Rend, $DN32,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM32,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32, $DB32), 1),\n\n  DW, $DR32,\n  CL, $DS32,\n  SM, $DT32,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY32*(DE32*OtherDamage*SL+UWDamage*DF32)))",
    "EE32": "IF(INDEX($BI$6:$BI177,BY32)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK32, 0),\n  CF, $DB32,\n  CC, $CZ32,\n  CCUW, $DA32,\n  SCM, $DD32,\n  SCC, $AV$17+INDEX($BI$5:$BI177,BY32+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY32 * (Critical*DO32*$DQ32+DW32*UWCritical)))",
    "EF32": "IF(INDEX($BJ$6:$BJ177,BZ32)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK32*1%, 1),\n  CF, $DB32,\n  CC, $CZ32,\n  CCUW, $DA32,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ177,BZ32+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC32,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY32*(Critical*DO32*$DQ32+DW32*UWCritical)))",
    "EG32": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK177,CA32)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH32,\n  Rapid, DG32,\n  DPM, (1+$DI32*$DJ32*$AQ$9),\n  Rend, $DN32,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK177,CA32+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM32*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32, $DB32), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK177,CA32+1)-1))/(45-CM32*3),1),\n\n  SL, $DQ32,\n  DW, $DR32,\n  CL, $DS32,\n  SM, $DT32,\n  SLM, $DU32,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY32*(DE32*OtherDamage*SL+UwDamage*DF32)))",
    "EH32": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL177,CB32+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL177,CB32)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH32,\n  Rapid, DG32,\n  DPM, (1+$DI32*$DJ32*$AQ$9),\n  SuperTower, $DL32,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL177,CB32+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY32*(DE32*OtherDamage*$DQ32+DW32*DF32)))",
    "EI32": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM177,CC32)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32, $DB32), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK32),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV32, $AR$29), 0),\n\n  DW, $DR32,\n  CL, $DS32,\n  SM, $DT32,\n  SL, $DQ32,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM32, UltCritCard),\nCY32*(DE32*DO32*SL+UwDamage*DF32)))",
    "EJ32": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN177,CD32)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT32,\n  DamageMastery, $CS32,\n  DemonMastery, $CX32,\n  SPB, INDEX($BN$5:$BN177,CD32+1),\n  ITO, $CV32,\n  Shock, $CW32,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE32*DO32*$DQ32+DW32*DF32)))",
    "EK32": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO177,CE32)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT32,\n  DamageMastery, $CS32,\n  DemonMastery, $CX32,\n  SPB, $CU32,\n  ITO, INDEX($BO$5:$BO177,CE32+1),\n  Shock, $CW32,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE32*DO32*$DQ32+DW32*DF32)))",
    "EL32": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP177,CF32)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32, $DB32), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP32),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF32),\n  CL, $DS32,\n  SM, $DT32,\n  SLM, $DU32,\n  SL, $DQ32,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM32, UltCritCard),\nCY32*(DE32*DO32*SL+UwDamage*DF32)))",
    "EM32": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ177,CG32)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG32+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN32": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR177,CH32)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32, $DB32), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH32+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP32),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK32),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM177,CC32), SMHeat, $AR$29), 0),\n\n  DW, $DR32,\n  CL, $DS32,\n  SL, $DQ32,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM32, UltCritCard),\nCY32*(DE32*DO32*SL+UwDamage*DF32)))",
    "EO32": "IF(OR(CI32 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI32+1))",
    "EP32": "IF(OR($AO$25, CJ32 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ32+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE176,BU32),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL32, 1),\n  DPM, (1+$DI32*CardRangeMastery*$DJ32*$AQ$9),\n  SuperTower, $DL32,\n  Rend, $DN32,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32, $DB32), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR32,\n  SM, $DT32,\n  SLM, $DU32,\n  SL, $DQ32,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM32, UltCritCard),\n\nCY32*(DE32*OtherDamage*SL+UwDamage*DF32)))",
    "EQ32": "IF(OR(CK32 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK32+1)*1%, 1),\n  CF, $DB32,\n  CC, MIN(100%, $CZ32 + 1%),\n  CCUW, DA32 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ177,BZ32) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC32 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR32,\n  CL, $DS32,\n  SM, $DT32,\n  SLM, $DU32,\n  SL, $DQ32,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM32, UltCritCard),\n\nCY32 * (Critical*DO32*SL+UwDamage*UWCritical)))",
    "ER32": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL32 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH177,BX32),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL32+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI32*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM177,CC32), $DV32, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH32,\n  Rapid, DG32,\n  SuperTower, $DL32,\n  Rend, $DN32,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM32,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32, $DB32), 1),\n\n  DW, $DR32,\n  CL, $DS32,\n  SM, $DT32,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY32*(DE32*OtherDamage*SL+UWDamage*DF32)))",
    "ES32": "IF(OR(CM32 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH32,\n  Rapid, DG32,\n  RDPM, (1+$DI32*$DJ32*$AQ$9),\n  Rend, $DN32,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK177,CA32),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM32+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32, $DB32), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR32,\n  CL, $DS32,\n  SM, $DT32,\n  SLM, $DU32,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY32*(DE32*OtherDamage*SL+UwDamage*DF32)))",
    "ET32": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN32 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM32,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN32+1, $DB32), 1),\n\n  DW, $DR32,\n  CL, $DS32,\n  SM, $DT32,\n  SLM, $DU32,\n  SL, $DQ32,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY32*(DE32*DO32*SL+UWDamage*DF32)))",
    "EU32": "IF(OR(NOT($BA$3), NOT($BA$23), $CO32 > $BA$15), \"\", 1 + 0.5*(CO32+1))",
    "EW32": "IF(DZ32=\"\", \"\", LET(\n  Now, CT32,\n  Next, DZ32,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT32),\nFactor/Cost))",
    "EX32": "IF(EA32=\"\",\"\",(EA32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU32))",
    "EY32": "IF(EB32=\"\",\"\",(EB32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV32))",
    "EZ32": "IF(EC32=\"\",\"\",(EC32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW32))",
    "FA32": "IF(ED32=\"\",\"\",(ED32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX32))",
    "FB32": "IF(EE32=\"\",\"\",(EE32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY32))",
    "FC32": "IF(EF32=\"\",\"\",(EF32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ32))",
    "FD32": "IF(EG32=\"\",\"\",(EG32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA32))",
    "FE32": "IF(EH32=\"\",\"\",(EH32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB32))",
    "FF32": "IF(EI32=\"\",\"\",(EI32/$DX32-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC32+1, 1, CC32))))",
    "FG32": "IF(EJ32=\"\",\"\",(EJ32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD32))",
    "FH32": "IF(EK32=\"\",\"\",(EK32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE32))",
    "FI32": "IF(EL32=\"\",\"\",(EL32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF32))",
    "FJ32": "IF(EM32=\"\", \"\", LET(\n  Now, CW32,\n  Next, EM32,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG32),\nFactor/Cost))",
    "FK32": "IF(EN32=\"\",\"\",(EN32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH32))",
    "FL32": "IF(EO32=\"\", \"\", LET(\n  Now, CS32,\n  Next, EO32,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI32),\nFactor/Cost))",
    "FM32": "IF(EP32=\"\",\"\",(EP32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ32))",
    "FN32": "IF(EQ32=\"\",\"\",(EQ32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK32))",
    "FO32": "IF(ER32=\"\",\"\",(ER32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL32))",
    "FP32": "IF(ES32=\"\",\"\",(ES32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM32))",
    "FQ32": "IF(ET32=\"\",\"\",(ET32/$DX32-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN32))",
    "FR32": "IF(EU32=\"\", \"\", LET(\n  Now, CX32,\n  Next, EU32,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO32),\nFactor/Cost))",
    "FT32": "IF(COLUMN(EW32:FR32) = MIN(IF(EW32:FR32=MAX(EW32:FR32), COLUMN(EW32:FR32))), 1, \"\")",
    "D33": "IF(SUM(FT32:GP32),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F33)),\"Card Mastery\",F33),G33)/$D$5,\"\")",
    "F33": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT32:GP32),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT32:GP32=1)),)\"),\"Critical Factor\")",
    "G33": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT32:GP32),ARRAYFORMULA(FILTER(BT32:CP32 , FT32:GP32=1)),\"\"\"\")\"),9.0)",
    "I33": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT32:GP32),ARRAYFORMULA(FILTER(EW32:FS32 , FT32:GP32=1))*D$5,\"\"\"\")\"),0.1649834196557041)",
    "K33": "IF(H33<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D33)),)",
    "AF33": "Images!D4",
    "AH33": "'Master Sheet'!S12",
    "AI33": "'Master Sheet'!V10",
    "AJ33": "'Master Sheet'!V11",
    "AK33": "'Master Sheet'!V12",
    "AL33": "'Master Sheet'!V13",
    "BC33": "BC32+1",
    "BD33": "BD32+BD$3",
    "BE33": "BE32+BE$3",
    "BF33": "BF32+BF$3",
    "BG33": "BG32+BG$3",
    "BH33": "BH32+BH$3",
    "BI33": "BI32+BI$3",
    "BJ33": "BJ32+BJ$3",
    "BK33": "BK32+BK$3",
    "BL33": "BL32+BL$3",
    "BP33": "BP32+BP$3",
    "BT33": "BT32+FT32",
    "BU33": "BU32+FU32",
    "BV33": "BV32+FV32",
    "BW33": "BW32+FW32",
    "BX33": "BX32+FX32",
    "BY33": "BY32+FY32",
    "BZ33": "BZ32+FZ32",
    "CA33": "CA32+GA32",
    "CB33": "CB32+GB32",
    "CC33": "CC32+GC32",
    "CD33": "CD32+GD32",
    "CE33": "CE32+GE32",
    "CF33": "CF32+GF32",
    "CG33": "CG32+GG32",
    "CH33": "CH32+GH32",
    "CI33": "CI32+GI32",
    "CJ33": "CJ32+GJ32",
    "CK33": "CK32+GK32",
    "CL33": "CL32+GL32",
    "CM33": "CM32+GM32",
    "CN33": "CN32+GN32",
    "CO33": "CO32+GO32",
    "CS33": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI33,1)",
    "CT33": "INDEX($BD$5:$BD178,BT33)",
    "CU33": "INDEX($BN$5:$BN178,CD33)",
    "CV33": "INDEX($BO$5:$BO178,CE33)",
    "CW33": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG33)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX33": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO33, 1)",
    "CY33": "LET(\n  Base, $CR$6,\n  Damage, $CT33,\n  DamageMastery, $CS33,\n  DemonMastery, $CX33,\n  SPB, $CU33,\n  ITO, $CV33,\n  Shock, $CW33,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ33": "MIN(100%, DA33)",
    "DA33": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK33*1%, 0)",
    "DB33": "LET(\n  Lab, 1+INDEX($BF$5:$BF178,BV33),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC33": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK33*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI178,BY33) + CardCritMastery)",
    "DD33": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK33*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ178,BZ33) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE33": "LET(\n  CF, $DB33,\n  CC, $CZ33,\n  SCM, $DD33,\n  SCC, $DC33,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF33": "LET(\n  CF, $DB33,\n  CC, $DA33,\n  SCM, $DD33,\n  SCC, $DC33,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG33": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH33)), 0)",
    "DH33": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ33*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE178,BU33),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI33": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG178, BW33), 1) + $AE$9)",
    "DJ33": "LET(\n  DpmLab, INDEX($BH$5:$BH178,BX33),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL33, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK33": "(1+$DI33*$DJ33*$AQ$9)",
    "DL33": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK178,CA33),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM33*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM33": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK178,CA33),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM33*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN33": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL178,CB33)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO33": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH33,\n  Rapid, DG33,\n  RDPM, DK33,\n  SuperTower, $DL33,\n  Rend, $DN33,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP33": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ33": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK33),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR33": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP33),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF33-1))",
    "DS33": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG33, DH33),0))",
    "DT33": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP33),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV33, $AR$29), 0))",
    "DU33": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK33),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM178,CC33), $DV33, $AR$29), 0))",
    "DV33": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH33), $AO$29)",
    "DW33": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM33,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33, $DB33), 1),\n\n  DW, $DR33,\n  CL, $DS33,\n  SM, $DT33,\n  SLM, $DU33,\n  SL, $DQ33,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX33": "CY33*(DE33*DO33*DQ33+DW33*DF33)",
    "DZ33": "IF(INDEX($BD$6:$BD178,BT33)=\"\", \"\", INDEX($BD$5:$BD178,BT33+1))",
    "EA33": "IF(OR($AO$25, INDEX($BE$6:$BE178,BU33)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ33)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE178,BU33+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI33*$DJ33*$AQ$9),\n  SuperTower, $DL33,\n  Rend, $DN33,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33, $DB33), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR33,\n  SM, $DT33,\n  SLM, $DU33,\n  SL, $DQ33,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM33, UltCritCard),\n\nCY33*(DE33*OtherDamage*SL+UwDamage*DF33)))",
    "EB33": "IF(INDEX($BF$6:$BF178,BV33)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF178,BV33+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ33,\n  CCUW, $DA33,\n  SCM, $DD33,\n  SCC, $DC33,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33, CF), 1),\n\n  DW, $DR33,\n  CL, $DS33,\n  SM, $DT33,\n  SLM, $DU33,\n  SL, $DQ33,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM33, UltCritCard),\n\nCY33 * (Critical * DO33 * SL + UwDamage * UWCritical)))",
    "EC33": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG178,BW33)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH33,\n  Rapid, DG33,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG178, BW33+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ33*$AQ$9),\n  SuperTower, $DL33,\n  Rend, $DN33,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM178,CC33), $DV33, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM33,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33, $DB33), 1),\n\n  DW, $DR33,\n  CL, $DS33,\n  SM, $DT33,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY33*(DE33*OtherDamage*SL+UWDamage*DF33)))",
    "ED33": "IF(OR($AO$25, INDEX($BH$6:$BH178,BX33)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH178,BX33+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL33, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI33*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM178,CC33), $DV33, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH33,\n  Rapid, DG33,\n  SuperTower, $DL33,\n  Rend, $DN33,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM33,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33, $DB33), 1),\n\n  DW, $DR33,\n  CL, $DS33,\n  SM, $DT33,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY33*(DE33*OtherDamage*SL+UWDamage*DF33)))",
    "EE33": "IF(INDEX($BI$6:$BI178,BY33)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK33, 0),\n  CF, $DB33,\n  CC, $CZ33,\n  CCUW, $DA33,\n  SCM, $DD33,\n  SCC, $AV$17+INDEX($BI$5:$BI178,BY33+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY33 * (Critical*DO33*$DQ33+DW33*UWCritical)))",
    "EF33": "IF(INDEX($BJ$6:$BJ178,BZ33)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK33*1%, 1),\n  CF, $DB33,\n  CC, $CZ33,\n  CCUW, $DA33,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ178,BZ33+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC33,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY33*(Critical*DO33*$DQ33+DW33*UWCritical)))",
    "EG33": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK178,CA33)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH33,\n  Rapid, DG33,\n  DPM, (1+$DI33*$DJ33*$AQ$9),\n  Rend, $DN33,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK178,CA33+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM33*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33, $DB33), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK178,CA33+1)-1))/(45-CM33*3),1),\n\n  SL, $DQ33,\n  DW, $DR33,\n  CL, $DS33,\n  SM, $DT33,\n  SLM, $DU33,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY33*(DE33*OtherDamage*SL+UwDamage*DF33)))",
    "EH33": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL178,CB33+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL178,CB33)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH33,\n  Rapid, DG33,\n  DPM, (1+$DI33*$DJ33*$AQ$9),\n  SuperTower, $DL33,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL178,CB33+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY33*(DE33*OtherDamage*$DQ33+DW33*DF33)))",
    "EI33": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM178,CC33)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33, $DB33), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK33),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV33, $AR$29), 0),\n\n  DW, $DR33,\n  CL, $DS33,\n  SM, $DT33,\n  SL, $DQ33,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM33, UltCritCard),\nCY33*(DE33*DO33*SL+UwDamage*DF33)))",
    "EJ33": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN178,CD33)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT33,\n  DamageMastery, $CS33,\n  DemonMastery, $CX33,\n  SPB, INDEX($BN$5:$BN178,CD33+1),\n  ITO, $CV33,\n  Shock, $CW33,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE33*DO33*$DQ33+DW33*DF33)))",
    "EK33": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO178,CE33)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT33,\n  DamageMastery, $CS33,\n  DemonMastery, $CX33,\n  SPB, $CU33,\n  ITO, INDEX($BO$5:$BO178,CE33+1),\n  Shock, $CW33,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE33*DO33*$DQ33+DW33*DF33)))",
    "EL33": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP178,CF33)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33, $DB33), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP33),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF33),\n  CL, $DS33,\n  SM, $DT33,\n  SLM, $DU33,\n  SL, $DQ33,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM33, UltCritCard),\nCY33*(DE33*DO33*SL+UwDamage*DF33)))",
    "EM33": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ178,CG33)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG33+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN33": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR178,CH33)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33, $DB33), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH33+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP33),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK33),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM178,CC33), SMHeat, $AR$29), 0),\n\n  DW, $DR33,\n  CL, $DS33,\n  SL, $DQ33,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM33, UltCritCard),\nCY33*(DE33*DO33*SL+UwDamage*DF33)))",
    "EO33": "IF(OR(CI33 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI33+1))",
    "EP33": "IF(OR($AO$25, CJ33 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ33+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE177,BU33),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL33, 1),\n  DPM, (1+$DI33*CardRangeMastery*$DJ33*$AQ$9),\n  SuperTower, $DL33,\n  Rend, $DN33,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33, $DB33), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR33,\n  SM, $DT33,\n  SLM, $DU33,\n  SL, $DQ33,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM33, UltCritCard),\n\nCY33*(DE33*OtherDamage*SL+UwDamage*DF33)))",
    "EQ33": "IF(OR(CK33 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK33+1)*1%, 1),\n  CF, $DB33,\n  CC, MIN(100%, $CZ33 + 1%),\n  CCUW, DA33 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ178,BZ33) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC33 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR33,\n  CL, $DS33,\n  SM, $DT33,\n  SLM, $DU33,\n  SL, $DQ33,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM33, UltCritCard),\n\nCY33 * (Critical*DO33*SL+UwDamage*UWCritical)))",
    "ER33": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL33 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH178,BX33),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL33+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI33*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM178,CC33), $DV33, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH33,\n  Rapid, DG33,\n  SuperTower, $DL33,\n  Rend, $DN33,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM33,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33, $DB33), 1),\n\n  DW, $DR33,\n  CL, $DS33,\n  SM, $DT33,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY33*(DE33*OtherDamage*SL+UWDamage*DF33)))",
    "ES33": "IF(OR(CM33 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH33,\n  Rapid, DG33,\n  RDPM, (1+$DI33*$DJ33*$AQ$9),\n  Rend, $DN33,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK178,CA33),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM33+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33, $DB33), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR33,\n  CL, $DS33,\n  SM, $DT33,\n  SLM, $DU33,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY33*(DE33*OtherDamage*SL+UwDamage*DF33)))",
    "ET33": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN33 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM33,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN33+1, $DB33), 1),\n\n  DW, $DR33,\n  CL, $DS33,\n  SM, $DT33,\n  SLM, $DU33,\n  SL, $DQ33,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY33*(DE33*DO33*SL+UWDamage*DF33)))",
    "EU33": "IF(OR(NOT($BA$3), NOT($BA$23), $CO33 > $BA$15), \"\", 1 + 0.5*(CO33+1))",
    "EW33": "IF(DZ33=\"\", \"\", LET(\n  Now, CT33,\n  Next, DZ33,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT33),\nFactor/Cost))",
    "EX33": "IF(EA33=\"\",\"\",(EA33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU33))",
    "EY33": "IF(EB33=\"\",\"\",(EB33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV33))",
    "EZ33": "IF(EC33=\"\",\"\",(EC33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW33))",
    "FA33": "IF(ED33=\"\",\"\",(ED33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX33))",
    "FB33": "IF(EE33=\"\",\"\",(EE33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY33))",
    "FC33": "IF(EF33=\"\",\"\",(EF33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ33))",
    "FD33": "IF(EG33=\"\",\"\",(EG33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA33))",
    "FE33": "IF(EH33=\"\",\"\",(EH33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB33))",
    "FF33": "IF(EI33=\"\",\"\",(EI33/$DX33-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC33+1, 1, CC33))))",
    "FG33": "IF(EJ33=\"\",\"\",(EJ33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD33))",
    "FH33": "IF(EK33=\"\",\"\",(EK33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE33))",
    "FI33": "IF(EL33=\"\",\"\",(EL33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF33))",
    "FJ33": "IF(EM33=\"\", \"\", LET(\n  Now, CW33,\n  Next, EM33,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG33),\nFactor/Cost))",
    "FK33": "IF(EN33=\"\",\"\",(EN33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH33))",
    "FL33": "IF(EO33=\"\", \"\", LET(\n  Now, CS33,\n  Next, EO33,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI33),\nFactor/Cost))",
    "FM33": "IF(EP33=\"\",\"\",(EP33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ33))",
    "FN33": "IF(EQ33=\"\",\"\",(EQ33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK33))",
    "FO33": "IF(ER33=\"\",\"\",(ER33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL33))",
    "FP33": "IF(ES33=\"\",\"\",(ES33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM33))",
    "FQ33": "IF(ET33=\"\",\"\",(ET33/$DX33-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN33))",
    "FR33": "IF(EU33=\"\", \"\", LET(\n  Now, CX33,\n  Next, EU33,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO33),\nFactor/Cost))",
    "FT33": "IF(COLUMN(EW33:FR33) = MIN(IF(EW33:FR33=MAX(EW33:FR33), COLUMN(EW33:FR33))), 1, \"\")",
    "D34": "IF(SUM(FT33:GP33),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F34)),\"Card Mastery\",F34),G34)/$D$5,\"\")",
    "F34": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT33:GP33),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT33:GP33=1)),)\"),\"Attack Speed\")",
    "G34": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT33:GP33),ARRAYFORMULA(FILTER(BT33:CP33 , FT33:GP33=1)),\"\"\"\")\"),8.0)",
    "I34": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT33:GP33),ARRAYFORMULA(FILTER(EW33:FS33 , FT33:GP33=1))*D$5,\"\"\"\")\"),0.15975681995734475)",
    "K34": "IF(H34<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D34)),)",
    "AF34": "Images!D3",
    "AH34": "'Master Sheet'!S4",
    "AI34": "'Master Sheet'!V2",
    "AJ34": "'Master Sheet'!V3",
    "AK34": "'Master Sheet'!V4",
    "BC34": "BC33+1",
    "BD34": "BD33+BD$3",
    "BE34": "BE33+BE$3",
    "BF34": "BF33+BF$3",
    "BG34": "BG33+BG$3",
    "BH34": "BH33+BH$3",
    "BI34": "BI33+BI$3",
    "BJ34": "BJ33+BJ$3",
    "BK34": "BK33+BK$3",
    "BL34": "BL33+BL$3",
    "BP34": "BP33+BP$3",
    "BT34": "BT33+FT33",
    "BU34": "BU33+FU33",
    "BV34": "BV33+FV33",
    "BW34": "BW33+FW33",
    "BX34": "BX33+FX33",
    "BY34": "BY33+FY33",
    "BZ34": "BZ33+FZ33",
    "CA34": "CA33+GA33",
    "CB34": "CB33+GB33",
    "CC34": "CC33+GC33",
    "CD34": "CD33+GD33",
    "CE34": "CE33+GE33",
    "CF34": "CF33+GF33",
    "CG34": "CG33+GG33",
    "CH34": "CH33+GH33",
    "CI34": "CI33+GI33",
    "CJ34": "CJ33+GJ33",
    "CK34": "CK33+GK33",
    "CL34": "CL33+GL33",
    "CM34": "CM33+GM33",
    "CN34": "CN33+GN33",
    "CO34": "CO33+GO33",
    "CS34": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI34,1)",
    "CT34": "INDEX($BD$5:$BD179,BT34)",
    "CU34": "INDEX($BN$5:$BN179,CD34)",
    "CV34": "INDEX($BO$5:$BO179,CE34)",
    "CW34": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG34)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX34": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO34, 1)",
    "CY34": "LET(\n  Base, $CR$6,\n  Damage, $CT34,\n  DamageMastery, $CS34,\n  DemonMastery, $CX34,\n  SPB, $CU34,\n  ITO, $CV34,\n  Shock, $CW34,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ34": "MIN(100%, DA34)",
    "DA34": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK34*1%, 0)",
    "DB34": "LET(\n  Lab, 1+INDEX($BF$5:$BF179,BV34),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC34": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK34*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI179,BY34) + CardCritMastery)",
    "DD34": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK34*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ179,BZ34) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE34": "LET(\n  CF, $DB34,\n  CC, $CZ34,\n  SCM, $DD34,\n  SCC, $DC34,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF34": "LET(\n  CF, $DB34,\n  CC, $DA34,\n  SCM, $DD34,\n  SCC, $DC34,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG34": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH34)), 0)",
    "DH34": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ34*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE179,BU34),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI34": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG179, BW34), 1) + $AE$9)",
    "DJ34": "LET(\n  DpmLab, INDEX($BH$5:$BH179,BX34),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL34, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK34": "(1+$DI34*$DJ34*$AQ$9)",
    "DL34": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK179,CA34),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM34*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM34": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK179,CA34),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM34*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN34": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL179,CB34)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO34": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH34,\n  Rapid, DG34,\n  RDPM, DK34,\n  SuperTower, $DL34,\n  Rend, $DN34,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP34": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ34": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK34),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR34": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP34),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF34-1))",
    "DS34": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG34, DH34),0))",
    "DT34": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP34),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV34, $AR$29), 0))",
    "DU34": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK34),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM179,CC34), $DV34, $AR$29), 0))",
    "DV34": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH34), $AO$29)",
    "DW34": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM34,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34, $DB34), 1),\n\n  DW, $DR34,\n  CL, $DS34,\n  SM, $DT34,\n  SLM, $DU34,\n  SL, $DQ34,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX34": "CY34*(DE34*DO34*DQ34+DW34*DF34)",
    "DZ34": "IF(INDEX($BD$6:$BD179,BT34)=\"\", \"\", INDEX($BD$5:$BD179,BT34+1))",
    "EA34": "IF(OR($AO$25, INDEX($BE$6:$BE179,BU34)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ34)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE179,BU34+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI34*$DJ34*$AQ$9),\n  SuperTower, $DL34,\n  Rend, $DN34,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34, $DB34), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR34,\n  SM, $DT34,\n  SLM, $DU34,\n  SL, $DQ34,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM34, UltCritCard),\n\nCY34*(DE34*OtherDamage*SL+UwDamage*DF34)))",
    "EB34": "IF(INDEX($BF$6:$BF179,BV34)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF179,BV34+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ34,\n  CCUW, $DA34,\n  SCM, $DD34,\n  SCC, $DC34,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34, CF), 1),\n\n  DW, $DR34,\n  CL, $DS34,\n  SM, $DT34,\n  SLM, $DU34,\n  SL, $DQ34,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM34, UltCritCard),\n\nCY34 * (Critical * DO34 * SL + UwDamage * UWCritical)))",
    "EC34": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG179,BW34)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH34,\n  Rapid, DG34,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG179, BW34+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ34*$AQ$9),\n  SuperTower, $DL34,\n  Rend, $DN34,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM179,CC34), $DV34, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM34,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34, $DB34), 1),\n\n  DW, $DR34,\n  CL, $DS34,\n  SM, $DT34,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY34*(DE34*OtherDamage*SL+UWDamage*DF34)))",
    "ED34": "IF(OR($AO$25, INDEX($BH$6:$BH179,BX34)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH179,BX34+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL34, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI34*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM179,CC34), $DV34, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH34,\n  Rapid, DG34,\n  SuperTower, $DL34,\n  Rend, $DN34,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM34,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34, $DB34), 1),\n\n  DW, $DR34,\n  CL, $DS34,\n  SM, $DT34,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY34*(DE34*OtherDamage*SL+UWDamage*DF34)))",
    "EE34": "IF(INDEX($BI$6:$BI179,BY34)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK34, 0),\n  CF, $DB34,\n  CC, $CZ34,\n  CCUW, $DA34,\n  SCM, $DD34,\n  SCC, $AV$17+INDEX($BI$5:$BI179,BY34+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY34 * (Critical*DO34*$DQ34+DW34*UWCritical)))",
    "EF34": "IF(INDEX($BJ$6:$BJ179,BZ34)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK34*1%, 1),\n  CF, $DB34,\n  CC, $CZ34,\n  CCUW, $DA34,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ179,BZ34+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC34,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY34*(Critical*DO34*$DQ34+DW34*UWCritical)))",
    "EG34": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK179,CA34)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH34,\n  Rapid, DG34,\n  DPM, (1+$DI34*$DJ34*$AQ$9),\n  Rend, $DN34,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK179,CA34+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM34*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34, $DB34), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK179,CA34+1)-1))/(45-CM34*3),1),\n\n  SL, $DQ34,\n  DW, $DR34,\n  CL, $DS34,\n  SM, $DT34,\n  SLM, $DU34,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY34*(DE34*OtherDamage*SL+UwDamage*DF34)))",
    "EH34": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL179,CB34+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL179,CB34)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH34,\n  Rapid, DG34,\n  DPM, (1+$DI34*$DJ34*$AQ$9),\n  SuperTower, $DL34,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL179,CB34+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY34*(DE34*OtherDamage*$DQ34+DW34*DF34)))",
    "EI34": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM179,CC34)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34, $DB34), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK34),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV34, $AR$29), 0),\n\n  DW, $DR34,\n  CL, $DS34,\n  SM, $DT34,\n  SL, $DQ34,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM34, UltCritCard),\nCY34*(DE34*DO34*SL+UwDamage*DF34)))",
    "EJ34": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN179,CD34)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT34,\n  DamageMastery, $CS34,\n  DemonMastery, $CX34,\n  SPB, INDEX($BN$5:$BN179,CD34+1),\n  ITO, $CV34,\n  Shock, $CW34,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE34*DO34*$DQ34+DW34*DF34)))",
    "EK34": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO179,CE34)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT34,\n  DamageMastery, $CS34,\n  DemonMastery, $CX34,\n  SPB, $CU34,\n  ITO, INDEX($BO$5:$BO179,CE34+1),\n  Shock, $CW34,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE34*DO34*$DQ34+DW34*DF34)))",
    "EL34": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP179,CF34)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34, $DB34), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP34),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF34),\n  CL, $DS34,\n  SM, $DT34,\n  SLM, $DU34,\n  SL, $DQ34,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM34, UltCritCard),\nCY34*(DE34*DO34*SL+UwDamage*DF34)))",
    "EM34": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ179,CG34)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG34+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN34": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR179,CH34)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34, $DB34), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH34+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP34),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK34),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM179,CC34), SMHeat, $AR$29), 0),\n\n  DW, $DR34,\n  CL, $DS34,\n  SL, $DQ34,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM34, UltCritCard),\nCY34*(DE34*DO34*SL+UwDamage*DF34)))",
    "EO34": "IF(OR(CI34 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI34+1))",
    "EP34": "IF(OR($AO$25, CJ34 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ34+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE178,BU34),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL34, 1),\n  DPM, (1+$DI34*CardRangeMastery*$DJ34*$AQ$9),\n  SuperTower, $DL34,\n  Rend, $DN34,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34, $DB34), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR34,\n  SM, $DT34,\n  SLM, $DU34,\n  SL, $DQ34,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM34, UltCritCard),\n\nCY34*(DE34*OtherDamage*SL+UwDamage*DF34)))",
    "EQ34": "IF(OR(CK34 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK34+1)*1%, 1),\n  CF, $DB34,\n  CC, MIN(100%, $CZ34 + 1%),\n  CCUW, DA34 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ179,BZ34) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC34 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR34,\n  CL, $DS34,\n  SM, $DT34,\n  SLM, $DU34,\n  SL, $DQ34,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM34, UltCritCard),\n\nCY34 * (Critical*DO34*SL+UwDamage*UWCritical)))",
    "ER34": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL34 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH179,BX34),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL34+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI34*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM179,CC34), $DV34, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH34,\n  Rapid, DG34,\n  SuperTower, $DL34,\n  Rend, $DN34,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM34,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34, $DB34), 1),\n\n  DW, $DR34,\n  CL, $DS34,\n  SM, $DT34,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY34*(DE34*OtherDamage*SL+UWDamage*DF34)))",
    "ES34": "IF(OR(CM34 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH34,\n  Rapid, DG34,\n  RDPM, (1+$DI34*$DJ34*$AQ$9),\n  Rend, $DN34,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK179,CA34),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM34+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34, $DB34), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR34,\n  CL, $DS34,\n  SM, $DT34,\n  SLM, $DU34,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY34*(DE34*OtherDamage*SL+UwDamage*DF34)))",
    "ET34": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN34 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM34,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN34+1, $DB34), 1),\n\n  DW, $DR34,\n  CL, $DS34,\n  SM, $DT34,\n  SLM, $DU34,\n  SL, $DQ34,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY34*(DE34*DO34*SL+UWDamage*DF34)))",
    "EU34": "IF(OR(NOT($BA$3), NOT($BA$23), $CO34 > $BA$15), \"\", 1 + 0.5*(CO34+1))",
    "EW34": "IF(DZ34=\"\", \"\", LET(\n  Now, CT34,\n  Next, DZ34,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT34),\nFactor/Cost))",
    "EX34": "IF(EA34=\"\",\"\",(EA34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU34))",
    "EY34": "IF(EB34=\"\",\"\",(EB34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV34))",
    "EZ34": "IF(EC34=\"\",\"\",(EC34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW34))",
    "FA34": "IF(ED34=\"\",\"\",(ED34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX34))",
    "FB34": "IF(EE34=\"\",\"\",(EE34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY34))",
    "FC34": "IF(EF34=\"\",\"\",(EF34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ34))",
    "FD34": "IF(EG34=\"\",\"\",(EG34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA34))",
    "FE34": "IF(EH34=\"\",\"\",(EH34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB34))",
    "FF34": "IF(EI34=\"\",\"\",(EI34/$DX34-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC34+1, 1, CC34))))",
    "FG34": "IF(EJ34=\"\",\"\",(EJ34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD34))",
    "FH34": "IF(EK34=\"\",\"\",(EK34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE34))",
    "FI34": "IF(EL34=\"\",\"\",(EL34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF34))",
    "FJ34": "IF(EM34=\"\", \"\", LET(\n  Now, CW34,\n  Next, EM34,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG34),\nFactor/Cost))",
    "FK34": "IF(EN34=\"\",\"\",(EN34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH34))",
    "FL34": "IF(EO34=\"\", \"\", LET(\n  Now, CS34,\n  Next, EO34,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI34),\nFactor/Cost))",
    "FM34": "IF(EP34=\"\",\"\",(EP34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ34))",
    "FN34": "IF(EQ34=\"\",\"\",(EQ34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK34))",
    "FO34": "IF(ER34=\"\",\"\",(ER34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL34))",
    "FP34": "IF(ES34=\"\",\"\",(ES34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM34))",
    "FQ34": "IF(ET34=\"\",\"\",(ET34/$DX34-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN34))",
    "FR34": "IF(EU34=\"\", \"\", LET(\n  Now, CX34,\n  Next, EU34,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO34),\nFactor/Cost))",
    "FT34": "IF(COLUMN(EW34:FR34) = MIN(IF(EW34:FR34=MAX(EW34:FR34), COLUMN(EW34:FR34))), 1, \"\")",
    "D35": "IF(SUM(FT34:GP34),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F35)),\"Card Mastery\",F35),G35)/$D$5,\"\")",
    "F35": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT34:GP34),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT34:GP34=1)),)\"),\"Damage\")",
    "G35": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT34:GP34),ARRAYFORMULA(FILTER(BT34:CP34 , FT34:GP34=1)),\"\"\"\")\"),8.0)",
    "I35": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT34:GP34),ARRAYFORMULA(FILTER(EW34:FS34 , FT34:GP34=1))*D$5,\"\"\"\")\"),0.15888778550149008)",
    "K35": "IF(D26,FORMAT_TIME_YEAR(SUM($D$6:$D35)),)",
    "AE35": "IFERROR(__xludf.DUMMYFUNCTION(\"LET(\n  ModName, INDIRECT($C$2 & \"\"!AQ16\"\"),\n  ModRarity, INDIRECT($C$2 & \"\"!AQ17\"\"),\n  IF(ModName = AC35, \n    IFS(\n      REGEXMATCH(ModRarity, \"\"Epic\"\"), -10, \n      REGEXMATCH(ModRarity, \"\"Legendary\"\"), -13, \n      REGEXMATCH(ModRarity, \"\"Mythic\"\"), -17\"&\", \n      REGEXMATCH(ModRarity, \"\"Ancestral\"\"), -20,\n      TRUE, 0\n    ),\n  0)\n)\n\"),0.0)",
    "AF35": "Images!E5",
    "AH35": "'Master Sheet'!S8",
    "AI35": "'Master Sheet'!V6",
    "AJ35": "'Master Sheet'!V7",
    "AK35": "'Master Sheet'!V8",
    "AL35": "'Master Sheet'!V9",
    "BC35": "BC34+1",
    "BD35": "BD34+BD$3",
    "BE35": "BE34+BE$3",
    "BF35": "BF34+BF$3",
    "BG35": "BG34+BG$3",
    "BH35": "BH34+BH$3",
    "BI35": "BI34+BI$3",
    "BJ35": "BJ34+BJ$3",
    "BK35": "BK34+BK$3",
    "BL35": "BL34+BL$3",
    "BP35": "BP34+BP$3",
    "BT35": "BT34+FT34",
    "BU35": "BU34+FU34",
    "BV35": "BV34+FV34",
    "BW35": "BW34+FW34",
    "BX35": "BX34+FX34",
    "BY35": "BY34+FY34",
    "BZ35": "BZ34+FZ34",
    "CA35": "CA34+GA34",
    "CB35": "CB34+GB34",
    "CC35": "CC34+GC34",
    "CD35": "CD34+GD34",
    "CE35": "CE34+GE34",
    "CF35": "CF34+GF34",
    "CG35": "CG34+GG34",
    "CH35": "CH34+GH34",
    "CI35": "CI34+GI34",
    "CJ35": "CJ34+GJ34",
    "CK35": "CK34+GK34",
    "CL35": "CL34+GL34",
    "CM35": "CM34+GM34",
    "CN35": "CN34+GN34",
    "CO35": "CO34+GO34",
    "CS35": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI35,1)",
    "CT35": "INDEX($BD$5:$BD180,BT35)",
    "CU35": "INDEX($BN$5:$BN180,CD35)",
    "CV35": "INDEX($BO$5:$BO180,CE35)",
    "CW35": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG35)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX35": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO35, 1)",
    "CY35": "LET(\n  Base, $CR$6,\n  Damage, $CT35,\n  DamageMastery, $CS35,\n  DemonMastery, $CX35,\n  SPB, $CU35,\n  ITO, $CV35,\n  Shock, $CW35,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ35": "MIN(100%, DA35)",
    "DA35": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK35*1%, 0)",
    "DB35": "LET(\n  Lab, 1+INDEX($BF$5:$BF180,BV35),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC35": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK35*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI180,BY35) + CardCritMastery)",
    "DD35": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK35*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ180,BZ35) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE35": "LET(\n  CF, $DB35,\n  CC, $CZ35,\n  SCM, $DD35,\n  SCC, $DC35,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF35": "LET(\n  CF, $DB35,\n  CC, $DA35,\n  SCM, $DD35,\n  SCC, $DC35,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG35": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH35)), 0)",
    "DH35": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ35*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE180,BU35),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI35": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG180, BW35), 1) + $AE$9)",
    "DJ35": "LET(\n  DpmLab, INDEX($BH$5:$BH180,BX35),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL35, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK35": "(1+$DI35*$DJ35*$AQ$9)",
    "DL35": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK180,CA35),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM35*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM35": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK180,CA35),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM35*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN35": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL180,CB35)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO35": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH35,\n  Rapid, DG35,\n  RDPM, DK35,\n  SuperTower, $DL35,\n  Rend, $DN35,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP35": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ35": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK35),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR35": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP35),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF35-1))",
    "DS35": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG35, DH35),0))",
    "DT35": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP35),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV35, $AR$29), 0))",
    "DU35": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK35),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM180,CC35), $DV35, $AR$29), 0))",
    "DV35": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH35), $AO$29)",
    "DW35": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM35,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35, $DB35), 1),\n\n  DW, $DR35,\n  CL, $DS35,\n  SM, $DT35,\n  SLM, $DU35,\n  SL, $DQ35,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX35": "CY35*(DE35*DO35*DQ35+DW35*DF35)",
    "DZ35": "IF(INDEX($BD$6:$BD180,BT35)=\"\", \"\", INDEX($BD$5:$BD180,BT35+1))",
    "EA35": "IF(OR($AO$25, INDEX($BE$6:$BE180,BU35)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ35)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE180,BU35+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI35*$DJ35*$AQ$9),\n  SuperTower, $DL35,\n  Rend, $DN35,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35, $DB35), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR35,\n  SM, $DT35,\n  SLM, $DU35,\n  SL, $DQ35,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM35, UltCritCard),\n\nCY35*(DE35*OtherDamage*SL+UwDamage*DF35)))",
    "EB35": "IF(INDEX($BF$6:$BF180,BV35)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF180,BV35+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ35,\n  CCUW, $DA35,\n  SCM, $DD35,\n  SCC, $DC35,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35, CF), 1),\n\n  DW, $DR35,\n  CL, $DS35,\n  SM, $DT35,\n  SLM, $DU35,\n  SL, $DQ35,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM35, UltCritCard),\n\nCY35 * (Critical * DO35 * SL + UwDamage * UWCritical)))",
    "EC35": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG180,BW35)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH35,\n  Rapid, DG35,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG180, BW35+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ35*$AQ$9),\n  SuperTower, $DL35,\n  Rend, $DN35,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM180,CC35), $DV35, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM35,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35, $DB35), 1),\n\n  DW, $DR35,\n  CL, $DS35,\n  SM, $DT35,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY35*(DE35*OtherDamage*SL+UWDamage*DF35)))",
    "ED35": "IF(OR($AO$25, INDEX($BH$6:$BH180,BX35)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH180,BX35+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL35, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI35*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM180,CC35), $DV35, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH35,\n  Rapid, DG35,\n  SuperTower, $DL35,\n  Rend, $DN35,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM35,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35, $DB35), 1),\n\n  DW, $DR35,\n  CL, $DS35,\n  SM, $DT35,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY35*(DE35*OtherDamage*SL+UWDamage*DF35)))",
    "EE35": "IF(INDEX($BI$6:$BI180,BY35)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK35, 0),\n  CF, $DB35,\n  CC, $CZ35,\n  CCUW, $DA35,\n  SCM, $DD35,\n  SCC, $AV$17+INDEX($BI$5:$BI180,BY35+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY35 * (Critical*DO35*$DQ35+DW35*UWCritical)))",
    "EF35": "IF(INDEX($BJ$6:$BJ180,BZ35)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK35*1%, 1),\n  CF, $DB35,\n  CC, $CZ35,\n  CCUW, $DA35,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ180,BZ35+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC35,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY35*(Critical*DO35*$DQ35+DW35*UWCritical)))",
    "EG35": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK180,CA35)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH35,\n  Rapid, DG35,\n  DPM, (1+$DI35*$DJ35*$AQ$9),\n  Rend, $DN35,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK180,CA35+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM35*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35, $DB35), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK180,CA35+1)-1))/(45-CM35*3),1),\n\n  SL, $DQ35,\n  DW, $DR35,\n  CL, $DS35,\n  SM, $DT35,\n  SLM, $DU35,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY35*(DE35*OtherDamage*SL+UwDamage*DF35)))",
    "EH35": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL180,CB35+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL180,CB35)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH35,\n  Rapid, DG35,\n  DPM, (1+$DI35*$DJ35*$AQ$9),\n  SuperTower, $DL35,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL180,CB35+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY35*(DE35*OtherDamage*$DQ35+DW35*DF35)))",
    "EI35": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM180,CC35)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35, $DB35), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK35),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV35, $AR$29), 0),\n\n  DW, $DR35,\n  CL, $DS35,\n  SM, $DT35,\n  SL, $DQ35,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM35, UltCritCard),\nCY35*(DE35*DO35*SL+UwDamage*DF35)))",
    "EJ35": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN180,CD35)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT35,\n  DamageMastery, $CS35,\n  DemonMastery, $CX35,\n  SPB, INDEX($BN$5:$BN180,CD35+1),\n  ITO, $CV35,\n  Shock, $CW35,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE35*DO35*$DQ35+DW35*DF35)))",
    "EK35": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO180,CE35)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT35,\n  DamageMastery, $CS35,\n  DemonMastery, $CX35,\n  SPB, $CU35,\n  ITO, INDEX($BO$5:$BO180,CE35+1),\n  Shock, $CW35,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE35*DO35*$DQ35+DW35*DF35)))",
    "EL35": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP180,CF35)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35, $DB35), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP35),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF35),\n  CL, $DS35,\n  SM, $DT35,\n  SLM, $DU35,\n  SL, $DQ35,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM35, UltCritCard),\nCY35*(DE35*DO35*SL+UwDamage*DF35)))",
    "EM35": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ180,CG35)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG35+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN35": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR180,CH35)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35, $DB35), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH35+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP35),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK35),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM180,CC35), SMHeat, $AR$29), 0),\n\n  DW, $DR35,\n  CL, $DS35,\n  SL, $DQ35,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM35, UltCritCard),\nCY35*(DE35*DO35*SL+UwDamage*DF35)))",
    "EO35": "IF(OR(CI35 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI35+1))",
    "EP35": "IF(OR($AO$25, CJ35 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ35+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE179,BU35),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL35, 1),\n  DPM, (1+$DI35*CardRangeMastery*$DJ35*$AQ$9),\n  SuperTower, $DL35,\n  Rend, $DN35,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35, $DB35), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR35,\n  SM, $DT35,\n  SLM, $DU35,\n  SL, $DQ35,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM35, UltCritCard),\n\nCY35*(DE35*OtherDamage*SL+UwDamage*DF35)))",
    "EQ35": "IF(OR(CK35 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK35+1)*1%, 1),\n  CF, $DB35,\n  CC, MIN(100%, $CZ35 + 1%),\n  CCUW, DA35 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ180,BZ35) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC35 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR35,\n  CL, $DS35,\n  SM, $DT35,\n  SLM, $DU35,\n  SL, $DQ35,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM35, UltCritCard),\n\nCY35 * (Critical*DO35*SL+UwDamage*UWCritical)))",
    "ER35": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL35 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH180,BX35),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL35+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI35*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM180,CC35), $DV35, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH35,\n  Rapid, DG35,\n  SuperTower, $DL35,\n  Rend, $DN35,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM35,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35, $DB35), 1),\n\n  DW, $DR35,\n  CL, $DS35,\n  SM, $DT35,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY35*(DE35*OtherDamage*SL+UWDamage*DF35)))",
    "ES35": "IF(OR(CM35 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH35,\n  Rapid, DG35,\n  RDPM, (1+$DI35*$DJ35*$AQ$9),\n  Rend, $DN35,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK180,CA35),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM35+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35, $DB35), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR35,\n  CL, $DS35,\n  SM, $DT35,\n  SLM, $DU35,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY35*(DE35*OtherDamage*SL+UwDamage*DF35)))",
    "ET35": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN35 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM35,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN35+1, $DB35), 1),\n\n  DW, $DR35,\n  CL, $DS35,\n  SM, $DT35,\n  SLM, $DU35,\n  SL, $DQ35,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY35*(DE35*DO35*SL+UWDamage*DF35)))",
    "EU35": "IF(OR(NOT($BA$3), NOT($BA$23), $CO35 > $BA$15), \"\", 1 + 0.5*(CO35+1))",
    "EW35": "IF(DZ35=\"\", \"\", LET(\n  Now, CT35,\n  Next, DZ35,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT35),\nFactor/Cost))",
    "EX35": "IF(EA35=\"\",\"\",(EA35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU35))",
    "EY35": "IF(EB35=\"\",\"\",(EB35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV35))",
    "EZ35": "IF(EC35=\"\",\"\",(EC35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW35))",
    "FA35": "IF(ED35=\"\",\"\",(ED35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX35))",
    "FB35": "IF(EE35=\"\",\"\",(EE35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY35))",
    "FC35": "IF(EF35=\"\",\"\",(EF35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ35))",
    "FD35": "IF(EG35=\"\",\"\",(EG35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA35))",
    "FE35": "IF(EH35=\"\",\"\",(EH35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB35))",
    "FF35": "IF(EI35=\"\",\"\",(EI35/$DX35-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC35+1, 1, CC35))))",
    "FG35": "IF(EJ35=\"\",\"\",(EJ35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD35))",
    "FH35": "IF(EK35=\"\",\"\",(EK35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE35))",
    "FI35": "IF(EL35=\"\",\"\",(EL35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF35))",
    "FJ35": "IF(EM35=\"\", \"\", LET(\n  Now, CW35,\n  Next, EM35,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG35),\nFactor/Cost))",
    "FK35": "IF(EN35=\"\",\"\",(EN35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH35))",
    "FL35": "IF(EO35=\"\", \"\", LET(\n  Now, CS35,\n  Next, EO35,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI35),\nFactor/Cost))",
    "FM35": "IF(EP35=\"\",\"\",(EP35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ35))",
    "FN35": "IF(EQ35=\"\",\"\",(EQ35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK35))",
    "FO35": "IF(ER35=\"\",\"\",(ER35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL35))",
    "FP35": "IF(ES35=\"\",\"\",(ES35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM35))",
    "FQ35": "IF(ET35=\"\",\"\",(ET35/$DX35-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN35))",
    "FR35": "IF(EU35=\"\", \"\", LET(\n  Now, CX35,\n  Next, EU35,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO35),\nFactor/Cost))",
    "FT35": "IF(COLUMN(EW35:FR35) = MIN(IF(EW35:FR35=MAX(EW35:FR35), COLUMN(EW35:FR35))), 1, \"\")",
    "D36": "IF(SUM(FT35:GP35),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F36)),\"Card Mastery\",F36),G36)/$D$5,\"\")",
    "F36": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT35:GP35),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT35:GP35=1)),)\"),\"Standard Perks Bonus\")",
    "G36": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT35:GP35),ARRAYFORMULA(FILTER(BT35:CP35 , FT35:GP35=1)),\"\"\"\")\"),1.0)",
    "I36": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT35:GP35),ARRAYFORMULA(FILTER(EW35:FS35 , FT35:GP35=1))*D$5,\"\"\"\")\"),0.14545454545454556)",
    "K36": "IF(H36<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D36)),)",
    "AD36": "IF(EQ(AE36, 15%), \"-\", LET(\n  Next, EQ($AE$34, \"Next Tier\"),\n  Common, EQ($AE$34, \"Common\"),\n  Rare, EQ($AE$34, \"Rare\"),\n  Epic, EQ($AE$34, \"Epic\"),\n  Legendary, EQ($AE$34, \"Legendary\"),\n  Mythic, EQ($AE$34, \"Mythic\"),\n  Ancestral, EQ($AE$34, \"Ancestral\"),\n  Planner, IFERROR(IFS(Next, IFS(AE36=0, 5%, AE36=5%, 8%, AE36=8%, 11%, AE36=11%, 15%), Epic, 5%, Legendary, 8%, Mythic, 11%, Ancestral, 15%), 0),\n\n  ST, $DL$5,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN5, $DB5), 1),\n\n  UwAdditionalDamage, $CR$14,\n  SL, DQ5,\n\n  WaveDur, $CR$15,\n  WdReco, $AN$20+IF(AND($BA$3, $BA$12), $AZ$12, 0)+$AK$20+Planner,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PKGBoost, -IF($AE$35, $AE$35*WdRecoBoss, 0),\n  GComp, 1-PKGBoost/(WaveDur+PKGBoost),\n\n  DWD, $AI$33+$AE$22,\n  DWQ, $AJ$33+$AE$23+IF(AND($BA$26, $BA$32), 1, 0),\n  DWC, ($AK$33+$AE$24)*GComp,\n  DW, IF($AH$33, DWD/DWC*DWQ*$AK$26, 0),\n\n  CL, $DS5,\n\n  SMD, $AI$35+$AE$27,\n  SMQ, $AJ$35+$AE$28+IF(AND($BA$26, $BA$34), 4, 0),\n  SMC, ($AK$35+$AE$29)*GComp,\n  SM, IF($AH$35, $DV$5*$AR$29*SMD*SMQ/SMC, 0),\n\n  SLM, $DU5,\n    UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM5, UltCritCard),\n\n  eDMG, CY5*(DE5*DO5*SL+UwDamage*DF5),\nIF(LTE(eDMG, $DX$5), \"-\", eDMG/$DX$5-1)))",
    "AE36": "IFERROR(INDEX(INDIRECT($C$2 & \"!$AU$14:$AU$19\"), MATCH(AC36,INDIRECT($C$2 & \"!$AR$14:$AR$19\"), 0)),0)",
    "AI36": "(AI37)*(IF(AH35,AI35,10))",
    "AK36": "20-'Master Sheet'!C81",
    "BC36": "BC35+1",
    "BD36": "BD35+BD$3",
    "BE36": "BE35+BE$3",
    "BF36": "BF35+BF$3",
    "BG36": "BG35+BG$3",
    "BH36": "BH35+BH$3",
    "BI36": "BI35+BI$3",
    "BJ36": "BJ35+BJ$3",
    "BT36": "BT35+FT35",
    "BU36": "BU35+FU35",
    "BV36": "BV35+FV35",
    "BW36": "BW35+FW35",
    "BX36": "BX35+FX35",
    "BY36": "BY35+FY35",
    "BZ36": "BZ35+FZ35",
    "CA36": "CA35+GA35",
    "CB36": "CB35+GB35",
    "CC36": "CC35+GC35",
    "CD36": "CD35+GD35",
    "CE36": "CE35+GE35",
    "CF36": "CF35+GF35",
    "CG36": "CG35+GG35",
    "CH36": "CH35+GH35",
    "CI36": "CI35+GI35",
    "CJ36": "CJ35+GJ35",
    "CK36": "CK35+GK35",
    "CL36": "CL35+GL35",
    "CM36": "CM35+GM35",
    "CN36": "CN35+GN35",
    "CO36": "CO35+GO35",
    "CS36": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI36,1)",
    "CT36": "INDEX($BD$5:$BD181,BT36)",
    "CU36": "INDEX($BN$5:$BN181,CD36)",
    "CV36": "INDEX($BO$5:$BO181,CE36)",
    "CW36": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG36)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX36": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO36, 1)",
    "CY36": "LET(\n  Base, $CR$6,\n  Damage, $CT36,\n  DamageMastery, $CS36,\n  DemonMastery, $CX36,\n  SPB, $CU36,\n  ITO, $CV36,\n  Shock, $CW36,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ36": "MIN(100%, DA36)",
    "DA36": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK36*1%, 0)",
    "DB36": "LET(\n  Lab, 1+INDEX($BF$5:$BF181,BV36),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC36": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK36*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI181,BY36) + CardCritMastery)",
    "DD36": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK36*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ181,BZ36) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE36": "LET(\n  CF, $DB36,\n  CC, $CZ36,\n  SCM, $DD36,\n  SCC, $DC36,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF36": "LET(\n  CF, $DB36,\n  CC, $DA36,\n  SCM, $DD36,\n  SCC, $DC36,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG36": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH36)), 0)",
    "DH36": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ36*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE181,BU36),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI36": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG181, BW36), 1) + $AE$9)",
    "DJ36": "LET(\n  DpmLab, INDEX($BH$5:$BH181,BX36),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL36, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK36": "(1+$DI36*$DJ36*$AQ$9)",
    "DL36": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK181,CA36),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM36*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM36": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK181,CA36),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM36*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN36": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL181,CB36)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO36": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH36,\n  Rapid, DG36,\n  RDPM, DK36,\n  SuperTower, $DL36,\n  Rend, $DN36,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP36": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ36": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK36),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR36": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP36),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF36-1))",
    "DS36": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG36, DH36),0))",
    "DT36": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP36),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV36, $AR$29), 0))",
    "DU36": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK36),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM181,CC36), $DV36, $AR$29), 0))",
    "DV36": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH36), $AO$29)",
    "DW36": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM36,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36, $DB36), 1),\n\n  DW, $DR36,\n  CL, $DS36,\n  SM, $DT36,\n  SLM, $DU36,\n  SL, $DQ36,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX36": "CY36*(DE36*DO36*DQ36+DW36*DF36)",
    "DZ36": "IF(INDEX($BD$6:$BD181,BT36)=\"\", \"\", INDEX($BD$5:$BD181,BT36+1))",
    "EA36": "IF(OR($AO$25, INDEX($BE$6:$BE181,BU36)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ36)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE181,BU36+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI36*$DJ36*$AQ$9),\n  SuperTower, $DL36,\n  Rend, $DN36,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36, $DB36), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR36,\n  SM, $DT36,\n  SLM, $DU36,\n  SL, $DQ36,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM36, UltCritCard),\n\nCY36*(DE36*OtherDamage*SL+UwDamage*DF36)))",
    "EB36": "IF(INDEX($BF$6:$BF181,BV36)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF181,BV36+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ36,\n  CCUW, $DA36,\n  SCM, $DD36,\n  SCC, $DC36,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36, CF), 1),\n\n  DW, $DR36,\n  CL, $DS36,\n  SM, $DT36,\n  SLM, $DU36,\n  SL, $DQ36,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM36, UltCritCard),\n\nCY36 * (Critical * DO36 * SL + UwDamage * UWCritical)))",
    "EC36": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG181,BW36)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH36,\n  Rapid, DG36,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG181, BW36+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ36*$AQ$9),\n  SuperTower, $DL36,\n  Rend, $DN36,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM181,CC36), $DV36, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM36,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36, $DB36), 1),\n\n  DW, $DR36,\n  CL, $DS36,\n  SM, $DT36,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY36*(DE36*OtherDamage*SL+UWDamage*DF36)))",
    "ED36": "IF(OR($AO$25, INDEX($BH$6:$BH181,BX36)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH181,BX36+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL36, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI36*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM181,CC36), $DV36, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH36,\n  Rapid, DG36,\n  SuperTower, $DL36,\n  Rend, $DN36,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM36,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36, $DB36), 1),\n\n  DW, $DR36,\n  CL, $DS36,\n  SM, $DT36,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY36*(DE36*OtherDamage*SL+UWDamage*DF36)))",
    "EE36": "IF(INDEX($BI$6:$BI181,BY36)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK36, 0),\n  CF, $DB36,\n  CC, $CZ36,\n  CCUW, $DA36,\n  SCM, $DD36,\n  SCC, $AV$17+INDEX($BI$5:$BI181,BY36+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY36 * (Critical*DO36*$DQ36+DW36*UWCritical)))",
    "EF36": "IF(INDEX($BJ$6:$BJ181,BZ36)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK36*1%, 1),\n  CF, $DB36,\n  CC, $CZ36,\n  CCUW, $DA36,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ181,BZ36+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC36,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY36*(Critical*DO36*$DQ36+DW36*UWCritical)))",
    "EG36": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK181,CA36)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH36,\n  Rapid, DG36,\n  DPM, (1+$DI36*$DJ36*$AQ$9),\n  Rend, $DN36,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK181,CA36+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM36*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36, $DB36), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK181,CA36+1)-1))/(45-CM36*3),1),\n\n  SL, $DQ36,\n  DW, $DR36,\n  CL, $DS36,\n  SM, $DT36,\n  SLM, $DU36,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY36*(DE36*OtherDamage*SL+UwDamage*DF36)))",
    "EH36": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL181,CB36+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL181,CB36)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH36,\n  Rapid, DG36,\n  DPM, (1+$DI36*$DJ36*$AQ$9),\n  SuperTower, $DL36,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL181,CB36+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY36*(DE36*OtherDamage*$DQ36+DW36*DF36)))",
    "EI36": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM181,CC36)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36, $DB36), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK36),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV36, $AR$29), 0),\n\n  DW, $DR36,\n  CL, $DS36,\n  SM, $DT36,\n  SL, $DQ36,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM36, UltCritCard),\nCY36*(DE36*DO36*SL+UwDamage*DF36)))",
    "EJ36": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN181,CD36)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT36,\n  DamageMastery, $CS36,\n  DemonMastery, $CX36,\n  SPB, INDEX($BN$5:$BN181,CD36+1),\n  ITO, $CV36,\n  Shock, $CW36,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE36*DO36*$DQ36+DW36*DF36)))",
    "EK36": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO181,CE36)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT36,\n  DamageMastery, $CS36,\n  DemonMastery, $CX36,\n  SPB, $CU36,\n  ITO, INDEX($BO$5:$BO181,CE36+1),\n  Shock, $CW36,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE36*DO36*$DQ36+DW36*DF36)))",
    "EL36": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP181,CF36)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36, $DB36), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP36),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF36),\n  CL, $DS36,\n  SM, $DT36,\n  SLM, $DU36,\n  SL, $DQ36,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM36, UltCritCard),\nCY36*(DE36*DO36*SL+UwDamage*DF36)))",
    "EM36": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ181,CG36)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG36+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN36": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR181,CH36)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36, $DB36), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH36+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP36),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK36),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM181,CC36), SMHeat, $AR$29), 0),\n\n  DW, $DR36,\n  CL, $DS36,\n  SL, $DQ36,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM36, UltCritCard),\nCY36*(DE36*DO36*SL+UwDamage*DF36)))",
    "EO36": "IF(OR(CI36 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI36+1))",
    "EP36": "IF(OR($AO$25, CJ36 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ36+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE180,BU36),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL36, 1),\n  DPM, (1+$DI36*CardRangeMastery*$DJ36*$AQ$9),\n  SuperTower, $DL36,\n  Rend, $DN36,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36, $DB36), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR36,\n  SM, $DT36,\n  SLM, $DU36,\n  SL, $DQ36,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM36, UltCritCard),\n\nCY36*(DE36*OtherDamage*SL+UwDamage*DF36)))",
    "EQ36": "IF(OR(CK36 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK36+1)*1%, 1),\n  CF, $DB36,\n  CC, MIN(100%, $CZ36 + 1%),\n  CCUW, DA36 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ181,BZ36) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC36 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR36,\n  CL, $DS36,\n  SM, $DT36,\n  SLM, $DU36,\n  SL, $DQ36,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM36, UltCritCard),\n\nCY36 * (Critical*DO36*SL+UwDamage*UWCritical)))",
    "ER36": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL36 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH181,BX36),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL36+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI36*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM181,CC36), $DV36, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH36,\n  Rapid, DG36,\n  SuperTower, $DL36,\n  Rend, $DN36,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM36,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36, $DB36), 1),\n\n  DW, $DR36,\n  CL, $DS36,\n  SM, $DT36,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY36*(DE36*OtherDamage*SL+UWDamage*DF36)))",
    "ES36": "IF(OR(CM36 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH36,\n  Rapid, DG36,\n  RDPM, (1+$DI36*$DJ36*$AQ$9),\n  Rend, $DN36,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK181,CA36),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM36+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36, $DB36), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR36,\n  CL, $DS36,\n  SM, $DT36,\n  SLM, $DU36,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY36*(DE36*OtherDamage*SL+UwDamage*DF36)))",
    "ET36": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN36 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM36,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN36+1, $DB36), 1),\n\n  DW, $DR36,\n  CL, $DS36,\n  SM, $DT36,\n  SLM, $DU36,\n  SL, $DQ36,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY36*(DE36*DO36*SL+UWDamage*DF36)))",
    "EU36": "IF(OR(NOT($BA$3), NOT($BA$23), $CO36 > $BA$15), \"\", 1 + 0.5*(CO36+1))",
    "EW36": "IF(DZ36=\"\", \"\", LET(\n  Now, CT36,\n  Next, DZ36,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT36),\nFactor/Cost))",
    "EX36": "IF(EA36=\"\",\"\",(EA36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU36))",
    "EY36": "IF(EB36=\"\",\"\",(EB36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV36))",
    "EZ36": "IF(EC36=\"\",\"\",(EC36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW36))",
    "FA36": "IF(ED36=\"\",\"\",(ED36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX36))",
    "FB36": "IF(EE36=\"\",\"\",(EE36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY36))",
    "FC36": "IF(EF36=\"\",\"\",(EF36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ36))",
    "FD36": "IF(EG36=\"\",\"\",(EG36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA36))",
    "FE36": "IF(EH36=\"\",\"\",(EH36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB36))",
    "FF36": "IF(EI36=\"\",\"\",(EI36/$DX36-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC36+1, 1, CC36))))",
    "FG36": "IF(EJ36=\"\",\"\",(EJ36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD36))",
    "FH36": "IF(EK36=\"\",\"\",(EK36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE36))",
    "FI36": "IF(EL36=\"\",\"\",(EL36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF36))",
    "FJ36": "IF(EM36=\"\", \"\", LET(\n  Now, CW36,\n  Next, EM36,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG36),\nFactor/Cost))",
    "FK36": "IF(EN36=\"\",\"\",(EN36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH36))",
    "FL36": "IF(EO36=\"\", \"\", LET(\n  Now, CS36,\n  Next, EO36,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI36),\nFactor/Cost))",
    "FM36": "IF(EP36=\"\",\"\",(EP36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ36))",
    "FN36": "IF(EQ36=\"\",\"\",(EQ36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK36))",
    "FO36": "IF(ER36=\"\",\"\",(ER36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL36))",
    "FP36": "IF(ES36=\"\",\"\",(ES36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM36))",
    "FQ36": "IF(ET36=\"\",\"\",(ET36/$DX36-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN36))",
    "FR36": "IF(EU36=\"\", \"\", LET(\n  Now, CX36,\n  Next, EU36,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO36),\nFactor/Cost))",
    "FT36": "IF(COLUMN(EW36:FR36) = MIN(IF(EW36:FR36=MAX(EW36:FR36), COLUMN(EW36:FR36))), 1, \"\")",
    "D37": "IF(SUM(FT36:GP36),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F37)),\"Card Mastery\",F37),G37)/$D$5,\"\")",
    "F37": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT36:GP36),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT36:GP36=1)),)\"),\"Damage / Meter\")",
    "G37": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT36:GP36),ARRAYFORMULA(FILTER(BT36:CP36 , FT36:GP36=1)),\"\"\"\")\"),6.0)",
    "I37": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT36:GP36),ARRAYFORMULA(FILTER(EW36:FS36 , FT36:GP36=1))*D$5,\"\"\"\")\"),0.1337217525663248)",
    "K37": "IF(H37<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D37)),)",
    "AF37": "Images!E4",
    "AH37": "'Master Sheet'!S36",
    "AI37": "'Master Sheet'!V34",
    "AJ37": "'Master Sheet'!V35",
    "AK37": "'Master Sheet'!V36",
    "AL37": "'Master Sheet'!V37",
    "BC37": "BC36+1",
    "BD37": "BD36+BD$3",
    "BE37": "BE36+BE$3",
    "BF37": "BF36+BF$3",
    "BG37": "BG36+BG$3",
    "BH37": "BH36+BH$3",
    "BI37": "BI36+BI$3",
    "BJ37": "BJ36+BJ$3",
    "BT37": "BT36+FT36",
    "BU37": "BU36+FU36",
    "BV37": "BV36+FV36",
    "BW37": "BW36+FW36",
    "BX37": "BX36+FX36",
    "BY37": "BY36+FY36",
    "BZ37": "BZ36+FZ36",
    "CA37": "CA36+GA36",
    "CB37": "CB36+GB36",
    "CC37": "CC36+GC36",
    "CD37": "CD36+GD36",
    "CE37": "CE36+GE36",
    "CF37": "CF36+GF36",
    "CG37": "CG36+GG36",
    "CH37": "CH36+GH36",
    "CI37": "CI36+GI36",
    "CJ37": "CJ36+GJ36",
    "CK37": "CK36+GK36",
    "CL37": "CL36+GL36",
    "CM37": "CM36+GM36",
    "CN37": "CN36+GN36",
    "CO37": "CO36+GO36",
    "CS37": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI37,1)",
    "CT37": "INDEX($BD$5:$BD182,BT37)",
    "CU37": "INDEX($BN$5:$BN182,CD37)",
    "CV37": "INDEX($BO$5:$BO182,CE37)",
    "CW37": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG37)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX37": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO37, 1)",
    "CY37": "LET(\n  Base, $CR$6,\n  Damage, $CT37,\n  DamageMastery, $CS37,\n  DemonMastery, $CX37,\n  SPB, $CU37,\n  ITO, $CV37,\n  Shock, $CW37,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ37": "MIN(100%, DA37)",
    "DA37": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK37*1%, 0)",
    "DB37": "LET(\n  Lab, 1+INDEX($BF$5:$BF182,BV37),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC37": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK37*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI182,BY37) + CardCritMastery)",
    "DD37": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK37*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ182,BZ37) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE37": "LET(\n  CF, $DB37,\n  CC, $CZ37,\n  SCM, $DD37,\n  SCC, $DC37,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF37": "LET(\n  CF, $DB37,\n  CC, $DA37,\n  SCM, $DD37,\n  SCC, $DC37,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG37": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH37)), 0)",
    "DH37": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ37*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE182,BU37),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI37": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG182, BW37), 1) + $AE$9)",
    "DJ37": "LET(\n  DpmLab, INDEX($BH$5:$BH182,BX37),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL37, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK37": "(1+$DI37*$DJ37*$AQ$9)",
    "DL37": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK182,CA37),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM37*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM37": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK182,CA37),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM37*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN37": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL182,CB37)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO37": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH37,\n  Rapid, DG37,\n  RDPM, DK37,\n  SuperTower, $DL37,\n  Rend, $DN37,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP37": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ37": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK37),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR37": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP37),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF37-1))",
    "DS37": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG37, DH37),0))",
    "DT37": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP37),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV37, $AR$29), 0))",
    "DU37": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK37),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM182,CC37), $DV37, $AR$29), 0))",
    "DV37": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH37), $AO$29)",
    "DW37": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM37,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37, $DB37), 1),\n\n  DW, $DR37,\n  CL, $DS37,\n  SM, $DT37,\n  SLM, $DU37,\n  SL, $DQ37,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX37": "CY37*(DE37*DO37*DQ37+DW37*DF37)",
    "DZ37": "IF(INDEX($BD$6:$BD182,BT37)=\"\", \"\", INDEX($BD$5:$BD182,BT37+1))",
    "EA37": "IF(OR($AO$25, INDEX($BE$6:$BE182,BU37)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ37)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE182,BU37+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI37*$DJ37*$AQ$9),\n  SuperTower, $DL37,\n  Rend, $DN37,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37, $DB37), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR37,\n  SM, $DT37,\n  SLM, $DU37,\n  SL, $DQ37,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM37, UltCritCard),\n\nCY37*(DE37*OtherDamage*SL+UwDamage*DF37)))",
    "EB37": "IF(INDEX($BF$6:$BF182,BV37)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF182,BV37+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ37,\n  CCUW, $DA37,\n  SCM, $DD37,\n  SCC, $DC37,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37, CF), 1),\n\n  DW, $DR37,\n  CL, $DS37,\n  SM, $DT37,\n  SLM, $DU37,\n  SL, $DQ37,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM37, UltCritCard),\n\nCY37 * (Critical * DO37 * SL + UwDamage * UWCritical)))",
    "EC37": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG182,BW37)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH37,\n  Rapid, DG37,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG182, BW37+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ37*$AQ$9),\n  SuperTower, $DL37,\n  Rend, $DN37,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM182,CC37), $DV37, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM37,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37, $DB37), 1),\n\n  DW, $DR37,\n  CL, $DS37,\n  SM, $DT37,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY37*(DE37*OtherDamage*SL+UWDamage*DF37)))",
    "ED37": "IF(OR($AO$25, INDEX($BH$6:$BH182,BX37)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH182,BX37+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL37, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI37*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM182,CC37), $DV37, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH37,\n  Rapid, DG37,\n  SuperTower, $DL37,\n  Rend, $DN37,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM37,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37, $DB37), 1),\n\n  DW, $DR37,\n  CL, $DS37,\n  SM, $DT37,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY37*(DE37*OtherDamage*SL+UWDamage*DF37)))",
    "EE37": "IF(INDEX($BI$6:$BI182,BY37)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK37, 0),\n  CF, $DB37,\n  CC, $CZ37,\n  CCUW, $DA37,\n  SCM, $DD37,\n  SCC, $AV$17+INDEX($BI$5:$BI182,BY37+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY37 * (Critical*DO37*$DQ37+DW37*UWCritical)))",
    "EF37": "IF(INDEX($BJ$6:$BJ182,BZ37)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK37*1%, 1),\n  CF, $DB37,\n  CC, $CZ37,\n  CCUW, $DA37,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ182,BZ37+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC37,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY37*(Critical*DO37*$DQ37+DW37*UWCritical)))",
    "EG37": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK182,CA37)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH37,\n  Rapid, DG37,\n  DPM, (1+$DI37*$DJ37*$AQ$9),\n  Rend, $DN37,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK182,CA37+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM37*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37, $DB37), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK182,CA37+1)-1))/(45-CM37*3),1),\n\n  SL, $DQ37,\n  DW, $DR37,\n  CL, $DS37,\n  SM, $DT37,\n  SLM, $DU37,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY37*(DE37*OtherDamage*SL+UwDamage*DF37)))",
    "EH37": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL182,CB37+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL182,CB37)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH37,\n  Rapid, DG37,\n  DPM, (1+$DI37*$DJ37*$AQ$9),\n  SuperTower, $DL37,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL182,CB37+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY37*(DE37*OtherDamage*$DQ37+DW37*DF37)))",
    "EI37": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM182,CC37)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37, $DB37), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK37),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV37, $AR$29), 0),\n\n  DW, $DR37,\n  CL, $DS37,\n  SM, $DT37,\n  SL, $DQ37,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM37, UltCritCard),\nCY37*(DE37*DO37*SL+UwDamage*DF37)))",
    "EJ37": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN182,CD37)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT37,\n  DamageMastery, $CS37,\n  DemonMastery, $CX37,\n  SPB, INDEX($BN$5:$BN182,CD37+1),\n  ITO, $CV37,\n  Shock, $CW37,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE37*DO37*$DQ37+DW37*DF37)))",
    "EK37": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO182,CE37)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT37,\n  DamageMastery, $CS37,\n  DemonMastery, $CX37,\n  SPB, $CU37,\n  ITO, INDEX($BO$5:$BO182,CE37+1),\n  Shock, $CW37,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE37*DO37*$DQ37+DW37*DF37)))",
    "EL37": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP182,CF37)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37, $DB37), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP37),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF37),\n  CL, $DS37,\n  SM, $DT37,\n  SLM, $DU37,\n  SL, $DQ37,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM37, UltCritCard),\nCY37*(DE37*DO37*SL+UwDamage*DF37)))",
    "EM37": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ182,CG37)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG37+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN37": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR182,CH37)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37, $DB37), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH37+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP37),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK37),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM182,CC37), SMHeat, $AR$29), 0),\n\n  DW, $DR37,\n  CL, $DS37,\n  SL, $DQ37,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM37, UltCritCard),\nCY37*(DE37*DO37*SL+UwDamage*DF37)))",
    "EO37": "IF(OR(CI37 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI37+1))",
    "EP37": "IF(OR($AO$25, CJ37 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ37+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE181,BU37),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL37, 1),\n  DPM, (1+$DI37*CardRangeMastery*$DJ37*$AQ$9),\n  SuperTower, $DL37,\n  Rend, $DN37,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37, $DB37), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR37,\n  SM, $DT37,\n  SLM, $DU37,\n  SL, $DQ37,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM37, UltCritCard),\n\nCY37*(DE37*OtherDamage*SL+UwDamage*DF37)))",
    "EQ37": "IF(OR(CK37 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK37+1)*1%, 1),\n  CF, $DB37,\n  CC, MIN(100%, $CZ37 + 1%),\n  CCUW, DA37 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ182,BZ37) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC37 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR37,\n  CL, $DS37,\n  SM, $DT37,\n  SLM, $DU37,\n  SL, $DQ37,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM37, UltCritCard),\n\nCY37 * (Critical*DO37*SL+UwDamage*UWCritical)))",
    "ER37": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL37 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH182,BX37),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL37+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI37*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM182,CC37), $DV37, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH37,\n  Rapid, DG37,\n  SuperTower, $DL37,\n  Rend, $DN37,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM37,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37, $DB37), 1),\n\n  DW, $DR37,\n  CL, $DS37,\n  SM, $DT37,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY37*(DE37*OtherDamage*SL+UWDamage*DF37)))",
    "ES37": "IF(OR(CM37 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH37,\n  Rapid, DG37,\n  RDPM, (1+$DI37*$DJ37*$AQ$9),\n  Rend, $DN37,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK182,CA37),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM37+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37, $DB37), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR37,\n  CL, $DS37,\n  SM, $DT37,\n  SLM, $DU37,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY37*(DE37*OtherDamage*SL+UwDamage*DF37)))",
    "ET37": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN37 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM37,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN37+1, $DB37), 1),\n\n  DW, $DR37,\n  CL, $DS37,\n  SM, $DT37,\n  SLM, $DU37,\n  SL, $DQ37,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY37*(DE37*DO37*SL+UWDamage*DF37)))",
    "EU37": "IF(OR(NOT($BA$3), NOT($BA$23), $CO37 > $BA$15), \"\", 1 + 0.5*(CO37+1))",
    "EW37": "IF(DZ37=\"\", \"\", LET(\n  Now, CT37,\n  Next, DZ37,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT37),\nFactor/Cost))",
    "EX37": "IF(EA37=\"\",\"\",(EA37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU37))",
    "EY37": "IF(EB37=\"\",\"\",(EB37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV37))",
    "EZ37": "IF(EC37=\"\",\"\",(EC37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW37))",
    "FA37": "IF(ED37=\"\",\"\",(ED37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX37))",
    "FB37": "IF(EE37=\"\",\"\",(EE37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY37))",
    "FC37": "IF(EF37=\"\",\"\",(EF37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ37))",
    "FD37": "IF(EG37=\"\",\"\",(EG37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA37))",
    "FE37": "IF(EH37=\"\",\"\",(EH37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB37))",
    "FF37": "IF(EI37=\"\",\"\",(EI37/$DX37-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC37+1, 1, CC37))))",
    "FG37": "IF(EJ37=\"\",\"\",(EJ37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD37))",
    "FH37": "IF(EK37=\"\",\"\",(EK37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE37))",
    "FI37": "IF(EL37=\"\",\"\",(EL37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF37))",
    "FJ37": "IF(EM37=\"\", \"\", LET(\n  Now, CW37,\n  Next, EM37,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG37),\nFactor/Cost))",
    "FK37": "IF(EN37=\"\",\"\",(EN37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH37))",
    "FL37": "IF(EO37=\"\", \"\", LET(\n  Now, CS37,\n  Next, EO37,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI37),\nFactor/Cost))",
    "FM37": "IF(EP37=\"\",\"\",(EP37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ37))",
    "FN37": "IF(EQ37=\"\",\"\",(EQ37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK37))",
    "FO37": "IF(ER37=\"\",\"\",(ER37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL37))",
    "FP37": "IF(ES37=\"\",\"\",(ES37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM37))",
    "FQ37": "IF(ET37=\"\",\"\",(ET37/$DX37-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN37))",
    "FR37": "IF(EU37=\"\", \"\", LET(\n  Now, CX37,\n  Next, EU37,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO37),\nFactor/Cost))",
    "FT37": "IF(COLUMN(EW37:FR37) = MIN(IF(EW37:FR37=MAX(EW37:FR37), COLUMN(EW37:FR37))), 1, \"\")",
    "D38": "IF(SUM(FT37:GP37),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F38)),\"Card Mastery\",F38),G38)/$D$5,\"\")",
    "F38": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT37:GP37),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT37:GP37=1)),)\"),\"Critical Factor\")",
    "G38": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT37:GP37),ARRAYFORMULA(FILTER(BT37:CP37 , FT37:GP37=1)),\"\"\"\")\"),10.0)",
    "I38": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT37:GP37),ARRAYFORMULA(FILTER(EW37:FS37 , FT37:GP37=1))*D$5,\"\"\"\")\"),0.1250420744691812)",
    "K38": "IF(H38<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D38)),)",
    "BC38": "BC37+1",
    "BD38": "BD37+BD$3",
    "BE38": "BE37+BE$3",
    "BF38": "BF37+BF$3",
    "BG38": "BG37+BG$3",
    "BH38": "BH37+BH$3",
    "BI38": "BI37+BI$3",
    "BJ38": "BJ37+BJ$3",
    "BT38": "BT37+FT37",
    "BU38": "BU37+FU37",
    "BV38": "BV37+FV37",
    "BW38": "BW37+FW37",
    "BX38": "BX37+FX37",
    "BY38": "BY37+FY37",
    "BZ38": "BZ37+FZ37",
    "CA38": "CA37+GA37",
    "CB38": "CB37+GB37",
    "CC38": "CC37+GC37",
    "CD38": "CD37+GD37",
    "CE38": "CE37+GE37",
    "CF38": "CF37+GF37",
    "CG38": "CG37+GG37",
    "CH38": "CH37+GH37",
    "CI38": "CI37+GI37",
    "CJ38": "CJ37+GJ37",
    "CK38": "CK37+GK37",
    "CL38": "CL37+GL37",
    "CM38": "CM37+GM37",
    "CN38": "CN37+GN37",
    "CO38": "CO37+GO37",
    "CS38": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI38,1)",
    "CT38": "INDEX($BD$5:$BD183,BT38)",
    "CU38": "INDEX($BN$5:$BN183,CD38)",
    "CV38": "INDEX($BO$5:$BO183,CE38)",
    "CW38": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG38)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX38": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO38, 1)",
    "CY38": "LET(\n  Base, $CR$6,\n  Damage, $CT38,\n  DamageMastery, $CS38,\n  DemonMastery, $CX38,\n  SPB, $CU38,\n  ITO, $CV38,\n  Shock, $CW38,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ38": "MIN(100%, DA38)",
    "DA38": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK38*1%, 0)",
    "DB38": "LET(\n  Lab, 1+INDEX($BF$5:$BF183,BV38),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC38": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK38*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI183,BY38) + CardCritMastery)",
    "DD38": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK38*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ183,BZ38) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE38": "LET(\n  CF, $DB38,\n  CC, $CZ38,\n  SCM, $DD38,\n  SCC, $DC38,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF38": "LET(\n  CF, $DB38,\n  CC, $DA38,\n  SCM, $DD38,\n  SCC, $DC38,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG38": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH38)), 0)",
    "DH38": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ38*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE183,BU38),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI38": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG183, BW38), 1) + $AE$9)",
    "DJ38": "LET(\n  DpmLab, INDEX($BH$5:$BH183,BX38),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL38, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK38": "(1+$DI38*$DJ38*$AQ$9)",
    "DL38": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK183,CA38),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM38*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM38": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK183,CA38),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM38*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN38": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL183,CB38)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO38": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH38,\n  Rapid, DG38,\n  RDPM, DK38,\n  SuperTower, $DL38,\n  Rend, $DN38,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP38": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ38": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK38),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR38": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP38),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF38-1))",
    "DS38": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG38, DH38),0))",
    "DT38": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP38),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV38, $AR$29), 0))",
    "DU38": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK38),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM183,CC38), $DV38, $AR$29), 0))",
    "DV38": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH38), $AO$29)",
    "DW38": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM38,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38, $DB38), 1),\n\n  DW, $DR38,\n  CL, $DS38,\n  SM, $DT38,\n  SLM, $DU38,\n  SL, $DQ38,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX38": "CY38*(DE38*DO38*DQ38+DW38*DF38)",
    "DZ38": "IF(INDEX($BD$6:$BD183,BT38)=\"\", \"\", INDEX($BD$5:$BD183,BT38+1))",
    "EA38": "IF(OR($AO$25, INDEX($BE$6:$BE183,BU38)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ38)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE183,BU38+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI38*$DJ38*$AQ$9),\n  SuperTower, $DL38,\n  Rend, $DN38,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38, $DB38), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR38,\n  SM, $DT38,\n  SLM, $DU38,\n  SL, $DQ38,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM38, UltCritCard),\n\nCY38*(DE38*OtherDamage*SL+UwDamage*DF38)))",
    "EB38": "IF(INDEX($BF$6:$BF183,BV38)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF183,BV38+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ38,\n  CCUW, $DA38,\n  SCM, $DD38,\n  SCC, $DC38,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38, CF), 1),\n\n  DW, $DR38,\n  CL, $DS38,\n  SM, $DT38,\n  SLM, $DU38,\n  SL, $DQ38,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM38, UltCritCard),\n\nCY38 * (Critical * DO38 * SL + UwDamage * UWCritical)))",
    "EC38": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG183,BW38)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH38,\n  Rapid, DG38,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG183, BW38+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ38*$AQ$9),\n  SuperTower, $DL38,\n  Rend, $DN38,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM183,CC38), $DV38, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM38,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38, $DB38), 1),\n\n  DW, $DR38,\n  CL, $DS38,\n  SM, $DT38,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY38*(DE38*OtherDamage*SL+UWDamage*DF38)))",
    "ED38": "IF(OR($AO$25, INDEX($BH$6:$BH183,BX38)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH183,BX38+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL38, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI38*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM183,CC38), $DV38, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH38,\n  Rapid, DG38,\n  SuperTower, $DL38,\n  Rend, $DN38,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM38,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38, $DB38), 1),\n\n  DW, $DR38,\n  CL, $DS38,\n  SM, $DT38,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY38*(DE38*OtherDamage*SL+UWDamage*DF38)))",
    "EE38": "IF(INDEX($BI$6:$BI183,BY38)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK38, 0),\n  CF, $DB38,\n  CC, $CZ38,\n  CCUW, $DA38,\n  SCM, $DD38,\n  SCC, $AV$17+INDEX($BI$5:$BI183,BY38+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY38 * (Critical*DO38*$DQ38+DW38*UWCritical)))",
    "EF38": "IF(INDEX($BJ$6:$BJ183,BZ38)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK38*1%, 1),\n  CF, $DB38,\n  CC, $CZ38,\n  CCUW, $DA38,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ183,BZ38+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC38,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY38*(Critical*DO38*$DQ38+DW38*UWCritical)))",
    "EG38": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK183,CA38)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH38,\n  Rapid, DG38,\n  DPM, (1+$DI38*$DJ38*$AQ$9),\n  Rend, $DN38,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK183,CA38+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM38*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38, $DB38), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK183,CA38+1)-1))/(45-CM38*3),1),\n\n  SL, $DQ38,\n  DW, $DR38,\n  CL, $DS38,\n  SM, $DT38,\n  SLM, $DU38,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY38*(DE38*OtherDamage*SL+UwDamage*DF38)))",
    "EH38": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL183,CB38+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL183,CB38)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH38,\n  Rapid, DG38,\n  DPM, (1+$DI38*$DJ38*$AQ$9),\n  SuperTower, $DL38,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL183,CB38+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY38*(DE38*OtherDamage*$DQ38+DW38*DF38)))",
    "EI38": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM183,CC38)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38, $DB38), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK38),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV38, $AR$29), 0),\n\n  DW, $DR38,\n  CL, $DS38,\n  SM, $DT38,\n  SL, $DQ38,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM38, UltCritCard),\nCY38*(DE38*DO38*SL+UwDamage*DF38)))",
    "EJ38": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN183,CD38)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT38,\n  DamageMastery, $CS38,\n  DemonMastery, $CX38,\n  SPB, INDEX($BN$5:$BN183,CD38+1),\n  ITO, $CV38,\n  Shock, $CW38,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE38*DO38*$DQ38+DW38*DF38)))",
    "EK38": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO183,CE38)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT38,\n  DamageMastery, $CS38,\n  DemonMastery, $CX38,\n  SPB, $CU38,\n  ITO, INDEX($BO$5:$BO183,CE38+1),\n  Shock, $CW38,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE38*DO38*$DQ38+DW38*DF38)))",
    "EL38": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP183,CF38)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38, $DB38), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP38),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF38),\n  CL, $DS38,\n  SM, $DT38,\n  SLM, $DU38,\n  SL, $DQ38,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM38, UltCritCard),\nCY38*(DE38*DO38*SL+UwDamage*DF38)))",
    "EM38": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ183,CG38)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG38+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN38": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR183,CH38)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38, $DB38), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH38+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP38),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK38),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM183,CC38), SMHeat, $AR$29), 0),\n\n  DW, $DR38,\n  CL, $DS38,\n  SL, $DQ38,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM38, UltCritCard),\nCY38*(DE38*DO38*SL+UwDamage*DF38)))",
    "EO38": "IF(OR(CI38 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI38+1))",
    "EP38": "IF(OR($AO$25, CJ38 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ38+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE182,BU38),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL38, 1),\n  DPM, (1+$DI38*CardRangeMastery*$DJ38*$AQ$9),\n  SuperTower, $DL38,\n  Rend, $DN38,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38, $DB38), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR38,\n  SM, $DT38,\n  SLM, $DU38,\n  SL, $DQ38,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM38, UltCritCard),\n\nCY38*(DE38*OtherDamage*SL+UwDamage*DF38)))",
    "EQ38": "IF(OR(CK38 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK38+1)*1%, 1),\n  CF, $DB38,\n  CC, MIN(100%, $CZ38 + 1%),\n  CCUW, DA38 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ183,BZ38) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC38 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR38,\n  CL, $DS38,\n  SM, $DT38,\n  SLM, $DU38,\n  SL, $DQ38,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM38, UltCritCard),\n\nCY38 * (Critical*DO38*SL+UwDamage*UWCritical)))",
    "ER38": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL38 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH183,BX38),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL38+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI38*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM183,CC38), $DV38, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH38,\n  Rapid, DG38,\n  SuperTower, $DL38,\n  Rend, $DN38,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM38,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38, $DB38), 1),\n\n  DW, $DR38,\n  CL, $DS38,\n  SM, $DT38,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY38*(DE38*OtherDamage*SL+UWDamage*DF38)))",
    "ES38": "IF(OR(CM38 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH38,\n  Rapid, DG38,\n  RDPM, (1+$DI38*$DJ38*$AQ$9),\n  Rend, $DN38,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK183,CA38),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM38+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38, $DB38), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR38,\n  CL, $DS38,\n  SM, $DT38,\n  SLM, $DU38,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY38*(DE38*OtherDamage*SL+UwDamage*DF38)))",
    "ET38": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN38 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM38,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN38+1, $DB38), 1),\n\n  DW, $DR38,\n  CL, $DS38,\n  SM, $DT38,\n  SLM, $DU38,\n  SL, $DQ38,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY38*(DE38*DO38*SL+UWDamage*DF38)))",
    "EU38": "IF(OR(NOT($BA$3), NOT($BA$23), $CO38 > $BA$15), \"\", 1 + 0.5*(CO38+1))",
    "EW38": "IF(DZ38=\"\", \"\", LET(\n  Now, CT38,\n  Next, DZ38,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT38),\nFactor/Cost))",
    "EX38": "IF(EA38=\"\",\"\",(EA38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU38))",
    "EY38": "IF(EB38=\"\",\"\",(EB38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV38))",
    "EZ38": "IF(EC38=\"\",\"\",(EC38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW38))",
    "FA38": "IF(ED38=\"\",\"\",(ED38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX38))",
    "FB38": "IF(EE38=\"\",\"\",(EE38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY38))",
    "FC38": "IF(EF38=\"\",\"\",(EF38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ38))",
    "FD38": "IF(EG38=\"\",\"\",(EG38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA38))",
    "FE38": "IF(EH38=\"\",\"\",(EH38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB38))",
    "FF38": "IF(EI38=\"\",\"\",(EI38/$DX38-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC38+1, 1, CC38))))",
    "FG38": "IF(EJ38=\"\",\"\",(EJ38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD38))",
    "FH38": "IF(EK38=\"\",\"\",(EK38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE38))",
    "FI38": "IF(EL38=\"\",\"\",(EL38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF38))",
    "FJ38": "IF(EM38=\"\", \"\", LET(\n  Now, CW38,\n  Next, EM38,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG38),\nFactor/Cost))",
    "FK38": "IF(EN38=\"\",\"\",(EN38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH38))",
    "FL38": "IF(EO38=\"\", \"\", LET(\n  Now, CS38,\n  Next, EO38,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI38),\nFactor/Cost))",
    "FM38": "IF(EP38=\"\",\"\",(EP38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ38))",
    "FN38": "IF(EQ38=\"\",\"\",(EQ38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK38))",
    "FO38": "IF(ER38=\"\",\"\",(ER38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL38))",
    "FP38": "IF(ES38=\"\",\"\",(ES38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM38))",
    "FQ38": "IF(ET38=\"\",\"\",(ET38/$DX38-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN38))",
    "FR38": "IF(EU38=\"\", \"\", LET(\n  Now, CX38,\n  Next, EU38,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO38),\nFactor/Cost))",
    "FT38": "IF(COLUMN(EW38:FR38) = MIN(IF(EW38:FR38=MAX(EW38:FR38), COLUMN(EW38:FR38))), 1, \"\")",
    "D39": "IF(SUM(FT38:GP38),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F39)),\"Card Mastery\",F39),G39)/$D$5,\"\")",
    "F39": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT38:GP38),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT38:GP38=1)),)\"),\"Attack Speed\")",
    "G39": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT38:GP38),ARRAYFORMULA(FILTER(BT38:CP38 , FT38:GP38=1)),\"\"\"\")\"),9.0)",
    "I39": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT38:GP38),ARRAYFORMULA(FILTER(EW38:FS38 , FT38:GP38=1))*D$5,\"\"\"\")\"),0.11815341070827727)",
    "K39": "IF(H39<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D39)),)",
    "BC39": "BC38+1",
    "BD39": "BD38+BD$3",
    "BE39": "BE38+BE$3",
    "BF39": "BF38+BF$3",
    "BG39": "BG38+BG$3",
    "BH39": "BH38+BH$3",
    "BI39": "BI38+BI$3",
    "BJ39": "BJ38+BJ$3",
    "BT39": "BT38+FT38",
    "BU39": "BU38+FU38",
    "BV39": "BV38+FV38",
    "BW39": "BW38+FW38",
    "BX39": "BX38+FX38",
    "BY39": "BY38+FY38",
    "BZ39": "BZ38+FZ38",
    "CA39": "CA38+GA38",
    "CB39": "CB38+GB38",
    "CC39": "CC38+GC38",
    "CD39": "CD38+GD38",
    "CE39": "CE38+GE38",
    "CF39": "CF38+GF38",
    "CG39": "CG38+GG38",
    "CH39": "CH38+GH38",
    "CI39": "CI38+GI38",
    "CJ39": "CJ38+GJ38",
    "CK39": "CK38+GK38",
    "CL39": "CL38+GL38",
    "CM39": "CM38+GM38",
    "CN39": "CN38+GN38",
    "CO39": "CO38+GO38",
    "CS39": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI39,1)",
    "CT39": "INDEX($BD$5:$BD184,BT39)",
    "CU39": "INDEX($BN$5:$BN184,CD39)",
    "CV39": "INDEX($BO$5:$BO184,CE39)",
    "CW39": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG39)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX39": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO39, 1)",
    "CY39": "LET(\n  Base, $CR$6,\n  Damage, $CT39,\n  DamageMastery, $CS39,\n  DemonMastery, $CX39,\n  SPB, $CU39,\n  ITO, $CV39,\n  Shock, $CW39,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ39": "MIN(100%, DA39)",
    "DA39": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK39*1%, 0)",
    "DB39": "LET(\n  Lab, 1+INDEX($BF$5:$BF184,BV39),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC39": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK39*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI184,BY39) + CardCritMastery)",
    "DD39": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK39*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ184,BZ39) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE39": "LET(\n  CF, $DB39,\n  CC, $CZ39,\n  SCM, $DD39,\n  SCC, $DC39,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF39": "LET(\n  CF, $DB39,\n  CC, $DA39,\n  SCM, $DD39,\n  SCC, $DC39,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG39": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH39)), 0)",
    "DH39": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ39*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE184,BU39),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI39": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG184, BW39), 1) + $AE$9)",
    "DJ39": "LET(\n  DpmLab, INDEX($BH$5:$BH184,BX39),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL39, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK39": "(1+$DI39*$DJ39*$AQ$9)",
    "DL39": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK184,CA39),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM39*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM39": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK184,CA39),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM39*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN39": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL184,CB39)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO39": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH39,\n  Rapid, DG39,\n  RDPM, DK39,\n  SuperTower, $DL39,\n  Rend, $DN39,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP39": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ39": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK39),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR39": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP39),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF39-1))",
    "DS39": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG39, DH39),0))",
    "DT39": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP39),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV39, $AR$29), 0))",
    "DU39": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK39),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM184,CC39), $DV39, $AR$29), 0))",
    "DV39": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH39), $AO$29)",
    "DW39": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM39,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39, $DB39), 1),\n\n  DW, $DR39,\n  CL, $DS39,\n  SM, $DT39,\n  SLM, $DU39,\n  SL, $DQ39,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX39": "CY39*(DE39*DO39*DQ39+DW39*DF39)",
    "DZ39": "IF(INDEX($BD$6:$BD184,BT39)=\"\", \"\", INDEX($BD$5:$BD184,BT39+1))",
    "EA39": "IF(OR($AO$25, INDEX($BE$6:$BE184,BU39)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ39)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE184,BU39+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI39*$DJ39*$AQ$9),\n  SuperTower, $DL39,\n  Rend, $DN39,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39, $DB39), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR39,\n  SM, $DT39,\n  SLM, $DU39,\n  SL, $DQ39,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM39, UltCritCard),\n\nCY39*(DE39*OtherDamage*SL+UwDamage*DF39)))",
    "EB39": "IF(INDEX($BF$6:$BF184,BV39)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF184,BV39+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ39,\n  CCUW, $DA39,\n  SCM, $DD39,\n  SCC, $DC39,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39, CF), 1),\n\n  DW, $DR39,\n  CL, $DS39,\n  SM, $DT39,\n  SLM, $DU39,\n  SL, $DQ39,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM39, UltCritCard),\n\nCY39 * (Critical * DO39 * SL + UwDamage * UWCritical)))",
    "EC39": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG184,BW39)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH39,\n  Rapid, DG39,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG184, BW39+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ39*$AQ$9),\n  SuperTower, $DL39,\n  Rend, $DN39,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM184,CC39), $DV39, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM39,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39, $DB39), 1),\n\n  DW, $DR39,\n  CL, $DS39,\n  SM, $DT39,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY39*(DE39*OtherDamage*SL+UWDamage*DF39)))",
    "ED39": "IF(OR($AO$25, INDEX($BH$6:$BH184,BX39)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH184,BX39+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL39, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI39*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM184,CC39), $DV39, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH39,\n  Rapid, DG39,\n  SuperTower, $DL39,\n  Rend, $DN39,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM39,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39, $DB39), 1),\n\n  DW, $DR39,\n  CL, $DS39,\n  SM, $DT39,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY39*(DE39*OtherDamage*SL+UWDamage*DF39)))",
    "EE39": "IF(INDEX($BI$6:$BI184,BY39)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK39, 0),\n  CF, $DB39,\n  CC, $CZ39,\n  CCUW, $DA39,\n  SCM, $DD39,\n  SCC, $AV$17+INDEX($BI$5:$BI184,BY39+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY39 * (Critical*DO39*$DQ39+DW39*UWCritical)))",
    "EF39": "IF(INDEX($BJ$6:$BJ184,BZ39)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK39*1%, 1),\n  CF, $DB39,\n  CC, $CZ39,\n  CCUW, $DA39,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ184,BZ39+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC39,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY39*(Critical*DO39*$DQ39+DW39*UWCritical)))",
    "EG39": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK184,CA39)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH39,\n  Rapid, DG39,\n  DPM, (1+$DI39*$DJ39*$AQ$9),\n  Rend, $DN39,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK184,CA39+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM39*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39, $DB39), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK184,CA39+1)-1))/(45-CM39*3),1),\n\n  SL, $DQ39,\n  DW, $DR39,\n  CL, $DS39,\n  SM, $DT39,\n  SLM, $DU39,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY39*(DE39*OtherDamage*SL+UwDamage*DF39)))",
    "EH39": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL184,CB39+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL184,CB39)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH39,\n  Rapid, DG39,\n  DPM, (1+$DI39*$DJ39*$AQ$9),\n  SuperTower, $DL39,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL184,CB39+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY39*(DE39*OtherDamage*$DQ39+DW39*DF39)))",
    "EI39": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM184,CC39)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39, $DB39), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK39),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV39, $AR$29), 0),\n\n  DW, $DR39,\n  CL, $DS39,\n  SM, $DT39,\n  SL, $DQ39,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM39, UltCritCard),\nCY39*(DE39*DO39*SL+UwDamage*DF39)))",
    "EJ39": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN184,CD39)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT39,\n  DamageMastery, $CS39,\n  DemonMastery, $CX39,\n  SPB, INDEX($BN$5:$BN184,CD39+1),\n  ITO, $CV39,\n  Shock, $CW39,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE39*DO39*$DQ39+DW39*DF39)))",
    "EK39": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO184,CE39)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT39,\n  DamageMastery, $CS39,\n  DemonMastery, $CX39,\n  SPB, $CU39,\n  ITO, INDEX($BO$5:$BO184,CE39+1),\n  Shock, $CW39,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE39*DO39*$DQ39+DW39*DF39)))",
    "EL39": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP184,CF39)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39, $DB39), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP39),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF39),\n  CL, $DS39,\n  SM, $DT39,\n  SLM, $DU39,\n  SL, $DQ39,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM39, UltCritCard),\nCY39*(DE39*DO39*SL+UwDamage*DF39)))",
    "EM39": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ184,CG39)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG39+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN39": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR184,CH39)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39, $DB39), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH39+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP39),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK39),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM184,CC39), SMHeat, $AR$29), 0),\n\n  DW, $DR39,\n  CL, $DS39,\n  SL, $DQ39,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM39, UltCritCard),\nCY39*(DE39*DO39*SL+UwDamage*DF39)))",
    "EO39": "IF(OR(CI39 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI39+1))",
    "EP39": "IF(OR($AO$25, CJ39 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ39+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE183,BU39),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL39, 1),\n  DPM, (1+$DI39*CardRangeMastery*$DJ39*$AQ$9),\n  SuperTower, $DL39,\n  Rend, $DN39,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39, $DB39), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR39,\n  SM, $DT39,\n  SLM, $DU39,\n  SL, $DQ39,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM39, UltCritCard),\n\nCY39*(DE39*OtherDamage*SL+UwDamage*DF39)))",
    "EQ39": "IF(OR(CK39 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK39+1)*1%, 1),\n  CF, $DB39,\n  CC, MIN(100%, $CZ39 + 1%),\n  CCUW, DA39 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ184,BZ39) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC39 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR39,\n  CL, $DS39,\n  SM, $DT39,\n  SLM, $DU39,\n  SL, $DQ39,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM39, UltCritCard),\n\nCY39 * (Critical*DO39*SL+UwDamage*UWCritical)))",
    "ER39": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL39 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH184,BX39),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL39+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI39*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM184,CC39), $DV39, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH39,\n  Rapid, DG39,\n  SuperTower, $DL39,\n  Rend, $DN39,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM39,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39, $DB39), 1),\n\n  DW, $DR39,\n  CL, $DS39,\n  SM, $DT39,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY39*(DE39*OtherDamage*SL+UWDamage*DF39)))",
    "ES39": "IF(OR(CM39 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH39,\n  Rapid, DG39,\n  RDPM, (1+$DI39*$DJ39*$AQ$9),\n  Rend, $DN39,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK184,CA39),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM39+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39, $DB39), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR39,\n  CL, $DS39,\n  SM, $DT39,\n  SLM, $DU39,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY39*(DE39*OtherDamage*SL+UwDamage*DF39)))",
    "ET39": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN39 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM39,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN39+1, $DB39), 1),\n\n  DW, $DR39,\n  CL, $DS39,\n  SM, $DT39,\n  SLM, $DU39,\n  SL, $DQ39,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY39*(DE39*DO39*SL+UWDamage*DF39)))",
    "EU39": "IF(OR(NOT($BA$3), NOT($BA$23), $CO39 > $BA$15), \"\", 1 + 0.5*(CO39+1))",
    "EW39": "IF(DZ39=\"\", \"\", LET(\n  Now, CT39,\n  Next, DZ39,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT39),\nFactor/Cost))",
    "EX39": "IF(EA39=\"\",\"\",(EA39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU39))",
    "EY39": "IF(EB39=\"\",\"\",(EB39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV39))",
    "EZ39": "IF(EC39=\"\",\"\",(EC39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW39))",
    "FA39": "IF(ED39=\"\",\"\",(ED39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX39))",
    "FB39": "IF(EE39=\"\",\"\",(EE39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY39))",
    "FC39": "IF(EF39=\"\",\"\",(EF39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ39))",
    "FD39": "IF(EG39=\"\",\"\",(EG39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA39))",
    "FE39": "IF(EH39=\"\",\"\",(EH39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB39))",
    "FF39": "IF(EI39=\"\",\"\",(EI39/$DX39-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC39+1, 1, CC39))))",
    "FG39": "IF(EJ39=\"\",\"\",(EJ39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD39))",
    "FH39": "IF(EK39=\"\",\"\",(EK39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE39))",
    "FI39": "IF(EL39=\"\",\"\",(EL39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF39))",
    "FJ39": "IF(EM39=\"\", \"\", LET(\n  Now, CW39,\n  Next, EM39,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG39),\nFactor/Cost))",
    "FK39": "IF(EN39=\"\",\"\",(EN39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH39))",
    "FL39": "IF(EO39=\"\", \"\", LET(\n  Now, CS39,\n  Next, EO39,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI39),\nFactor/Cost))",
    "FM39": "IF(EP39=\"\",\"\",(EP39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ39))",
    "FN39": "IF(EQ39=\"\",\"\",(EQ39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK39))",
    "FO39": "IF(ER39=\"\",\"\",(ER39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL39))",
    "FP39": "IF(ES39=\"\",\"\",(ES39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM39))",
    "FQ39": "IF(ET39=\"\",\"\",(ET39/$DX39-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN39))",
    "FR39": "IF(EU39=\"\", \"\", LET(\n  Now, CX39,\n  Next, EU39,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO39),\nFactor/Cost))",
    "FT39": "IF(COLUMN(EW39:FR39) = MIN(IF(EW39:FR39=MAX(EW39:FR39), COLUMN(EW39:FR39))), 1, \"\")",
    "D40": "IF(SUM(FT39:GP39),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F40)),\"Card Mastery\",F40),G40)/$D$5,\"\")",
    "F40": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT39:GP39),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT39:GP39=1)),)\"),\"Damage\")",
    "G40": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT39:GP39),ARRAYFORMULA(FILTER(BT39:CP39 , FT39:GP39=1)),\"\"\"\")\"),9.0)",
    "I40": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT39:GP39),ARRAYFORMULA(FILTER(EW39:FS39 , FT39:GP39=1))*D$5,\"\"\"\")\"),0.11766628534074142)",
    "K40": "IF(H40<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D40)),)",
    "BC40": "BC39+1",
    "BD40": "BD39+BD$3",
    "BE40": "BE39+BE$3",
    "BF40": "BF39+BF$3",
    "BG40": "BG39+BG$3",
    "BH40": "BH39+BH$3",
    "BI40": "BI39+BI$3",
    "BJ40": "BJ39+BJ$3",
    "BT40": "BT39+FT39",
    "BU40": "BU39+FU39",
    "BV40": "BV39+FV39",
    "BW40": "BW39+FW39",
    "BX40": "BX39+FX39",
    "BY40": "BY39+FY39",
    "BZ40": "BZ39+FZ39",
    "CA40": "CA39+GA39",
    "CB40": "CB39+GB39",
    "CC40": "CC39+GC39",
    "CD40": "CD39+GD39",
    "CE40": "CE39+GE39",
    "CF40": "CF39+GF39",
    "CG40": "CG39+GG39",
    "CH40": "CH39+GH39",
    "CI40": "CI39+GI39",
    "CJ40": "CJ39+GJ39",
    "CK40": "CK39+GK39",
    "CL40": "CL39+GL39",
    "CM40": "CM39+GM39",
    "CN40": "CN39+GN39",
    "CO40": "CO39+GO39",
    "CS40": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI40,1)",
    "CT40": "INDEX($BD$5:$BD185,BT40)",
    "CU40": "INDEX($BN$5:$BN185,CD40)",
    "CV40": "INDEX($BO$5:$BO185,CE40)",
    "CW40": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG40)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX40": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO40, 1)",
    "CY40": "LET(\n  Base, $CR$6,\n  Damage, $CT40,\n  DamageMastery, $CS40,\n  DemonMastery, $CX40,\n  SPB, $CU40,\n  ITO, $CV40,\n  Shock, $CW40,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ40": "MIN(100%, DA40)",
    "DA40": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK40*1%, 0)",
    "DB40": "LET(\n  Lab, 1+INDEX($BF$5:$BF185,BV40),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC40": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK40*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI185,BY40) + CardCritMastery)",
    "DD40": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK40*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ185,BZ40) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE40": "LET(\n  CF, $DB40,\n  CC, $CZ40,\n  SCM, $DD40,\n  SCC, $DC40,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF40": "LET(\n  CF, $DB40,\n  CC, $DA40,\n  SCM, $DD40,\n  SCC, $DC40,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG40": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH40)), 0)",
    "DH40": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ40*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE185,BU40),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI40": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG185, BW40), 1) + $AE$9)",
    "DJ40": "LET(\n  DpmLab, INDEX($BH$5:$BH185,BX40),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL40, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK40": "(1+$DI40*$DJ40*$AQ$9)",
    "DL40": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK185,CA40),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM40*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM40": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK185,CA40),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM40*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN40": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL185,CB40)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO40": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH40,\n  Rapid, DG40,\n  RDPM, DK40,\n  SuperTower, $DL40,\n  Rend, $DN40,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP40": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ40": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK40),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR40": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP40),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF40-1))",
    "DS40": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG40, DH40),0))",
    "DT40": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP40),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV40, $AR$29), 0))",
    "DU40": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK40),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM185,CC40), $DV40, $AR$29), 0))",
    "DV40": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH40), $AO$29)",
    "DW40": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM40,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40, $DB40), 1),\n\n  DW, $DR40,\n  CL, $DS40,\n  SM, $DT40,\n  SLM, $DU40,\n  SL, $DQ40,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX40": "CY40*(DE40*DO40*DQ40+DW40*DF40)",
    "DZ40": "IF(INDEX($BD$6:$BD185,BT40)=\"\", \"\", INDEX($BD$5:$BD185,BT40+1))",
    "EA40": "IF(OR($AO$25, INDEX($BE$6:$BE185,BU40)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ40)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE185,BU40+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI40*$DJ40*$AQ$9),\n  SuperTower, $DL40,\n  Rend, $DN40,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40, $DB40), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR40,\n  SM, $DT40,\n  SLM, $DU40,\n  SL, $DQ40,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM40, UltCritCard),\n\nCY40*(DE40*OtherDamage*SL+UwDamage*DF40)))",
    "EB40": "IF(INDEX($BF$6:$BF185,BV40)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF185,BV40+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ40,\n  CCUW, $DA40,\n  SCM, $DD40,\n  SCC, $DC40,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40, CF), 1),\n\n  DW, $DR40,\n  CL, $DS40,\n  SM, $DT40,\n  SLM, $DU40,\n  SL, $DQ40,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM40, UltCritCard),\n\nCY40 * (Critical * DO40 * SL + UwDamage * UWCritical)))",
    "EC40": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG185,BW40)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH40,\n  Rapid, DG40,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG185, BW40+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ40*$AQ$9),\n  SuperTower, $DL40,\n  Rend, $DN40,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM185,CC40), $DV40, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM40,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40, $DB40), 1),\n\n  DW, $DR40,\n  CL, $DS40,\n  SM, $DT40,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY40*(DE40*OtherDamage*SL+UWDamage*DF40)))",
    "ED40": "IF(OR($AO$25, INDEX($BH$6:$BH185,BX40)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH185,BX40+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL40, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI40*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM185,CC40), $DV40, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH40,\n  Rapid, DG40,\n  SuperTower, $DL40,\n  Rend, $DN40,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM40,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40, $DB40), 1),\n\n  DW, $DR40,\n  CL, $DS40,\n  SM, $DT40,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY40*(DE40*OtherDamage*SL+UWDamage*DF40)))",
    "EE40": "IF(INDEX($BI$6:$BI185,BY40)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK40, 0),\n  CF, $DB40,\n  CC, $CZ40,\n  CCUW, $DA40,\n  SCM, $DD40,\n  SCC, $AV$17+INDEX($BI$5:$BI185,BY40+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY40 * (Critical*DO40*$DQ40+DW40*UWCritical)))",
    "EF40": "IF(INDEX($BJ$6:$BJ185,BZ40)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK40*1%, 1),\n  CF, $DB40,\n  CC, $CZ40,\n  CCUW, $DA40,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ185,BZ40+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC40,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY40*(Critical*DO40*$DQ40+DW40*UWCritical)))",
    "EG40": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK185,CA40)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH40,\n  Rapid, DG40,\n  DPM, (1+$DI40*$DJ40*$AQ$9),\n  Rend, $DN40,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK185,CA40+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM40*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40, $DB40), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK185,CA40+1)-1))/(45-CM40*3),1),\n\n  SL, $DQ40,\n  DW, $DR40,\n  CL, $DS40,\n  SM, $DT40,\n  SLM, $DU40,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY40*(DE40*OtherDamage*SL+UwDamage*DF40)))",
    "EH40": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL185,CB40+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL185,CB40)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH40,\n  Rapid, DG40,\n  DPM, (1+$DI40*$DJ40*$AQ$9),\n  SuperTower, $DL40,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL185,CB40+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY40*(DE40*OtherDamage*$DQ40+DW40*DF40)))",
    "EI40": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM185,CC40)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40, $DB40), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK40),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV40, $AR$29), 0),\n\n  DW, $DR40,\n  CL, $DS40,\n  SM, $DT40,\n  SL, $DQ40,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM40, UltCritCard),\nCY40*(DE40*DO40*SL+UwDamage*DF40)))",
    "EJ40": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN185,CD40)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT40,\n  DamageMastery, $CS40,\n  DemonMastery, $CX40,\n  SPB, INDEX($BN$5:$BN185,CD40+1),\n  ITO, $CV40,\n  Shock, $CW40,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE40*DO40*$DQ40+DW40*DF40)))",
    "EK40": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO185,CE40)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT40,\n  DamageMastery, $CS40,\n  DemonMastery, $CX40,\n  SPB, $CU40,\n  ITO, INDEX($BO$5:$BO185,CE40+1),\n  Shock, $CW40,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE40*DO40*$DQ40+DW40*DF40)))",
    "EL40": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP185,CF40)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40, $DB40), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP40),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF40),\n  CL, $DS40,\n  SM, $DT40,\n  SLM, $DU40,\n  SL, $DQ40,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM40, UltCritCard),\nCY40*(DE40*DO40*SL+UwDamage*DF40)))",
    "EM40": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ185,CG40)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG40+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN40": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR185,CH40)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40, $DB40), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH40+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP40),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK40),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM185,CC40), SMHeat, $AR$29), 0),\n\n  DW, $DR40,\n  CL, $DS40,\n  SL, $DQ40,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM40, UltCritCard),\nCY40*(DE40*DO40*SL+UwDamage*DF40)))",
    "EO40": "IF(OR(CI40 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI40+1))",
    "EP40": "IF(OR($AO$25, CJ40 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ40+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE184,BU40),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL40, 1),\n  DPM, (1+$DI40*CardRangeMastery*$DJ40*$AQ$9),\n  SuperTower, $DL40,\n  Rend, $DN40,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40, $DB40), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR40,\n  SM, $DT40,\n  SLM, $DU40,\n  SL, $DQ40,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM40, UltCritCard),\n\nCY40*(DE40*OtherDamage*SL+UwDamage*DF40)))",
    "EQ40": "IF(OR(CK40 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK40+1)*1%, 1),\n  CF, $DB40,\n  CC, MIN(100%, $CZ40 + 1%),\n  CCUW, DA40 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ185,BZ40) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC40 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR40,\n  CL, $DS40,\n  SM, $DT40,\n  SLM, $DU40,\n  SL, $DQ40,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM40, UltCritCard),\n\nCY40 * (Critical*DO40*SL+UwDamage*UWCritical)))",
    "ER40": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL40 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH185,BX40),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL40+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI40*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM185,CC40), $DV40, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH40,\n  Rapid, DG40,\n  SuperTower, $DL40,\n  Rend, $DN40,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM40,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40, $DB40), 1),\n\n  DW, $DR40,\n  CL, $DS40,\n  SM, $DT40,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY40*(DE40*OtherDamage*SL+UWDamage*DF40)))",
    "ES40": "IF(OR(CM40 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH40,\n  Rapid, DG40,\n  RDPM, (1+$DI40*$DJ40*$AQ$9),\n  Rend, $DN40,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK185,CA40),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM40+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40, $DB40), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR40,\n  CL, $DS40,\n  SM, $DT40,\n  SLM, $DU40,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY40*(DE40*OtherDamage*SL+UwDamage*DF40)))",
    "ET40": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN40 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM40,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN40+1, $DB40), 1),\n\n  DW, $DR40,\n  CL, $DS40,\n  SM, $DT40,\n  SLM, $DU40,\n  SL, $DQ40,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY40*(DE40*DO40*SL+UWDamage*DF40)))",
    "EU40": "IF(OR(NOT($BA$3), NOT($BA$23), $CO40 > $BA$15), \"\", 1 + 0.5*(CO40+1))",
    "EW40": "IF(DZ40=\"\", \"\", LET(\n  Now, CT40,\n  Next, DZ40,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT40),\nFactor/Cost))",
    "EX40": "IF(EA40=\"\",\"\",(EA40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU40))",
    "EY40": "IF(EB40=\"\",\"\",(EB40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV40))",
    "EZ40": "IF(EC40=\"\",\"\",(EC40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW40))",
    "FA40": "IF(ED40=\"\",\"\",(ED40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX40))",
    "FB40": "IF(EE40=\"\",\"\",(EE40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY40))",
    "FC40": "IF(EF40=\"\",\"\",(EF40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ40))",
    "FD40": "IF(EG40=\"\",\"\",(EG40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA40))",
    "FE40": "IF(EH40=\"\",\"\",(EH40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB40))",
    "FF40": "IF(EI40=\"\",\"\",(EI40/$DX40-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC40+1, 1, CC40))))",
    "FG40": "IF(EJ40=\"\",\"\",(EJ40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD40))",
    "FH40": "IF(EK40=\"\",\"\",(EK40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE40))",
    "FI40": "IF(EL40=\"\",\"\",(EL40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF40))",
    "FJ40": "IF(EM40=\"\", \"\", LET(\n  Now, CW40,\n  Next, EM40,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG40),\nFactor/Cost))",
    "FK40": "IF(EN40=\"\",\"\",(EN40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH40))",
    "FL40": "IF(EO40=\"\", \"\", LET(\n  Now, CS40,\n  Next, EO40,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI40),\nFactor/Cost))",
    "FM40": "IF(EP40=\"\",\"\",(EP40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ40))",
    "FN40": "IF(EQ40=\"\",\"\",(EQ40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK40))",
    "FO40": "IF(ER40=\"\",\"\",(ER40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL40))",
    "FP40": "IF(ES40=\"\",\"\",(ES40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM40))",
    "FQ40": "IF(ET40=\"\",\"\",(ET40/$DX40-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN40))",
    "FR40": "IF(EU40=\"\", \"\", LET(\n  Now, CX40,\n  Next, EU40,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO40),\nFactor/Cost))",
    "FT40": "IF(COLUMN(EW40:FR40) = MIN(IF(EW40:FR40=MAX(EW40:FR40), COLUMN(EW40:FR40))), 1, \"\")",
    "D41": "IF(SUM(FT40:GP40),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F41)),\"Card Mastery\",F41),G41)/$D$5,\"\")",
    "F41": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT40:GP40),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT40:GP40=1)),)\"),\"Critical Factor\")",
    "G41": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT40:GP40),ARRAYFORMULA(FILTER(BT40:CP40 , FT40:GP40=1)),\"\"\"\")\"),11.0)",
    "I41": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT40:GP40),ARRAYFORMULA(FILTER(EW40:FS40 , FT40:GP40=1))*D$5,\"\"\"\")\"),0.09693722205298327)",
    "K41": "IF(H41<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D41)),)",
    "BC41": "BC40+1",
    "BD41": "BD40+BD$3",
    "BE41": "BE40+BE$3",
    "BF41": "BF40+BF$3",
    "BG41": "BG40+BG$3",
    "BH41": "BH40+BH$3",
    "BI41": "BI40+BI$3",
    "BJ41": "BJ40+BJ$3",
    "BT41": "BT40+FT40",
    "BU41": "BU40+FU40",
    "BV41": "BV40+FV40",
    "BW41": "BW40+FW40",
    "BX41": "BX40+FX40",
    "BY41": "BY40+FY40",
    "BZ41": "BZ40+FZ40",
    "CA41": "CA40+GA40",
    "CB41": "CB40+GB40",
    "CC41": "CC40+GC40",
    "CD41": "CD40+GD40",
    "CE41": "CE40+GE40",
    "CF41": "CF40+GF40",
    "CG41": "CG40+GG40",
    "CH41": "CH40+GH40",
    "CI41": "CI40+GI40",
    "CJ41": "CJ40+GJ40",
    "CK41": "CK40+GK40",
    "CL41": "CL40+GL40",
    "CM41": "CM40+GM40",
    "CN41": "CN40+GN40",
    "CO41": "CO40+GO40",
    "CS41": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI41,1)",
    "CT41": "INDEX($BD$5:$BD186,BT41)",
    "CU41": "INDEX($BN$5:$BN186,CD41)",
    "CV41": "INDEX($BO$5:$BO186,CE41)",
    "CW41": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG41)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX41": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO41, 1)",
    "CY41": "LET(\n  Base, $CR$6,\n  Damage, $CT41,\n  DamageMastery, $CS41,\n  DemonMastery, $CX41,\n  SPB, $CU41,\n  ITO, $CV41,\n  Shock, $CW41,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ41": "MIN(100%, DA41)",
    "DA41": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK41*1%, 0)",
    "DB41": "LET(\n  Lab, 1+INDEX($BF$5:$BF186,BV41),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC41": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK41*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI186,BY41) + CardCritMastery)",
    "DD41": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK41*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ186,BZ41) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE41": "LET(\n  CF, $DB41,\n  CC, $CZ41,\n  SCM, $DD41,\n  SCC, $DC41,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF41": "LET(\n  CF, $DB41,\n  CC, $DA41,\n  SCM, $DD41,\n  SCC, $DC41,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG41": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH41)), 0)",
    "DH41": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ41*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE186,BU41),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI41": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG186, BW41), 1) + $AE$9)",
    "DJ41": "LET(\n  DpmLab, INDEX($BH$5:$BH186,BX41),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL41, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK41": "(1+$DI41*$DJ41*$AQ$9)",
    "DL41": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK186,CA41),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM41*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM41": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK186,CA41),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM41*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN41": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL186,CB41)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO41": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH41,\n  Rapid, DG41,\n  RDPM, DK41,\n  SuperTower, $DL41,\n  Rend, $DN41,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP41": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ41": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK41),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR41": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP41),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF41-1))",
    "DS41": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG41, DH41),0))",
    "DT41": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP41),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV41, $AR$29), 0))",
    "DU41": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK41),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM186,CC41), $DV41, $AR$29), 0))",
    "DV41": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH41), $AO$29)",
    "DW41": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM41,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41, $DB41), 1),\n\n  DW, $DR41,\n  CL, $DS41,\n  SM, $DT41,\n  SLM, $DU41,\n  SL, $DQ41,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX41": "CY41*(DE41*DO41*DQ41+DW41*DF41)",
    "DZ41": "IF(INDEX($BD$6:$BD186,BT41)=\"\", \"\", INDEX($BD$5:$BD186,BT41+1))",
    "EA41": "IF(OR($AO$25, INDEX($BE$6:$BE186,BU41)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ41)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE186,BU41+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI41*$DJ41*$AQ$9),\n  SuperTower, $DL41,\n  Rend, $DN41,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41, $DB41), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR41,\n  SM, $DT41,\n  SLM, $DU41,\n  SL, $DQ41,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM41, UltCritCard),\n\nCY41*(DE41*OtherDamage*SL+UwDamage*DF41)))",
    "EB41": "IF(INDEX($BF$6:$BF186,BV41)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF186,BV41+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ41,\n  CCUW, $DA41,\n  SCM, $DD41,\n  SCC, $DC41,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41, CF), 1),\n\n  DW, $DR41,\n  CL, $DS41,\n  SM, $DT41,\n  SLM, $DU41,\n  SL, $DQ41,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM41, UltCritCard),\n\nCY41 * (Critical * DO41 * SL + UwDamage * UWCritical)))",
    "EC41": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG186,BW41)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH41,\n  Rapid, DG41,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG186, BW41+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ41*$AQ$9),\n  SuperTower, $DL41,\n  Rend, $DN41,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM186,CC41), $DV41, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM41,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41, $DB41), 1),\n\n  DW, $DR41,\n  CL, $DS41,\n  SM, $DT41,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY41*(DE41*OtherDamage*SL+UWDamage*DF41)))",
    "ED41": "IF(OR($AO$25, INDEX($BH$6:$BH186,BX41)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH186,BX41+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL41, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI41*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM186,CC41), $DV41, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH41,\n  Rapid, DG41,\n  SuperTower, $DL41,\n  Rend, $DN41,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM41,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41, $DB41), 1),\n\n  DW, $DR41,\n  CL, $DS41,\n  SM, $DT41,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY41*(DE41*OtherDamage*SL+UWDamage*DF41)))",
    "EE41": "IF(INDEX($BI$6:$BI186,BY41)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK41, 0),\n  CF, $DB41,\n  CC, $CZ41,\n  CCUW, $DA41,\n  SCM, $DD41,\n  SCC, $AV$17+INDEX($BI$5:$BI186,BY41+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY41 * (Critical*DO41*$DQ41+DW41*UWCritical)))",
    "EF41": "IF(INDEX($BJ$6:$BJ186,BZ41)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK41*1%, 1),\n  CF, $DB41,\n  CC, $CZ41,\n  CCUW, $DA41,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ186,BZ41+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC41,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY41*(Critical*DO41*$DQ41+DW41*UWCritical)))",
    "EG41": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK186,CA41)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH41,\n  Rapid, DG41,\n  DPM, (1+$DI41*$DJ41*$AQ$9),\n  Rend, $DN41,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK186,CA41+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM41*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41, $DB41), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK186,CA41+1)-1))/(45-CM41*3),1),\n\n  SL, $DQ41,\n  DW, $DR41,\n  CL, $DS41,\n  SM, $DT41,\n  SLM, $DU41,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY41*(DE41*OtherDamage*SL+UwDamage*DF41)))",
    "EH41": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL186,CB41+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL186,CB41)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH41,\n  Rapid, DG41,\n  DPM, (1+$DI41*$DJ41*$AQ$9),\n  SuperTower, $DL41,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL186,CB41+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY41*(DE41*OtherDamage*$DQ41+DW41*DF41)))",
    "EI41": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM186,CC41)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41, $DB41), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK41),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV41, $AR$29), 0),\n\n  DW, $DR41,\n  CL, $DS41,\n  SM, $DT41,\n  SL, $DQ41,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM41, UltCritCard),\nCY41*(DE41*DO41*SL+UwDamage*DF41)))",
    "EJ41": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN186,CD41)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT41,\n  DamageMastery, $CS41,\n  DemonMastery, $CX41,\n  SPB, INDEX($BN$5:$BN186,CD41+1),\n  ITO, $CV41,\n  Shock, $CW41,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE41*DO41*$DQ41+DW41*DF41)))",
    "EK41": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO186,CE41)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT41,\n  DamageMastery, $CS41,\n  DemonMastery, $CX41,\n  SPB, $CU41,\n  ITO, INDEX($BO$5:$BO186,CE41+1),\n  Shock, $CW41,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE41*DO41*$DQ41+DW41*DF41)))",
    "EL41": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP186,CF41)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41, $DB41), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP41),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF41),\n  CL, $DS41,\n  SM, $DT41,\n  SLM, $DU41,\n  SL, $DQ41,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM41, UltCritCard),\nCY41*(DE41*DO41*SL+UwDamage*DF41)))",
    "EM41": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ186,CG41)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG41+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN41": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR186,CH41)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41, $DB41), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH41+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP41),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK41),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM186,CC41), SMHeat, $AR$29), 0),\n\n  DW, $DR41,\n  CL, $DS41,\n  SL, $DQ41,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM41, UltCritCard),\nCY41*(DE41*DO41*SL+UwDamage*DF41)))",
    "EO41": "IF(OR(CI41 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI41+1))",
    "EP41": "IF(OR($AO$25, CJ41 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ41+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE185,BU41),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL41, 1),\n  DPM, (1+$DI41*CardRangeMastery*$DJ41*$AQ$9),\n  SuperTower, $DL41,\n  Rend, $DN41,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41, $DB41), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR41,\n  SM, $DT41,\n  SLM, $DU41,\n  SL, $DQ41,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM41, UltCritCard),\n\nCY41*(DE41*OtherDamage*SL+UwDamage*DF41)))",
    "EQ41": "IF(OR(CK41 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK41+1)*1%, 1),\n  CF, $DB41,\n  CC, MIN(100%, $CZ41 + 1%),\n  CCUW, DA41 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ186,BZ41) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC41 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR41,\n  CL, $DS41,\n  SM, $DT41,\n  SLM, $DU41,\n  SL, $DQ41,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM41, UltCritCard),\n\nCY41 * (Critical*DO41*SL+UwDamage*UWCritical)))",
    "ER41": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL41 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH186,BX41),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL41+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI41*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM186,CC41), $DV41, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH41,\n  Rapid, DG41,\n  SuperTower, $DL41,\n  Rend, $DN41,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM41,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41, $DB41), 1),\n\n  DW, $DR41,\n  CL, $DS41,\n  SM, $DT41,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY41*(DE41*OtherDamage*SL+UWDamage*DF41)))",
    "ES41": "IF(OR(CM41 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH41,\n  Rapid, DG41,\n  RDPM, (1+$DI41*$DJ41*$AQ$9),\n  Rend, $DN41,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK186,CA41),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM41+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41, $DB41), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR41,\n  CL, $DS41,\n  SM, $DT41,\n  SLM, $DU41,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY41*(DE41*OtherDamage*SL+UwDamage*DF41)))",
    "ET41": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN41 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM41,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN41+1, $DB41), 1),\n\n  DW, $DR41,\n  CL, $DS41,\n  SM, $DT41,\n  SLM, $DU41,\n  SL, $DQ41,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY41*(DE41*DO41*SL+UWDamage*DF41)))",
    "EU41": "IF(OR(NOT($BA$3), NOT($BA$23), $CO41 > $BA$15), \"\", 1 + 0.5*(CO41+1))",
    "EW41": "IF(DZ41=\"\", \"\", LET(\n  Now, CT41,\n  Next, DZ41,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT41),\nFactor/Cost))",
    "EX41": "IF(EA41=\"\",\"\",(EA41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU41))",
    "EY41": "IF(EB41=\"\",\"\",(EB41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV41))",
    "EZ41": "IF(EC41=\"\",\"\",(EC41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW41))",
    "FA41": "IF(ED41=\"\",\"\",(ED41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX41))",
    "FB41": "IF(EE41=\"\",\"\",(EE41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY41))",
    "FC41": "IF(EF41=\"\",\"\",(EF41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ41))",
    "FD41": "IF(EG41=\"\",\"\",(EG41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA41))",
    "FE41": "IF(EH41=\"\",\"\",(EH41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB41))",
    "FF41": "IF(EI41=\"\",\"\",(EI41/$DX41-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC41+1, 1, CC41))))",
    "FG41": "IF(EJ41=\"\",\"\",(EJ41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD41))",
    "FH41": "IF(EK41=\"\",\"\",(EK41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE41))",
    "FI41": "IF(EL41=\"\",\"\",(EL41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF41))",
    "FJ41": "IF(EM41=\"\", \"\", LET(\n  Now, CW41,\n  Next, EM41,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG41),\nFactor/Cost))",
    "FK41": "IF(EN41=\"\",\"\",(EN41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH41))",
    "FL41": "IF(EO41=\"\", \"\", LET(\n  Now, CS41,\n  Next, EO41,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI41),\nFactor/Cost))",
    "FM41": "IF(EP41=\"\",\"\",(EP41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ41))",
    "FN41": "IF(EQ41=\"\",\"\",(EQ41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK41))",
    "FO41": "IF(ER41=\"\",\"\",(ER41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL41))",
    "FP41": "IF(ES41=\"\",\"\",(ES41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM41))",
    "FQ41": "IF(ET41=\"\",\"\",(ET41/$DX41-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN41))",
    "FR41": "IF(EU41=\"\", \"\", LET(\n  Now, CX41,\n  Next, EU41,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO41),\nFactor/Cost))",
    "FT41": "IF(COLUMN(EW41:FR41) = MIN(IF(EW41:FR41=MAX(EW41:FR41), COLUMN(EW41:FR41))), 1, \"\")",
    "D42": "IF(SUM(FT41:GP41),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F42)),\"Card Mastery\",F42),G42)/$D$5,\"\")",
    "F42": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT41:GP41),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT41:GP41=1)),)\"),\"Damage / Meter\")",
    "G42": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT41:GP41),ARRAYFORMULA(FILTER(BT41:CP41 , FT41:GP41=1)),\"\"\"\")\"),7.0)",
    "I42": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT41:GP41),ARRAYFORMULA(FILTER(EW41:FS41 , FT41:GP41=1))*D$5,\"\"\"\")\"),0.09151184812954496)",
    "K42": "IF(H42<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D42)),)",
    "BC42": "BC41+1",
    "BD42": "BD41+BD$3",
    "BE42": "BE41+BE$3",
    "BF42": "BF41+BF$3",
    "BG42": "BG41+BG$3",
    "BH42": "BH41+BH$3",
    "BI42": "BI41+BI$3",
    "BJ42": "BJ41+BJ$3",
    "BT42": "BT41+FT41",
    "BU42": "BU41+FU41",
    "BV42": "BV41+FV41",
    "BW42": "BW41+FW41",
    "BX42": "BX41+FX41",
    "BY42": "BY41+FY41",
    "BZ42": "BZ41+FZ41",
    "CA42": "CA41+GA41",
    "CB42": "CB41+GB41",
    "CC42": "CC41+GC41",
    "CD42": "CD41+GD41",
    "CE42": "CE41+GE41",
    "CF42": "CF41+GF41",
    "CG42": "CG41+GG41",
    "CH42": "CH41+GH41",
    "CI42": "CI41+GI41",
    "CJ42": "CJ41+GJ41",
    "CK42": "CK41+GK41",
    "CL42": "CL41+GL41",
    "CM42": "CM41+GM41",
    "CN42": "CN41+GN41",
    "CO42": "CO41+GO41",
    "CS42": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI42,1)",
    "CT42": "INDEX($BD$5:$BD187,BT42)",
    "CU42": "INDEX($BN$5:$BN187,CD42)",
    "CV42": "INDEX($BO$5:$BO187,CE42)",
    "CW42": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG42)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX42": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO42, 1)",
    "CY42": "LET(\n  Base, $CR$6,\n  Damage, $CT42,\n  DamageMastery, $CS42,\n  DemonMastery, $CX42,\n  SPB, $CU42,\n  ITO, $CV42,\n  Shock, $CW42,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ42": "MIN(100%, DA42)",
    "DA42": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK42*1%, 0)",
    "DB42": "LET(\n  Lab, 1+INDEX($BF$5:$BF187,BV42),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC42": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK42*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI187,BY42) + CardCritMastery)",
    "DD42": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK42*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ187,BZ42) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE42": "LET(\n  CF, $DB42,\n  CC, $CZ42,\n  SCM, $DD42,\n  SCC, $DC42,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF42": "LET(\n  CF, $DB42,\n  CC, $DA42,\n  SCM, $DD42,\n  SCC, $DC42,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG42": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH42)), 0)",
    "DH42": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ42*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE187,BU42),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI42": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG187, BW42), 1) + $AE$9)",
    "DJ42": "LET(\n  DpmLab, INDEX($BH$5:$BH187,BX42),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL42, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK42": "(1+$DI42*$DJ42*$AQ$9)",
    "DL42": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK187,CA42),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM42*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM42": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK187,CA42),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM42*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN42": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL187,CB42)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO42": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH42,\n  Rapid, DG42,\n  RDPM, DK42,\n  SuperTower, $DL42,\n  Rend, $DN42,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP42": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ42": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK42),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR42": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP42),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF42-1))",
    "DS42": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG42, DH42),0))",
    "DT42": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP42),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV42, $AR$29), 0))",
    "DU42": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK42),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM187,CC42), $DV42, $AR$29), 0))",
    "DV42": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH42), $AO$29)",
    "DW42": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM42,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42, $DB42), 1),\n\n  DW, $DR42,\n  CL, $DS42,\n  SM, $DT42,\n  SLM, $DU42,\n  SL, $DQ42,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX42": "CY42*(DE42*DO42*DQ42+DW42*DF42)",
    "DZ42": "IF(INDEX($BD$6:$BD187,BT42)=\"\", \"\", INDEX($BD$5:$BD187,BT42+1))",
    "EA42": "IF(OR($AO$25, INDEX($BE$6:$BE187,BU42)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ42)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE187,BU42+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI42*$DJ42*$AQ$9),\n  SuperTower, $DL42,\n  Rend, $DN42,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42, $DB42), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR42,\n  SM, $DT42,\n  SLM, $DU42,\n  SL, $DQ42,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM42, UltCritCard),\n\nCY42*(DE42*OtherDamage*SL+UwDamage*DF42)))",
    "EB42": "IF(INDEX($BF$6:$BF187,BV42)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF187,BV42+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ42,\n  CCUW, $DA42,\n  SCM, $DD42,\n  SCC, $DC42,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42, CF), 1),\n\n  DW, $DR42,\n  CL, $DS42,\n  SM, $DT42,\n  SLM, $DU42,\n  SL, $DQ42,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM42, UltCritCard),\n\nCY42 * (Critical * DO42 * SL + UwDamage * UWCritical)))",
    "EC42": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG187,BW42)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH42,\n  Rapid, DG42,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG187, BW42+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ42*$AQ$9),\n  SuperTower, $DL42,\n  Rend, $DN42,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM187,CC42), $DV42, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM42,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42, $DB42), 1),\n\n  DW, $DR42,\n  CL, $DS42,\n  SM, $DT42,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY42*(DE42*OtherDamage*SL+UWDamage*DF42)))",
    "ED42": "IF(OR($AO$25, INDEX($BH$6:$BH187,BX42)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH187,BX42+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL42, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI42*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM187,CC42), $DV42, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH42,\n  Rapid, DG42,\n  SuperTower, $DL42,\n  Rend, $DN42,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM42,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42, $DB42), 1),\n\n  DW, $DR42,\n  CL, $DS42,\n  SM, $DT42,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY42*(DE42*OtherDamage*SL+UWDamage*DF42)))",
    "EE42": "IF(INDEX($BI$6:$BI187,BY42)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK42, 0),\n  CF, $DB42,\n  CC, $CZ42,\n  CCUW, $DA42,\n  SCM, $DD42,\n  SCC, $AV$17+INDEX($BI$5:$BI187,BY42+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY42 * (Critical*DO42*$DQ42+DW42*UWCritical)))",
    "EF42": "IF(INDEX($BJ$6:$BJ187,BZ42)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK42*1%, 1),\n  CF, $DB42,\n  CC, $CZ42,\n  CCUW, $DA42,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ187,BZ42+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC42,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY42*(Critical*DO42*$DQ42+DW42*UWCritical)))",
    "EG42": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK187,CA42)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH42,\n  Rapid, DG42,\n  DPM, (1+$DI42*$DJ42*$AQ$9),\n  Rend, $DN42,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK187,CA42+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM42*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42, $DB42), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK187,CA42+1)-1))/(45-CM42*3),1),\n\n  SL, $DQ42,\n  DW, $DR42,\n  CL, $DS42,\n  SM, $DT42,\n  SLM, $DU42,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY42*(DE42*OtherDamage*SL+UwDamage*DF42)))",
    "EH42": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL187,CB42+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL187,CB42)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH42,\n  Rapid, DG42,\n  DPM, (1+$DI42*$DJ42*$AQ$9),\n  SuperTower, $DL42,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL187,CB42+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY42*(DE42*OtherDamage*$DQ42+DW42*DF42)))",
    "EI42": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM187,CC42)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42, $DB42), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK42),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV42, $AR$29), 0),\n\n  DW, $DR42,\n  CL, $DS42,\n  SM, $DT42,\n  SL, $DQ42,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM42, UltCritCard),\nCY42*(DE42*DO42*SL+UwDamage*DF42)))",
    "EJ42": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN187,CD42)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT42,\n  DamageMastery, $CS42,\n  DemonMastery, $CX42,\n  SPB, INDEX($BN$5:$BN187,CD42+1),\n  ITO, $CV42,\n  Shock, $CW42,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE42*DO42*$DQ42+DW42*DF42)))",
    "EK42": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO187,CE42)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT42,\n  DamageMastery, $CS42,\n  DemonMastery, $CX42,\n  SPB, $CU42,\n  ITO, INDEX($BO$5:$BO187,CE42+1),\n  Shock, $CW42,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE42*DO42*$DQ42+DW42*DF42)))",
    "EL42": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP187,CF42)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42, $DB42), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP42),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF42),\n  CL, $DS42,\n  SM, $DT42,\n  SLM, $DU42,\n  SL, $DQ42,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM42, UltCritCard),\nCY42*(DE42*DO42*SL+UwDamage*DF42)))",
    "EM42": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ187,CG42)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG42+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN42": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR187,CH42)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42, $DB42), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH42+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP42),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK42),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM187,CC42), SMHeat, $AR$29), 0),\n\n  DW, $DR42,\n  CL, $DS42,\n  SL, $DQ42,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM42, UltCritCard),\nCY42*(DE42*DO42*SL+UwDamage*DF42)))",
    "EO42": "IF(OR(CI42 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI42+1))",
    "EP42": "IF(OR($AO$25, CJ42 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ42+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE186,BU42),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL42, 1),\n  DPM, (1+$DI42*CardRangeMastery*$DJ42*$AQ$9),\n  SuperTower, $DL42,\n  Rend, $DN42,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42, $DB42), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR42,\n  SM, $DT42,\n  SLM, $DU42,\n  SL, $DQ42,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM42, UltCritCard),\n\nCY42*(DE42*OtherDamage*SL+UwDamage*DF42)))",
    "EQ42": "IF(OR(CK42 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK42+1)*1%, 1),\n  CF, $DB42,\n  CC, MIN(100%, $CZ42 + 1%),\n  CCUW, DA42 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ187,BZ42) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC42 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR42,\n  CL, $DS42,\n  SM, $DT42,\n  SLM, $DU42,\n  SL, $DQ42,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM42, UltCritCard),\n\nCY42 * (Critical*DO42*SL+UwDamage*UWCritical)))",
    "ER42": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL42 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH187,BX42),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL42+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI42*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM187,CC42), $DV42, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH42,\n  Rapid, DG42,\n  SuperTower, $DL42,\n  Rend, $DN42,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM42,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42, $DB42), 1),\n\n  DW, $DR42,\n  CL, $DS42,\n  SM, $DT42,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY42*(DE42*OtherDamage*SL+UWDamage*DF42)))",
    "ES42": "IF(OR(CM42 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH42,\n  Rapid, DG42,\n  RDPM, (1+$DI42*$DJ42*$AQ$9),\n  Rend, $DN42,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK187,CA42),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM42+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42, $DB42), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR42,\n  CL, $DS42,\n  SM, $DT42,\n  SLM, $DU42,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY42*(DE42*OtherDamage*SL+UwDamage*DF42)))",
    "ET42": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN42 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM42,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN42+1, $DB42), 1),\n\n  DW, $DR42,\n  CL, $DS42,\n  SM, $DT42,\n  SLM, $DU42,\n  SL, $DQ42,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY42*(DE42*DO42*SL+UWDamage*DF42)))",
    "EU42": "IF(OR(NOT($BA$3), NOT($BA$23), $CO42 > $BA$15), \"\", 1 + 0.5*(CO42+1))",
    "EW42": "IF(DZ42=\"\", \"\", LET(\n  Now, CT42,\n  Next, DZ42,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT42),\nFactor/Cost))",
    "EX42": "IF(EA42=\"\",\"\",(EA42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU42))",
    "EY42": "IF(EB42=\"\",\"\",(EB42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV42))",
    "EZ42": "IF(EC42=\"\",\"\",(EC42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW42))",
    "FA42": "IF(ED42=\"\",\"\",(ED42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX42))",
    "FB42": "IF(EE42=\"\",\"\",(EE42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY42))",
    "FC42": "IF(EF42=\"\",\"\",(EF42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ42))",
    "FD42": "IF(EG42=\"\",\"\",(EG42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA42))",
    "FE42": "IF(EH42=\"\",\"\",(EH42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB42))",
    "FF42": "IF(EI42=\"\",\"\",(EI42/$DX42-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC42+1, 1, CC42))))",
    "FG42": "IF(EJ42=\"\",\"\",(EJ42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD42))",
    "FH42": "IF(EK42=\"\",\"\",(EK42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE42))",
    "FI42": "IF(EL42=\"\",\"\",(EL42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF42))",
    "FJ42": "IF(EM42=\"\", \"\", LET(\n  Now, CW42,\n  Next, EM42,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG42),\nFactor/Cost))",
    "FK42": "IF(EN42=\"\",\"\",(EN42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH42))",
    "FL42": "IF(EO42=\"\", \"\", LET(\n  Now, CS42,\n  Next, EO42,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI42),\nFactor/Cost))",
    "FM42": "IF(EP42=\"\",\"\",(EP42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ42))",
    "FN42": "IF(EQ42=\"\",\"\",(EQ42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK42))",
    "FO42": "IF(ER42=\"\",\"\",(ER42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL42))",
    "FP42": "IF(ES42=\"\",\"\",(ES42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM42))",
    "FQ42": "IF(ET42=\"\",\"\",(ET42/$DX42-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN42))",
    "FR42": "IF(EU42=\"\", \"\", LET(\n  Now, CX42,\n  Next, EU42,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO42),\nFactor/Cost))",
    "FT42": "IF(COLUMN(EW42:FR42) = MIN(IF(EW42:FR42=MAX(EW42:FR42), COLUMN(EW42:FR42))), 1, \"\")",
    "D43": "IF(SUM(FT42:GP42),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F43)),\"Card Mastery\",F43),G43)/$D$5,\"\")",
    "F43": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT42:GP42),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT42:GP42=1)),)\"),\"Attack Speed\")",
    "G43": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT42:GP42),ARRAYFORMULA(FILTER(BT42:CP42 , FT42:GP42=1)),\"\"\"\")\"),10.0)",
    "I43": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT42:GP42),ARRAYFORMULA(FILTER(EW42:FS42 , FT42:GP42=1))*D$5,\"\"\"\")\"),0.08998422714757416)",
    "K43": "IF(H43<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D43)),)",
    "BC43": "BC42+1",
    "BD43": "BD42+BD$3",
    "BE43": "BE42+BE$3",
    "BF43": "BF42+BF$3",
    "BG43": "BG42+BG$3",
    "BH43": "BH42+BH$3",
    "BI43": "BI42+BI$3",
    "BJ43": "BJ42+BJ$3",
    "BT43": "BT42+FT42",
    "BU43": "BU42+FU42",
    "BV43": "BV42+FV42",
    "BW43": "BW42+FW42",
    "BX43": "BX42+FX42",
    "BY43": "BY42+FY42",
    "BZ43": "BZ42+FZ42",
    "CA43": "CA42+GA42",
    "CB43": "CB42+GB42",
    "CC43": "CC42+GC42",
    "CD43": "CD42+GD42",
    "CE43": "CE42+GE42",
    "CF43": "CF42+GF42",
    "CG43": "CG42+GG42",
    "CH43": "CH42+GH42",
    "CI43": "CI42+GI42",
    "CJ43": "CJ42+GJ42",
    "CK43": "CK42+GK42",
    "CL43": "CL42+GL42",
    "CM43": "CM42+GM42",
    "CN43": "CN42+GN42",
    "CO43": "CO42+GO42",
    "CS43": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI43,1)",
    "CT43": "INDEX($BD$5:$BD188,BT43)",
    "CU43": "INDEX($BN$5:$BN188,CD43)",
    "CV43": "INDEX($BO$5:$BO188,CE43)",
    "CW43": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG43)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX43": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO43, 1)",
    "CY43": "LET(\n  Base, $CR$6,\n  Damage, $CT43,\n  DamageMastery, $CS43,\n  DemonMastery, $CX43,\n  SPB, $CU43,\n  ITO, $CV43,\n  Shock, $CW43,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ43": "MIN(100%, DA43)",
    "DA43": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK43*1%, 0)",
    "DB43": "LET(\n  Lab, 1+INDEX($BF$5:$BF188,BV43),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC43": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK43*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI188,BY43) + CardCritMastery)",
    "DD43": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK43*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ188,BZ43) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE43": "LET(\n  CF, $DB43,\n  CC, $CZ43,\n  SCM, $DD43,\n  SCC, $DC43,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF43": "LET(\n  CF, $DB43,\n  CC, $DA43,\n  SCM, $DD43,\n  SCC, $DC43,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG43": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH43)), 0)",
    "DH43": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ43*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE188,BU43),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI43": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG188, BW43), 1) + $AE$9)",
    "DJ43": "LET(\n  DpmLab, INDEX($BH$5:$BH188,BX43),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL43, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK43": "(1+$DI43*$DJ43*$AQ$9)",
    "DL43": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK188,CA43),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM43*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM43": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK188,CA43),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM43*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN43": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL188,CB43)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO43": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH43,\n  Rapid, DG43,\n  RDPM, DK43,\n  SuperTower, $DL43,\n  Rend, $DN43,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP43": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ43": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK43),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR43": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP43),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF43-1))",
    "DS43": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG43, DH43),0))",
    "DT43": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP43),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV43, $AR$29), 0))",
    "DU43": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK43),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM188,CC43), $DV43, $AR$29), 0))",
    "DV43": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH43), $AO$29)",
    "DW43": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM43,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43, $DB43), 1),\n\n  DW, $DR43,\n  CL, $DS43,\n  SM, $DT43,\n  SLM, $DU43,\n  SL, $DQ43,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX43": "CY43*(DE43*DO43*DQ43+DW43*DF43)",
    "DZ43": "IF(INDEX($BD$6:$BD188,BT43)=\"\", \"\", INDEX($BD$5:$BD188,BT43+1))",
    "EA43": "IF(OR($AO$25, INDEX($BE$6:$BE188,BU43)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ43)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE188,BU43+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI43*$DJ43*$AQ$9),\n  SuperTower, $DL43,\n  Rend, $DN43,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43, $DB43), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR43,\n  SM, $DT43,\n  SLM, $DU43,\n  SL, $DQ43,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM43, UltCritCard),\n\nCY43*(DE43*OtherDamage*SL+UwDamage*DF43)))",
    "EB43": "IF(INDEX($BF$6:$BF188,BV43)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF188,BV43+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ43,\n  CCUW, $DA43,\n  SCM, $DD43,\n  SCC, $DC43,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43, CF), 1),\n\n  DW, $DR43,\n  CL, $DS43,\n  SM, $DT43,\n  SLM, $DU43,\n  SL, $DQ43,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM43, UltCritCard),\n\nCY43 * (Critical * DO43 * SL + UwDamage * UWCritical)))",
    "EC43": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG188,BW43)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH43,\n  Rapid, DG43,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG188, BW43+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ43*$AQ$9),\n  SuperTower, $DL43,\n  Rend, $DN43,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM188,CC43), $DV43, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM43,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43, $DB43), 1),\n\n  DW, $DR43,\n  CL, $DS43,\n  SM, $DT43,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY43*(DE43*OtherDamage*SL+UWDamage*DF43)))",
    "ED43": "IF(OR($AO$25, INDEX($BH$6:$BH188,BX43)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH188,BX43+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL43, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI43*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM188,CC43), $DV43, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH43,\n  Rapid, DG43,\n  SuperTower, $DL43,\n  Rend, $DN43,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM43,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43, $DB43), 1),\n\n  DW, $DR43,\n  CL, $DS43,\n  SM, $DT43,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY43*(DE43*OtherDamage*SL+UWDamage*DF43)))",
    "EE43": "IF(INDEX($BI$6:$BI188,BY43)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK43, 0),\n  CF, $DB43,\n  CC, $CZ43,\n  CCUW, $DA43,\n  SCM, $DD43,\n  SCC, $AV$17+INDEX($BI$5:$BI188,BY43+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY43 * (Critical*DO43*$DQ43+DW43*UWCritical)))",
    "EF43": "IF(INDEX($BJ$6:$BJ188,BZ43)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK43*1%, 1),\n  CF, $DB43,\n  CC, $CZ43,\n  CCUW, $DA43,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ188,BZ43+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC43,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY43*(Critical*DO43*$DQ43+DW43*UWCritical)))",
    "EG43": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK188,CA43)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH43,\n  Rapid, DG43,\n  DPM, (1+$DI43*$DJ43*$AQ$9),\n  Rend, $DN43,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK188,CA43+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM43*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43, $DB43), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK188,CA43+1)-1))/(45-CM43*3),1),\n\n  SL, $DQ43,\n  DW, $DR43,\n  CL, $DS43,\n  SM, $DT43,\n  SLM, $DU43,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY43*(DE43*OtherDamage*SL+UwDamage*DF43)))",
    "EH43": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL188,CB43+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL188,CB43)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH43,\n  Rapid, DG43,\n  DPM, (1+$DI43*$DJ43*$AQ$9),\n  SuperTower, $DL43,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL188,CB43+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY43*(DE43*OtherDamage*$DQ43+DW43*DF43)))",
    "EI43": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM188,CC43)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43, $DB43), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK43),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV43, $AR$29), 0),\n\n  DW, $DR43,\n  CL, $DS43,\n  SM, $DT43,\n  SL, $DQ43,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM43, UltCritCard),\nCY43*(DE43*DO43*SL+UwDamage*DF43)))",
    "EJ43": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN188,CD43)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT43,\n  DamageMastery, $CS43,\n  DemonMastery, $CX43,\n  SPB, INDEX($BN$5:$BN188,CD43+1),\n  ITO, $CV43,\n  Shock, $CW43,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE43*DO43*$DQ43+DW43*DF43)))",
    "EK43": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO188,CE43)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT43,\n  DamageMastery, $CS43,\n  DemonMastery, $CX43,\n  SPB, $CU43,\n  ITO, INDEX($BO$5:$BO188,CE43+1),\n  Shock, $CW43,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE43*DO43*$DQ43+DW43*DF43)))",
    "EL43": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP188,CF43)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43, $DB43), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP43),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF43),\n  CL, $DS43,\n  SM, $DT43,\n  SLM, $DU43,\n  SL, $DQ43,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM43, UltCritCard),\nCY43*(DE43*DO43*SL+UwDamage*DF43)))",
    "EM43": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ188,CG43)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG43+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN43": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR188,CH43)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43, $DB43), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH43+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP43),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK43),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM188,CC43), SMHeat, $AR$29), 0),\n\n  DW, $DR43,\n  CL, $DS43,\n  SL, $DQ43,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM43, UltCritCard),\nCY43*(DE43*DO43*SL+UwDamage*DF43)))",
    "EO43": "IF(OR(CI43 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI43+1))",
    "EP43": "IF(OR($AO$25, CJ43 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ43+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE187,BU43),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL43, 1),\n  DPM, (1+$DI43*CardRangeMastery*$DJ43*$AQ$9),\n  SuperTower, $DL43,\n  Rend, $DN43,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43, $DB43), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR43,\n  SM, $DT43,\n  SLM, $DU43,\n  SL, $DQ43,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM43, UltCritCard),\n\nCY43*(DE43*OtherDamage*SL+UwDamage*DF43)))",
    "EQ43": "IF(OR(CK43 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK43+1)*1%, 1),\n  CF, $DB43,\n  CC, MIN(100%, $CZ43 + 1%),\n  CCUW, DA43 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ188,BZ43) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC43 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR43,\n  CL, $DS43,\n  SM, $DT43,\n  SLM, $DU43,\n  SL, $DQ43,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM43, UltCritCard),\n\nCY43 * (Critical*DO43*SL+UwDamage*UWCritical)))",
    "ER43": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL43 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH188,BX43),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL43+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI43*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM188,CC43), $DV43, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH43,\n  Rapid, DG43,\n  SuperTower, $DL43,\n  Rend, $DN43,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM43,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43, $DB43), 1),\n\n  DW, $DR43,\n  CL, $DS43,\n  SM, $DT43,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY43*(DE43*OtherDamage*SL+UWDamage*DF43)))",
    "ES43": "IF(OR(CM43 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH43,\n  Rapid, DG43,\n  RDPM, (1+$DI43*$DJ43*$AQ$9),\n  Rend, $DN43,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK188,CA43),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM43+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43, $DB43), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR43,\n  CL, $DS43,\n  SM, $DT43,\n  SLM, $DU43,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY43*(DE43*OtherDamage*SL+UwDamage*DF43)))",
    "ET43": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN43 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM43,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN43+1, $DB43), 1),\n\n  DW, $DR43,\n  CL, $DS43,\n  SM, $DT43,\n  SLM, $DU43,\n  SL, $DQ43,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY43*(DE43*DO43*SL+UWDamage*DF43)))",
    "EU43": "IF(OR(NOT($BA$3), NOT($BA$23), $CO43 > $BA$15), \"\", 1 + 0.5*(CO43+1))",
    "EW43": "IF(DZ43=\"\", \"\", LET(\n  Now, CT43,\n  Next, DZ43,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT43),\nFactor/Cost))",
    "EX43": "IF(EA43=\"\",\"\",(EA43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU43))",
    "EY43": "IF(EB43=\"\",\"\",(EB43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV43))",
    "EZ43": "IF(EC43=\"\",\"\",(EC43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW43))",
    "FA43": "IF(ED43=\"\",\"\",(ED43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX43))",
    "FB43": "IF(EE43=\"\",\"\",(EE43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY43))",
    "FC43": "IF(EF43=\"\",\"\",(EF43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ43))",
    "FD43": "IF(EG43=\"\",\"\",(EG43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA43))",
    "FE43": "IF(EH43=\"\",\"\",(EH43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB43))",
    "FF43": "IF(EI43=\"\",\"\",(EI43/$DX43-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC43+1, 1, CC43))))",
    "FG43": "IF(EJ43=\"\",\"\",(EJ43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD43))",
    "FH43": "IF(EK43=\"\",\"\",(EK43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE43))",
    "FI43": "IF(EL43=\"\",\"\",(EL43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF43))",
    "FJ43": "IF(EM43=\"\", \"\", LET(\n  Now, CW43,\n  Next, EM43,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG43),\nFactor/Cost))",
    "FK43": "IF(EN43=\"\",\"\",(EN43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH43))",
    "FL43": "IF(EO43=\"\", \"\", LET(\n  Now, CS43,\n  Next, EO43,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI43),\nFactor/Cost))",
    "FM43": "IF(EP43=\"\",\"\",(EP43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ43))",
    "FN43": "IF(EQ43=\"\",\"\",(EQ43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK43))",
    "FO43": "IF(ER43=\"\",\"\",(ER43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL43))",
    "FP43": "IF(ES43=\"\",\"\",(ES43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM43))",
    "FQ43": "IF(ET43=\"\",\"\",(ET43/$DX43-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN43))",
    "FR43": "IF(EU43=\"\", \"\", LET(\n  Now, CX43,\n  Next, EU43,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO43),\nFactor/Cost))",
    "FT43": "IF(COLUMN(EW43:FR43) = MIN(IF(EW43:FR43=MAX(EW43:FR43), COLUMN(EW43:FR43))), 1, \"\")",
    "D44": "IF(SUM(FT43:GP43),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F44)),\"Card Mastery\",F44),G44)/$D$5,\"\")",
    "F44": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT43:GP43),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT43:GP43=1)),)\"),\"Damage\")",
    "G44": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT43:GP43),ARRAYFORMULA(FILTER(BT43:CP43 , FT43:GP43=1)),\"\"\"\")\"),10.0)",
    "I44": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT43:GP43),ARRAYFORMULA(FILTER(EW43:FS43 , FT43:GP43=1))*D$5,\"\"\"\")\"),0.08973080757726797)",
    "K44": "IF(H44<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D44)),)",
    "BC44": "BC43+1",
    "BD44": "BD43+BD$3",
    "BE44": "BE43+BE$3",
    "BF44": "BF43+BF$3",
    "BG44": "BG43+BG$3",
    "BH44": "BH43+BH$3",
    "BI44": "BI43+BI$3",
    "BJ44": "BJ43+BJ$3",
    "BT44": "BT43+FT43",
    "BU44": "BU43+FU43",
    "BV44": "BV43+FV43",
    "BW44": "BW43+FW43",
    "BX44": "BX43+FX43",
    "BY44": "BY43+FY43",
    "BZ44": "BZ43+FZ43",
    "CA44": "CA43+GA43",
    "CB44": "CB43+GB43",
    "CC44": "CC43+GC43",
    "CD44": "CD43+GD43",
    "CE44": "CE43+GE43",
    "CF44": "CF43+GF43",
    "CG44": "CG43+GG43",
    "CH44": "CH43+GH43",
    "CI44": "CI43+GI43",
    "CJ44": "CJ43+GJ43",
    "CK44": "CK43+GK43",
    "CL44": "CL43+GL43",
    "CM44": "CM43+GM43",
    "CN44": "CN43+GN43",
    "CO44": "CO43+GO43",
    "CS44": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI44,1)",
    "CT44": "INDEX($BD$5:$BD189,BT44)",
    "CU44": "INDEX($BN$5:$BN189,CD44)",
    "CV44": "INDEX($BO$5:$BO189,CE44)",
    "CW44": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG44)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX44": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO44, 1)",
    "CY44": "LET(\n  Base, $CR$6,\n  Damage, $CT44,\n  DamageMastery, $CS44,\n  DemonMastery, $CX44,\n  SPB, $CU44,\n  ITO, $CV44,\n  Shock, $CW44,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ44": "MIN(100%, DA44)",
    "DA44": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK44*1%, 0)",
    "DB44": "LET(\n  Lab, 1+INDEX($BF$5:$BF189,BV44),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC44": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK44*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI189,BY44) + CardCritMastery)",
    "DD44": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK44*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ189,BZ44) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE44": "LET(\n  CF, $DB44,\n  CC, $CZ44,\n  SCM, $DD44,\n  SCC, $DC44,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF44": "LET(\n  CF, $DB44,\n  CC, $DA44,\n  SCM, $DD44,\n  SCC, $DC44,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG44": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH44)), 0)",
    "DH44": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ44*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE189,BU44),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI44": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG189, BW44), 1) + $AE$9)",
    "DJ44": "LET(\n  DpmLab, INDEX($BH$5:$BH189,BX44),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL44, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK44": "(1+$DI44*$DJ44*$AQ$9)",
    "DL44": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK189,CA44),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM44*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM44": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK189,CA44),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM44*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN44": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL189,CB44)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO44": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH44,\n  Rapid, DG44,\n  RDPM, DK44,\n  SuperTower, $DL44,\n  Rend, $DN44,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP44": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ44": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK44),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR44": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP44),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF44-1))",
    "DS44": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG44, DH44),0))",
    "DT44": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP44),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV44, $AR$29), 0))",
    "DU44": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK44),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM189,CC44), $DV44, $AR$29), 0))",
    "DV44": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH44), $AO$29)",
    "DW44": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM44,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44, $DB44), 1),\n\n  DW, $DR44,\n  CL, $DS44,\n  SM, $DT44,\n  SLM, $DU44,\n  SL, $DQ44,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX44": "CY44*(DE44*DO44*DQ44+DW44*DF44)",
    "DZ44": "IF(INDEX($BD$6:$BD189,BT44)=\"\", \"\", INDEX($BD$5:$BD189,BT44+1))",
    "EA44": "IF(OR($AO$25, INDEX($BE$6:$BE189,BU44)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ44)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE189,BU44+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI44*$DJ44*$AQ$9),\n  SuperTower, $DL44,\n  Rend, $DN44,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44, $DB44), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR44,\n  SM, $DT44,\n  SLM, $DU44,\n  SL, $DQ44,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM44, UltCritCard),\n\nCY44*(DE44*OtherDamage*SL+UwDamage*DF44)))",
    "EB44": "IF(INDEX($BF$6:$BF189,BV44)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF189,BV44+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ44,\n  CCUW, $DA44,\n  SCM, $DD44,\n  SCC, $DC44,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44, CF), 1),\n\n  DW, $DR44,\n  CL, $DS44,\n  SM, $DT44,\n  SLM, $DU44,\n  SL, $DQ44,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM44, UltCritCard),\n\nCY44 * (Critical * DO44 * SL + UwDamage * UWCritical)))",
    "EC44": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG189,BW44)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH44,\n  Rapid, DG44,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG189, BW44+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ44*$AQ$9),\n  SuperTower, $DL44,\n  Rend, $DN44,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM189,CC44), $DV44, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM44,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44, $DB44), 1),\n\n  DW, $DR44,\n  CL, $DS44,\n  SM, $DT44,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY44*(DE44*OtherDamage*SL+UWDamage*DF44)))",
    "ED44": "IF(OR($AO$25, INDEX($BH$6:$BH189,BX44)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH189,BX44+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL44, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI44*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM189,CC44), $DV44, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH44,\n  Rapid, DG44,\n  SuperTower, $DL44,\n  Rend, $DN44,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM44,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44, $DB44), 1),\n\n  DW, $DR44,\n  CL, $DS44,\n  SM, $DT44,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY44*(DE44*OtherDamage*SL+UWDamage*DF44)))",
    "EE44": "IF(INDEX($BI$6:$BI189,BY44)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK44, 0),\n  CF, $DB44,\n  CC, $CZ44,\n  CCUW, $DA44,\n  SCM, $DD44,\n  SCC, $AV$17+INDEX($BI$5:$BI189,BY44+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY44 * (Critical*DO44*$DQ44+DW44*UWCritical)))",
    "EF44": "IF(INDEX($BJ$6:$BJ189,BZ44)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK44*1%, 1),\n  CF, $DB44,\n  CC, $CZ44,\n  CCUW, $DA44,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ189,BZ44+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC44,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY44*(Critical*DO44*$DQ44+DW44*UWCritical)))",
    "EG44": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK189,CA44)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH44,\n  Rapid, DG44,\n  DPM, (1+$DI44*$DJ44*$AQ$9),\n  Rend, $DN44,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK189,CA44+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM44*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44, $DB44), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK189,CA44+1)-1))/(45-CM44*3),1),\n\n  SL, $DQ44,\n  DW, $DR44,\n  CL, $DS44,\n  SM, $DT44,\n  SLM, $DU44,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY44*(DE44*OtherDamage*SL+UwDamage*DF44)))",
    "EH44": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL189,CB44+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL189,CB44)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH44,\n  Rapid, DG44,\n  DPM, (1+$DI44*$DJ44*$AQ$9),\n  SuperTower, $DL44,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL189,CB44+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY44*(DE44*OtherDamage*$DQ44+DW44*DF44)))",
    "EI44": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM189,CC44)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44, $DB44), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK44),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV44, $AR$29), 0),\n\n  DW, $DR44,\n  CL, $DS44,\n  SM, $DT44,\n  SL, $DQ44,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM44, UltCritCard),\nCY44*(DE44*DO44*SL+UwDamage*DF44)))",
    "EJ44": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN189,CD44)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT44,\n  DamageMastery, $CS44,\n  DemonMastery, $CX44,\n  SPB, INDEX($BN$5:$BN189,CD44+1),\n  ITO, $CV44,\n  Shock, $CW44,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE44*DO44*$DQ44+DW44*DF44)))",
    "EK44": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO189,CE44)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT44,\n  DamageMastery, $CS44,\n  DemonMastery, $CX44,\n  SPB, $CU44,\n  ITO, INDEX($BO$5:$BO189,CE44+1),\n  Shock, $CW44,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE44*DO44*$DQ44+DW44*DF44)))",
    "EL44": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP189,CF44)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44, $DB44), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP44),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF44),\n  CL, $DS44,\n  SM, $DT44,\n  SLM, $DU44,\n  SL, $DQ44,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM44, UltCritCard),\nCY44*(DE44*DO44*SL+UwDamage*DF44)))",
    "EM44": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ189,CG44)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG44+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN44": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR189,CH44)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44, $DB44), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH44+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP44),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK44),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM189,CC44), SMHeat, $AR$29), 0),\n\n  DW, $DR44,\n  CL, $DS44,\n  SL, $DQ44,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM44, UltCritCard),\nCY44*(DE44*DO44*SL+UwDamage*DF44)))",
    "EO44": "IF(OR(CI44 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI44+1))",
    "EP44": "IF(OR($AO$25, CJ44 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ44+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE188,BU44),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL44, 1),\n  DPM, (1+$DI44*CardRangeMastery*$DJ44*$AQ$9),\n  SuperTower, $DL44,\n  Rend, $DN44,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44, $DB44), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR44,\n  SM, $DT44,\n  SLM, $DU44,\n  SL, $DQ44,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM44, UltCritCard),\n\nCY44*(DE44*OtherDamage*SL+UwDamage*DF44)))",
    "EQ44": "IF(OR(CK44 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK44+1)*1%, 1),\n  CF, $DB44,\n  CC, MIN(100%, $CZ44 + 1%),\n  CCUW, DA44 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ189,BZ44) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC44 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR44,\n  CL, $DS44,\n  SM, $DT44,\n  SLM, $DU44,\n  SL, $DQ44,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM44, UltCritCard),\n\nCY44 * (Critical*DO44*SL+UwDamage*UWCritical)))",
    "ER44": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL44 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH189,BX44),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL44+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI44*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM189,CC44), $DV44, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH44,\n  Rapid, DG44,\n  SuperTower, $DL44,\n  Rend, $DN44,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM44,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44, $DB44), 1),\n\n  DW, $DR44,\n  CL, $DS44,\n  SM, $DT44,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY44*(DE44*OtherDamage*SL+UWDamage*DF44)))",
    "ES44": "IF(OR(CM44 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH44,\n  Rapid, DG44,\n  RDPM, (1+$DI44*$DJ44*$AQ$9),\n  Rend, $DN44,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK189,CA44),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM44+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44, $DB44), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR44,\n  CL, $DS44,\n  SM, $DT44,\n  SLM, $DU44,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY44*(DE44*OtherDamage*SL+UwDamage*DF44)))",
    "ET44": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN44 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM44,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN44+1, $DB44), 1),\n\n  DW, $DR44,\n  CL, $DS44,\n  SM, $DT44,\n  SLM, $DU44,\n  SL, $DQ44,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY44*(DE44*DO44*SL+UWDamage*DF44)))",
    "EU44": "IF(OR(NOT($BA$3), NOT($BA$23), $CO44 > $BA$15), \"\", 1 + 0.5*(CO44+1))",
    "EW44": "IF(DZ44=\"\", \"\", LET(\n  Now, CT44,\n  Next, DZ44,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT44),\nFactor/Cost))",
    "EX44": "IF(EA44=\"\",\"\",(EA44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU44))",
    "EY44": "IF(EB44=\"\",\"\",(EB44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV44))",
    "EZ44": "IF(EC44=\"\",\"\",(EC44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW44))",
    "FA44": "IF(ED44=\"\",\"\",(ED44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX44))",
    "FB44": "IF(EE44=\"\",\"\",(EE44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY44))",
    "FC44": "IF(EF44=\"\",\"\",(EF44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ44))",
    "FD44": "IF(EG44=\"\",\"\",(EG44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA44))",
    "FE44": "IF(EH44=\"\",\"\",(EH44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB44))",
    "FF44": "IF(EI44=\"\",\"\",(EI44/$DX44-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC44+1, 1, CC44))))",
    "FG44": "IF(EJ44=\"\",\"\",(EJ44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD44))",
    "FH44": "IF(EK44=\"\",\"\",(EK44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE44))",
    "FI44": "IF(EL44=\"\",\"\",(EL44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF44))",
    "FJ44": "IF(EM44=\"\", \"\", LET(\n  Now, CW44,\n  Next, EM44,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG44),\nFactor/Cost))",
    "FK44": "IF(EN44=\"\",\"\",(EN44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH44))",
    "FL44": "IF(EO44=\"\", \"\", LET(\n  Now, CS44,\n  Next, EO44,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI44),\nFactor/Cost))",
    "FM44": "IF(EP44=\"\",\"\",(EP44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ44))",
    "FN44": "IF(EQ44=\"\",\"\",(EQ44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK44))",
    "FO44": "IF(ER44=\"\",\"\",(ER44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL44))",
    "FP44": "IF(ES44=\"\",\"\",(ES44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM44))",
    "FQ44": "IF(ET44=\"\",\"\",(ET44/$DX44-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN44))",
    "FR44": "IF(EU44=\"\", \"\", LET(\n  Now, CX44,\n  Next, EU44,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO44),\nFactor/Cost))",
    "FT44": "IF(COLUMN(EW44:FR44) = MIN(IF(EW44:FR44=MAX(EW44:FR44), COLUMN(EW44:FR44))), 1, \"\")",
    "D45": "IF(SUM(FT44:GP44),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F45)),\"Card Mastery\",F45),G45)/$D$5,\"\")",
    "F45": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT44:GP44),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT44:GP44=1)),)\"),\"Critical Factor\")",
    "G45": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT44:GP44),ARRAYFORMULA(FILTER(BT44:CP44 , FT44:GP44=1)),\"\"\"\")\"),12.0)",
    "I45": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT44:GP44),ARRAYFORMULA(FILTER(EW44:FS44 , FT44:GP44=1))*D$5,\"\"\"\")\"),0.07687785543329886)",
    "K45": "IF(D36,FORMAT_TIME_YEAR(SUM($D$6:$D45)),)",
    "BC45": "BC44+1",
    "BD45": "BD44+BD$3",
    "BE45": "BE44+BE$3",
    "BF45": "BF44+BF$3",
    "BG45": "BG44+BG$3",
    "BH45": "BH44+BH$3",
    "BI45": "BI44+BI$3",
    "BJ45": "BJ44+BJ$3",
    "BT45": "BT44+FT44",
    "BU45": "BU44+FU44",
    "BV45": "BV44+FV44",
    "BW45": "BW44+FW44",
    "BX45": "BX44+FX44",
    "BY45": "BY44+FY44",
    "BZ45": "BZ44+FZ44",
    "CA45": "CA44+GA44",
    "CB45": "CB44+GB44",
    "CC45": "CC44+GC44",
    "CD45": "CD44+GD44",
    "CE45": "CE44+GE44",
    "CF45": "CF44+GF44",
    "CG45": "CG44+GG44",
    "CH45": "CH44+GH44",
    "CI45": "CI44+GI44",
    "CJ45": "CJ44+GJ44",
    "CK45": "CK44+GK44",
    "CL45": "CL44+GL44",
    "CM45": "CM44+GM44",
    "CN45": "CN44+GN44",
    "CO45": "CO44+GO44",
    "CS45": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI45,1)",
    "CT45": "INDEX($BD$5:$BD190,BT45)",
    "CU45": "INDEX($BN$5:$BN190,CD45)",
    "CV45": "INDEX($BO$5:$BO190,CE45)",
    "CW45": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG45)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX45": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO45, 1)",
    "CY45": "LET(\n  Base, $CR$6,\n  Damage, $CT45,\n  DamageMastery, $CS45,\n  DemonMastery, $CX45,\n  SPB, $CU45,\n  ITO, $CV45,\n  Shock, $CW45,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ45": "MIN(100%, DA45)",
    "DA45": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK45*1%, 0)",
    "DB45": "LET(\n  Lab, 1+INDEX($BF$5:$BF190,BV45),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC45": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK45*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI190,BY45) + CardCritMastery)",
    "DD45": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK45*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ190,BZ45) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE45": "LET(\n  CF, $DB45,\n  CC, $CZ45,\n  SCM, $DD45,\n  SCC, $DC45,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF45": "LET(\n  CF, $DB45,\n  CC, $DA45,\n  SCM, $DD45,\n  SCC, $DC45,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG45": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH45)), 0)",
    "DH45": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ45*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE190,BU45),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI45": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG190, BW45), 1) + $AE$9)",
    "DJ45": "LET(\n  DpmLab, INDEX($BH$5:$BH190,BX45),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL45, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK45": "(1+$DI45*$DJ45*$AQ$9)",
    "DL45": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK190,CA45),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM45*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM45": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK190,CA45),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM45*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN45": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL190,CB45)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO45": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH45,\n  Rapid, DG45,\n  RDPM, DK45,\n  SuperTower, $DL45,\n  Rend, $DN45,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP45": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ45": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK45),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR45": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP45),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF45-1))",
    "DS45": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG45, DH45),0))",
    "DT45": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP45),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV45, $AR$29), 0))",
    "DU45": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK45),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM190,CC45), $DV45, $AR$29), 0))",
    "DV45": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH45), $AO$29)",
    "DW45": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM45,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45, $DB45), 1),\n\n  DW, $DR45,\n  CL, $DS45,\n  SM, $DT45,\n  SLM, $DU45,\n  SL, $DQ45,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX45": "CY45*(DE45*DO45*DQ45+DW45*DF45)",
    "DZ45": "IF(INDEX($BD$6:$BD190,BT45)=\"\", \"\", INDEX($BD$5:$BD190,BT45+1))",
    "EA45": "IF(OR($AO$25, INDEX($BE$6:$BE190,BU45)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ45)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE190,BU45+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI45*$DJ45*$AQ$9),\n  SuperTower, $DL45,\n  Rend, $DN45,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45, $DB45), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR45,\n  SM, $DT45,\n  SLM, $DU45,\n  SL, $DQ45,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM45, UltCritCard),\n\nCY45*(DE45*OtherDamage*SL+UwDamage*DF45)))",
    "EB45": "IF(INDEX($BF$6:$BF190,BV45)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF190,BV45+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ45,\n  CCUW, $DA45,\n  SCM, $DD45,\n  SCC, $DC45,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45, CF), 1),\n\n  DW, $DR45,\n  CL, $DS45,\n  SM, $DT45,\n  SLM, $DU45,\n  SL, $DQ45,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM45, UltCritCard),\n\nCY45 * (Critical * DO45 * SL + UwDamage * UWCritical)))",
    "EC45": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG190,BW45)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH45,\n  Rapid, DG45,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG190, BW45+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ45*$AQ$9),\n  SuperTower, $DL45,\n  Rend, $DN45,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM190,CC45), $DV45, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM45,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45, $DB45), 1),\n\n  DW, $DR45,\n  CL, $DS45,\n  SM, $DT45,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY45*(DE45*OtherDamage*SL+UWDamage*DF45)))",
    "ED45": "IF(OR($AO$25, INDEX($BH$6:$BH190,BX45)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH190,BX45+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL45, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI45*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM190,CC45), $DV45, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH45,\n  Rapid, DG45,\n  SuperTower, $DL45,\n  Rend, $DN45,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM45,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45, $DB45), 1),\n\n  DW, $DR45,\n  CL, $DS45,\n  SM, $DT45,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY45*(DE45*OtherDamage*SL+UWDamage*DF45)))",
    "EE45": "IF(INDEX($BI$6:$BI190,BY45)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK45, 0),\n  CF, $DB45,\n  CC, $CZ45,\n  CCUW, $DA45,\n  SCM, $DD45,\n  SCC, $AV$17+INDEX($BI$5:$BI190,BY45+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY45 * (Critical*DO45*$DQ45+DW45*UWCritical)))",
    "EF45": "IF(INDEX($BJ$6:$BJ190,BZ45)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK45*1%, 1),\n  CF, $DB45,\n  CC, $CZ45,\n  CCUW, $DA45,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ190,BZ45+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC45,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY45*(Critical*DO45*$DQ45+DW45*UWCritical)))",
    "EG45": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK190,CA45)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH45,\n  Rapid, DG45,\n  DPM, (1+$DI45*$DJ45*$AQ$9),\n  Rend, $DN45,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK190,CA45+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM45*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45, $DB45), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK190,CA45+1)-1))/(45-CM45*3),1),\n\n  SL, $DQ45,\n  DW, $DR45,\n  CL, $DS45,\n  SM, $DT45,\n  SLM, $DU45,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY45*(DE45*OtherDamage*SL+UwDamage*DF45)))",
    "EH45": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL190,CB45+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL190,CB45)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH45,\n  Rapid, DG45,\n  DPM, (1+$DI45*$DJ45*$AQ$9),\n  SuperTower, $DL45,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL190,CB45+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY45*(DE45*OtherDamage*$DQ45+DW45*DF45)))",
    "EI45": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM190,CC45)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45, $DB45), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK45),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV45, $AR$29), 0),\n\n  DW, $DR45,\n  CL, $DS45,\n  SM, $DT45,\n  SL, $DQ45,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM45, UltCritCard),\nCY45*(DE45*DO45*SL+UwDamage*DF45)))",
    "EJ45": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN190,CD45)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT45,\n  DamageMastery, $CS45,\n  DemonMastery, $CX45,\n  SPB, INDEX($BN$5:$BN190,CD45+1),\n  ITO, $CV45,\n  Shock, $CW45,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE45*DO45*$DQ45+DW45*DF45)))",
    "EK45": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO190,CE45)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT45,\n  DamageMastery, $CS45,\n  DemonMastery, $CX45,\n  SPB, $CU45,\n  ITO, INDEX($BO$5:$BO190,CE45+1),\n  Shock, $CW45,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE45*DO45*$DQ45+DW45*DF45)))",
    "EL45": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP190,CF45)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45, $DB45), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP45),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF45),\n  CL, $DS45,\n  SM, $DT45,\n  SLM, $DU45,\n  SL, $DQ45,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM45, UltCritCard),\nCY45*(DE45*DO45*SL+UwDamage*DF45)))",
    "EM45": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ190,CG45)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG45+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN45": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR190,CH45)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45, $DB45), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH45+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP45),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK45),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM190,CC45), SMHeat, $AR$29), 0),\n\n  DW, $DR45,\n  CL, $DS45,\n  SL, $DQ45,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM45, UltCritCard),\nCY45*(DE45*DO45*SL+UwDamage*DF45)))",
    "EO45": "IF(OR(CI45 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI45+1))",
    "EP45": "IF(OR($AO$25, CJ45 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ45+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE189,BU45),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL45, 1),\n  DPM, (1+$DI45*CardRangeMastery*$DJ45*$AQ$9),\n  SuperTower, $DL45,\n  Rend, $DN45,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45, $DB45), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR45,\n  SM, $DT45,\n  SLM, $DU45,\n  SL, $DQ45,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM45, UltCritCard),\n\nCY45*(DE45*OtherDamage*SL+UwDamage*DF45)))",
    "EQ45": "IF(OR(CK45 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK45+1)*1%, 1),\n  CF, $DB45,\n  CC, MIN(100%, $CZ45 + 1%),\n  CCUW, DA45 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ190,BZ45) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC45 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR45,\n  CL, $DS45,\n  SM, $DT45,\n  SLM, $DU45,\n  SL, $DQ45,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM45, UltCritCard),\n\nCY45 * (Critical*DO45*SL+UwDamage*UWCritical)))",
    "ER45": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL45 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH190,BX45),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL45+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI45*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM190,CC45), $DV45, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH45,\n  Rapid, DG45,\n  SuperTower, $DL45,\n  Rend, $DN45,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM45,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45, $DB45), 1),\n\n  DW, $DR45,\n  CL, $DS45,\n  SM, $DT45,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY45*(DE45*OtherDamage*SL+UWDamage*DF45)))",
    "ES45": "IF(OR(CM45 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH45,\n  Rapid, DG45,\n  RDPM, (1+$DI45*$DJ45*$AQ$9),\n  Rend, $DN45,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK190,CA45),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM45+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45, $DB45), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR45,\n  CL, $DS45,\n  SM, $DT45,\n  SLM, $DU45,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY45*(DE45*OtherDamage*SL+UwDamage*DF45)))",
    "ET45": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN45 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM45,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN45+1, $DB45), 1),\n\n  DW, $DR45,\n  CL, $DS45,\n  SM, $DT45,\n  SLM, $DU45,\n  SL, $DQ45,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY45*(DE45*DO45*SL+UWDamage*DF45)))",
    "EU45": "IF(OR(NOT($BA$3), NOT($BA$23), $CO45 > $BA$15), \"\", 1 + 0.5*(CO45+1))",
    "EW45": "IF(DZ45=\"\", \"\", LET(\n  Now, CT45,\n  Next, DZ45,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT45),\nFactor/Cost))",
    "EX45": "IF(EA45=\"\",\"\",(EA45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU45))",
    "EY45": "IF(EB45=\"\",\"\",(EB45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV45))",
    "EZ45": "IF(EC45=\"\",\"\",(EC45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW45))",
    "FA45": "IF(ED45=\"\",\"\",(ED45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX45))",
    "FB45": "IF(EE45=\"\",\"\",(EE45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY45))",
    "FC45": "IF(EF45=\"\",\"\",(EF45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ45))",
    "FD45": "IF(EG45=\"\",\"\",(EG45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA45))",
    "FE45": "IF(EH45=\"\",\"\",(EH45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB45))",
    "FF45": "IF(EI45=\"\",\"\",(EI45/$DX45-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC45+1, 1, CC45))))",
    "FG45": "IF(EJ45=\"\",\"\",(EJ45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD45))",
    "FH45": "IF(EK45=\"\",\"\",(EK45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE45))",
    "FI45": "IF(EL45=\"\",\"\",(EL45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF45))",
    "FJ45": "IF(EM45=\"\", \"\", LET(\n  Now, CW45,\n  Next, EM45,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG45),\nFactor/Cost))",
    "FK45": "IF(EN45=\"\",\"\",(EN45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH45))",
    "FL45": "IF(EO45=\"\", \"\", LET(\n  Now, CS45,\n  Next, EO45,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI45),\nFactor/Cost))",
    "FM45": "IF(EP45=\"\",\"\",(EP45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ45))",
    "FN45": "IF(EQ45=\"\",\"\",(EQ45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK45))",
    "FO45": "IF(ER45=\"\",\"\",(ER45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL45))",
    "FP45": "IF(ES45=\"\",\"\",(ES45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM45))",
    "FQ45": "IF(ET45=\"\",\"\",(ET45/$DX45-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN45))",
    "FR45": "IF(EU45=\"\", \"\", LET(\n  Now, CX45,\n  Next, EU45,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO45),\nFactor/Cost))",
    "FT45": "IF(COLUMN(EW45:FR45) = MIN(IF(EW45:FR45=MAX(EW45:FR45), COLUMN(EW45:FR45))), 1, \"\")",
    "D46": "IF(SUM(FT45:GP45),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F46)),\"Card Mastery\",F46),G46)/$D$5,\"\")",
    "F46": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT45:GP45),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT45:GP45=1)),)\"),\"Super Tower Bonus\")",
    "G46": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT45:GP45),ARRAYFORMULA(FILTER(BT45:CP45 , FT45:GP45=1)),\"\"\"\")\"),1.0)",
    "I46": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT45:GP45),ARRAYFORMULA(FILTER(EW45:FS45 , FT45:GP45=1))*D$5,\"\"\"\")\"),0.07023775530543863)",
    "K46": "IF(H46<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D46)),)",
    "BC46": "BC45+1",
    "BD46": "BD45+BD$3",
    "BE46": "BE45+BE$3",
    "BF46": "BF45+BF$3",
    "BG46": "BG45+BG$3",
    "BH46": "BH45+BH$3",
    "BI46": "BI45+BI$3",
    "BT46": "BT45+FT45",
    "BU46": "BU45+FU45",
    "BV46": "BV45+FV45",
    "BW46": "BW45+FW45",
    "BX46": "BX45+FX45",
    "BY46": "BY45+FY45",
    "BZ46": "BZ45+FZ45",
    "CA46": "CA45+GA45",
    "CB46": "CB45+GB45",
    "CC46": "CC45+GC45",
    "CD46": "CD45+GD45",
    "CE46": "CE45+GE45",
    "CF46": "CF45+GF45",
    "CG46": "CG45+GG45",
    "CH46": "CH45+GH45",
    "CI46": "CI45+GI45",
    "CJ46": "CJ45+GJ45",
    "CK46": "CK45+GK45",
    "CL46": "CL45+GL45",
    "CM46": "CM45+GM45",
    "CN46": "CN45+GN45",
    "CO46": "CO45+GO45",
    "CS46": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI46,1)",
    "CT46": "INDEX($BD$5:$BD191,BT46)",
    "CU46": "INDEX($BN$5:$BN191,CD46)",
    "CV46": "INDEX($BO$5:$BO191,CE46)",
    "CW46": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG46)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX46": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO46, 1)",
    "CY46": "LET(\n  Base, $CR$6,\n  Damage, $CT46,\n  DamageMastery, $CS46,\n  DemonMastery, $CX46,\n  SPB, $CU46,\n  ITO, $CV46,\n  Shock, $CW46,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ46": "MIN(100%, DA46)",
    "DA46": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK46*1%, 0)",
    "DB46": "LET(\n  Lab, 1+INDEX($BF$5:$BF191,BV46),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC46": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK46*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI191,BY46) + CardCritMastery)",
    "DD46": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK46*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ191,BZ46) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE46": "LET(\n  CF, $DB46,\n  CC, $CZ46,\n  SCM, $DD46,\n  SCC, $DC46,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF46": "LET(\n  CF, $DB46,\n  CC, $DA46,\n  SCM, $DD46,\n  SCC, $DC46,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG46": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH46)), 0)",
    "DH46": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ46*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE191,BU46),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI46": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG191, BW46), 1) + $AE$9)",
    "DJ46": "LET(\n  DpmLab, INDEX($BH$5:$BH191,BX46),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL46, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK46": "(1+$DI46*$DJ46*$AQ$9)",
    "DL46": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK191,CA46),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM46*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM46": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK191,CA46),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM46*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN46": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL191,CB46)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO46": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH46,\n  Rapid, DG46,\n  RDPM, DK46,\n  SuperTower, $DL46,\n  Rend, $DN46,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP46": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ46": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK46),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR46": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP46),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF46-1))",
    "DS46": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG46, DH46),0))",
    "DT46": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP46),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV46, $AR$29), 0))",
    "DU46": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK46),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM191,CC46), $DV46, $AR$29), 0))",
    "DV46": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH46), $AO$29)",
    "DW46": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM46,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46, $DB46), 1),\n\n  DW, $DR46,\n  CL, $DS46,\n  SM, $DT46,\n  SLM, $DU46,\n  SL, $DQ46,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX46": "CY46*(DE46*DO46*DQ46+DW46*DF46)",
    "DZ46": "IF(INDEX($BD$6:$BD191,BT46)=\"\", \"\", INDEX($BD$5:$BD191,BT46+1))",
    "EA46": "IF(OR($AO$25, INDEX($BE$6:$BE191,BU46)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ46)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE191,BU46+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI46*$DJ46*$AQ$9),\n  SuperTower, $DL46,\n  Rend, $DN46,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46, $DB46), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR46,\n  SM, $DT46,\n  SLM, $DU46,\n  SL, $DQ46,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM46, UltCritCard),\n\nCY46*(DE46*OtherDamage*SL+UwDamage*DF46)))",
    "EB46": "IF(INDEX($BF$6:$BF191,BV46)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF191,BV46+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ46,\n  CCUW, $DA46,\n  SCM, $DD46,\n  SCC, $DC46,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46, CF), 1),\n\n  DW, $DR46,\n  CL, $DS46,\n  SM, $DT46,\n  SLM, $DU46,\n  SL, $DQ46,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM46, UltCritCard),\n\nCY46 * (Critical * DO46 * SL + UwDamage * UWCritical)))",
    "EC46": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG191,BW46)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH46,\n  Rapid, DG46,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG191, BW46+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ46*$AQ$9),\n  SuperTower, $DL46,\n  Rend, $DN46,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM191,CC46), $DV46, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM46,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46, $DB46), 1),\n\n  DW, $DR46,\n  CL, $DS46,\n  SM, $DT46,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY46*(DE46*OtherDamage*SL+UWDamage*DF46)))",
    "ED46": "IF(OR($AO$25, INDEX($BH$6:$BH191,BX46)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH191,BX46+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL46, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI46*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM191,CC46), $DV46, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH46,\n  Rapid, DG46,\n  SuperTower, $DL46,\n  Rend, $DN46,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM46,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46, $DB46), 1),\n\n  DW, $DR46,\n  CL, $DS46,\n  SM, $DT46,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY46*(DE46*OtherDamage*SL+UWDamage*DF46)))",
    "EE46": "IF(INDEX($BI$6:$BI191,BY46)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK46, 0),\n  CF, $DB46,\n  CC, $CZ46,\n  CCUW, $DA46,\n  SCM, $DD46,\n  SCC, $AV$17+INDEX($BI$5:$BI191,BY46+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY46 * (Critical*DO46*$DQ46+DW46*UWCritical)))",
    "EF46": "IF(INDEX($BJ$6:$BJ191,BZ46)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK46*1%, 1),\n  CF, $DB46,\n  CC, $CZ46,\n  CCUW, $DA46,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ191,BZ46+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC46,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY46*(Critical*DO46*$DQ46+DW46*UWCritical)))",
    "EG46": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK191,CA46)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH46,\n  Rapid, DG46,\n  DPM, (1+$DI46*$DJ46*$AQ$9),\n  Rend, $DN46,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK191,CA46+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM46*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46, $DB46), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK191,CA46+1)-1))/(45-CM46*3),1),\n\n  SL, $DQ46,\n  DW, $DR46,\n  CL, $DS46,\n  SM, $DT46,\n  SLM, $DU46,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY46*(DE46*OtherDamage*SL+UwDamage*DF46)))",
    "EH46": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL191,CB46+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL191,CB46)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH46,\n  Rapid, DG46,\n  DPM, (1+$DI46*$DJ46*$AQ$9),\n  SuperTower, $DL46,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL191,CB46+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY46*(DE46*OtherDamage*$DQ46+DW46*DF46)))",
    "EI46": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM191,CC46)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46, $DB46), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK46),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV46, $AR$29), 0),\n\n  DW, $DR46,\n  CL, $DS46,\n  SM, $DT46,\n  SL, $DQ46,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM46, UltCritCard),\nCY46*(DE46*DO46*SL+UwDamage*DF46)))",
    "EJ46": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN191,CD46)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT46,\n  DamageMastery, $CS46,\n  DemonMastery, $CX46,\n  SPB, INDEX($BN$5:$BN191,CD46+1),\n  ITO, $CV46,\n  Shock, $CW46,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE46*DO46*$DQ46+DW46*DF46)))",
    "EK46": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO191,CE46)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT46,\n  DamageMastery, $CS46,\n  DemonMastery, $CX46,\n  SPB, $CU46,\n  ITO, INDEX($BO$5:$BO191,CE46+1),\n  Shock, $CW46,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE46*DO46*$DQ46+DW46*DF46)))",
    "EL46": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP191,CF46)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46, $DB46), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP46),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF46),\n  CL, $DS46,\n  SM, $DT46,\n  SLM, $DU46,\n  SL, $DQ46,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM46, UltCritCard),\nCY46*(DE46*DO46*SL+UwDamage*DF46)))",
    "EM46": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ191,CG46)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG46+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN46": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR191,CH46)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46, $DB46), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH46+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP46),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK46),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM191,CC46), SMHeat, $AR$29), 0),\n\n  DW, $DR46,\n  CL, $DS46,\n  SL, $DQ46,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM46, UltCritCard),\nCY46*(DE46*DO46*SL+UwDamage*DF46)))",
    "EO46": "IF(OR(CI46 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI46+1))",
    "EP46": "IF(OR($AO$25, CJ46 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ46+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE190,BU46),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL46, 1),\n  DPM, (1+$DI46*CardRangeMastery*$DJ46*$AQ$9),\n  SuperTower, $DL46,\n  Rend, $DN46,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46, $DB46), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR46,\n  SM, $DT46,\n  SLM, $DU46,\n  SL, $DQ46,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM46, UltCritCard),\n\nCY46*(DE46*OtherDamage*SL+UwDamage*DF46)))",
    "EQ46": "IF(OR(CK46 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK46+1)*1%, 1),\n  CF, $DB46,\n  CC, MIN(100%, $CZ46 + 1%),\n  CCUW, DA46 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ191,BZ46) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC46 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR46,\n  CL, $DS46,\n  SM, $DT46,\n  SLM, $DU46,\n  SL, $DQ46,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM46, UltCritCard),\n\nCY46 * (Critical*DO46*SL+UwDamage*UWCritical)))",
    "ER46": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL46 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH191,BX46),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL46+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI46*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM191,CC46), $DV46, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH46,\n  Rapid, DG46,\n  SuperTower, $DL46,\n  Rend, $DN46,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM46,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46, $DB46), 1),\n\n  DW, $DR46,\n  CL, $DS46,\n  SM, $DT46,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY46*(DE46*OtherDamage*SL+UWDamage*DF46)))",
    "ES46": "IF(OR(CM46 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH46,\n  Rapid, DG46,\n  RDPM, (1+$DI46*$DJ46*$AQ$9),\n  Rend, $DN46,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK191,CA46),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM46+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46, $DB46), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR46,\n  CL, $DS46,\n  SM, $DT46,\n  SLM, $DU46,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY46*(DE46*OtherDamage*SL+UwDamage*DF46)))",
    "ET46": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN46 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM46,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN46+1, $DB46), 1),\n\n  DW, $DR46,\n  CL, $DS46,\n  SM, $DT46,\n  SLM, $DU46,\n  SL, $DQ46,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY46*(DE46*DO46*SL+UWDamage*DF46)))",
    "EU46": "IF(OR(NOT($BA$3), NOT($BA$23), $CO46 > $BA$15), \"\", 1 + 0.5*(CO46+1))",
    "EW46": "IF(DZ46=\"\", \"\", LET(\n  Now, CT46,\n  Next, DZ46,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT46),\nFactor/Cost))",
    "EX46": "IF(EA46=\"\",\"\",(EA46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU46))",
    "EY46": "IF(EB46=\"\",\"\",(EB46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV46))",
    "EZ46": "IF(EC46=\"\",\"\",(EC46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW46))",
    "FA46": "IF(ED46=\"\",\"\",(ED46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX46))",
    "FB46": "IF(EE46=\"\",\"\",(EE46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY46))",
    "FC46": "IF(EF46=\"\",\"\",(EF46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ46))",
    "FD46": "IF(EG46=\"\",\"\",(EG46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA46))",
    "FE46": "IF(EH46=\"\",\"\",(EH46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB46))",
    "FF46": "IF(EI46=\"\",\"\",(EI46/$DX46-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC46+1, 1, CC46))))",
    "FG46": "IF(EJ46=\"\",\"\",(EJ46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD46))",
    "FH46": "IF(EK46=\"\",\"\",(EK46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE46))",
    "FI46": "IF(EL46=\"\",\"\",(EL46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF46))",
    "FJ46": "IF(EM46=\"\", \"\", LET(\n  Now, CW46,\n  Next, EM46,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG46),\nFactor/Cost))",
    "FK46": "IF(EN46=\"\",\"\",(EN46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH46))",
    "FL46": "IF(EO46=\"\", \"\", LET(\n  Now, CS46,\n  Next, EO46,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI46),\nFactor/Cost))",
    "FM46": "IF(EP46=\"\",\"\",(EP46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ46))",
    "FN46": "IF(EQ46=\"\",\"\",(EQ46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK46))",
    "FO46": "IF(ER46=\"\",\"\",(ER46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL46))",
    "FP46": "IF(ES46=\"\",\"\",(ES46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM46))",
    "FQ46": "IF(ET46=\"\",\"\",(ET46/$DX46-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN46))",
    "FR46": "IF(EU46=\"\", \"\", LET(\n  Now, CX46,\n  Next, EU46,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO46),\nFactor/Cost))",
    "FT46": "IF(COLUMN(EW46:FR46) = MIN(IF(EW46:FR46=MAX(EW46:FR46), COLUMN(EW46:FR46))), 1, \"\")",
    "D47": "IF(SUM(FT46:GP46),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F47)),\"Card Mastery\",F47),G47)/$D$5,\"\")",
    "F47": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT46:GP46),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT46:GP46=1)),)\"),\"Attack Speed\")",
    "G47": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT46:GP46),ARRAYFORMULA(FILTER(BT46:CP46 , FT46:GP46=1)),\"\"\"\")\"),11.0)",
    "I47": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT46:GP46),ARRAYFORMULA(FILTER(EW46:FS46 , FT46:GP46=1))*D$5,\"\"\"\")\"),0.07007804433590342)",
    "K47": "IF(H47<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D47)),)",
    "BC47": "BC46+1",
    "BD47": "BD46+BD$3",
    "BE47": "BE46+BE$3",
    "BF47": "BF46+BF$3",
    "BG47": "BG46+BG$3",
    "BH47": "BH46+BH$3",
    "BI47": "BI46+BI$3",
    "BT47": "BT46+FT46",
    "BU47": "BU46+FU46",
    "BV47": "BV46+FV46",
    "BW47": "BW46+FW46",
    "BX47": "BX46+FX46",
    "BY47": "BY46+FY46",
    "BZ47": "BZ46+FZ46",
    "CA47": "CA46+GA46",
    "CB47": "CB46+GB46",
    "CC47": "CC46+GC46",
    "CD47": "CD46+GD46",
    "CE47": "CE46+GE46",
    "CF47": "CF46+GF46",
    "CG47": "CG46+GG46",
    "CH47": "CH46+GH46",
    "CI47": "CI46+GI46",
    "CJ47": "CJ46+GJ46",
    "CK47": "CK46+GK46",
    "CL47": "CL46+GL46",
    "CM47": "CM46+GM46",
    "CN47": "CN46+GN46",
    "CO47": "CO46+GO46",
    "CS47": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI47,1)",
    "CT47": "INDEX($BD$5:$BD192,BT47)",
    "CU47": "INDEX($BN$5:$BN192,CD47)",
    "CV47": "INDEX($BO$5:$BO192,CE47)",
    "CW47": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG47)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX47": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO47, 1)",
    "CY47": "LET(\n  Base, $CR$6,\n  Damage, $CT47,\n  DamageMastery, $CS47,\n  DemonMastery, $CX47,\n  SPB, $CU47,\n  ITO, $CV47,\n  Shock, $CW47,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ47": "MIN(100%, DA47)",
    "DA47": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK47*1%, 0)",
    "DB47": "LET(\n  Lab, 1+INDEX($BF$5:$BF192,BV47),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC47": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK47*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI192,BY47) + CardCritMastery)",
    "DD47": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK47*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ192,BZ47) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE47": "LET(\n  CF, $DB47,\n  CC, $CZ47,\n  SCM, $DD47,\n  SCC, $DC47,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF47": "LET(\n  CF, $DB47,\n  CC, $DA47,\n  SCM, $DD47,\n  SCC, $DC47,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG47": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH47)), 0)",
    "DH47": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ47*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE192,BU47),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI47": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG192, BW47), 1) + $AE$9)",
    "DJ47": "LET(\n  DpmLab, INDEX($BH$5:$BH192,BX47),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL47, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK47": "(1+$DI47*$DJ47*$AQ$9)",
    "DL47": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK192,CA47),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM47*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM47": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK192,CA47),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM47*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN47": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL192,CB47)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO47": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH47,\n  Rapid, DG47,\n  RDPM, DK47,\n  SuperTower, $DL47,\n  Rend, $DN47,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP47": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ47": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK47),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR47": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP47),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF47-1))",
    "DS47": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG47, DH47),0))",
    "DT47": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP47),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV47, $AR$29), 0))",
    "DU47": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK47),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM192,CC47), $DV47, $AR$29), 0))",
    "DV47": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH47), $AO$29)",
    "DW47": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM47,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47, $DB47), 1),\n\n  DW, $DR47,\n  CL, $DS47,\n  SM, $DT47,\n  SLM, $DU47,\n  SL, $DQ47,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX47": "CY47*(DE47*DO47*DQ47+DW47*DF47)",
    "DZ47": "IF(INDEX($BD$6:$BD192,BT47)=\"\", \"\", INDEX($BD$5:$BD192,BT47+1))",
    "EA47": "IF(OR($AO$25, INDEX($BE$6:$BE192,BU47)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ47)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE192,BU47+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI47*$DJ47*$AQ$9),\n  SuperTower, $DL47,\n  Rend, $DN47,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47, $DB47), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR47,\n  SM, $DT47,\n  SLM, $DU47,\n  SL, $DQ47,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM47, UltCritCard),\n\nCY47*(DE47*OtherDamage*SL+UwDamage*DF47)))",
    "EB47": "IF(INDEX($BF$6:$BF192,BV47)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF192,BV47+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ47,\n  CCUW, $DA47,\n  SCM, $DD47,\n  SCC, $DC47,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47, CF), 1),\n\n  DW, $DR47,\n  CL, $DS47,\n  SM, $DT47,\n  SLM, $DU47,\n  SL, $DQ47,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM47, UltCritCard),\n\nCY47 * (Critical * DO47 * SL + UwDamage * UWCritical)))",
    "EC47": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG192,BW47)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH47,\n  Rapid, DG47,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG192, BW47+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ47*$AQ$9),\n  SuperTower, $DL47,\n  Rend, $DN47,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM192,CC47), $DV47, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM47,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47, $DB47), 1),\n\n  DW, $DR47,\n  CL, $DS47,\n  SM, $DT47,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY47*(DE47*OtherDamage*SL+UWDamage*DF47)))",
    "ED47": "IF(OR($AO$25, INDEX($BH$6:$BH192,BX47)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH192,BX47+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL47, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI47*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM192,CC47), $DV47, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH47,\n  Rapid, DG47,\n  SuperTower, $DL47,\n  Rend, $DN47,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM47,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47, $DB47), 1),\n\n  DW, $DR47,\n  CL, $DS47,\n  SM, $DT47,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY47*(DE47*OtherDamage*SL+UWDamage*DF47)))",
    "EE47": "IF(INDEX($BI$6:$BI192,BY47)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK47, 0),\n  CF, $DB47,\n  CC, $CZ47,\n  CCUW, $DA47,\n  SCM, $DD47,\n  SCC, $AV$17+INDEX($BI$5:$BI192,BY47+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY47 * (Critical*DO47*$DQ47+DW47*UWCritical)))",
    "EF47": "IF(INDEX($BJ$6:$BJ192,BZ47)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK47*1%, 1),\n  CF, $DB47,\n  CC, $CZ47,\n  CCUW, $DA47,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ192,BZ47+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC47,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY47*(Critical*DO47*$DQ47+DW47*UWCritical)))",
    "EG47": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK192,CA47)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH47,\n  Rapid, DG47,\n  DPM, (1+$DI47*$DJ47*$AQ$9),\n  Rend, $DN47,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK192,CA47+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM47*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47, $DB47), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK192,CA47+1)-1))/(45-CM47*3),1),\n\n  SL, $DQ47,\n  DW, $DR47,\n  CL, $DS47,\n  SM, $DT47,\n  SLM, $DU47,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY47*(DE47*OtherDamage*SL+UwDamage*DF47)))",
    "EH47": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL192,CB47+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL192,CB47)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH47,\n  Rapid, DG47,\n  DPM, (1+$DI47*$DJ47*$AQ$9),\n  SuperTower, $DL47,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL192,CB47+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY47*(DE47*OtherDamage*$DQ47+DW47*DF47)))",
    "EI47": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM192,CC47)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47, $DB47), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK47),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV47, $AR$29), 0),\n\n  DW, $DR47,\n  CL, $DS47,\n  SM, $DT47,\n  SL, $DQ47,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM47, UltCritCard),\nCY47*(DE47*DO47*SL+UwDamage*DF47)))",
    "EJ47": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN192,CD47)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT47,\n  DamageMastery, $CS47,\n  DemonMastery, $CX47,\n  SPB, INDEX($BN$5:$BN192,CD47+1),\n  ITO, $CV47,\n  Shock, $CW47,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE47*DO47*$DQ47+DW47*DF47)))",
    "EK47": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO192,CE47)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT47,\n  DamageMastery, $CS47,\n  DemonMastery, $CX47,\n  SPB, $CU47,\n  ITO, INDEX($BO$5:$BO192,CE47+1),\n  Shock, $CW47,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE47*DO47*$DQ47+DW47*DF47)))",
    "EL47": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP192,CF47)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47, $DB47), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP47),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF47),\n  CL, $DS47,\n  SM, $DT47,\n  SLM, $DU47,\n  SL, $DQ47,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM47, UltCritCard),\nCY47*(DE47*DO47*SL+UwDamage*DF47)))",
    "EM47": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ192,CG47)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG47+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN47": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR192,CH47)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47, $DB47), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH47+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP47),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK47),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM192,CC47), SMHeat, $AR$29), 0),\n\n  DW, $DR47,\n  CL, $DS47,\n  SL, $DQ47,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM47, UltCritCard),\nCY47*(DE47*DO47*SL+UwDamage*DF47)))",
    "EO47": "IF(OR(CI47 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI47+1))",
    "EP47": "IF(OR($AO$25, CJ47 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ47+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE191,BU47),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL47, 1),\n  DPM, (1+$DI47*CardRangeMastery*$DJ47*$AQ$9),\n  SuperTower, $DL47,\n  Rend, $DN47,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47, $DB47), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR47,\n  SM, $DT47,\n  SLM, $DU47,\n  SL, $DQ47,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM47, UltCritCard),\n\nCY47*(DE47*OtherDamage*SL+UwDamage*DF47)))",
    "EQ47": "IF(OR(CK47 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK47+1)*1%, 1),\n  CF, $DB47,\n  CC, MIN(100%, $CZ47 + 1%),\n  CCUW, DA47 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ192,BZ47) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC47 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR47,\n  CL, $DS47,\n  SM, $DT47,\n  SLM, $DU47,\n  SL, $DQ47,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM47, UltCritCard),\n\nCY47 * (Critical*DO47*SL+UwDamage*UWCritical)))",
    "ER47": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL47 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH192,BX47),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL47+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI47*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM192,CC47), $DV47, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH47,\n  Rapid, DG47,\n  SuperTower, $DL47,\n  Rend, $DN47,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM47,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47, $DB47), 1),\n\n  DW, $DR47,\n  CL, $DS47,\n  SM, $DT47,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY47*(DE47*OtherDamage*SL+UWDamage*DF47)))",
    "ES47": "IF(OR(CM47 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH47,\n  Rapid, DG47,\n  RDPM, (1+$DI47*$DJ47*$AQ$9),\n  Rend, $DN47,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK192,CA47),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM47+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47, $DB47), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR47,\n  CL, $DS47,\n  SM, $DT47,\n  SLM, $DU47,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY47*(DE47*OtherDamage*SL+UwDamage*DF47)))",
    "ET47": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN47 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM47,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN47+1, $DB47), 1),\n\n  DW, $DR47,\n  CL, $DS47,\n  SM, $DT47,\n  SLM, $DU47,\n  SL, $DQ47,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY47*(DE47*DO47*SL+UWDamage*DF47)))",
    "EU47": "IF(OR(NOT($BA$3), NOT($BA$23), $CO47 > $BA$15), \"\", 1 + 0.5*(CO47+1))",
    "EW47": "IF(DZ47=\"\", \"\", LET(\n  Now, CT47,\n  Next, DZ47,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT47),\nFactor/Cost))",
    "EX47": "IF(EA47=\"\",\"\",(EA47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU47))",
    "EY47": "IF(EB47=\"\",\"\",(EB47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV47))",
    "EZ47": "IF(EC47=\"\",\"\",(EC47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW47))",
    "FA47": "IF(ED47=\"\",\"\",(ED47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX47))",
    "FB47": "IF(EE47=\"\",\"\",(EE47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY47))",
    "FC47": "IF(EF47=\"\",\"\",(EF47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ47))",
    "FD47": "IF(EG47=\"\",\"\",(EG47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA47))",
    "FE47": "IF(EH47=\"\",\"\",(EH47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB47))",
    "FF47": "IF(EI47=\"\",\"\",(EI47/$DX47-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC47+1, 1, CC47))))",
    "FG47": "IF(EJ47=\"\",\"\",(EJ47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD47))",
    "FH47": "IF(EK47=\"\",\"\",(EK47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE47))",
    "FI47": "IF(EL47=\"\",\"\",(EL47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF47))",
    "FJ47": "IF(EM47=\"\", \"\", LET(\n  Now, CW47,\n  Next, EM47,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG47),\nFactor/Cost))",
    "FK47": "IF(EN47=\"\",\"\",(EN47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH47))",
    "FL47": "IF(EO47=\"\", \"\", LET(\n  Now, CS47,\n  Next, EO47,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI47),\nFactor/Cost))",
    "FM47": "IF(EP47=\"\",\"\",(EP47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ47))",
    "FN47": "IF(EQ47=\"\",\"\",(EQ47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK47))",
    "FO47": "IF(ER47=\"\",\"\",(ER47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL47))",
    "FP47": "IF(ES47=\"\",\"\",(ES47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM47))",
    "FQ47": "IF(ET47=\"\",\"\",(ET47/$DX47-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN47))",
    "FR47": "IF(EU47=\"\", \"\", LET(\n  Now, CX47,\n  Next, EU47,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO47),\nFactor/Cost))",
    "FT47": "IF(COLUMN(EW47:FR47) = MIN(IF(EW47:FR47=MAX(EW47:FR47), COLUMN(EW47:FR47))), 1, \"\")",
    "D48": "IF(SUM(FT47:GP47),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F48)),\"Card Mastery\",F48),G48)/$D$5,\"\")",
    "F48": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT47:GP47),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT47:GP47=1)),)\"),\"Damage\")",
    "G48": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT47:GP47),ARRAYFORMULA(FILTER(BT47:CP47 , FT47:GP47=1)),\"\"\"\")\"),11.0)",
    "I48": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT47:GP47),ARRAYFORMULA(FILTER(EW47:FS47 , FT47:GP47=1))*D$5,\"\"\"\")\"),0.06997084548104932)",
    "K48": "IF(H48<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D48)),)",
    "BC48": "BC47+1",
    "BD48": "BD47+BD$3",
    "BE48": "BE47+BE$3",
    "BF48": "BF47+BF$3",
    "BG48": "BG47+BG$3",
    "BH48": "BH47+BH$3",
    "BI48": "BI47+BI$3",
    "BT48": "BT47+FT47",
    "BU48": "BU47+FU47",
    "BV48": "BV47+FV47",
    "BW48": "BW47+FW47",
    "BX48": "BX47+FX47",
    "BY48": "BY47+FY47",
    "BZ48": "BZ47+FZ47",
    "CA48": "CA47+GA47",
    "CB48": "CB47+GB47",
    "CC48": "CC47+GC47",
    "CD48": "CD47+GD47",
    "CE48": "CE47+GE47",
    "CF48": "CF47+GF47",
    "CG48": "CG47+GG47",
    "CH48": "CH47+GH47",
    "CI48": "CI47+GI47",
    "CJ48": "CJ47+GJ47",
    "CK48": "CK47+GK47",
    "CL48": "CL47+GL47",
    "CM48": "CM47+GM47",
    "CN48": "CN47+GN47",
    "CO48": "CO47+GO47",
    "CS48": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI48,1)",
    "CT48": "INDEX($BD$5:$BD193,BT48)",
    "CU48": "INDEX($BN$5:$BN193,CD48)",
    "CV48": "INDEX($BO$5:$BO193,CE48)",
    "CW48": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG48)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX48": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO48, 1)",
    "CY48": "LET(\n  Base, $CR$6,\n  Damage, $CT48,\n  DamageMastery, $CS48,\n  DemonMastery, $CX48,\n  SPB, $CU48,\n  ITO, $CV48,\n  Shock, $CW48,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ48": "MIN(100%, DA48)",
    "DA48": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK48*1%, 0)",
    "DB48": "LET(\n  Lab, 1+INDEX($BF$5:$BF193,BV48),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC48": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK48*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI193,BY48) + CardCritMastery)",
    "DD48": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK48*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ193,BZ48) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE48": "LET(\n  CF, $DB48,\n  CC, $CZ48,\n  SCM, $DD48,\n  SCC, $DC48,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF48": "LET(\n  CF, $DB48,\n  CC, $DA48,\n  SCM, $DD48,\n  SCC, $DC48,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG48": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH48)), 0)",
    "DH48": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ48*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE193,BU48),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI48": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG193, BW48), 1) + $AE$9)",
    "DJ48": "LET(\n  DpmLab, INDEX($BH$5:$BH193,BX48),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL48, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK48": "(1+$DI48*$DJ48*$AQ$9)",
    "DL48": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK193,CA48),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM48*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM48": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK193,CA48),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM48*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN48": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL193,CB48)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO48": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH48,\n  Rapid, DG48,\n  RDPM, DK48,\n  SuperTower, $DL48,\n  Rend, $DN48,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP48": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ48": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK48),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR48": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP48),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF48-1))",
    "DS48": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG48, DH48),0))",
    "DT48": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP48),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV48, $AR$29), 0))",
    "DU48": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK48),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM193,CC48), $DV48, $AR$29), 0))",
    "DV48": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH48), $AO$29)",
    "DW48": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM48,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48, $DB48), 1),\n\n  DW, $DR48,\n  CL, $DS48,\n  SM, $DT48,\n  SLM, $DU48,\n  SL, $DQ48,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX48": "CY48*(DE48*DO48*DQ48+DW48*DF48)",
    "DZ48": "IF(INDEX($BD$6:$BD193,BT48)=\"\", \"\", INDEX($BD$5:$BD193,BT48+1))",
    "EA48": "IF(OR($AO$25, INDEX($BE$6:$BE193,BU48)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ48)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE193,BU48+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI48*$DJ48*$AQ$9),\n  SuperTower, $DL48,\n  Rend, $DN48,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48, $DB48), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR48,\n  SM, $DT48,\n  SLM, $DU48,\n  SL, $DQ48,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM48, UltCritCard),\n\nCY48*(DE48*OtherDamage*SL+UwDamage*DF48)))",
    "EB48": "IF(INDEX($BF$6:$BF193,BV48)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF193,BV48+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ48,\n  CCUW, $DA48,\n  SCM, $DD48,\n  SCC, $DC48,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48, CF), 1),\n\n  DW, $DR48,\n  CL, $DS48,\n  SM, $DT48,\n  SLM, $DU48,\n  SL, $DQ48,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM48, UltCritCard),\n\nCY48 * (Critical * DO48 * SL + UwDamage * UWCritical)))",
    "EC48": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG193,BW48)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH48,\n  Rapid, DG48,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG193, BW48+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ48*$AQ$9),\n  SuperTower, $DL48,\n  Rend, $DN48,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM193,CC48), $DV48, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM48,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48, $DB48), 1),\n\n  DW, $DR48,\n  CL, $DS48,\n  SM, $DT48,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY48*(DE48*OtherDamage*SL+UWDamage*DF48)))",
    "ED48": "IF(OR($AO$25, INDEX($BH$6:$BH193,BX48)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH193,BX48+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL48, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI48*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM193,CC48), $DV48, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH48,\n  Rapid, DG48,\n  SuperTower, $DL48,\n  Rend, $DN48,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM48,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48, $DB48), 1),\n\n  DW, $DR48,\n  CL, $DS48,\n  SM, $DT48,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY48*(DE48*OtherDamage*SL+UWDamage*DF48)))",
    "EE48": "IF(INDEX($BI$6:$BI193,BY48)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK48, 0),\n  CF, $DB48,\n  CC, $CZ48,\n  CCUW, $DA48,\n  SCM, $DD48,\n  SCC, $AV$17+INDEX($BI$5:$BI193,BY48+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY48 * (Critical*DO48*$DQ48+DW48*UWCritical)))",
    "EF48": "IF(INDEX($BJ$6:$BJ193,BZ48)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK48*1%, 1),\n  CF, $DB48,\n  CC, $CZ48,\n  CCUW, $DA48,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ193,BZ48+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC48,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY48*(Critical*DO48*$DQ48+DW48*UWCritical)))",
    "EG48": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK193,CA48)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH48,\n  Rapid, DG48,\n  DPM, (1+$DI48*$DJ48*$AQ$9),\n  Rend, $DN48,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK193,CA48+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM48*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48, $DB48), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK193,CA48+1)-1))/(45-CM48*3),1),\n\n  SL, $DQ48,\n  DW, $DR48,\n  CL, $DS48,\n  SM, $DT48,\n  SLM, $DU48,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY48*(DE48*OtherDamage*SL+UwDamage*DF48)))",
    "EH48": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL193,CB48+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL193,CB48)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH48,\n  Rapid, DG48,\n  DPM, (1+$DI48*$DJ48*$AQ$9),\n  SuperTower, $DL48,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL193,CB48+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY48*(DE48*OtherDamage*$DQ48+DW48*DF48)))",
    "EI48": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM193,CC48)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48, $DB48), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK48),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV48, $AR$29), 0),\n\n  DW, $DR48,\n  CL, $DS48,\n  SM, $DT48,\n  SL, $DQ48,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM48, UltCritCard),\nCY48*(DE48*DO48*SL+UwDamage*DF48)))",
    "EJ48": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN193,CD48)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT48,\n  DamageMastery, $CS48,\n  DemonMastery, $CX48,\n  SPB, INDEX($BN$5:$BN193,CD48+1),\n  ITO, $CV48,\n  Shock, $CW48,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE48*DO48*$DQ48+DW48*DF48)))",
    "EK48": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO193,CE48)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT48,\n  DamageMastery, $CS48,\n  DemonMastery, $CX48,\n  SPB, $CU48,\n  ITO, INDEX($BO$5:$BO193,CE48+1),\n  Shock, $CW48,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE48*DO48*$DQ48+DW48*DF48)))",
    "EL48": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP193,CF48)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48, $DB48), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP48),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF48),\n  CL, $DS48,\n  SM, $DT48,\n  SLM, $DU48,\n  SL, $DQ48,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM48, UltCritCard),\nCY48*(DE48*DO48*SL+UwDamage*DF48)))",
    "EM48": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ193,CG48)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG48+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN48": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR193,CH48)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48, $DB48), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH48+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP48),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK48),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM193,CC48), SMHeat, $AR$29), 0),\n\n  DW, $DR48,\n  CL, $DS48,\n  SL, $DQ48,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM48, UltCritCard),\nCY48*(DE48*DO48*SL+UwDamage*DF48)))",
    "EO48": "IF(OR(CI48 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI48+1))",
    "EP48": "IF(OR($AO$25, CJ48 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ48+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE192,BU48),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL48, 1),\n  DPM, (1+$DI48*CardRangeMastery*$DJ48*$AQ$9),\n  SuperTower, $DL48,\n  Rend, $DN48,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48, $DB48), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR48,\n  SM, $DT48,\n  SLM, $DU48,\n  SL, $DQ48,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM48, UltCritCard),\n\nCY48*(DE48*OtherDamage*SL+UwDamage*DF48)))",
    "EQ48": "IF(OR(CK48 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK48+1)*1%, 1),\n  CF, $DB48,\n  CC, MIN(100%, $CZ48 + 1%),\n  CCUW, DA48 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ193,BZ48) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC48 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR48,\n  CL, $DS48,\n  SM, $DT48,\n  SLM, $DU48,\n  SL, $DQ48,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM48, UltCritCard),\n\nCY48 * (Critical*DO48*SL+UwDamage*UWCritical)))",
    "ER48": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL48 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH193,BX48),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL48+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI48*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM193,CC48), $DV48, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH48,\n  Rapid, DG48,\n  SuperTower, $DL48,\n  Rend, $DN48,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM48,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48, $DB48), 1),\n\n  DW, $DR48,\n  CL, $DS48,\n  SM, $DT48,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY48*(DE48*OtherDamage*SL+UWDamage*DF48)))",
    "ES48": "IF(OR(CM48 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH48,\n  Rapid, DG48,\n  RDPM, (1+$DI48*$DJ48*$AQ$9),\n  Rend, $DN48,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK193,CA48),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM48+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48, $DB48), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR48,\n  CL, $DS48,\n  SM, $DT48,\n  SLM, $DU48,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY48*(DE48*OtherDamage*SL+UwDamage*DF48)))",
    "ET48": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN48 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM48,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN48+1, $DB48), 1),\n\n  DW, $DR48,\n  CL, $DS48,\n  SM, $DT48,\n  SLM, $DU48,\n  SL, $DQ48,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY48*(DE48*DO48*SL+UWDamage*DF48)))",
    "EU48": "IF(OR(NOT($BA$3), NOT($BA$23), $CO48 > $BA$15), \"\", 1 + 0.5*(CO48+1))",
    "EW48": "IF(DZ48=\"\", \"\", LET(\n  Now, CT48,\n  Next, DZ48,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT48),\nFactor/Cost))",
    "EX48": "IF(EA48=\"\",\"\",(EA48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU48))",
    "EY48": "IF(EB48=\"\",\"\",(EB48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV48))",
    "EZ48": "IF(EC48=\"\",\"\",(EC48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW48))",
    "FA48": "IF(ED48=\"\",\"\",(ED48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX48))",
    "FB48": "IF(EE48=\"\",\"\",(EE48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY48))",
    "FC48": "IF(EF48=\"\",\"\",(EF48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ48))",
    "FD48": "IF(EG48=\"\",\"\",(EG48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA48))",
    "FE48": "IF(EH48=\"\",\"\",(EH48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB48))",
    "FF48": "IF(EI48=\"\",\"\",(EI48/$DX48-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC48+1, 1, CC48))))",
    "FG48": "IF(EJ48=\"\",\"\",(EJ48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD48))",
    "FH48": "IF(EK48=\"\",\"\",(EK48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE48))",
    "FI48": "IF(EL48=\"\",\"\",(EL48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF48))",
    "FJ48": "IF(EM48=\"\", \"\", LET(\n  Now, CW48,\n  Next, EM48,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG48),\nFactor/Cost))",
    "FK48": "IF(EN48=\"\",\"\",(EN48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH48))",
    "FL48": "IF(EO48=\"\", \"\", LET(\n  Now, CS48,\n  Next, EO48,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI48),\nFactor/Cost))",
    "FM48": "IF(EP48=\"\",\"\",(EP48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ48))",
    "FN48": "IF(EQ48=\"\",\"\",(EQ48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK48))",
    "FO48": "IF(ER48=\"\",\"\",(ER48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL48))",
    "FP48": "IF(ES48=\"\",\"\",(ES48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM48))",
    "FQ48": "IF(ET48=\"\",\"\",(ET48/$DX48-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN48))",
    "FR48": "IF(EU48=\"\", \"\", LET(\n  Now, CX48,\n  Next, EU48,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO48),\nFactor/Cost))",
    "FT48": "IF(COLUMN(EW48:FR48) = MIN(IF(EW48:FR48=MAX(EW48:FR48), COLUMN(EW48:FR48))), 1, \"\")",
    "D49": "IF(SUM(FT48:GP48),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F49)),\"Card Mastery\",F49),G49)/$D$5,\"\")",
    "F49": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT48:GP48),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT48:GP48=1)),)\"),\"Damage / Meter\")",
    "G49": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT48:GP48),ARRAYFORMULA(FILTER(BT48:CP48 , FT48:GP48=1)),\"\"\"\")\"),8.0)",
    "I49": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT48:GP48),ARRAYFORMULA(FILTER(EW48:FS48 , FT48:GP48=1))*D$5,\"\"\"\")\"),0.06640159971375681)",
    "K49": "IF(H49<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D49)),)",
    "BC49": "BC48+1",
    "BD49": "BD48+BD$3",
    "BE49": "BE48+BE$3",
    "BF49": "BF48+BF$3",
    "BG49": "BG48+BG$3",
    "BH49": "BH48+BH$3",
    "BI49": "BI48+BI$3",
    "BT49": "BT48+FT48",
    "BU49": "BU48+FU48",
    "BV49": "BV48+FV48",
    "BW49": "BW48+FW48",
    "BX49": "BX48+FX48",
    "BY49": "BY48+FY48",
    "BZ49": "BZ48+FZ48",
    "CA49": "CA48+GA48",
    "CB49": "CB48+GB48",
    "CC49": "CC48+GC48",
    "CD49": "CD48+GD48",
    "CE49": "CE48+GE48",
    "CF49": "CF48+GF48",
    "CG49": "CG48+GG48",
    "CH49": "CH48+GH48",
    "CI49": "CI48+GI48",
    "CJ49": "CJ48+GJ48",
    "CK49": "CK48+GK48",
    "CL49": "CL48+GL48",
    "CM49": "CM48+GM48",
    "CN49": "CN48+GN48",
    "CO49": "CO48+GO48",
    "CS49": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI49,1)",
    "CT49": "INDEX($BD$5:$BD194,BT49)",
    "CU49": "INDEX($BN$5:$BN194,CD49)",
    "CV49": "INDEX($BO$5:$BO194,CE49)",
    "CW49": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG49)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX49": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO49, 1)",
    "CY49": "LET(\n  Base, $CR$6,\n  Damage, $CT49,\n  DamageMastery, $CS49,\n  DemonMastery, $CX49,\n  SPB, $CU49,\n  ITO, $CV49,\n  Shock, $CW49,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ49": "MIN(100%, DA49)",
    "DA49": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK49*1%, 0)",
    "DB49": "LET(\n  Lab, 1+INDEX($BF$5:$BF194,BV49),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC49": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK49*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI194,BY49) + CardCritMastery)",
    "DD49": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK49*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ194,BZ49) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE49": "LET(\n  CF, $DB49,\n  CC, $CZ49,\n  SCM, $DD49,\n  SCC, $DC49,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF49": "LET(\n  CF, $DB49,\n  CC, $DA49,\n  SCM, $DD49,\n  SCC, $DC49,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG49": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH49)), 0)",
    "DH49": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ49*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE194,BU49),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI49": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG194, BW49), 1) + $AE$9)",
    "DJ49": "LET(\n  DpmLab, INDEX($BH$5:$BH194,BX49),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL49, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK49": "(1+$DI49*$DJ49*$AQ$9)",
    "DL49": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK194,CA49),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM49*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM49": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK194,CA49),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM49*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN49": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL194,CB49)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO49": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH49,\n  Rapid, DG49,\n  RDPM, DK49,\n  SuperTower, $DL49,\n  Rend, $DN49,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP49": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ49": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK49),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR49": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP49),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF49-1))",
    "DS49": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG49, DH49),0))",
    "DT49": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP49),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV49, $AR$29), 0))",
    "DU49": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK49),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM194,CC49), $DV49, $AR$29), 0))",
    "DV49": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH49), $AO$29)",
    "DW49": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM49,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49, $DB49), 1),\n\n  DW, $DR49,\n  CL, $DS49,\n  SM, $DT49,\n  SLM, $DU49,\n  SL, $DQ49,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX49": "CY49*(DE49*DO49*DQ49+DW49*DF49)",
    "DZ49": "IF(INDEX($BD$6:$BD194,BT49)=\"\", \"\", INDEX($BD$5:$BD194,BT49+1))",
    "EA49": "IF(OR($AO$25, INDEX($BE$6:$BE194,BU49)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ49)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE194,BU49+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI49*$DJ49*$AQ$9),\n  SuperTower, $DL49,\n  Rend, $DN49,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49, $DB49), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR49,\n  SM, $DT49,\n  SLM, $DU49,\n  SL, $DQ49,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM49, UltCritCard),\n\nCY49*(DE49*OtherDamage*SL+UwDamage*DF49)))",
    "EB49": "IF(INDEX($BF$6:$BF194,BV49)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF194,BV49+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ49,\n  CCUW, $DA49,\n  SCM, $DD49,\n  SCC, $DC49,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49, CF), 1),\n\n  DW, $DR49,\n  CL, $DS49,\n  SM, $DT49,\n  SLM, $DU49,\n  SL, $DQ49,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM49, UltCritCard),\n\nCY49 * (Critical * DO49 * SL + UwDamage * UWCritical)))",
    "EC49": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG194,BW49)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH49,\n  Rapid, DG49,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG194, BW49+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ49*$AQ$9),\n  SuperTower, $DL49,\n  Rend, $DN49,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM194,CC49), $DV49, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM49,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49, $DB49), 1),\n\n  DW, $DR49,\n  CL, $DS49,\n  SM, $DT49,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY49*(DE49*OtherDamage*SL+UWDamage*DF49)))",
    "ED49": "IF(OR($AO$25, INDEX($BH$6:$BH194,BX49)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH194,BX49+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL49, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI49*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM194,CC49), $DV49, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH49,\n  Rapid, DG49,\n  SuperTower, $DL49,\n  Rend, $DN49,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM49,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49, $DB49), 1),\n\n  DW, $DR49,\n  CL, $DS49,\n  SM, $DT49,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY49*(DE49*OtherDamage*SL+UWDamage*DF49)))",
    "EE49": "IF(INDEX($BI$6:$BI194,BY49)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK49, 0),\n  CF, $DB49,\n  CC, $CZ49,\n  CCUW, $DA49,\n  SCM, $DD49,\n  SCC, $AV$17+INDEX($BI$5:$BI194,BY49+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY49 * (Critical*DO49*$DQ49+DW49*UWCritical)))",
    "EF49": "IF(INDEX($BJ$6:$BJ194,BZ49)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK49*1%, 1),\n  CF, $DB49,\n  CC, $CZ49,\n  CCUW, $DA49,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ194,BZ49+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC49,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY49*(Critical*DO49*$DQ49+DW49*UWCritical)))",
    "EG49": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK194,CA49)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH49,\n  Rapid, DG49,\n  DPM, (1+$DI49*$DJ49*$AQ$9),\n  Rend, $DN49,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK194,CA49+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM49*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49, $DB49), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK194,CA49+1)-1))/(45-CM49*3),1),\n\n  SL, $DQ49,\n  DW, $DR49,\n  CL, $DS49,\n  SM, $DT49,\n  SLM, $DU49,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY49*(DE49*OtherDamage*SL+UwDamage*DF49)))",
    "EH49": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL194,CB49+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL194,CB49)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH49,\n  Rapid, DG49,\n  DPM, (1+$DI49*$DJ49*$AQ$9),\n  SuperTower, $DL49,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL194,CB49+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY49*(DE49*OtherDamage*$DQ49+DW49*DF49)))",
    "EI49": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM194,CC49)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49, $DB49), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK49),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV49, $AR$29), 0),\n\n  DW, $DR49,\n  CL, $DS49,\n  SM, $DT49,\n  SL, $DQ49,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM49, UltCritCard),\nCY49*(DE49*DO49*SL+UwDamage*DF49)))",
    "EJ49": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN194,CD49)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT49,\n  DamageMastery, $CS49,\n  DemonMastery, $CX49,\n  SPB, INDEX($BN$5:$BN194,CD49+1),\n  ITO, $CV49,\n  Shock, $CW49,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE49*DO49*$DQ49+DW49*DF49)))",
    "EK49": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO194,CE49)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT49,\n  DamageMastery, $CS49,\n  DemonMastery, $CX49,\n  SPB, $CU49,\n  ITO, INDEX($BO$5:$BO194,CE49+1),\n  Shock, $CW49,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE49*DO49*$DQ49+DW49*DF49)))",
    "EL49": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP194,CF49)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49, $DB49), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP49),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF49),\n  CL, $DS49,\n  SM, $DT49,\n  SLM, $DU49,\n  SL, $DQ49,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM49, UltCritCard),\nCY49*(DE49*DO49*SL+UwDamage*DF49)))",
    "EM49": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ194,CG49)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG49+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN49": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR194,CH49)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49, $DB49), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH49+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP49),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK49),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM194,CC49), SMHeat, $AR$29), 0),\n\n  DW, $DR49,\n  CL, $DS49,\n  SL, $DQ49,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM49, UltCritCard),\nCY49*(DE49*DO49*SL+UwDamage*DF49)))",
    "EO49": "IF(OR(CI49 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI49+1))",
    "EP49": "IF(OR($AO$25, CJ49 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ49+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE193,BU49),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL49, 1),\n  DPM, (1+$DI49*CardRangeMastery*$DJ49*$AQ$9),\n  SuperTower, $DL49,\n  Rend, $DN49,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49, $DB49), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR49,\n  SM, $DT49,\n  SLM, $DU49,\n  SL, $DQ49,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM49, UltCritCard),\n\nCY49*(DE49*OtherDamage*SL+UwDamage*DF49)))",
    "EQ49": "IF(OR(CK49 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK49+1)*1%, 1),\n  CF, $DB49,\n  CC, MIN(100%, $CZ49 + 1%),\n  CCUW, DA49 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ194,BZ49) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC49 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR49,\n  CL, $DS49,\n  SM, $DT49,\n  SLM, $DU49,\n  SL, $DQ49,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM49, UltCritCard),\n\nCY49 * (Critical*DO49*SL+UwDamage*UWCritical)))",
    "ER49": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL49 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH194,BX49),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL49+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI49*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM194,CC49), $DV49, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH49,\n  Rapid, DG49,\n  SuperTower, $DL49,\n  Rend, $DN49,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM49,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49, $DB49), 1),\n\n  DW, $DR49,\n  CL, $DS49,\n  SM, $DT49,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY49*(DE49*OtherDamage*SL+UWDamage*DF49)))",
    "ES49": "IF(OR(CM49 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH49,\n  Rapid, DG49,\n  RDPM, (1+$DI49*$DJ49*$AQ$9),\n  Rend, $DN49,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK194,CA49),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM49+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49, $DB49), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR49,\n  CL, $DS49,\n  SM, $DT49,\n  SLM, $DU49,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY49*(DE49*OtherDamage*SL+UwDamage*DF49)))",
    "ET49": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN49 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM49,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN49+1, $DB49), 1),\n\n  DW, $DR49,\n  CL, $DS49,\n  SM, $DT49,\n  SLM, $DU49,\n  SL, $DQ49,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY49*(DE49*DO49*SL+UWDamage*DF49)))",
    "EU49": "IF(OR(NOT($BA$3), NOT($BA$23), $CO49 > $BA$15), \"\", 1 + 0.5*(CO49+1))",
    "EW49": "IF(DZ49=\"\", \"\", LET(\n  Now, CT49,\n  Next, DZ49,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT49),\nFactor/Cost))",
    "EX49": "IF(EA49=\"\",\"\",(EA49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU49))",
    "EY49": "IF(EB49=\"\",\"\",(EB49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV49))",
    "EZ49": "IF(EC49=\"\",\"\",(EC49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW49))",
    "FA49": "IF(ED49=\"\",\"\",(ED49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX49))",
    "FB49": "IF(EE49=\"\",\"\",(EE49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY49))",
    "FC49": "IF(EF49=\"\",\"\",(EF49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ49))",
    "FD49": "IF(EG49=\"\",\"\",(EG49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA49))",
    "FE49": "IF(EH49=\"\",\"\",(EH49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB49))",
    "FF49": "IF(EI49=\"\",\"\",(EI49/$DX49-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC49+1, 1, CC49))))",
    "FG49": "IF(EJ49=\"\",\"\",(EJ49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD49))",
    "FH49": "IF(EK49=\"\",\"\",(EK49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE49))",
    "FI49": "IF(EL49=\"\",\"\",(EL49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF49))",
    "FJ49": "IF(EM49=\"\", \"\", LET(\n  Now, CW49,\n  Next, EM49,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG49),\nFactor/Cost))",
    "FK49": "IF(EN49=\"\",\"\",(EN49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH49))",
    "FL49": "IF(EO49=\"\", \"\", LET(\n  Now, CS49,\n  Next, EO49,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI49),\nFactor/Cost))",
    "FM49": "IF(EP49=\"\",\"\",(EP49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ49))",
    "FN49": "IF(EQ49=\"\",\"\",(EQ49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK49))",
    "FO49": "IF(ER49=\"\",\"\",(ER49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL49))",
    "FP49": "IF(ES49=\"\",\"\",(ES49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM49))",
    "FQ49": "IF(ET49=\"\",\"\",(ET49/$DX49-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN49))",
    "FR49": "IF(EU49=\"\", \"\", LET(\n  Now, CX49,\n  Next, EU49,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO49),\nFactor/Cost))",
    "FT49": "IF(COLUMN(EW49:FR49) = MIN(IF(EW49:FR49=MAX(EW49:FR49), COLUMN(EW49:FR49))), 1, \"\")",
    "D50": "IF(SUM(FT49:GP49),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F50)),\"Card Mastery\",F50),G50)/$D$5,\"\")",
    "F50": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT49:GP49),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT49:GP49=1)),)\"),\"Critical Factor\")",
    "G50": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT49:GP49),ARRAYFORMULA(FILTER(BT49:CP49 , FT49:GP49=1)),\"\"\"\")\"),13.0)",
    "I50": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT49:GP49),ARRAYFORMULA(FILTER(EW49:FS49 , FT49:GP49=1))*D$5,\"\"\"\")\"),0.061900171428036055)",
    "K50": "IF(H50<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D50)),)",
    "BC50": "BC49+1",
    "BD50": "BD49+BD$3",
    "BE50": "BE49+BE$3",
    "BF50": "BF49+BF$3",
    "BG50": "BG49+BG$3",
    "BH50": "BH49+BH$3",
    "BI50": "BI49+BI$3",
    "BT50": "BT49+FT49",
    "BU50": "BU49+FU49",
    "BV50": "BV49+FV49",
    "BW50": "BW49+FW49",
    "BX50": "BX49+FX49",
    "BY50": "BY49+FY49",
    "BZ50": "BZ49+FZ49",
    "CA50": "CA49+GA49",
    "CB50": "CB49+GB49",
    "CC50": "CC49+GC49",
    "CD50": "CD49+GD49",
    "CE50": "CE49+GE49",
    "CF50": "CF49+GF49",
    "CG50": "CG49+GG49",
    "CH50": "CH49+GH49",
    "CI50": "CI49+GI49",
    "CJ50": "CJ49+GJ49",
    "CK50": "CK49+GK49",
    "CL50": "CL49+GL49",
    "CM50": "CM49+GM49",
    "CN50": "CN49+GN49",
    "CO50": "CO49+GO49",
    "CS50": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI50,1)",
    "CT50": "INDEX($BD$5:$BD195,BT50)",
    "CU50": "INDEX($BN$5:$BN195,CD50)",
    "CV50": "INDEX($BO$5:$BO195,CE50)",
    "CW50": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG50)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX50": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO50, 1)",
    "CY50": "LET(\n  Base, $CR$6,\n  Damage, $CT50,\n  DamageMastery, $CS50,\n  DemonMastery, $CX50,\n  SPB, $CU50,\n  ITO, $CV50,\n  Shock, $CW50,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ50": "MIN(100%, DA50)",
    "DA50": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK50*1%, 0)",
    "DB50": "LET(\n  Lab, 1+INDEX($BF$5:$BF195,BV50),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC50": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK50*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI195,BY50) + CardCritMastery)",
    "DD50": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK50*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ195,BZ50) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE50": "LET(\n  CF, $DB50,\n  CC, $CZ50,\n  SCM, $DD50,\n  SCC, $DC50,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF50": "LET(\n  CF, $DB50,\n  CC, $DA50,\n  SCM, $DD50,\n  SCC, $DC50,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG50": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH50)), 0)",
    "DH50": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ50*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE195,BU50),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI50": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG195, BW50), 1) + $AE$9)",
    "DJ50": "LET(\n  DpmLab, INDEX($BH$5:$BH195,BX50),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL50, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK50": "(1+$DI50*$DJ50*$AQ$9)",
    "DL50": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK195,CA50),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM50*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM50": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK195,CA50),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM50*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN50": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL195,CB50)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO50": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH50,\n  Rapid, DG50,\n  RDPM, DK50,\n  SuperTower, $DL50,\n  Rend, $DN50,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP50": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ50": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK50),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR50": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP50),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF50-1))",
    "DS50": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG50, DH50),0))",
    "DT50": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP50),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV50, $AR$29), 0))",
    "DU50": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK50),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM195,CC50), $DV50, $AR$29), 0))",
    "DV50": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH50), $AO$29)",
    "DW50": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM50,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50, $DB50), 1),\n\n  DW, $DR50,\n  CL, $DS50,\n  SM, $DT50,\n  SLM, $DU50,\n  SL, $DQ50,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX50": "CY50*(DE50*DO50*DQ50+DW50*DF50)",
    "DZ50": "IF(INDEX($BD$6:$BD195,BT50)=\"\", \"\", INDEX($BD$5:$BD195,BT50+1))",
    "EA50": "IF(OR($AO$25, INDEX($BE$6:$BE195,BU50)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ50)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE195,BU50+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI50*$DJ50*$AQ$9),\n  SuperTower, $DL50,\n  Rend, $DN50,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50, $DB50), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR50,\n  SM, $DT50,\n  SLM, $DU50,\n  SL, $DQ50,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM50, UltCritCard),\n\nCY50*(DE50*OtherDamage*SL+UwDamage*DF50)))",
    "EB50": "IF(INDEX($BF$6:$BF195,BV50)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF195,BV50+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ50,\n  CCUW, $DA50,\n  SCM, $DD50,\n  SCC, $DC50,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50, CF), 1),\n\n  DW, $DR50,\n  CL, $DS50,\n  SM, $DT50,\n  SLM, $DU50,\n  SL, $DQ50,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM50, UltCritCard),\n\nCY50 * (Critical * DO50 * SL + UwDamage * UWCritical)))",
    "EC50": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG195,BW50)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH50,\n  Rapid, DG50,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG195, BW50+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ50*$AQ$9),\n  SuperTower, $DL50,\n  Rend, $DN50,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM195,CC50), $DV50, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM50,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50, $DB50), 1),\n\n  DW, $DR50,\n  CL, $DS50,\n  SM, $DT50,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY50*(DE50*OtherDamage*SL+UWDamage*DF50)))",
    "ED50": "IF(OR($AO$25, INDEX($BH$6:$BH195,BX50)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH195,BX50+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL50, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI50*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM195,CC50), $DV50, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH50,\n  Rapid, DG50,\n  SuperTower, $DL50,\n  Rend, $DN50,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM50,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50, $DB50), 1),\n\n  DW, $DR50,\n  CL, $DS50,\n  SM, $DT50,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY50*(DE50*OtherDamage*SL+UWDamage*DF50)))",
    "EE50": "IF(INDEX($BI$6:$BI195,BY50)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK50, 0),\n  CF, $DB50,\n  CC, $CZ50,\n  CCUW, $DA50,\n  SCM, $DD50,\n  SCC, $AV$17+INDEX($BI$5:$BI195,BY50+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY50 * (Critical*DO50*$DQ50+DW50*UWCritical)))",
    "EF50": "IF(INDEX($BJ$6:$BJ195,BZ50)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK50*1%, 1),\n  CF, $DB50,\n  CC, $CZ50,\n  CCUW, $DA50,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ195,BZ50+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC50,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY50*(Critical*DO50*$DQ50+DW50*UWCritical)))",
    "EG50": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK195,CA50)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH50,\n  Rapid, DG50,\n  DPM, (1+$DI50*$DJ50*$AQ$9),\n  Rend, $DN50,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK195,CA50+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM50*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50, $DB50), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK195,CA50+1)-1))/(45-CM50*3),1),\n\n  SL, $DQ50,\n  DW, $DR50,\n  CL, $DS50,\n  SM, $DT50,\n  SLM, $DU50,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY50*(DE50*OtherDamage*SL+UwDamage*DF50)))",
    "EH50": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL195,CB50+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL195,CB50)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH50,\n  Rapid, DG50,\n  DPM, (1+$DI50*$DJ50*$AQ$9),\n  SuperTower, $DL50,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL195,CB50+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY50*(DE50*OtherDamage*$DQ50+DW50*DF50)))",
    "EI50": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM195,CC50)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50, $DB50), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK50),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV50, $AR$29), 0),\n\n  DW, $DR50,\n  CL, $DS50,\n  SM, $DT50,\n  SL, $DQ50,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM50, UltCritCard),\nCY50*(DE50*DO50*SL+UwDamage*DF50)))",
    "EJ50": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN195,CD50)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT50,\n  DamageMastery, $CS50,\n  DemonMastery, $CX50,\n  SPB, INDEX($BN$5:$BN195,CD50+1),\n  ITO, $CV50,\n  Shock, $CW50,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE50*DO50*$DQ50+DW50*DF50)))",
    "EK50": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO195,CE50)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT50,\n  DamageMastery, $CS50,\n  DemonMastery, $CX50,\n  SPB, $CU50,\n  ITO, INDEX($BO$5:$BO195,CE50+1),\n  Shock, $CW50,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE50*DO50*$DQ50+DW50*DF50)))",
    "EL50": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP195,CF50)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50, $DB50), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP50),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF50),\n  CL, $DS50,\n  SM, $DT50,\n  SLM, $DU50,\n  SL, $DQ50,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM50, UltCritCard),\nCY50*(DE50*DO50*SL+UwDamage*DF50)))",
    "EM50": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ195,CG50)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG50+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN50": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR195,CH50)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50, $DB50), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH50+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP50),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK50),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM195,CC50), SMHeat, $AR$29), 0),\n\n  DW, $DR50,\n  CL, $DS50,\n  SL, $DQ50,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM50, UltCritCard),\nCY50*(DE50*DO50*SL+UwDamage*DF50)))",
    "EO50": "IF(OR(CI50 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI50+1))",
    "EP50": "IF(OR($AO$25, CJ50 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ50+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE194,BU50),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL50, 1),\n  DPM, (1+$DI50*CardRangeMastery*$DJ50*$AQ$9),\n  SuperTower, $DL50,\n  Rend, $DN50,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50, $DB50), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR50,\n  SM, $DT50,\n  SLM, $DU50,\n  SL, $DQ50,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM50, UltCritCard),\n\nCY50*(DE50*OtherDamage*SL+UwDamage*DF50)))",
    "EQ50": "IF(OR(CK50 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK50+1)*1%, 1),\n  CF, $DB50,\n  CC, MIN(100%, $CZ50 + 1%),\n  CCUW, DA50 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ195,BZ50) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC50 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR50,\n  CL, $DS50,\n  SM, $DT50,\n  SLM, $DU50,\n  SL, $DQ50,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM50, UltCritCard),\n\nCY50 * (Critical*DO50*SL+UwDamage*UWCritical)))",
    "ER50": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL50 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH195,BX50),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL50+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI50*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM195,CC50), $DV50, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH50,\n  Rapid, DG50,\n  SuperTower, $DL50,\n  Rend, $DN50,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM50,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50, $DB50), 1),\n\n  DW, $DR50,\n  CL, $DS50,\n  SM, $DT50,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY50*(DE50*OtherDamage*SL+UWDamage*DF50)))",
    "ES50": "IF(OR(CM50 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH50,\n  Rapid, DG50,\n  RDPM, (1+$DI50*$DJ50*$AQ$9),\n  Rend, $DN50,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK195,CA50),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM50+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50, $DB50), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR50,\n  CL, $DS50,\n  SM, $DT50,\n  SLM, $DU50,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY50*(DE50*OtherDamage*SL+UwDamage*DF50)))",
    "ET50": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN50 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM50,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN50+1, $DB50), 1),\n\n  DW, $DR50,\n  CL, $DS50,\n  SM, $DT50,\n  SLM, $DU50,\n  SL, $DQ50,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY50*(DE50*DO50*SL+UWDamage*DF50)))",
    "EU50": "IF(OR(NOT($BA$3), NOT($BA$23), $CO50 > $BA$15), \"\", 1 + 0.5*(CO50+1))",
    "EW50": "IF(DZ50=\"\", \"\", LET(\n  Now, CT50,\n  Next, DZ50,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT50),\nFactor/Cost))",
    "EX50": "IF(EA50=\"\",\"\",(EA50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU50))",
    "EY50": "IF(EB50=\"\",\"\",(EB50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV50))",
    "EZ50": "IF(EC50=\"\",\"\",(EC50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW50))",
    "FA50": "IF(ED50=\"\",\"\",(ED50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX50))",
    "FB50": "IF(EE50=\"\",\"\",(EE50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY50))",
    "FC50": "IF(EF50=\"\",\"\",(EF50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ50))",
    "FD50": "IF(EG50=\"\",\"\",(EG50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA50))",
    "FE50": "IF(EH50=\"\",\"\",(EH50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB50))",
    "FF50": "IF(EI50=\"\",\"\",(EI50/$DX50-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC50+1, 1, CC50))))",
    "FG50": "IF(EJ50=\"\",\"\",(EJ50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD50))",
    "FH50": "IF(EK50=\"\",\"\",(EK50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE50))",
    "FI50": "IF(EL50=\"\",\"\",(EL50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF50))",
    "FJ50": "IF(EM50=\"\", \"\", LET(\n  Now, CW50,\n  Next, EM50,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG50),\nFactor/Cost))",
    "FK50": "IF(EN50=\"\",\"\",(EN50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH50))",
    "FL50": "IF(EO50=\"\", \"\", LET(\n  Now, CS50,\n  Next, EO50,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI50),\nFactor/Cost))",
    "FM50": "IF(EP50=\"\",\"\",(EP50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ50))",
    "FN50": "IF(EQ50=\"\",\"\",(EQ50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK50))",
    "FO50": "IF(ER50=\"\",\"\",(ER50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL50))",
    "FP50": "IF(ES50=\"\",\"\",(ES50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM50))",
    "FQ50": "IF(ET50=\"\",\"\",(ET50/$DX50-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN50))",
    "FR50": "IF(EU50=\"\", \"\", LET(\n  Now, CX50,\n  Next, EU50,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO50),\nFactor/Cost))",
    "FT50": "IF(COLUMN(EW50:FR50) = MIN(IF(EW50:FR50=MAX(EW50:FR50), COLUMN(EW50:FR50))), 1, \"\")",
    "D51": "IF(SUM(FT50:GP50),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F51)),\"Card Mastery\",F51),G51)/$D$5,\"\")",
    "F51": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT50:GP50),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT50:GP50=1)),)\"),\"Attack Speed\")",
    "G51": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT50:GP50),ARRAYFORMULA(FILTER(BT50:CP50 , FT50:GP50=1)),\"\"\"\")\"),12.0)",
    "I51": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT50:GP50),ARRAYFORMULA(FILTER(EW50:FS50 , FT50:GP50=1))*D$5,\"\"\"\")\"),0.05582100087326459)",
    "K51": "IF(H51<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D51)),)",
    "BC51": "BC50+1",
    "BD51": "BD50+BD$3",
    "BE51": "BE50+BE$3",
    "BF51": "BF50+BF$3",
    "BG51": "BG50+BG$3",
    "BH51": "BH50+BH$3",
    "BI51": "BI50+BI$3",
    "BT51": "BT50+FT50",
    "BU51": "BU50+FU50",
    "BV51": "BV50+FV50",
    "BW51": "BW50+FW50",
    "BX51": "BX50+FX50",
    "BY51": "BY50+FY50",
    "BZ51": "BZ50+FZ50",
    "CA51": "CA50+GA50",
    "CB51": "CB50+GB50",
    "CC51": "CC50+GC50",
    "CD51": "CD50+GD50",
    "CE51": "CE50+GE50",
    "CF51": "CF50+GF50",
    "CG51": "CG50+GG50",
    "CH51": "CH50+GH50",
    "CI51": "CI50+GI50",
    "CJ51": "CJ50+GJ50",
    "CK51": "CK50+GK50",
    "CL51": "CL50+GL50",
    "CM51": "CM50+GM50",
    "CN51": "CN50+GN50",
    "CO51": "CO50+GO50",
    "CS51": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI51,1)",
    "CT51": "INDEX($BD$5:$BD196,BT51)",
    "CU51": "INDEX($BN$5:$BN196,CD51)",
    "CV51": "INDEX($BO$5:$BO196,CE51)",
    "CW51": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG51)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX51": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO51, 1)",
    "CY51": "LET(\n  Base, $CR$6,\n  Damage, $CT51,\n  DamageMastery, $CS51,\n  DemonMastery, $CX51,\n  SPB, $CU51,\n  ITO, $CV51,\n  Shock, $CW51,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ51": "MIN(100%, DA51)",
    "DA51": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK51*1%, 0)",
    "DB51": "LET(\n  Lab, 1+INDEX($BF$5:$BF196,BV51),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC51": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK51*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI196,BY51) + CardCritMastery)",
    "DD51": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK51*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ196,BZ51) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE51": "LET(\n  CF, $DB51,\n  CC, $CZ51,\n  SCM, $DD51,\n  SCC, $DC51,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF51": "LET(\n  CF, $DB51,\n  CC, $DA51,\n  SCM, $DD51,\n  SCC, $DC51,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG51": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH51)), 0)",
    "DH51": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ51*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE196,BU51),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI51": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG196, BW51), 1) + $AE$9)",
    "DJ51": "LET(\n  DpmLab, INDEX($BH$5:$BH196,BX51),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL51, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK51": "(1+$DI51*$DJ51*$AQ$9)",
    "DL51": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK196,CA51),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM51*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM51": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK196,CA51),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM51*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN51": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL196,CB51)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO51": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH51,\n  Rapid, DG51,\n  RDPM, DK51,\n  SuperTower, $DL51,\n  Rend, $DN51,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP51": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ51": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK51),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR51": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP51),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF51-1))",
    "DS51": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG51, DH51),0))",
    "DT51": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP51),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV51, $AR$29), 0))",
    "DU51": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK51),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM196,CC51), $DV51, $AR$29), 0))",
    "DV51": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH51), $AO$29)",
    "DW51": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM51,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51, $DB51), 1),\n\n  DW, $DR51,\n  CL, $DS51,\n  SM, $DT51,\n  SLM, $DU51,\n  SL, $DQ51,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX51": "CY51*(DE51*DO51*DQ51+DW51*DF51)",
    "DZ51": "IF(INDEX($BD$6:$BD196,BT51)=\"\", \"\", INDEX($BD$5:$BD196,BT51+1))",
    "EA51": "IF(OR($AO$25, INDEX($BE$6:$BE196,BU51)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ51)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE196,BU51+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI51*$DJ51*$AQ$9),\n  SuperTower, $DL51,\n  Rend, $DN51,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51, $DB51), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR51,\n  SM, $DT51,\n  SLM, $DU51,\n  SL, $DQ51,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM51, UltCritCard),\n\nCY51*(DE51*OtherDamage*SL+UwDamage*DF51)))",
    "EB51": "IF(INDEX($BF$6:$BF196,BV51)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF196,BV51+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ51,\n  CCUW, $DA51,\n  SCM, $DD51,\n  SCC, $DC51,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51, CF), 1),\n\n  DW, $DR51,\n  CL, $DS51,\n  SM, $DT51,\n  SLM, $DU51,\n  SL, $DQ51,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM51, UltCritCard),\n\nCY51 * (Critical * DO51 * SL + UwDamage * UWCritical)))",
    "EC51": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG196,BW51)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH51,\n  Rapid, DG51,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG196, BW51+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ51*$AQ$9),\n  SuperTower, $DL51,\n  Rend, $DN51,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM196,CC51), $DV51, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM51,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51, $DB51), 1),\n\n  DW, $DR51,\n  CL, $DS51,\n  SM, $DT51,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY51*(DE51*OtherDamage*SL+UWDamage*DF51)))",
    "ED51": "IF(OR($AO$25, INDEX($BH$6:$BH196,BX51)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH196,BX51+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL51, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI51*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM196,CC51), $DV51, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH51,\n  Rapid, DG51,\n  SuperTower, $DL51,\n  Rend, $DN51,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM51,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51, $DB51), 1),\n\n  DW, $DR51,\n  CL, $DS51,\n  SM, $DT51,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY51*(DE51*OtherDamage*SL+UWDamage*DF51)))",
    "EE51": "IF(INDEX($BI$6:$BI196,BY51)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK51, 0),\n  CF, $DB51,\n  CC, $CZ51,\n  CCUW, $DA51,\n  SCM, $DD51,\n  SCC, $AV$17+INDEX($BI$5:$BI196,BY51+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY51 * (Critical*DO51*$DQ51+DW51*UWCritical)))",
    "EF51": "IF(INDEX($BJ$6:$BJ196,BZ51)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK51*1%, 1),\n  CF, $DB51,\n  CC, $CZ51,\n  CCUW, $DA51,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ196,BZ51+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC51,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY51*(Critical*DO51*$DQ51+DW51*UWCritical)))",
    "EG51": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK196,CA51)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH51,\n  Rapid, DG51,\n  DPM, (1+$DI51*$DJ51*$AQ$9),\n  Rend, $DN51,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK196,CA51+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM51*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51, $DB51), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK196,CA51+1)-1))/(45-CM51*3),1),\n\n  SL, $DQ51,\n  DW, $DR51,\n  CL, $DS51,\n  SM, $DT51,\n  SLM, $DU51,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY51*(DE51*OtherDamage*SL+UwDamage*DF51)))",
    "EH51": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL196,CB51+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL196,CB51)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH51,\n  Rapid, DG51,\n  DPM, (1+$DI51*$DJ51*$AQ$9),\n  SuperTower, $DL51,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL196,CB51+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY51*(DE51*OtherDamage*$DQ51+DW51*DF51)))",
    "EI51": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM196,CC51)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51, $DB51), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK51),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV51, $AR$29), 0),\n\n  DW, $DR51,\n  CL, $DS51,\n  SM, $DT51,\n  SL, $DQ51,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM51, UltCritCard),\nCY51*(DE51*DO51*SL+UwDamage*DF51)))",
    "EJ51": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN196,CD51)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT51,\n  DamageMastery, $CS51,\n  DemonMastery, $CX51,\n  SPB, INDEX($BN$5:$BN196,CD51+1),\n  ITO, $CV51,\n  Shock, $CW51,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE51*DO51*$DQ51+DW51*DF51)))",
    "EK51": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO196,CE51)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT51,\n  DamageMastery, $CS51,\n  DemonMastery, $CX51,\n  SPB, $CU51,\n  ITO, INDEX($BO$5:$BO196,CE51+1),\n  Shock, $CW51,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE51*DO51*$DQ51+DW51*DF51)))",
    "EL51": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP196,CF51)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51, $DB51), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP51),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF51),\n  CL, $DS51,\n  SM, $DT51,\n  SLM, $DU51,\n  SL, $DQ51,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM51, UltCritCard),\nCY51*(DE51*DO51*SL+UwDamage*DF51)))",
    "EM51": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ196,CG51)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG51+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN51": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR196,CH51)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51, $DB51), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH51+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP51),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK51),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM196,CC51), SMHeat, $AR$29), 0),\n\n  DW, $DR51,\n  CL, $DS51,\n  SL, $DQ51,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM51, UltCritCard),\nCY51*(DE51*DO51*SL+UwDamage*DF51)))",
    "EO51": "IF(OR(CI51 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI51+1))",
    "EP51": "IF(OR($AO$25, CJ51 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ51+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE195,BU51),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL51, 1),\n  DPM, (1+$DI51*CardRangeMastery*$DJ51*$AQ$9),\n  SuperTower, $DL51,\n  Rend, $DN51,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51, $DB51), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR51,\n  SM, $DT51,\n  SLM, $DU51,\n  SL, $DQ51,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM51, UltCritCard),\n\nCY51*(DE51*OtherDamage*SL+UwDamage*DF51)))",
    "EQ51": "IF(OR(CK51 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK51+1)*1%, 1),\n  CF, $DB51,\n  CC, MIN(100%, $CZ51 + 1%),\n  CCUW, DA51 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ196,BZ51) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC51 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR51,\n  CL, $DS51,\n  SM, $DT51,\n  SLM, $DU51,\n  SL, $DQ51,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM51, UltCritCard),\n\nCY51 * (Critical*DO51*SL+UwDamage*UWCritical)))",
    "ER51": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL51 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH196,BX51),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL51+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI51*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM196,CC51), $DV51, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH51,\n  Rapid, DG51,\n  SuperTower, $DL51,\n  Rend, $DN51,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM51,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51, $DB51), 1),\n\n  DW, $DR51,\n  CL, $DS51,\n  SM, $DT51,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY51*(DE51*OtherDamage*SL+UWDamage*DF51)))",
    "ES51": "IF(OR(CM51 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH51,\n  Rapid, DG51,\n  RDPM, (1+$DI51*$DJ51*$AQ$9),\n  Rend, $DN51,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK196,CA51),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM51+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51, $DB51), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR51,\n  CL, $DS51,\n  SM, $DT51,\n  SLM, $DU51,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY51*(DE51*OtherDamage*SL+UwDamage*DF51)))",
    "ET51": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN51 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM51,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN51+1, $DB51), 1),\n\n  DW, $DR51,\n  CL, $DS51,\n  SM, $DT51,\n  SLM, $DU51,\n  SL, $DQ51,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY51*(DE51*DO51*SL+UWDamage*DF51)))",
    "EU51": "IF(OR(NOT($BA$3), NOT($BA$23), $CO51 > $BA$15), \"\", 1 + 0.5*(CO51+1))",
    "EW51": "IF(DZ51=\"\", \"\", LET(\n  Now, CT51,\n  Next, DZ51,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT51),\nFactor/Cost))",
    "EX51": "IF(EA51=\"\",\"\",(EA51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU51))",
    "EY51": "IF(EB51=\"\",\"\",(EB51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV51))",
    "EZ51": "IF(EC51=\"\",\"\",(EC51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW51))",
    "FA51": "IF(ED51=\"\",\"\",(ED51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX51))",
    "FB51": "IF(EE51=\"\",\"\",(EE51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY51))",
    "FC51": "IF(EF51=\"\",\"\",(EF51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ51))",
    "FD51": "IF(EG51=\"\",\"\",(EG51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA51))",
    "FE51": "IF(EH51=\"\",\"\",(EH51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB51))",
    "FF51": "IF(EI51=\"\",\"\",(EI51/$DX51-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC51+1, 1, CC51))))",
    "FG51": "IF(EJ51=\"\",\"\",(EJ51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD51))",
    "FH51": "IF(EK51=\"\",\"\",(EK51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE51))",
    "FI51": "IF(EL51=\"\",\"\",(EL51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF51))",
    "FJ51": "IF(EM51=\"\", \"\", LET(\n  Now, CW51,\n  Next, EM51,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG51),\nFactor/Cost))",
    "FK51": "IF(EN51=\"\",\"\",(EN51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH51))",
    "FL51": "IF(EO51=\"\", \"\", LET(\n  Now, CS51,\n  Next, EO51,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI51),\nFactor/Cost))",
    "FM51": "IF(EP51=\"\",\"\",(EP51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ51))",
    "FN51": "IF(EQ51=\"\",\"\",(EQ51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK51))",
    "FO51": "IF(ER51=\"\",\"\",(ER51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL51))",
    "FP51": "IF(ES51=\"\",\"\",(ES51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM51))",
    "FQ51": "IF(ET51=\"\",\"\",(ET51/$DX51-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN51))",
    "FR51": "IF(EU51=\"\", \"\", LET(\n  Now, CX51,\n  Next, EU51,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO51),\nFactor/Cost))",
    "FT51": "IF(COLUMN(EW51:FR51) = MIN(IF(EW51:FR51=MAX(EW51:FR51), COLUMN(EW51:FR51))), 1, \"\")",
    "D52": "IF(SUM(FT51:GP51),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F52)),\"Card Mastery\",F52),G52)/$D$5,\"\")",
    "F52": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT51:GP51),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT51:GP51=1)),)\"),\"Damage\")",
    "G52": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT51:GP51),ARRAYFORMULA(FILTER(BT51:CP51 , FT51:GP51=1)),\"\"\"\")\"),12.0)",
    "I52": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT51:GP51),ARRAYFORMULA(FILTER(EW51:FS51 , FT51:GP51=1))*D$5,\"\"\"\")\"),0.05580746424834328)",
    "K52": "IF(H52<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D52)),)",
    "BC52": "BC51+1",
    "BD52": "BD51+BD$3",
    "BE52": "BE51+BE$3",
    "BF52": "BF51+BF$3",
    "BG52": "BG51+BG$3",
    "BH52": "BH51+BH$3",
    "BI52": "BI51+BI$3",
    "BT52": "BT51+FT51",
    "BU52": "BU51+FU51",
    "BV52": "BV51+FV51",
    "BW52": "BW51+FW51",
    "BX52": "BX51+FX51",
    "BY52": "BY51+FY51",
    "BZ52": "BZ51+FZ51",
    "CA52": "CA51+GA51",
    "CB52": "CB51+GB51",
    "CC52": "CC51+GC51",
    "CD52": "CD51+GD51",
    "CE52": "CE51+GE51",
    "CF52": "CF51+GF51",
    "CG52": "CG51+GG51",
    "CH52": "CH51+GH51",
    "CI52": "CI51+GI51",
    "CJ52": "CJ51+GJ51",
    "CK52": "CK51+GK51",
    "CL52": "CL51+GL51",
    "CM52": "CM51+GM51",
    "CN52": "CN51+GN51",
    "CO52": "CO51+GO51",
    "CS52": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI52,1)",
    "CT52": "INDEX($BD$5:$BD197,BT52)",
    "CU52": "INDEX($BN$5:$BN197,CD52)",
    "CV52": "INDEX($BO$5:$BO197,CE52)",
    "CW52": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG52)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX52": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO52, 1)",
    "CY52": "LET(\n  Base, $CR$6,\n  Damage, $CT52,\n  DamageMastery, $CS52,\n  DemonMastery, $CX52,\n  SPB, $CU52,\n  ITO, $CV52,\n  Shock, $CW52,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ52": "MIN(100%, DA52)",
    "DA52": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK52*1%, 0)",
    "DB52": "LET(\n  Lab, 1+INDEX($BF$5:$BF197,BV52),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC52": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK52*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI197,BY52) + CardCritMastery)",
    "DD52": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK52*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ197,BZ52) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE52": "LET(\n  CF, $DB52,\n  CC, $CZ52,\n  SCM, $DD52,\n  SCC, $DC52,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF52": "LET(\n  CF, $DB52,\n  CC, $DA52,\n  SCM, $DD52,\n  SCC, $DC52,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG52": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH52)), 0)",
    "DH52": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ52*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE197,BU52),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI52": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG197, BW52), 1) + $AE$9)",
    "DJ52": "LET(\n  DpmLab, INDEX($BH$5:$BH197,BX52),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL52, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK52": "(1+$DI52*$DJ52*$AQ$9)",
    "DL52": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK197,CA52),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM52*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM52": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK197,CA52),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM52*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN52": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL197,CB52)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO52": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH52,\n  Rapid, DG52,\n  RDPM, DK52,\n  SuperTower, $DL52,\n  Rend, $DN52,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP52": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ52": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK52),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR52": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP52),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF52-1))",
    "DS52": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG52, DH52),0))",
    "DT52": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP52),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV52, $AR$29), 0))",
    "DU52": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK52),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM197,CC52), $DV52, $AR$29), 0))",
    "DV52": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH52), $AO$29)",
    "DW52": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM52,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52, $DB52), 1),\n\n  DW, $DR52,\n  CL, $DS52,\n  SM, $DT52,\n  SLM, $DU52,\n  SL, $DQ52,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX52": "CY52*(DE52*DO52*DQ52+DW52*DF52)",
    "DZ52": "IF(INDEX($BD$6:$BD197,BT52)=\"\", \"\", INDEX($BD$5:$BD197,BT52+1))",
    "EA52": "IF(OR($AO$25, INDEX($BE$6:$BE197,BU52)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ52)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE197,BU52+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI52*$DJ52*$AQ$9),\n  SuperTower, $DL52,\n  Rend, $DN52,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52, $DB52), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR52,\n  SM, $DT52,\n  SLM, $DU52,\n  SL, $DQ52,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM52, UltCritCard),\n\nCY52*(DE52*OtherDamage*SL+UwDamage*DF52)))",
    "EB52": "IF(INDEX($BF$6:$BF197,BV52)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF197,BV52+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ52,\n  CCUW, $DA52,\n  SCM, $DD52,\n  SCC, $DC52,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52, CF), 1),\n\n  DW, $DR52,\n  CL, $DS52,\n  SM, $DT52,\n  SLM, $DU52,\n  SL, $DQ52,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM52, UltCritCard),\n\nCY52 * (Critical * DO52 * SL + UwDamage * UWCritical)))",
    "EC52": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG197,BW52)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH52,\n  Rapid, DG52,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG197, BW52+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ52*$AQ$9),\n  SuperTower, $DL52,\n  Rend, $DN52,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM197,CC52), $DV52, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM52,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52, $DB52), 1),\n\n  DW, $DR52,\n  CL, $DS52,\n  SM, $DT52,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY52*(DE52*OtherDamage*SL+UWDamage*DF52)))",
    "ED52": "IF(OR($AO$25, INDEX($BH$6:$BH197,BX52)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH197,BX52+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL52, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI52*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM197,CC52), $DV52, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH52,\n  Rapid, DG52,\n  SuperTower, $DL52,\n  Rend, $DN52,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM52,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52, $DB52), 1),\n\n  DW, $DR52,\n  CL, $DS52,\n  SM, $DT52,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY52*(DE52*OtherDamage*SL+UWDamage*DF52)))",
    "EE52": "IF(INDEX($BI$6:$BI197,BY52)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK52, 0),\n  CF, $DB52,\n  CC, $CZ52,\n  CCUW, $DA52,\n  SCM, $DD52,\n  SCC, $AV$17+INDEX($BI$5:$BI197,BY52+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY52 * (Critical*DO52*$DQ52+DW52*UWCritical)))",
    "EF52": "IF(INDEX($BJ$6:$BJ197,BZ52)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK52*1%, 1),\n  CF, $DB52,\n  CC, $CZ52,\n  CCUW, $DA52,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ197,BZ52+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC52,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY52*(Critical*DO52*$DQ52+DW52*UWCritical)))",
    "EG52": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK197,CA52)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH52,\n  Rapid, DG52,\n  DPM, (1+$DI52*$DJ52*$AQ$9),\n  Rend, $DN52,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK197,CA52+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM52*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52, $DB52), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK197,CA52+1)-1))/(45-CM52*3),1),\n\n  SL, $DQ52,\n  DW, $DR52,\n  CL, $DS52,\n  SM, $DT52,\n  SLM, $DU52,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY52*(DE52*OtherDamage*SL+UwDamage*DF52)))",
    "EH52": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL197,CB52+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL197,CB52)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH52,\n  Rapid, DG52,\n  DPM, (1+$DI52*$DJ52*$AQ$9),\n  SuperTower, $DL52,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL197,CB52+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY52*(DE52*OtherDamage*$DQ52+DW52*DF52)))",
    "EI52": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM197,CC52)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52, $DB52), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK52),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV52, $AR$29), 0),\n\n  DW, $DR52,\n  CL, $DS52,\n  SM, $DT52,\n  SL, $DQ52,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM52, UltCritCard),\nCY52*(DE52*DO52*SL+UwDamage*DF52)))",
    "EJ52": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN197,CD52)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT52,\n  DamageMastery, $CS52,\n  DemonMastery, $CX52,\n  SPB, INDEX($BN$5:$BN197,CD52+1),\n  ITO, $CV52,\n  Shock, $CW52,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE52*DO52*$DQ52+DW52*DF52)))",
    "EK52": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO197,CE52)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT52,\n  DamageMastery, $CS52,\n  DemonMastery, $CX52,\n  SPB, $CU52,\n  ITO, INDEX($BO$5:$BO197,CE52+1),\n  Shock, $CW52,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE52*DO52*$DQ52+DW52*DF52)))",
    "EL52": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP197,CF52)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52, $DB52), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP52),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF52),\n  CL, $DS52,\n  SM, $DT52,\n  SLM, $DU52,\n  SL, $DQ52,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM52, UltCritCard),\nCY52*(DE52*DO52*SL+UwDamage*DF52)))",
    "EM52": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ197,CG52)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG52+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN52": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR197,CH52)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52, $DB52), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH52+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP52),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK52),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM197,CC52), SMHeat, $AR$29), 0),\n\n  DW, $DR52,\n  CL, $DS52,\n  SL, $DQ52,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM52, UltCritCard),\nCY52*(DE52*DO52*SL+UwDamage*DF52)))",
    "EO52": "IF(OR(CI52 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI52+1))",
    "EP52": "IF(OR($AO$25, CJ52 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ52+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE196,BU52),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL52, 1),\n  DPM, (1+$DI52*CardRangeMastery*$DJ52*$AQ$9),\n  SuperTower, $DL52,\n  Rend, $DN52,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52, $DB52), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR52,\n  SM, $DT52,\n  SLM, $DU52,\n  SL, $DQ52,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM52, UltCritCard),\n\nCY52*(DE52*OtherDamage*SL+UwDamage*DF52)))",
    "EQ52": "IF(OR(CK52 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK52+1)*1%, 1),\n  CF, $DB52,\n  CC, MIN(100%, $CZ52 + 1%),\n  CCUW, DA52 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ197,BZ52) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC52 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR52,\n  CL, $DS52,\n  SM, $DT52,\n  SLM, $DU52,\n  SL, $DQ52,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM52, UltCritCard),\n\nCY52 * (Critical*DO52*SL+UwDamage*UWCritical)))",
    "ER52": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL52 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH197,BX52),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL52+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI52*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM197,CC52), $DV52, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH52,\n  Rapid, DG52,\n  SuperTower, $DL52,\n  Rend, $DN52,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM52,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52, $DB52), 1),\n\n  DW, $DR52,\n  CL, $DS52,\n  SM, $DT52,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY52*(DE52*OtherDamage*SL+UWDamage*DF52)))",
    "ES52": "IF(OR(CM52 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH52,\n  Rapid, DG52,\n  RDPM, (1+$DI52*$DJ52*$AQ$9),\n  Rend, $DN52,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK197,CA52),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM52+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52, $DB52), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR52,\n  CL, $DS52,\n  SM, $DT52,\n  SLM, $DU52,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY52*(DE52*OtherDamage*SL+UwDamage*DF52)))",
    "ET52": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN52 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM52,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN52+1, $DB52), 1),\n\n  DW, $DR52,\n  CL, $DS52,\n  SM, $DT52,\n  SLM, $DU52,\n  SL, $DQ52,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY52*(DE52*DO52*SL+UWDamage*DF52)))",
    "EU52": "IF(OR(NOT($BA$3), NOT($BA$23), $CO52 > $BA$15), \"\", 1 + 0.5*(CO52+1))",
    "EW52": "IF(DZ52=\"\", \"\", LET(\n  Now, CT52,\n  Next, DZ52,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT52),\nFactor/Cost))",
    "EX52": "IF(EA52=\"\",\"\",(EA52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU52))",
    "EY52": "IF(EB52=\"\",\"\",(EB52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV52))",
    "EZ52": "IF(EC52=\"\",\"\",(EC52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW52))",
    "FA52": "IF(ED52=\"\",\"\",(ED52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX52))",
    "FB52": "IF(EE52=\"\",\"\",(EE52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY52))",
    "FC52": "IF(EF52=\"\",\"\",(EF52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ52))",
    "FD52": "IF(EG52=\"\",\"\",(EG52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA52))",
    "FE52": "IF(EH52=\"\",\"\",(EH52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB52))",
    "FF52": "IF(EI52=\"\",\"\",(EI52/$DX52-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC52+1, 1, CC52))))",
    "FG52": "IF(EJ52=\"\",\"\",(EJ52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD52))",
    "FH52": "IF(EK52=\"\",\"\",(EK52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE52))",
    "FI52": "IF(EL52=\"\",\"\",(EL52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF52))",
    "FJ52": "IF(EM52=\"\", \"\", LET(\n  Now, CW52,\n  Next, EM52,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG52),\nFactor/Cost))",
    "FK52": "IF(EN52=\"\",\"\",(EN52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH52))",
    "FL52": "IF(EO52=\"\", \"\", LET(\n  Now, CS52,\n  Next, EO52,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI52),\nFactor/Cost))",
    "FM52": "IF(EP52=\"\",\"\",(EP52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ52))",
    "FN52": "IF(EQ52=\"\",\"\",(EQ52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK52))",
    "FO52": "IF(ER52=\"\",\"\",(ER52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL52))",
    "FP52": "IF(ES52=\"\",\"\",(ES52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM52))",
    "FQ52": "IF(ET52=\"\",\"\",(ET52/$DX52-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN52))",
    "FR52": "IF(EU52=\"\", \"\", LET(\n  Now, CX52,\n  Next, EU52,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO52),\nFactor/Cost))",
    "FT52": "IF(COLUMN(EW52:FR52) = MIN(IF(EW52:FR52=MAX(EW52:FR52), COLUMN(EW52:FR52))), 1, \"\")",
    "D53": "IF(SUM(FT52:GP52),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F53)),\"Card Mastery\",F53),G53)/$D$5,\"\")",
    "F53": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT52:GP52),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT52:GP52=1)),)\"),\"Critical Factor\")",
    "G53": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT52:GP52),ARRAYFORMULA(FILTER(BT52:CP52 , FT52:GP52=1)),\"\"\"\")\"),14.0)",
    "I53": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT52:GP52),ARRAYFORMULA(FILTER(EW52:FS52 , FT52:GP52=1))*D$5,\"\"\"\")\"),0.05064975416282463)",
    "K53": "IF(H53<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D53)),)",
    "BC53": "BC52+1",
    "BD53": "BD52+BD$3",
    "BE53": "BE52+BE$3",
    "BF53": "BF52+BF$3",
    "BG53": "BG52+BG$3",
    "BH53": "BH52+BH$3",
    "BI53": "BI52+BI$3",
    "BT53": "BT52+FT52",
    "BU53": "BU52+FU52",
    "BV53": "BV52+FV52",
    "BW53": "BW52+FW52",
    "BX53": "BX52+FX52",
    "BY53": "BY52+FY52",
    "BZ53": "BZ52+FZ52",
    "CA53": "CA52+GA52",
    "CB53": "CB52+GB52",
    "CC53": "CC52+GC52",
    "CD53": "CD52+GD52",
    "CE53": "CE52+GE52",
    "CF53": "CF52+GF52",
    "CG53": "CG52+GG52",
    "CH53": "CH52+GH52",
    "CI53": "CI52+GI52",
    "CJ53": "CJ52+GJ52",
    "CK53": "CK52+GK52",
    "CL53": "CL52+GL52",
    "CM53": "CM52+GM52",
    "CN53": "CN52+GN52",
    "CO53": "CO52+GO52",
    "CS53": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI53,1)",
    "CT53": "INDEX($BD$5:$BD198,BT53)",
    "CU53": "INDEX($BN$5:$BN198,CD53)",
    "CV53": "INDEX($BO$5:$BO198,CE53)",
    "CW53": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG53)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX53": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO53, 1)",
    "CY53": "LET(\n  Base, $CR$6,\n  Damage, $CT53,\n  DamageMastery, $CS53,\n  DemonMastery, $CX53,\n  SPB, $CU53,\n  ITO, $CV53,\n  Shock, $CW53,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ53": "MIN(100%, DA53)",
    "DA53": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK53*1%, 0)",
    "DB53": "LET(\n  Lab, 1+INDEX($BF$5:$BF198,BV53),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC53": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK53*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI198,BY53) + CardCritMastery)",
    "DD53": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK53*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ198,BZ53) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE53": "LET(\n  CF, $DB53,\n  CC, $CZ53,\n  SCM, $DD53,\n  SCC, $DC53,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF53": "LET(\n  CF, $DB53,\n  CC, $DA53,\n  SCM, $DD53,\n  SCC, $DC53,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG53": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH53)), 0)",
    "DH53": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ53*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE198,BU53),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI53": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG198, BW53), 1) + $AE$9)",
    "DJ53": "LET(\n  DpmLab, INDEX($BH$5:$BH198,BX53),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL53, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK53": "(1+$DI53*$DJ53*$AQ$9)",
    "DL53": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK198,CA53),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM53*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM53": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK198,CA53),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM53*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN53": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL198,CB53)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO53": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH53,\n  Rapid, DG53,\n  RDPM, DK53,\n  SuperTower, $DL53,\n  Rend, $DN53,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP53": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ53": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK53),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR53": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP53),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF53-1))",
    "DS53": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG53, DH53),0))",
    "DT53": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP53),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV53, $AR$29), 0))",
    "DU53": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK53),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM198,CC53), $DV53, $AR$29), 0))",
    "DV53": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH53), $AO$29)",
    "DW53": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM53,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53, $DB53), 1),\n\n  DW, $DR53,\n  CL, $DS53,\n  SM, $DT53,\n  SLM, $DU53,\n  SL, $DQ53,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX53": "CY53*(DE53*DO53*DQ53+DW53*DF53)",
    "DZ53": "IF(INDEX($BD$6:$BD198,BT53)=\"\", \"\", INDEX($BD$5:$BD198,BT53+1))",
    "EA53": "IF(OR($AO$25, INDEX($BE$6:$BE198,BU53)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ53)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE198,BU53+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI53*$DJ53*$AQ$9),\n  SuperTower, $DL53,\n  Rend, $DN53,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53, $DB53), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR53,\n  SM, $DT53,\n  SLM, $DU53,\n  SL, $DQ53,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM53, UltCritCard),\n\nCY53*(DE53*OtherDamage*SL+UwDamage*DF53)))",
    "EB53": "IF(INDEX($BF$6:$BF198,BV53)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF198,BV53+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ53,\n  CCUW, $DA53,\n  SCM, $DD53,\n  SCC, $DC53,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53, CF), 1),\n\n  DW, $DR53,\n  CL, $DS53,\n  SM, $DT53,\n  SLM, $DU53,\n  SL, $DQ53,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM53, UltCritCard),\n\nCY53 * (Critical * DO53 * SL + UwDamage * UWCritical)))",
    "EC53": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG198,BW53)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH53,\n  Rapid, DG53,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG198, BW53+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ53*$AQ$9),\n  SuperTower, $DL53,\n  Rend, $DN53,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM198,CC53), $DV53, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM53,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53, $DB53), 1),\n\n  DW, $DR53,\n  CL, $DS53,\n  SM, $DT53,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY53*(DE53*OtherDamage*SL+UWDamage*DF53)))",
    "ED53": "IF(OR($AO$25, INDEX($BH$6:$BH198,BX53)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH198,BX53+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL53, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI53*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM198,CC53), $DV53, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH53,\n  Rapid, DG53,\n  SuperTower, $DL53,\n  Rend, $DN53,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM53,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53, $DB53), 1),\n\n  DW, $DR53,\n  CL, $DS53,\n  SM, $DT53,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY53*(DE53*OtherDamage*SL+UWDamage*DF53)))",
    "EE53": "IF(INDEX($BI$6:$BI198,BY53)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK53, 0),\n  CF, $DB53,\n  CC, $CZ53,\n  CCUW, $DA53,\n  SCM, $DD53,\n  SCC, $AV$17+INDEX($BI$5:$BI198,BY53+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY53 * (Critical*DO53*$DQ53+DW53*UWCritical)))",
    "EF53": "IF(INDEX($BJ$6:$BJ198,BZ53)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK53*1%, 1),\n  CF, $DB53,\n  CC, $CZ53,\n  CCUW, $DA53,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ198,BZ53+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC53,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY53*(Critical*DO53*$DQ53+DW53*UWCritical)))",
    "EG53": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK198,CA53)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH53,\n  Rapid, DG53,\n  DPM, (1+$DI53*$DJ53*$AQ$9),\n  Rend, $DN53,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK198,CA53+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM53*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53, $DB53), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK198,CA53+1)-1))/(45-CM53*3),1),\n\n  SL, $DQ53,\n  DW, $DR53,\n  CL, $DS53,\n  SM, $DT53,\n  SLM, $DU53,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY53*(DE53*OtherDamage*SL+UwDamage*DF53)))",
    "EH53": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL198,CB53+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL198,CB53)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH53,\n  Rapid, DG53,\n  DPM, (1+$DI53*$DJ53*$AQ$9),\n  SuperTower, $DL53,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL198,CB53+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY53*(DE53*OtherDamage*$DQ53+DW53*DF53)))",
    "EI53": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM198,CC53)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53, $DB53), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK53),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV53, $AR$29), 0),\n\n  DW, $DR53,\n  CL, $DS53,\n  SM, $DT53,\n  SL, $DQ53,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM53, UltCritCard),\nCY53*(DE53*DO53*SL+UwDamage*DF53)))",
    "EJ53": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN198,CD53)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT53,\n  DamageMastery, $CS53,\n  DemonMastery, $CX53,\n  SPB, INDEX($BN$5:$BN198,CD53+1),\n  ITO, $CV53,\n  Shock, $CW53,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE53*DO53*$DQ53+DW53*DF53)))",
    "EK53": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO198,CE53)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT53,\n  DamageMastery, $CS53,\n  DemonMastery, $CX53,\n  SPB, $CU53,\n  ITO, INDEX($BO$5:$BO198,CE53+1),\n  Shock, $CW53,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE53*DO53*$DQ53+DW53*DF53)))",
    "EL53": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP198,CF53)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53, $DB53), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP53),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF53),\n  CL, $DS53,\n  SM, $DT53,\n  SLM, $DU53,\n  SL, $DQ53,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM53, UltCritCard),\nCY53*(DE53*DO53*SL+UwDamage*DF53)))",
    "EM53": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ198,CG53)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG53+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN53": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR198,CH53)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53, $DB53), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH53+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP53),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK53),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM198,CC53), SMHeat, $AR$29), 0),\n\n  DW, $DR53,\n  CL, $DS53,\n  SL, $DQ53,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM53, UltCritCard),\nCY53*(DE53*DO53*SL+UwDamage*DF53)))",
    "EO53": "IF(OR(CI53 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI53+1))",
    "EP53": "IF(OR($AO$25, CJ53 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ53+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE197,BU53),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL53, 1),\n  DPM, (1+$DI53*CardRangeMastery*$DJ53*$AQ$9),\n  SuperTower, $DL53,\n  Rend, $DN53,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53, $DB53), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR53,\n  SM, $DT53,\n  SLM, $DU53,\n  SL, $DQ53,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM53, UltCritCard),\n\nCY53*(DE53*OtherDamage*SL+UwDamage*DF53)))",
    "EQ53": "IF(OR(CK53 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK53+1)*1%, 1),\n  CF, $DB53,\n  CC, MIN(100%, $CZ53 + 1%),\n  CCUW, DA53 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ198,BZ53) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC53 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR53,\n  CL, $DS53,\n  SM, $DT53,\n  SLM, $DU53,\n  SL, $DQ53,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM53, UltCritCard),\n\nCY53 * (Critical*DO53*SL+UwDamage*UWCritical)))",
    "ER53": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL53 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH198,BX53),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL53+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI53*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM198,CC53), $DV53, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH53,\n  Rapid, DG53,\n  SuperTower, $DL53,\n  Rend, $DN53,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM53,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53, $DB53), 1),\n\n  DW, $DR53,\n  CL, $DS53,\n  SM, $DT53,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY53*(DE53*OtherDamage*SL+UWDamage*DF53)))",
    "ES53": "IF(OR(CM53 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH53,\n  Rapid, DG53,\n  RDPM, (1+$DI53*$DJ53*$AQ$9),\n  Rend, $DN53,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK198,CA53),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM53+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53, $DB53), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR53,\n  CL, $DS53,\n  SM, $DT53,\n  SLM, $DU53,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY53*(DE53*OtherDamage*SL+UwDamage*DF53)))",
    "ET53": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN53 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM53,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN53+1, $DB53), 1),\n\n  DW, $DR53,\n  CL, $DS53,\n  SM, $DT53,\n  SLM, $DU53,\n  SL, $DQ53,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY53*(DE53*DO53*SL+UWDamage*DF53)))",
    "EU53": "IF(OR(NOT($BA$3), NOT($BA$23), $CO53 > $BA$15), \"\", 1 + 0.5*(CO53+1))",
    "EW53": "IF(DZ53=\"\", \"\", LET(\n  Now, CT53,\n  Next, DZ53,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT53),\nFactor/Cost))",
    "EX53": "IF(EA53=\"\",\"\",(EA53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU53))",
    "EY53": "IF(EB53=\"\",\"\",(EB53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV53))",
    "EZ53": "IF(EC53=\"\",\"\",(EC53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW53))",
    "FA53": "IF(ED53=\"\",\"\",(ED53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX53))",
    "FB53": "IF(EE53=\"\",\"\",(EE53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY53))",
    "FC53": "IF(EF53=\"\",\"\",(EF53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ53))",
    "FD53": "IF(EG53=\"\",\"\",(EG53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA53))",
    "FE53": "IF(EH53=\"\",\"\",(EH53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB53))",
    "FF53": "IF(EI53=\"\",\"\",(EI53/$DX53-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC53+1, 1, CC53))))",
    "FG53": "IF(EJ53=\"\",\"\",(EJ53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD53))",
    "FH53": "IF(EK53=\"\",\"\",(EK53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE53))",
    "FI53": "IF(EL53=\"\",\"\",(EL53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF53))",
    "FJ53": "IF(EM53=\"\", \"\", LET(\n  Now, CW53,\n  Next, EM53,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG53),\nFactor/Cost))",
    "FK53": "IF(EN53=\"\",\"\",(EN53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH53))",
    "FL53": "IF(EO53=\"\", \"\", LET(\n  Now, CS53,\n  Next, EO53,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI53),\nFactor/Cost))",
    "FM53": "IF(EP53=\"\",\"\",(EP53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ53))",
    "FN53": "IF(EQ53=\"\",\"\",(EQ53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK53))",
    "FO53": "IF(ER53=\"\",\"\",(ER53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL53))",
    "FP53": "IF(ES53=\"\",\"\",(ES53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM53))",
    "FQ53": "IF(ET53=\"\",\"\",(ET53/$DX53-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN53))",
    "FR53": "IF(EU53=\"\", \"\", LET(\n  Now, CX53,\n  Next, EU53,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO53),\nFactor/Cost))",
    "FT53": "IF(COLUMN(EW53:FR53) = MIN(IF(EW53:FR53=MAX(EW53:FR53), COLUMN(EW53:FR53))), 1, \"\")",
    "D54": "IF(SUM(FT53:GP53),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F54)),\"Card Mastery\",F54),G54)/$D$5,\"\")",
    "F54": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT53:GP53),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT53:GP53=1)),)\"),\"Damage / Meter\")",
    "G54": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT53:GP53),ARRAYFORMULA(FILTER(BT53:CP53 , FT53:GP53=1)),\"\"\"\")\"),9.0)",
    "I54": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT53:GP53),ARRAYFORMULA(FILTER(EW53:FS53 , FT53:GP53=1))*D$5,\"\"\"\")\"),0.04965508734648714)",
    "K54": "IF(H54<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D54)),)",
    "BC54": "BC53+1",
    "BD54": "BD53+BD$3",
    "BE54": "BE53+BE$3",
    "BF54": "BF53+BF$3",
    "BG54": "BG53+BG$3",
    "BH54": "BH53+BH$3",
    "BI54": "BI53+BI$3",
    "BT54": "BT53+FT53",
    "BU54": "BU53+FU53",
    "BV54": "BV53+FV53",
    "BW54": "BW53+FW53",
    "BX54": "BX53+FX53",
    "BY54": "BY53+FY53",
    "BZ54": "BZ53+FZ53",
    "CA54": "CA53+GA53",
    "CB54": "CB53+GB53",
    "CC54": "CC53+GC53",
    "CD54": "CD53+GD53",
    "CE54": "CE53+GE53",
    "CF54": "CF53+GF53",
    "CG54": "CG53+GG53",
    "CH54": "CH53+GH53",
    "CI54": "CI53+GI53",
    "CJ54": "CJ53+GJ53",
    "CK54": "CK53+GK53",
    "CL54": "CL53+GL53",
    "CM54": "CM53+GM53",
    "CN54": "CN53+GN53",
    "CO54": "CO53+GO53",
    "CS54": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI54,1)",
    "CT54": "INDEX($BD$5:$BD199,BT54)",
    "CU54": "INDEX($BN$5:$BN199,CD54)",
    "CV54": "INDEX($BO$5:$BO199,CE54)",
    "CW54": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG54)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX54": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO54, 1)",
    "CY54": "LET(\n  Base, $CR$6,\n  Damage, $CT54,\n  DamageMastery, $CS54,\n  DemonMastery, $CX54,\n  SPB, $CU54,\n  ITO, $CV54,\n  Shock, $CW54,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ54": "MIN(100%, DA54)",
    "DA54": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK54*1%, 0)",
    "DB54": "LET(\n  Lab, 1+INDEX($BF$5:$BF199,BV54),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC54": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK54*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI199,BY54) + CardCritMastery)",
    "DD54": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK54*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ199,BZ54) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE54": "LET(\n  CF, $DB54,\n  CC, $CZ54,\n  SCM, $DD54,\n  SCC, $DC54,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF54": "LET(\n  CF, $DB54,\n  CC, $DA54,\n  SCM, $DD54,\n  SCC, $DC54,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG54": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH54)), 0)",
    "DH54": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ54*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE199,BU54),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI54": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG199, BW54), 1) + $AE$9)",
    "DJ54": "LET(\n  DpmLab, INDEX($BH$5:$BH199,BX54),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL54, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK54": "(1+$DI54*$DJ54*$AQ$9)",
    "DL54": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK199,CA54),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM54*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM54": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK199,CA54),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM54*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN54": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL199,CB54)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO54": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH54,\n  Rapid, DG54,\n  RDPM, DK54,\n  SuperTower, $DL54,\n  Rend, $DN54,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP54": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ54": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK54),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR54": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP54),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF54-1))",
    "DS54": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG54, DH54),0))",
    "DT54": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP54),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV54, $AR$29), 0))",
    "DU54": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK54),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM199,CC54), $DV54, $AR$29), 0))",
    "DV54": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH54), $AO$29)",
    "DW54": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM54,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54, $DB54), 1),\n\n  DW, $DR54,\n  CL, $DS54,\n  SM, $DT54,\n  SLM, $DU54,\n  SL, $DQ54,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX54": "CY54*(DE54*DO54*DQ54+DW54*DF54)",
    "DZ54": "IF(INDEX($BD$6:$BD199,BT54)=\"\", \"\", INDEX($BD$5:$BD199,BT54+1))",
    "EA54": "IF(OR($AO$25, INDEX($BE$6:$BE199,BU54)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ54)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE199,BU54+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI54*$DJ54*$AQ$9),\n  SuperTower, $DL54,\n  Rend, $DN54,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54, $DB54), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR54,\n  SM, $DT54,\n  SLM, $DU54,\n  SL, $DQ54,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM54, UltCritCard),\n\nCY54*(DE54*OtherDamage*SL+UwDamage*DF54)))",
    "EB54": "IF(INDEX($BF$6:$BF199,BV54)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF199,BV54+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ54,\n  CCUW, $DA54,\n  SCM, $DD54,\n  SCC, $DC54,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54, CF), 1),\n\n  DW, $DR54,\n  CL, $DS54,\n  SM, $DT54,\n  SLM, $DU54,\n  SL, $DQ54,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM54, UltCritCard),\n\nCY54 * (Critical * DO54 * SL + UwDamage * UWCritical)))",
    "EC54": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG199,BW54)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH54,\n  Rapid, DG54,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG199, BW54+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ54*$AQ$9),\n  SuperTower, $DL54,\n  Rend, $DN54,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM199,CC54), $DV54, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM54,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54, $DB54), 1),\n\n  DW, $DR54,\n  CL, $DS54,\n  SM, $DT54,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY54*(DE54*OtherDamage*SL+UWDamage*DF54)))",
    "ED54": "IF(OR($AO$25, INDEX($BH$6:$BH199,BX54)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH199,BX54+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL54, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI54*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM199,CC54), $DV54, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH54,\n  Rapid, DG54,\n  SuperTower, $DL54,\n  Rend, $DN54,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM54,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54, $DB54), 1),\n\n  DW, $DR54,\n  CL, $DS54,\n  SM, $DT54,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY54*(DE54*OtherDamage*SL+UWDamage*DF54)))",
    "EE54": "IF(INDEX($BI$6:$BI199,BY54)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK54, 0),\n  CF, $DB54,\n  CC, $CZ54,\n  CCUW, $DA54,\n  SCM, $DD54,\n  SCC, $AV$17+INDEX($BI$5:$BI199,BY54+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY54 * (Critical*DO54*$DQ54+DW54*UWCritical)))",
    "EF54": "IF(INDEX($BJ$6:$BJ199,BZ54)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK54*1%, 1),\n  CF, $DB54,\n  CC, $CZ54,\n  CCUW, $DA54,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ199,BZ54+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC54,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY54*(Critical*DO54*$DQ54+DW54*UWCritical)))",
    "EG54": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK199,CA54)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH54,\n  Rapid, DG54,\n  DPM, (1+$DI54*$DJ54*$AQ$9),\n  Rend, $DN54,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK199,CA54+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM54*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54, $DB54), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK199,CA54+1)-1))/(45-CM54*3),1),\n\n  SL, $DQ54,\n  DW, $DR54,\n  CL, $DS54,\n  SM, $DT54,\n  SLM, $DU54,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY54*(DE54*OtherDamage*SL+UwDamage*DF54)))",
    "EH54": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL199,CB54+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL199,CB54)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH54,\n  Rapid, DG54,\n  DPM, (1+$DI54*$DJ54*$AQ$9),\n  SuperTower, $DL54,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL199,CB54+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY54*(DE54*OtherDamage*$DQ54+DW54*DF54)))",
    "EI54": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM199,CC54)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54, $DB54), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK54),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV54, $AR$29), 0),\n\n  DW, $DR54,\n  CL, $DS54,\n  SM, $DT54,\n  SL, $DQ54,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM54, UltCritCard),\nCY54*(DE54*DO54*SL+UwDamage*DF54)))",
    "EJ54": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN199,CD54)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT54,\n  DamageMastery, $CS54,\n  DemonMastery, $CX54,\n  SPB, INDEX($BN$5:$BN199,CD54+1),\n  ITO, $CV54,\n  Shock, $CW54,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE54*DO54*$DQ54+DW54*DF54)))",
    "EK54": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO199,CE54)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT54,\n  DamageMastery, $CS54,\n  DemonMastery, $CX54,\n  SPB, $CU54,\n  ITO, INDEX($BO$5:$BO199,CE54+1),\n  Shock, $CW54,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE54*DO54*$DQ54+DW54*DF54)))",
    "EL54": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP199,CF54)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54, $DB54), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP54),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF54),\n  CL, $DS54,\n  SM, $DT54,\n  SLM, $DU54,\n  SL, $DQ54,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM54, UltCritCard),\nCY54*(DE54*DO54*SL+UwDamage*DF54)))",
    "EM54": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ199,CG54)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG54+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN54": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR199,CH54)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54, $DB54), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH54+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP54),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK54),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM199,CC54), SMHeat, $AR$29), 0),\n\n  DW, $DR54,\n  CL, $DS54,\n  SL, $DQ54,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM54, UltCritCard),\nCY54*(DE54*DO54*SL+UwDamage*DF54)))",
    "EO54": "IF(OR(CI54 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI54+1))",
    "EP54": "IF(OR($AO$25, CJ54 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ54+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE198,BU54),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL54, 1),\n  DPM, (1+$DI54*CardRangeMastery*$DJ54*$AQ$9),\n  SuperTower, $DL54,\n  Rend, $DN54,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54, $DB54), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR54,\n  SM, $DT54,\n  SLM, $DU54,\n  SL, $DQ54,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM54, UltCritCard),\n\nCY54*(DE54*OtherDamage*SL+UwDamage*DF54)))",
    "EQ54": "IF(OR(CK54 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK54+1)*1%, 1),\n  CF, $DB54,\n  CC, MIN(100%, $CZ54 + 1%),\n  CCUW, DA54 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ199,BZ54) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC54 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR54,\n  CL, $DS54,\n  SM, $DT54,\n  SLM, $DU54,\n  SL, $DQ54,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM54, UltCritCard),\n\nCY54 * (Critical*DO54*SL+UwDamage*UWCritical)))",
    "ER54": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL54 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH199,BX54),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL54+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI54*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM199,CC54), $DV54, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH54,\n  Rapid, DG54,\n  SuperTower, $DL54,\n  Rend, $DN54,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM54,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54, $DB54), 1),\n\n  DW, $DR54,\n  CL, $DS54,\n  SM, $DT54,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY54*(DE54*OtherDamage*SL+UWDamage*DF54)))",
    "ES54": "IF(OR(CM54 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH54,\n  Rapid, DG54,\n  RDPM, (1+$DI54*$DJ54*$AQ$9),\n  Rend, $DN54,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK199,CA54),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM54+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54, $DB54), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR54,\n  CL, $DS54,\n  SM, $DT54,\n  SLM, $DU54,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY54*(DE54*OtherDamage*SL+UwDamage*DF54)))",
    "ET54": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN54 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM54,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN54+1, $DB54), 1),\n\n  DW, $DR54,\n  CL, $DS54,\n  SM, $DT54,\n  SLM, $DU54,\n  SL, $DQ54,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY54*(DE54*DO54*SL+UWDamage*DF54)))",
    "EU54": "IF(OR(NOT($BA$3), NOT($BA$23), $CO54 > $BA$15), \"\", 1 + 0.5*(CO54+1))",
    "EW54": "IF(DZ54=\"\", \"\", LET(\n  Now, CT54,\n  Next, DZ54,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT54),\nFactor/Cost))",
    "EX54": "IF(EA54=\"\",\"\",(EA54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU54))",
    "EY54": "IF(EB54=\"\",\"\",(EB54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV54))",
    "EZ54": "IF(EC54=\"\",\"\",(EC54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW54))",
    "FA54": "IF(ED54=\"\",\"\",(ED54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX54))",
    "FB54": "IF(EE54=\"\",\"\",(EE54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY54))",
    "FC54": "IF(EF54=\"\",\"\",(EF54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ54))",
    "FD54": "IF(EG54=\"\",\"\",(EG54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA54))",
    "FE54": "IF(EH54=\"\",\"\",(EH54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB54))",
    "FF54": "IF(EI54=\"\",\"\",(EI54/$DX54-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC54+1, 1, CC54))))",
    "FG54": "IF(EJ54=\"\",\"\",(EJ54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD54))",
    "FH54": "IF(EK54=\"\",\"\",(EK54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE54))",
    "FI54": "IF(EL54=\"\",\"\",(EL54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF54))",
    "FJ54": "IF(EM54=\"\", \"\", LET(\n  Now, CW54,\n  Next, EM54,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG54),\nFactor/Cost))",
    "FK54": "IF(EN54=\"\",\"\",(EN54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH54))",
    "FL54": "IF(EO54=\"\", \"\", LET(\n  Now, CS54,\n  Next, EO54,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI54),\nFactor/Cost))",
    "FM54": "IF(EP54=\"\",\"\",(EP54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ54))",
    "FN54": "IF(EQ54=\"\",\"\",(EQ54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK54))",
    "FO54": "IF(ER54=\"\",\"\",(ER54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL54))",
    "FP54": "IF(ES54=\"\",\"\",(ES54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM54))",
    "FQ54": "IF(ET54=\"\",\"\",(ET54/$DX54-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN54))",
    "FR54": "IF(EU54=\"\", \"\", LET(\n  Now, CX54,\n  Next, EU54,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO54),\nFactor/Cost))",
    "FT54": "IF(COLUMN(EW54:FR54) = MIN(IF(EW54:FR54=MAX(EW54:FR54), COLUMN(EW54:FR54))), 1, \"\")",
    "D55": "IF(SUM(FT54:GP54),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F55)),\"Card Mastery\",F55),G55)/$D$5,\"\")",
    "F55": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT54:GP54),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT54:GP54=1)),)\"),\"Damage\")",
    "G55": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT54:GP54),ARRAYFORMULA(FILTER(BT54:CP54 , FT54:GP54=1)),\"\"\"\")\"),13.0)",
    "I55": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT54:GP54),ARRAYFORMULA(FILTER(EW54:FS54 , FT54:GP54=1))*D$5,\"\"\"\")\"),0.045186393874733236)",
    "K55": "IF(D46,FORMAT_TIME_YEAR(SUM($D$6:$D55)),)",
    "BC55": "BC54+1",
    "BD55": "BD54+BD$3",
    "BE55": "BE54+BE$3",
    "BF55": "BF54+BF$3",
    "BG55": "BG54+BG$3",
    "BH55": "BH54+BH$3",
    "BI55": "BI54+BI$3",
    "BT55": "BT54+FT54",
    "BU55": "BU54+FU54",
    "BV55": "BV54+FV54",
    "BW55": "BW54+FW54",
    "BX55": "BX54+FX54",
    "BY55": "BY54+FY54",
    "BZ55": "BZ54+FZ54",
    "CA55": "CA54+GA54",
    "CB55": "CB54+GB54",
    "CC55": "CC54+GC54",
    "CD55": "CD54+GD54",
    "CE55": "CE54+GE54",
    "CF55": "CF54+GF54",
    "CG55": "CG54+GG54",
    "CH55": "CH54+GH54",
    "CI55": "CI54+GI54",
    "CJ55": "CJ54+GJ54",
    "CK55": "CK54+GK54",
    "CL55": "CL54+GL54",
    "CM55": "CM54+GM54",
    "CN55": "CN54+GN54",
    "CO55": "CO54+GO54",
    "CS55": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI55,1)",
    "CT55": "INDEX($BD$5:$BD200,BT55)",
    "CU55": "INDEX($BN$5:$BN200,CD55)",
    "CV55": "INDEX($BO$5:$BO200,CE55)",
    "CW55": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG55)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX55": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO55, 1)",
    "CY55": "LET(\n  Base, $CR$6,\n  Damage, $CT55,\n  DamageMastery, $CS55,\n  DemonMastery, $CX55,\n  SPB, $CU55,\n  ITO, $CV55,\n  Shock, $CW55,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ55": "MIN(100%, DA55)",
    "DA55": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK55*1%, 0)",
    "DB55": "LET(\n  Lab, 1+INDEX($BF$5:$BF200,BV55),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC55": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK55*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI200,BY55) + CardCritMastery)",
    "DD55": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK55*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ200,BZ55) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE55": "LET(\n  CF, $DB55,\n  CC, $CZ55,\n  SCM, $DD55,\n  SCC, $DC55,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF55": "LET(\n  CF, $DB55,\n  CC, $DA55,\n  SCM, $DD55,\n  SCC, $DC55,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG55": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH55)), 0)",
    "DH55": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ55*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE200,BU55),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI55": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG200, BW55), 1) + $AE$9)",
    "DJ55": "LET(\n  DpmLab, INDEX($BH$5:$BH200,BX55),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL55, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK55": "(1+$DI55*$DJ55*$AQ$9)",
    "DL55": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK200,CA55),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM55*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM55": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK200,CA55),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM55*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN55": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL200,CB55)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO55": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH55,\n  Rapid, DG55,\n  RDPM, DK55,\n  SuperTower, $DL55,\n  Rend, $DN55,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP55": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ55": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK55),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR55": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP55),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF55-1))",
    "DS55": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG55, DH55),0))",
    "DT55": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP55),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV55, $AR$29), 0))",
    "DU55": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK55),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM200,CC55), $DV55, $AR$29), 0))",
    "DV55": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH55), $AO$29)",
    "DW55": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM55,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55, $DB55), 1),\n\n  DW, $DR55,\n  CL, $DS55,\n  SM, $DT55,\n  SLM, $DU55,\n  SL, $DQ55,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX55": "CY55*(DE55*DO55*DQ55+DW55*DF55)",
    "DZ55": "IF(INDEX($BD$6:$BD200,BT55)=\"\", \"\", INDEX($BD$5:$BD200,BT55+1))",
    "EA55": "IF(OR($AO$25, INDEX($BE$6:$BE200,BU55)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ55)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE200,BU55+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI55*$DJ55*$AQ$9),\n  SuperTower, $DL55,\n  Rend, $DN55,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55, $DB55), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR55,\n  SM, $DT55,\n  SLM, $DU55,\n  SL, $DQ55,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM55, UltCritCard),\n\nCY55*(DE55*OtherDamage*SL+UwDamage*DF55)))",
    "EB55": "IF(INDEX($BF$6:$BF200,BV55)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF200,BV55+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ55,\n  CCUW, $DA55,\n  SCM, $DD55,\n  SCC, $DC55,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55, CF), 1),\n\n  DW, $DR55,\n  CL, $DS55,\n  SM, $DT55,\n  SLM, $DU55,\n  SL, $DQ55,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM55, UltCritCard),\n\nCY55 * (Critical * DO55 * SL + UwDamage * UWCritical)))",
    "EC55": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG200,BW55)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH55,\n  Rapid, DG55,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG200, BW55+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ55*$AQ$9),\n  SuperTower, $DL55,\n  Rend, $DN55,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM200,CC55), $DV55, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM55,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55, $DB55), 1),\n\n  DW, $DR55,\n  CL, $DS55,\n  SM, $DT55,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY55*(DE55*OtherDamage*SL+UWDamage*DF55)))",
    "ED55": "IF(OR($AO$25, INDEX($BH$6:$BH200,BX55)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH200,BX55+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL55, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI55*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM200,CC55), $DV55, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH55,\n  Rapid, DG55,\n  SuperTower, $DL55,\n  Rend, $DN55,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM55,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55, $DB55), 1),\n\n  DW, $DR55,\n  CL, $DS55,\n  SM, $DT55,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY55*(DE55*OtherDamage*SL+UWDamage*DF55)))",
    "EE55": "IF(INDEX($BI$6:$BI200,BY55)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK55, 0),\n  CF, $DB55,\n  CC, $CZ55,\n  CCUW, $DA55,\n  SCM, $DD55,\n  SCC, $AV$17+INDEX($BI$5:$BI200,BY55+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY55 * (Critical*DO55*$DQ55+DW55*UWCritical)))",
    "EF55": "IF(INDEX($BJ$6:$BJ200,BZ55)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK55*1%, 1),\n  CF, $DB55,\n  CC, $CZ55,\n  CCUW, $DA55,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ200,BZ55+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC55,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY55*(Critical*DO55*$DQ55+DW55*UWCritical)))",
    "EG55": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK200,CA55)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH55,\n  Rapid, DG55,\n  DPM, (1+$DI55*$DJ55*$AQ$9),\n  Rend, $DN55,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK200,CA55+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM55*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55, $DB55), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK200,CA55+1)-1))/(45-CM55*3),1),\n\n  SL, $DQ55,\n  DW, $DR55,\n  CL, $DS55,\n  SM, $DT55,\n  SLM, $DU55,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY55*(DE55*OtherDamage*SL+UwDamage*DF55)))",
    "EH55": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL200,CB55+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL200,CB55)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH55,\n  Rapid, DG55,\n  DPM, (1+$DI55*$DJ55*$AQ$9),\n  SuperTower, $DL55,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL200,CB55+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY55*(DE55*OtherDamage*$DQ55+DW55*DF55)))",
    "EI55": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM200,CC55)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55, $DB55), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK55),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV55, $AR$29), 0),\n\n  DW, $DR55,\n  CL, $DS55,\n  SM, $DT55,\n  SL, $DQ55,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM55, UltCritCard),\nCY55*(DE55*DO55*SL+UwDamage*DF55)))",
    "EJ55": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN200,CD55)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT55,\n  DamageMastery, $CS55,\n  DemonMastery, $CX55,\n  SPB, INDEX($BN$5:$BN200,CD55+1),\n  ITO, $CV55,\n  Shock, $CW55,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE55*DO55*$DQ55+DW55*DF55)))",
    "EK55": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO200,CE55)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT55,\n  DamageMastery, $CS55,\n  DemonMastery, $CX55,\n  SPB, $CU55,\n  ITO, INDEX($BO$5:$BO200,CE55+1),\n  Shock, $CW55,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE55*DO55*$DQ55+DW55*DF55)))",
    "EL55": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP200,CF55)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55, $DB55), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP55),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF55),\n  CL, $DS55,\n  SM, $DT55,\n  SLM, $DU55,\n  SL, $DQ55,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM55, UltCritCard),\nCY55*(DE55*DO55*SL+UwDamage*DF55)))",
    "EM55": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ200,CG55)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG55+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN55": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR200,CH55)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55, $DB55), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH55+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP55),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK55),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM200,CC55), SMHeat, $AR$29), 0),\n\n  DW, $DR55,\n  CL, $DS55,\n  SL, $DQ55,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM55, UltCritCard),\nCY55*(DE55*DO55*SL+UwDamage*DF55)))",
    "EO55": "IF(OR(CI55 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI55+1))",
    "EP55": "IF(OR($AO$25, CJ55 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ55+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE199,BU55),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL55, 1),\n  DPM, (1+$DI55*CardRangeMastery*$DJ55*$AQ$9),\n  SuperTower, $DL55,\n  Rend, $DN55,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55, $DB55), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR55,\n  SM, $DT55,\n  SLM, $DU55,\n  SL, $DQ55,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM55, UltCritCard),\n\nCY55*(DE55*OtherDamage*SL+UwDamage*DF55)))",
    "EQ55": "IF(OR(CK55 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK55+1)*1%, 1),\n  CF, $DB55,\n  CC, MIN(100%, $CZ55 + 1%),\n  CCUW, DA55 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ200,BZ55) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC55 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR55,\n  CL, $DS55,\n  SM, $DT55,\n  SLM, $DU55,\n  SL, $DQ55,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM55, UltCritCard),\n\nCY55 * (Critical*DO55*SL+UwDamage*UWCritical)))",
    "ER55": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL55 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH200,BX55),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL55+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI55*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM200,CC55), $DV55, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH55,\n  Rapid, DG55,\n  SuperTower, $DL55,\n  Rend, $DN55,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM55,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55, $DB55), 1),\n\n  DW, $DR55,\n  CL, $DS55,\n  SM, $DT55,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY55*(DE55*OtherDamage*SL+UWDamage*DF55)))",
    "ES55": "IF(OR(CM55 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH55,\n  Rapid, DG55,\n  RDPM, (1+$DI55*$DJ55*$AQ$9),\n  Rend, $DN55,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK200,CA55),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM55+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55, $DB55), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR55,\n  CL, $DS55,\n  SM, $DT55,\n  SLM, $DU55,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY55*(DE55*OtherDamage*SL+UwDamage*DF55)))",
    "ET55": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN55 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM55,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN55+1, $DB55), 1),\n\n  DW, $DR55,\n  CL, $DS55,\n  SM, $DT55,\n  SLM, $DU55,\n  SL, $DQ55,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY55*(DE55*DO55*SL+UWDamage*DF55)))",
    "EU55": "IF(OR(NOT($BA$3), NOT($BA$23), $CO55 > $BA$15), \"\", 1 + 0.5*(CO55+1))",
    "EW55": "IF(DZ55=\"\", \"\", LET(\n  Now, CT55,\n  Next, DZ55,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT55),\nFactor/Cost))",
    "EX55": "IF(EA55=\"\",\"\",(EA55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU55))",
    "EY55": "IF(EB55=\"\",\"\",(EB55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV55))",
    "EZ55": "IF(EC55=\"\",\"\",(EC55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW55))",
    "FA55": "IF(ED55=\"\",\"\",(ED55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX55))",
    "FB55": "IF(EE55=\"\",\"\",(EE55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY55))",
    "FC55": "IF(EF55=\"\",\"\",(EF55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ55))",
    "FD55": "IF(EG55=\"\",\"\",(EG55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA55))",
    "FE55": "IF(EH55=\"\",\"\",(EH55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB55))",
    "FF55": "IF(EI55=\"\",\"\",(EI55/$DX55-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC55+1, 1, CC55))))",
    "FG55": "IF(EJ55=\"\",\"\",(EJ55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD55))",
    "FH55": "IF(EK55=\"\",\"\",(EK55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE55))",
    "FI55": "IF(EL55=\"\",\"\",(EL55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF55))",
    "FJ55": "IF(EM55=\"\", \"\", LET(\n  Now, CW55,\n  Next, EM55,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG55),\nFactor/Cost))",
    "FK55": "IF(EN55=\"\",\"\",(EN55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH55))",
    "FL55": "IF(EO55=\"\", \"\", LET(\n  Now, CS55,\n  Next, EO55,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI55),\nFactor/Cost))",
    "FM55": "IF(EP55=\"\",\"\",(EP55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ55))",
    "FN55": "IF(EQ55=\"\",\"\",(EQ55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK55))",
    "FO55": "IF(ER55=\"\",\"\",(ER55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL55))",
    "FP55": "IF(ES55=\"\",\"\",(ES55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM55))",
    "FQ55": "IF(ET55=\"\",\"\",(ET55/$DX55-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN55))",
    "FR55": "IF(EU55=\"\", \"\", LET(\n  Now, CX55,\n  Next, EU55,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO55),\nFactor/Cost))",
    "FT55": "IF(COLUMN(EW55:FR55) = MIN(IF(EW55:FR55=MAX(EW55:FR55), COLUMN(EW55:FR55))), 1, \"\")",
    "D56": "IF(SUM(FT55:GP55),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F56)),\"Card Mastery\",F56),G56)/$D$5,\"\")",
    "F56": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT55:GP55),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT55:GP55=1)),)\"),\"Attack Speed\")",
    "G56": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT55:GP55),ARRAYFORMULA(FILTER(BT55:CP55 , FT55:GP55=1)),\"\"\"\")\"),13.0)",
    "I56": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT55:GP55),ARRAYFORMULA(FILTER(EW55:FS55 , FT55:GP55=1))*D$5,\"\"\"\")\"),0.0451396489639447)",
    "K56": "IF(H56<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D56)),)",
    "BC56": "BC55+1",
    "BD56": "BD55+BD$3",
    "BE56": "BE55+BE$3",
    "BF56": "BF55+BF$3",
    "BG56": "BG55+BG$3",
    "BH56": "BH55+BH$3",
    "BT56": "BT55+FT55",
    "BU56": "BU55+FU55",
    "BV56": "BV55+FV55",
    "BW56": "BW55+FW55",
    "BX56": "BX55+FX55",
    "BY56": "BY55+FY55",
    "BZ56": "BZ55+FZ55",
    "CA56": "CA55+GA55",
    "CB56": "CB55+GB55",
    "CC56": "CC55+GC55",
    "CD56": "CD55+GD55",
    "CE56": "CE55+GE55",
    "CF56": "CF55+GF55",
    "CG56": "CG55+GG55",
    "CH56": "CH55+GH55",
    "CI56": "CI55+GI55",
    "CJ56": "CJ55+GJ55",
    "CK56": "CK55+GK55",
    "CL56": "CL55+GL55",
    "CM56": "CM55+GM55",
    "CN56": "CN55+GN55",
    "CO56": "CO55+GO55",
    "CS56": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI56,1)",
    "CT56": "INDEX($BD$5:$BD201,BT56)",
    "CU56": "INDEX($BN$5:$BN201,CD56)",
    "CV56": "INDEX($BO$5:$BO201,CE56)",
    "CW56": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG56)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX56": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO56, 1)",
    "CY56": "LET(\n  Base, $CR$6,\n  Damage, $CT56,\n  DamageMastery, $CS56,\n  DemonMastery, $CX56,\n  SPB, $CU56,\n  ITO, $CV56,\n  Shock, $CW56,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ56": "MIN(100%, DA56)",
    "DA56": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK56*1%, 0)",
    "DB56": "LET(\n  Lab, 1+INDEX($BF$5:$BF201,BV56),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC56": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK56*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI201,BY56) + CardCritMastery)",
    "DD56": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK56*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ201,BZ56) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE56": "LET(\n  CF, $DB56,\n  CC, $CZ56,\n  SCM, $DD56,\n  SCC, $DC56,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF56": "LET(\n  CF, $DB56,\n  CC, $DA56,\n  SCM, $DD56,\n  SCC, $DC56,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG56": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH56)), 0)",
    "DH56": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ56*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE201,BU56),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI56": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG201, BW56), 1) + $AE$9)",
    "DJ56": "LET(\n  DpmLab, INDEX($BH$5:$BH201,BX56),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL56, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK56": "(1+$DI56*$DJ56*$AQ$9)",
    "DL56": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK201,CA56),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM56*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM56": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK201,CA56),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM56*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN56": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL201,CB56)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO56": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH56,\n  Rapid, DG56,\n  RDPM, DK56,\n  SuperTower, $DL56,\n  Rend, $DN56,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP56": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ56": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK56),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR56": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP56),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF56-1))",
    "DS56": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG56, DH56),0))",
    "DT56": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP56),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV56, $AR$29), 0))",
    "DU56": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK56),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM201,CC56), $DV56, $AR$29), 0))",
    "DV56": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH56), $AO$29)",
    "DW56": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM56,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56, $DB56), 1),\n\n  DW, $DR56,\n  CL, $DS56,\n  SM, $DT56,\n  SLM, $DU56,\n  SL, $DQ56,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX56": "CY56*(DE56*DO56*DQ56+DW56*DF56)",
    "DZ56": "IF(INDEX($BD$6:$BD201,BT56)=\"\", \"\", INDEX($BD$5:$BD201,BT56+1))",
    "EA56": "IF(OR($AO$25, INDEX($BE$6:$BE201,BU56)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ56)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE201,BU56+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI56*$DJ56*$AQ$9),\n  SuperTower, $DL56,\n  Rend, $DN56,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56, $DB56), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR56,\n  SM, $DT56,\n  SLM, $DU56,\n  SL, $DQ56,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM56, UltCritCard),\n\nCY56*(DE56*OtherDamage*SL+UwDamage*DF56)))",
    "EB56": "IF(INDEX($BF$6:$BF201,BV56)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF201,BV56+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ56,\n  CCUW, $DA56,\n  SCM, $DD56,\n  SCC, $DC56,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56, CF), 1),\n\n  DW, $DR56,\n  CL, $DS56,\n  SM, $DT56,\n  SLM, $DU56,\n  SL, $DQ56,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM56, UltCritCard),\n\nCY56 * (Critical * DO56 * SL + UwDamage * UWCritical)))",
    "EC56": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG201,BW56)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH56,\n  Rapid, DG56,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG201, BW56+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ56*$AQ$9),\n  SuperTower, $DL56,\n  Rend, $DN56,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM201,CC56), $DV56, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM56,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56, $DB56), 1),\n\n  DW, $DR56,\n  CL, $DS56,\n  SM, $DT56,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY56*(DE56*OtherDamage*SL+UWDamage*DF56)))",
    "ED56": "IF(OR($AO$25, INDEX($BH$6:$BH201,BX56)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH201,BX56+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL56, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI56*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM201,CC56), $DV56, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH56,\n  Rapid, DG56,\n  SuperTower, $DL56,\n  Rend, $DN56,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM56,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56, $DB56), 1),\n\n  DW, $DR56,\n  CL, $DS56,\n  SM, $DT56,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY56*(DE56*OtherDamage*SL+UWDamage*DF56)))",
    "EE56": "IF(INDEX($BI$6:$BI201,BY56)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK56, 0),\n  CF, $DB56,\n  CC, $CZ56,\n  CCUW, $DA56,\n  SCM, $DD56,\n  SCC, $AV$17+INDEX($BI$5:$BI201,BY56+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY56 * (Critical*DO56*$DQ56+DW56*UWCritical)))",
    "EF56": "IF(INDEX($BJ$6:$BJ201,BZ56)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK56*1%, 1),\n  CF, $DB56,\n  CC, $CZ56,\n  CCUW, $DA56,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ201,BZ56+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC56,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY56*(Critical*DO56*$DQ56+DW56*UWCritical)))",
    "EG56": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK201,CA56)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH56,\n  Rapid, DG56,\n  DPM, (1+$DI56*$DJ56*$AQ$9),\n  Rend, $DN56,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK201,CA56+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM56*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56, $DB56), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK201,CA56+1)-1))/(45-CM56*3),1),\n\n  SL, $DQ56,\n  DW, $DR56,\n  CL, $DS56,\n  SM, $DT56,\n  SLM, $DU56,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY56*(DE56*OtherDamage*SL+UwDamage*DF56)))",
    "EH56": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL201,CB56+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL201,CB56)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH56,\n  Rapid, DG56,\n  DPM, (1+$DI56*$DJ56*$AQ$9),\n  SuperTower, $DL56,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL201,CB56+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY56*(DE56*OtherDamage*$DQ56+DW56*DF56)))",
    "EI56": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM201,CC56)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56, $DB56), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK56),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV56, $AR$29), 0),\n\n  DW, $DR56,\n  CL, $DS56,\n  SM, $DT56,\n  SL, $DQ56,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM56, UltCritCard),\nCY56*(DE56*DO56*SL+UwDamage*DF56)))",
    "EJ56": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN201,CD56)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT56,\n  DamageMastery, $CS56,\n  DemonMastery, $CX56,\n  SPB, INDEX($BN$5:$BN201,CD56+1),\n  ITO, $CV56,\n  Shock, $CW56,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE56*DO56*$DQ56+DW56*DF56)))",
    "EK56": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO201,CE56)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT56,\n  DamageMastery, $CS56,\n  DemonMastery, $CX56,\n  SPB, $CU56,\n  ITO, INDEX($BO$5:$BO201,CE56+1),\n  Shock, $CW56,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE56*DO56*$DQ56+DW56*DF56)))",
    "EL56": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP201,CF56)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56, $DB56), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP56),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF56),\n  CL, $DS56,\n  SM, $DT56,\n  SLM, $DU56,\n  SL, $DQ56,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM56, UltCritCard),\nCY56*(DE56*DO56*SL+UwDamage*DF56)))",
    "EM56": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ201,CG56)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG56+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN56": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR201,CH56)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56, $DB56), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH56+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP56),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK56),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM201,CC56), SMHeat, $AR$29), 0),\n\n  DW, $DR56,\n  CL, $DS56,\n  SL, $DQ56,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM56, UltCritCard),\nCY56*(DE56*DO56*SL+UwDamage*DF56)))",
    "EO56": "IF(OR(CI56 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI56+1))",
    "EP56": "IF(OR($AO$25, CJ56 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ56+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE200,BU56),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL56, 1),\n  DPM, (1+$DI56*CardRangeMastery*$DJ56*$AQ$9),\n  SuperTower, $DL56,\n  Rend, $DN56,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56, $DB56), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR56,\n  SM, $DT56,\n  SLM, $DU56,\n  SL, $DQ56,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM56, UltCritCard),\n\nCY56*(DE56*OtherDamage*SL+UwDamage*DF56)))",
    "EQ56": "IF(OR(CK56 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK56+1)*1%, 1),\n  CF, $DB56,\n  CC, MIN(100%, $CZ56 + 1%),\n  CCUW, DA56 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ201,BZ56) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC56 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR56,\n  CL, $DS56,\n  SM, $DT56,\n  SLM, $DU56,\n  SL, $DQ56,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM56, UltCritCard),\n\nCY56 * (Critical*DO56*SL+UwDamage*UWCritical)))",
    "ER56": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL56 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH201,BX56),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL56+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI56*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM201,CC56), $DV56, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH56,\n  Rapid, DG56,\n  SuperTower, $DL56,\n  Rend, $DN56,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM56,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56, $DB56), 1),\n\n  DW, $DR56,\n  CL, $DS56,\n  SM, $DT56,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY56*(DE56*OtherDamage*SL+UWDamage*DF56)))",
    "ES56": "IF(OR(CM56 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH56,\n  Rapid, DG56,\n  RDPM, (1+$DI56*$DJ56*$AQ$9),\n  Rend, $DN56,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK201,CA56),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM56+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56, $DB56), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR56,\n  CL, $DS56,\n  SM, $DT56,\n  SLM, $DU56,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY56*(DE56*OtherDamage*SL+UwDamage*DF56)))",
    "ET56": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN56 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM56,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN56+1, $DB56), 1),\n\n  DW, $DR56,\n  CL, $DS56,\n  SM, $DT56,\n  SLM, $DU56,\n  SL, $DQ56,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY56*(DE56*DO56*SL+UWDamage*DF56)))",
    "EU56": "IF(OR(NOT($BA$3), NOT($BA$23), $CO56 > $BA$15), \"\", 1 + 0.5*(CO56+1))",
    "EW56": "IF(DZ56=\"\", \"\", LET(\n  Now, CT56,\n  Next, DZ56,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT56),\nFactor/Cost))",
    "EX56": "IF(EA56=\"\",\"\",(EA56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU56))",
    "EY56": "IF(EB56=\"\",\"\",(EB56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV56))",
    "EZ56": "IF(EC56=\"\",\"\",(EC56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW56))",
    "FA56": "IF(ED56=\"\",\"\",(ED56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX56))",
    "FB56": "IF(EE56=\"\",\"\",(EE56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY56))",
    "FC56": "IF(EF56=\"\",\"\",(EF56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ56))",
    "FD56": "IF(EG56=\"\",\"\",(EG56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA56))",
    "FE56": "IF(EH56=\"\",\"\",(EH56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB56))",
    "FF56": "IF(EI56=\"\",\"\",(EI56/$DX56-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC56+1, 1, CC56))))",
    "FG56": "IF(EJ56=\"\",\"\",(EJ56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD56))",
    "FH56": "IF(EK56=\"\",\"\",(EK56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE56))",
    "FI56": "IF(EL56=\"\",\"\",(EL56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF56))",
    "FJ56": "IF(EM56=\"\", \"\", LET(\n  Now, CW56,\n  Next, EM56,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG56),\nFactor/Cost))",
    "FK56": "IF(EN56=\"\",\"\",(EN56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH56))",
    "FL56": "IF(EO56=\"\", \"\", LET(\n  Now, CS56,\n  Next, EO56,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI56),\nFactor/Cost))",
    "FM56": "IF(EP56=\"\",\"\",(EP56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ56))",
    "FN56": "IF(EQ56=\"\",\"\",(EQ56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK56))",
    "FO56": "IF(ER56=\"\",\"\",(ER56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL56))",
    "FP56": "IF(ES56=\"\",\"\",(ES56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM56))",
    "FQ56": "IF(ET56=\"\",\"\",(ET56/$DX56-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN56))",
    "FR56": "IF(EU56=\"\", \"\", LET(\n  Now, CX56,\n  Next, EU56,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO56),\nFactor/Cost))",
    "FT56": "IF(COLUMN(EW56:FR56) = MIN(IF(EW56:FR56=MAX(EW56:FR56), COLUMN(EW56:FR56))), 1, \"\")",
    "D57": "IF(SUM(FT56:GP56),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F57)),\"Card Mastery\",F57),G57)/$D$5,\"\")",
    "F57": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT56:GP56),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT56:GP56=1)),)\"),\"Standard Perks Bonus\")",
    "G57": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT56:GP56),ARRAYFORMULA(FILTER(BT56:CP56 , FT56:GP56=1)),\"\"\"\")\"),2.0)",
    "I57": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT56:GP56),ARRAYFORMULA(FILTER(EW56:FS56 , FT56:GP56=1))*D$5,\"\"\"\")\"),0.042686903420881044)",
    "K57": "IF(H57<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D57)),)",
    "BC57": "BC56+1",
    "BD57": "BD56+BD$3",
    "BE57": "BE56+BE$3",
    "BF57": "BF56+BF$3",
    "BG57": "BG56+BG$3",
    "BH57": "BH56+BH$3",
    "BT57": "BT56+FT56",
    "BU57": "BU56+FU56",
    "BV57": "BV56+FV56",
    "BW57": "BW56+FW56",
    "BX57": "BX56+FX56",
    "BY57": "BY56+FY56",
    "BZ57": "BZ56+FZ56",
    "CA57": "CA56+GA56",
    "CB57": "CB56+GB56",
    "CC57": "CC56+GC56",
    "CD57": "CD56+GD56",
    "CE57": "CE56+GE56",
    "CF57": "CF56+GF56",
    "CG57": "CG56+GG56",
    "CH57": "CH56+GH56",
    "CI57": "CI56+GI56",
    "CJ57": "CJ56+GJ56",
    "CK57": "CK56+GK56",
    "CL57": "CL56+GL56",
    "CM57": "CM56+GM56",
    "CN57": "CN56+GN56",
    "CO57": "CO56+GO56",
    "CS57": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI57,1)",
    "CT57": "INDEX($BD$5:$BD202,BT57)",
    "CU57": "INDEX($BN$5:$BN202,CD57)",
    "CV57": "INDEX($BO$5:$BO202,CE57)",
    "CW57": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG57)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX57": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO57, 1)",
    "CY57": "LET(\n  Base, $CR$6,\n  Damage, $CT57,\n  DamageMastery, $CS57,\n  DemonMastery, $CX57,\n  SPB, $CU57,\n  ITO, $CV57,\n  Shock, $CW57,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ57": "MIN(100%, DA57)",
    "DA57": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK57*1%, 0)",
    "DB57": "LET(\n  Lab, 1+INDEX($BF$5:$BF202,BV57),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC57": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK57*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI202,BY57) + CardCritMastery)",
    "DD57": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK57*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ202,BZ57) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE57": "LET(\n  CF, $DB57,\n  CC, $CZ57,\n  SCM, $DD57,\n  SCC, $DC57,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF57": "LET(\n  CF, $DB57,\n  CC, $DA57,\n  SCM, $DD57,\n  SCC, $DC57,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG57": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH57)), 0)",
    "DH57": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ57*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE202,BU57),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI57": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG202, BW57), 1) + $AE$9)",
    "DJ57": "LET(\n  DpmLab, INDEX($BH$5:$BH202,BX57),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL57, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK57": "(1+$DI57*$DJ57*$AQ$9)",
    "DL57": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK202,CA57),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM57*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM57": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK202,CA57),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM57*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN57": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL202,CB57)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO57": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH57,\n  Rapid, DG57,\n  RDPM, DK57,\n  SuperTower, $DL57,\n  Rend, $DN57,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP57": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ57": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK57),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR57": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP57),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF57-1))",
    "DS57": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG57, DH57),0))",
    "DT57": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP57),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV57, $AR$29), 0))",
    "DU57": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK57),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM202,CC57), $DV57, $AR$29), 0))",
    "DV57": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH57), $AO$29)",
    "DW57": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM57,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57, $DB57), 1),\n\n  DW, $DR57,\n  CL, $DS57,\n  SM, $DT57,\n  SLM, $DU57,\n  SL, $DQ57,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX57": "CY57*(DE57*DO57*DQ57+DW57*DF57)",
    "DZ57": "IF(INDEX($BD$6:$BD202,BT57)=\"\", \"\", INDEX($BD$5:$BD202,BT57+1))",
    "EA57": "IF(OR($AO$25, INDEX($BE$6:$BE202,BU57)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ57)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE202,BU57+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI57*$DJ57*$AQ$9),\n  SuperTower, $DL57,\n  Rend, $DN57,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57, $DB57), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR57,\n  SM, $DT57,\n  SLM, $DU57,\n  SL, $DQ57,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM57, UltCritCard),\n\nCY57*(DE57*OtherDamage*SL+UwDamage*DF57)))",
    "EB57": "IF(INDEX($BF$6:$BF202,BV57)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF202,BV57+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ57,\n  CCUW, $DA57,\n  SCM, $DD57,\n  SCC, $DC57,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57, CF), 1),\n\n  DW, $DR57,\n  CL, $DS57,\n  SM, $DT57,\n  SLM, $DU57,\n  SL, $DQ57,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM57, UltCritCard),\n\nCY57 * (Critical * DO57 * SL + UwDamage * UWCritical)))",
    "EC57": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG202,BW57)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH57,\n  Rapid, DG57,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG202, BW57+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ57*$AQ$9),\n  SuperTower, $DL57,\n  Rend, $DN57,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM202,CC57), $DV57, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM57,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57, $DB57), 1),\n\n  DW, $DR57,\n  CL, $DS57,\n  SM, $DT57,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY57*(DE57*OtherDamage*SL+UWDamage*DF57)))",
    "ED57": "IF(OR($AO$25, INDEX($BH$6:$BH202,BX57)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH202,BX57+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL57, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI57*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM202,CC57), $DV57, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH57,\n  Rapid, DG57,\n  SuperTower, $DL57,\n  Rend, $DN57,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM57,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57, $DB57), 1),\n\n  DW, $DR57,\n  CL, $DS57,\n  SM, $DT57,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY57*(DE57*OtherDamage*SL+UWDamage*DF57)))",
    "EE57": "IF(INDEX($BI$6:$BI202,BY57)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK57, 0),\n  CF, $DB57,\n  CC, $CZ57,\n  CCUW, $DA57,\n  SCM, $DD57,\n  SCC, $AV$17+INDEX($BI$5:$BI202,BY57+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY57 * (Critical*DO57*$DQ57+DW57*UWCritical)))",
    "EF57": "IF(INDEX($BJ$6:$BJ202,BZ57)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK57*1%, 1),\n  CF, $DB57,\n  CC, $CZ57,\n  CCUW, $DA57,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ202,BZ57+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC57,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY57*(Critical*DO57*$DQ57+DW57*UWCritical)))",
    "EG57": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK202,CA57)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH57,\n  Rapid, DG57,\n  DPM, (1+$DI57*$DJ57*$AQ$9),\n  Rend, $DN57,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK202,CA57+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM57*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57, $DB57), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK202,CA57+1)-1))/(45-CM57*3),1),\n\n  SL, $DQ57,\n  DW, $DR57,\n  CL, $DS57,\n  SM, $DT57,\n  SLM, $DU57,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY57*(DE57*OtherDamage*SL+UwDamage*DF57)))",
    "EH57": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL202,CB57+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL202,CB57)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH57,\n  Rapid, DG57,\n  DPM, (1+$DI57*$DJ57*$AQ$9),\n  SuperTower, $DL57,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL202,CB57+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY57*(DE57*OtherDamage*$DQ57+DW57*DF57)))",
    "EI57": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM202,CC57)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57, $DB57), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK57),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV57, $AR$29), 0),\n\n  DW, $DR57,\n  CL, $DS57,\n  SM, $DT57,\n  SL, $DQ57,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM57, UltCritCard),\nCY57*(DE57*DO57*SL+UwDamage*DF57)))",
    "EJ57": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN202,CD57)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT57,\n  DamageMastery, $CS57,\n  DemonMastery, $CX57,\n  SPB, INDEX($BN$5:$BN202,CD57+1),\n  ITO, $CV57,\n  Shock, $CW57,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE57*DO57*$DQ57+DW57*DF57)))",
    "EK57": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO202,CE57)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT57,\n  DamageMastery, $CS57,\n  DemonMastery, $CX57,\n  SPB, $CU57,\n  ITO, INDEX($BO$5:$BO202,CE57+1),\n  Shock, $CW57,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE57*DO57*$DQ57+DW57*DF57)))",
    "EL57": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP202,CF57)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57, $DB57), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP57),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF57),\n  CL, $DS57,\n  SM, $DT57,\n  SLM, $DU57,\n  SL, $DQ57,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM57, UltCritCard),\nCY57*(DE57*DO57*SL+UwDamage*DF57)))",
    "EM57": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ202,CG57)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG57+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN57": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR202,CH57)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57, $DB57), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH57+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP57),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK57),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM202,CC57), SMHeat, $AR$29), 0),\n\n  DW, $DR57,\n  CL, $DS57,\n  SL, $DQ57,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM57, UltCritCard),\nCY57*(DE57*DO57*SL+UwDamage*DF57)))",
    "EO57": "IF(OR(CI57 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI57+1))",
    "EP57": "IF(OR($AO$25, CJ57 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ57+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE201,BU57),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL57, 1),\n  DPM, (1+$DI57*CardRangeMastery*$DJ57*$AQ$9),\n  SuperTower, $DL57,\n  Rend, $DN57,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57, $DB57), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR57,\n  SM, $DT57,\n  SLM, $DU57,\n  SL, $DQ57,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM57, UltCritCard),\n\nCY57*(DE57*OtherDamage*SL+UwDamage*DF57)))",
    "EQ57": "IF(OR(CK57 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK57+1)*1%, 1),\n  CF, $DB57,\n  CC, MIN(100%, $CZ57 + 1%),\n  CCUW, DA57 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ202,BZ57) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC57 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR57,\n  CL, $DS57,\n  SM, $DT57,\n  SLM, $DU57,\n  SL, $DQ57,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM57, UltCritCard),\n\nCY57 * (Critical*DO57*SL+UwDamage*UWCritical)))",
    "ER57": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL57 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH202,BX57),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL57+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI57*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM202,CC57), $DV57, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH57,\n  Rapid, DG57,\n  SuperTower, $DL57,\n  Rend, $DN57,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM57,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57, $DB57), 1),\n\n  DW, $DR57,\n  CL, $DS57,\n  SM, $DT57,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY57*(DE57*OtherDamage*SL+UWDamage*DF57)))",
    "ES57": "IF(OR(CM57 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH57,\n  Rapid, DG57,\n  RDPM, (1+$DI57*$DJ57*$AQ$9),\n  Rend, $DN57,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK202,CA57),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM57+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57, $DB57), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR57,\n  CL, $DS57,\n  SM, $DT57,\n  SLM, $DU57,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY57*(DE57*OtherDamage*SL+UwDamage*DF57)))",
    "ET57": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN57 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM57,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN57+1, $DB57), 1),\n\n  DW, $DR57,\n  CL, $DS57,\n  SM, $DT57,\n  SLM, $DU57,\n  SL, $DQ57,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY57*(DE57*DO57*SL+UWDamage*DF57)))",
    "EU57": "IF(OR(NOT($BA$3), NOT($BA$23), $CO57 > $BA$15), \"\", 1 + 0.5*(CO57+1))",
    "EW57": "IF(DZ57=\"\", \"\", LET(\n  Now, CT57,\n  Next, DZ57,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT57),\nFactor/Cost))",
    "EX57": "IF(EA57=\"\",\"\",(EA57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU57))",
    "EY57": "IF(EB57=\"\",\"\",(EB57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV57))",
    "EZ57": "IF(EC57=\"\",\"\",(EC57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW57))",
    "FA57": "IF(ED57=\"\",\"\",(ED57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX57))",
    "FB57": "IF(EE57=\"\",\"\",(EE57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY57))",
    "FC57": "IF(EF57=\"\",\"\",(EF57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ57))",
    "FD57": "IF(EG57=\"\",\"\",(EG57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA57))",
    "FE57": "IF(EH57=\"\",\"\",(EH57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB57))",
    "FF57": "IF(EI57=\"\",\"\",(EI57/$DX57-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC57+1, 1, CC57))))",
    "FG57": "IF(EJ57=\"\",\"\",(EJ57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD57))",
    "FH57": "IF(EK57=\"\",\"\",(EK57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE57))",
    "FI57": "IF(EL57=\"\",\"\",(EL57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF57))",
    "FJ57": "IF(EM57=\"\", \"\", LET(\n  Now, CW57,\n  Next, EM57,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG57),\nFactor/Cost))",
    "FK57": "IF(EN57=\"\",\"\",(EN57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH57))",
    "FL57": "IF(EO57=\"\", \"\", LET(\n  Now, CS57,\n  Next, EO57,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI57),\nFactor/Cost))",
    "FM57": "IF(EP57=\"\",\"\",(EP57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ57))",
    "FN57": "IF(EQ57=\"\",\"\",(EQ57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK57))",
    "FO57": "IF(ER57=\"\",\"\",(ER57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL57))",
    "FP57": "IF(ES57=\"\",\"\",(ES57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM57))",
    "FQ57": "IF(ET57=\"\",\"\",(ET57/$DX57-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN57))",
    "FR57": "IF(EU57=\"\", \"\", LET(\n  Now, CX57,\n  Next, EU57,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO57),\nFactor/Cost))",
    "FT57": "IF(COLUMN(EW57:FR57) = MIN(IF(EW57:FR57=MAX(EW57:FR57), COLUMN(EW57:FR57))), 1, \"\")",
    "D58": "IF(SUM(FT57:GP57),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F58)),\"Card Mastery\",F58),G58)/$D$5,\"\")",
    "F58": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT57:GP57),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT57:GP57=1)),)\"),\"Critical Factor\")",
    "G58": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT57:GP57),ARRAYFORMULA(FILTER(BT57:CP57 , FT57:GP57=1)),\"\"\"\")\"),15.0)",
    "I58": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT57:GP57),ARRAYFORMULA(FILTER(EW57:FS57 , FT57:GP57=1))*D$5,\"\"\"\")\"),0.041964481865272116)",
    "K58": "IF(H58<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D58)),)",
    "BC58": "BC57+1",
    "BD58": "BD57+BD$3",
    "BE58": "BE57+BE$3",
    "BF58": "BF57+BF$3",
    "BG58": "BG57+BG$3",
    "BH58": "BH57+BH$3",
    "BT58": "BT57+FT57",
    "BU58": "BU57+FU57",
    "BV58": "BV57+FV57",
    "BW58": "BW57+FW57",
    "BX58": "BX57+FX57",
    "BY58": "BY57+FY57",
    "BZ58": "BZ57+FZ57",
    "CA58": "CA57+GA57",
    "CB58": "CB57+GB57",
    "CC58": "CC57+GC57",
    "CD58": "CD57+GD57",
    "CE58": "CE57+GE57",
    "CF58": "CF57+GF57",
    "CG58": "CG57+GG57",
    "CH58": "CH57+GH57",
    "CI58": "CI57+GI57",
    "CJ58": "CJ57+GJ57",
    "CK58": "CK57+GK57",
    "CL58": "CL57+GL57",
    "CM58": "CM57+GM57",
    "CN58": "CN57+GN57",
    "CO58": "CO57+GO57",
    "CS58": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI58,1)",
    "CT58": "INDEX($BD$5:$BD203,BT58)",
    "CU58": "INDEX($BN$5:$BN203,CD58)",
    "CV58": "INDEX($BO$5:$BO203,CE58)",
    "CW58": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG58)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX58": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO58, 1)",
    "CY58": "LET(\n  Base, $CR$6,\n  Damage, $CT58,\n  DamageMastery, $CS58,\n  DemonMastery, $CX58,\n  SPB, $CU58,\n  ITO, $CV58,\n  Shock, $CW58,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ58": "MIN(100%, DA58)",
    "DA58": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK58*1%, 0)",
    "DB58": "LET(\n  Lab, 1+INDEX($BF$5:$BF203,BV58),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC58": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK58*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI203,BY58) + CardCritMastery)",
    "DD58": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK58*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ203,BZ58) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE58": "LET(\n  CF, $DB58,\n  CC, $CZ58,\n  SCM, $DD58,\n  SCC, $DC58,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF58": "LET(\n  CF, $DB58,\n  CC, $DA58,\n  SCM, $DD58,\n  SCC, $DC58,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG58": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH58)), 0)",
    "DH58": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ58*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE203,BU58),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI58": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG203, BW58), 1) + $AE$9)",
    "DJ58": "LET(\n  DpmLab, INDEX($BH$5:$BH203,BX58),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL58, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK58": "(1+$DI58*$DJ58*$AQ$9)",
    "DL58": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK203,CA58),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM58*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM58": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK203,CA58),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM58*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN58": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL203,CB58)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO58": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH58,\n  Rapid, DG58,\n  RDPM, DK58,\n  SuperTower, $DL58,\n  Rend, $DN58,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP58": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ58": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK58),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR58": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP58),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF58-1))",
    "DS58": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG58, DH58),0))",
    "DT58": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP58),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV58, $AR$29), 0))",
    "DU58": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK58),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM203,CC58), $DV58, $AR$29), 0))",
    "DV58": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH58), $AO$29)",
    "DW58": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM58,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58, $DB58), 1),\n\n  DW, $DR58,\n  CL, $DS58,\n  SM, $DT58,\n  SLM, $DU58,\n  SL, $DQ58,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX58": "CY58*(DE58*DO58*DQ58+DW58*DF58)",
    "DZ58": "IF(INDEX($BD$6:$BD203,BT58)=\"\", \"\", INDEX($BD$5:$BD203,BT58+1))",
    "EA58": "IF(OR($AO$25, INDEX($BE$6:$BE203,BU58)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ58)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE203,BU58+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI58*$DJ58*$AQ$9),\n  SuperTower, $DL58,\n  Rend, $DN58,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58, $DB58), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR58,\n  SM, $DT58,\n  SLM, $DU58,\n  SL, $DQ58,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM58, UltCritCard),\n\nCY58*(DE58*OtherDamage*SL+UwDamage*DF58)))",
    "EB58": "IF(INDEX($BF$6:$BF203,BV58)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF203,BV58+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ58,\n  CCUW, $DA58,\n  SCM, $DD58,\n  SCC, $DC58,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58, CF), 1),\n\n  DW, $DR58,\n  CL, $DS58,\n  SM, $DT58,\n  SLM, $DU58,\n  SL, $DQ58,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM58, UltCritCard),\n\nCY58 * (Critical * DO58 * SL + UwDamage * UWCritical)))",
    "EC58": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG203,BW58)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH58,\n  Rapid, DG58,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG203, BW58+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ58*$AQ$9),\n  SuperTower, $DL58,\n  Rend, $DN58,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM203,CC58), $DV58, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM58,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58, $DB58), 1),\n\n  DW, $DR58,\n  CL, $DS58,\n  SM, $DT58,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY58*(DE58*OtherDamage*SL+UWDamage*DF58)))",
    "ED58": "IF(OR($AO$25, INDEX($BH$6:$BH203,BX58)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH203,BX58+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL58, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI58*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM203,CC58), $DV58, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH58,\n  Rapid, DG58,\n  SuperTower, $DL58,\n  Rend, $DN58,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM58,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58, $DB58), 1),\n\n  DW, $DR58,\n  CL, $DS58,\n  SM, $DT58,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY58*(DE58*OtherDamage*SL+UWDamage*DF58)))",
    "EE58": "IF(INDEX($BI$6:$BI203,BY58)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK58, 0),\n  CF, $DB58,\n  CC, $CZ58,\n  CCUW, $DA58,\n  SCM, $DD58,\n  SCC, $AV$17+INDEX($BI$5:$BI203,BY58+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY58 * (Critical*DO58*$DQ58+DW58*UWCritical)))",
    "EF58": "IF(INDEX($BJ$6:$BJ203,BZ58)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK58*1%, 1),\n  CF, $DB58,\n  CC, $CZ58,\n  CCUW, $DA58,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ203,BZ58+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC58,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY58*(Critical*DO58*$DQ58+DW58*UWCritical)))",
    "EG58": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK203,CA58)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH58,\n  Rapid, DG58,\n  DPM, (1+$DI58*$DJ58*$AQ$9),\n  Rend, $DN58,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK203,CA58+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM58*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58, $DB58), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK203,CA58+1)-1))/(45-CM58*3),1),\n\n  SL, $DQ58,\n  DW, $DR58,\n  CL, $DS58,\n  SM, $DT58,\n  SLM, $DU58,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY58*(DE58*OtherDamage*SL+UwDamage*DF58)))",
    "EH58": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL203,CB58+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL203,CB58)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH58,\n  Rapid, DG58,\n  DPM, (1+$DI58*$DJ58*$AQ$9),\n  SuperTower, $DL58,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL203,CB58+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY58*(DE58*OtherDamage*$DQ58+DW58*DF58)))",
    "EI58": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM203,CC58)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58, $DB58), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK58),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV58, $AR$29), 0),\n\n  DW, $DR58,\n  CL, $DS58,\n  SM, $DT58,\n  SL, $DQ58,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM58, UltCritCard),\nCY58*(DE58*DO58*SL+UwDamage*DF58)))",
    "EJ58": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN203,CD58)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT58,\n  DamageMastery, $CS58,\n  DemonMastery, $CX58,\n  SPB, INDEX($BN$5:$BN203,CD58+1),\n  ITO, $CV58,\n  Shock, $CW58,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE58*DO58*$DQ58+DW58*DF58)))",
    "EK58": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO203,CE58)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT58,\n  DamageMastery, $CS58,\n  DemonMastery, $CX58,\n  SPB, $CU58,\n  ITO, INDEX($BO$5:$BO203,CE58+1),\n  Shock, $CW58,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE58*DO58*$DQ58+DW58*DF58)))",
    "EL58": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP203,CF58)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58, $DB58), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP58),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF58),\n  CL, $DS58,\n  SM, $DT58,\n  SLM, $DU58,\n  SL, $DQ58,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM58, UltCritCard),\nCY58*(DE58*DO58*SL+UwDamage*DF58)))",
    "EM58": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ203,CG58)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG58+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN58": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR203,CH58)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58, $DB58), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH58+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP58),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK58),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM203,CC58), SMHeat, $AR$29), 0),\n\n  DW, $DR58,\n  CL, $DS58,\n  SL, $DQ58,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM58, UltCritCard),\nCY58*(DE58*DO58*SL+UwDamage*DF58)))",
    "EO58": "IF(OR(CI58 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI58+1))",
    "EP58": "IF(OR($AO$25, CJ58 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ58+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE202,BU58),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL58, 1),\n  DPM, (1+$DI58*CardRangeMastery*$DJ58*$AQ$9),\n  SuperTower, $DL58,\n  Rend, $DN58,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58, $DB58), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR58,\n  SM, $DT58,\n  SLM, $DU58,\n  SL, $DQ58,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM58, UltCritCard),\n\nCY58*(DE58*OtherDamage*SL+UwDamage*DF58)))",
    "EQ58": "IF(OR(CK58 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK58+1)*1%, 1),\n  CF, $DB58,\n  CC, MIN(100%, $CZ58 + 1%),\n  CCUW, DA58 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ203,BZ58) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC58 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR58,\n  CL, $DS58,\n  SM, $DT58,\n  SLM, $DU58,\n  SL, $DQ58,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM58, UltCritCard),\n\nCY58 * (Critical*DO58*SL+UwDamage*UWCritical)))",
    "ER58": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL58 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH203,BX58),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL58+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI58*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM203,CC58), $DV58, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH58,\n  Rapid, DG58,\n  SuperTower, $DL58,\n  Rend, $DN58,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM58,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58, $DB58), 1),\n\n  DW, $DR58,\n  CL, $DS58,\n  SM, $DT58,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY58*(DE58*OtherDamage*SL+UWDamage*DF58)))",
    "ES58": "IF(OR(CM58 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH58,\n  Rapid, DG58,\n  RDPM, (1+$DI58*$DJ58*$AQ$9),\n  Rend, $DN58,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK203,CA58),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM58+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58, $DB58), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR58,\n  CL, $DS58,\n  SM, $DT58,\n  SLM, $DU58,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY58*(DE58*OtherDamage*SL+UwDamage*DF58)))",
    "ET58": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN58 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM58,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN58+1, $DB58), 1),\n\n  DW, $DR58,\n  CL, $DS58,\n  SM, $DT58,\n  SLM, $DU58,\n  SL, $DQ58,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY58*(DE58*DO58*SL+UWDamage*DF58)))",
    "EU58": "IF(OR(NOT($BA$3), NOT($BA$23), $CO58 > $BA$15), \"\", 1 + 0.5*(CO58+1))",
    "EW58": "IF(DZ58=\"\", \"\", LET(\n  Now, CT58,\n  Next, DZ58,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT58),\nFactor/Cost))",
    "EX58": "IF(EA58=\"\",\"\",(EA58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU58))",
    "EY58": "IF(EB58=\"\",\"\",(EB58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV58))",
    "EZ58": "IF(EC58=\"\",\"\",(EC58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW58))",
    "FA58": "IF(ED58=\"\",\"\",(ED58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX58))",
    "FB58": "IF(EE58=\"\",\"\",(EE58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY58))",
    "FC58": "IF(EF58=\"\",\"\",(EF58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ58))",
    "FD58": "IF(EG58=\"\",\"\",(EG58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA58))",
    "FE58": "IF(EH58=\"\",\"\",(EH58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB58))",
    "FF58": "IF(EI58=\"\",\"\",(EI58/$DX58-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC58+1, 1, CC58))))",
    "FG58": "IF(EJ58=\"\",\"\",(EJ58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD58))",
    "FH58": "IF(EK58=\"\",\"\",(EK58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE58))",
    "FI58": "IF(EL58=\"\",\"\",(EL58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF58))",
    "FJ58": "IF(EM58=\"\", \"\", LET(\n  Now, CW58,\n  Next, EM58,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG58),\nFactor/Cost))",
    "FK58": "IF(EN58=\"\",\"\",(EN58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH58))",
    "FL58": "IF(EO58=\"\", \"\", LET(\n  Now, CS58,\n  Next, EO58,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI58),\nFactor/Cost))",
    "FM58": "IF(EP58=\"\",\"\",(EP58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ58))",
    "FN58": "IF(EQ58=\"\",\"\",(EQ58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK58))",
    "FO58": "IF(ER58=\"\",\"\",(ER58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL58))",
    "FP58": "IF(ES58=\"\",\"\",(ES58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM58))",
    "FQ58": "IF(ET58=\"\",\"\",(ET58/$DX58-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN58))",
    "FR58": "IF(EU58=\"\", \"\", LET(\n  Now, CX58,\n  Next, EU58,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO58),\nFactor/Cost))",
    "FT58": "IF(COLUMN(EW58:FR58) = MIN(IF(EW58:FR58=MAX(EW58:FR58), COLUMN(EW58:FR58))), 1, \"\")",
    "D59": "IF(SUM(FT58:GP58),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F59)),\"Card Mastery\",F59),G59)/$D$5,\"\")",
    "F59": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT58:GP58),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT58:GP58=1)),)\"),\"Damage / Meter\")",
    "G59": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT58:GP58),ARRAYFORMULA(FILTER(BT58:CP58 , FT58:GP58=1)),\"\"\"\")\"),10.0)",
    "I59": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT58:GP58),ARRAYFORMULA(FILTER(EW58:FS58 , FT58:GP58=1))*D$5,\"\"\"\")\"),0.038234168542910216)",
    "K59": "IF(H59<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D59)),)",
    "BC59": "BC58+1",
    "BD59": "BD58+BD$3",
    "BE59": "BE58+BE$3",
    "BF59": "BF58+BF$3",
    "BG59": "BG58+BG$3",
    "BH59": "BH58+BH$3",
    "BT59": "BT58+FT58",
    "BU59": "BU58+FU58",
    "BV59": "BV58+FV58",
    "BW59": "BW58+FW58",
    "BX59": "BX58+FX58",
    "BY59": "BY58+FY58",
    "BZ59": "BZ58+FZ58",
    "CA59": "CA58+GA58",
    "CB59": "CB58+GB58",
    "CC59": "CC58+GC58",
    "CD59": "CD58+GD58",
    "CE59": "CE58+GE58",
    "CF59": "CF58+GF58",
    "CG59": "CG58+GG58",
    "CH59": "CH58+GH58",
    "CI59": "CI58+GI58",
    "CJ59": "CJ58+GJ58",
    "CK59": "CK58+GK58",
    "CL59": "CL58+GL58",
    "CM59": "CM58+GM58",
    "CN59": "CN58+GN58",
    "CO59": "CO58+GO58",
    "CS59": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI59,1)",
    "CT59": "INDEX($BD$5:$BD204,BT59)",
    "CU59": "INDEX($BN$5:$BN204,CD59)",
    "CV59": "INDEX($BO$5:$BO204,CE59)",
    "CW59": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG59)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX59": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO59, 1)",
    "CY59": "LET(\n  Base, $CR$6,\n  Damage, $CT59,\n  DamageMastery, $CS59,\n  DemonMastery, $CX59,\n  SPB, $CU59,\n  ITO, $CV59,\n  Shock, $CW59,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ59": "MIN(100%, DA59)",
    "DA59": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK59*1%, 0)",
    "DB59": "LET(\n  Lab, 1+INDEX($BF$5:$BF204,BV59),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC59": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK59*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI204,BY59) + CardCritMastery)",
    "DD59": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK59*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ204,BZ59) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE59": "LET(\n  CF, $DB59,\n  CC, $CZ59,\n  SCM, $DD59,\n  SCC, $DC59,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF59": "LET(\n  CF, $DB59,\n  CC, $DA59,\n  SCM, $DD59,\n  SCC, $DC59,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG59": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH59)), 0)",
    "DH59": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ59*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE204,BU59),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI59": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG204, BW59), 1) + $AE$9)",
    "DJ59": "LET(\n  DpmLab, INDEX($BH$5:$BH204,BX59),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL59, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK59": "(1+$DI59*$DJ59*$AQ$9)",
    "DL59": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK204,CA59),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM59*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM59": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK204,CA59),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM59*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN59": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL204,CB59)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO59": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH59,\n  Rapid, DG59,\n  RDPM, DK59,\n  SuperTower, $DL59,\n  Rend, $DN59,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP59": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ59": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK59),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR59": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP59),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF59-1))",
    "DS59": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG59, DH59),0))",
    "DT59": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP59),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV59, $AR$29), 0))",
    "DU59": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK59),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM204,CC59), $DV59, $AR$29), 0))",
    "DV59": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH59), $AO$29)",
    "DW59": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM59,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59, $DB59), 1),\n\n  DW, $DR59,\n  CL, $DS59,\n  SM, $DT59,\n  SLM, $DU59,\n  SL, $DQ59,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX59": "CY59*(DE59*DO59*DQ59+DW59*DF59)",
    "DZ59": "IF(INDEX($BD$6:$BD204,BT59)=\"\", \"\", INDEX($BD$5:$BD204,BT59+1))",
    "EA59": "IF(OR($AO$25, INDEX($BE$6:$BE204,BU59)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ59)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE204,BU59+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI59*$DJ59*$AQ$9),\n  SuperTower, $DL59,\n  Rend, $DN59,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59, $DB59), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR59,\n  SM, $DT59,\n  SLM, $DU59,\n  SL, $DQ59,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM59, UltCritCard),\n\nCY59*(DE59*OtherDamage*SL+UwDamage*DF59)))",
    "EB59": "IF(INDEX($BF$6:$BF204,BV59)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF204,BV59+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ59,\n  CCUW, $DA59,\n  SCM, $DD59,\n  SCC, $DC59,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59, CF), 1),\n\n  DW, $DR59,\n  CL, $DS59,\n  SM, $DT59,\n  SLM, $DU59,\n  SL, $DQ59,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM59, UltCritCard),\n\nCY59 * (Critical * DO59 * SL + UwDamage * UWCritical)))",
    "EC59": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG204,BW59)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH59,\n  Rapid, DG59,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG204, BW59+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ59*$AQ$9),\n  SuperTower, $DL59,\n  Rend, $DN59,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM204,CC59), $DV59, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM59,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59, $DB59), 1),\n\n  DW, $DR59,\n  CL, $DS59,\n  SM, $DT59,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY59*(DE59*OtherDamage*SL+UWDamage*DF59)))",
    "ED59": "IF(OR($AO$25, INDEX($BH$6:$BH204,BX59)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH204,BX59+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL59, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI59*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM204,CC59), $DV59, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH59,\n  Rapid, DG59,\n  SuperTower, $DL59,\n  Rend, $DN59,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM59,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59, $DB59), 1),\n\n  DW, $DR59,\n  CL, $DS59,\n  SM, $DT59,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY59*(DE59*OtherDamage*SL+UWDamage*DF59)))",
    "EE59": "IF(INDEX($BI$6:$BI204,BY59)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK59, 0),\n  CF, $DB59,\n  CC, $CZ59,\n  CCUW, $DA59,\n  SCM, $DD59,\n  SCC, $AV$17+INDEX($BI$5:$BI204,BY59+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY59 * (Critical*DO59*$DQ59+DW59*UWCritical)))",
    "EF59": "IF(INDEX($BJ$6:$BJ204,BZ59)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK59*1%, 1),\n  CF, $DB59,\n  CC, $CZ59,\n  CCUW, $DA59,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ204,BZ59+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC59,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY59*(Critical*DO59*$DQ59+DW59*UWCritical)))",
    "EG59": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK204,CA59)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH59,\n  Rapid, DG59,\n  DPM, (1+$DI59*$DJ59*$AQ$9),\n  Rend, $DN59,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK204,CA59+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM59*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59, $DB59), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK204,CA59+1)-1))/(45-CM59*3),1),\n\n  SL, $DQ59,\n  DW, $DR59,\n  CL, $DS59,\n  SM, $DT59,\n  SLM, $DU59,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY59*(DE59*OtherDamage*SL+UwDamage*DF59)))",
    "EH59": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL204,CB59+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL204,CB59)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH59,\n  Rapid, DG59,\n  DPM, (1+$DI59*$DJ59*$AQ$9),\n  SuperTower, $DL59,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL204,CB59+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY59*(DE59*OtherDamage*$DQ59+DW59*DF59)))",
    "EI59": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM204,CC59)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59, $DB59), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK59),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV59, $AR$29), 0),\n\n  DW, $DR59,\n  CL, $DS59,\n  SM, $DT59,\n  SL, $DQ59,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM59, UltCritCard),\nCY59*(DE59*DO59*SL+UwDamage*DF59)))",
    "EJ59": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN204,CD59)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT59,\n  DamageMastery, $CS59,\n  DemonMastery, $CX59,\n  SPB, INDEX($BN$5:$BN204,CD59+1),\n  ITO, $CV59,\n  Shock, $CW59,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE59*DO59*$DQ59+DW59*DF59)))",
    "EK59": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO204,CE59)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT59,\n  DamageMastery, $CS59,\n  DemonMastery, $CX59,\n  SPB, $CU59,\n  ITO, INDEX($BO$5:$BO204,CE59+1),\n  Shock, $CW59,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE59*DO59*$DQ59+DW59*DF59)))",
    "EL59": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP204,CF59)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59, $DB59), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP59),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF59),\n  CL, $DS59,\n  SM, $DT59,\n  SLM, $DU59,\n  SL, $DQ59,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM59, UltCritCard),\nCY59*(DE59*DO59*SL+UwDamage*DF59)))",
    "EM59": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ204,CG59)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG59+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN59": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR204,CH59)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59, $DB59), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH59+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP59),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK59),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM204,CC59), SMHeat, $AR$29), 0),\n\n  DW, $DR59,\n  CL, $DS59,\n  SL, $DQ59,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM59, UltCritCard),\nCY59*(DE59*DO59*SL+UwDamage*DF59)))",
    "EO59": "IF(OR(CI59 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI59+1))",
    "EP59": "IF(OR($AO$25, CJ59 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ59+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE203,BU59),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL59, 1),\n  DPM, (1+$DI59*CardRangeMastery*$DJ59*$AQ$9),\n  SuperTower, $DL59,\n  Rend, $DN59,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59, $DB59), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR59,\n  SM, $DT59,\n  SLM, $DU59,\n  SL, $DQ59,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM59, UltCritCard),\n\nCY59*(DE59*OtherDamage*SL+UwDamage*DF59)))",
    "EQ59": "IF(OR(CK59 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK59+1)*1%, 1),\n  CF, $DB59,\n  CC, MIN(100%, $CZ59 + 1%),\n  CCUW, DA59 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ204,BZ59) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC59 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR59,\n  CL, $DS59,\n  SM, $DT59,\n  SLM, $DU59,\n  SL, $DQ59,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM59, UltCritCard),\n\nCY59 * (Critical*DO59*SL+UwDamage*UWCritical)))",
    "ER59": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL59 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH204,BX59),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL59+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI59*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM204,CC59), $DV59, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH59,\n  Rapid, DG59,\n  SuperTower, $DL59,\n  Rend, $DN59,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM59,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59, $DB59), 1),\n\n  DW, $DR59,\n  CL, $DS59,\n  SM, $DT59,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY59*(DE59*OtherDamage*SL+UWDamage*DF59)))",
    "ES59": "IF(OR(CM59 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH59,\n  Rapid, DG59,\n  RDPM, (1+$DI59*$DJ59*$AQ$9),\n  Rend, $DN59,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK204,CA59),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM59+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59, $DB59), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR59,\n  CL, $DS59,\n  SM, $DT59,\n  SLM, $DU59,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY59*(DE59*OtherDamage*SL+UwDamage*DF59)))",
    "ET59": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN59 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM59,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN59+1, $DB59), 1),\n\n  DW, $DR59,\n  CL, $DS59,\n  SM, $DT59,\n  SLM, $DU59,\n  SL, $DQ59,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY59*(DE59*DO59*SL+UWDamage*DF59)))",
    "EU59": "IF(OR(NOT($BA$3), NOT($BA$23), $CO59 > $BA$15), \"\", 1 + 0.5*(CO59+1))",
    "EW59": "IF(DZ59=\"\", \"\", LET(\n  Now, CT59,\n  Next, DZ59,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT59),\nFactor/Cost))",
    "EX59": "IF(EA59=\"\",\"\",(EA59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU59))",
    "EY59": "IF(EB59=\"\",\"\",(EB59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV59))",
    "EZ59": "IF(EC59=\"\",\"\",(EC59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW59))",
    "FA59": "IF(ED59=\"\",\"\",(ED59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX59))",
    "FB59": "IF(EE59=\"\",\"\",(EE59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY59))",
    "FC59": "IF(EF59=\"\",\"\",(EF59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ59))",
    "FD59": "IF(EG59=\"\",\"\",(EG59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA59))",
    "FE59": "IF(EH59=\"\",\"\",(EH59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB59))",
    "FF59": "IF(EI59=\"\",\"\",(EI59/$DX59-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC59+1, 1, CC59))))",
    "FG59": "IF(EJ59=\"\",\"\",(EJ59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD59))",
    "FH59": "IF(EK59=\"\",\"\",(EK59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE59))",
    "FI59": "IF(EL59=\"\",\"\",(EL59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF59))",
    "FJ59": "IF(EM59=\"\", \"\", LET(\n  Now, CW59,\n  Next, EM59,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG59),\nFactor/Cost))",
    "FK59": "IF(EN59=\"\",\"\",(EN59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH59))",
    "FL59": "IF(EO59=\"\", \"\", LET(\n  Now, CS59,\n  Next, EO59,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI59),\nFactor/Cost))",
    "FM59": "IF(EP59=\"\",\"\",(EP59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ59))",
    "FN59": "IF(EQ59=\"\",\"\",(EQ59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK59))",
    "FO59": "IF(ER59=\"\",\"\",(ER59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL59))",
    "FP59": "IF(ES59=\"\",\"\",(ES59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM59))",
    "FQ59": "IF(ET59=\"\",\"\",(ET59/$DX59-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN59))",
    "FR59": "IF(EU59=\"\", \"\", LET(\n  Now, CX59,\n  Next, EU59,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO59),\nFactor/Cost))",
    "FT59": "IF(COLUMN(EW59:FR59) = MIN(IF(EW59:FR59=MAX(EW59:FR59), COLUMN(EW59:FR59))), 1, \"\")",
    "D60": "IF(SUM(FT59:GP59),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F60)),\"Card Mastery\",F60),G60)/$D$5,\"\")",
    "F60": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT59:GP59),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT59:GP59=1)),)\"),\"Damage\")",
    "G60": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT59:GP59),ARRAYFORMULA(FILTER(BT59:CP59 , FT59:GP59=1)),\"\"\"\")\"),14.0)",
    "I60": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT59:GP59),ARRAYFORMULA(FILTER(EW59:FS59 , FT59:GP59=1))*D$5,\"\"\"\")\"),0.03716608594657362)",
    "K60": "IF(H60<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D60)),)",
    "BC60": "BC59+1",
    "BD60": "BD59+BD$3",
    "BE60": "BE59+BE$3",
    "BF60": "BF59+BF$3",
    "BG60": "BG59+BG$3",
    "BH60": "BH59+BH$3",
    "BT60": "BT59+FT59",
    "BU60": "BU59+FU59",
    "BV60": "BV59+FV59",
    "BW60": "BW59+FW59",
    "BX60": "BX59+FX59",
    "BY60": "BY59+FY59",
    "BZ60": "BZ59+FZ59",
    "CA60": "CA59+GA59",
    "CB60": "CB59+GB59",
    "CC60": "CC59+GC59",
    "CD60": "CD59+GD59",
    "CE60": "CE59+GE59",
    "CF60": "CF59+GF59",
    "CG60": "CG59+GG59",
    "CH60": "CH59+GH59",
    "CI60": "CI59+GI59",
    "CJ60": "CJ59+GJ59",
    "CK60": "CK59+GK59",
    "CL60": "CL59+GL59",
    "CM60": "CM59+GM59",
    "CN60": "CN59+GN59",
    "CO60": "CO59+GO59",
    "CS60": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI60,1)",
    "CT60": "INDEX($BD$5:$BD205,BT60)",
    "CU60": "INDEX($BN$5:$BN205,CD60)",
    "CV60": "INDEX($BO$5:$BO205,CE60)",
    "CW60": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG60)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX60": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO60, 1)",
    "CY60": "LET(\n  Base, $CR$6,\n  Damage, $CT60,\n  DamageMastery, $CS60,\n  DemonMastery, $CX60,\n  SPB, $CU60,\n  ITO, $CV60,\n  Shock, $CW60,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ60": "MIN(100%, DA60)",
    "DA60": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK60*1%, 0)",
    "DB60": "LET(\n  Lab, 1+INDEX($BF$5:$BF205,BV60),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC60": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK60*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI205,BY60) + CardCritMastery)",
    "DD60": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK60*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ205,BZ60) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE60": "LET(\n  CF, $DB60,\n  CC, $CZ60,\n  SCM, $DD60,\n  SCC, $DC60,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF60": "LET(\n  CF, $DB60,\n  CC, $DA60,\n  SCM, $DD60,\n  SCC, $DC60,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG60": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH60)), 0)",
    "DH60": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ60*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE205,BU60),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI60": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG205, BW60), 1) + $AE$9)",
    "DJ60": "LET(\n  DpmLab, INDEX($BH$5:$BH205,BX60),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL60, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK60": "(1+$DI60*$DJ60*$AQ$9)",
    "DL60": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK205,CA60),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM60*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM60": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK205,CA60),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM60*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN60": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL205,CB60)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO60": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH60,\n  Rapid, DG60,\n  RDPM, DK60,\n  SuperTower, $DL60,\n  Rend, $DN60,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP60": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ60": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK60),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR60": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP60),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF60-1))",
    "DS60": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG60, DH60),0))",
    "DT60": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP60),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV60, $AR$29), 0))",
    "DU60": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK60),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM205,CC60), $DV60, $AR$29), 0))",
    "DV60": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH60), $AO$29)",
    "DW60": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM60,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60, $DB60), 1),\n\n  DW, $DR60,\n  CL, $DS60,\n  SM, $DT60,\n  SLM, $DU60,\n  SL, $DQ60,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX60": "CY60*(DE60*DO60*DQ60+DW60*DF60)",
    "DZ60": "IF(INDEX($BD$6:$BD205,BT60)=\"\", \"\", INDEX($BD$5:$BD205,BT60+1))",
    "EA60": "IF(OR($AO$25, INDEX($BE$6:$BE205,BU60)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ60)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE205,BU60+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI60*$DJ60*$AQ$9),\n  SuperTower, $DL60,\n  Rend, $DN60,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60, $DB60), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR60,\n  SM, $DT60,\n  SLM, $DU60,\n  SL, $DQ60,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM60, UltCritCard),\n\nCY60*(DE60*OtherDamage*SL+UwDamage*DF60)))",
    "EB60": "IF(INDEX($BF$6:$BF205,BV60)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF205,BV60+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ60,\n  CCUW, $DA60,\n  SCM, $DD60,\n  SCC, $DC60,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60, CF), 1),\n\n  DW, $DR60,\n  CL, $DS60,\n  SM, $DT60,\n  SLM, $DU60,\n  SL, $DQ60,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM60, UltCritCard),\n\nCY60 * (Critical * DO60 * SL + UwDamage * UWCritical)))",
    "EC60": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG205,BW60)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH60,\n  Rapid, DG60,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG205, BW60+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ60*$AQ$9),\n  SuperTower, $DL60,\n  Rend, $DN60,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM205,CC60), $DV60, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM60,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60, $DB60), 1),\n\n  DW, $DR60,\n  CL, $DS60,\n  SM, $DT60,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY60*(DE60*OtherDamage*SL+UWDamage*DF60)))",
    "ED60": "IF(OR($AO$25, INDEX($BH$6:$BH205,BX60)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH205,BX60+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL60, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI60*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM205,CC60), $DV60, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH60,\n  Rapid, DG60,\n  SuperTower, $DL60,\n  Rend, $DN60,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM60,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60, $DB60), 1),\n\n  DW, $DR60,\n  CL, $DS60,\n  SM, $DT60,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY60*(DE60*OtherDamage*SL+UWDamage*DF60)))",
    "EE60": "IF(INDEX($BI$6:$BI205,BY60)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK60, 0),\n  CF, $DB60,\n  CC, $CZ60,\n  CCUW, $DA60,\n  SCM, $DD60,\n  SCC, $AV$17+INDEX($BI$5:$BI205,BY60+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY60 * (Critical*DO60*$DQ60+DW60*UWCritical)))",
    "EF60": "IF(INDEX($BJ$6:$BJ205,BZ60)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK60*1%, 1),\n  CF, $DB60,\n  CC, $CZ60,\n  CCUW, $DA60,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ205,BZ60+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC60,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY60*(Critical*DO60*$DQ60+DW60*UWCritical)))",
    "EG60": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK205,CA60)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH60,\n  Rapid, DG60,\n  DPM, (1+$DI60*$DJ60*$AQ$9),\n  Rend, $DN60,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK205,CA60+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM60*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60, $DB60), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK205,CA60+1)-1))/(45-CM60*3),1),\n\n  SL, $DQ60,\n  DW, $DR60,\n  CL, $DS60,\n  SM, $DT60,\n  SLM, $DU60,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY60*(DE60*OtherDamage*SL+UwDamage*DF60)))",
    "EH60": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL205,CB60+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL205,CB60)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH60,\n  Rapid, DG60,\n  DPM, (1+$DI60*$DJ60*$AQ$9),\n  SuperTower, $DL60,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL205,CB60+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY60*(DE60*OtherDamage*$DQ60+DW60*DF60)))",
    "EI60": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM205,CC60)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60, $DB60), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK60),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV60, $AR$29), 0),\n\n  DW, $DR60,\n  CL, $DS60,\n  SM, $DT60,\n  SL, $DQ60,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM60, UltCritCard),\nCY60*(DE60*DO60*SL+UwDamage*DF60)))",
    "EJ60": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN205,CD60)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT60,\n  DamageMastery, $CS60,\n  DemonMastery, $CX60,\n  SPB, INDEX($BN$5:$BN205,CD60+1),\n  ITO, $CV60,\n  Shock, $CW60,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE60*DO60*$DQ60+DW60*DF60)))",
    "EK60": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO205,CE60)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT60,\n  DamageMastery, $CS60,\n  DemonMastery, $CX60,\n  SPB, $CU60,\n  ITO, INDEX($BO$5:$BO205,CE60+1),\n  Shock, $CW60,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE60*DO60*$DQ60+DW60*DF60)))",
    "EL60": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP205,CF60)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60, $DB60), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP60),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF60),\n  CL, $DS60,\n  SM, $DT60,\n  SLM, $DU60,\n  SL, $DQ60,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM60, UltCritCard),\nCY60*(DE60*DO60*SL+UwDamage*DF60)))",
    "EM60": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ205,CG60)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG60+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN60": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR205,CH60)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60, $DB60), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH60+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP60),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK60),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM205,CC60), SMHeat, $AR$29), 0),\n\n  DW, $DR60,\n  CL, $DS60,\n  SL, $DQ60,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM60, UltCritCard),\nCY60*(DE60*DO60*SL+UwDamage*DF60)))",
    "EO60": "IF(OR(CI60 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI60+1))",
    "EP60": "IF(OR($AO$25, CJ60 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ60+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE204,BU60),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL60, 1),\n  DPM, (1+$DI60*CardRangeMastery*$DJ60*$AQ$9),\n  SuperTower, $DL60,\n  Rend, $DN60,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60, $DB60), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR60,\n  SM, $DT60,\n  SLM, $DU60,\n  SL, $DQ60,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM60, UltCritCard),\n\nCY60*(DE60*OtherDamage*SL+UwDamage*DF60)))",
    "EQ60": "IF(OR(CK60 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK60+1)*1%, 1),\n  CF, $DB60,\n  CC, MIN(100%, $CZ60 + 1%),\n  CCUW, DA60 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ205,BZ60) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC60 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR60,\n  CL, $DS60,\n  SM, $DT60,\n  SLM, $DU60,\n  SL, $DQ60,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM60, UltCritCard),\n\nCY60 * (Critical*DO60*SL+UwDamage*UWCritical)))",
    "ER60": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL60 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH205,BX60),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL60+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI60*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM205,CC60), $DV60, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH60,\n  Rapid, DG60,\n  SuperTower, $DL60,\n  Rend, $DN60,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM60,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60, $DB60), 1),\n\n  DW, $DR60,\n  CL, $DS60,\n  SM, $DT60,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY60*(DE60*OtherDamage*SL+UWDamage*DF60)))",
    "ES60": "IF(OR(CM60 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH60,\n  Rapid, DG60,\n  RDPM, (1+$DI60*$DJ60*$AQ$9),\n  Rend, $DN60,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK205,CA60),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM60+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60, $DB60), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR60,\n  CL, $DS60,\n  SM, $DT60,\n  SLM, $DU60,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY60*(DE60*OtherDamage*SL+UwDamage*DF60)))",
    "ET60": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN60 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM60,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN60+1, $DB60), 1),\n\n  DW, $DR60,\n  CL, $DS60,\n  SM, $DT60,\n  SLM, $DU60,\n  SL, $DQ60,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY60*(DE60*DO60*SL+UWDamage*DF60)))",
    "EU60": "IF(OR(NOT($BA$3), NOT($BA$23), $CO60 > $BA$15), \"\", 1 + 0.5*(CO60+1))",
    "EW60": "IF(DZ60=\"\", \"\", LET(\n  Now, CT60,\n  Next, DZ60,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT60),\nFactor/Cost))",
    "EX60": "IF(EA60=\"\",\"\",(EA60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU60))",
    "EY60": "IF(EB60=\"\",\"\",(EB60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV60))",
    "EZ60": "IF(EC60=\"\",\"\",(EC60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW60))",
    "FA60": "IF(ED60=\"\",\"\",(ED60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX60))",
    "FB60": "IF(EE60=\"\",\"\",(EE60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY60))",
    "FC60": "IF(EF60=\"\",\"\",(EF60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ60))",
    "FD60": "IF(EG60=\"\",\"\",(EG60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA60))",
    "FE60": "IF(EH60=\"\",\"\",(EH60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB60))",
    "FF60": "IF(EI60=\"\",\"\",(EI60/$DX60-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC60+1, 1, CC60))))",
    "FG60": "IF(EJ60=\"\",\"\",(EJ60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD60))",
    "FH60": "IF(EK60=\"\",\"\",(EK60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE60))",
    "FI60": "IF(EL60=\"\",\"\",(EL60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF60))",
    "FJ60": "IF(EM60=\"\", \"\", LET(\n  Now, CW60,\n  Next, EM60,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG60),\nFactor/Cost))",
    "FK60": "IF(EN60=\"\",\"\",(EN60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH60))",
    "FL60": "IF(EO60=\"\", \"\", LET(\n  Now, CS60,\n  Next, EO60,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI60),\nFactor/Cost))",
    "FM60": "IF(EP60=\"\",\"\",(EP60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ60))",
    "FN60": "IF(EQ60=\"\",\"\",(EQ60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK60))",
    "FO60": "IF(ER60=\"\",\"\",(ER60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL60))",
    "FP60": "IF(ES60=\"\",\"\",(ES60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM60))",
    "FQ60": "IF(ET60=\"\",\"\",(ET60/$DX60-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN60))",
    "FR60": "IF(EU60=\"\", \"\", LET(\n  Now, CX60,\n  Next, EU60,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO60),\nFactor/Cost))",
    "FT60": "IF(COLUMN(EW60:FR60) = MIN(IF(EW60:FR60=MAX(EW60:FR60), COLUMN(EW60:FR60))), 1, \"\")",
    "D61": "IF(SUM(FT60:GP60),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F61)),\"Card Mastery\",F61),G61)/$D$5,\"\")",
    "F61": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT60:GP60),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT60:GP60=1)),)\"),\"Attack Speed\")",
    "G61": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT60:GP60),ARRAYFORMULA(FILTER(BT60:CP60 , FT60:GP60=1)),\"\"\"\")\"),14.0)",
    "I61": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT60:GP60),ARRAYFORMULA(FILTER(EW60:FS60 , FT60:GP60=1))*D$5,\"\"\"\")\"),0.037080620370502276)",
    "K61": "IF(H61<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D61)),)",
    "BC61": "BC60+1",
    "BD61": "BD60+BD$3",
    "BE61": "BE60+BE$3",
    "BF61": "BF60+BF$3",
    "BG61": "BG60+BG$3",
    "BH61": "BH60+BH$3",
    "BT61": "BT60+FT60",
    "BU61": "BU60+FU60",
    "BV61": "BV60+FV60",
    "BW61": "BW60+FW60",
    "BX61": "BX60+FX60",
    "BY61": "BY60+FY60",
    "BZ61": "BZ60+FZ60",
    "CA61": "CA60+GA60",
    "CB61": "CB60+GB60",
    "CC61": "CC60+GC60",
    "CD61": "CD60+GD60",
    "CE61": "CE60+GE60",
    "CF61": "CF60+GF60",
    "CG61": "CG60+GG60",
    "CH61": "CH60+GH60",
    "CI61": "CI60+GI60",
    "CJ61": "CJ60+GJ60",
    "CK61": "CK60+GK60",
    "CL61": "CL60+GL60",
    "CM61": "CM60+GM60",
    "CN61": "CN60+GN60",
    "CO61": "CO60+GO60",
    "CS61": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI61,1)",
    "CT61": "INDEX($BD$5:$BD206,BT61)",
    "CU61": "INDEX($BN$5:$BN206,CD61)",
    "CV61": "INDEX($BO$5:$BO206,CE61)",
    "CW61": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG61)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX61": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO61, 1)",
    "CY61": "LET(\n  Base, $CR$6,\n  Damage, $CT61,\n  DamageMastery, $CS61,\n  DemonMastery, $CX61,\n  SPB, $CU61,\n  ITO, $CV61,\n  Shock, $CW61,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ61": "MIN(100%, DA61)",
    "DA61": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK61*1%, 0)",
    "DB61": "LET(\n  Lab, 1+INDEX($BF$5:$BF206,BV61),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC61": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK61*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI206,BY61) + CardCritMastery)",
    "DD61": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK61*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ206,BZ61) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE61": "LET(\n  CF, $DB61,\n  CC, $CZ61,\n  SCM, $DD61,\n  SCC, $DC61,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF61": "LET(\n  CF, $DB61,\n  CC, $DA61,\n  SCM, $DD61,\n  SCC, $DC61,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG61": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH61)), 0)",
    "DH61": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ61*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE206,BU61),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI61": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG206, BW61), 1) + $AE$9)",
    "DJ61": "LET(\n  DpmLab, INDEX($BH$5:$BH206,BX61),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL61, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK61": "(1+$DI61*$DJ61*$AQ$9)",
    "DL61": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK206,CA61),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM61*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM61": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK206,CA61),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM61*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN61": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL206,CB61)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO61": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH61,\n  Rapid, DG61,\n  RDPM, DK61,\n  SuperTower, $DL61,\n  Rend, $DN61,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP61": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ61": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK61),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR61": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP61),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF61-1))",
    "DS61": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG61, DH61),0))",
    "DT61": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP61),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV61, $AR$29), 0))",
    "DU61": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK61),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM206,CC61), $DV61, $AR$29), 0))",
    "DV61": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH61), $AO$29)",
    "DW61": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM61,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61, $DB61), 1),\n\n  DW, $DR61,\n  CL, $DS61,\n  SM, $DT61,\n  SLM, $DU61,\n  SL, $DQ61,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX61": "CY61*(DE61*DO61*DQ61+DW61*DF61)",
    "DZ61": "IF(INDEX($BD$6:$BD206,BT61)=\"\", \"\", INDEX($BD$5:$BD206,BT61+1))",
    "EA61": "IF(OR($AO$25, INDEX($BE$6:$BE206,BU61)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ61)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE206,BU61+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI61*$DJ61*$AQ$9),\n  SuperTower, $DL61,\n  Rend, $DN61,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61, $DB61), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR61,\n  SM, $DT61,\n  SLM, $DU61,\n  SL, $DQ61,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM61, UltCritCard),\n\nCY61*(DE61*OtherDamage*SL+UwDamage*DF61)))",
    "EB61": "IF(INDEX($BF$6:$BF206,BV61)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF206,BV61+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ61,\n  CCUW, $DA61,\n  SCM, $DD61,\n  SCC, $DC61,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61, CF), 1),\n\n  DW, $DR61,\n  CL, $DS61,\n  SM, $DT61,\n  SLM, $DU61,\n  SL, $DQ61,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM61, UltCritCard),\n\nCY61 * (Critical * DO61 * SL + UwDamage * UWCritical)))",
    "EC61": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG206,BW61)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH61,\n  Rapid, DG61,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG206, BW61+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ61*$AQ$9),\n  SuperTower, $DL61,\n  Rend, $DN61,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM206,CC61), $DV61, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM61,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61, $DB61), 1),\n\n  DW, $DR61,\n  CL, $DS61,\n  SM, $DT61,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY61*(DE61*OtherDamage*SL+UWDamage*DF61)))",
    "ED61": "IF(OR($AO$25, INDEX($BH$6:$BH206,BX61)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH206,BX61+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL61, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI61*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM206,CC61), $DV61, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH61,\n  Rapid, DG61,\n  SuperTower, $DL61,\n  Rend, $DN61,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM61,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61, $DB61), 1),\n\n  DW, $DR61,\n  CL, $DS61,\n  SM, $DT61,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY61*(DE61*OtherDamage*SL+UWDamage*DF61)))",
    "EE61": "IF(INDEX($BI$6:$BI206,BY61)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK61, 0),\n  CF, $DB61,\n  CC, $CZ61,\n  CCUW, $DA61,\n  SCM, $DD61,\n  SCC, $AV$17+INDEX($BI$5:$BI206,BY61+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY61 * (Critical*DO61*$DQ61+DW61*UWCritical)))",
    "EF61": "IF(INDEX($BJ$6:$BJ206,BZ61)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK61*1%, 1),\n  CF, $DB61,\n  CC, $CZ61,\n  CCUW, $DA61,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ206,BZ61+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC61,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY61*(Critical*DO61*$DQ61+DW61*UWCritical)))",
    "EG61": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK206,CA61)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH61,\n  Rapid, DG61,\n  DPM, (1+$DI61*$DJ61*$AQ$9),\n  Rend, $DN61,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK206,CA61+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM61*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61, $DB61), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK206,CA61+1)-1))/(45-CM61*3),1),\n\n  SL, $DQ61,\n  DW, $DR61,\n  CL, $DS61,\n  SM, $DT61,\n  SLM, $DU61,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY61*(DE61*OtherDamage*SL+UwDamage*DF61)))",
    "EH61": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL206,CB61+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL206,CB61)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH61,\n  Rapid, DG61,\n  DPM, (1+$DI61*$DJ61*$AQ$9),\n  SuperTower, $DL61,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL206,CB61+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY61*(DE61*OtherDamage*$DQ61+DW61*DF61)))",
    "EI61": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM206,CC61)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61, $DB61), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK61),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV61, $AR$29), 0),\n\n  DW, $DR61,\n  CL, $DS61,\n  SM, $DT61,\n  SL, $DQ61,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM61, UltCritCard),\nCY61*(DE61*DO61*SL+UwDamage*DF61)))",
    "EJ61": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN206,CD61)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT61,\n  DamageMastery, $CS61,\n  DemonMastery, $CX61,\n  SPB, INDEX($BN$5:$BN206,CD61+1),\n  ITO, $CV61,\n  Shock, $CW61,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE61*DO61*$DQ61+DW61*DF61)))",
    "EK61": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO206,CE61)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT61,\n  DamageMastery, $CS61,\n  DemonMastery, $CX61,\n  SPB, $CU61,\n  ITO, INDEX($BO$5:$BO206,CE61+1),\n  Shock, $CW61,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE61*DO61*$DQ61+DW61*DF61)))",
    "EL61": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP206,CF61)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61, $DB61), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP61),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF61),\n  CL, $DS61,\n  SM, $DT61,\n  SLM, $DU61,\n  SL, $DQ61,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM61, UltCritCard),\nCY61*(DE61*DO61*SL+UwDamage*DF61)))",
    "EM61": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ206,CG61)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG61+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN61": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR206,CH61)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61, $DB61), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH61+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP61),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK61),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM206,CC61), SMHeat, $AR$29), 0),\n\n  DW, $DR61,\n  CL, $DS61,\n  SL, $DQ61,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM61, UltCritCard),\nCY61*(DE61*DO61*SL+UwDamage*DF61)))",
    "EO61": "IF(OR(CI61 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI61+1))",
    "EP61": "IF(OR($AO$25, CJ61 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ61+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE205,BU61),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL61, 1),\n  DPM, (1+$DI61*CardRangeMastery*$DJ61*$AQ$9),\n  SuperTower, $DL61,\n  Rend, $DN61,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61, $DB61), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR61,\n  SM, $DT61,\n  SLM, $DU61,\n  SL, $DQ61,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM61, UltCritCard),\n\nCY61*(DE61*OtherDamage*SL+UwDamage*DF61)))",
    "EQ61": "IF(OR(CK61 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK61+1)*1%, 1),\n  CF, $DB61,\n  CC, MIN(100%, $CZ61 + 1%),\n  CCUW, DA61 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ206,BZ61) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC61 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR61,\n  CL, $DS61,\n  SM, $DT61,\n  SLM, $DU61,\n  SL, $DQ61,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM61, UltCritCard),\n\nCY61 * (Critical*DO61*SL+UwDamage*UWCritical)))",
    "ER61": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL61 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH206,BX61),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL61+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI61*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM206,CC61), $DV61, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH61,\n  Rapid, DG61,\n  SuperTower, $DL61,\n  Rend, $DN61,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM61,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61, $DB61), 1),\n\n  DW, $DR61,\n  CL, $DS61,\n  SM, $DT61,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY61*(DE61*OtherDamage*SL+UWDamage*DF61)))",
    "ES61": "IF(OR(CM61 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH61,\n  Rapid, DG61,\n  RDPM, (1+$DI61*$DJ61*$AQ$9),\n  Rend, $DN61,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK206,CA61),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM61+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61, $DB61), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR61,\n  CL, $DS61,\n  SM, $DT61,\n  SLM, $DU61,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY61*(DE61*OtherDamage*SL+UwDamage*DF61)))",
    "ET61": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN61 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM61,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN61+1, $DB61), 1),\n\n  DW, $DR61,\n  CL, $DS61,\n  SM, $DT61,\n  SLM, $DU61,\n  SL, $DQ61,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY61*(DE61*DO61*SL+UWDamage*DF61)))",
    "EU61": "IF(OR(NOT($BA$3), NOT($BA$23), $CO61 > $BA$15), \"\", 1 + 0.5*(CO61+1))",
    "EW61": "IF(DZ61=\"\", \"\", LET(\n  Now, CT61,\n  Next, DZ61,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT61),\nFactor/Cost))",
    "EX61": "IF(EA61=\"\",\"\",(EA61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU61))",
    "EY61": "IF(EB61=\"\",\"\",(EB61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV61))",
    "EZ61": "IF(EC61=\"\",\"\",(EC61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW61))",
    "FA61": "IF(ED61=\"\",\"\",(ED61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX61))",
    "FB61": "IF(EE61=\"\",\"\",(EE61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY61))",
    "FC61": "IF(EF61=\"\",\"\",(EF61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ61))",
    "FD61": "IF(EG61=\"\",\"\",(EG61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA61))",
    "FE61": "IF(EH61=\"\",\"\",(EH61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB61))",
    "FF61": "IF(EI61=\"\",\"\",(EI61/$DX61-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC61+1, 1, CC61))))",
    "FG61": "IF(EJ61=\"\",\"\",(EJ61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD61))",
    "FH61": "IF(EK61=\"\",\"\",(EK61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE61))",
    "FI61": "IF(EL61=\"\",\"\",(EL61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF61))",
    "FJ61": "IF(EM61=\"\", \"\", LET(\n  Now, CW61,\n  Next, EM61,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG61),\nFactor/Cost))",
    "FK61": "IF(EN61=\"\",\"\",(EN61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH61))",
    "FL61": "IF(EO61=\"\", \"\", LET(\n  Now, CS61,\n  Next, EO61,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI61),\nFactor/Cost))",
    "FM61": "IF(EP61=\"\",\"\",(EP61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ61))",
    "FN61": "IF(EQ61=\"\",\"\",(EQ61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK61))",
    "FO61": "IF(ER61=\"\",\"\",(ER61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL61))",
    "FP61": "IF(ES61=\"\",\"\",(ES61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM61))",
    "FQ61": "IF(ET61=\"\",\"\",(ET61/$DX61-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN61))",
    "FR61": "IF(EU61=\"\", \"\", LET(\n  Now, CX61,\n  Next, EU61,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO61),\nFactor/Cost))",
    "FT61": "IF(COLUMN(EW61:FR61) = MIN(IF(EW61:FR61=MAX(EW61:FR61), COLUMN(EW61:FR61))), 1, \"\")",
    "D62": "IF(SUM(FT61:GP61),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F62)),\"Card Mastery\",F62),G62)/$D$5,\"\")",
    "F62": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT61:GP61),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT61:GP61=1)),)\"),\"Critical Factor\")",
    "G62": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT61:GP61),ARRAYFORMULA(FILTER(BT61:CP61 , FT61:GP61=1)),\"\"\"\")\"),16.0)",
    "I62": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT61:GP61),ARRAYFORMULA(FILTER(EW61:FS61 , FT61:GP61=1))*D$5,\"\"\"\")\"),0.035167967994514104)",
    "K62": "IF(H62<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D62)),)",
    "BC62": "BC61+1",
    "BD62": "BD61+BD$3",
    "BE62": "BE61+BE$3",
    "BF62": "BF61+BF$3",
    "BG62": "BG61+BG$3",
    "BH62": "BH61+BH$3",
    "BT62": "BT61+FT61",
    "BU62": "BU61+FU61",
    "BV62": "BV61+FV61",
    "BW62": "BW61+FW61",
    "BX62": "BX61+FX61",
    "BY62": "BY61+FY61",
    "BZ62": "BZ61+FZ61",
    "CA62": "CA61+GA61",
    "CB62": "CB61+GB61",
    "CC62": "CC61+GC61",
    "CD62": "CD61+GD61",
    "CE62": "CE61+GE61",
    "CF62": "CF61+GF61",
    "CG62": "CG61+GG61",
    "CH62": "CH61+GH61",
    "CI62": "CI61+GI61",
    "CJ62": "CJ61+GJ61",
    "CK62": "CK61+GK61",
    "CL62": "CL61+GL61",
    "CM62": "CM61+GM61",
    "CN62": "CN61+GN61",
    "CO62": "CO61+GO61",
    "CS62": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI62,1)",
    "CT62": "INDEX($BD$5:$BD207,BT62)",
    "CU62": "INDEX($BN$5:$BN207,CD62)",
    "CV62": "INDEX($BO$5:$BO207,CE62)",
    "CW62": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG62)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX62": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO62, 1)",
    "CY62": "LET(\n  Base, $CR$6,\n  Damage, $CT62,\n  DamageMastery, $CS62,\n  DemonMastery, $CX62,\n  SPB, $CU62,\n  ITO, $CV62,\n  Shock, $CW62,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ62": "MIN(100%, DA62)",
    "DA62": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK62*1%, 0)",
    "DB62": "LET(\n  Lab, 1+INDEX($BF$5:$BF207,BV62),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC62": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK62*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI207,BY62) + CardCritMastery)",
    "DD62": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK62*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ207,BZ62) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE62": "LET(\n  CF, $DB62,\n  CC, $CZ62,\n  SCM, $DD62,\n  SCC, $DC62,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF62": "LET(\n  CF, $DB62,\n  CC, $DA62,\n  SCM, $DD62,\n  SCC, $DC62,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG62": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH62)), 0)",
    "DH62": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ62*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE207,BU62),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI62": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG207, BW62), 1) + $AE$9)",
    "DJ62": "LET(\n  DpmLab, INDEX($BH$5:$BH207,BX62),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL62, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK62": "(1+$DI62*$DJ62*$AQ$9)",
    "DL62": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK207,CA62),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM62*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM62": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK207,CA62),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM62*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN62": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL207,CB62)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO62": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH62,\n  Rapid, DG62,\n  RDPM, DK62,\n  SuperTower, $DL62,\n  Rend, $DN62,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP62": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ62": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK62),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR62": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP62),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF62-1))",
    "DS62": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG62, DH62),0))",
    "DT62": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP62),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV62, $AR$29), 0))",
    "DU62": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK62),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM207,CC62), $DV62, $AR$29), 0))",
    "DV62": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH62), $AO$29)",
    "DW62": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM62,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62, $DB62), 1),\n\n  DW, $DR62,\n  CL, $DS62,\n  SM, $DT62,\n  SLM, $DU62,\n  SL, $DQ62,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX62": "CY62*(DE62*DO62*DQ62+DW62*DF62)",
    "DZ62": "IF(INDEX($BD$6:$BD207,BT62)=\"\", \"\", INDEX($BD$5:$BD207,BT62+1))",
    "EA62": "IF(OR($AO$25, INDEX($BE$6:$BE207,BU62)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ62)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE207,BU62+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI62*$DJ62*$AQ$9),\n  SuperTower, $DL62,\n  Rend, $DN62,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62, $DB62), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR62,\n  SM, $DT62,\n  SLM, $DU62,\n  SL, $DQ62,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM62, UltCritCard),\n\nCY62*(DE62*OtherDamage*SL+UwDamage*DF62)))",
    "EB62": "IF(INDEX($BF$6:$BF207,BV62)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF207,BV62+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ62,\n  CCUW, $DA62,\n  SCM, $DD62,\n  SCC, $DC62,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62, CF), 1),\n\n  DW, $DR62,\n  CL, $DS62,\n  SM, $DT62,\n  SLM, $DU62,\n  SL, $DQ62,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM62, UltCritCard),\n\nCY62 * (Critical * DO62 * SL + UwDamage * UWCritical)))",
    "EC62": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG207,BW62)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH62,\n  Rapid, DG62,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG207, BW62+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ62*$AQ$9),\n  SuperTower, $DL62,\n  Rend, $DN62,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM207,CC62), $DV62, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM62,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62, $DB62), 1),\n\n  DW, $DR62,\n  CL, $DS62,\n  SM, $DT62,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY62*(DE62*OtherDamage*SL+UWDamage*DF62)))",
    "ED62": "IF(OR($AO$25, INDEX($BH$6:$BH207,BX62)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH207,BX62+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL62, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI62*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM207,CC62), $DV62, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH62,\n  Rapid, DG62,\n  SuperTower, $DL62,\n  Rend, $DN62,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM62,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62, $DB62), 1),\n\n  DW, $DR62,\n  CL, $DS62,\n  SM, $DT62,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY62*(DE62*OtherDamage*SL+UWDamage*DF62)))",
    "EE62": "IF(INDEX($BI$6:$BI207,BY62)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK62, 0),\n  CF, $DB62,\n  CC, $CZ62,\n  CCUW, $DA62,\n  SCM, $DD62,\n  SCC, $AV$17+INDEX($BI$5:$BI207,BY62+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY62 * (Critical*DO62*$DQ62+DW62*UWCritical)))",
    "EF62": "IF(INDEX($BJ$6:$BJ207,BZ62)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK62*1%, 1),\n  CF, $DB62,\n  CC, $CZ62,\n  CCUW, $DA62,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ207,BZ62+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC62,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY62*(Critical*DO62*$DQ62+DW62*UWCritical)))",
    "EG62": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK207,CA62)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH62,\n  Rapid, DG62,\n  DPM, (1+$DI62*$DJ62*$AQ$9),\n  Rend, $DN62,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK207,CA62+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM62*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62, $DB62), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK207,CA62+1)-1))/(45-CM62*3),1),\n\n  SL, $DQ62,\n  DW, $DR62,\n  CL, $DS62,\n  SM, $DT62,\n  SLM, $DU62,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY62*(DE62*OtherDamage*SL+UwDamage*DF62)))",
    "EH62": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL207,CB62+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL207,CB62)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH62,\n  Rapid, DG62,\n  DPM, (1+$DI62*$DJ62*$AQ$9),\n  SuperTower, $DL62,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL207,CB62+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY62*(DE62*OtherDamage*$DQ62+DW62*DF62)))",
    "EI62": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM207,CC62)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62, $DB62), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK62),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV62, $AR$29), 0),\n\n  DW, $DR62,\n  CL, $DS62,\n  SM, $DT62,\n  SL, $DQ62,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM62, UltCritCard),\nCY62*(DE62*DO62*SL+UwDamage*DF62)))",
    "EJ62": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN207,CD62)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT62,\n  DamageMastery, $CS62,\n  DemonMastery, $CX62,\n  SPB, INDEX($BN$5:$BN207,CD62+1),\n  ITO, $CV62,\n  Shock, $CW62,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE62*DO62*$DQ62+DW62*DF62)))",
    "EK62": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO207,CE62)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT62,\n  DamageMastery, $CS62,\n  DemonMastery, $CX62,\n  SPB, $CU62,\n  ITO, INDEX($BO$5:$BO207,CE62+1),\n  Shock, $CW62,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE62*DO62*$DQ62+DW62*DF62)))",
    "EL62": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP207,CF62)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62, $DB62), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP62),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF62),\n  CL, $DS62,\n  SM, $DT62,\n  SLM, $DU62,\n  SL, $DQ62,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM62, UltCritCard),\nCY62*(DE62*DO62*SL+UwDamage*DF62)))",
    "EM62": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ207,CG62)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG62+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN62": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR207,CH62)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62, $DB62), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH62+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP62),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK62),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM207,CC62), SMHeat, $AR$29), 0),\n\n  DW, $DR62,\n  CL, $DS62,\n  SL, $DQ62,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM62, UltCritCard),\nCY62*(DE62*DO62*SL+UwDamage*DF62)))",
    "EO62": "IF(OR(CI62 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI62+1))",
    "EP62": "IF(OR($AO$25, CJ62 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ62+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE206,BU62),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL62, 1),\n  DPM, (1+$DI62*CardRangeMastery*$DJ62*$AQ$9),\n  SuperTower, $DL62,\n  Rend, $DN62,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62, $DB62), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR62,\n  SM, $DT62,\n  SLM, $DU62,\n  SL, $DQ62,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM62, UltCritCard),\n\nCY62*(DE62*OtherDamage*SL+UwDamage*DF62)))",
    "EQ62": "IF(OR(CK62 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK62+1)*1%, 1),\n  CF, $DB62,\n  CC, MIN(100%, $CZ62 + 1%),\n  CCUW, DA62 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ207,BZ62) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC62 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR62,\n  CL, $DS62,\n  SM, $DT62,\n  SLM, $DU62,\n  SL, $DQ62,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM62, UltCritCard),\n\nCY62 * (Critical*DO62*SL+UwDamage*UWCritical)))",
    "ER62": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL62 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH207,BX62),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL62+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI62*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM207,CC62), $DV62, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH62,\n  Rapid, DG62,\n  SuperTower, $DL62,\n  Rend, $DN62,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM62,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62, $DB62), 1),\n\n  DW, $DR62,\n  CL, $DS62,\n  SM, $DT62,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY62*(DE62*OtherDamage*SL+UWDamage*DF62)))",
    "ES62": "IF(OR(CM62 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH62,\n  Rapid, DG62,\n  RDPM, (1+$DI62*$DJ62*$AQ$9),\n  Rend, $DN62,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK207,CA62),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM62+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62, $DB62), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR62,\n  CL, $DS62,\n  SM, $DT62,\n  SLM, $DU62,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY62*(DE62*OtherDamage*SL+UwDamage*DF62)))",
    "ET62": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN62 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM62,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN62+1, $DB62), 1),\n\n  DW, $DR62,\n  CL, $DS62,\n  SM, $DT62,\n  SLM, $DU62,\n  SL, $DQ62,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY62*(DE62*DO62*SL+UWDamage*DF62)))",
    "EU62": "IF(OR(NOT($BA$3), NOT($BA$23), $CO62 > $BA$15), \"\", 1 + 0.5*(CO62+1))",
    "EW62": "IF(DZ62=\"\", \"\", LET(\n  Now, CT62,\n  Next, DZ62,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT62),\nFactor/Cost))",
    "EX62": "IF(EA62=\"\",\"\",(EA62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU62))",
    "EY62": "IF(EB62=\"\",\"\",(EB62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV62))",
    "EZ62": "IF(EC62=\"\",\"\",(EC62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW62))",
    "FA62": "IF(ED62=\"\",\"\",(ED62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX62))",
    "FB62": "IF(EE62=\"\",\"\",(EE62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY62))",
    "FC62": "IF(EF62=\"\",\"\",(EF62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ62))",
    "FD62": "IF(EG62=\"\",\"\",(EG62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA62))",
    "FE62": "IF(EH62=\"\",\"\",(EH62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB62))",
    "FF62": "IF(EI62=\"\",\"\",(EI62/$DX62-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC62+1, 1, CC62))))",
    "FG62": "IF(EJ62=\"\",\"\",(EJ62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD62))",
    "FH62": "IF(EK62=\"\",\"\",(EK62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE62))",
    "FI62": "IF(EL62=\"\",\"\",(EL62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF62))",
    "FJ62": "IF(EM62=\"\", \"\", LET(\n  Now, CW62,\n  Next, EM62,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG62),\nFactor/Cost))",
    "FK62": "IF(EN62=\"\",\"\",(EN62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH62))",
    "FL62": "IF(EO62=\"\", \"\", LET(\n  Now, CS62,\n  Next, EO62,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI62),\nFactor/Cost))",
    "FM62": "IF(EP62=\"\",\"\",(EP62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ62))",
    "FN62": "IF(EQ62=\"\",\"\",(EQ62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK62))",
    "FO62": "IF(ER62=\"\",\"\",(ER62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL62))",
    "FP62": "IF(ES62=\"\",\"\",(ES62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM62))",
    "FQ62": "IF(ET62=\"\",\"\",(ET62/$DX62-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN62))",
    "FR62": "IF(EU62=\"\", \"\", LET(\n  Now, CX62,\n  Next, EU62,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO62),\nFactor/Cost))",
    "FT62": "IF(COLUMN(EW62:FR62) = MIN(IF(EW62:FR62=MAX(EW62:FR62), COLUMN(EW62:FR62))), 1, \"\")",
    "D63": "IF(SUM(FT62:GP62),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F63)),\"Card Mastery\",F63),G63)/$D$5,\"\")",
    "F63": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT62:GP62),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT62:GP62=1)),)\"),\"Damage\")",
    "G63": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT62:GP62),ARRAYFORMULA(FILTER(BT62:CP62 , FT62:GP62=1)),\"\"\"\")\"),15.0)",
    "I63": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT62:GP62),ARRAYFORMULA(FILTER(EW62:FS62 , FT62:GP62=1))*D$5,\"\"\"\")\"),0.03094910591471802)",
    "K63": "IF(H63<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D63)),)",
    "BC63": "BC62+1",
    "BD63": "BD62+BD$3",
    "BE63": "BE62+BE$3",
    "BF63": "BF62+BF$3",
    "BG63": "BG62+BG$3",
    "BH63": "BH62+BH$3",
    "BT63": "BT62+FT62",
    "BU63": "BU62+FU62",
    "BV63": "BV62+FV62",
    "BW63": "BW62+FW62",
    "BX63": "BX62+FX62",
    "BY63": "BY62+FY62",
    "BZ63": "BZ62+FZ62",
    "CA63": "CA62+GA62",
    "CB63": "CB62+GB62",
    "CC63": "CC62+GC62",
    "CD63": "CD62+GD62",
    "CE63": "CE62+GE62",
    "CF63": "CF62+GF62",
    "CG63": "CG62+GG62",
    "CH63": "CH62+GH62",
    "CI63": "CI62+GI62",
    "CJ63": "CJ62+GJ62",
    "CK63": "CK62+GK62",
    "CL63": "CL62+GL62",
    "CM63": "CM62+GM62",
    "CN63": "CN62+GN62",
    "CO63": "CO62+GO62",
    "CS63": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI63,1)",
    "CT63": "INDEX($BD$5:$BD208,BT63)",
    "CU63": "INDEX($BN$5:$BN208,CD63)",
    "CV63": "INDEX($BO$5:$BO208,CE63)",
    "CW63": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG63)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX63": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO63, 1)",
    "CY63": "LET(\n  Base, $CR$6,\n  Damage, $CT63,\n  DamageMastery, $CS63,\n  DemonMastery, $CX63,\n  SPB, $CU63,\n  ITO, $CV63,\n  Shock, $CW63,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ63": "MIN(100%, DA63)",
    "DA63": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK63*1%, 0)",
    "DB63": "LET(\n  Lab, 1+INDEX($BF$5:$BF208,BV63),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC63": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK63*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI208,BY63) + CardCritMastery)",
    "DD63": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK63*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ208,BZ63) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE63": "LET(\n  CF, $DB63,\n  CC, $CZ63,\n  SCM, $DD63,\n  SCC, $DC63,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF63": "LET(\n  CF, $DB63,\n  CC, $DA63,\n  SCM, $DD63,\n  SCC, $DC63,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG63": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH63)), 0)",
    "DH63": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ63*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE208,BU63),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI63": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG208, BW63), 1) + $AE$9)",
    "DJ63": "LET(\n  DpmLab, INDEX($BH$5:$BH208,BX63),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL63, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK63": "(1+$DI63*$DJ63*$AQ$9)",
    "DL63": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK208,CA63),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM63*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM63": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK208,CA63),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM63*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN63": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL208,CB63)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO63": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH63,\n  Rapid, DG63,\n  RDPM, DK63,\n  SuperTower, $DL63,\n  Rend, $DN63,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP63": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ63": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK63),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR63": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP63),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF63-1))",
    "DS63": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG63, DH63),0))",
    "DT63": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP63),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV63, $AR$29), 0))",
    "DU63": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK63),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM208,CC63), $DV63, $AR$29), 0))",
    "DV63": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH63), $AO$29)",
    "DW63": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM63,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63, $DB63), 1),\n\n  DW, $DR63,\n  CL, $DS63,\n  SM, $DT63,\n  SLM, $DU63,\n  SL, $DQ63,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX63": "CY63*(DE63*DO63*DQ63+DW63*DF63)",
    "DZ63": "IF(INDEX($BD$6:$BD208,BT63)=\"\", \"\", INDEX($BD$5:$BD208,BT63+1))",
    "EA63": "IF(OR($AO$25, INDEX($BE$6:$BE208,BU63)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ63)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE208,BU63+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI63*$DJ63*$AQ$9),\n  SuperTower, $DL63,\n  Rend, $DN63,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63, $DB63), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR63,\n  SM, $DT63,\n  SLM, $DU63,\n  SL, $DQ63,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM63, UltCritCard),\n\nCY63*(DE63*OtherDamage*SL+UwDamage*DF63)))",
    "EB63": "IF(INDEX($BF$6:$BF208,BV63)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF208,BV63+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ63,\n  CCUW, $DA63,\n  SCM, $DD63,\n  SCC, $DC63,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63, CF), 1),\n\n  DW, $DR63,\n  CL, $DS63,\n  SM, $DT63,\n  SLM, $DU63,\n  SL, $DQ63,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM63, UltCritCard),\n\nCY63 * (Critical * DO63 * SL + UwDamage * UWCritical)))",
    "EC63": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG208,BW63)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH63,\n  Rapid, DG63,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG208, BW63+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ63*$AQ$9),\n  SuperTower, $DL63,\n  Rend, $DN63,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM208,CC63), $DV63, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM63,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63, $DB63), 1),\n\n  DW, $DR63,\n  CL, $DS63,\n  SM, $DT63,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY63*(DE63*OtherDamage*SL+UWDamage*DF63)))",
    "ED63": "IF(OR($AO$25, INDEX($BH$6:$BH208,BX63)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH208,BX63+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL63, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI63*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM208,CC63), $DV63, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH63,\n  Rapid, DG63,\n  SuperTower, $DL63,\n  Rend, $DN63,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM63,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63, $DB63), 1),\n\n  DW, $DR63,\n  CL, $DS63,\n  SM, $DT63,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY63*(DE63*OtherDamage*SL+UWDamage*DF63)))",
    "EE63": "IF(INDEX($BI$6:$BI208,BY63)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK63, 0),\n  CF, $DB63,\n  CC, $CZ63,\n  CCUW, $DA63,\n  SCM, $DD63,\n  SCC, $AV$17+INDEX($BI$5:$BI208,BY63+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY63 * (Critical*DO63*$DQ63+DW63*UWCritical)))",
    "EF63": "IF(INDEX($BJ$6:$BJ208,BZ63)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK63*1%, 1),\n  CF, $DB63,\n  CC, $CZ63,\n  CCUW, $DA63,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ208,BZ63+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC63,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY63*(Critical*DO63*$DQ63+DW63*UWCritical)))",
    "EG63": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK208,CA63)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH63,\n  Rapid, DG63,\n  DPM, (1+$DI63*$DJ63*$AQ$9),\n  Rend, $DN63,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK208,CA63+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM63*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63, $DB63), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK208,CA63+1)-1))/(45-CM63*3),1),\n\n  SL, $DQ63,\n  DW, $DR63,\n  CL, $DS63,\n  SM, $DT63,\n  SLM, $DU63,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY63*(DE63*OtherDamage*SL+UwDamage*DF63)))",
    "EH63": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL208,CB63+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL208,CB63)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH63,\n  Rapid, DG63,\n  DPM, (1+$DI63*$DJ63*$AQ$9),\n  SuperTower, $DL63,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL208,CB63+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY63*(DE63*OtherDamage*$DQ63+DW63*DF63)))",
    "EI63": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM208,CC63)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63, $DB63), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK63),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV63, $AR$29), 0),\n\n  DW, $DR63,\n  CL, $DS63,\n  SM, $DT63,\n  SL, $DQ63,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM63, UltCritCard),\nCY63*(DE63*DO63*SL+UwDamage*DF63)))",
    "EJ63": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN208,CD63)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT63,\n  DamageMastery, $CS63,\n  DemonMastery, $CX63,\n  SPB, INDEX($BN$5:$BN208,CD63+1),\n  ITO, $CV63,\n  Shock, $CW63,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE63*DO63*$DQ63+DW63*DF63)))",
    "EK63": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO208,CE63)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT63,\n  DamageMastery, $CS63,\n  DemonMastery, $CX63,\n  SPB, $CU63,\n  ITO, INDEX($BO$5:$BO208,CE63+1),\n  Shock, $CW63,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE63*DO63*$DQ63+DW63*DF63)))",
    "EL63": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP208,CF63)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63, $DB63), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP63),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF63),\n  CL, $DS63,\n  SM, $DT63,\n  SLM, $DU63,\n  SL, $DQ63,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM63, UltCritCard),\nCY63*(DE63*DO63*SL+UwDamage*DF63)))",
    "EM63": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ208,CG63)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG63+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN63": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR208,CH63)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63, $DB63), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH63+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP63),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK63),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM208,CC63), SMHeat, $AR$29), 0),\n\n  DW, $DR63,\n  CL, $DS63,\n  SL, $DQ63,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM63, UltCritCard),\nCY63*(DE63*DO63*SL+UwDamage*DF63)))",
    "EO63": "IF(OR(CI63 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI63+1))",
    "EP63": "IF(OR($AO$25, CJ63 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ63+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE207,BU63),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL63, 1),\n  DPM, (1+$DI63*CardRangeMastery*$DJ63*$AQ$9),\n  SuperTower, $DL63,\n  Rend, $DN63,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63, $DB63), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR63,\n  SM, $DT63,\n  SLM, $DU63,\n  SL, $DQ63,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM63, UltCritCard),\n\nCY63*(DE63*OtherDamage*SL+UwDamage*DF63)))",
    "EQ63": "IF(OR(CK63 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK63+1)*1%, 1),\n  CF, $DB63,\n  CC, MIN(100%, $CZ63 + 1%),\n  CCUW, DA63 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ208,BZ63) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC63 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR63,\n  CL, $DS63,\n  SM, $DT63,\n  SLM, $DU63,\n  SL, $DQ63,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM63, UltCritCard),\n\nCY63 * (Critical*DO63*SL+UwDamage*UWCritical)))",
    "ER63": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL63 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH208,BX63),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL63+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI63*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM208,CC63), $DV63, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH63,\n  Rapid, DG63,\n  SuperTower, $DL63,\n  Rend, $DN63,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM63,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63, $DB63), 1),\n\n  DW, $DR63,\n  CL, $DS63,\n  SM, $DT63,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY63*(DE63*OtherDamage*SL+UWDamage*DF63)))",
    "ES63": "IF(OR(CM63 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH63,\n  Rapid, DG63,\n  RDPM, (1+$DI63*$DJ63*$AQ$9),\n  Rend, $DN63,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK208,CA63),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM63+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63, $DB63), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR63,\n  CL, $DS63,\n  SM, $DT63,\n  SLM, $DU63,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY63*(DE63*OtherDamage*SL+UwDamage*DF63)))",
    "ET63": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN63 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM63,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN63+1, $DB63), 1),\n\n  DW, $DR63,\n  CL, $DS63,\n  SM, $DT63,\n  SLM, $DU63,\n  SL, $DQ63,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY63*(DE63*DO63*SL+UWDamage*DF63)))",
    "EU63": "IF(OR(NOT($BA$3), NOT($BA$23), $CO63 > $BA$15), \"\", 1 + 0.5*(CO63+1))",
    "EW63": "IF(DZ63=\"\", \"\", LET(\n  Now, CT63,\n  Next, DZ63,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT63),\nFactor/Cost))",
    "EX63": "IF(EA63=\"\",\"\",(EA63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU63))",
    "EY63": "IF(EB63=\"\",\"\",(EB63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV63))",
    "EZ63": "IF(EC63=\"\",\"\",(EC63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW63))",
    "FA63": "IF(ED63=\"\",\"\",(ED63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX63))",
    "FB63": "IF(EE63=\"\",\"\",(EE63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY63))",
    "FC63": "IF(EF63=\"\",\"\",(EF63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ63))",
    "FD63": "IF(EG63=\"\",\"\",(EG63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA63))",
    "FE63": "IF(EH63=\"\",\"\",(EH63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB63))",
    "FF63": "IF(EI63=\"\",\"\",(EI63/$DX63-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC63+1, 1, CC63))))",
    "FG63": "IF(EJ63=\"\",\"\",(EJ63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD63))",
    "FH63": "IF(EK63=\"\",\"\",(EK63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE63))",
    "FI63": "IF(EL63=\"\",\"\",(EL63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF63))",
    "FJ63": "IF(EM63=\"\", \"\", LET(\n  Now, CW63,\n  Next, EM63,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG63),\nFactor/Cost))",
    "FK63": "IF(EN63=\"\",\"\",(EN63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH63))",
    "FL63": "IF(EO63=\"\", \"\", LET(\n  Now, CS63,\n  Next, EO63,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI63),\nFactor/Cost))",
    "FM63": "IF(EP63=\"\",\"\",(EP63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ63))",
    "FN63": "IF(EQ63=\"\",\"\",(EQ63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK63))",
    "FO63": "IF(ER63=\"\",\"\",(ER63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL63))",
    "FP63": "IF(ES63=\"\",\"\",(ES63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM63))",
    "FQ63": "IF(ET63=\"\",\"\",(ET63/$DX63-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN63))",
    "FR63": "IF(EU63=\"\", \"\", LET(\n  Now, CX63,\n  Next, EU63,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO63),\nFactor/Cost))",
    "FT63": "IF(COLUMN(EW63:FR63) = MIN(IF(EW63:FR63=MAX(EW63:FR63), COLUMN(EW63:FR63))), 1, \"\")",
    "D64": "IF(SUM(FT63:GP63),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F64)),\"Card Mastery\",F64),G64)/$D$5,\"\")",
    "F64": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT63:GP63),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT63:GP63=1)),)\"),\"Attack Speed\")",
    "G64": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT63:GP63),ARRAYFORMULA(FILTER(BT63:CP63 , FT63:GP63=1)),\"\"\"\")\"),15.0)",
    "I64": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT63:GP63),ARRAYFORMULA(FILTER(EW63:FS63 , FT63:GP63=1))*D$5,\"\"\"\")\"),0.030838858502878725)",
    "K64": "IF(H64<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D64)),)",
    "BC64": "BC63+1",
    "BD64": "BD63+BD$3",
    "BE64": "BE63+BE$3",
    "BF64": "BF63+BF$3",
    "BG64": "BG63+BG$3",
    "BH64": "BH63+BH$3",
    "BT64": "BT63+FT63",
    "BU64": "BU63+FU63",
    "BV64": "BV63+FV63",
    "BW64": "BW63+FW63",
    "BX64": "BX63+FX63",
    "BY64": "BY63+FY63",
    "BZ64": "BZ63+FZ63",
    "CA64": "CA63+GA63",
    "CB64": "CB63+GB63",
    "CC64": "CC63+GC63",
    "CD64": "CD63+GD63",
    "CE64": "CE63+GE63",
    "CF64": "CF63+GF63",
    "CG64": "CG63+GG63",
    "CH64": "CH63+GH63",
    "CI64": "CI63+GI63",
    "CJ64": "CJ63+GJ63",
    "CK64": "CK63+GK63",
    "CL64": "CL63+GL63",
    "CM64": "CM63+GM63",
    "CN64": "CN63+GN63",
    "CO64": "CO63+GO63",
    "CS64": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI64,1)",
    "CT64": "INDEX($BD$5:$BD209,BT64)",
    "CU64": "INDEX($BN$5:$BN209,CD64)",
    "CV64": "INDEX($BO$5:$BO209,CE64)",
    "CW64": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG64)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX64": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO64, 1)",
    "CY64": "LET(\n  Base, $CR$6,\n  Damage, $CT64,\n  DamageMastery, $CS64,\n  DemonMastery, $CX64,\n  SPB, $CU64,\n  ITO, $CV64,\n  Shock, $CW64,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ64": "MIN(100%, DA64)",
    "DA64": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK64*1%, 0)",
    "DB64": "LET(\n  Lab, 1+INDEX($BF$5:$BF209,BV64),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC64": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK64*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI209,BY64) + CardCritMastery)",
    "DD64": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK64*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ209,BZ64) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE64": "LET(\n  CF, $DB64,\n  CC, $CZ64,\n  SCM, $DD64,\n  SCC, $DC64,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF64": "LET(\n  CF, $DB64,\n  CC, $DA64,\n  SCM, $DD64,\n  SCC, $DC64,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG64": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH64)), 0)",
    "DH64": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ64*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE209,BU64),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI64": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG209, BW64), 1) + $AE$9)",
    "DJ64": "LET(\n  DpmLab, INDEX($BH$5:$BH209,BX64),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL64, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK64": "(1+$DI64*$DJ64*$AQ$9)",
    "DL64": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK209,CA64),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM64*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM64": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK209,CA64),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM64*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN64": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL209,CB64)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO64": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH64,\n  Rapid, DG64,\n  RDPM, DK64,\n  SuperTower, $DL64,\n  Rend, $DN64,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP64": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ64": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK64),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR64": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP64),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF64-1))",
    "DS64": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG64, DH64),0))",
    "DT64": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP64),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV64, $AR$29), 0))",
    "DU64": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK64),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM209,CC64), $DV64, $AR$29), 0))",
    "DV64": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH64), $AO$29)",
    "DW64": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM64,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64, $DB64), 1),\n\n  DW, $DR64,\n  CL, $DS64,\n  SM, $DT64,\n  SLM, $DU64,\n  SL, $DQ64,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX64": "CY64*(DE64*DO64*DQ64+DW64*DF64)",
    "DZ64": "IF(INDEX($BD$6:$BD209,BT64)=\"\", \"\", INDEX($BD$5:$BD209,BT64+1))",
    "EA64": "IF(OR($AO$25, INDEX($BE$6:$BE209,BU64)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ64)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE209,BU64+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI64*$DJ64*$AQ$9),\n  SuperTower, $DL64,\n  Rend, $DN64,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64, $DB64), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR64,\n  SM, $DT64,\n  SLM, $DU64,\n  SL, $DQ64,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM64, UltCritCard),\n\nCY64*(DE64*OtherDamage*SL+UwDamage*DF64)))",
    "EB64": "IF(INDEX($BF$6:$BF209,BV64)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF209,BV64+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ64,\n  CCUW, $DA64,\n  SCM, $DD64,\n  SCC, $DC64,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64, CF), 1),\n\n  DW, $DR64,\n  CL, $DS64,\n  SM, $DT64,\n  SLM, $DU64,\n  SL, $DQ64,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM64, UltCritCard),\n\nCY64 * (Critical * DO64 * SL + UwDamage * UWCritical)))",
    "EC64": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG209,BW64)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH64,\n  Rapid, DG64,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG209, BW64+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ64*$AQ$9),\n  SuperTower, $DL64,\n  Rend, $DN64,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM209,CC64), $DV64, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM64,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64, $DB64), 1),\n\n  DW, $DR64,\n  CL, $DS64,\n  SM, $DT64,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY64*(DE64*OtherDamage*SL+UWDamage*DF64)))",
    "ED64": "IF(OR($AO$25, INDEX($BH$6:$BH209,BX64)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH209,BX64+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL64, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI64*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM209,CC64), $DV64, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH64,\n  Rapid, DG64,\n  SuperTower, $DL64,\n  Rend, $DN64,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM64,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64, $DB64), 1),\n\n  DW, $DR64,\n  CL, $DS64,\n  SM, $DT64,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY64*(DE64*OtherDamage*SL+UWDamage*DF64)))",
    "EE64": "IF(INDEX($BI$6:$BI209,BY64)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK64, 0),\n  CF, $DB64,\n  CC, $CZ64,\n  CCUW, $DA64,\n  SCM, $DD64,\n  SCC, $AV$17+INDEX($BI$5:$BI209,BY64+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY64 * (Critical*DO64*$DQ64+DW64*UWCritical)))",
    "EF64": "IF(INDEX($BJ$6:$BJ209,BZ64)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK64*1%, 1),\n  CF, $DB64,\n  CC, $CZ64,\n  CCUW, $DA64,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ209,BZ64+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC64,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY64*(Critical*DO64*$DQ64+DW64*UWCritical)))",
    "EG64": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK209,CA64)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH64,\n  Rapid, DG64,\n  DPM, (1+$DI64*$DJ64*$AQ$9),\n  Rend, $DN64,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK209,CA64+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM64*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64, $DB64), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK209,CA64+1)-1))/(45-CM64*3),1),\n\n  SL, $DQ64,\n  DW, $DR64,\n  CL, $DS64,\n  SM, $DT64,\n  SLM, $DU64,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY64*(DE64*OtherDamage*SL+UwDamage*DF64)))",
    "EH64": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL209,CB64+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL209,CB64)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH64,\n  Rapid, DG64,\n  DPM, (1+$DI64*$DJ64*$AQ$9),\n  SuperTower, $DL64,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL209,CB64+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY64*(DE64*OtherDamage*$DQ64+DW64*DF64)))",
    "EI64": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM209,CC64)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64, $DB64), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK64),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV64, $AR$29), 0),\n\n  DW, $DR64,\n  CL, $DS64,\n  SM, $DT64,\n  SL, $DQ64,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM64, UltCritCard),\nCY64*(DE64*DO64*SL+UwDamage*DF64)))",
    "EJ64": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN209,CD64)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT64,\n  DamageMastery, $CS64,\n  DemonMastery, $CX64,\n  SPB, INDEX($BN$5:$BN209,CD64+1),\n  ITO, $CV64,\n  Shock, $CW64,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE64*DO64*$DQ64+DW64*DF64)))",
    "EK64": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO209,CE64)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT64,\n  DamageMastery, $CS64,\n  DemonMastery, $CX64,\n  SPB, $CU64,\n  ITO, INDEX($BO$5:$BO209,CE64+1),\n  Shock, $CW64,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE64*DO64*$DQ64+DW64*DF64)))",
    "EL64": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP209,CF64)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64, $DB64), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP64),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF64),\n  CL, $DS64,\n  SM, $DT64,\n  SLM, $DU64,\n  SL, $DQ64,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM64, UltCritCard),\nCY64*(DE64*DO64*SL+UwDamage*DF64)))",
    "EM64": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ209,CG64)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG64+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN64": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR209,CH64)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64, $DB64), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH64+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP64),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK64),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM209,CC64), SMHeat, $AR$29), 0),\n\n  DW, $DR64,\n  CL, $DS64,\n  SL, $DQ64,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM64, UltCritCard),\nCY64*(DE64*DO64*SL+UwDamage*DF64)))",
    "EO64": "IF(OR(CI64 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI64+1))",
    "EP64": "IF(OR($AO$25, CJ64 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ64+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE208,BU64),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL64, 1),\n  DPM, (1+$DI64*CardRangeMastery*$DJ64*$AQ$9),\n  SuperTower, $DL64,\n  Rend, $DN64,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64, $DB64), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR64,\n  SM, $DT64,\n  SLM, $DU64,\n  SL, $DQ64,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM64, UltCritCard),\n\nCY64*(DE64*OtherDamage*SL+UwDamage*DF64)))",
    "EQ64": "IF(OR(CK64 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK64+1)*1%, 1),\n  CF, $DB64,\n  CC, MIN(100%, $CZ64 + 1%),\n  CCUW, DA64 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ209,BZ64) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC64 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR64,\n  CL, $DS64,\n  SM, $DT64,\n  SLM, $DU64,\n  SL, $DQ64,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM64, UltCritCard),\n\nCY64 * (Critical*DO64*SL+UwDamage*UWCritical)))",
    "ER64": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL64 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH209,BX64),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL64+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI64*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM209,CC64), $DV64, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH64,\n  Rapid, DG64,\n  SuperTower, $DL64,\n  Rend, $DN64,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM64,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64, $DB64), 1),\n\n  DW, $DR64,\n  CL, $DS64,\n  SM, $DT64,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY64*(DE64*OtherDamage*SL+UWDamage*DF64)))",
    "ES64": "IF(OR(CM64 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH64,\n  Rapid, DG64,\n  RDPM, (1+$DI64*$DJ64*$AQ$9),\n  Rend, $DN64,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK209,CA64),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM64+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64, $DB64), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR64,\n  CL, $DS64,\n  SM, $DT64,\n  SLM, $DU64,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY64*(DE64*OtherDamage*SL+UwDamage*DF64)))",
    "ET64": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN64 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM64,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN64+1, $DB64), 1),\n\n  DW, $DR64,\n  CL, $DS64,\n  SM, $DT64,\n  SLM, $DU64,\n  SL, $DQ64,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY64*(DE64*DO64*SL+UWDamage*DF64)))",
    "EU64": "IF(OR(NOT($BA$3), NOT($BA$23), $CO64 > $BA$15), \"\", 1 + 0.5*(CO64+1))",
    "EW64": "IF(DZ64=\"\", \"\", LET(\n  Now, CT64,\n  Next, DZ64,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT64),\nFactor/Cost))",
    "EX64": "IF(EA64=\"\",\"\",(EA64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU64))",
    "EY64": "IF(EB64=\"\",\"\",(EB64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV64))",
    "EZ64": "IF(EC64=\"\",\"\",(EC64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW64))",
    "FA64": "IF(ED64=\"\",\"\",(ED64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX64))",
    "FB64": "IF(EE64=\"\",\"\",(EE64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY64))",
    "FC64": "IF(EF64=\"\",\"\",(EF64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ64))",
    "FD64": "IF(EG64=\"\",\"\",(EG64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA64))",
    "FE64": "IF(EH64=\"\",\"\",(EH64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB64))",
    "FF64": "IF(EI64=\"\",\"\",(EI64/$DX64-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC64+1, 1, CC64))))",
    "FG64": "IF(EJ64=\"\",\"\",(EJ64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD64))",
    "FH64": "IF(EK64=\"\",\"\",(EK64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE64))",
    "FI64": "IF(EL64=\"\",\"\",(EL64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF64))",
    "FJ64": "IF(EM64=\"\", \"\", LET(\n  Now, CW64,\n  Next, EM64,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG64),\nFactor/Cost))",
    "FK64": "IF(EN64=\"\",\"\",(EN64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH64))",
    "FL64": "IF(EO64=\"\", \"\", LET(\n  Now, CS64,\n  Next, EO64,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI64),\nFactor/Cost))",
    "FM64": "IF(EP64=\"\",\"\",(EP64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ64))",
    "FN64": "IF(EQ64=\"\",\"\",(EQ64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK64))",
    "FO64": "IF(ER64=\"\",\"\",(ER64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL64))",
    "FP64": "IF(ES64=\"\",\"\",(ES64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM64))",
    "FQ64": "IF(ET64=\"\",\"\",(ET64/$DX64-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN64))",
    "FR64": "IF(EU64=\"\", \"\", LET(\n  Now, CX64,\n  Next, EU64,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO64),\nFactor/Cost))",
    "FT64": "IF(COLUMN(EW64:FR64) = MIN(IF(EW64:FR64=MAX(EW64:FR64), COLUMN(EW64:FR64))), 1, \"\")",
    "D65": "IF(SUM(FT64:GP64),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F65)),\"Card Mastery\",F65),G65)/$D$5,\"\")",
    "F65": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT64:GP64),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT64:GP64=1)),)\"),\"Damage / Meter\")",
    "G65": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT64:GP64),ARRAYFORMULA(FILTER(BT64:CP64 , FT64:GP64=1)),\"\"\"\")\"),11.0)",
    "I65": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT64:GP64),ARRAYFORMULA(FILTER(EW64:FS64 , FT64:GP64=1))*D$5,\"\"\"\")\"),0.030097507929609635)",
    "K65": "IF(D56,FORMAT_TIME_YEAR(SUM($D$6:$D65)),)",
    "BC65": "BC64+1",
    "BD65": "BD64+BD$3",
    "BE65": "BE64+BE$3",
    "BF65": "BF64+BF$3",
    "BG65": "BG64+BG$3",
    "BH65": "BH64+BH$3",
    "BT65": "BT64+FT64",
    "BU65": "BU64+FU64",
    "BV65": "BV64+FV64",
    "BW65": "BW64+FW64",
    "BX65": "BX64+FX64",
    "BY65": "BY64+FY64",
    "BZ65": "BZ64+FZ64",
    "CA65": "CA64+GA64",
    "CB65": "CB64+GB64",
    "CC65": "CC64+GC64",
    "CD65": "CD64+GD64",
    "CE65": "CE64+GE64",
    "CF65": "CF64+GF64",
    "CG65": "CG64+GG64",
    "CH65": "CH64+GH64",
    "CI65": "CI64+GI64",
    "CJ65": "CJ64+GJ64",
    "CK65": "CK64+GK64",
    "CL65": "CL64+GL64",
    "CM65": "CM64+GM64",
    "CN65": "CN64+GN64",
    "CO65": "CO64+GO64",
    "CS65": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI65,1)",
    "CT65": "INDEX($BD$5:$BD210,BT65)",
    "CU65": "INDEX($BN$5:$BN210,CD65)",
    "CV65": "INDEX($BO$5:$BO210,CE65)",
    "CW65": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG65)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX65": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO65, 1)",
    "CY65": "LET(\n  Base, $CR$6,\n  Damage, $CT65,\n  DamageMastery, $CS65,\n  DemonMastery, $CX65,\n  SPB, $CU65,\n  ITO, $CV65,\n  Shock, $CW65,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ65": "MIN(100%, DA65)",
    "DA65": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK65*1%, 0)",
    "DB65": "LET(\n  Lab, 1+INDEX($BF$5:$BF210,BV65),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC65": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK65*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI210,BY65) + CardCritMastery)",
    "DD65": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK65*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ210,BZ65) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE65": "LET(\n  CF, $DB65,\n  CC, $CZ65,\n  SCM, $DD65,\n  SCC, $DC65,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF65": "LET(\n  CF, $DB65,\n  CC, $DA65,\n  SCM, $DD65,\n  SCC, $DC65,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG65": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH65)), 0)",
    "DH65": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ65*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE210,BU65),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI65": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG210, BW65), 1) + $AE$9)",
    "DJ65": "LET(\n  DpmLab, INDEX($BH$5:$BH210,BX65),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL65, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK65": "(1+$DI65*$DJ65*$AQ$9)",
    "DL65": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK210,CA65),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM65*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM65": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK210,CA65),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM65*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN65": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL210,CB65)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO65": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH65,\n  Rapid, DG65,\n  RDPM, DK65,\n  SuperTower, $DL65,\n  Rend, $DN65,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP65": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ65": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK65),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR65": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP65),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF65-1))",
    "DS65": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG65, DH65),0))",
    "DT65": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP65),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV65, $AR$29), 0))",
    "DU65": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK65),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM210,CC65), $DV65, $AR$29), 0))",
    "DV65": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH65), $AO$29)",
    "DW65": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM65,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65, $DB65), 1),\n\n  DW, $DR65,\n  CL, $DS65,\n  SM, $DT65,\n  SLM, $DU65,\n  SL, $DQ65,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX65": "CY65*(DE65*DO65*DQ65+DW65*DF65)",
    "DZ65": "IF(INDEX($BD$6:$BD210,BT65)=\"\", \"\", INDEX($BD$5:$BD210,BT65+1))",
    "EA65": "IF(OR($AO$25, INDEX($BE$6:$BE210,BU65)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ65)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE210,BU65+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI65*$DJ65*$AQ$9),\n  SuperTower, $DL65,\n  Rend, $DN65,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65, $DB65), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR65,\n  SM, $DT65,\n  SLM, $DU65,\n  SL, $DQ65,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM65, UltCritCard),\n\nCY65*(DE65*OtherDamage*SL+UwDamage*DF65)))",
    "EB65": "IF(INDEX($BF$6:$BF210,BV65)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF210,BV65+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ65,\n  CCUW, $DA65,\n  SCM, $DD65,\n  SCC, $DC65,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65, CF), 1),\n\n  DW, $DR65,\n  CL, $DS65,\n  SM, $DT65,\n  SLM, $DU65,\n  SL, $DQ65,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM65, UltCritCard),\n\nCY65 * (Critical * DO65 * SL + UwDamage * UWCritical)))",
    "EC65": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG210,BW65)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH65,\n  Rapid, DG65,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG210, BW65+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ65*$AQ$9),\n  SuperTower, $DL65,\n  Rend, $DN65,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM210,CC65), $DV65, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM65,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65, $DB65), 1),\n\n  DW, $DR65,\n  CL, $DS65,\n  SM, $DT65,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY65*(DE65*OtherDamage*SL+UWDamage*DF65)))",
    "ED65": "IF(OR($AO$25, INDEX($BH$6:$BH210,BX65)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH210,BX65+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL65, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI65*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM210,CC65), $DV65, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH65,\n  Rapid, DG65,\n  SuperTower, $DL65,\n  Rend, $DN65,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM65,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65, $DB65), 1),\n\n  DW, $DR65,\n  CL, $DS65,\n  SM, $DT65,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY65*(DE65*OtherDamage*SL+UWDamage*DF65)))",
    "EE65": "IF(INDEX($BI$6:$BI210,BY65)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK65, 0),\n  CF, $DB65,\n  CC, $CZ65,\n  CCUW, $DA65,\n  SCM, $DD65,\n  SCC, $AV$17+INDEX($BI$5:$BI210,BY65+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY65 * (Critical*DO65*$DQ65+DW65*UWCritical)))",
    "EF65": "IF(INDEX($BJ$6:$BJ210,BZ65)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK65*1%, 1),\n  CF, $DB65,\n  CC, $CZ65,\n  CCUW, $DA65,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ210,BZ65+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC65,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY65*(Critical*DO65*$DQ65+DW65*UWCritical)))",
    "EG65": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK210,CA65)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH65,\n  Rapid, DG65,\n  DPM, (1+$DI65*$DJ65*$AQ$9),\n  Rend, $DN65,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK210,CA65+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM65*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65, $DB65), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK210,CA65+1)-1))/(45-CM65*3),1),\n\n  SL, $DQ65,\n  DW, $DR65,\n  CL, $DS65,\n  SM, $DT65,\n  SLM, $DU65,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY65*(DE65*OtherDamage*SL+UwDamage*DF65)))",
    "EH65": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL210,CB65+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL210,CB65)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH65,\n  Rapid, DG65,\n  DPM, (1+$DI65*$DJ65*$AQ$9),\n  SuperTower, $DL65,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL210,CB65+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY65*(DE65*OtherDamage*$DQ65+DW65*DF65)))",
    "EI65": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM210,CC65)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65, $DB65), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK65),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV65, $AR$29), 0),\n\n  DW, $DR65,\n  CL, $DS65,\n  SM, $DT65,\n  SL, $DQ65,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM65, UltCritCard),\nCY65*(DE65*DO65*SL+UwDamage*DF65)))",
    "EJ65": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN210,CD65)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT65,\n  DamageMastery, $CS65,\n  DemonMastery, $CX65,\n  SPB, INDEX($BN$5:$BN210,CD65+1),\n  ITO, $CV65,\n  Shock, $CW65,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE65*DO65*$DQ65+DW65*DF65)))",
    "EK65": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO210,CE65)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT65,\n  DamageMastery, $CS65,\n  DemonMastery, $CX65,\n  SPB, $CU65,\n  ITO, INDEX($BO$5:$BO210,CE65+1),\n  Shock, $CW65,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE65*DO65*$DQ65+DW65*DF65)))",
    "EL65": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP210,CF65)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65, $DB65), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP65),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF65),\n  CL, $DS65,\n  SM, $DT65,\n  SLM, $DU65,\n  SL, $DQ65,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM65, UltCritCard),\nCY65*(DE65*DO65*SL+UwDamage*DF65)))",
    "EM65": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ210,CG65)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG65+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN65": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR210,CH65)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65, $DB65), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH65+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP65),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK65),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM210,CC65), SMHeat, $AR$29), 0),\n\n  DW, $DR65,\n  CL, $DS65,\n  SL, $DQ65,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM65, UltCritCard),\nCY65*(DE65*DO65*SL+UwDamage*DF65)))",
    "EO65": "IF(OR(CI65 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI65+1))",
    "EP65": "IF(OR($AO$25, CJ65 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ65+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE209,BU65),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL65, 1),\n  DPM, (1+$DI65*CardRangeMastery*$DJ65*$AQ$9),\n  SuperTower, $DL65,\n  Rend, $DN65,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65, $DB65), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR65,\n  SM, $DT65,\n  SLM, $DU65,\n  SL, $DQ65,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM65, UltCritCard),\n\nCY65*(DE65*OtherDamage*SL+UwDamage*DF65)))",
    "EQ65": "IF(OR(CK65 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK65+1)*1%, 1),\n  CF, $DB65,\n  CC, MIN(100%, $CZ65 + 1%),\n  CCUW, DA65 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ210,BZ65) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC65 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR65,\n  CL, $DS65,\n  SM, $DT65,\n  SLM, $DU65,\n  SL, $DQ65,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM65, UltCritCard),\n\nCY65 * (Critical*DO65*SL+UwDamage*UWCritical)))",
    "ER65": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL65 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH210,BX65),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL65+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI65*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM210,CC65), $DV65, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH65,\n  Rapid, DG65,\n  SuperTower, $DL65,\n  Rend, $DN65,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM65,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65, $DB65), 1),\n\n  DW, $DR65,\n  CL, $DS65,\n  SM, $DT65,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY65*(DE65*OtherDamage*SL+UWDamage*DF65)))",
    "ES65": "IF(OR(CM65 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH65,\n  Rapid, DG65,\n  RDPM, (1+$DI65*$DJ65*$AQ$9),\n  Rend, $DN65,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK210,CA65),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM65+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65, $DB65), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR65,\n  CL, $DS65,\n  SM, $DT65,\n  SLM, $DU65,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY65*(DE65*OtherDamage*SL+UwDamage*DF65)))",
    "ET65": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN65 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM65,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN65+1, $DB65), 1),\n\n  DW, $DR65,\n  CL, $DS65,\n  SM, $DT65,\n  SLM, $DU65,\n  SL, $DQ65,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY65*(DE65*DO65*SL+UWDamage*DF65)))",
    "EU65": "IF(OR(NOT($BA$3), NOT($BA$23), $CO65 > $BA$15), \"\", 1 + 0.5*(CO65+1))",
    "EW65": "IF(DZ65=\"\", \"\", LET(\n  Now, CT65,\n  Next, DZ65,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT65),\nFactor/Cost))",
    "EX65": "IF(EA65=\"\",\"\",(EA65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU65))",
    "EY65": "IF(EB65=\"\",\"\",(EB65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV65))",
    "EZ65": "IF(EC65=\"\",\"\",(EC65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW65))",
    "FA65": "IF(ED65=\"\",\"\",(ED65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX65))",
    "FB65": "IF(EE65=\"\",\"\",(EE65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY65))",
    "FC65": "IF(EF65=\"\",\"\",(EF65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ65))",
    "FD65": "IF(EG65=\"\",\"\",(EG65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA65))",
    "FE65": "IF(EH65=\"\",\"\",(EH65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB65))",
    "FF65": "IF(EI65=\"\",\"\",(EI65/$DX65-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC65+1, 1, CC65))))",
    "FG65": "IF(EJ65=\"\",\"\",(EJ65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD65))",
    "FH65": "IF(EK65=\"\",\"\",(EK65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE65))",
    "FI65": "IF(EL65=\"\",\"\",(EL65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF65))",
    "FJ65": "IF(EM65=\"\", \"\", LET(\n  Now, CW65,\n  Next, EM65,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG65),\nFactor/Cost))",
    "FK65": "IF(EN65=\"\",\"\",(EN65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH65))",
    "FL65": "IF(EO65=\"\", \"\", LET(\n  Now, CS65,\n  Next, EO65,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI65),\nFactor/Cost))",
    "FM65": "IF(EP65=\"\",\"\",(EP65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ65))",
    "FN65": "IF(EQ65=\"\",\"\",(EQ65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK65))",
    "FO65": "IF(ER65=\"\",\"\",(ER65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL65))",
    "FP65": "IF(ES65=\"\",\"\",(ES65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM65))",
    "FQ65": "IF(ET65=\"\",\"\",(ET65/$DX65-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN65))",
    "FR65": "IF(EU65=\"\", \"\", LET(\n  Now, CX65,\n  Next, EU65,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO65),\nFactor/Cost))",
    "FT65": "IF(COLUMN(EW65:FR65) = MIN(IF(EW65:FR65=MAX(EW65:FR65), COLUMN(EW65:FR65))), 1, \"\")",
    "D66": "IF(SUM(FT65:GP65),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F66)),\"Card Mastery\",F66),G66)/$D$5,\"\")",
    "F66": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT65:GP65),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT65:GP65=1)),)\"),\"Critical Factor\")",
    "G66": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT65:GP65),ARRAYFORMULA(FILTER(BT65:CP65 , FT65:GP65=1)),\"\"\"\")\"),17.0)",
    "I66": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT65:GP65),ARRAYFORMULA(FILTER(EW65:FS65 , FT65:GP65=1))*D$5,\"\"\"\")\"),0.02974804889321222)",
    "K66": "IF(H66<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D66)),)",
    "BC66": "BC65+1",
    "BD66": "BD65+BD$3",
    "BE66": "BE65+BE$3",
    "BF66": "BF65+BF$3",
    "BG66": "BG65+BG$3",
    "BH66": "BH65+BH$3",
    "BT66": "BT65+FT65",
    "BU66": "BU65+FU65",
    "BV66": "BV65+FV65",
    "BW66": "BW65+FW65",
    "BX66": "BX65+FX65",
    "BY66": "BY65+FY65",
    "BZ66": "BZ65+FZ65",
    "CA66": "CA65+GA65",
    "CB66": "CB65+GB65",
    "CC66": "CC65+GC65",
    "CD66": "CD65+GD65",
    "CE66": "CE65+GE65",
    "CF66": "CF65+GF65",
    "CG66": "CG65+GG65",
    "CH66": "CH65+GH65",
    "CI66": "CI65+GI65",
    "CJ66": "CJ65+GJ65",
    "CK66": "CK65+GK65",
    "CL66": "CL65+GL65",
    "CM66": "CM65+GM65",
    "CN66": "CN65+GN65",
    "CO66": "CO65+GO65",
    "CS66": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI66,1)",
    "CT66": "INDEX($BD$5:$BD211,BT66)",
    "CU66": "INDEX($BN$5:$BN211,CD66)",
    "CV66": "INDEX($BO$5:$BO211,CE66)",
    "CW66": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG66)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX66": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO66, 1)",
    "CY66": "LET(\n  Base, $CR$6,\n  Damage, $CT66,\n  DamageMastery, $CS66,\n  DemonMastery, $CX66,\n  SPB, $CU66,\n  ITO, $CV66,\n  Shock, $CW66,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ66": "MIN(100%, DA66)",
    "DA66": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK66*1%, 0)",
    "DB66": "LET(\n  Lab, 1+INDEX($BF$5:$BF211,BV66),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC66": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK66*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI211,BY66) + CardCritMastery)",
    "DD66": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK66*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ211,BZ66) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE66": "LET(\n  CF, $DB66,\n  CC, $CZ66,\n  SCM, $DD66,\n  SCC, $DC66,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF66": "LET(\n  CF, $DB66,\n  CC, $DA66,\n  SCM, $DD66,\n  SCC, $DC66,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG66": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH66)), 0)",
    "DH66": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ66*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE211,BU66),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI66": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG211, BW66), 1) + $AE$9)",
    "DJ66": "LET(\n  DpmLab, INDEX($BH$5:$BH211,BX66),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL66, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK66": "(1+$DI66*$DJ66*$AQ$9)",
    "DL66": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK211,CA66),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM66*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM66": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK211,CA66),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM66*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN66": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL211,CB66)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO66": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH66,\n  Rapid, DG66,\n  RDPM, DK66,\n  SuperTower, $DL66,\n  Rend, $DN66,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP66": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ66": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK66),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR66": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP66),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF66-1))",
    "DS66": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG66, DH66),0))",
    "DT66": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP66),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV66, $AR$29), 0))",
    "DU66": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK66),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM211,CC66), $DV66, $AR$29), 0))",
    "DV66": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH66), $AO$29)",
    "DW66": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM66,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66, $DB66), 1),\n\n  DW, $DR66,\n  CL, $DS66,\n  SM, $DT66,\n  SLM, $DU66,\n  SL, $DQ66,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX66": "CY66*(DE66*DO66*DQ66+DW66*DF66)",
    "DZ66": "IF(INDEX($BD$6:$BD211,BT66)=\"\", \"\", INDEX($BD$5:$BD211,BT66+1))",
    "EA66": "IF(OR($AO$25, INDEX($BE$6:$BE211,BU66)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ66)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE211,BU66+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI66*$DJ66*$AQ$9),\n  SuperTower, $DL66,\n  Rend, $DN66,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66, $DB66), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR66,\n  SM, $DT66,\n  SLM, $DU66,\n  SL, $DQ66,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM66, UltCritCard),\n\nCY66*(DE66*OtherDamage*SL+UwDamage*DF66)))",
    "EB66": "IF(INDEX($BF$6:$BF211,BV66)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF211,BV66+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ66,\n  CCUW, $DA66,\n  SCM, $DD66,\n  SCC, $DC66,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66, CF), 1),\n\n  DW, $DR66,\n  CL, $DS66,\n  SM, $DT66,\n  SLM, $DU66,\n  SL, $DQ66,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM66, UltCritCard),\n\nCY66 * (Critical * DO66 * SL + UwDamage * UWCritical)))",
    "EC66": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG211,BW66)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH66,\n  Rapid, DG66,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG211, BW66+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ66*$AQ$9),\n  SuperTower, $DL66,\n  Rend, $DN66,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM211,CC66), $DV66, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM66,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66, $DB66), 1),\n\n  DW, $DR66,\n  CL, $DS66,\n  SM, $DT66,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY66*(DE66*OtherDamage*SL+UWDamage*DF66)))",
    "ED66": "IF(OR($AO$25, INDEX($BH$6:$BH211,BX66)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH211,BX66+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL66, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI66*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM211,CC66), $DV66, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH66,\n  Rapid, DG66,\n  SuperTower, $DL66,\n  Rend, $DN66,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM66,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66, $DB66), 1),\n\n  DW, $DR66,\n  CL, $DS66,\n  SM, $DT66,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY66*(DE66*OtherDamage*SL+UWDamage*DF66)))",
    "EE66": "IF(INDEX($BI$6:$BI211,BY66)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK66, 0),\n  CF, $DB66,\n  CC, $CZ66,\n  CCUW, $DA66,\n  SCM, $DD66,\n  SCC, $AV$17+INDEX($BI$5:$BI211,BY66+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY66 * (Critical*DO66*$DQ66+DW66*UWCritical)))",
    "EF66": "IF(INDEX($BJ$6:$BJ211,BZ66)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK66*1%, 1),\n  CF, $DB66,\n  CC, $CZ66,\n  CCUW, $DA66,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ211,BZ66+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC66,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY66*(Critical*DO66*$DQ66+DW66*UWCritical)))",
    "EG66": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK211,CA66)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH66,\n  Rapid, DG66,\n  DPM, (1+$DI66*$DJ66*$AQ$9),\n  Rend, $DN66,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK211,CA66+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM66*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66, $DB66), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK211,CA66+1)-1))/(45-CM66*3),1),\n\n  SL, $DQ66,\n  DW, $DR66,\n  CL, $DS66,\n  SM, $DT66,\n  SLM, $DU66,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY66*(DE66*OtherDamage*SL+UwDamage*DF66)))",
    "EH66": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL211,CB66+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL211,CB66)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH66,\n  Rapid, DG66,\n  DPM, (1+$DI66*$DJ66*$AQ$9),\n  SuperTower, $DL66,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL211,CB66+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY66*(DE66*OtherDamage*$DQ66+DW66*DF66)))",
    "EI66": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM211,CC66)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66, $DB66), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK66),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV66, $AR$29), 0),\n\n  DW, $DR66,\n  CL, $DS66,\n  SM, $DT66,\n  SL, $DQ66,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM66, UltCritCard),\nCY66*(DE66*DO66*SL+UwDamage*DF66)))",
    "EJ66": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN211,CD66)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT66,\n  DamageMastery, $CS66,\n  DemonMastery, $CX66,\n  SPB, INDEX($BN$5:$BN211,CD66+1),\n  ITO, $CV66,\n  Shock, $CW66,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE66*DO66*$DQ66+DW66*DF66)))",
    "EK66": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO211,CE66)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT66,\n  DamageMastery, $CS66,\n  DemonMastery, $CX66,\n  SPB, $CU66,\n  ITO, INDEX($BO$5:$BO211,CE66+1),\n  Shock, $CW66,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE66*DO66*$DQ66+DW66*DF66)))",
    "EL66": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP211,CF66)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66, $DB66), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP66),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF66),\n  CL, $DS66,\n  SM, $DT66,\n  SLM, $DU66,\n  SL, $DQ66,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM66, UltCritCard),\nCY66*(DE66*DO66*SL+UwDamage*DF66)))",
    "EM66": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ211,CG66)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG66+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN66": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR211,CH66)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66, $DB66), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH66+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP66),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK66),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM211,CC66), SMHeat, $AR$29), 0),\n\n  DW, $DR66,\n  CL, $DS66,\n  SL, $DQ66,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM66, UltCritCard),\nCY66*(DE66*DO66*SL+UwDamage*DF66)))",
    "EO66": "IF(OR(CI66 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI66+1))",
    "EP66": "IF(OR($AO$25, CJ66 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ66+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE210,BU66),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL66, 1),\n  DPM, (1+$DI66*CardRangeMastery*$DJ66*$AQ$9),\n  SuperTower, $DL66,\n  Rend, $DN66,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66, $DB66), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR66,\n  SM, $DT66,\n  SLM, $DU66,\n  SL, $DQ66,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM66, UltCritCard),\n\nCY66*(DE66*OtherDamage*SL+UwDamage*DF66)))",
    "EQ66": "IF(OR(CK66 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK66+1)*1%, 1),\n  CF, $DB66,\n  CC, MIN(100%, $CZ66 + 1%),\n  CCUW, DA66 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ211,BZ66) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC66 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR66,\n  CL, $DS66,\n  SM, $DT66,\n  SLM, $DU66,\n  SL, $DQ66,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM66, UltCritCard),\n\nCY66 * (Critical*DO66*SL+UwDamage*UWCritical)))",
    "ER66": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL66 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH211,BX66),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL66+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI66*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM211,CC66), $DV66, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH66,\n  Rapid, DG66,\n  SuperTower, $DL66,\n  Rend, $DN66,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM66,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66, $DB66), 1),\n\n  DW, $DR66,\n  CL, $DS66,\n  SM, $DT66,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY66*(DE66*OtherDamage*SL+UWDamage*DF66)))",
    "ES66": "IF(OR(CM66 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH66,\n  Rapid, DG66,\n  RDPM, (1+$DI66*$DJ66*$AQ$9),\n  Rend, $DN66,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK211,CA66),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM66+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66, $DB66), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR66,\n  CL, $DS66,\n  SM, $DT66,\n  SLM, $DU66,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY66*(DE66*OtherDamage*SL+UwDamage*DF66)))",
    "ET66": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN66 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM66,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN66+1, $DB66), 1),\n\n  DW, $DR66,\n  CL, $DS66,\n  SM, $DT66,\n  SLM, $DU66,\n  SL, $DQ66,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY66*(DE66*DO66*SL+UWDamage*DF66)))",
    "EU66": "IF(OR(NOT($BA$3), NOT($BA$23), $CO66 > $BA$15), \"\", 1 + 0.5*(CO66+1))",
    "EW66": "IF(DZ66=\"\", \"\", LET(\n  Now, CT66,\n  Next, DZ66,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT66),\nFactor/Cost))",
    "EX66": "IF(EA66=\"\",\"\",(EA66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU66))",
    "EY66": "IF(EB66=\"\",\"\",(EB66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV66))",
    "EZ66": "IF(EC66=\"\",\"\",(EC66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW66))",
    "FA66": "IF(ED66=\"\",\"\",(ED66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX66))",
    "FB66": "IF(EE66=\"\",\"\",(EE66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY66))",
    "FC66": "IF(EF66=\"\",\"\",(EF66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ66))",
    "FD66": "IF(EG66=\"\",\"\",(EG66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA66))",
    "FE66": "IF(EH66=\"\",\"\",(EH66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB66))",
    "FF66": "IF(EI66=\"\",\"\",(EI66/$DX66-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC66+1, 1, CC66))))",
    "FG66": "IF(EJ66=\"\",\"\",(EJ66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD66))",
    "FH66": "IF(EK66=\"\",\"\",(EK66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE66))",
    "FI66": "IF(EL66=\"\",\"\",(EL66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF66))",
    "FJ66": "IF(EM66=\"\", \"\", LET(\n  Now, CW66,\n  Next, EM66,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG66),\nFactor/Cost))",
    "FK66": "IF(EN66=\"\",\"\",(EN66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH66))",
    "FL66": "IF(EO66=\"\", \"\", LET(\n  Now, CS66,\n  Next, EO66,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI66),\nFactor/Cost))",
    "FM66": "IF(EP66=\"\",\"\",(EP66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ66))",
    "FN66": "IF(EQ66=\"\",\"\",(EQ66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK66))",
    "FO66": "IF(ER66=\"\",\"\",(ER66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL66))",
    "FP66": "IF(ES66=\"\",\"\",(ES66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM66))",
    "FQ66": "IF(ET66=\"\",\"\",(ET66/$DX66-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN66))",
    "FR66": "IF(EU66=\"\", \"\", LET(\n  Now, CX66,\n  Next, EU66,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO66),\nFactor/Cost))",
    "FT66": "IF(COLUMN(EW66:FR66) = MIN(IF(EW66:FR66=MAX(EW66:FR66), COLUMN(EW66:FR66))), 1, \"\")",
    "D67": "IF(SUM(FT66:GP66),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F67)),\"Card Mastery\",F67),G67)/$D$5,\"\")",
    "F67": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT66:GP66),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT66:GP66=1)),)\"),\"Damage\")",
    "G67": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT66:GP66),ARRAYFORMULA(FILTER(BT66:CP66 , FT66:GP66=1)),\"\"\"\")\"),16.0)",
    "I67": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT66:GP66),ARRAYFORMULA(FILTER(EW66:FS66 , FT66:GP66=1))*D$5,\"\"\"\")\"),0.0260633484162895)",
    "K67": "IF(H67<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D67)),)",
    "BC67": "BC66+1",
    "BD67": "BD66+BD$3",
    "BE67": "BE66+BE$3",
    "BF67": "BF66+BF$3",
    "BG67": "BG66+BG$3",
    "BH67": "BH66+BH$3",
    "BT67": "BT66+FT66",
    "BU67": "BU66+FU66",
    "BV67": "BV66+FV66",
    "BW67": "BW66+FW66",
    "BX67": "BX66+FX66",
    "BY67": "BY66+FY66",
    "BZ67": "BZ66+FZ66",
    "CA67": "CA66+GA66",
    "CB67": "CB66+GB66",
    "CC67": "CC66+GC66",
    "CD67": "CD66+GD66",
    "CE67": "CE66+GE66",
    "CF67": "CF66+GF66",
    "CG67": "CG66+GG66",
    "CH67": "CH66+GH66",
    "CI67": "CI66+GI66",
    "CJ67": "CJ66+GJ66",
    "CK67": "CK66+GK66",
    "CL67": "CL66+GL66",
    "CM67": "CM66+GM66",
    "CN67": "CN66+GN66",
    "CO67": "CO66+GO66",
    "CS67": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI67,1)",
    "CT67": "INDEX($BD$5:$BD212,BT67)",
    "CU67": "INDEX($BN$5:$BN212,CD67)",
    "CV67": "INDEX($BO$5:$BO212,CE67)",
    "CW67": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG67)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX67": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO67, 1)",
    "CY67": "LET(\n  Base, $CR$6,\n  Damage, $CT67,\n  DamageMastery, $CS67,\n  DemonMastery, $CX67,\n  SPB, $CU67,\n  ITO, $CV67,\n  Shock, $CW67,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ67": "MIN(100%, DA67)",
    "DA67": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK67*1%, 0)",
    "DB67": "LET(\n  Lab, 1+INDEX($BF$5:$BF212,BV67),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC67": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK67*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI212,BY67) + CardCritMastery)",
    "DD67": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK67*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ212,BZ67) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE67": "LET(\n  CF, $DB67,\n  CC, $CZ67,\n  SCM, $DD67,\n  SCC, $DC67,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF67": "LET(\n  CF, $DB67,\n  CC, $DA67,\n  SCM, $DD67,\n  SCC, $DC67,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG67": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH67)), 0)",
    "DH67": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ67*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE212,BU67),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI67": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG212, BW67), 1) + $AE$9)",
    "DJ67": "LET(\n  DpmLab, INDEX($BH$5:$BH212,BX67),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL67, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK67": "(1+$DI67*$DJ67*$AQ$9)",
    "DL67": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK212,CA67),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM67*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM67": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK212,CA67),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM67*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN67": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL212,CB67)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO67": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH67,\n  Rapid, DG67,\n  RDPM, DK67,\n  SuperTower, $DL67,\n  Rend, $DN67,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP67": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ67": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK67),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR67": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP67),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF67-1))",
    "DS67": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG67, DH67),0))",
    "DT67": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP67),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV67, $AR$29), 0))",
    "DU67": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK67),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM212,CC67), $DV67, $AR$29), 0))",
    "DV67": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH67), $AO$29)",
    "DW67": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM67,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67, $DB67), 1),\n\n  DW, $DR67,\n  CL, $DS67,\n  SM, $DT67,\n  SLM, $DU67,\n  SL, $DQ67,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX67": "CY67*(DE67*DO67*DQ67+DW67*DF67)",
    "DZ67": "IF(INDEX($BD$6:$BD212,BT67)=\"\", \"\", INDEX($BD$5:$BD212,BT67+1))",
    "EA67": "IF(OR($AO$25, INDEX($BE$6:$BE212,BU67)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ67)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE212,BU67+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI67*$DJ67*$AQ$9),\n  SuperTower, $DL67,\n  Rend, $DN67,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67, $DB67), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR67,\n  SM, $DT67,\n  SLM, $DU67,\n  SL, $DQ67,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM67, UltCritCard),\n\nCY67*(DE67*OtherDamage*SL+UwDamage*DF67)))",
    "EB67": "IF(INDEX($BF$6:$BF212,BV67)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF212,BV67+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ67,\n  CCUW, $DA67,\n  SCM, $DD67,\n  SCC, $DC67,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67, CF), 1),\n\n  DW, $DR67,\n  CL, $DS67,\n  SM, $DT67,\n  SLM, $DU67,\n  SL, $DQ67,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM67, UltCritCard),\n\nCY67 * (Critical * DO67 * SL + UwDamage * UWCritical)))",
    "EC67": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG212,BW67)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH67,\n  Rapid, DG67,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG212, BW67+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ67*$AQ$9),\n  SuperTower, $DL67,\n  Rend, $DN67,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM212,CC67), $DV67, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM67,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67, $DB67), 1),\n\n  DW, $DR67,\n  CL, $DS67,\n  SM, $DT67,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY67*(DE67*OtherDamage*SL+UWDamage*DF67)))",
    "ED67": "IF(OR($AO$25, INDEX($BH$6:$BH212,BX67)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH212,BX67+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL67, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI67*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM212,CC67), $DV67, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH67,\n  Rapid, DG67,\n  SuperTower, $DL67,\n  Rend, $DN67,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM67,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67, $DB67), 1),\n\n  DW, $DR67,\n  CL, $DS67,\n  SM, $DT67,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY67*(DE67*OtherDamage*SL+UWDamage*DF67)))",
    "EE67": "IF(INDEX($BI$6:$BI212,BY67)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK67, 0),\n  CF, $DB67,\n  CC, $CZ67,\n  CCUW, $DA67,\n  SCM, $DD67,\n  SCC, $AV$17+INDEX($BI$5:$BI212,BY67+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY67 * (Critical*DO67*$DQ67+DW67*UWCritical)))",
    "EF67": "IF(INDEX($BJ$6:$BJ212,BZ67)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK67*1%, 1),\n  CF, $DB67,\n  CC, $CZ67,\n  CCUW, $DA67,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ212,BZ67+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC67,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY67*(Critical*DO67*$DQ67+DW67*UWCritical)))",
    "EG67": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK212,CA67)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH67,\n  Rapid, DG67,\n  DPM, (1+$DI67*$DJ67*$AQ$9),\n  Rend, $DN67,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK212,CA67+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM67*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67, $DB67), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK212,CA67+1)-1))/(45-CM67*3),1),\n\n  SL, $DQ67,\n  DW, $DR67,\n  CL, $DS67,\n  SM, $DT67,\n  SLM, $DU67,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY67*(DE67*OtherDamage*SL+UwDamage*DF67)))",
    "EH67": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL212,CB67+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL212,CB67)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH67,\n  Rapid, DG67,\n  DPM, (1+$DI67*$DJ67*$AQ$9),\n  SuperTower, $DL67,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL212,CB67+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY67*(DE67*OtherDamage*$DQ67+DW67*DF67)))",
    "EI67": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM212,CC67)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67, $DB67), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK67),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV67, $AR$29), 0),\n\n  DW, $DR67,\n  CL, $DS67,\n  SM, $DT67,\n  SL, $DQ67,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM67, UltCritCard),\nCY67*(DE67*DO67*SL+UwDamage*DF67)))",
    "EJ67": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN212,CD67)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT67,\n  DamageMastery, $CS67,\n  DemonMastery, $CX67,\n  SPB, INDEX($BN$5:$BN212,CD67+1),\n  ITO, $CV67,\n  Shock, $CW67,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE67*DO67*$DQ67+DW67*DF67)))",
    "EK67": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO212,CE67)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT67,\n  DamageMastery, $CS67,\n  DemonMastery, $CX67,\n  SPB, $CU67,\n  ITO, INDEX($BO$5:$BO212,CE67+1),\n  Shock, $CW67,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE67*DO67*$DQ67+DW67*DF67)))",
    "EL67": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP212,CF67)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67, $DB67), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP67),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF67),\n  CL, $DS67,\n  SM, $DT67,\n  SLM, $DU67,\n  SL, $DQ67,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM67, UltCritCard),\nCY67*(DE67*DO67*SL+UwDamage*DF67)))",
    "EM67": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ212,CG67)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG67+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN67": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR212,CH67)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67, $DB67), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH67+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP67),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK67),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM212,CC67), SMHeat, $AR$29), 0),\n\n  DW, $DR67,\n  CL, $DS67,\n  SL, $DQ67,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM67, UltCritCard),\nCY67*(DE67*DO67*SL+UwDamage*DF67)))",
    "EO67": "IF(OR(CI67 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI67+1))",
    "EP67": "IF(OR($AO$25, CJ67 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ67+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE211,BU67),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL67, 1),\n  DPM, (1+$DI67*CardRangeMastery*$DJ67*$AQ$9),\n  SuperTower, $DL67,\n  Rend, $DN67,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67, $DB67), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR67,\n  SM, $DT67,\n  SLM, $DU67,\n  SL, $DQ67,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM67, UltCritCard),\n\nCY67*(DE67*OtherDamage*SL+UwDamage*DF67)))",
    "EQ67": "IF(OR(CK67 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK67+1)*1%, 1),\n  CF, $DB67,\n  CC, MIN(100%, $CZ67 + 1%),\n  CCUW, DA67 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ212,BZ67) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC67 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR67,\n  CL, $DS67,\n  SM, $DT67,\n  SLM, $DU67,\n  SL, $DQ67,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM67, UltCritCard),\n\nCY67 * (Critical*DO67*SL+UwDamage*UWCritical)))",
    "ER67": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL67 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH212,BX67),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL67+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI67*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM212,CC67), $DV67, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH67,\n  Rapid, DG67,\n  SuperTower, $DL67,\n  Rend, $DN67,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM67,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67, $DB67), 1),\n\n  DW, $DR67,\n  CL, $DS67,\n  SM, $DT67,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY67*(DE67*OtherDamage*SL+UWDamage*DF67)))",
    "ES67": "IF(OR(CM67 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH67,\n  Rapid, DG67,\n  RDPM, (1+$DI67*$DJ67*$AQ$9),\n  Rend, $DN67,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK212,CA67),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM67+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67, $DB67), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR67,\n  CL, $DS67,\n  SM, $DT67,\n  SLM, $DU67,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY67*(DE67*OtherDamage*SL+UwDamage*DF67)))",
    "ET67": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN67 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM67,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN67+1, $DB67), 1),\n\n  DW, $DR67,\n  CL, $DS67,\n  SM, $DT67,\n  SLM, $DU67,\n  SL, $DQ67,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY67*(DE67*DO67*SL+UWDamage*DF67)))",
    "EU67": "IF(OR(NOT($BA$3), NOT($BA$23), $CO67 > $BA$15), \"\", 1 + 0.5*(CO67+1))",
    "EW67": "IF(DZ67=\"\", \"\", LET(\n  Now, CT67,\n  Next, DZ67,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT67),\nFactor/Cost))",
    "EX67": "IF(EA67=\"\",\"\",(EA67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU67))",
    "EY67": "IF(EB67=\"\",\"\",(EB67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV67))",
    "EZ67": "IF(EC67=\"\",\"\",(EC67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW67))",
    "FA67": "IF(ED67=\"\",\"\",(ED67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX67))",
    "FB67": "IF(EE67=\"\",\"\",(EE67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY67))",
    "FC67": "IF(EF67=\"\",\"\",(EF67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ67))",
    "FD67": "IF(EG67=\"\",\"\",(EG67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA67))",
    "FE67": "IF(EH67=\"\",\"\",(EH67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB67))",
    "FF67": "IF(EI67=\"\",\"\",(EI67/$DX67-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC67+1, 1, CC67))))",
    "FG67": "IF(EJ67=\"\",\"\",(EJ67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD67))",
    "FH67": "IF(EK67=\"\",\"\",(EK67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE67))",
    "FI67": "IF(EL67=\"\",\"\",(EL67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF67))",
    "FJ67": "IF(EM67=\"\", \"\", LET(\n  Now, CW67,\n  Next, EM67,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG67),\nFactor/Cost))",
    "FK67": "IF(EN67=\"\",\"\",(EN67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH67))",
    "FL67": "IF(EO67=\"\", \"\", LET(\n  Now, CS67,\n  Next, EO67,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI67),\nFactor/Cost))",
    "FM67": "IF(EP67=\"\",\"\",(EP67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ67))",
    "FN67": "IF(EQ67=\"\",\"\",(EQ67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK67))",
    "FO67": "IF(ER67=\"\",\"\",(ER67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL67))",
    "FP67": "IF(ES67=\"\",\"\",(ES67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM67))",
    "FQ67": "IF(ET67=\"\",\"\",(ET67/$DX67-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN67))",
    "FR67": "IF(EU67=\"\", \"\", LET(\n  Now, CX67,\n  Next, EU67,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO67),\nFactor/Cost))",
    "FT67": "IF(COLUMN(EW67:FR67) = MIN(IF(EW67:FR67=MAX(EW67:FR67), COLUMN(EW67:FR67))), 1, \"\")",
    "D68": "IF(SUM(FT67:GP67),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F68)),\"Card Mastery\",F68),G68)/$D$5,\"\")",
    "F68": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT67:GP67),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT67:GP67=1)),)\"),\"Attack Speed\")",
    "G68": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT67:GP67),ARRAYFORMULA(FILTER(BT67:CP67 , FT67:GP67=1)),\"\"\"\")\"),16.0)",
    "I68": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT67:GP67),ARRAYFORMULA(FILTER(EW67:FS67 , FT67:GP67=1))*D$5,\"\"\"\")\"),0.02593813093698421)",
    "K68": "IF(H68<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D68)),)",
    "BC68": "BC67+1",
    "BD68": "BD67+BD$3",
    "BE68": "BE67+BE$3",
    "BF68": "BF67+BF$3",
    "BG68": "BG67+BG$3",
    "BH68": "BH67+BH$3",
    "BT68": "BT67+FT67",
    "BU68": "BU67+FU67",
    "BV68": "BV67+FV67",
    "BW68": "BW67+FW67",
    "BX68": "BX67+FX67",
    "BY68": "BY67+FY67",
    "BZ68": "BZ67+FZ67",
    "CA68": "CA67+GA67",
    "CB68": "CB67+GB67",
    "CC68": "CC67+GC67",
    "CD68": "CD67+GD67",
    "CE68": "CE67+GE67",
    "CF68": "CF67+GF67",
    "CG68": "CG67+GG67",
    "CH68": "CH67+GH67",
    "CI68": "CI67+GI67",
    "CJ68": "CJ67+GJ67",
    "CK68": "CK67+GK67",
    "CL68": "CL67+GL67",
    "CM68": "CM67+GM67",
    "CN68": "CN67+GN67",
    "CO68": "CO67+GO67",
    "CS68": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI68,1)",
    "CT68": "INDEX($BD$5:$BD213,BT68)",
    "CU68": "INDEX($BN$5:$BN213,CD68)",
    "CV68": "INDEX($BO$5:$BO213,CE68)",
    "CW68": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG68)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX68": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO68, 1)",
    "CY68": "LET(\n  Base, $CR$6,\n  Damage, $CT68,\n  DamageMastery, $CS68,\n  DemonMastery, $CX68,\n  SPB, $CU68,\n  ITO, $CV68,\n  Shock, $CW68,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ68": "MIN(100%, DA68)",
    "DA68": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK68*1%, 0)",
    "DB68": "LET(\n  Lab, 1+INDEX($BF$5:$BF213,BV68),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC68": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK68*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI213,BY68) + CardCritMastery)",
    "DD68": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK68*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ213,BZ68) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE68": "LET(\n  CF, $DB68,\n  CC, $CZ68,\n  SCM, $DD68,\n  SCC, $DC68,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF68": "LET(\n  CF, $DB68,\n  CC, $DA68,\n  SCM, $DD68,\n  SCC, $DC68,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG68": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH68)), 0)",
    "DH68": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ68*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE213,BU68),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI68": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG213, BW68), 1) + $AE$9)",
    "DJ68": "LET(\n  DpmLab, INDEX($BH$5:$BH213,BX68),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL68, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK68": "(1+$DI68*$DJ68*$AQ$9)",
    "DL68": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK213,CA68),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM68*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM68": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK213,CA68),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM68*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN68": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL213,CB68)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO68": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH68,\n  Rapid, DG68,\n  RDPM, DK68,\n  SuperTower, $DL68,\n  Rend, $DN68,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP68": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ68": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK68),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR68": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP68),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF68-1))",
    "DS68": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG68, DH68),0))",
    "DT68": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP68),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV68, $AR$29), 0))",
    "DU68": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK68),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM213,CC68), $DV68, $AR$29), 0))",
    "DV68": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH68), $AO$29)",
    "DW68": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM68,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68, $DB68), 1),\n\n  DW, $DR68,\n  CL, $DS68,\n  SM, $DT68,\n  SLM, $DU68,\n  SL, $DQ68,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX68": "CY68*(DE68*DO68*DQ68+DW68*DF68)",
    "DZ68": "IF(INDEX($BD$6:$BD213,BT68)=\"\", \"\", INDEX($BD$5:$BD213,BT68+1))",
    "EA68": "IF(OR($AO$25, INDEX($BE$6:$BE213,BU68)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ68)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE213,BU68+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI68*$DJ68*$AQ$9),\n  SuperTower, $DL68,\n  Rend, $DN68,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68, $DB68), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR68,\n  SM, $DT68,\n  SLM, $DU68,\n  SL, $DQ68,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM68, UltCritCard),\n\nCY68*(DE68*OtherDamage*SL+UwDamage*DF68)))",
    "EB68": "IF(INDEX($BF$6:$BF213,BV68)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF213,BV68+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ68,\n  CCUW, $DA68,\n  SCM, $DD68,\n  SCC, $DC68,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68, CF), 1),\n\n  DW, $DR68,\n  CL, $DS68,\n  SM, $DT68,\n  SLM, $DU68,\n  SL, $DQ68,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM68, UltCritCard),\n\nCY68 * (Critical * DO68 * SL + UwDamage * UWCritical)))",
    "EC68": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG213,BW68)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH68,\n  Rapid, DG68,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG213, BW68+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ68*$AQ$9),\n  SuperTower, $DL68,\n  Rend, $DN68,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM213,CC68), $DV68, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM68,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68, $DB68), 1),\n\n  DW, $DR68,\n  CL, $DS68,\n  SM, $DT68,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY68*(DE68*OtherDamage*SL+UWDamage*DF68)))",
    "ED68": "IF(OR($AO$25, INDEX($BH$6:$BH213,BX68)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH213,BX68+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL68, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI68*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM213,CC68), $DV68, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH68,\n  Rapid, DG68,\n  SuperTower, $DL68,\n  Rend, $DN68,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM68,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68, $DB68), 1),\n\n  DW, $DR68,\n  CL, $DS68,\n  SM, $DT68,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY68*(DE68*OtherDamage*SL+UWDamage*DF68)))",
    "EE68": "IF(INDEX($BI$6:$BI213,BY68)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK68, 0),\n  CF, $DB68,\n  CC, $CZ68,\n  CCUW, $DA68,\n  SCM, $DD68,\n  SCC, $AV$17+INDEX($BI$5:$BI213,BY68+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY68 * (Critical*DO68*$DQ68+DW68*UWCritical)))",
    "EF68": "IF(INDEX($BJ$6:$BJ213,BZ68)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK68*1%, 1),\n  CF, $DB68,\n  CC, $CZ68,\n  CCUW, $DA68,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ213,BZ68+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC68,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY68*(Critical*DO68*$DQ68+DW68*UWCritical)))",
    "EG68": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK213,CA68)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH68,\n  Rapid, DG68,\n  DPM, (1+$DI68*$DJ68*$AQ$9),\n  Rend, $DN68,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK213,CA68+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM68*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68, $DB68), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK213,CA68+1)-1))/(45-CM68*3),1),\n\n  SL, $DQ68,\n  DW, $DR68,\n  CL, $DS68,\n  SM, $DT68,\n  SLM, $DU68,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY68*(DE68*OtherDamage*SL+UwDamage*DF68)))",
    "EH68": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL213,CB68+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL213,CB68)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH68,\n  Rapid, DG68,\n  DPM, (1+$DI68*$DJ68*$AQ$9),\n  SuperTower, $DL68,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL213,CB68+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY68*(DE68*OtherDamage*$DQ68+DW68*DF68)))",
    "EI68": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM213,CC68)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68, $DB68), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK68),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV68, $AR$29), 0),\n\n  DW, $DR68,\n  CL, $DS68,\n  SM, $DT68,\n  SL, $DQ68,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM68, UltCritCard),\nCY68*(DE68*DO68*SL+UwDamage*DF68)))",
    "EJ68": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN213,CD68)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT68,\n  DamageMastery, $CS68,\n  DemonMastery, $CX68,\n  SPB, INDEX($BN$5:$BN213,CD68+1),\n  ITO, $CV68,\n  Shock, $CW68,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE68*DO68*$DQ68+DW68*DF68)))",
    "EK68": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO213,CE68)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT68,\n  DamageMastery, $CS68,\n  DemonMastery, $CX68,\n  SPB, $CU68,\n  ITO, INDEX($BO$5:$BO213,CE68+1),\n  Shock, $CW68,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE68*DO68*$DQ68+DW68*DF68)))",
    "EL68": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP213,CF68)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68, $DB68), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP68),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF68),\n  CL, $DS68,\n  SM, $DT68,\n  SLM, $DU68,\n  SL, $DQ68,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM68, UltCritCard),\nCY68*(DE68*DO68*SL+UwDamage*DF68)))",
    "EM68": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ213,CG68)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG68+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN68": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR213,CH68)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68, $DB68), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH68+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP68),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK68),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM213,CC68), SMHeat, $AR$29), 0),\n\n  DW, $DR68,\n  CL, $DS68,\n  SL, $DQ68,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM68, UltCritCard),\nCY68*(DE68*DO68*SL+UwDamage*DF68)))",
    "EO68": "IF(OR(CI68 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI68+1))",
    "EP68": "IF(OR($AO$25, CJ68 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ68+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE212,BU68),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL68, 1),\n  DPM, (1+$DI68*CardRangeMastery*$DJ68*$AQ$9),\n  SuperTower, $DL68,\n  Rend, $DN68,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68, $DB68), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR68,\n  SM, $DT68,\n  SLM, $DU68,\n  SL, $DQ68,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM68, UltCritCard),\n\nCY68*(DE68*OtherDamage*SL+UwDamage*DF68)))",
    "EQ68": "IF(OR(CK68 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK68+1)*1%, 1),\n  CF, $DB68,\n  CC, MIN(100%, $CZ68 + 1%),\n  CCUW, DA68 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ213,BZ68) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC68 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR68,\n  CL, $DS68,\n  SM, $DT68,\n  SLM, $DU68,\n  SL, $DQ68,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM68, UltCritCard),\n\nCY68 * (Critical*DO68*SL+UwDamage*UWCritical)))",
    "ER68": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL68 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH213,BX68),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL68+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI68*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM213,CC68), $DV68, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH68,\n  Rapid, DG68,\n  SuperTower, $DL68,\n  Rend, $DN68,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM68,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68, $DB68), 1),\n\n  DW, $DR68,\n  CL, $DS68,\n  SM, $DT68,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY68*(DE68*OtherDamage*SL+UWDamage*DF68)))",
    "ES68": "IF(OR(CM68 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH68,\n  Rapid, DG68,\n  RDPM, (1+$DI68*$DJ68*$AQ$9),\n  Rend, $DN68,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK213,CA68),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM68+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68, $DB68), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR68,\n  CL, $DS68,\n  SM, $DT68,\n  SLM, $DU68,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY68*(DE68*OtherDamage*SL+UwDamage*DF68)))",
    "ET68": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN68 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM68,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN68+1, $DB68), 1),\n\n  DW, $DR68,\n  CL, $DS68,\n  SM, $DT68,\n  SLM, $DU68,\n  SL, $DQ68,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY68*(DE68*DO68*SL+UWDamage*DF68)))",
    "EU68": "IF(OR(NOT($BA$3), NOT($BA$23), $CO68 > $BA$15), \"\", 1 + 0.5*(CO68+1))",
    "EW68": "IF(DZ68=\"\", \"\", LET(\n  Now, CT68,\n  Next, DZ68,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT68),\nFactor/Cost))",
    "EX68": "IF(EA68=\"\",\"\",(EA68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU68))",
    "EY68": "IF(EB68=\"\",\"\",(EB68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV68))",
    "EZ68": "IF(EC68=\"\",\"\",(EC68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW68))",
    "FA68": "IF(ED68=\"\",\"\",(ED68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX68))",
    "FB68": "IF(EE68=\"\",\"\",(EE68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY68))",
    "FC68": "IF(EF68=\"\",\"\",(EF68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ68))",
    "FD68": "IF(EG68=\"\",\"\",(EG68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA68))",
    "FE68": "IF(EH68=\"\",\"\",(EH68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB68))",
    "FF68": "IF(EI68=\"\",\"\",(EI68/$DX68-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC68+1, 1, CC68))))",
    "FG68": "IF(EJ68=\"\",\"\",(EJ68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD68))",
    "FH68": "IF(EK68=\"\",\"\",(EK68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE68))",
    "FI68": "IF(EL68=\"\",\"\",(EL68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF68))",
    "FJ68": "IF(EM68=\"\", \"\", LET(\n  Now, CW68,\n  Next, EM68,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG68),\nFactor/Cost))",
    "FK68": "IF(EN68=\"\",\"\",(EN68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH68))",
    "FL68": "IF(EO68=\"\", \"\", LET(\n  Now, CS68,\n  Next, EO68,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI68),\nFactor/Cost))",
    "FM68": "IF(EP68=\"\",\"\",(EP68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ68))",
    "FN68": "IF(EQ68=\"\",\"\",(EQ68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK68))",
    "FO68": "IF(ER68=\"\",\"\",(ER68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL68))",
    "FP68": "IF(ES68=\"\",\"\",(ES68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM68))",
    "FQ68": "IF(ET68=\"\",\"\",(ET68/$DX68-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN68))",
    "FR68": "IF(EU68=\"\", \"\", LET(\n  Now, CX68,\n  Next, EU68,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO68),\nFactor/Cost))",
    "FT68": "IF(COLUMN(EW68:FR68) = MIN(IF(EW68:FR68=MAX(EW68:FR68), COLUMN(EW68:FR68))), 1, \"\")",
    "D69": "IF(SUM(FT68:GP68),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F69)),\"Card Mastery\",F69),G69)/$D$5,\"\")",
    "F69": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT68:GP68),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT68:GP68=1)),)\"),\"Super Tower Bonus\")",
    "G69": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT68:GP68),ARRAYFORMULA(FILTER(BT68:CP68 , FT68:GP68=1)),\"\"\"\")\"),2.0)",
    "I69": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT68:GP68),ARRAYFORMULA(FILTER(EW68:FS68 , FT68:GP68=1))*D$5,\"\"\"\")\"),0.025922934776830123)",
    "K69": "IF(H69<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D69)),)",
    "BC69": "BC68+1",
    "BD69": "BD68+BD$3",
    "BE69": "BE68+BE$3",
    "BF69": "BF68+BF$3",
    "BG69": "BG68+BG$3",
    "BH69": "BH68+BH$3",
    "BT69": "BT68+FT68",
    "BU69": "BU68+FU68",
    "BV69": "BV68+FV68",
    "BW69": "BW68+FW68",
    "BX69": "BX68+FX68",
    "BY69": "BY68+FY68",
    "BZ69": "BZ68+FZ68",
    "CA69": "CA68+GA68",
    "CB69": "CB68+GB68",
    "CC69": "CC68+GC68",
    "CD69": "CD68+GD68",
    "CE69": "CE68+GE68",
    "CF69": "CF68+GF68",
    "CG69": "CG68+GG68",
    "CH69": "CH68+GH68",
    "CI69": "CI68+GI68",
    "CJ69": "CJ68+GJ68",
    "CK69": "CK68+GK68",
    "CL69": "CL68+GL68",
    "CM69": "CM68+GM68",
    "CN69": "CN68+GN68",
    "CO69": "CO68+GO68",
    "CS69": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI69,1)",
    "CT69": "INDEX($BD$5:$BD214,BT69)",
    "CU69": "INDEX($BN$5:$BN214,CD69)",
    "CV69": "INDEX($BO$5:$BO214,CE69)",
    "CW69": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG69)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX69": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO69, 1)",
    "CY69": "LET(\n  Base, $CR$6,\n  Damage, $CT69,\n  DamageMastery, $CS69,\n  DemonMastery, $CX69,\n  SPB, $CU69,\n  ITO, $CV69,\n  Shock, $CW69,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ69": "MIN(100%, DA69)",
    "DA69": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK69*1%, 0)",
    "DB69": "LET(\n  Lab, 1+INDEX($BF$5:$BF214,BV69),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC69": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK69*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI214,BY69) + CardCritMastery)",
    "DD69": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK69*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ214,BZ69) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE69": "LET(\n  CF, $DB69,\n  CC, $CZ69,\n  SCM, $DD69,\n  SCC, $DC69,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF69": "LET(\n  CF, $DB69,\n  CC, $DA69,\n  SCM, $DD69,\n  SCC, $DC69,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG69": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH69)), 0)",
    "DH69": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ69*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE214,BU69),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI69": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG214, BW69), 1) + $AE$9)",
    "DJ69": "LET(\n  DpmLab, INDEX($BH$5:$BH214,BX69),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL69, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK69": "(1+$DI69*$DJ69*$AQ$9)",
    "DL69": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK214,CA69),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM69*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM69": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK214,CA69),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM69*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN69": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL214,CB69)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO69": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH69,\n  Rapid, DG69,\n  RDPM, DK69,\n  SuperTower, $DL69,\n  Rend, $DN69,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP69": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ69": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK69),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR69": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP69),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF69-1))",
    "DS69": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG69, DH69),0))",
    "DT69": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP69),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV69, $AR$29), 0))",
    "DU69": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK69),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM214,CC69), $DV69, $AR$29), 0))",
    "DV69": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH69), $AO$29)",
    "DW69": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM69,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69, $DB69), 1),\n\n  DW, $DR69,\n  CL, $DS69,\n  SM, $DT69,\n  SLM, $DU69,\n  SL, $DQ69,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX69": "CY69*(DE69*DO69*DQ69+DW69*DF69)",
    "DZ69": "IF(INDEX($BD$6:$BD214,BT69)=\"\", \"\", INDEX($BD$5:$BD214,BT69+1))",
    "EA69": "IF(OR($AO$25, INDEX($BE$6:$BE214,BU69)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ69)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE214,BU69+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI69*$DJ69*$AQ$9),\n  SuperTower, $DL69,\n  Rend, $DN69,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69, $DB69), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR69,\n  SM, $DT69,\n  SLM, $DU69,\n  SL, $DQ69,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM69, UltCritCard),\n\nCY69*(DE69*OtherDamage*SL+UwDamage*DF69)))",
    "EB69": "IF(INDEX($BF$6:$BF214,BV69)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF214,BV69+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ69,\n  CCUW, $DA69,\n  SCM, $DD69,\n  SCC, $DC69,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69, CF), 1),\n\n  DW, $DR69,\n  CL, $DS69,\n  SM, $DT69,\n  SLM, $DU69,\n  SL, $DQ69,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM69, UltCritCard),\n\nCY69 * (Critical * DO69 * SL + UwDamage * UWCritical)))",
    "EC69": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG214,BW69)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH69,\n  Rapid, DG69,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG214, BW69+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ69*$AQ$9),\n  SuperTower, $DL69,\n  Rend, $DN69,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM214,CC69), $DV69, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM69,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69, $DB69), 1),\n\n  DW, $DR69,\n  CL, $DS69,\n  SM, $DT69,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY69*(DE69*OtherDamage*SL+UWDamage*DF69)))",
    "ED69": "IF(OR($AO$25, INDEX($BH$6:$BH214,BX69)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH214,BX69+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL69, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI69*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM214,CC69), $DV69, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH69,\n  Rapid, DG69,\n  SuperTower, $DL69,\n  Rend, $DN69,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM69,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69, $DB69), 1),\n\n  DW, $DR69,\n  CL, $DS69,\n  SM, $DT69,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY69*(DE69*OtherDamage*SL+UWDamage*DF69)))",
    "EE69": "IF(INDEX($BI$6:$BI214,BY69)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK69, 0),\n  CF, $DB69,\n  CC, $CZ69,\n  CCUW, $DA69,\n  SCM, $DD69,\n  SCC, $AV$17+INDEX($BI$5:$BI214,BY69+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY69 * (Critical*DO69*$DQ69+DW69*UWCritical)))",
    "EF69": "IF(INDEX($BJ$6:$BJ214,BZ69)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK69*1%, 1),\n  CF, $DB69,\n  CC, $CZ69,\n  CCUW, $DA69,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ214,BZ69+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC69,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY69*(Critical*DO69*$DQ69+DW69*UWCritical)))",
    "EG69": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK214,CA69)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH69,\n  Rapid, DG69,\n  DPM, (1+$DI69*$DJ69*$AQ$9),\n  Rend, $DN69,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK214,CA69+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM69*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69, $DB69), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK214,CA69+1)-1))/(45-CM69*3),1),\n\n  SL, $DQ69,\n  DW, $DR69,\n  CL, $DS69,\n  SM, $DT69,\n  SLM, $DU69,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY69*(DE69*OtherDamage*SL+UwDamage*DF69)))",
    "EH69": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL214,CB69+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL214,CB69)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH69,\n  Rapid, DG69,\n  DPM, (1+$DI69*$DJ69*$AQ$9),\n  SuperTower, $DL69,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL214,CB69+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY69*(DE69*OtherDamage*$DQ69+DW69*DF69)))",
    "EI69": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM214,CC69)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69, $DB69), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK69),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV69, $AR$29), 0),\n\n  DW, $DR69,\n  CL, $DS69,\n  SM, $DT69,\n  SL, $DQ69,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM69, UltCritCard),\nCY69*(DE69*DO69*SL+UwDamage*DF69)))",
    "EJ69": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN214,CD69)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT69,\n  DamageMastery, $CS69,\n  DemonMastery, $CX69,\n  SPB, INDEX($BN$5:$BN214,CD69+1),\n  ITO, $CV69,\n  Shock, $CW69,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE69*DO69*$DQ69+DW69*DF69)))",
    "EK69": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO214,CE69)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT69,\n  DamageMastery, $CS69,\n  DemonMastery, $CX69,\n  SPB, $CU69,\n  ITO, INDEX($BO$5:$BO214,CE69+1),\n  Shock, $CW69,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE69*DO69*$DQ69+DW69*DF69)))",
    "EL69": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP214,CF69)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69, $DB69), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP69),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF69),\n  CL, $DS69,\n  SM, $DT69,\n  SLM, $DU69,\n  SL, $DQ69,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM69, UltCritCard),\nCY69*(DE69*DO69*SL+UwDamage*DF69)))",
    "EM69": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ214,CG69)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG69+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN69": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR214,CH69)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69, $DB69), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH69+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP69),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK69),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM214,CC69), SMHeat, $AR$29), 0),\n\n  DW, $DR69,\n  CL, $DS69,\n  SL, $DQ69,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM69, UltCritCard),\nCY69*(DE69*DO69*SL+UwDamage*DF69)))",
    "EO69": "IF(OR(CI69 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI69+1))",
    "EP69": "IF(OR($AO$25, CJ69 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ69+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE213,BU69),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL69, 1),\n  DPM, (1+$DI69*CardRangeMastery*$DJ69*$AQ$9),\n  SuperTower, $DL69,\n  Rend, $DN69,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69, $DB69), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR69,\n  SM, $DT69,\n  SLM, $DU69,\n  SL, $DQ69,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM69, UltCritCard),\n\nCY69*(DE69*OtherDamage*SL+UwDamage*DF69)))",
    "EQ69": "IF(OR(CK69 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK69+1)*1%, 1),\n  CF, $DB69,\n  CC, MIN(100%, $CZ69 + 1%),\n  CCUW, DA69 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ214,BZ69) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC69 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR69,\n  CL, $DS69,\n  SM, $DT69,\n  SLM, $DU69,\n  SL, $DQ69,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM69, UltCritCard),\n\nCY69 * (Critical*DO69*SL+UwDamage*UWCritical)))",
    "ER69": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL69 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH214,BX69),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL69+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI69*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM214,CC69), $DV69, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH69,\n  Rapid, DG69,\n  SuperTower, $DL69,\n  Rend, $DN69,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM69,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69, $DB69), 1),\n\n  DW, $DR69,\n  CL, $DS69,\n  SM, $DT69,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY69*(DE69*OtherDamage*SL+UWDamage*DF69)))",
    "ES69": "IF(OR(CM69 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH69,\n  Rapid, DG69,\n  RDPM, (1+$DI69*$DJ69*$AQ$9),\n  Rend, $DN69,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK214,CA69),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM69+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69, $DB69), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR69,\n  CL, $DS69,\n  SM, $DT69,\n  SLM, $DU69,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY69*(DE69*OtherDamage*SL+UwDamage*DF69)))",
    "ET69": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN69 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM69,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN69+1, $DB69), 1),\n\n  DW, $DR69,\n  CL, $DS69,\n  SM, $DT69,\n  SLM, $DU69,\n  SL, $DQ69,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY69*(DE69*DO69*SL+UWDamage*DF69)))",
    "EU69": "IF(OR(NOT($BA$3), NOT($BA$23), $CO69 > $BA$15), \"\", 1 + 0.5*(CO69+1))",
    "EW69": "IF(DZ69=\"\", \"\", LET(\n  Now, CT69,\n  Next, DZ69,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT69),\nFactor/Cost))",
    "EX69": "IF(EA69=\"\",\"\",(EA69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU69))",
    "EY69": "IF(EB69=\"\",\"\",(EB69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV69))",
    "EZ69": "IF(EC69=\"\",\"\",(EC69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW69))",
    "FA69": "IF(ED69=\"\",\"\",(ED69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX69))",
    "FB69": "IF(EE69=\"\",\"\",(EE69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY69))",
    "FC69": "IF(EF69=\"\",\"\",(EF69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ69))",
    "FD69": "IF(EG69=\"\",\"\",(EG69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA69))",
    "FE69": "IF(EH69=\"\",\"\",(EH69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB69))",
    "FF69": "IF(EI69=\"\",\"\",(EI69/$DX69-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC69+1, 1, CC69))))",
    "FG69": "IF(EJ69=\"\",\"\",(EJ69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD69))",
    "FH69": "IF(EK69=\"\",\"\",(EK69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE69))",
    "FI69": "IF(EL69=\"\",\"\",(EL69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF69))",
    "FJ69": "IF(EM69=\"\", \"\", LET(\n  Now, CW69,\n  Next, EM69,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG69),\nFactor/Cost))",
    "FK69": "IF(EN69=\"\",\"\",(EN69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH69))",
    "FL69": "IF(EO69=\"\", \"\", LET(\n  Now, CS69,\n  Next, EO69,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI69),\nFactor/Cost))",
    "FM69": "IF(EP69=\"\",\"\",(EP69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ69))",
    "FN69": "IF(EQ69=\"\",\"\",(EQ69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK69))",
    "FO69": "IF(ER69=\"\",\"\",(ER69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL69))",
    "FP69": "IF(ES69=\"\",\"\",(ES69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM69))",
    "FQ69": "IF(ET69=\"\",\"\",(ET69/$DX69-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN69))",
    "FR69": "IF(EU69=\"\", \"\", LET(\n  Now, CX69,\n  Next, EU69,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO69),\nFactor/Cost))",
    "FT69": "IF(COLUMN(EW69:FR69) = MIN(IF(EW69:FR69=MAX(EW69:FR69), COLUMN(EW69:FR69))), 1, \"\")",
    "D70": "IF(SUM(FT69:GP69),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F70)),\"Card Mastery\",F70),G70)/$D$5,\"\")",
    "F70": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT69:GP69),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT69:GP69=1)),)\"),\"Critical Factor\")",
    "G70": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT69:GP69),ARRAYFORMULA(FILTER(BT69:CP69 , FT69:GP69=1)),\"\"\"\")\"),18.0)",
    "I70": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT69:GP69),ARRAYFORMULA(FILTER(EW69:FS69 , FT69:GP69=1))*D$5,\"\"\"\")\"),0.02538135718309172)",
    "K70": "IF(H70<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D70)),)",
    "BC70": "BC69+1",
    "BD70": "BD69+BD$3",
    "BE70": "BE69+BE$3",
    "BF70": "BF69+BF$3",
    "BG70": "BG69+BG$3",
    "BH70": "BH69+BH$3",
    "BT70": "BT69+FT69",
    "BU70": "BU69+FU69",
    "BV70": "BV69+FV69",
    "BW70": "BW69+FW69",
    "BX70": "BX69+FX69",
    "BY70": "BY69+FY69",
    "BZ70": "BZ69+FZ69",
    "CA70": "CA69+GA69",
    "CB70": "CB69+GB69",
    "CC70": "CC69+GC69",
    "CD70": "CD69+GD69",
    "CE70": "CE69+GE69",
    "CF70": "CF69+GF69",
    "CG70": "CG69+GG69",
    "CH70": "CH69+GH69",
    "CI70": "CI69+GI69",
    "CJ70": "CJ69+GJ69",
    "CK70": "CK69+GK69",
    "CL70": "CL69+GL69",
    "CM70": "CM69+GM69",
    "CN70": "CN69+GN69",
    "CO70": "CO69+GO69",
    "CS70": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI70,1)",
    "CT70": "INDEX($BD$5:$BD215,BT70)",
    "CU70": "INDEX($BN$5:$BN215,CD70)",
    "CV70": "INDEX($BO$5:$BO215,CE70)",
    "CW70": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG70)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX70": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO70, 1)",
    "CY70": "LET(\n  Base, $CR$6,\n  Damage, $CT70,\n  DamageMastery, $CS70,\n  DemonMastery, $CX70,\n  SPB, $CU70,\n  ITO, $CV70,\n  Shock, $CW70,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ70": "MIN(100%, DA70)",
    "DA70": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK70*1%, 0)",
    "DB70": "LET(\n  Lab, 1+INDEX($BF$5:$BF215,BV70),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC70": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK70*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI215,BY70) + CardCritMastery)",
    "DD70": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK70*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ215,BZ70) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE70": "LET(\n  CF, $DB70,\n  CC, $CZ70,\n  SCM, $DD70,\n  SCC, $DC70,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF70": "LET(\n  CF, $DB70,\n  CC, $DA70,\n  SCM, $DD70,\n  SCC, $DC70,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG70": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH70)), 0)",
    "DH70": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ70*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE215,BU70),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI70": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG215, BW70), 1) + $AE$9)",
    "DJ70": "LET(\n  DpmLab, INDEX($BH$5:$BH215,BX70),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL70, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK70": "(1+$DI70*$DJ70*$AQ$9)",
    "DL70": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK215,CA70),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM70*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM70": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK215,CA70),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM70*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN70": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL215,CB70)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO70": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH70,\n  Rapid, DG70,\n  RDPM, DK70,\n  SuperTower, $DL70,\n  Rend, $DN70,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP70": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ70": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK70),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR70": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP70),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF70-1))",
    "DS70": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG70, DH70),0))",
    "DT70": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP70),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV70, $AR$29), 0))",
    "DU70": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK70),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM215,CC70), $DV70, $AR$29), 0))",
    "DV70": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH70), $AO$29)",
    "DW70": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM70,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70, $DB70), 1),\n\n  DW, $DR70,\n  CL, $DS70,\n  SM, $DT70,\n  SLM, $DU70,\n  SL, $DQ70,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX70": "CY70*(DE70*DO70*DQ70+DW70*DF70)",
    "DZ70": "IF(INDEX($BD$6:$BD215,BT70)=\"\", \"\", INDEX($BD$5:$BD215,BT70+1))",
    "EA70": "IF(OR($AO$25, INDEX($BE$6:$BE215,BU70)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ70)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE215,BU70+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI70*$DJ70*$AQ$9),\n  SuperTower, $DL70,\n  Rend, $DN70,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70, $DB70), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR70,\n  SM, $DT70,\n  SLM, $DU70,\n  SL, $DQ70,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM70, UltCritCard),\n\nCY70*(DE70*OtherDamage*SL+UwDamage*DF70)))",
    "EB70": "IF(INDEX($BF$6:$BF215,BV70)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF215,BV70+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ70,\n  CCUW, $DA70,\n  SCM, $DD70,\n  SCC, $DC70,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70, CF), 1),\n\n  DW, $DR70,\n  CL, $DS70,\n  SM, $DT70,\n  SLM, $DU70,\n  SL, $DQ70,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM70, UltCritCard),\n\nCY70 * (Critical * DO70 * SL + UwDamage * UWCritical)))",
    "EC70": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG215,BW70)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH70,\n  Rapid, DG70,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG215, BW70+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ70*$AQ$9),\n  SuperTower, $DL70,\n  Rend, $DN70,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM215,CC70), $DV70, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM70,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70, $DB70), 1),\n\n  DW, $DR70,\n  CL, $DS70,\n  SM, $DT70,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY70*(DE70*OtherDamage*SL+UWDamage*DF70)))",
    "ED70": "IF(OR($AO$25, INDEX($BH$6:$BH215,BX70)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH215,BX70+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL70, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI70*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM215,CC70), $DV70, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH70,\n  Rapid, DG70,\n  SuperTower, $DL70,\n  Rend, $DN70,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM70,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70, $DB70), 1),\n\n  DW, $DR70,\n  CL, $DS70,\n  SM, $DT70,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY70*(DE70*OtherDamage*SL+UWDamage*DF70)))",
    "EE70": "IF(INDEX($BI$6:$BI215,BY70)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK70, 0),\n  CF, $DB70,\n  CC, $CZ70,\n  CCUW, $DA70,\n  SCM, $DD70,\n  SCC, $AV$17+INDEX($BI$5:$BI215,BY70+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY70 * (Critical*DO70*$DQ70+DW70*UWCritical)))",
    "EF70": "IF(INDEX($BJ$6:$BJ215,BZ70)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK70*1%, 1),\n  CF, $DB70,\n  CC, $CZ70,\n  CCUW, $DA70,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ215,BZ70+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC70,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY70*(Critical*DO70*$DQ70+DW70*UWCritical)))",
    "EG70": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK215,CA70)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH70,\n  Rapid, DG70,\n  DPM, (1+$DI70*$DJ70*$AQ$9),\n  Rend, $DN70,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK215,CA70+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM70*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70, $DB70), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK215,CA70+1)-1))/(45-CM70*3),1),\n\n  SL, $DQ70,\n  DW, $DR70,\n  CL, $DS70,\n  SM, $DT70,\n  SLM, $DU70,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY70*(DE70*OtherDamage*SL+UwDamage*DF70)))",
    "EH70": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL215,CB70+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL215,CB70)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH70,\n  Rapid, DG70,\n  DPM, (1+$DI70*$DJ70*$AQ$9),\n  SuperTower, $DL70,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL215,CB70+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY70*(DE70*OtherDamage*$DQ70+DW70*DF70)))",
    "EI70": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM215,CC70)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70, $DB70), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK70),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV70, $AR$29), 0),\n\n  DW, $DR70,\n  CL, $DS70,\n  SM, $DT70,\n  SL, $DQ70,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM70, UltCritCard),\nCY70*(DE70*DO70*SL+UwDamage*DF70)))",
    "EJ70": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN215,CD70)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT70,\n  DamageMastery, $CS70,\n  DemonMastery, $CX70,\n  SPB, INDEX($BN$5:$BN215,CD70+1),\n  ITO, $CV70,\n  Shock, $CW70,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE70*DO70*$DQ70+DW70*DF70)))",
    "EK70": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO215,CE70)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT70,\n  DamageMastery, $CS70,\n  DemonMastery, $CX70,\n  SPB, $CU70,\n  ITO, INDEX($BO$5:$BO215,CE70+1),\n  Shock, $CW70,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE70*DO70*$DQ70+DW70*DF70)))",
    "EL70": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP215,CF70)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70, $DB70), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP70),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF70),\n  CL, $DS70,\n  SM, $DT70,\n  SLM, $DU70,\n  SL, $DQ70,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM70, UltCritCard),\nCY70*(DE70*DO70*SL+UwDamage*DF70)))",
    "EM70": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ215,CG70)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG70+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN70": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR215,CH70)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70, $DB70), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH70+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP70),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK70),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM215,CC70), SMHeat, $AR$29), 0),\n\n  DW, $DR70,\n  CL, $DS70,\n  SL, $DQ70,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM70, UltCritCard),\nCY70*(DE70*DO70*SL+UwDamage*DF70)))",
    "EO70": "IF(OR(CI70 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI70+1))",
    "EP70": "IF(OR($AO$25, CJ70 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ70+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE214,BU70),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL70, 1),\n  DPM, (1+$DI70*CardRangeMastery*$DJ70*$AQ$9),\n  SuperTower, $DL70,\n  Rend, $DN70,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70, $DB70), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR70,\n  SM, $DT70,\n  SLM, $DU70,\n  SL, $DQ70,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM70, UltCritCard),\n\nCY70*(DE70*OtherDamage*SL+UwDamage*DF70)))",
    "EQ70": "IF(OR(CK70 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK70+1)*1%, 1),\n  CF, $DB70,\n  CC, MIN(100%, $CZ70 + 1%),\n  CCUW, DA70 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ215,BZ70) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC70 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR70,\n  CL, $DS70,\n  SM, $DT70,\n  SLM, $DU70,\n  SL, $DQ70,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM70, UltCritCard),\n\nCY70 * (Critical*DO70*SL+UwDamage*UWCritical)))",
    "ER70": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL70 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH215,BX70),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL70+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI70*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM215,CC70), $DV70, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH70,\n  Rapid, DG70,\n  SuperTower, $DL70,\n  Rend, $DN70,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM70,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70, $DB70), 1),\n\n  DW, $DR70,\n  CL, $DS70,\n  SM, $DT70,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY70*(DE70*OtherDamage*SL+UWDamage*DF70)))",
    "ES70": "IF(OR(CM70 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH70,\n  Rapid, DG70,\n  RDPM, (1+$DI70*$DJ70*$AQ$9),\n  Rend, $DN70,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK215,CA70),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM70+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70, $DB70), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR70,\n  CL, $DS70,\n  SM, $DT70,\n  SLM, $DU70,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY70*(DE70*OtherDamage*SL+UwDamage*DF70)))",
    "ET70": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN70 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM70,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN70+1, $DB70), 1),\n\n  DW, $DR70,\n  CL, $DS70,\n  SM, $DT70,\n  SLM, $DU70,\n  SL, $DQ70,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY70*(DE70*DO70*SL+UWDamage*DF70)))",
    "EU70": "IF(OR(NOT($BA$3), NOT($BA$23), $CO70 > $BA$15), \"\", 1 + 0.5*(CO70+1))",
    "EW70": "IF(DZ70=\"\", \"\", LET(\n  Now, CT70,\n  Next, DZ70,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT70),\nFactor/Cost))",
    "EX70": "IF(EA70=\"\",\"\",(EA70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU70))",
    "EY70": "IF(EB70=\"\",\"\",(EB70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV70))",
    "EZ70": "IF(EC70=\"\",\"\",(EC70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW70))",
    "FA70": "IF(ED70=\"\",\"\",(ED70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX70))",
    "FB70": "IF(EE70=\"\",\"\",(EE70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY70))",
    "FC70": "IF(EF70=\"\",\"\",(EF70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ70))",
    "FD70": "IF(EG70=\"\",\"\",(EG70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA70))",
    "FE70": "IF(EH70=\"\",\"\",(EH70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB70))",
    "FF70": "IF(EI70=\"\",\"\",(EI70/$DX70-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC70+1, 1, CC70))))",
    "FG70": "IF(EJ70=\"\",\"\",(EJ70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD70))",
    "FH70": "IF(EK70=\"\",\"\",(EK70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE70))",
    "FI70": "IF(EL70=\"\",\"\",(EL70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF70))",
    "FJ70": "IF(EM70=\"\", \"\", LET(\n  Now, CW70,\n  Next, EM70,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG70),\nFactor/Cost))",
    "FK70": "IF(EN70=\"\",\"\",(EN70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH70))",
    "FL70": "IF(EO70=\"\", \"\", LET(\n  Now, CS70,\n  Next, EO70,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI70),\nFactor/Cost))",
    "FM70": "IF(EP70=\"\",\"\",(EP70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ70))",
    "FN70": "IF(EQ70=\"\",\"\",(EQ70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK70))",
    "FO70": "IF(ER70=\"\",\"\",(ER70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL70))",
    "FP70": "IF(ES70=\"\",\"\",(ES70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM70))",
    "FQ70": "IF(ET70=\"\",\"\",(ET70/$DX70-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN70))",
    "FR70": "IF(EU70=\"\", \"\", LET(\n  Now, CX70,\n  Next, EU70,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO70),\nFactor/Cost))",
    "FT70": "IF(COLUMN(EW70:FR70) = MIN(IF(EW70:FR70=MAX(EW70:FR70), COLUMN(EW70:FR70))), 1, \"\")",
    "D71": "IF(SUM(FT70:GP70),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F71)),\"Card Mastery\",F71),G71)/$D$5,\"\")",
    "F71": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT70:GP70),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT70:GP70=1)),)\"),\"Standard Perks Bonus\")",
    "G71": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT70:GP70),ARRAYFORMULA(FILTER(BT70:CP70 , FT70:GP70=1)),\"\"\"\")\"),3.0)",
    "I71": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT70:GP70),ARRAYFORMULA(FILTER(EW70:FS70 , FT70:GP70=1))*D$5,\"\"\"\")\"),0.02438281011886556)",
    "K71": "IF(H71<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D71)),)",
    "BC71": "BC70+1",
    "BD71": "BD70+BD$3",
    "BE71": "BE70+BE$3",
    "BF71": "BF70+BF$3",
    "BG71": "BG70+BG$3",
    "BH71": "BH70+BH$3",
    "BT71": "BT70+FT70",
    "BU71": "BU70+FU70",
    "BV71": "BV70+FV70",
    "BW71": "BW70+FW70",
    "BX71": "BX70+FX70",
    "BY71": "BY70+FY70",
    "BZ71": "BZ70+FZ70",
    "CA71": "CA70+GA70",
    "CB71": "CB70+GB70",
    "CC71": "CC70+GC70",
    "CD71": "CD70+GD70",
    "CE71": "CE70+GE70",
    "CF71": "CF70+GF70",
    "CG71": "CG70+GG70",
    "CH71": "CH70+GH70",
    "CI71": "CI70+GI70",
    "CJ71": "CJ70+GJ70",
    "CK71": "CK70+GK70",
    "CL71": "CL70+GL70",
    "CM71": "CM70+GM70",
    "CN71": "CN70+GN70",
    "CO71": "CO70+GO70",
    "CS71": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI71,1)",
    "CT71": "INDEX($BD$5:$BD216,BT71)",
    "CU71": "INDEX($BN$5:$BN216,CD71)",
    "CV71": "INDEX($BO$5:$BO216,CE71)",
    "CW71": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG71)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX71": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO71, 1)",
    "CY71": "LET(\n  Base, $CR$6,\n  Damage, $CT71,\n  DamageMastery, $CS71,\n  DemonMastery, $CX71,\n  SPB, $CU71,\n  ITO, $CV71,\n  Shock, $CW71,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ71": "MIN(100%, DA71)",
    "DA71": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK71*1%, 0)",
    "DB71": "LET(\n  Lab, 1+INDEX($BF$5:$BF216,BV71),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC71": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK71*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI216,BY71) + CardCritMastery)",
    "DD71": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK71*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ216,BZ71) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE71": "LET(\n  CF, $DB71,\n  CC, $CZ71,\n  SCM, $DD71,\n  SCC, $DC71,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF71": "LET(\n  CF, $DB71,\n  CC, $DA71,\n  SCM, $DD71,\n  SCC, $DC71,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG71": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH71)), 0)",
    "DH71": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ71*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE216,BU71),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI71": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG216, BW71), 1) + $AE$9)",
    "DJ71": "LET(\n  DpmLab, INDEX($BH$5:$BH216,BX71),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL71, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK71": "(1+$DI71*$DJ71*$AQ$9)",
    "DL71": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK216,CA71),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM71*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM71": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK216,CA71),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM71*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN71": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL216,CB71)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO71": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH71,\n  Rapid, DG71,\n  RDPM, DK71,\n  SuperTower, $DL71,\n  Rend, $DN71,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP71": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ71": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK71),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR71": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP71),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF71-1))",
    "DS71": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG71, DH71),0))",
    "DT71": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP71),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV71, $AR$29), 0))",
    "DU71": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK71),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM216,CC71), $DV71, $AR$29), 0))",
    "DV71": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH71), $AO$29)",
    "DW71": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM71,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71, $DB71), 1),\n\n  DW, $DR71,\n  CL, $DS71,\n  SM, $DT71,\n  SLM, $DU71,\n  SL, $DQ71,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX71": "CY71*(DE71*DO71*DQ71+DW71*DF71)",
    "DZ71": "IF(INDEX($BD$6:$BD216,BT71)=\"\", \"\", INDEX($BD$5:$BD216,BT71+1))",
    "EA71": "IF(OR($AO$25, INDEX($BE$6:$BE216,BU71)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ71)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE216,BU71+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI71*$DJ71*$AQ$9),\n  SuperTower, $DL71,\n  Rend, $DN71,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71, $DB71), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR71,\n  SM, $DT71,\n  SLM, $DU71,\n  SL, $DQ71,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM71, UltCritCard),\n\nCY71*(DE71*OtherDamage*SL+UwDamage*DF71)))",
    "EB71": "IF(INDEX($BF$6:$BF216,BV71)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF216,BV71+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ71,\n  CCUW, $DA71,\n  SCM, $DD71,\n  SCC, $DC71,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71, CF), 1),\n\n  DW, $DR71,\n  CL, $DS71,\n  SM, $DT71,\n  SLM, $DU71,\n  SL, $DQ71,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM71, UltCritCard),\n\nCY71 * (Critical * DO71 * SL + UwDamage * UWCritical)))",
    "EC71": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG216,BW71)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH71,\n  Rapid, DG71,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG216, BW71+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ71*$AQ$9),\n  SuperTower, $DL71,\n  Rend, $DN71,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM216,CC71), $DV71, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM71,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71, $DB71), 1),\n\n  DW, $DR71,\n  CL, $DS71,\n  SM, $DT71,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY71*(DE71*OtherDamage*SL+UWDamage*DF71)))",
    "ED71": "IF(OR($AO$25, INDEX($BH$6:$BH216,BX71)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH216,BX71+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL71, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI71*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM216,CC71), $DV71, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH71,\n  Rapid, DG71,\n  SuperTower, $DL71,\n  Rend, $DN71,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM71,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71, $DB71), 1),\n\n  DW, $DR71,\n  CL, $DS71,\n  SM, $DT71,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY71*(DE71*OtherDamage*SL+UWDamage*DF71)))",
    "EE71": "IF(INDEX($BI$6:$BI216,BY71)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK71, 0),\n  CF, $DB71,\n  CC, $CZ71,\n  CCUW, $DA71,\n  SCM, $DD71,\n  SCC, $AV$17+INDEX($BI$5:$BI216,BY71+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY71 * (Critical*DO71*$DQ71+DW71*UWCritical)))",
    "EF71": "IF(INDEX($BJ$6:$BJ216,BZ71)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK71*1%, 1),\n  CF, $DB71,\n  CC, $CZ71,\n  CCUW, $DA71,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ216,BZ71+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC71,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY71*(Critical*DO71*$DQ71+DW71*UWCritical)))",
    "EG71": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK216,CA71)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH71,\n  Rapid, DG71,\n  DPM, (1+$DI71*$DJ71*$AQ$9),\n  Rend, $DN71,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK216,CA71+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM71*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71, $DB71), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK216,CA71+1)-1))/(45-CM71*3),1),\n\n  SL, $DQ71,\n  DW, $DR71,\n  CL, $DS71,\n  SM, $DT71,\n  SLM, $DU71,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY71*(DE71*OtherDamage*SL+UwDamage*DF71)))",
    "EH71": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL216,CB71+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL216,CB71)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH71,\n  Rapid, DG71,\n  DPM, (1+$DI71*$DJ71*$AQ$9),\n  SuperTower, $DL71,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL216,CB71+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY71*(DE71*OtherDamage*$DQ71+DW71*DF71)))",
    "EI71": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM216,CC71)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71, $DB71), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK71),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV71, $AR$29), 0),\n\n  DW, $DR71,\n  CL, $DS71,\n  SM, $DT71,\n  SL, $DQ71,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM71, UltCritCard),\nCY71*(DE71*DO71*SL+UwDamage*DF71)))",
    "EJ71": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN216,CD71)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT71,\n  DamageMastery, $CS71,\n  DemonMastery, $CX71,\n  SPB, INDEX($BN$5:$BN216,CD71+1),\n  ITO, $CV71,\n  Shock, $CW71,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE71*DO71*$DQ71+DW71*DF71)))",
    "EK71": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO216,CE71)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT71,\n  DamageMastery, $CS71,\n  DemonMastery, $CX71,\n  SPB, $CU71,\n  ITO, INDEX($BO$5:$BO216,CE71+1),\n  Shock, $CW71,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE71*DO71*$DQ71+DW71*DF71)))",
    "EL71": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP216,CF71)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71, $DB71), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP71),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF71),\n  CL, $DS71,\n  SM, $DT71,\n  SLM, $DU71,\n  SL, $DQ71,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM71, UltCritCard),\nCY71*(DE71*DO71*SL+UwDamage*DF71)))",
    "EM71": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ216,CG71)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG71+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN71": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR216,CH71)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71, $DB71), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH71+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP71),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK71),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM216,CC71), SMHeat, $AR$29), 0),\n\n  DW, $DR71,\n  CL, $DS71,\n  SL, $DQ71,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM71, UltCritCard),\nCY71*(DE71*DO71*SL+UwDamage*DF71)))",
    "EO71": "IF(OR(CI71 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI71+1))",
    "EP71": "IF(OR($AO$25, CJ71 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ71+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE215,BU71),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL71, 1),\n  DPM, (1+$DI71*CardRangeMastery*$DJ71*$AQ$9),\n  SuperTower, $DL71,\n  Rend, $DN71,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71, $DB71), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR71,\n  SM, $DT71,\n  SLM, $DU71,\n  SL, $DQ71,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM71, UltCritCard),\n\nCY71*(DE71*OtherDamage*SL+UwDamage*DF71)))",
    "EQ71": "IF(OR(CK71 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK71+1)*1%, 1),\n  CF, $DB71,\n  CC, MIN(100%, $CZ71 + 1%),\n  CCUW, DA71 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ216,BZ71) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC71 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR71,\n  CL, $DS71,\n  SM, $DT71,\n  SLM, $DU71,\n  SL, $DQ71,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM71, UltCritCard),\n\nCY71 * (Critical*DO71*SL+UwDamage*UWCritical)))",
    "ER71": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL71 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH216,BX71),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL71+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI71*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM216,CC71), $DV71, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH71,\n  Rapid, DG71,\n  SuperTower, $DL71,\n  Rend, $DN71,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM71,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71, $DB71), 1),\n\n  DW, $DR71,\n  CL, $DS71,\n  SM, $DT71,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY71*(DE71*OtherDamage*SL+UWDamage*DF71)))",
    "ES71": "IF(OR(CM71 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH71,\n  Rapid, DG71,\n  RDPM, (1+$DI71*$DJ71*$AQ$9),\n  Rend, $DN71,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK216,CA71),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM71+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71, $DB71), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR71,\n  CL, $DS71,\n  SM, $DT71,\n  SLM, $DU71,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY71*(DE71*OtherDamage*SL+UwDamage*DF71)))",
    "ET71": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN71 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM71,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN71+1, $DB71), 1),\n\n  DW, $DR71,\n  CL, $DS71,\n  SM, $DT71,\n  SLM, $DU71,\n  SL, $DQ71,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY71*(DE71*DO71*SL+UWDamage*DF71)))",
    "EU71": "IF(OR(NOT($BA$3), NOT($BA$23), $CO71 > $BA$15), \"\", 1 + 0.5*(CO71+1))",
    "EW71": "IF(DZ71=\"\", \"\", LET(\n  Now, CT71,\n  Next, DZ71,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT71),\nFactor/Cost))",
    "EX71": "IF(EA71=\"\",\"\",(EA71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU71))",
    "EY71": "IF(EB71=\"\",\"\",(EB71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV71))",
    "EZ71": "IF(EC71=\"\",\"\",(EC71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW71))",
    "FA71": "IF(ED71=\"\",\"\",(ED71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX71))",
    "FB71": "IF(EE71=\"\",\"\",(EE71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY71))",
    "FC71": "IF(EF71=\"\",\"\",(EF71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ71))",
    "FD71": "IF(EG71=\"\",\"\",(EG71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA71))",
    "FE71": "IF(EH71=\"\",\"\",(EH71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB71))",
    "FF71": "IF(EI71=\"\",\"\",(EI71/$DX71-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC71+1, 1, CC71))))",
    "FG71": "IF(EJ71=\"\",\"\",(EJ71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD71))",
    "FH71": "IF(EK71=\"\",\"\",(EK71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE71))",
    "FI71": "IF(EL71=\"\",\"\",(EL71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF71))",
    "FJ71": "IF(EM71=\"\", \"\", LET(\n  Now, CW71,\n  Next, EM71,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG71),\nFactor/Cost))",
    "FK71": "IF(EN71=\"\",\"\",(EN71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH71))",
    "FL71": "IF(EO71=\"\", \"\", LET(\n  Now, CS71,\n  Next, EO71,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI71),\nFactor/Cost))",
    "FM71": "IF(EP71=\"\",\"\",(EP71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ71))",
    "FN71": "IF(EQ71=\"\",\"\",(EQ71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK71))",
    "FO71": "IF(ER71=\"\",\"\",(ER71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL71))",
    "FP71": "IF(ES71=\"\",\"\",(ES71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM71))",
    "FQ71": "IF(ET71=\"\",\"\",(ET71/$DX71-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN71))",
    "FR71": "IF(EU71=\"\", \"\", LET(\n  Now, CX71,\n  Next, EU71,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO71),\nFactor/Cost))",
    "FT71": "IF(COLUMN(EW71:FR71) = MIN(IF(EW71:FR71=MAX(EW71:FR71), COLUMN(EW71:FR71))), 1, \"\")",
    "D72": "IF(SUM(FT71:GP71),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F72)),\"Card Mastery\",F72),G72)/$D$5,\"\")",
    "F72": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT71:GP71),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT71:GP71=1)),)\"),\"Damage / Meter\")",
    "G72": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT71:GP71),ARRAYFORMULA(FILTER(BT71:CP71 , FT71:GP71=1)),\"\"\"\")\"),12.0)",
    "I72": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT71:GP71),ARRAYFORMULA(FILTER(EW71:FS71 , FT71:GP71=1))*D$5,\"\"\"\")\"),0.024269140741786994)",
    "K72": "IF(H72<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D72)),)",
    "BC72": "BC71+1",
    "BD72": "BD71+BD$3",
    "BE72": "BE71+BE$3",
    "BF72": "BF71+BF$3",
    "BG72": "BG71+BG$3",
    "BH72": "BH71+BH$3",
    "BT72": "BT71+FT71",
    "BU72": "BU71+FU71",
    "BV72": "BV71+FV71",
    "BW72": "BW71+FW71",
    "BX72": "BX71+FX71",
    "BY72": "BY71+FY71",
    "BZ72": "BZ71+FZ71",
    "CA72": "CA71+GA71",
    "CB72": "CB71+GB71",
    "CC72": "CC71+GC71",
    "CD72": "CD71+GD71",
    "CE72": "CE71+GE71",
    "CF72": "CF71+GF71",
    "CG72": "CG71+GG71",
    "CH72": "CH71+GH71",
    "CI72": "CI71+GI71",
    "CJ72": "CJ71+GJ71",
    "CK72": "CK71+GK71",
    "CL72": "CL71+GL71",
    "CM72": "CM71+GM71",
    "CN72": "CN71+GN71",
    "CO72": "CO71+GO71",
    "CS72": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI72,1)",
    "CT72": "INDEX($BD$5:$BD217,BT72)",
    "CU72": "INDEX($BN$5:$BN217,CD72)",
    "CV72": "INDEX($BO$5:$BO217,CE72)",
    "CW72": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG72)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX72": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO72, 1)",
    "CY72": "LET(\n  Base, $CR$6,\n  Damage, $CT72,\n  DamageMastery, $CS72,\n  DemonMastery, $CX72,\n  SPB, $CU72,\n  ITO, $CV72,\n  Shock, $CW72,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ72": "MIN(100%, DA72)",
    "DA72": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK72*1%, 0)",
    "DB72": "LET(\n  Lab, 1+INDEX($BF$5:$BF217,BV72),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC72": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK72*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI217,BY72) + CardCritMastery)",
    "DD72": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK72*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ217,BZ72) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE72": "LET(\n  CF, $DB72,\n  CC, $CZ72,\n  SCM, $DD72,\n  SCC, $DC72,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF72": "LET(\n  CF, $DB72,\n  CC, $DA72,\n  SCM, $DD72,\n  SCC, $DC72,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG72": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH72)), 0)",
    "DH72": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ72*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE217,BU72),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI72": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG217, BW72), 1) + $AE$9)",
    "DJ72": "LET(\n  DpmLab, INDEX($BH$5:$BH217,BX72),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL72, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK72": "(1+$DI72*$DJ72*$AQ$9)",
    "DL72": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK217,CA72),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM72*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM72": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK217,CA72),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM72*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN72": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL217,CB72)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO72": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH72,\n  Rapid, DG72,\n  RDPM, DK72,\n  SuperTower, $DL72,\n  Rend, $DN72,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP72": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ72": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK72),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR72": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP72),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF72-1))",
    "DS72": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG72, DH72),0))",
    "DT72": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP72),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV72, $AR$29), 0))",
    "DU72": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK72),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM217,CC72), $DV72, $AR$29), 0))",
    "DV72": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH72), $AO$29)",
    "DW72": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM72,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72, $DB72), 1),\n\n  DW, $DR72,\n  CL, $DS72,\n  SM, $DT72,\n  SLM, $DU72,\n  SL, $DQ72,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX72": "CY72*(DE72*DO72*DQ72+DW72*DF72)",
    "DZ72": "IF(INDEX($BD$6:$BD217,BT72)=\"\", \"\", INDEX($BD$5:$BD217,BT72+1))",
    "EA72": "IF(OR($AO$25, INDEX($BE$6:$BE217,BU72)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ72)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE217,BU72+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI72*$DJ72*$AQ$9),\n  SuperTower, $DL72,\n  Rend, $DN72,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72, $DB72), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR72,\n  SM, $DT72,\n  SLM, $DU72,\n  SL, $DQ72,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM72, UltCritCard),\n\nCY72*(DE72*OtherDamage*SL+UwDamage*DF72)))",
    "EB72": "IF(INDEX($BF$6:$BF217,BV72)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF217,BV72+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ72,\n  CCUW, $DA72,\n  SCM, $DD72,\n  SCC, $DC72,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72, CF), 1),\n\n  DW, $DR72,\n  CL, $DS72,\n  SM, $DT72,\n  SLM, $DU72,\n  SL, $DQ72,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM72, UltCritCard),\n\nCY72 * (Critical * DO72 * SL + UwDamage * UWCritical)))",
    "EC72": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG217,BW72)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH72,\n  Rapid, DG72,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG217, BW72+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ72*$AQ$9),\n  SuperTower, $DL72,\n  Rend, $DN72,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM217,CC72), $DV72, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM72,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72, $DB72), 1),\n\n  DW, $DR72,\n  CL, $DS72,\n  SM, $DT72,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY72*(DE72*OtherDamage*SL+UWDamage*DF72)))",
    "ED72": "IF(OR($AO$25, INDEX($BH$6:$BH217,BX72)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH217,BX72+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL72, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI72*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM217,CC72), $DV72, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH72,\n  Rapid, DG72,\n  SuperTower, $DL72,\n  Rend, $DN72,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM72,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72, $DB72), 1),\n\n  DW, $DR72,\n  CL, $DS72,\n  SM, $DT72,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY72*(DE72*OtherDamage*SL+UWDamage*DF72)))",
    "EE72": "IF(INDEX($BI$6:$BI217,BY72)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK72, 0),\n  CF, $DB72,\n  CC, $CZ72,\n  CCUW, $DA72,\n  SCM, $DD72,\n  SCC, $AV$17+INDEX($BI$5:$BI217,BY72+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY72 * (Critical*DO72*$DQ72+DW72*UWCritical)))",
    "EF72": "IF(INDEX($BJ$6:$BJ217,BZ72)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK72*1%, 1),\n  CF, $DB72,\n  CC, $CZ72,\n  CCUW, $DA72,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ217,BZ72+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC72,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY72*(Critical*DO72*$DQ72+DW72*UWCritical)))",
    "EG72": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK217,CA72)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH72,\n  Rapid, DG72,\n  DPM, (1+$DI72*$DJ72*$AQ$9),\n  Rend, $DN72,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK217,CA72+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM72*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72, $DB72), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK217,CA72+1)-1))/(45-CM72*3),1),\n\n  SL, $DQ72,\n  DW, $DR72,\n  CL, $DS72,\n  SM, $DT72,\n  SLM, $DU72,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY72*(DE72*OtherDamage*SL+UwDamage*DF72)))",
    "EH72": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL217,CB72+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL217,CB72)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH72,\n  Rapid, DG72,\n  DPM, (1+$DI72*$DJ72*$AQ$9),\n  SuperTower, $DL72,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL217,CB72+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY72*(DE72*OtherDamage*$DQ72+DW72*DF72)))",
    "EI72": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM217,CC72)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72, $DB72), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK72),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV72, $AR$29), 0),\n\n  DW, $DR72,\n  CL, $DS72,\n  SM, $DT72,\n  SL, $DQ72,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM72, UltCritCard),\nCY72*(DE72*DO72*SL+UwDamage*DF72)))",
    "EJ72": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN217,CD72)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT72,\n  DamageMastery, $CS72,\n  DemonMastery, $CX72,\n  SPB, INDEX($BN$5:$BN217,CD72+1),\n  ITO, $CV72,\n  Shock, $CW72,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE72*DO72*$DQ72+DW72*DF72)))",
    "EK72": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO217,CE72)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT72,\n  DamageMastery, $CS72,\n  DemonMastery, $CX72,\n  SPB, $CU72,\n  ITO, INDEX($BO$5:$BO217,CE72+1),\n  Shock, $CW72,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE72*DO72*$DQ72+DW72*DF72)))",
    "EL72": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP217,CF72)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72, $DB72), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP72),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF72),\n  CL, $DS72,\n  SM, $DT72,\n  SLM, $DU72,\n  SL, $DQ72,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM72, UltCritCard),\nCY72*(DE72*DO72*SL+UwDamage*DF72)))",
    "EM72": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ217,CG72)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG72+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN72": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR217,CH72)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72, $DB72), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH72+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP72),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK72),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM217,CC72), SMHeat, $AR$29), 0),\n\n  DW, $DR72,\n  CL, $DS72,\n  SL, $DQ72,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM72, UltCritCard),\nCY72*(DE72*DO72*SL+UwDamage*DF72)))",
    "EO72": "IF(OR(CI72 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI72+1))",
    "EP72": "IF(OR($AO$25, CJ72 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ72+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE216,BU72),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL72, 1),\n  DPM, (1+$DI72*CardRangeMastery*$DJ72*$AQ$9),\n  SuperTower, $DL72,\n  Rend, $DN72,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72, $DB72), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR72,\n  SM, $DT72,\n  SLM, $DU72,\n  SL, $DQ72,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM72, UltCritCard),\n\nCY72*(DE72*OtherDamage*SL+UwDamage*DF72)))",
    "EQ72": "IF(OR(CK72 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK72+1)*1%, 1),\n  CF, $DB72,\n  CC, MIN(100%, $CZ72 + 1%),\n  CCUW, DA72 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ217,BZ72) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC72 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR72,\n  CL, $DS72,\n  SM, $DT72,\n  SLM, $DU72,\n  SL, $DQ72,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM72, UltCritCard),\n\nCY72 * (Critical*DO72*SL+UwDamage*UWCritical)))",
    "ER72": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL72 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH217,BX72),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL72+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI72*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM217,CC72), $DV72, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH72,\n  Rapid, DG72,\n  SuperTower, $DL72,\n  Rend, $DN72,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM72,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72, $DB72), 1),\n\n  DW, $DR72,\n  CL, $DS72,\n  SM, $DT72,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY72*(DE72*OtherDamage*SL+UWDamage*DF72)))",
    "ES72": "IF(OR(CM72 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH72,\n  Rapid, DG72,\n  RDPM, (1+$DI72*$DJ72*$AQ$9),\n  Rend, $DN72,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK217,CA72),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM72+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72, $DB72), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR72,\n  CL, $DS72,\n  SM, $DT72,\n  SLM, $DU72,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY72*(DE72*OtherDamage*SL+UwDamage*DF72)))",
    "ET72": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN72 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM72,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN72+1, $DB72), 1),\n\n  DW, $DR72,\n  CL, $DS72,\n  SM, $DT72,\n  SLM, $DU72,\n  SL, $DQ72,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY72*(DE72*DO72*SL+UWDamage*DF72)))",
    "EU72": "IF(OR(NOT($BA$3), NOT($BA$23), $CO72 > $BA$15), \"\", 1 + 0.5*(CO72+1))",
    "EW72": "IF(DZ72=\"\", \"\", LET(\n  Now, CT72,\n  Next, DZ72,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT72),\nFactor/Cost))",
    "EX72": "IF(EA72=\"\",\"\",(EA72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU72))",
    "EY72": "IF(EB72=\"\",\"\",(EB72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV72))",
    "EZ72": "IF(EC72=\"\",\"\",(EC72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW72))",
    "FA72": "IF(ED72=\"\",\"\",(ED72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX72))",
    "FB72": "IF(EE72=\"\",\"\",(EE72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY72))",
    "FC72": "IF(EF72=\"\",\"\",(EF72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ72))",
    "FD72": "IF(EG72=\"\",\"\",(EG72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA72))",
    "FE72": "IF(EH72=\"\",\"\",(EH72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB72))",
    "FF72": "IF(EI72=\"\",\"\",(EI72/$DX72-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC72+1, 1, CC72))))",
    "FG72": "IF(EJ72=\"\",\"\",(EJ72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD72))",
    "FH72": "IF(EK72=\"\",\"\",(EK72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE72))",
    "FI72": "IF(EL72=\"\",\"\",(EL72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF72))",
    "FJ72": "IF(EM72=\"\", \"\", LET(\n  Now, CW72,\n  Next, EM72,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG72),\nFactor/Cost))",
    "FK72": "IF(EN72=\"\",\"\",(EN72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH72))",
    "FL72": "IF(EO72=\"\", \"\", LET(\n  Now, CS72,\n  Next, EO72,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI72),\nFactor/Cost))",
    "FM72": "IF(EP72=\"\",\"\",(EP72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ72))",
    "FN72": "IF(EQ72=\"\",\"\",(EQ72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK72))",
    "FO72": "IF(ER72=\"\",\"\",(ER72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL72))",
    "FP72": "IF(ES72=\"\",\"\",(ES72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM72))",
    "FQ72": "IF(ET72=\"\",\"\",(ET72/$DX72-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN72))",
    "FR72": "IF(EU72=\"\", \"\", LET(\n  Now, CX72,\n  Next, EU72,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO72),\nFactor/Cost))",
    "FT72": "IF(COLUMN(EW72:FR72) = MIN(IF(EW72:FR72=MAX(EW72:FR72), COLUMN(EW72:FR72))), 1, \"\")",
    "D73": "IF(SUM(FT72:GP72),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F73)),\"Card Mastery\",F73),G73)/$D$5,\"\")",
    "F73": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT72:GP72),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT72:GP72=1)),)\"),\"Damage\")",
    "G73": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT72:GP72),ARRAYFORMULA(FILTER(BT72:CP72 , FT72:GP72=1)),\"\"\"\")\"),17.0)",
    "I73": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT72:GP72),ARRAYFORMULA(FILTER(EW72:FS72 , FT72:GP72=1))*D$5,\"\"\"\")\"),0.022150438394093197)",
    "K73": "IF(H73<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D73)),)",
    "BC73": "BC72+1",
    "BD73": "BD72+BD$3",
    "BE73": "BE72+BE$3",
    "BF73": "BF72+BF$3",
    "BG73": "BG72+BG$3",
    "BH73": "BH72+BH$3",
    "BT73": "BT72+FT72",
    "BU73": "BU72+FU72",
    "BV73": "BV72+FV72",
    "BW73": "BW72+FW72",
    "BX73": "BX72+FX72",
    "BY73": "BY72+FY72",
    "BZ73": "BZ72+FZ72",
    "CA73": "CA72+GA72",
    "CB73": "CB72+GB72",
    "CC73": "CC72+GC72",
    "CD73": "CD72+GD72",
    "CE73": "CE72+GE72",
    "CF73": "CF72+GF72",
    "CG73": "CG72+GG72",
    "CH73": "CH72+GH72",
    "CI73": "CI72+GI72",
    "CJ73": "CJ72+GJ72",
    "CK73": "CK72+GK72",
    "CL73": "CL72+GL72",
    "CM73": "CM72+GM72",
    "CN73": "CN72+GN72",
    "CO73": "CO72+GO72",
    "CS73": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI73,1)",
    "CT73": "INDEX($BD$5:$BD218,BT73)",
    "CU73": "INDEX($BN$5:$BN218,CD73)",
    "CV73": "INDEX($BO$5:$BO218,CE73)",
    "CW73": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG73)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX73": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO73, 1)",
    "CY73": "LET(\n  Base, $CR$6,\n  Damage, $CT73,\n  DamageMastery, $CS73,\n  DemonMastery, $CX73,\n  SPB, $CU73,\n  ITO, $CV73,\n  Shock, $CW73,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ73": "MIN(100%, DA73)",
    "DA73": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK73*1%, 0)",
    "DB73": "LET(\n  Lab, 1+INDEX($BF$5:$BF218,BV73),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC73": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK73*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI218,BY73) + CardCritMastery)",
    "DD73": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK73*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ218,BZ73) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE73": "LET(\n  CF, $DB73,\n  CC, $CZ73,\n  SCM, $DD73,\n  SCC, $DC73,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF73": "LET(\n  CF, $DB73,\n  CC, $DA73,\n  SCM, $DD73,\n  SCC, $DC73,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG73": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH73)), 0)",
    "DH73": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ73*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE218,BU73),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI73": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG218, BW73), 1) + $AE$9)",
    "DJ73": "LET(\n  DpmLab, INDEX($BH$5:$BH218,BX73),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL73, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK73": "(1+$DI73*$DJ73*$AQ$9)",
    "DL73": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK218,CA73),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM73*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM73": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK218,CA73),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM73*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN73": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL218,CB73)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO73": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH73,\n  Rapid, DG73,\n  RDPM, DK73,\n  SuperTower, $DL73,\n  Rend, $DN73,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP73": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ73": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK73),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR73": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP73),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF73-1))",
    "DS73": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG73, DH73),0))",
    "DT73": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP73),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV73, $AR$29), 0))",
    "DU73": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK73),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM218,CC73), $DV73, $AR$29), 0))",
    "DV73": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH73), $AO$29)",
    "DW73": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM73,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73, $DB73), 1),\n\n  DW, $DR73,\n  CL, $DS73,\n  SM, $DT73,\n  SLM, $DU73,\n  SL, $DQ73,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX73": "CY73*(DE73*DO73*DQ73+DW73*DF73)",
    "DZ73": "IF(INDEX($BD$6:$BD218,BT73)=\"\", \"\", INDEX($BD$5:$BD218,BT73+1))",
    "EA73": "IF(OR($AO$25, INDEX($BE$6:$BE218,BU73)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ73)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE218,BU73+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI73*$DJ73*$AQ$9),\n  SuperTower, $DL73,\n  Rend, $DN73,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73, $DB73), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR73,\n  SM, $DT73,\n  SLM, $DU73,\n  SL, $DQ73,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM73, UltCritCard),\n\nCY73*(DE73*OtherDamage*SL+UwDamage*DF73)))",
    "EB73": "IF(INDEX($BF$6:$BF218,BV73)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF218,BV73+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ73,\n  CCUW, $DA73,\n  SCM, $DD73,\n  SCC, $DC73,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73, CF), 1),\n\n  DW, $DR73,\n  CL, $DS73,\n  SM, $DT73,\n  SLM, $DU73,\n  SL, $DQ73,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM73, UltCritCard),\n\nCY73 * (Critical * DO73 * SL + UwDamage * UWCritical)))",
    "EC73": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG218,BW73)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH73,\n  Rapid, DG73,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG218, BW73+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ73*$AQ$9),\n  SuperTower, $DL73,\n  Rend, $DN73,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM218,CC73), $DV73, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM73,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73, $DB73), 1),\n\n  DW, $DR73,\n  CL, $DS73,\n  SM, $DT73,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY73*(DE73*OtherDamage*SL+UWDamage*DF73)))",
    "ED73": "IF(OR($AO$25, INDEX($BH$6:$BH218,BX73)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH218,BX73+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL73, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI73*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM218,CC73), $DV73, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH73,\n  Rapid, DG73,\n  SuperTower, $DL73,\n  Rend, $DN73,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM73,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73, $DB73), 1),\n\n  DW, $DR73,\n  CL, $DS73,\n  SM, $DT73,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY73*(DE73*OtherDamage*SL+UWDamage*DF73)))",
    "EE73": "IF(INDEX($BI$6:$BI218,BY73)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK73, 0),\n  CF, $DB73,\n  CC, $CZ73,\n  CCUW, $DA73,\n  SCM, $DD73,\n  SCC, $AV$17+INDEX($BI$5:$BI218,BY73+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY73 * (Critical*DO73*$DQ73+DW73*UWCritical)))",
    "EF73": "IF(INDEX($BJ$6:$BJ218,BZ73)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK73*1%, 1),\n  CF, $DB73,\n  CC, $CZ73,\n  CCUW, $DA73,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ218,BZ73+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC73,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY73*(Critical*DO73*$DQ73+DW73*UWCritical)))",
    "EG73": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK218,CA73)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH73,\n  Rapid, DG73,\n  DPM, (1+$DI73*$DJ73*$AQ$9),\n  Rend, $DN73,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK218,CA73+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM73*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73, $DB73), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK218,CA73+1)-1))/(45-CM73*3),1),\n\n  SL, $DQ73,\n  DW, $DR73,\n  CL, $DS73,\n  SM, $DT73,\n  SLM, $DU73,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY73*(DE73*OtherDamage*SL+UwDamage*DF73)))",
    "EH73": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL218,CB73+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL218,CB73)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH73,\n  Rapid, DG73,\n  DPM, (1+$DI73*$DJ73*$AQ$9),\n  SuperTower, $DL73,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL218,CB73+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY73*(DE73*OtherDamage*$DQ73+DW73*DF73)))",
    "EI73": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM218,CC73)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73, $DB73), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK73),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV73, $AR$29), 0),\n\n  DW, $DR73,\n  CL, $DS73,\n  SM, $DT73,\n  SL, $DQ73,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM73, UltCritCard),\nCY73*(DE73*DO73*SL+UwDamage*DF73)))",
    "EJ73": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN218,CD73)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT73,\n  DamageMastery, $CS73,\n  DemonMastery, $CX73,\n  SPB, INDEX($BN$5:$BN218,CD73+1),\n  ITO, $CV73,\n  Shock, $CW73,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE73*DO73*$DQ73+DW73*DF73)))",
    "EK73": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO218,CE73)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT73,\n  DamageMastery, $CS73,\n  DemonMastery, $CX73,\n  SPB, $CU73,\n  ITO, INDEX($BO$5:$BO218,CE73+1),\n  Shock, $CW73,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE73*DO73*$DQ73+DW73*DF73)))",
    "EL73": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP218,CF73)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73, $DB73), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP73),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF73),\n  CL, $DS73,\n  SM, $DT73,\n  SLM, $DU73,\n  SL, $DQ73,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM73, UltCritCard),\nCY73*(DE73*DO73*SL+UwDamage*DF73)))",
    "EM73": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ218,CG73)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG73+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN73": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR218,CH73)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73, $DB73), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH73+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP73),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK73),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM218,CC73), SMHeat, $AR$29), 0),\n\n  DW, $DR73,\n  CL, $DS73,\n  SL, $DQ73,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM73, UltCritCard),\nCY73*(DE73*DO73*SL+UwDamage*DF73)))",
    "EO73": "IF(OR(CI73 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI73+1))",
    "EP73": "IF(OR($AO$25, CJ73 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ73+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE217,BU73),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL73, 1),\n  DPM, (1+$DI73*CardRangeMastery*$DJ73*$AQ$9),\n  SuperTower, $DL73,\n  Rend, $DN73,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73, $DB73), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR73,\n  SM, $DT73,\n  SLM, $DU73,\n  SL, $DQ73,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM73, UltCritCard),\n\nCY73*(DE73*OtherDamage*SL+UwDamage*DF73)))",
    "EQ73": "IF(OR(CK73 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK73+1)*1%, 1),\n  CF, $DB73,\n  CC, MIN(100%, $CZ73 + 1%),\n  CCUW, DA73 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ218,BZ73) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC73 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR73,\n  CL, $DS73,\n  SM, $DT73,\n  SLM, $DU73,\n  SL, $DQ73,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM73, UltCritCard),\n\nCY73 * (Critical*DO73*SL+UwDamage*UWCritical)))",
    "ER73": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL73 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH218,BX73),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL73+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI73*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM218,CC73), $DV73, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH73,\n  Rapid, DG73,\n  SuperTower, $DL73,\n  Rend, $DN73,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM73,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73, $DB73), 1),\n\n  DW, $DR73,\n  CL, $DS73,\n  SM, $DT73,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY73*(DE73*OtherDamage*SL+UWDamage*DF73)))",
    "ES73": "IF(OR(CM73 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH73,\n  Rapid, DG73,\n  RDPM, (1+$DI73*$DJ73*$AQ$9),\n  Rend, $DN73,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK218,CA73),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM73+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73, $DB73), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR73,\n  CL, $DS73,\n  SM, $DT73,\n  SLM, $DU73,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY73*(DE73*OtherDamage*SL+UwDamage*DF73)))",
    "ET73": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN73 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM73,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN73+1, $DB73), 1),\n\n  DW, $DR73,\n  CL, $DS73,\n  SM, $DT73,\n  SLM, $DU73,\n  SL, $DQ73,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY73*(DE73*DO73*SL+UWDamage*DF73)))",
    "EU73": "IF(OR(NOT($BA$3), NOT($BA$23), $CO73 > $BA$15), \"\", 1 + 0.5*(CO73+1))",
    "EW73": "IF(DZ73=\"\", \"\", LET(\n  Now, CT73,\n  Next, DZ73,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT73),\nFactor/Cost))",
    "EX73": "IF(EA73=\"\",\"\",(EA73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU73))",
    "EY73": "IF(EB73=\"\",\"\",(EB73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV73))",
    "EZ73": "IF(EC73=\"\",\"\",(EC73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW73))",
    "FA73": "IF(ED73=\"\",\"\",(ED73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX73))",
    "FB73": "IF(EE73=\"\",\"\",(EE73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY73))",
    "FC73": "IF(EF73=\"\",\"\",(EF73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ73))",
    "FD73": "IF(EG73=\"\",\"\",(EG73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA73))",
    "FE73": "IF(EH73=\"\",\"\",(EH73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB73))",
    "FF73": "IF(EI73=\"\",\"\",(EI73/$DX73-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC73+1, 1, CC73))))",
    "FG73": "IF(EJ73=\"\",\"\",(EJ73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD73))",
    "FH73": "IF(EK73=\"\",\"\",(EK73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE73))",
    "FI73": "IF(EL73=\"\",\"\",(EL73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF73))",
    "FJ73": "IF(EM73=\"\", \"\", LET(\n  Now, CW73,\n  Next, EM73,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG73),\nFactor/Cost))",
    "FK73": "IF(EN73=\"\",\"\",(EN73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH73))",
    "FL73": "IF(EO73=\"\", \"\", LET(\n  Now, CS73,\n  Next, EO73,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI73),\nFactor/Cost))",
    "FM73": "IF(EP73=\"\",\"\",(EP73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ73))",
    "FN73": "IF(EQ73=\"\",\"\",(EQ73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK73))",
    "FO73": "IF(ER73=\"\",\"\",(ER73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL73))",
    "FP73": "IF(ES73=\"\",\"\",(ES73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM73))",
    "FQ73": "IF(ET73=\"\",\"\",(ET73/$DX73-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN73))",
    "FR73": "IF(EU73=\"\", \"\", LET(\n  Now, CX73,\n  Next, EU73,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO73),\nFactor/Cost))",
    "FT73": "IF(COLUMN(EW73:FR73) = MIN(IF(EW73:FR73=MAX(EW73:FR73), COLUMN(EW73:FR73))), 1, \"\")",
    "D74": "IF(SUM(FT73:GP73),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F74)),\"Card Mastery\",F74),G74)/$D$5,\"\")",
    "F74": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT73:GP73),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT73:GP73=1)),)\"),\"Attack Speed\")",
    "G74": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT73:GP73),ARRAYFORMULA(FILTER(BT73:CP73 , FT73:GP73=1)),\"\"\"\")\"),17.0)",
    "I74": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT73:GP73),ARRAYFORMULA(FILTER(EW73:FS73 , FT73:GP73=1))*D$5,\"\"\"\")\"),0.022017130048433538)",
    "K74": "IF(H74<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D74)),)",
    "BC74": "BC73+1",
    "BD74": "BD73+BD$3",
    "BE74": "BE73+BE$3",
    "BF74": "BF73+BF$3",
    "BG74": "BG73+BG$3",
    "BH74": "BH73+BH$3",
    "BT74": "BT73+FT73",
    "BU74": "BU73+FU73",
    "BV74": "BV73+FV73",
    "BW74": "BW73+FW73",
    "BX74": "BX73+FX73",
    "BY74": "BY73+FY73",
    "BZ74": "BZ73+FZ73",
    "CA74": "CA73+GA73",
    "CB74": "CB73+GB73",
    "CC74": "CC73+GC73",
    "CD74": "CD73+GD73",
    "CE74": "CE73+GE73",
    "CF74": "CF73+GF73",
    "CG74": "CG73+GG73",
    "CH74": "CH73+GH73",
    "CI74": "CI73+GI73",
    "CJ74": "CJ73+GJ73",
    "CK74": "CK73+GK73",
    "CL74": "CL73+GL73",
    "CM74": "CM73+GM73",
    "CN74": "CN73+GN73",
    "CO74": "CO73+GO73",
    "CS74": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI74,1)",
    "CT74": "INDEX($BD$5:$BD219,BT74)",
    "CU74": "INDEX($BN$5:$BN219,CD74)",
    "CV74": "INDEX($BO$5:$BO219,CE74)",
    "CW74": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG74)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX74": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO74, 1)",
    "CY74": "LET(\n  Base, $CR$6,\n  Damage, $CT74,\n  DamageMastery, $CS74,\n  DemonMastery, $CX74,\n  SPB, $CU74,\n  ITO, $CV74,\n  Shock, $CW74,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ74": "MIN(100%, DA74)",
    "DA74": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK74*1%, 0)",
    "DB74": "LET(\n  Lab, 1+INDEX($BF$5:$BF219,BV74),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC74": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK74*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI219,BY74) + CardCritMastery)",
    "DD74": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK74*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ219,BZ74) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE74": "LET(\n  CF, $DB74,\n  CC, $CZ74,\n  SCM, $DD74,\n  SCC, $DC74,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF74": "LET(\n  CF, $DB74,\n  CC, $DA74,\n  SCM, $DD74,\n  SCC, $DC74,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG74": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH74)), 0)",
    "DH74": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ74*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE219,BU74),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI74": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG219, BW74), 1) + $AE$9)",
    "DJ74": "LET(\n  DpmLab, INDEX($BH$5:$BH219,BX74),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL74, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK74": "(1+$DI74*$DJ74*$AQ$9)",
    "DL74": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK219,CA74),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM74*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM74": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK219,CA74),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM74*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN74": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL219,CB74)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO74": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH74,\n  Rapid, DG74,\n  RDPM, DK74,\n  SuperTower, $DL74,\n  Rend, $DN74,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP74": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ74": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK74),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR74": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP74),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF74-1))",
    "DS74": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG74, DH74),0))",
    "DT74": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP74),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV74, $AR$29), 0))",
    "DU74": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK74),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM219,CC74), $DV74, $AR$29), 0))",
    "DV74": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH74), $AO$29)",
    "DW74": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM74,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74, $DB74), 1),\n\n  DW, $DR74,\n  CL, $DS74,\n  SM, $DT74,\n  SLM, $DU74,\n  SL, $DQ74,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX74": "CY74*(DE74*DO74*DQ74+DW74*DF74)",
    "DZ74": "IF(INDEX($BD$6:$BD219,BT74)=\"\", \"\", INDEX($BD$5:$BD219,BT74+1))",
    "EA74": "IF(OR($AO$25, INDEX($BE$6:$BE219,BU74)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ74)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE219,BU74+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI74*$DJ74*$AQ$9),\n  SuperTower, $DL74,\n  Rend, $DN74,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74, $DB74), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR74,\n  SM, $DT74,\n  SLM, $DU74,\n  SL, $DQ74,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM74, UltCritCard),\n\nCY74*(DE74*OtherDamage*SL+UwDamage*DF74)))",
    "EB74": "IF(INDEX($BF$6:$BF219,BV74)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF219,BV74+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ74,\n  CCUW, $DA74,\n  SCM, $DD74,\n  SCC, $DC74,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74, CF), 1),\n\n  DW, $DR74,\n  CL, $DS74,\n  SM, $DT74,\n  SLM, $DU74,\n  SL, $DQ74,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM74, UltCritCard),\n\nCY74 * (Critical * DO74 * SL + UwDamage * UWCritical)))",
    "EC74": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG219,BW74)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH74,\n  Rapid, DG74,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG219, BW74+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ74*$AQ$9),\n  SuperTower, $DL74,\n  Rend, $DN74,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM219,CC74), $DV74, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM74,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74, $DB74), 1),\n\n  DW, $DR74,\n  CL, $DS74,\n  SM, $DT74,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY74*(DE74*OtherDamage*SL+UWDamage*DF74)))",
    "ED74": "IF(OR($AO$25, INDEX($BH$6:$BH219,BX74)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH219,BX74+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL74, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI74*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM219,CC74), $DV74, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH74,\n  Rapid, DG74,\n  SuperTower, $DL74,\n  Rend, $DN74,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM74,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74, $DB74), 1),\n\n  DW, $DR74,\n  CL, $DS74,\n  SM, $DT74,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY74*(DE74*OtherDamage*SL+UWDamage*DF74)))",
    "EE74": "IF(INDEX($BI$6:$BI219,BY74)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK74, 0),\n  CF, $DB74,\n  CC, $CZ74,\n  CCUW, $DA74,\n  SCM, $DD74,\n  SCC, $AV$17+INDEX($BI$5:$BI219,BY74+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY74 * (Critical*DO74*$DQ74+DW74*UWCritical)))",
    "EF74": "IF(INDEX($BJ$6:$BJ219,BZ74)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK74*1%, 1),\n  CF, $DB74,\n  CC, $CZ74,\n  CCUW, $DA74,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ219,BZ74+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC74,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY74*(Critical*DO74*$DQ74+DW74*UWCritical)))",
    "EG74": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK219,CA74)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH74,\n  Rapid, DG74,\n  DPM, (1+$DI74*$DJ74*$AQ$9),\n  Rend, $DN74,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK219,CA74+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM74*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74, $DB74), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK219,CA74+1)-1))/(45-CM74*3),1),\n\n  SL, $DQ74,\n  DW, $DR74,\n  CL, $DS74,\n  SM, $DT74,\n  SLM, $DU74,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY74*(DE74*OtherDamage*SL+UwDamage*DF74)))",
    "EH74": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL219,CB74+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL219,CB74)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH74,\n  Rapid, DG74,\n  DPM, (1+$DI74*$DJ74*$AQ$9),\n  SuperTower, $DL74,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL219,CB74+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY74*(DE74*OtherDamage*$DQ74+DW74*DF74)))",
    "EI74": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM219,CC74)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74, $DB74), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK74),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV74, $AR$29), 0),\n\n  DW, $DR74,\n  CL, $DS74,\n  SM, $DT74,\n  SL, $DQ74,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM74, UltCritCard),\nCY74*(DE74*DO74*SL+UwDamage*DF74)))",
    "EJ74": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN219,CD74)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT74,\n  DamageMastery, $CS74,\n  DemonMastery, $CX74,\n  SPB, INDEX($BN$5:$BN219,CD74+1),\n  ITO, $CV74,\n  Shock, $CW74,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE74*DO74*$DQ74+DW74*DF74)))",
    "EK74": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO219,CE74)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT74,\n  DamageMastery, $CS74,\n  DemonMastery, $CX74,\n  SPB, $CU74,\n  ITO, INDEX($BO$5:$BO219,CE74+1),\n  Shock, $CW74,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE74*DO74*$DQ74+DW74*DF74)))",
    "EL74": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP219,CF74)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74, $DB74), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP74),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF74),\n  CL, $DS74,\n  SM, $DT74,\n  SLM, $DU74,\n  SL, $DQ74,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM74, UltCritCard),\nCY74*(DE74*DO74*SL+UwDamage*DF74)))",
    "EM74": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ219,CG74)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG74+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN74": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR219,CH74)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74, $DB74), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH74+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP74),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK74),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM219,CC74), SMHeat, $AR$29), 0),\n\n  DW, $DR74,\n  CL, $DS74,\n  SL, $DQ74,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM74, UltCritCard),\nCY74*(DE74*DO74*SL+UwDamage*DF74)))",
    "EO74": "IF(OR(CI74 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI74+1))",
    "EP74": "IF(OR($AO$25, CJ74 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ74+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE218,BU74),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL74, 1),\n  DPM, (1+$DI74*CardRangeMastery*$DJ74*$AQ$9),\n  SuperTower, $DL74,\n  Rend, $DN74,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74, $DB74), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR74,\n  SM, $DT74,\n  SLM, $DU74,\n  SL, $DQ74,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM74, UltCritCard),\n\nCY74*(DE74*OtherDamage*SL+UwDamage*DF74)))",
    "EQ74": "IF(OR(CK74 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK74+1)*1%, 1),\n  CF, $DB74,\n  CC, MIN(100%, $CZ74 + 1%),\n  CCUW, DA74 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ219,BZ74) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC74 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR74,\n  CL, $DS74,\n  SM, $DT74,\n  SLM, $DU74,\n  SL, $DQ74,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM74, UltCritCard),\n\nCY74 * (Critical*DO74*SL+UwDamage*UWCritical)))",
    "ER74": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL74 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH219,BX74),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL74+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI74*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM219,CC74), $DV74, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH74,\n  Rapid, DG74,\n  SuperTower, $DL74,\n  Rend, $DN74,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM74,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74, $DB74), 1),\n\n  DW, $DR74,\n  CL, $DS74,\n  SM, $DT74,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY74*(DE74*OtherDamage*SL+UWDamage*DF74)))",
    "ES74": "IF(OR(CM74 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH74,\n  Rapid, DG74,\n  RDPM, (1+$DI74*$DJ74*$AQ$9),\n  Rend, $DN74,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK219,CA74),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM74+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74, $DB74), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR74,\n  CL, $DS74,\n  SM, $DT74,\n  SLM, $DU74,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY74*(DE74*OtherDamage*SL+UwDamage*DF74)))",
    "ET74": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN74 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM74,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN74+1, $DB74), 1),\n\n  DW, $DR74,\n  CL, $DS74,\n  SM, $DT74,\n  SLM, $DU74,\n  SL, $DQ74,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY74*(DE74*DO74*SL+UWDamage*DF74)))",
    "EU74": "IF(OR(NOT($BA$3), NOT($BA$23), $CO74 > $BA$15), \"\", 1 + 0.5*(CO74+1))",
    "EW74": "IF(DZ74=\"\", \"\", LET(\n  Now, CT74,\n  Next, DZ74,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT74),\nFactor/Cost))",
    "EX74": "IF(EA74=\"\",\"\",(EA74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU74))",
    "EY74": "IF(EB74=\"\",\"\",(EB74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV74))",
    "EZ74": "IF(EC74=\"\",\"\",(EC74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW74))",
    "FA74": "IF(ED74=\"\",\"\",(ED74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX74))",
    "FB74": "IF(EE74=\"\",\"\",(EE74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY74))",
    "FC74": "IF(EF74=\"\",\"\",(EF74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ74))",
    "FD74": "IF(EG74=\"\",\"\",(EG74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA74))",
    "FE74": "IF(EH74=\"\",\"\",(EH74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB74))",
    "FF74": "IF(EI74=\"\",\"\",(EI74/$DX74-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC74+1, 1, CC74))))",
    "FG74": "IF(EJ74=\"\",\"\",(EJ74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD74))",
    "FH74": "IF(EK74=\"\",\"\",(EK74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE74))",
    "FI74": "IF(EL74=\"\",\"\",(EL74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF74))",
    "FJ74": "IF(EM74=\"\", \"\", LET(\n  Now, CW74,\n  Next, EM74,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG74),\nFactor/Cost))",
    "FK74": "IF(EN74=\"\",\"\",(EN74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH74))",
    "FL74": "IF(EO74=\"\", \"\", LET(\n  Now, CS74,\n  Next, EO74,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI74),\nFactor/Cost))",
    "FM74": "IF(EP74=\"\",\"\",(EP74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ74))",
    "FN74": "IF(EQ74=\"\",\"\",(EQ74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK74))",
    "FO74": "IF(ER74=\"\",\"\",(ER74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL74))",
    "FP74": "IF(ES74=\"\",\"\",(ES74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM74))",
    "FQ74": "IF(ET74=\"\",\"\",(ET74/$DX74-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN74))",
    "FR74": "IF(EU74=\"\", \"\", LET(\n  Now, CX74,\n  Next, EU74,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO74),\nFactor/Cost))",
    "FT74": "IF(COLUMN(EW74:FR74) = MIN(IF(EW74:FR74=MAX(EW74:FR74), COLUMN(EW74:FR74))), 1, \"\")",
    "D75": "IF(SUM(FT74:GP74),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F75)),\"Card Mastery\",F75),G75)/$D$5,\"\")",
    "F75": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT74:GP74),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT74:GP74=1)),)\"),\"Critical Factor\")",
    "G75": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT74:GP74),ARRAYFORMULA(FILTER(BT74:CP74 , FT74:GP74=1)),\"\"\"\")\"),19.0)",
    "I75": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT74:GP74),ARRAYFORMULA(FILTER(EW74:FS74 , FT74:GP74=1))*D$5,\"\"\"\")\"),0.021832251561762765)",
    "K75": "IF(D66,FORMAT_TIME_YEAR(SUM($D$6:$D75)),)",
    "BC75": "BC74+1",
    "BD75": "BD74+BD$3",
    "BE75": "BE74+BE$3",
    "BF75": "BF74+BF$3",
    "BG75": "BG74+BG$3",
    "BH75": "BH74+BH$3",
    "BT75": "BT74+FT74",
    "BU75": "BU74+FU74",
    "BV75": "BV74+FV74",
    "BW75": "BW74+FW74",
    "BX75": "BX74+FX74",
    "BY75": "BY74+FY74",
    "BZ75": "BZ74+FZ74",
    "CA75": "CA74+GA74",
    "CB75": "CB74+GB74",
    "CC75": "CC74+GC74",
    "CD75": "CD74+GD74",
    "CE75": "CE74+GE74",
    "CF75": "CF74+GF74",
    "CG75": "CG74+GG74",
    "CH75": "CH74+GH74",
    "CI75": "CI74+GI74",
    "CJ75": "CJ74+GJ74",
    "CK75": "CK74+GK74",
    "CL75": "CL74+GL74",
    "CM75": "CM74+GM74",
    "CN75": "CN74+GN74",
    "CO75": "CO74+GO74",
    "CS75": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI75,1)",
    "CT75": "INDEX($BD$5:$BD220,BT75)",
    "CU75": "INDEX($BN$5:$BN220,CD75)",
    "CV75": "INDEX($BO$5:$BO220,CE75)",
    "CW75": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG75)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX75": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO75, 1)",
    "CY75": "LET(\n  Base, $CR$6,\n  Damage, $CT75,\n  DamageMastery, $CS75,\n  DemonMastery, $CX75,\n  SPB, $CU75,\n  ITO, $CV75,\n  Shock, $CW75,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ75": "MIN(100%, DA75)",
    "DA75": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK75*1%, 0)",
    "DB75": "LET(\n  Lab, 1+INDEX($BF$5:$BF220,BV75),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC75": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK75*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI220,BY75) + CardCritMastery)",
    "DD75": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK75*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ220,BZ75) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE75": "LET(\n  CF, $DB75,\n  CC, $CZ75,\n  SCM, $DD75,\n  SCC, $DC75,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF75": "LET(\n  CF, $DB75,\n  CC, $DA75,\n  SCM, $DD75,\n  SCC, $DC75,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG75": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH75)), 0)",
    "DH75": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ75*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE220,BU75),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI75": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG220, BW75), 1) + $AE$9)",
    "DJ75": "LET(\n  DpmLab, INDEX($BH$5:$BH220,BX75),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL75, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK75": "(1+$DI75*$DJ75*$AQ$9)",
    "DL75": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK220,CA75),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM75*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM75": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK220,CA75),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM75*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN75": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL220,CB75)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO75": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH75,\n  Rapid, DG75,\n  RDPM, DK75,\n  SuperTower, $DL75,\n  Rend, $DN75,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP75": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ75": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK75),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR75": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP75),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF75-1))",
    "DS75": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG75, DH75),0))",
    "DT75": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP75),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV75, $AR$29), 0))",
    "DU75": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK75),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM220,CC75), $DV75, $AR$29), 0))",
    "DV75": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH75), $AO$29)",
    "DW75": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM75,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75, $DB75), 1),\n\n  DW, $DR75,\n  CL, $DS75,\n  SM, $DT75,\n  SLM, $DU75,\n  SL, $DQ75,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX75": "CY75*(DE75*DO75*DQ75+DW75*DF75)",
    "DZ75": "IF(INDEX($BD$6:$BD220,BT75)=\"\", \"\", INDEX($BD$5:$BD220,BT75+1))",
    "EA75": "IF(OR($AO$25, INDEX($BE$6:$BE220,BU75)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ75)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE220,BU75+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI75*$DJ75*$AQ$9),\n  SuperTower, $DL75,\n  Rend, $DN75,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75, $DB75), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR75,\n  SM, $DT75,\n  SLM, $DU75,\n  SL, $DQ75,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM75, UltCritCard),\n\nCY75*(DE75*OtherDamage*SL+UwDamage*DF75)))",
    "EB75": "IF(INDEX($BF$6:$BF220,BV75)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF220,BV75+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ75,\n  CCUW, $DA75,\n  SCM, $DD75,\n  SCC, $DC75,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75, CF), 1),\n\n  DW, $DR75,\n  CL, $DS75,\n  SM, $DT75,\n  SLM, $DU75,\n  SL, $DQ75,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM75, UltCritCard),\n\nCY75 * (Critical * DO75 * SL + UwDamage * UWCritical)))",
    "EC75": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG220,BW75)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH75,\n  Rapid, DG75,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG220, BW75+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ75*$AQ$9),\n  SuperTower, $DL75,\n  Rend, $DN75,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM220,CC75), $DV75, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM75,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75, $DB75), 1),\n\n  DW, $DR75,\n  CL, $DS75,\n  SM, $DT75,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY75*(DE75*OtherDamage*SL+UWDamage*DF75)))",
    "ED75": "IF(OR($AO$25, INDEX($BH$6:$BH220,BX75)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH220,BX75+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL75, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI75*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM220,CC75), $DV75, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH75,\n  Rapid, DG75,\n  SuperTower, $DL75,\n  Rend, $DN75,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM75,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75, $DB75), 1),\n\n  DW, $DR75,\n  CL, $DS75,\n  SM, $DT75,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY75*(DE75*OtherDamage*SL+UWDamage*DF75)))",
    "EE75": "IF(INDEX($BI$6:$BI220,BY75)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK75, 0),\n  CF, $DB75,\n  CC, $CZ75,\n  CCUW, $DA75,\n  SCM, $DD75,\n  SCC, $AV$17+INDEX($BI$5:$BI220,BY75+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY75 * (Critical*DO75*$DQ75+DW75*UWCritical)))",
    "EF75": "IF(INDEX($BJ$6:$BJ220,BZ75)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK75*1%, 1),\n  CF, $DB75,\n  CC, $CZ75,\n  CCUW, $DA75,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ220,BZ75+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC75,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY75*(Critical*DO75*$DQ75+DW75*UWCritical)))",
    "EG75": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK220,CA75)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH75,\n  Rapid, DG75,\n  DPM, (1+$DI75*$DJ75*$AQ$9),\n  Rend, $DN75,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK220,CA75+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM75*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75, $DB75), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK220,CA75+1)-1))/(45-CM75*3),1),\n\n  SL, $DQ75,\n  DW, $DR75,\n  CL, $DS75,\n  SM, $DT75,\n  SLM, $DU75,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY75*(DE75*OtherDamage*SL+UwDamage*DF75)))",
    "EH75": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL220,CB75+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL220,CB75)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH75,\n  Rapid, DG75,\n  DPM, (1+$DI75*$DJ75*$AQ$9),\n  SuperTower, $DL75,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL220,CB75+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY75*(DE75*OtherDamage*$DQ75+DW75*DF75)))",
    "EI75": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM220,CC75)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75, $DB75), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK75),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV75, $AR$29), 0),\n\n  DW, $DR75,\n  CL, $DS75,\n  SM, $DT75,\n  SL, $DQ75,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM75, UltCritCard),\nCY75*(DE75*DO75*SL+UwDamage*DF75)))",
    "EJ75": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN220,CD75)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT75,\n  DamageMastery, $CS75,\n  DemonMastery, $CX75,\n  SPB, INDEX($BN$5:$BN220,CD75+1),\n  ITO, $CV75,\n  Shock, $CW75,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE75*DO75*$DQ75+DW75*DF75)))",
    "EK75": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO220,CE75)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT75,\n  DamageMastery, $CS75,\n  DemonMastery, $CX75,\n  SPB, $CU75,\n  ITO, INDEX($BO$5:$BO220,CE75+1),\n  Shock, $CW75,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE75*DO75*$DQ75+DW75*DF75)))",
    "EL75": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP220,CF75)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75, $DB75), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP75),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF75),\n  CL, $DS75,\n  SM, $DT75,\n  SLM, $DU75,\n  SL, $DQ75,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM75, UltCritCard),\nCY75*(DE75*DO75*SL+UwDamage*DF75)))",
    "EM75": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ220,CG75)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG75+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN75": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR220,CH75)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75, $DB75), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH75+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP75),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK75),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM220,CC75), SMHeat, $AR$29), 0),\n\n  DW, $DR75,\n  CL, $DS75,\n  SL, $DQ75,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM75, UltCritCard),\nCY75*(DE75*DO75*SL+UwDamage*DF75)))",
    "EO75": "IF(OR(CI75 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI75+1))",
    "EP75": "IF(OR($AO$25, CJ75 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ75+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE219,BU75),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL75, 1),\n  DPM, (1+$DI75*CardRangeMastery*$DJ75*$AQ$9),\n  SuperTower, $DL75,\n  Rend, $DN75,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75, $DB75), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR75,\n  SM, $DT75,\n  SLM, $DU75,\n  SL, $DQ75,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM75, UltCritCard),\n\nCY75*(DE75*OtherDamage*SL+UwDamage*DF75)))",
    "EQ75": "IF(OR(CK75 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK75+1)*1%, 1),\n  CF, $DB75,\n  CC, MIN(100%, $CZ75 + 1%),\n  CCUW, DA75 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ220,BZ75) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC75 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR75,\n  CL, $DS75,\n  SM, $DT75,\n  SLM, $DU75,\n  SL, $DQ75,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM75, UltCritCard),\n\nCY75 * (Critical*DO75*SL+UwDamage*UWCritical)))",
    "ER75": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL75 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH220,BX75),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL75+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI75*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM220,CC75), $DV75, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH75,\n  Rapid, DG75,\n  SuperTower, $DL75,\n  Rend, $DN75,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM75,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75, $DB75), 1),\n\n  DW, $DR75,\n  CL, $DS75,\n  SM, $DT75,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY75*(DE75*OtherDamage*SL+UWDamage*DF75)))",
    "ES75": "IF(OR(CM75 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH75,\n  Rapid, DG75,\n  RDPM, (1+$DI75*$DJ75*$AQ$9),\n  Rend, $DN75,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK220,CA75),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM75+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75, $DB75), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR75,\n  CL, $DS75,\n  SM, $DT75,\n  SLM, $DU75,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY75*(DE75*OtherDamage*SL+UwDamage*DF75)))",
    "ET75": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN75 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM75,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN75+1, $DB75), 1),\n\n  DW, $DR75,\n  CL, $DS75,\n  SM, $DT75,\n  SLM, $DU75,\n  SL, $DQ75,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY75*(DE75*DO75*SL+UWDamage*DF75)))",
    "EU75": "IF(OR(NOT($BA$3), NOT($BA$23), $CO75 > $BA$15), \"\", 1 + 0.5*(CO75+1))",
    "EW75": "IF(DZ75=\"\", \"\", LET(\n  Now, CT75,\n  Next, DZ75,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT75),\nFactor/Cost))",
    "EX75": "IF(EA75=\"\",\"\",(EA75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU75))",
    "EY75": "IF(EB75=\"\",\"\",(EB75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV75))",
    "EZ75": "IF(EC75=\"\",\"\",(EC75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW75))",
    "FA75": "IF(ED75=\"\",\"\",(ED75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX75))",
    "FB75": "IF(EE75=\"\",\"\",(EE75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY75))",
    "FC75": "IF(EF75=\"\",\"\",(EF75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ75))",
    "FD75": "IF(EG75=\"\",\"\",(EG75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA75))",
    "FE75": "IF(EH75=\"\",\"\",(EH75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB75))",
    "FF75": "IF(EI75=\"\",\"\",(EI75/$DX75-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC75+1, 1, CC75))))",
    "FG75": "IF(EJ75=\"\",\"\",(EJ75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD75))",
    "FH75": "IF(EK75=\"\",\"\",(EK75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE75))",
    "FI75": "IF(EL75=\"\",\"\",(EL75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF75))",
    "FJ75": "IF(EM75=\"\", \"\", LET(\n  Now, CW75,\n  Next, EM75,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG75),\nFactor/Cost))",
    "FK75": "IF(EN75=\"\",\"\",(EN75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH75))",
    "FL75": "IF(EO75=\"\", \"\", LET(\n  Now, CS75,\n  Next, EO75,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI75),\nFactor/Cost))",
    "FM75": "IF(EP75=\"\",\"\",(EP75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ75))",
    "FN75": "IF(EQ75=\"\",\"\",(EQ75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK75))",
    "FO75": "IF(ER75=\"\",\"\",(ER75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL75))",
    "FP75": "IF(ES75=\"\",\"\",(ES75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM75))",
    "FQ75": "IF(ET75=\"\",\"\",(ET75/$DX75-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN75))",
    "FR75": "IF(EU75=\"\", \"\", LET(\n  Now, CX75,\n  Next, EU75,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO75),\nFactor/Cost))",
    "FT75": "IF(COLUMN(EW75:FR75) = MIN(IF(EW75:FR75=MAX(EW75:FR75), COLUMN(EW75:FR75))), 1, \"\")",
    "D76": "IF(SUM(FT75:GP75),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F76)),\"Card Mastery\",F76),G76)/$D$5,\"\")",
    "F76": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT75:GP75),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT75:GP75=1)),)\"),\"Damage / Meter\")",
    "G76": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT75:GP75),ARRAYFORMULA(FILTER(BT75:CP75 , FT75:GP75=1)),\"\"\"\")\"),13.0)",
    "I76": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT75:GP75),ARRAYFORMULA(FILTER(EW75:FS75 , FT75:GP75=1))*D$5,\"\"\"\")\"),0.019827264146153812)",
    "K76": "IF(H76<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D76)),)",
    "BC76": "BC75+1",
    "BD76": "BD75+BD$3",
    "BE76": "BE75+BE$3",
    "BF76": "BF75+BF$3",
    "BG76": "BG75+BG$3",
    "BH76": "BH75+BH$3",
    "BT76": "BT75+FT75",
    "BU76": "BU75+FU75",
    "BV76": "BV75+FV75",
    "BW76": "BW75+FW75",
    "BX76": "BX75+FX75",
    "BY76": "BY75+FY75",
    "BZ76": "BZ75+FZ75",
    "CA76": "CA75+GA75",
    "CB76": "CB75+GB75",
    "CC76": "CC75+GC75",
    "CD76": "CD75+GD75",
    "CE76": "CE75+GE75",
    "CF76": "CF75+GF75",
    "CG76": "CG75+GG75",
    "CH76": "CH75+GH75",
    "CI76": "CI75+GI75",
    "CJ76": "CJ75+GJ75",
    "CK76": "CK75+GK75",
    "CL76": "CL75+GL75",
    "CM76": "CM75+GM75",
    "CN76": "CN75+GN75",
    "CO76": "CO75+GO75",
    "CS76": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI76,1)",
    "CT76": "INDEX($BD$5:$BD221,BT76)",
    "CU76": "INDEX($BN$5:$BN221,CD76)",
    "CV76": "INDEX($BO$5:$BO221,CE76)",
    "CW76": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG76)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX76": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO76, 1)",
    "CY76": "LET(\n  Base, $CR$6,\n  Damage, $CT76,\n  DamageMastery, $CS76,\n  DemonMastery, $CX76,\n  SPB, $CU76,\n  ITO, $CV76,\n  Shock, $CW76,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ76": "MIN(100%, DA76)",
    "DA76": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK76*1%, 0)",
    "DB76": "LET(\n  Lab, 1+INDEX($BF$5:$BF221,BV76),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC76": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK76*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI221,BY76) + CardCritMastery)",
    "DD76": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK76*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ221,BZ76) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE76": "LET(\n  CF, $DB76,\n  CC, $CZ76,\n  SCM, $DD76,\n  SCC, $DC76,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF76": "LET(\n  CF, $DB76,\n  CC, $DA76,\n  SCM, $DD76,\n  SCC, $DC76,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG76": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH76)), 0)",
    "DH76": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ76*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE221,BU76),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI76": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG221, BW76), 1) + $AE$9)",
    "DJ76": "LET(\n  DpmLab, INDEX($BH$5:$BH221,BX76),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL76, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK76": "(1+$DI76*$DJ76*$AQ$9)",
    "DL76": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK221,CA76),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM76*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM76": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK221,CA76),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM76*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN76": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL221,CB76)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO76": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH76,\n  Rapid, DG76,\n  RDPM, DK76,\n  SuperTower, $DL76,\n  Rend, $DN76,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP76": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ76": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK76),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR76": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP76),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF76-1))",
    "DS76": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG76, DH76),0))",
    "DT76": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP76),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV76, $AR$29), 0))",
    "DU76": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK76),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM221,CC76), $DV76, $AR$29), 0))",
    "DV76": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH76), $AO$29)",
    "DW76": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM76,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76, $DB76), 1),\n\n  DW, $DR76,\n  CL, $DS76,\n  SM, $DT76,\n  SLM, $DU76,\n  SL, $DQ76,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX76": "CY76*(DE76*DO76*DQ76+DW76*DF76)",
    "DZ76": "IF(INDEX($BD$6:$BD221,BT76)=\"\", \"\", INDEX($BD$5:$BD221,BT76+1))",
    "EA76": "IF(OR($AO$25, INDEX($BE$6:$BE221,BU76)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ76)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE221,BU76+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI76*$DJ76*$AQ$9),\n  SuperTower, $DL76,\n  Rend, $DN76,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76, $DB76), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR76,\n  SM, $DT76,\n  SLM, $DU76,\n  SL, $DQ76,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM76, UltCritCard),\n\nCY76*(DE76*OtherDamage*SL+UwDamage*DF76)))",
    "EB76": "IF(INDEX($BF$6:$BF221,BV76)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF221,BV76+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ76,\n  CCUW, $DA76,\n  SCM, $DD76,\n  SCC, $DC76,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76, CF), 1),\n\n  DW, $DR76,\n  CL, $DS76,\n  SM, $DT76,\n  SLM, $DU76,\n  SL, $DQ76,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM76, UltCritCard),\n\nCY76 * (Critical * DO76 * SL + UwDamage * UWCritical)))",
    "EC76": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG221,BW76)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH76,\n  Rapid, DG76,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG221, BW76+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ76*$AQ$9),\n  SuperTower, $DL76,\n  Rend, $DN76,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM221,CC76), $DV76, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM76,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76, $DB76), 1),\n\n  DW, $DR76,\n  CL, $DS76,\n  SM, $DT76,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY76*(DE76*OtherDamage*SL+UWDamage*DF76)))",
    "ED76": "IF(OR($AO$25, INDEX($BH$6:$BH221,BX76)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH221,BX76+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL76, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI76*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM221,CC76), $DV76, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH76,\n  Rapid, DG76,\n  SuperTower, $DL76,\n  Rend, $DN76,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM76,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76, $DB76), 1),\n\n  DW, $DR76,\n  CL, $DS76,\n  SM, $DT76,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY76*(DE76*OtherDamage*SL+UWDamage*DF76)))",
    "EE76": "IF(INDEX($BI$6:$BI221,BY76)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK76, 0),\n  CF, $DB76,\n  CC, $CZ76,\n  CCUW, $DA76,\n  SCM, $DD76,\n  SCC, $AV$17+INDEX($BI$5:$BI221,BY76+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY76 * (Critical*DO76*$DQ76+DW76*UWCritical)))",
    "EF76": "IF(INDEX($BJ$6:$BJ221,BZ76)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK76*1%, 1),\n  CF, $DB76,\n  CC, $CZ76,\n  CCUW, $DA76,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ221,BZ76+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC76,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY76*(Critical*DO76*$DQ76+DW76*UWCritical)))",
    "EG76": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK221,CA76)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH76,\n  Rapid, DG76,\n  DPM, (1+$DI76*$DJ76*$AQ$9),\n  Rend, $DN76,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK221,CA76+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM76*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76, $DB76), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK221,CA76+1)-1))/(45-CM76*3),1),\n\n  SL, $DQ76,\n  DW, $DR76,\n  CL, $DS76,\n  SM, $DT76,\n  SLM, $DU76,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY76*(DE76*OtherDamage*SL+UwDamage*DF76)))",
    "EH76": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL221,CB76+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL221,CB76)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH76,\n  Rapid, DG76,\n  DPM, (1+$DI76*$DJ76*$AQ$9),\n  SuperTower, $DL76,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL221,CB76+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY76*(DE76*OtherDamage*$DQ76+DW76*DF76)))",
    "EI76": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM221,CC76)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76, $DB76), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK76),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV76, $AR$29), 0),\n\n  DW, $DR76,\n  CL, $DS76,\n  SM, $DT76,\n  SL, $DQ76,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM76, UltCritCard),\nCY76*(DE76*DO76*SL+UwDamage*DF76)))",
    "EJ76": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN221,CD76)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT76,\n  DamageMastery, $CS76,\n  DemonMastery, $CX76,\n  SPB, INDEX($BN$5:$BN221,CD76+1),\n  ITO, $CV76,\n  Shock, $CW76,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE76*DO76*$DQ76+DW76*DF76)))",
    "EK76": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO221,CE76)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT76,\n  DamageMastery, $CS76,\n  DemonMastery, $CX76,\n  SPB, $CU76,\n  ITO, INDEX($BO$5:$BO221,CE76+1),\n  Shock, $CW76,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE76*DO76*$DQ76+DW76*DF76)))",
    "EL76": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP221,CF76)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76, $DB76), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP76),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF76),\n  CL, $DS76,\n  SM, $DT76,\n  SLM, $DU76,\n  SL, $DQ76,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM76, UltCritCard),\nCY76*(DE76*DO76*SL+UwDamage*DF76)))",
    "EM76": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ221,CG76)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG76+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN76": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR221,CH76)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76, $DB76), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH76+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP76),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK76),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM221,CC76), SMHeat, $AR$29), 0),\n\n  DW, $DR76,\n  CL, $DS76,\n  SL, $DQ76,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM76, UltCritCard),\nCY76*(DE76*DO76*SL+UwDamage*DF76)))",
    "EO76": "IF(OR(CI76 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI76+1))",
    "EP76": "IF(OR($AO$25, CJ76 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ76+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE220,BU76),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL76, 1),\n  DPM, (1+$DI76*CardRangeMastery*$DJ76*$AQ$9),\n  SuperTower, $DL76,\n  Rend, $DN76,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76, $DB76), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR76,\n  SM, $DT76,\n  SLM, $DU76,\n  SL, $DQ76,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM76, UltCritCard),\n\nCY76*(DE76*OtherDamage*SL+UwDamage*DF76)))",
    "EQ76": "IF(OR(CK76 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK76+1)*1%, 1),\n  CF, $DB76,\n  CC, MIN(100%, $CZ76 + 1%),\n  CCUW, DA76 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ221,BZ76) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC76 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR76,\n  CL, $DS76,\n  SM, $DT76,\n  SLM, $DU76,\n  SL, $DQ76,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM76, UltCritCard),\n\nCY76 * (Critical*DO76*SL+UwDamage*UWCritical)))",
    "ER76": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL76 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH221,BX76),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL76+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI76*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM221,CC76), $DV76, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH76,\n  Rapid, DG76,\n  SuperTower, $DL76,\n  Rend, $DN76,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM76,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76, $DB76), 1),\n\n  DW, $DR76,\n  CL, $DS76,\n  SM, $DT76,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY76*(DE76*OtherDamage*SL+UWDamage*DF76)))",
    "ES76": "IF(OR(CM76 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH76,\n  Rapid, DG76,\n  RDPM, (1+$DI76*$DJ76*$AQ$9),\n  Rend, $DN76,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK221,CA76),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM76+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76, $DB76), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR76,\n  CL, $DS76,\n  SM, $DT76,\n  SLM, $DU76,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY76*(DE76*OtherDamage*SL+UwDamage*DF76)))",
    "ET76": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN76 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM76,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN76+1, $DB76), 1),\n\n  DW, $DR76,\n  CL, $DS76,\n  SM, $DT76,\n  SLM, $DU76,\n  SL, $DQ76,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY76*(DE76*DO76*SL+UWDamage*DF76)))",
    "EU76": "IF(OR(NOT($BA$3), NOT($BA$23), $CO76 > $BA$15), \"\", 1 + 0.5*(CO76+1))",
    "EW76": "IF(DZ76=\"\", \"\", LET(\n  Now, CT76,\n  Next, DZ76,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT76),\nFactor/Cost))",
    "EX76": "IF(EA76=\"\",\"\",(EA76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU76))",
    "EY76": "IF(EB76=\"\",\"\",(EB76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV76))",
    "EZ76": "IF(EC76=\"\",\"\",(EC76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW76))",
    "FA76": "IF(ED76=\"\",\"\",(ED76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX76))",
    "FB76": "IF(EE76=\"\",\"\",(EE76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY76))",
    "FC76": "IF(EF76=\"\",\"\",(EF76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ76))",
    "FD76": "IF(EG76=\"\",\"\",(EG76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA76))",
    "FE76": "IF(EH76=\"\",\"\",(EH76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB76))",
    "FF76": "IF(EI76=\"\",\"\",(EI76/$DX76-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC76+1, 1, CC76))))",
    "FG76": "IF(EJ76=\"\",\"\",(EJ76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD76))",
    "FH76": "IF(EK76=\"\",\"\",(EK76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE76))",
    "FI76": "IF(EL76=\"\",\"\",(EL76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF76))",
    "FJ76": "IF(EM76=\"\", \"\", LET(\n  Now, CW76,\n  Next, EM76,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG76),\nFactor/Cost))",
    "FK76": "IF(EN76=\"\",\"\",(EN76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH76))",
    "FL76": "IF(EO76=\"\", \"\", LET(\n  Now, CS76,\n  Next, EO76,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI76),\nFactor/Cost))",
    "FM76": "IF(EP76=\"\",\"\",(EP76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ76))",
    "FN76": "IF(EQ76=\"\",\"\",(EQ76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK76))",
    "FO76": "IF(ER76=\"\",\"\",(ER76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL76))",
    "FP76": "IF(ES76=\"\",\"\",(ES76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM76))",
    "FQ76": "IF(ET76=\"\",\"\",(ET76/$DX76-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN76))",
    "FR76": "IF(EU76=\"\", \"\", LET(\n  Now, CX76,\n  Next, EU76,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO76),\nFactor/Cost))",
    "FT76": "IF(COLUMN(EW76:FR76) = MIN(IF(EW76:FR76=MAX(EW76:FR76), COLUMN(EW76:FR76))), 1, \"\")",
    "D77": "IF(SUM(FT76:GP76),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F77)),\"Card Mastery\",F77),G77)/$D$5,\"\")",
    "F77": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT76:GP76),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT76:GP76=1)),)\"),\"Damage\")",
    "G77": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT76:GP76),ARRAYFORMULA(FILTER(BT76:CP76 , FT76:GP76=1)),\"\"\"\")\"),18.0)",
    "I77": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT76:GP76),ARRAYFORMULA(FILTER(EW76:FS76 , FT76:GP76=1))*D$5,\"\"\"\")\"),0.018986340382891254)",
    "K77": "IF(H77<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D77)),)",
    "BC77": "BC76+1",
    "BD77": "BD76+BD$3",
    "BE77": "BE76+BE$3",
    "BF77": "BF76+BF$3",
    "BG77": "BG76+BG$3",
    "BH77": "BH76+BH$3",
    "BT77": "BT76+FT76",
    "BU77": "BU76+FU76",
    "BV77": "BV76+FV76",
    "BW77": "BW76+FW76",
    "BX77": "BX76+FX76",
    "BY77": "BY76+FY76",
    "BZ77": "BZ76+FZ76",
    "CA77": "CA76+GA76",
    "CB77": "CB76+GB76",
    "CC77": "CC76+GC76",
    "CD77": "CD76+GD76",
    "CE77": "CE76+GE76",
    "CF77": "CF76+GF76",
    "CG77": "CG76+GG76",
    "CH77": "CH76+GH76",
    "CI77": "CI76+GI76",
    "CJ77": "CJ76+GJ76",
    "CK77": "CK76+GK76",
    "CL77": "CL76+GL76",
    "CM77": "CM76+GM76",
    "CN77": "CN76+GN76",
    "CO77": "CO76+GO76",
    "CS77": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI77,1)",
    "CT77": "INDEX($BD$5:$BD222,BT77)",
    "CU77": "INDEX($BN$5:$BN222,CD77)",
    "CV77": "INDEX($BO$5:$BO222,CE77)",
    "CW77": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG77)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX77": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO77, 1)",
    "CY77": "LET(\n  Base, $CR$6,\n  Damage, $CT77,\n  DamageMastery, $CS77,\n  DemonMastery, $CX77,\n  SPB, $CU77,\n  ITO, $CV77,\n  Shock, $CW77,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ77": "MIN(100%, DA77)",
    "DA77": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK77*1%, 0)",
    "DB77": "LET(\n  Lab, 1+INDEX($BF$5:$BF222,BV77),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC77": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK77*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI222,BY77) + CardCritMastery)",
    "DD77": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK77*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ222,BZ77) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE77": "LET(\n  CF, $DB77,\n  CC, $CZ77,\n  SCM, $DD77,\n  SCC, $DC77,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF77": "LET(\n  CF, $DB77,\n  CC, $DA77,\n  SCM, $DD77,\n  SCC, $DC77,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG77": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH77)), 0)",
    "DH77": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ77*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE222,BU77),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI77": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG222, BW77), 1) + $AE$9)",
    "DJ77": "LET(\n  DpmLab, INDEX($BH$5:$BH222,BX77),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL77, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK77": "(1+$DI77*$DJ77*$AQ$9)",
    "DL77": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK222,CA77),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM77*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM77": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK222,CA77),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM77*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN77": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL222,CB77)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO77": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH77,\n  Rapid, DG77,\n  RDPM, DK77,\n  SuperTower, $DL77,\n  Rend, $DN77,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP77": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ77": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK77),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR77": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP77),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF77-1))",
    "DS77": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG77, DH77),0))",
    "DT77": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP77),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV77, $AR$29), 0))",
    "DU77": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK77),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM222,CC77), $DV77, $AR$29), 0))",
    "DV77": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH77), $AO$29)",
    "DW77": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM77,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77, $DB77), 1),\n\n  DW, $DR77,\n  CL, $DS77,\n  SM, $DT77,\n  SLM, $DU77,\n  SL, $DQ77,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX77": "CY77*(DE77*DO77*DQ77+DW77*DF77)",
    "DZ77": "IF(INDEX($BD$6:$BD222,BT77)=\"\", \"\", INDEX($BD$5:$BD222,BT77+1))",
    "EA77": "IF(OR($AO$25, INDEX($BE$6:$BE222,BU77)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ77)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE222,BU77+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI77*$DJ77*$AQ$9),\n  SuperTower, $DL77,\n  Rend, $DN77,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77, $DB77), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR77,\n  SM, $DT77,\n  SLM, $DU77,\n  SL, $DQ77,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM77, UltCritCard),\n\nCY77*(DE77*OtherDamage*SL+UwDamage*DF77)))",
    "EB77": "IF(INDEX($BF$6:$BF222,BV77)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF222,BV77+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ77,\n  CCUW, $DA77,\n  SCM, $DD77,\n  SCC, $DC77,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77, CF), 1),\n\n  DW, $DR77,\n  CL, $DS77,\n  SM, $DT77,\n  SLM, $DU77,\n  SL, $DQ77,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM77, UltCritCard),\n\nCY77 * (Critical * DO77 * SL + UwDamage * UWCritical)))",
    "EC77": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG222,BW77)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH77,\n  Rapid, DG77,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG222, BW77+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ77*$AQ$9),\n  SuperTower, $DL77,\n  Rend, $DN77,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM222,CC77), $DV77, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM77,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77, $DB77), 1),\n\n  DW, $DR77,\n  CL, $DS77,\n  SM, $DT77,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY77*(DE77*OtherDamage*SL+UWDamage*DF77)))",
    "ED77": "IF(OR($AO$25, INDEX($BH$6:$BH222,BX77)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH222,BX77+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL77, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI77*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM222,CC77), $DV77, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH77,\n  Rapid, DG77,\n  SuperTower, $DL77,\n  Rend, $DN77,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM77,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77, $DB77), 1),\n\n  DW, $DR77,\n  CL, $DS77,\n  SM, $DT77,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY77*(DE77*OtherDamage*SL+UWDamage*DF77)))",
    "EE77": "IF(INDEX($BI$6:$BI222,BY77)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK77, 0),\n  CF, $DB77,\n  CC, $CZ77,\n  CCUW, $DA77,\n  SCM, $DD77,\n  SCC, $AV$17+INDEX($BI$5:$BI222,BY77+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY77 * (Critical*DO77*$DQ77+DW77*UWCritical)))",
    "EF77": "IF(INDEX($BJ$6:$BJ222,BZ77)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK77*1%, 1),\n  CF, $DB77,\n  CC, $CZ77,\n  CCUW, $DA77,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ222,BZ77+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC77,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY77*(Critical*DO77*$DQ77+DW77*UWCritical)))",
    "EG77": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK222,CA77)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH77,\n  Rapid, DG77,\n  DPM, (1+$DI77*$DJ77*$AQ$9),\n  Rend, $DN77,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK222,CA77+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM77*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77, $DB77), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK222,CA77+1)-1))/(45-CM77*3),1),\n\n  SL, $DQ77,\n  DW, $DR77,\n  CL, $DS77,\n  SM, $DT77,\n  SLM, $DU77,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY77*(DE77*OtherDamage*SL+UwDamage*DF77)))",
    "EH77": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL222,CB77+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL222,CB77)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH77,\n  Rapid, DG77,\n  DPM, (1+$DI77*$DJ77*$AQ$9),\n  SuperTower, $DL77,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL222,CB77+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY77*(DE77*OtherDamage*$DQ77+DW77*DF77)))",
    "EI77": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM222,CC77)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77, $DB77), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK77),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV77, $AR$29), 0),\n\n  DW, $DR77,\n  CL, $DS77,\n  SM, $DT77,\n  SL, $DQ77,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM77, UltCritCard),\nCY77*(DE77*DO77*SL+UwDamage*DF77)))",
    "EJ77": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN222,CD77)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT77,\n  DamageMastery, $CS77,\n  DemonMastery, $CX77,\n  SPB, INDEX($BN$5:$BN222,CD77+1),\n  ITO, $CV77,\n  Shock, $CW77,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE77*DO77*$DQ77+DW77*DF77)))",
    "EK77": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO222,CE77)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT77,\n  DamageMastery, $CS77,\n  DemonMastery, $CX77,\n  SPB, $CU77,\n  ITO, INDEX($BO$5:$BO222,CE77+1),\n  Shock, $CW77,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE77*DO77*$DQ77+DW77*DF77)))",
    "EL77": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP222,CF77)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77, $DB77), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP77),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF77),\n  CL, $DS77,\n  SM, $DT77,\n  SLM, $DU77,\n  SL, $DQ77,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM77, UltCritCard),\nCY77*(DE77*DO77*SL+UwDamage*DF77)))",
    "EM77": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ222,CG77)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG77+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN77": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR222,CH77)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77, $DB77), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH77+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP77),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK77),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM222,CC77), SMHeat, $AR$29), 0),\n\n  DW, $DR77,\n  CL, $DS77,\n  SL, $DQ77,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM77, UltCritCard),\nCY77*(DE77*DO77*SL+UwDamage*DF77)))",
    "EO77": "IF(OR(CI77 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI77+1))",
    "EP77": "IF(OR($AO$25, CJ77 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ77+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE221,BU77),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL77, 1),\n  DPM, (1+$DI77*CardRangeMastery*$DJ77*$AQ$9),\n  SuperTower, $DL77,\n  Rend, $DN77,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77, $DB77), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR77,\n  SM, $DT77,\n  SLM, $DU77,\n  SL, $DQ77,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM77, UltCritCard),\n\nCY77*(DE77*OtherDamage*SL+UwDamage*DF77)))",
    "EQ77": "IF(OR(CK77 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK77+1)*1%, 1),\n  CF, $DB77,\n  CC, MIN(100%, $CZ77 + 1%),\n  CCUW, DA77 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ222,BZ77) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC77 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR77,\n  CL, $DS77,\n  SM, $DT77,\n  SLM, $DU77,\n  SL, $DQ77,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM77, UltCritCard),\n\nCY77 * (Critical*DO77*SL+UwDamage*UWCritical)))",
    "ER77": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL77 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH222,BX77),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL77+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI77*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM222,CC77), $DV77, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH77,\n  Rapid, DG77,\n  SuperTower, $DL77,\n  Rend, $DN77,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM77,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77, $DB77), 1),\n\n  DW, $DR77,\n  CL, $DS77,\n  SM, $DT77,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY77*(DE77*OtherDamage*SL+UWDamage*DF77)))",
    "ES77": "IF(OR(CM77 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH77,\n  Rapid, DG77,\n  RDPM, (1+$DI77*$DJ77*$AQ$9),\n  Rend, $DN77,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK222,CA77),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM77+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77, $DB77), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR77,\n  CL, $DS77,\n  SM, $DT77,\n  SLM, $DU77,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY77*(DE77*OtherDamage*SL+UwDamage*DF77)))",
    "ET77": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN77 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM77,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN77+1, $DB77), 1),\n\n  DW, $DR77,\n  CL, $DS77,\n  SM, $DT77,\n  SLM, $DU77,\n  SL, $DQ77,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY77*(DE77*DO77*SL+UWDamage*DF77)))",
    "EU77": "IF(OR(NOT($BA$3), NOT($BA$23), $CO77 > $BA$15), \"\", 1 + 0.5*(CO77+1))",
    "EW77": "IF(DZ77=\"\", \"\", LET(\n  Now, CT77,\n  Next, DZ77,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT77),\nFactor/Cost))",
    "EX77": "IF(EA77=\"\",\"\",(EA77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU77))",
    "EY77": "IF(EB77=\"\",\"\",(EB77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV77))",
    "EZ77": "IF(EC77=\"\",\"\",(EC77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW77))",
    "FA77": "IF(ED77=\"\",\"\",(ED77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX77))",
    "FB77": "IF(EE77=\"\",\"\",(EE77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY77))",
    "FC77": "IF(EF77=\"\",\"\",(EF77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ77))",
    "FD77": "IF(EG77=\"\",\"\",(EG77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA77))",
    "FE77": "IF(EH77=\"\",\"\",(EH77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB77))",
    "FF77": "IF(EI77=\"\",\"\",(EI77/$DX77-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC77+1, 1, CC77))))",
    "FG77": "IF(EJ77=\"\",\"\",(EJ77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD77))",
    "FH77": "IF(EK77=\"\",\"\",(EK77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE77))",
    "FI77": "IF(EL77=\"\",\"\",(EL77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF77))",
    "FJ77": "IF(EM77=\"\", \"\", LET(\n  Now, CW77,\n  Next, EM77,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG77),\nFactor/Cost))",
    "FK77": "IF(EN77=\"\",\"\",(EN77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH77))",
    "FL77": "IF(EO77=\"\", \"\", LET(\n  Now, CS77,\n  Next, EO77,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI77),\nFactor/Cost))",
    "FM77": "IF(EP77=\"\",\"\",(EP77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ77))",
    "FN77": "IF(EQ77=\"\",\"\",(EQ77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK77))",
    "FO77": "IF(ER77=\"\",\"\",(ER77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL77))",
    "FP77": "IF(ES77=\"\",\"\",(ES77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM77))",
    "FQ77": "IF(ET77=\"\",\"\",(ET77/$DX77-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN77))",
    "FR77": "IF(EU77=\"\", \"\", LET(\n  Now, CX77,\n  Next, EU77,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO77),\nFactor/Cost))",
    "FT77": "IF(COLUMN(EW77:FR77) = MIN(IF(EW77:FR77=MAX(EW77:FR77), COLUMN(EW77:FR77))), 1, \"\")",
    "D78": "IF(SUM(FT77:GP77),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F78)),\"Card Mastery\",F78),G78)/$D$5,\"\")",
    "F78": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT77:GP77),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT77:GP77=1)),)\"),\"Critical Factor\")",
    "G78": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT77:GP77),ARRAYFORMULA(FILTER(BT77:CP77 , FT77:GP77=1)),\"\"\"\")\"),20.0)",
    "I78": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT77:GP77),ARRAYFORMULA(FILTER(EW77:FS77 , FT77:GP77=1))*D$5,\"\"\"\")\"),0.01891908559556905)",
    "K78": "IF(H78<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D78)),)",
    "BC78": "BC77+1",
    "BD78": "BD77+BD$3",
    "BE78": "BE77+BE$3",
    "BF78": "BF77+BF$3",
    "BG78": "BG77+BG$3",
    "BH78": "BH77+BH$3",
    "BT78": "BT77+FT77",
    "BU78": "BU77+FU77",
    "BV78": "BV77+FV77",
    "BW78": "BW77+FW77",
    "BX78": "BX77+FX77",
    "BY78": "BY77+FY77",
    "BZ78": "BZ77+FZ77",
    "CA78": "CA77+GA77",
    "CB78": "CB77+GB77",
    "CC78": "CC77+GC77",
    "CD78": "CD77+GD77",
    "CE78": "CE77+GE77",
    "CF78": "CF77+GF77",
    "CG78": "CG77+GG77",
    "CH78": "CH77+GH77",
    "CI78": "CI77+GI77",
    "CJ78": "CJ77+GJ77",
    "CK78": "CK77+GK77",
    "CL78": "CL77+GL77",
    "CM78": "CM77+GM77",
    "CN78": "CN77+GN77",
    "CO78": "CO77+GO77",
    "CS78": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI78,1)",
    "CT78": "INDEX($BD$5:$BD223,BT78)",
    "CU78": "INDEX($BN$5:$BN223,CD78)",
    "CV78": "INDEX($BO$5:$BO223,CE78)",
    "CW78": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG78)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX78": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO78, 1)",
    "CY78": "LET(\n  Base, $CR$6,\n  Damage, $CT78,\n  DamageMastery, $CS78,\n  DemonMastery, $CX78,\n  SPB, $CU78,\n  ITO, $CV78,\n  Shock, $CW78,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ78": "MIN(100%, DA78)",
    "DA78": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK78*1%, 0)",
    "DB78": "LET(\n  Lab, 1+INDEX($BF$5:$BF223,BV78),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC78": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK78*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI223,BY78) + CardCritMastery)",
    "DD78": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK78*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ223,BZ78) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE78": "LET(\n  CF, $DB78,\n  CC, $CZ78,\n  SCM, $DD78,\n  SCC, $DC78,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF78": "LET(\n  CF, $DB78,\n  CC, $DA78,\n  SCM, $DD78,\n  SCC, $DC78,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG78": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH78)), 0)",
    "DH78": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ78*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE223,BU78),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI78": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG223, BW78), 1) + $AE$9)",
    "DJ78": "LET(\n  DpmLab, INDEX($BH$5:$BH223,BX78),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL78, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK78": "(1+$DI78*$DJ78*$AQ$9)",
    "DL78": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK223,CA78),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM78*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM78": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK223,CA78),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM78*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN78": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL223,CB78)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO78": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH78,\n  Rapid, DG78,\n  RDPM, DK78,\n  SuperTower, $DL78,\n  Rend, $DN78,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP78": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ78": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK78),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR78": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP78),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF78-1))",
    "DS78": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG78, DH78),0))",
    "DT78": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP78),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV78, $AR$29), 0))",
    "DU78": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK78),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM223,CC78), $DV78, $AR$29), 0))",
    "DV78": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH78), $AO$29)",
    "DW78": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM78,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78, $DB78), 1),\n\n  DW, $DR78,\n  CL, $DS78,\n  SM, $DT78,\n  SLM, $DU78,\n  SL, $DQ78,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX78": "CY78*(DE78*DO78*DQ78+DW78*DF78)",
    "DZ78": "IF(INDEX($BD$6:$BD223,BT78)=\"\", \"\", INDEX($BD$5:$BD223,BT78+1))",
    "EA78": "IF(OR($AO$25, INDEX($BE$6:$BE223,BU78)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ78)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE223,BU78+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI78*$DJ78*$AQ$9),\n  SuperTower, $DL78,\n  Rend, $DN78,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78, $DB78), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR78,\n  SM, $DT78,\n  SLM, $DU78,\n  SL, $DQ78,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM78, UltCritCard),\n\nCY78*(DE78*OtherDamage*SL+UwDamage*DF78)))",
    "EB78": "IF(INDEX($BF$6:$BF223,BV78)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF223,BV78+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ78,\n  CCUW, $DA78,\n  SCM, $DD78,\n  SCC, $DC78,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78, CF), 1),\n\n  DW, $DR78,\n  CL, $DS78,\n  SM, $DT78,\n  SLM, $DU78,\n  SL, $DQ78,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM78, UltCritCard),\n\nCY78 * (Critical * DO78 * SL + UwDamage * UWCritical)))",
    "EC78": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG223,BW78)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH78,\n  Rapid, DG78,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG223, BW78+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ78*$AQ$9),\n  SuperTower, $DL78,\n  Rend, $DN78,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM223,CC78), $DV78, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM78,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78, $DB78), 1),\n\n  DW, $DR78,\n  CL, $DS78,\n  SM, $DT78,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY78*(DE78*OtherDamage*SL+UWDamage*DF78)))",
    "ED78": "IF(OR($AO$25, INDEX($BH$6:$BH223,BX78)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH223,BX78+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL78, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI78*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM223,CC78), $DV78, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH78,\n  Rapid, DG78,\n  SuperTower, $DL78,\n  Rend, $DN78,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM78,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78, $DB78), 1),\n\n  DW, $DR78,\n  CL, $DS78,\n  SM, $DT78,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY78*(DE78*OtherDamage*SL+UWDamage*DF78)))",
    "EE78": "IF(INDEX($BI$6:$BI223,BY78)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK78, 0),\n  CF, $DB78,\n  CC, $CZ78,\n  CCUW, $DA78,\n  SCM, $DD78,\n  SCC, $AV$17+INDEX($BI$5:$BI223,BY78+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY78 * (Critical*DO78*$DQ78+DW78*UWCritical)))",
    "EF78": "IF(INDEX($BJ$6:$BJ223,BZ78)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK78*1%, 1),\n  CF, $DB78,\n  CC, $CZ78,\n  CCUW, $DA78,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ223,BZ78+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC78,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY78*(Critical*DO78*$DQ78+DW78*UWCritical)))",
    "EG78": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK223,CA78)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH78,\n  Rapid, DG78,\n  DPM, (1+$DI78*$DJ78*$AQ$9),\n  Rend, $DN78,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK223,CA78+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM78*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78, $DB78), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK223,CA78+1)-1))/(45-CM78*3),1),\n\n  SL, $DQ78,\n  DW, $DR78,\n  CL, $DS78,\n  SM, $DT78,\n  SLM, $DU78,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY78*(DE78*OtherDamage*SL+UwDamage*DF78)))",
    "EH78": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL223,CB78+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL223,CB78)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH78,\n  Rapid, DG78,\n  DPM, (1+$DI78*$DJ78*$AQ$9),\n  SuperTower, $DL78,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL223,CB78+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY78*(DE78*OtherDamage*$DQ78+DW78*DF78)))",
    "EI78": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM223,CC78)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78, $DB78), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK78),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV78, $AR$29), 0),\n\n  DW, $DR78,\n  CL, $DS78,\n  SM, $DT78,\n  SL, $DQ78,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM78, UltCritCard),\nCY78*(DE78*DO78*SL+UwDamage*DF78)))",
    "EJ78": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN223,CD78)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT78,\n  DamageMastery, $CS78,\n  DemonMastery, $CX78,\n  SPB, INDEX($BN$5:$BN223,CD78+1),\n  ITO, $CV78,\n  Shock, $CW78,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE78*DO78*$DQ78+DW78*DF78)))",
    "EK78": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO223,CE78)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT78,\n  DamageMastery, $CS78,\n  DemonMastery, $CX78,\n  SPB, $CU78,\n  ITO, INDEX($BO$5:$BO223,CE78+1),\n  Shock, $CW78,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE78*DO78*$DQ78+DW78*DF78)))",
    "EL78": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP223,CF78)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78, $DB78), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP78),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF78),\n  CL, $DS78,\n  SM, $DT78,\n  SLM, $DU78,\n  SL, $DQ78,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM78, UltCritCard),\nCY78*(DE78*DO78*SL+UwDamage*DF78)))",
    "EM78": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ223,CG78)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG78+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN78": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR223,CH78)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78, $DB78), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH78+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP78),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK78),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM223,CC78), SMHeat, $AR$29), 0),\n\n  DW, $DR78,\n  CL, $DS78,\n  SL, $DQ78,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM78, UltCritCard),\nCY78*(DE78*DO78*SL+UwDamage*DF78)))",
    "EO78": "IF(OR(CI78 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI78+1))",
    "EP78": "IF(OR($AO$25, CJ78 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ78+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE222,BU78),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL78, 1),\n  DPM, (1+$DI78*CardRangeMastery*$DJ78*$AQ$9),\n  SuperTower, $DL78,\n  Rend, $DN78,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78, $DB78), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR78,\n  SM, $DT78,\n  SLM, $DU78,\n  SL, $DQ78,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM78, UltCritCard),\n\nCY78*(DE78*OtherDamage*SL+UwDamage*DF78)))",
    "EQ78": "IF(OR(CK78 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK78+1)*1%, 1),\n  CF, $DB78,\n  CC, MIN(100%, $CZ78 + 1%),\n  CCUW, DA78 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ223,BZ78) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC78 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR78,\n  CL, $DS78,\n  SM, $DT78,\n  SLM, $DU78,\n  SL, $DQ78,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM78, UltCritCard),\n\nCY78 * (Critical*DO78*SL+UwDamage*UWCritical)))",
    "ER78": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL78 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH223,BX78),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL78+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI78*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM223,CC78), $DV78, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH78,\n  Rapid, DG78,\n  SuperTower, $DL78,\n  Rend, $DN78,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM78,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78, $DB78), 1),\n\n  DW, $DR78,\n  CL, $DS78,\n  SM, $DT78,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY78*(DE78*OtherDamage*SL+UWDamage*DF78)))",
    "ES78": "IF(OR(CM78 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH78,\n  Rapid, DG78,\n  RDPM, (1+$DI78*$DJ78*$AQ$9),\n  Rend, $DN78,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK223,CA78),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM78+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78, $DB78), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR78,\n  CL, $DS78,\n  SM, $DT78,\n  SLM, $DU78,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY78*(DE78*OtherDamage*SL+UwDamage*DF78)))",
    "ET78": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN78 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM78,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN78+1, $DB78), 1),\n\n  DW, $DR78,\n  CL, $DS78,\n  SM, $DT78,\n  SLM, $DU78,\n  SL, $DQ78,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY78*(DE78*DO78*SL+UWDamage*DF78)))",
    "EU78": "IF(OR(NOT($BA$3), NOT($BA$23), $CO78 > $BA$15), \"\", 1 + 0.5*(CO78+1))",
    "EW78": "IF(DZ78=\"\", \"\", LET(\n  Now, CT78,\n  Next, DZ78,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT78),\nFactor/Cost))",
    "EX78": "IF(EA78=\"\",\"\",(EA78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU78))",
    "EY78": "IF(EB78=\"\",\"\",(EB78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV78))",
    "EZ78": "IF(EC78=\"\",\"\",(EC78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW78))",
    "FA78": "IF(ED78=\"\",\"\",(ED78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX78))",
    "FB78": "IF(EE78=\"\",\"\",(EE78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY78))",
    "FC78": "IF(EF78=\"\",\"\",(EF78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ78))",
    "FD78": "IF(EG78=\"\",\"\",(EG78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA78))",
    "FE78": "IF(EH78=\"\",\"\",(EH78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB78))",
    "FF78": "IF(EI78=\"\",\"\",(EI78/$DX78-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC78+1, 1, CC78))))",
    "FG78": "IF(EJ78=\"\",\"\",(EJ78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD78))",
    "FH78": "IF(EK78=\"\",\"\",(EK78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE78))",
    "FI78": "IF(EL78=\"\",\"\",(EL78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF78))",
    "FJ78": "IF(EM78=\"\", \"\", LET(\n  Now, CW78,\n  Next, EM78,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG78),\nFactor/Cost))",
    "FK78": "IF(EN78=\"\",\"\",(EN78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH78))",
    "FL78": "IF(EO78=\"\", \"\", LET(\n  Now, CS78,\n  Next, EO78,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI78),\nFactor/Cost))",
    "FM78": "IF(EP78=\"\",\"\",(EP78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ78))",
    "FN78": "IF(EQ78=\"\",\"\",(EQ78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK78))",
    "FO78": "IF(ER78=\"\",\"\",(ER78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL78))",
    "FP78": "IF(ES78=\"\",\"\",(ES78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM78))",
    "FQ78": "IF(ET78=\"\",\"\",(ET78/$DX78-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN78))",
    "FR78": "IF(EU78=\"\", \"\", LET(\n  Now, CX78,\n  Next, EU78,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO78),\nFactor/Cost))",
    "FT78": "IF(COLUMN(EW78:FR78) = MIN(IF(EW78:FR78=MAX(EW78:FR78), COLUMN(EW78:FR78))), 1, \"\")",
    "D79": "IF(SUM(FT78:GP78),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F79)),\"Card Mastery\",F79),G79)/$D$5,\"\")",
    "F79": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT78:GP78),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT78:GP78=1)),)\"),\"Attack Speed\")",
    "G79": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT78:GP78),ARRAYFORMULA(FILTER(BT78:CP78 , FT78:GP78=1)),\"\"\"\")\"),18.0)",
    "I79": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT78:GP78),ARRAYFORMULA(FILTER(EW78:FS78 , FT78:GP78=1))*D$5,\"\"\"\")\"),0.01884884722478124)",
    "K79": "IF(H79<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D79)),)",
    "BC79": "BC78+1",
    "BD79": "BD78+BD$3",
    "BE79": "BE78+BE$3",
    "BF79": "BF78+BF$3",
    "BG79": "BG78+BG$3",
    "BH79": "BH78+BH$3",
    "BT79": "BT78+FT78",
    "BU79": "BU78+FU78",
    "BV79": "BV78+FV78",
    "BW79": "BW78+FW78",
    "BX79": "BX78+FX78",
    "BY79": "BY78+FY78",
    "BZ79": "BZ78+FZ78",
    "CA79": "CA78+GA78",
    "CB79": "CB78+GB78",
    "CC79": "CC78+GC78",
    "CD79": "CD78+GD78",
    "CE79": "CE78+GE78",
    "CF79": "CF78+GF78",
    "CG79": "CG78+GG78",
    "CH79": "CH78+GH78",
    "CI79": "CI78+GI78",
    "CJ79": "CJ78+GJ78",
    "CK79": "CK78+GK78",
    "CL79": "CL78+GL78",
    "CM79": "CM78+GM78",
    "CN79": "CN78+GN78",
    "CO79": "CO78+GO78",
    "CS79": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI79,1)",
    "CT79": "INDEX($BD$5:$BD224,BT79)",
    "CU79": "INDEX($BN$5:$BN224,CD79)",
    "CV79": "INDEX($BO$5:$BO224,CE79)",
    "CW79": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG79)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX79": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO79, 1)",
    "CY79": "LET(\n  Base, $CR$6,\n  Damage, $CT79,\n  DamageMastery, $CS79,\n  DemonMastery, $CX79,\n  SPB, $CU79,\n  ITO, $CV79,\n  Shock, $CW79,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ79": "MIN(100%, DA79)",
    "DA79": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK79*1%, 0)",
    "DB79": "LET(\n  Lab, 1+INDEX($BF$5:$BF224,BV79),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC79": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK79*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI224,BY79) + CardCritMastery)",
    "DD79": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK79*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ224,BZ79) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE79": "LET(\n  CF, $DB79,\n  CC, $CZ79,\n  SCM, $DD79,\n  SCC, $DC79,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF79": "LET(\n  CF, $DB79,\n  CC, $DA79,\n  SCM, $DD79,\n  SCC, $DC79,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG79": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH79)), 0)",
    "DH79": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ79*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE224,BU79),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI79": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG224, BW79), 1) + $AE$9)",
    "DJ79": "LET(\n  DpmLab, INDEX($BH$5:$BH224,BX79),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL79, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK79": "(1+$DI79*$DJ79*$AQ$9)",
    "DL79": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK224,CA79),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM79*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM79": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK224,CA79),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM79*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN79": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL224,CB79)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO79": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH79,\n  Rapid, DG79,\n  RDPM, DK79,\n  SuperTower, $DL79,\n  Rend, $DN79,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP79": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ79": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK79),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR79": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP79),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF79-1))",
    "DS79": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG79, DH79),0))",
    "DT79": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP79),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV79, $AR$29), 0))",
    "DU79": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK79),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM224,CC79), $DV79, $AR$29), 0))",
    "DV79": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH79), $AO$29)",
    "DW79": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM79,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79, $DB79), 1),\n\n  DW, $DR79,\n  CL, $DS79,\n  SM, $DT79,\n  SLM, $DU79,\n  SL, $DQ79,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX79": "CY79*(DE79*DO79*DQ79+DW79*DF79)",
    "DZ79": "IF(INDEX($BD$6:$BD224,BT79)=\"\", \"\", INDEX($BD$5:$BD224,BT79+1))",
    "EA79": "IF(OR($AO$25, INDEX($BE$6:$BE224,BU79)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ79)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE224,BU79+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI79*$DJ79*$AQ$9),\n  SuperTower, $DL79,\n  Rend, $DN79,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79, $DB79), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR79,\n  SM, $DT79,\n  SLM, $DU79,\n  SL, $DQ79,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM79, UltCritCard),\n\nCY79*(DE79*OtherDamage*SL+UwDamage*DF79)))",
    "EB79": "IF(INDEX($BF$6:$BF224,BV79)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF224,BV79+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ79,\n  CCUW, $DA79,\n  SCM, $DD79,\n  SCC, $DC79,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79, CF), 1),\n\n  DW, $DR79,\n  CL, $DS79,\n  SM, $DT79,\n  SLM, $DU79,\n  SL, $DQ79,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM79, UltCritCard),\n\nCY79 * (Critical * DO79 * SL + UwDamage * UWCritical)))",
    "EC79": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG224,BW79)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH79,\n  Rapid, DG79,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG224, BW79+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ79*$AQ$9),\n  SuperTower, $DL79,\n  Rend, $DN79,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM224,CC79), $DV79, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM79,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79, $DB79), 1),\n\n  DW, $DR79,\n  CL, $DS79,\n  SM, $DT79,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY79*(DE79*OtherDamage*SL+UWDamage*DF79)))",
    "ED79": "IF(OR($AO$25, INDEX($BH$6:$BH224,BX79)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH224,BX79+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL79, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI79*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM224,CC79), $DV79, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH79,\n  Rapid, DG79,\n  SuperTower, $DL79,\n  Rend, $DN79,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM79,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79, $DB79), 1),\n\n  DW, $DR79,\n  CL, $DS79,\n  SM, $DT79,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY79*(DE79*OtherDamage*SL+UWDamage*DF79)))",
    "EE79": "IF(INDEX($BI$6:$BI224,BY79)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK79, 0),\n  CF, $DB79,\n  CC, $CZ79,\n  CCUW, $DA79,\n  SCM, $DD79,\n  SCC, $AV$17+INDEX($BI$5:$BI224,BY79+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY79 * (Critical*DO79*$DQ79+DW79*UWCritical)))",
    "EF79": "IF(INDEX($BJ$6:$BJ224,BZ79)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK79*1%, 1),\n  CF, $DB79,\n  CC, $CZ79,\n  CCUW, $DA79,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ224,BZ79+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC79,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY79*(Critical*DO79*$DQ79+DW79*UWCritical)))",
    "EG79": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK224,CA79)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH79,\n  Rapid, DG79,\n  DPM, (1+$DI79*$DJ79*$AQ$9),\n  Rend, $DN79,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK224,CA79+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM79*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79, $DB79), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK224,CA79+1)-1))/(45-CM79*3),1),\n\n  SL, $DQ79,\n  DW, $DR79,\n  CL, $DS79,\n  SM, $DT79,\n  SLM, $DU79,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY79*(DE79*OtherDamage*SL+UwDamage*DF79)))",
    "EH79": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL224,CB79+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL224,CB79)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH79,\n  Rapid, DG79,\n  DPM, (1+$DI79*$DJ79*$AQ$9),\n  SuperTower, $DL79,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL224,CB79+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY79*(DE79*OtherDamage*$DQ79+DW79*DF79)))",
    "EI79": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM224,CC79)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79, $DB79), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK79),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV79, $AR$29), 0),\n\n  DW, $DR79,\n  CL, $DS79,\n  SM, $DT79,\n  SL, $DQ79,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM79, UltCritCard),\nCY79*(DE79*DO79*SL+UwDamage*DF79)))",
    "EJ79": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN224,CD79)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT79,\n  DamageMastery, $CS79,\n  DemonMastery, $CX79,\n  SPB, INDEX($BN$5:$BN224,CD79+1),\n  ITO, $CV79,\n  Shock, $CW79,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE79*DO79*$DQ79+DW79*DF79)))",
    "EK79": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO224,CE79)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT79,\n  DamageMastery, $CS79,\n  DemonMastery, $CX79,\n  SPB, $CU79,\n  ITO, INDEX($BO$5:$BO224,CE79+1),\n  Shock, $CW79,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE79*DO79*$DQ79+DW79*DF79)))",
    "EL79": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP224,CF79)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79, $DB79), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP79),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF79),\n  CL, $DS79,\n  SM, $DT79,\n  SLM, $DU79,\n  SL, $DQ79,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM79, UltCritCard),\nCY79*(DE79*DO79*SL+UwDamage*DF79)))",
    "EM79": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ224,CG79)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG79+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN79": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR224,CH79)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79, $DB79), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH79+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP79),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK79),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM224,CC79), SMHeat, $AR$29), 0),\n\n  DW, $DR79,\n  CL, $DS79,\n  SL, $DQ79,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM79, UltCritCard),\nCY79*(DE79*DO79*SL+UwDamage*DF79)))",
    "EO79": "IF(OR(CI79 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI79+1))",
    "EP79": "IF(OR($AO$25, CJ79 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ79+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE223,BU79),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL79, 1),\n  DPM, (1+$DI79*CardRangeMastery*$DJ79*$AQ$9),\n  SuperTower, $DL79,\n  Rend, $DN79,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79, $DB79), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR79,\n  SM, $DT79,\n  SLM, $DU79,\n  SL, $DQ79,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM79, UltCritCard),\n\nCY79*(DE79*OtherDamage*SL+UwDamage*DF79)))",
    "EQ79": "IF(OR(CK79 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK79+1)*1%, 1),\n  CF, $DB79,\n  CC, MIN(100%, $CZ79 + 1%),\n  CCUW, DA79 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ224,BZ79) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC79 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR79,\n  CL, $DS79,\n  SM, $DT79,\n  SLM, $DU79,\n  SL, $DQ79,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM79, UltCritCard),\n\nCY79 * (Critical*DO79*SL+UwDamage*UWCritical)))",
    "ER79": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL79 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH224,BX79),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL79+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI79*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM224,CC79), $DV79, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH79,\n  Rapid, DG79,\n  SuperTower, $DL79,\n  Rend, $DN79,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM79,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79, $DB79), 1),\n\n  DW, $DR79,\n  CL, $DS79,\n  SM, $DT79,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY79*(DE79*OtherDamage*SL+UWDamage*DF79)))",
    "ES79": "IF(OR(CM79 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH79,\n  Rapid, DG79,\n  RDPM, (1+$DI79*$DJ79*$AQ$9),\n  Rend, $DN79,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK224,CA79),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM79+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79, $DB79), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR79,\n  CL, $DS79,\n  SM, $DT79,\n  SLM, $DU79,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY79*(DE79*OtherDamage*SL+UwDamage*DF79)))",
    "ET79": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN79 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM79,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN79+1, $DB79), 1),\n\n  DW, $DR79,\n  CL, $DS79,\n  SM, $DT79,\n  SLM, $DU79,\n  SL, $DQ79,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY79*(DE79*DO79*SL+UWDamage*DF79)))",
    "EU79": "IF(OR(NOT($BA$3), NOT($BA$23), $CO79 > $BA$15), \"\", 1 + 0.5*(CO79+1))",
    "EW79": "IF(DZ79=\"\", \"\", LET(\n  Now, CT79,\n  Next, DZ79,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT79),\nFactor/Cost))",
    "EX79": "IF(EA79=\"\",\"\",(EA79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU79))",
    "EY79": "IF(EB79=\"\",\"\",(EB79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV79))",
    "EZ79": "IF(EC79=\"\",\"\",(EC79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW79))",
    "FA79": "IF(ED79=\"\",\"\",(ED79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX79))",
    "FB79": "IF(EE79=\"\",\"\",(EE79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY79))",
    "FC79": "IF(EF79=\"\",\"\",(EF79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ79))",
    "FD79": "IF(EG79=\"\",\"\",(EG79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA79))",
    "FE79": "IF(EH79=\"\",\"\",(EH79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB79))",
    "FF79": "IF(EI79=\"\",\"\",(EI79/$DX79-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC79+1, 1, CC79))))",
    "FG79": "IF(EJ79=\"\",\"\",(EJ79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD79))",
    "FH79": "IF(EK79=\"\",\"\",(EK79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE79))",
    "FI79": "IF(EL79=\"\",\"\",(EL79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF79))",
    "FJ79": "IF(EM79=\"\", \"\", LET(\n  Now, CW79,\n  Next, EM79,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG79),\nFactor/Cost))",
    "FK79": "IF(EN79=\"\",\"\",(EN79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH79))",
    "FL79": "IF(EO79=\"\", \"\", LET(\n  Now, CS79,\n  Next, EO79,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI79),\nFactor/Cost))",
    "FM79": "IF(EP79=\"\",\"\",(EP79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ79))",
    "FN79": "IF(EQ79=\"\",\"\",(EQ79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK79))",
    "FO79": "IF(ER79=\"\",\"\",(ER79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL79))",
    "FP79": "IF(ES79=\"\",\"\",(ES79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM79))",
    "FQ79": "IF(ET79=\"\",\"\",(ET79/$DX79-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN79))",
    "FR79": "IF(EU79=\"\", \"\", LET(\n  Now, CX79,\n  Next, EU79,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO79),\nFactor/Cost))",
    "FT79": "IF(COLUMN(EW79:FR79) = MIN(IF(EW79:FR79=MAX(EW79:FR79), COLUMN(EW79:FR79))), 1, \"\")",
    "D80": "IF(SUM(FT79:GP79),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F80)),\"Card Mastery\",F80),G80)/$D$5,\"\")",
    "F80": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT79:GP79),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT79:GP79=1)),)\"),\"Critical Factor\")",
    "G80": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT79:GP79),ARRAYFORMULA(FILTER(BT79:CP79 , FT79:GP79=1)),\"\"\"\")\"),21.0)",
    "I80": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT79:GP79),ARRAYFORMULA(FILTER(EW79:FS79 , FT79:GP79=1))*D$5,\"\"\"\")\"),0.016497875197665185)",
    "K80": "IF(H80<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D80)),)",
    "BC80": "BC79+1",
    "BD80": "BD79+BD$3",
    "BE80": "BE79+BE$3",
    "BF80": "BF79+BF$3",
    "BG80": "BG79+BG$3",
    "BH80": "BH79+BH$3",
    "BT80": "BT79+FT79",
    "BU80": "BU79+FU79",
    "BV80": "BV79+FV79",
    "BW80": "BW79+FW79",
    "BX80": "BX79+FX79",
    "BY80": "BY79+FY79",
    "BZ80": "BZ79+FZ79",
    "CA80": "CA79+GA79",
    "CB80": "CB79+GB79",
    "CC80": "CC79+GC79",
    "CD80": "CD79+GD79",
    "CE80": "CE79+GE79",
    "CF80": "CF79+GF79",
    "CG80": "CG79+GG79",
    "CH80": "CH79+GH79",
    "CI80": "CI79+GI79",
    "CJ80": "CJ79+GJ79",
    "CK80": "CK79+GK79",
    "CL80": "CL79+GL79",
    "CM80": "CM79+GM79",
    "CN80": "CN79+GN79",
    "CO80": "CO79+GO79",
    "CS80": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI80,1)",
    "CT80": "INDEX($BD$5:$BD225,BT80)",
    "CU80": "INDEX($BN$5:$BN225,CD80)",
    "CV80": "INDEX($BO$5:$BO225,CE80)",
    "CW80": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG80)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX80": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO80, 1)",
    "CY80": "LET(\n  Base, $CR$6,\n  Damage, $CT80,\n  DamageMastery, $CS80,\n  DemonMastery, $CX80,\n  SPB, $CU80,\n  ITO, $CV80,\n  Shock, $CW80,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ80": "MIN(100%, DA80)",
    "DA80": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK80*1%, 0)",
    "DB80": "LET(\n  Lab, 1+INDEX($BF$5:$BF225,BV80),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC80": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK80*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI225,BY80) + CardCritMastery)",
    "DD80": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK80*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ225,BZ80) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE80": "LET(\n  CF, $DB80,\n  CC, $CZ80,\n  SCM, $DD80,\n  SCC, $DC80,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF80": "LET(\n  CF, $DB80,\n  CC, $DA80,\n  SCM, $DD80,\n  SCC, $DC80,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG80": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH80)), 0)",
    "DH80": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ80*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE225,BU80),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI80": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG225, BW80), 1) + $AE$9)",
    "DJ80": "LET(\n  DpmLab, INDEX($BH$5:$BH225,BX80),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL80, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK80": "(1+$DI80*$DJ80*$AQ$9)",
    "DL80": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK225,CA80),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM80*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM80": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK225,CA80),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM80*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN80": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL225,CB80)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO80": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH80,\n  Rapid, DG80,\n  RDPM, DK80,\n  SuperTower, $DL80,\n  Rend, $DN80,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP80": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ80": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK80),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR80": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP80),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF80-1))",
    "DS80": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG80, DH80),0))",
    "DT80": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP80),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV80, $AR$29), 0))",
    "DU80": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK80),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM225,CC80), $DV80, $AR$29), 0))",
    "DV80": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH80), $AO$29)",
    "DW80": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM80,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80, $DB80), 1),\n\n  DW, $DR80,\n  CL, $DS80,\n  SM, $DT80,\n  SLM, $DU80,\n  SL, $DQ80,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX80": "CY80*(DE80*DO80*DQ80+DW80*DF80)",
    "DZ80": "IF(INDEX($BD$6:$BD225,BT80)=\"\", \"\", INDEX($BD$5:$BD225,BT80+1))",
    "EA80": "IF(OR($AO$25, INDEX($BE$6:$BE225,BU80)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ80)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE225,BU80+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI80*$DJ80*$AQ$9),\n  SuperTower, $DL80,\n  Rend, $DN80,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80, $DB80), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR80,\n  SM, $DT80,\n  SLM, $DU80,\n  SL, $DQ80,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM80, UltCritCard),\n\nCY80*(DE80*OtherDamage*SL+UwDamage*DF80)))",
    "EB80": "IF(INDEX($BF$6:$BF225,BV80)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF225,BV80+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ80,\n  CCUW, $DA80,\n  SCM, $DD80,\n  SCC, $DC80,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80, CF), 1),\n\n  DW, $DR80,\n  CL, $DS80,\n  SM, $DT80,\n  SLM, $DU80,\n  SL, $DQ80,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM80, UltCritCard),\n\nCY80 * (Critical * DO80 * SL + UwDamage * UWCritical)))",
    "EC80": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG225,BW80)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH80,\n  Rapid, DG80,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG225, BW80+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ80*$AQ$9),\n  SuperTower, $DL80,\n  Rend, $DN80,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM225,CC80), $DV80, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM80,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80, $DB80), 1),\n\n  DW, $DR80,\n  CL, $DS80,\n  SM, $DT80,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY80*(DE80*OtherDamage*SL+UWDamage*DF80)))",
    "ED80": "IF(OR($AO$25, INDEX($BH$6:$BH225,BX80)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH225,BX80+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL80, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI80*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM225,CC80), $DV80, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH80,\n  Rapid, DG80,\n  SuperTower, $DL80,\n  Rend, $DN80,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM80,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80, $DB80), 1),\n\n  DW, $DR80,\n  CL, $DS80,\n  SM, $DT80,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY80*(DE80*OtherDamage*SL+UWDamage*DF80)))",
    "EE80": "IF(INDEX($BI$6:$BI225,BY80)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK80, 0),\n  CF, $DB80,\n  CC, $CZ80,\n  CCUW, $DA80,\n  SCM, $DD80,\n  SCC, $AV$17+INDEX($BI$5:$BI225,BY80+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY80 * (Critical*DO80*$DQ80+DW80*UWCritical)))",
    "EF80": "IF(INDEX($BJ$6:$BJ225,BZ80)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK80*1%, 1),\n  CF, $DB80,\n  CC, $CZ80,\n  CCUW, $DA80,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ225,BZ80+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC80,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY80*(Critical*DO80*$DQ80+DW80*UWCritical)))",
    "EG80": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK225,CA80)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH80,\n  Rapid, DG80,\n  DPM, (1+$DI80*$DJ80*$AQ$9),\n  Rend, $DN80,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK225,CA80+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM80*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80, $DB80), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK225,CA80+1)-1))/(45-CM80*3),1),\n\n  SL, $DQ80,\n  DW, $DR80,\n  CL, $DS80,\n  SM, $DT80,\n  SLM, $DU80,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY80*(DE80*OtherDamage*SL+UwDamage*DF80)))",
    "EH80": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL225,CB80+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL225,CB80)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH80,\n  Rapid, DG80,\n  DPM, (1+$DI80*$DJ80*$AQ$9),\n  SuperTower, $DL80,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL225,CB80+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY80*(DE80*OtherDamage*$DQ80+DW80*DF80)))",
    "EI80": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM225,CC80)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80, $DB80), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK80),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV80, $AR$29), 0),\n\n  DW, $DR80,\n  CL, $DS80,\n  SM, $DT80,\n  SL, $DQ80,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM80, UltCritCard),\nCY80*(DE80*DO80*SL+UwDamage*DF80)))",
    "EJ80": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN225,CD80)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT80,\n  DamageMastery, $CS80,\n  DemonMastery, $CX80,\n  SPB, INDEX($BN$5:$BN225,CD80+1),\n  ITO, $CV80,\n  Shock, $CW80,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE80*DO80*$DQ80+DW80*DF80)))",
    "EK80": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO225,CE80)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT80,\n  DamageMastery, $CS80,\n  DemonMastery, $CX80,\n  SPB, $CU80,\n  ITO, INDEX($BO$5:$BO225,CE80+1),\n  Shock, $CW80,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE80*DO80*$DQ80+DW80*DF80)))",
    "EL80": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP225,CF80)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80, $DB80), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP80),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF80),\n  CL, $DS80,\n  SM, $DT80,\n  SLM, $DU80,\n  SL, $DQ80,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM80, UltCritCard),\nCY80*(DE80*DO80*SL+UwDamage*DF80)))",
    "EM80": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ225,CG80)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG80+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN80": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR225,CH80)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80, $DB80), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH80+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP80),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK80),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM225,CC80), SMHeat, $AR$29), 0),\n\n  DW, $DR80,\n  CL, $DS80,\n  SL, $DQ80,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM80, UltCritCard),\nCY80*(DE80*DO80*SL+UwDamage*DF80)))",
    "EO80": "IF(OR(CI80 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI80+1))",
    "EP80": "IF(OR($AO$25, CJ80 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ80+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE224,BU80),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL80, 1),\n  DPM, (1+$DI80*CardRangeMastery*$DJ80*$AQ$9),\n  SuperTower, $DL80,\n  Rend, $DN80,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80, $DB80), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR80,\n  SM, $DT80,\n  SLM, $DU80,\n  SL, $DQ80,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM80, UltCritCard),\n\nCY80*(DE80*OtherDamage*SL+UwDamage*DF80)))",
    "EQ80": "IF(OR(CK80 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK80+1)*1%, 1),\n  CF, $DB80,\n  CC, MIN(100%, $CZ80 + 1%),\n  CCUW, DA80 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ225,BZ80) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC80 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR80,\n  CL, $DS80,\n  SM, $DT80,\n  SLM, $DU80,\n  SL, $DQ80,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM80, UltCritCard),\n\nCY80 * (Critical*DO80*SL+UwDamage*UWCritical)))",
    "ER80": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL80 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH225,BX80),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL80+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI80*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM225,CC80), $DV80, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH80,\n  Rapid, DG80,\n  SuperTower, $DL80,\n  Rend, $DN80,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM80,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80, $DB80), 1),\n\n  DW, $DR80,\n  CL, $DS80,\n  SM, $DT80,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY80*(DE80*OtherDamage*SL+UWDamage*DF80)))",
    "ES80": "IF(OR(CM80 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH80,\n  Rapid, DG80,\n  RDPM, (1+$DI80*$DJ80*$AQ$9),\n  Rend, $DN80,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK225,CA80),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM80+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80, $DB80), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR80,\n  CL, $DS80,\n  SM, $DT80,\n  SLM, $DU80,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY80*(DE80*OtherDamage*SL+UwDamage*DF80)))",
    "ET80": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN80 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM80,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN80+1, $DB80), 1),\n\n  DW, $DR80,\n  CL, $DS80,\n  SM, $DT80,\n  SLM, $DU80,\n  SL, $DQ80,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY80*(DE80*DO80*SL+UWDamage*DF80)))",
    "EU80": "IF(OR(NOT($BA$3), NOT($BA$23), $CO80 > $BA$15), \"\", 1 + 0.5*(CO80+1))",
    "EW80": "IF(DZ80=\"\", \"\", LET(\n  Now, CT80,\n  Next, DZ80,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT80),\nFactor/Cost))",
    "EX80": "IF(EA80=\"\",\"\",(EA80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU80))",
    "EY80": "IF(EB80=\"\",\"\",(EB80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV80))",
    "EZ80": "IF(EC80=\"\",\"\",(EC80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW80))",
    "FA80": "IF(ED80=\"\",\"\",(ED80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX80))",
    "FB80": "IF(EE80=\"\",\"\",(EE80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY80))",
    "FC80": "IF(EF80=\"\",\"\",(EF80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ80))",
    "FD80": "IF(EG80=\"\",\"\",(EG80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA80))",
    "FE80": "IF(EH80=\"\",\"\",(EH80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB80))",
    "FF80": "IF(EI80=\"\",\"\",(EI80/$DX80-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC80+1, 1, CC80))))",
    "FG80": "IF(EJ80=\"\",\"\",(EJ80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD80))",
    "FH80": "IF(EK80=\"\",\"\",(EK80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE80))",
    "FI80": "IF(EL80=\"\",\"\",(EL80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF80))",
    "FJ80": "IF(EM80=\"\", \"\", LET(\n  Now, CW80,\n  Next, EM80,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG80),\nFactor/Cost))",
    "FK80": "IF(EN80=\"\",\"\",(EN80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH80))",
    "FL80": "IF(EO80=\"\", \"\", LET(\n  Now, CS80,\n  Next, EO80,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI80),\nFactor/Cost))",
    "FM80": "IF(EP80=\"\",\"\",(EP80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ80))",
    "FN80": "IF(EQ80=\"\",\"\",(EQ80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK80))",
    "FO80": "IF(ER80=\"\",\"\",(ER80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL80))",
    "FP80": "IF(ES80=\"\",\"\",(ES80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM80))",
    "FQ80": "IF(ET80=\"\",\"\",(ET80/$DX80-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN80))",
    "FR80": "IF(EU80=\"\", \"\", LET(\n  Now, CX80,\n  Next, EU80,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO80),\nFactor/Cost))",
    "FT80": "IF(COLUMN(EW80:FR80) = MIN(IF(EW80:FR80=MAX(EW80:FR80), COLUMN(EW80:FR80))), 1, \"\")",
    "D81": "IF(SUM(FT80:GP80),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F81)),\"Card Mastery\",F81),G81)/$D$5,\"\")",
    "F81": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT80:GP80),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT80:GP80=1)),)\"),\"Damage / Meter\")",
    "G81": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT80:GP80),ARRAYFORMULA(FILTER(BT80:CP80 , FT80:GP80=1)),\"\"\"\")\"),14.0)",
    "I81": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT80:GP80),ARRAYFORMULA(FILTER(EW80:FS80 , FT80:GP80=1))*D$5,\"\"\"\")\"),0.016447828817244773)",
    "K81": "IF(H81<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D81)),)",
    "BC81": "BC80+1",
    "BD81": "BD80+BD$3",
    "BE81": "BE80+BE$3",
    "BF81": "BF80+BF$3",
    "BG81": "BG80+BG$3",
    "BH81": "BH80+BH$3",
    "BT81": "BT80+FT80",
    "BU81": "BU80+FU80",
    "BV81": "BV80+FV80",
    "BW81": "BW80+FW80",
    "BX81": "BX80+FX80",
    "BY81": "BY80+FY80",
    "BZ81": "BZ80+FZ80",
    "CA81": "CA80+GA80",
    "CB81": "CB80+GB80",
    "CC81": "CC80+GC80",
    "CD81": "CD80+GD80",
    "CE81": "CE80+GE80",
    "CF81": "CF80+GF80",
    "CG81": "CG80+GG80",
    "CH81": "CH80+GH80",
    "CI81": "CI80+GI80",
    "CJ81": "CJ80+GJ80",
    "CK81": "CK80+GK80",
    "CL81": "CL80+GL80",
    "CM81": "CM80+GM80",
    "CN81": "CN80+GN80",
    "CO81": "CO80+GO80",
    "CS81": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI81,1)",
    "CT81": "INDEX($BD$5:$BD226,BT81)",
    "CU81": "INDEX($BN$5:$BN226,CD81)",
    "CV81": "INDEX($BO$5:$BO226,CE81)",
    "CW81": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG81)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX81": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO81, 1)",
    "CY81": "LET(\n  Base, $CR$6,\n  Damage, $CT81,\n  DamageMastery, $CS81,\n  DemonMastery, $CX81,\n  SPB, $CU81,\n  ITO, $CV81,\n  Shock, $CW81,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ81": "MIN(100%, DA81)",
    "DA81": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK81*1%, 0)",
    "DB81": "LET(\n  Lab, 1+INDEX($BF$5:$BF226,BV81),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC81": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK81*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI226,BY81) + CardCritMastery)",
    "DD81": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK81*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ226,BZ81) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE81": "LET(\n  CF, $DB81,\n  CC, $CZ81,\n  SCM, $DD81,\n  SCC, $DC81,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF81": "LET(\n  CF, $DB81,\n  CC, $DA81,\n  SCM, $DD81,\n  SCC, $DC81,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG81": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH81)), 0)",
    "DH81": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ81*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE226,BU81),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI81": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG226, BW81), 1) + $AE$9)",
    "DJ81": "LET(\n  DpmLab, INDEX($BH$5:$BH226,BX81),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL81, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK81": "(1+$DI81*$DJ81*$AQ$9)",
    "DL81": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK226,CA81),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM81*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM81": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK226,CA81),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM81*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN81": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL226,CB81)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO81": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH81,\n  Rapid, DG81,\n  RDPM, DK81,\n  SuperTower, $DL81,\n  Rend, $DN81,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP81": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ81": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK81),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR81": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP81),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF81-1))",
    "DS81": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG81, DH81),0))",
    "DT81": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP81),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV81, $AR$29), 0))",
    "DU81": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK81),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM226,CC81), $DV81, $AR$29), 0))",
    "DV81": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH81), $AO$29)",
    "DW81": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM81,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81, $DB81), 1),\n\n  DW, $DR81,\n  CL, $DS81,\n  SM, $DT81,\n  SLM, $DU81,\n  SL, $DQ81,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX81": "CY81*(DE81*DO81*DQ81+DW81*DF81)",
    "DZ81": "IF(INDEX($BD$6:$BD226,BT81)=\"\", \"\", INDEX($BD$5:$BD226,BT81+1))",
    "EA81": "IF(OR($AO$25, INDEX($BE$6:$BE226,BU81)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ81)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE226,BU81+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI81*$DJ81*$AQ$9),\n  SuperTower, $DL81,\n  Rend, $DN81,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81, $DB81), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR81,\n  SM, $DT81,\n  SLM, $DU81,\n  SL, $DQ81,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM81, UltCritCard),\n\nCY81*(DE81*OtherDamage*SL+UwDamage*DF81)))",
    "EB81": "IF(INDEX($BF$6:$BF226,BV81)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF226,BV81+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ81,\n  CCUW, $DA81,\n  SCM, $DD81,\n  SCC, $DC81,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81, CF), 1),\n\n  DW, $DR81,\n  CL, $DS81,\n  SM, $DT81,\n  SLM, $DU81,\n  SL, $DQ81,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM81, UltCritCard),\n\nCY81 * (Critical * DO81 * SL + UwDamage * UWCritical)))",
    "EC81": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG226,BW81)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH81,\n  Rapid, DG81,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG226, BW81+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ81*$AQ$9),\n  SuperTower, $DL81,\n  Rend, $DN81,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM226,CC81), $DV81, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM81,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81, $DB81), 1),\n\n  DW, $DR81,\n  CL, $DS81,\n  SM, $DT81,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY81*(DE81*OtherDamage*SL+UWDamage*DF81)))",
    "ED81": "IF(OR($AO$25, INDEX($BH$6:$BH226,BX81)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH226,BX81+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL81, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI81*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM226,CC81), $DV81, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH81,\n  Rapid, DG81,\n  SuperTower, $DL81,\n  Rend, $DN81,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM81,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81, $DB81), 1),\n\n  DW, $DR81,\n  CL, $DS81,\n  SM, $DT81,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY81*(DE81*OtherDamage*SL+UWDamage*DF81)))",
    "EE81": "IF(INDEX($BI$6:$BI226,BY81)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK81, 0),\n  CF, $DB81,\n  CC, $CZ81,\n  CCUW, $DA81,\n  SCM, $DD81,\n  SCC, $AV$17+INDEX($BI$5:$BI226,BY81+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY81 * (Critical*DO81*$DQ81+DW81*UWCritical)))",
    "EF81": "IF(INDEX($BJ$6:$BJ226,BZ81)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK81*1%, 1),\n  CF, $DB81,\n  CC, $CZ81,\n  CCUW, $DA81,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ226,BZ81+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC81,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY81*(Critical*DO81*$DQ81+DW81*UWCritical)))",
    "EG81": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK226,CA81)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH81,\n  Rapid, DG81,\n  DPM, (1+$DI81*$DJ81*$AQ$9),\n  Rend, $DN81,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK226,CA81+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM81*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81, $DB81), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK226,CA81+1)-1))/(45-CM81*3),1),\n\n  SL, $DQ81,\n  DW, $DR81,\n  CL, $DS81,\n  SM, $DT81,\n  SLM, $DU81,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY81*(DE81*OtherDamage*SL+UwDamage*DF81)))",
    "EH81": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL226,CB81+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL226,CB81)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH81,\n  Rapid, DG81,\n  DPM, (1+$DI81*$DJ81*$AQ$9),\n  SuperTower, $DL81,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL226,CB81+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY81*(DE81*OtherDamage*$DQ81+DW81*DF81)))",
    "EI81": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM226,CC81)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81, $DB81), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK81),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV81, $AR$29), 0),\n\n  DW, $DR81,\n  CL, $DS81,\n  SM, $DT81,\n  SL, $DQ81,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM81, UltCritCard),\nCY81*(DE81*DO81*SL+UwDamage*DF81)))",
    "EJ81": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN226,CD81)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT81,\n  DamageMastery, $CS81,\n  DemonMastery, $CX81,\n  SPB, INDEX($BN$5:$BN226,CD81+1),\n  ITO, $CV81,\n  Shock, $CW81,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE81*DO81*$DQ81+DW81*DF81)))",
    "EK81": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO226,CE81)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT81,\n  DamageMastery, $CS81,\n  DemonMastery, $CX81,\n  SPB, $CU81,\n  ITO, INDEX($BO$5:$BO226,CE81+1),\n  Shock, $CW81,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE81*DO81*$DQ81+DW81*DF81)))",
    "EL81": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP226,CF81)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81, $DB81), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP81),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF81),\n  CL, $DS81,\n  SM, $DT81,\n  SLM, $DU81,\n  SL, $DQ81,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM81, UltCritCard),\nCY81*(DE81*DO81*SL+UwDamage*DF81)))",
    "EM81": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ226,CG81)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG81+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN81": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR226,CH81)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81, $DB81), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH81+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP81),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK81),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM226,CC81), SMHeat, $AR$29), 0),\n\n  DW, $DR81,\n  CL, $DS81,\n  SL, $DQ81,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM81, UltCritCard),\nCY81*(DE81*DO81*SL+UwDamage*DF81)))",
    "EO81": "IF(OR(CI81 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI81+1))",
    "EP81": "IF(OR($AO$25, CJ81 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ81+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE225,BU81),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL81, 1),\n  DPM, (1+$DI81*CardRangeMastery*$DJ81*$AQ$9),\n  SuperTower, $DL81,\n  Rend, $DN81,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81, $DB81), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR81,\n  SM, $DT81,\n  SLM, $DU81,\n  SL, $DQ81,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM81, UltCritCard),\n\nCY81*(DE81*OtherDamage*SL+UwDamage*DF81)))",
    "EQ81": "IF(OR(CK81 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK81+1)*1%, 1),\n  CF, $DB81,\n  CC, MIN(100%, $CZ81 + 1%),\n  CCUW, DA81 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ226,BZ81) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC81 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR81,\n  CL, $DS81,\n  SM, $DT81,\n  SLM, $DU81,\n  SL, $DQ81,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM81, UltCritCard),\n\nCY81 * (Critical*DO81*SL+UwDamage*UWCritical)))",
    "ER81": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL81 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH226,BX81),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL81+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI81*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM226,CC81), $DV81, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH81,\n  Rapid, DG81,\n  SuperTower, $DL81,\n  Rend, $DN81,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM81,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81, $DB81), 1),\n\n  DW, $DR81,\n  CL, $DS81,\n  SM, $DT81,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY81*(DE81*OtherDamage*SL+UWDamage*DF81)))",
    "ES81": "IF(OR(CM81 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH81,\n  Rapid, DG81,\n  RDPM, (1+$DI81*$DJ81*$AQ$9),\n  Rend, $DN81,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK226,CA81),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM81+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81, $DB81), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR81,\n  CL, $DS81,\n  SM, $DT81,\n  SLM, $DU81,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY81*(DE81*OtherDamage*SL+UwDamage*DF81)))",
    "ET81": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN81 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM81,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN81+1, $DB81), 1),\n\n  DW, $DR81,\n  CL, $DS81,\n  SM, $DT81,\n  SLM, $DU81,\n  SL, $DQ81,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY81*(DE81*DO81*SL+UWDamage*DF81)))",
    "EU81": "IF(OR(NOT($BA$3), NOT($BA$23), $CO81 > $BA$15), \"\", 1 + 0.5*(CO81+1))",
    "EW81": "IF(DZ81=\"\", \"\", LET(\n  Now, CT81,\n  Next, DZ81,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT81),\nFactor/Cost))",
    "EX81": "IF(EA81=\"\",\"\",(EA81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU81))",
    "EY81": "IF(EB81=\"\",\"\",(EB81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV81))",
    "EZ81": "IF(EC81=\"\",\"\",(EC81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW81))",
    "FA81": "IF(ED81=\"\",\"\",(ED81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX81))",
    "FB81": "IF(EE81=\"\",\"\",(EE81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY81))",
    "FC81": "IF(EF81=\"\",\"\",(EF81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ81))",
    "FD81": "IF(EG81=\"\",\"\",(EG81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA81))",
    "FE81": "IF(EH81=\"\",\"\",(EH81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB81))",
    "FF81": "IF(EI81=\"\",\"\",(EI81/$DX81-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC81+1, 1, CC81))))",
    "FG81": "IF(EJ81=\"\",\"\",(EJ81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD81))",
    "FH81": "IF(EK81=\"\",\"\",(EK81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE81))",
    "FI81": "IF(EL81=\"\",\"\",(EL81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF81))",
    "FJ81": "IF(EM81=\"\", \"\", LET(\n  Now, CW81,\n  Next, EM81,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG81),\nFactor/Cost))",
    "FK81": "IF(EN81=\"\",\"\",(EN81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH81))",
    "FL81": "IF(EO81=\"\", \"\", LET(\n  Now, CS81,\n  Next, EO81,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI81),\nFactor/Cost))",
    "FM81": "IF(EP81=\"\",\"\",(EP81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ81))",
    "FN81": "IF(EQ81=\"\",\"\",(EQ81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK81))",
    "FO81": "IF(ER81=\"\",\"\",(ER81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL81))",
    "FP81": "IF(ES81=\"\",\"\",(ES81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM81))",
    "FQ81": "IF(ET81=\"\",\"\",(ET81/$DX81-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN81))",
    "FR81": "IF(EU81=\"\", \"\", LET(\n  Now, CX81,\n  Next, EU81,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO81),\nFactor/Cost))",
    "FT81": "IF(COLUMN(EW81:FR81) = MIN(IF(EW81:FR81=MAX(EW81:FR81), COLUMN(EW81:FR81))), 1, \"\")",
    "D82": "IF(SUM(FT81:GP81),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F82)),\"Card Mastery\",F82),G82)/$D$5,\"\")",
    "F82": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT81:GP81),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT81:GP81=1)),)\"),\"Damage\")",
    "G82": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT81:GP81),ARRAYFORMULA(FILTER(BT81:CP81 , FT81:GP81=1)),\"\"\"\")\"),19.0)",
    "I82": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT81:GP81),ARRAYFORMULA(FILTER(EW81:FS81 , FT81:GP81=1))*D$5,\"\"\"\")\"),0.016403153050530764)",
    "K82": "IF(H82<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D82)),)",
    "BC82": "BC81+1",
    "BD82": "BD81+BD$3",
    "BE82": "BE81+BE$3",
    "BF82": "BF81+BF$3",
    "BG82": "BG81+BG$3",
    "BH82": "BH81+BH$3",
    "BT82": "BT81+FT81",
    "BU82": "BU81+FU81",
    "BV82": "BV81+FV81",
    "BW82": "BW81+FW81",
    "BX82": "BX81+FX81",
    "BY82": "BY81+FY81",
    "BZ82": "BZ81+FZ81",
    "CA82": "CA81+GA81",
    "CB82": "CB81+GB81",
    "CC82": "CC81+GC81",
    "CD82": "CD81+GD81",
    "CE82": "CE81+GE81",
    "CF82": "CF81+GF81",
    "CG82": "CG81+GG81",
    "CH82": "CH81+GH81",
    "CI82": "CI81+GI81",
    "CJ82": "CJ81+GJ81",
    "CK82": "CK81+GK81",
    "CL82": "CL81+GL81",
    "CM82": "CM81+GM81",
    "CN82": "CN81+GN81",
    "CO82": "CO81+GO81",
    "CS82": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI82,1)",
    "CT82": "INDEX($BD$5:$BD227,BT82)",
    "CU82": "INDEX($BN$5:$BN227,CD82)",
    "CV82": "INDEX($BO$5:$BO227,CE82)",
    "CW82": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG82)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX82": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO82, 1)",
    "CY82": "LET(\n  Base, $CR$6,\n  Damage, $CT82,\n  DamageMastery, $CS82,\n  DemonMastery, $CX82,\n  SPB, $CU82,\n  ITO, $CV82,\n  Shock, $CW82,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ82": "MIN(100%, DA82)",
    "DA82": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK82*1%, 0)",
    "DB82": "LET(\n  Lab, 1+INDEX($BF$5:$BF227,BV82),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC82": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK82*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI227,BY82) + CardCritMastery)",
    "DD82": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK82*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ227,BZ82) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE82": "LET(\n  CF, $DB82,\n  CC, $CZ82,\n  SCM, $DD82,\n  SCC, $DC82,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF82": "LET(\n  CF, $DB82,\n  CC, $DA82,\n  SCM, $DD82,\n  SCC, $DC82,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG82": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH82)), 0)",
    "DH82": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ82*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE227,BU82),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI82": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG227, BW82), 1) + $AE$9)",
    "DJ82": "LET(\n  DpmLab, INDEX($BH$5:$BH227,BX82),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL82, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK82": "(1+$DI82*$DJ82*$AQ$9)",
    "DL82": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK227,CA82),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM82*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM82": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK227,CA82),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM82*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN82": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL227,CB82)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO82": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH82,\n  Rapid, DG82,\n  RDPM, DK82,\n  SuperTower, $DL82,\n  Rend, $DN82,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP82": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ82": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK82),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR82": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP82),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF82-1))",
    "DS82": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG82, DH82),0))",
    "DT82": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP82),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV82, $AR$29), 0))",
    "DU82": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK82),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM227,CC82), $DV82, $AR$29), 0))",
    "DV82": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH82), $AO$29)",
    "DW82": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM82,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82, $DB82), 1),\n\n  DW, $DR82,\n  CL, $DS82,\n  SM, $DT82,\n  SLM, $DU82,\n  SL, $DQ82,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX82": "CY82*(DE82*DO82*DQ82+DW82*DF82)",
    "DZ82": "IF(INDEX($BD$6:$BD227,BT82)=\"\", \"\", INDEX($BD$5:$BD227,BT82+1))",
    "EA82": "IF(OR($AO$25, INDEX($BE$6:$BE227,BU82)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ82)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE227,BU82+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI82*$DJ82*$AQ$9),\n  SuperTower, $DL82,\n  Rend, $DN82,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82, $DB82), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR82,\n  SM, $DT82,\n  SLM, $DU82,\n  SL, $DQ82,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM82, UltCritCard),\n\nCY82*(DE82*OtherDamage*SL+UwDamage*DF82)))",
    "EB82": "IF(INDEX($BF$6:$BF227,BV82)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF227,BV82+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ82,\n  CCUW, $DA82,\n  SCM, $DD82,\n  SCC, $DC82,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82, CF), 1),\n\n  DW, $DR82,\n  CL, $DS82,\n  SM, $DT82,\n  SLM, $DU82,\n  SL, $DQ82,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM82, UltCritCard),\n\nCY82 * (Critical * DO82 * SL + UwDamage * UWCritical)))",
    "EC82": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG227,BW82)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH82,\n  Rapid, DG82,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG227, BW82+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ82*$AQ$9),\n  SuperTower, $DL82,\n  Rend, $DN82,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM227,CC82), $DV82, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM82,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82, $DB82), 1),\n\n  DW, $DR82,\n  CL, $DS82,\n  SM, $DT82,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY82*(DE82*OtherDamage*SL+UWDamage*DF82)))",
    "ED82": "IF(OR($AO$25, INDEX($BH$6:$BH227,BX82)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH227,BX82+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL82, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI82*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM227,CC82), $DV82, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH82,\n  Rapid, DG82,\n  SuperTower, $DL82,\n  Rend, $DN82,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM82,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82, $DB82), 1),\n\n  DW, $DR82,\n  CL, $DS82,\n  SM, $DT82,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY82*(DE82*OtherDamage*SL+UWDamage*DF82)))",
    "EE82": "IF(INDEX($BI$6:$BI227,BY82)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK82, 0),\n  CF, $DB82,\n  CC, $CZ82,\n  CCUW, $DA82,\n  SCM, $DD82,\n  SCC, $AV$17+INDEX($BI$5:$BI227,BY82+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY82 * (Critical*DO82*$DQ82+DW82*UWCritical)))",
    "EF82": "IF(INDEX($BJ$6:$BJ227,BZ82)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK82*1%, 1),\n  CF, $DB82,\n  CC, $CZ82,\n  CCUW, $DA82,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ227,BZ82+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC82,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY82*(Critical*DO82*$DQ82+DW82*UWCritical)))",
    "EG82": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK227,CA82)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH82,\n  Rapid, DG82,\n  DPM, (1+$DI82*$DJ82*$AQ$9),\n  Rend, $DN82,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK227,CA82+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM82*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82, $DB82), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK227,CA82+1)-1))/(45-CM82*3),1),\n\n  SL, $DQ82,\n  DW, $DR82,\n  CL, $DS82,\n  SM, $DT82,\n  SLM, $DU82,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY82*(DE82*OtherDamage*SL+UwDamage*DF82)))",
    "EH82": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL227,CB82+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL227,CB82)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH82,\n  Rapid, DG82,\n  DPM, (1+$DI82*$DJ82*$AQ$9),\n  SuperTower, $DL82,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL227,CB82+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY82*(DE82*OtherDamage*$DQ82+DW82*DF82)))",
    "EI82": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM227,CC82)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82, $DB82), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK82),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV82, $AR$29), 0),\n\n  DW, $DR82,\n  CL, $DS82,\n  SM, $DT82,\n  SL, $DQ82,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM82, UltCritCard),\nCY82*(DE82*DO82*SL+UwDamage*DF82)))",
    "EJ82": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN227,CD82)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT82,\n  DamageMastery, $CS82,\n  DemonMastery, $CX82,\n  SPB, INDEX($BN$5:$BN227,CD82+1),\n  ITO, $CV82,\n  Shock, $CW82,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE82*DO82*$DQ82+DW82*DF82)))",
    "EK82": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO227,CE82)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT82,\n  DamageMastery, $CS82,\n  DemonMastery, $CX82,\n  SPB, $CU82,\n  ITO, INDEX($BO$5:$BO227,CE82+1),\n  Shock, $CW82,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE82*DO82*$DQ82+DW82*DF82)))",
    "EL82": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP227,CF82)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82, $DB82), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP82),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF82),\n  CL, $DS82,\n  SM, $DT82,\n  SLM, $DU82,\n  SL, $DQ82,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM82, UltCritCard),\nCY82*(DE82*DO82*SL+UwDamage*DF82)))",
    "EM82": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ227,CG82)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG82+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN82": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR227,CH82)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82, $DB82), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH82+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP82),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK82),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM227,CC82), SMHeat, $AR$29), 0),\n\n  DW, $DR82,\n  CL, $DS82,\n  SL, $DQ82,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM82, UltCritCard),\nCY82*(DE82*DO82*SL+UwDamage*DF82)))",
    "EO82": "IF(OR(CI82 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI82+1))",
    "EP82": "IF(OR($AO$25, CJ82 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ82+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE226,BU82),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL82, 1),\n  DPM, (1+$DI82*CardRangeMastery*$DJ82*$AQ$9),\n  SuperTower, $DL82,\n  Rend, $DN82,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82, $DB82), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR82,\n  SM, $DT82,\n  SLM, $DU82,\n  SL, $DQ82,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM82, UltCritCard),\n\nCY82*(DE82*OtherDamage*SL+UwDamage*DF82)))",
    "EQ82": "IF(OR(CK82 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK82+1)*1%, 1),\n  CF, $DB82,\n  CC, MIN(100%, $CZ82 + 1%),\n  CCUW, DA82 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ227,BZ82) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC82 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR82,\n  CL, $DS82,\n  SM, $DT82,\n  SLM, $DU82,\n  SL, $DQ82,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM82, UltCritCard),\n\nCY82 * (Critical*DO82*SL+UwDamage*UWCritical)))",
    "ER82": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL82 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH227,BX82),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL82+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI82*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM227,CC82), $DV82, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH82,\n  Rapid, DG82,\n  SuperTower, $DL82,\n  Rend, $DN82,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM82,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82, $DB82), 1),\n\n  DW, $DR82,\n  CL, $DS82,\n  SM, $DT82,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY82*(DE82*OtherDamage*SL+UWDamage*DF82)))",
    "ES82": "IF(OR(CM82 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH82,\n  Rapid, DG82,\n  RDPM, (1+$DI82*$DJ82*$AQ$9),\n  Rend, $DN82,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK227,CA82),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM82+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82, $DB82), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR82,\n  CL, $DS82,\n  SM, $DT82,\n  SLM, $DU82,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY82*(DE82*OtherDamage*SL+UwDamage*DF82)))",
    "ET82": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN82 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM82,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN82+1, $DB82), 1),\n\n  DW, $DR82,\n  CL, $DS82,\n  SM, $DT82,\n  SLM, $DU82,\n  SL, $DQ82,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY82*(DE82*DO82*SL+UWDamage*DF82)))",
    "EU82": "IF(OR(NOT($BA$3), NOT($BA$23), $CO82 > $BA$15), \"\", 1 + 0.5*(CO82+1))",
    "EW82": "IF(DZ82=\"\", \"\", LET(\n  Now, CT82,\n  Next, DZ82,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT82),\nFactor/Cost))",
    "EX82": "IF(EA82=\"\",\"\",(EA82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU82))",
    "EY82": "IF(EB82=\"\",\"\",(EB82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV82))",
    "EZ82": "IF(EC82=\"\",\"\",(EC82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW82))",
    "FA82": "IF(ED82=\"\",\"\",(ED82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX82))",
    "FB82": "IF(EE82=\"\",\"\",(EE82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY82))",
    "FC82": "IF(EF82=\"\",\"\",(EF82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ82))",
    "FD82": "IF(EG82=\"\",\"\",(EG82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA82))",
    "FE82": "IF(EH82=\"\",\"\",(EH82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB82))",
    "FF82": "IF(EI82=\"\",\"\",(EI82/$DX82-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC82+1, 1, CC82))))",
    "FG82": "IF(EJ82=\"\",\"\",(EJ82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD82))",
    "FH82": "IF(EK82=\"\",\"\",(EK82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE82))",
    "FI82": "IF(EL82=\"\",\"\",(EL82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF82))",
    "FJ82": "IF(EM82=\"\", \"\", LET(\n  Now, CW82,\n  Next, EM82,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG82),\nFactor/Cost))",
    "FK82": "IF(EN82=\"\",\"\",(EN82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH82))",
    "FL82": "IF(EO82=\"\", \"\", LET(\n  Now, CS82,\n  Next, EO82,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI82),\nFactor/Cost))",
    "FM82": "IF(EP82=\"\",\"\",(EP82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ82))",
    "FN82": "IF(EQ82=\"\",\"\",(EQ82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK82))",
    "FO82": "IF(ER82=\"\",\"\",(ER82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL82))",
    "FP82": "IF(ES82=\"\",\"\",(ES82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM82))",
    "FQ82": "IF(ET82=\"\",\"\",(ET82/$DX82-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN82))",
    "FR82": "IF(EU82=\"\", \"\", LET(\n  Now, CX82,\n  Next, EU82,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO82),\nFactor/Cost))",
    "FT82": "IF(COLUMN(EW82:FR82) = MIN(IF(EW82:FR82=MAX(EW82:FR82), COLUMN(EW82:FR82))), 1, \"\")",
    "D83": "IF(SUM(FT82:GP82),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F83)),\"Card Mastery\",F83),G83)/$D$5,\"\")",
    "F83": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT82:GP82),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT82:GP82=1)),)\"),\"Standard Perks Bonus\")",
    "G83": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT82:GP82),ARRAYFORMULA(FILTER(BT82:CP82 , FT82:GP82=1)),\"\"\"\")\"),4.0)",
    "I83": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT82:GP82),ARRAYFORMULA(FILTER(EW82:FS82 , FT82:GP82=1))*D$5,\"\"\"\")\"),0.016370705531934236)",
    "K83": "IF(H83<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D83)),)",
    "BC83": "BC82+1",
    "BD83": "BD82+BD$3",
    "BE83": "BE82+BE$3",
    "BF83": "BF82+BF$3",
    "BG83": "BG82+BG$3",
    "BH83": "BH82+BH$3",
    "BT83": "BT82+FT82",
    "BU83": "BU82+FU82",
    "BV83": "BV82+FV82",
    "BW83": "BW82+FW82",
    "BX83": "BX82+FX82",
    "BY83": "BY82+FY82",
    "BZ83": "BZ82+FZ82",
    "CA83": "CA82+GA82",
    "CB83": "CB82+GB82",
    "CC83": "CC82+GC82",
    "CD83": "CD82+GD82",
    "CE83": "CE82+GE82",
    "CF83": "CF82+GF82",
    "CG83": "CG82+GG82",
    "CH83": "CH82+GH82",
    "CI83": "CI82+GI82",
    "CJ83": "CJ82+GJ82",
    "CK83": "CK82+GK82",
    "CL83": "CL82+GL82",
    "CM83": "CM82+GM82",
    "CN83": "CN82+GN82",
    "CO83": "CO82+GO82",
    "CS83": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI83,1)",
    "CT83": "INDEX($BD$5:$BD228,BT83)",
    "CU83": "INDEX($BN$5:$BN228,CD83)",
    "CV83": "INDEX($BO$5:$BO228,CE83)",
    "CW83": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG83)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX83": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO83, 1)",
    "CY83": "LET(\n  Base, $CR$6,\n  Damage, $CT83,\n  DamageMastery, $CS83,\n  DemonMastery, $CX83,\n  SPB, $CU83,\n  ITO, $CV83,\n  Shock, $CW83,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ83": "MIN(100%, DA83)",
    "DA83": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK83*1%, 0)",
    "DB83": "LET(\n  Lab, 1+INDEX($BF$5:$BF228,BV83),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC83": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK83*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI228,BY83) + CardCritMastery)",
    "DD83": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK83*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ228,BZ83) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE83": "LET(\n  CF, $DB83,\n  CC, $CZ83,\n  SCM, $DD83,\n  SCC, $DC83,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF83": "LET(\n  CF, $DB83,\n  CC, $DA83,\n  SCM, $DD83,\n  SCC, $DC83,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG83": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH83)), 0)",
    "DH83": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ83*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE228,BU83),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI83": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG228, BW83), 1) + $AE$9)",
    "DJ83": "LET(\n  DpmLab, INDEX($BH$5:$BH228,BX83),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL83, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK83": "(1+$DI83*$DJ83*$AQ$9)",
    "DL83": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK228,CA83),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM83*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM83": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK228,CA83),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM83*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN83": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL228,CB83)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO83": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH83,\n  Rapid, DG83,\n  RDPM, DK83,\n  SuperTower, $DL83,\n  Rend, $DN83,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP83": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ83": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK83),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR83": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP83),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF83-1))",
    "DS83": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG83, DH83),0))",
    "DT83": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP83),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV83, $AR$29), 0))",
    "DU83": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK83),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM228,CC83), $DV83, $AR$29), 0))",
    "DV83": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH83), $AO$29)",
    "DW83": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM83,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83, $DB83), 1),\n\n  DW, $DR83,\n  CL, $DS83,\n  SM, $DT83,\n  SLM, $DU83,\n  SL, $DQ83,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX83": "CY83*(DE83*DO83*DQ83+DW83*DF83)",
    "DZ83": "IF(INDEX($BD$6:$BD228,BT83)=\"\", \"\", INDEX($BD$5:$BD228,BT83+1))",
    "EA83": "IF(OR($AO$25, INDEX($BE$6:$BE228,BU83)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ83)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE228,BU83+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI83*$DJ83*$AQ$9),\n  SuperTower, $DL83,\n  Rend, $DN83,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83, $DB83), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR83,\n  SM, $DT83,\n  SLM, $DU83,\n  SL, $DQ83,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM83, UltCritCard),\n\nCY83*(DE83*OtherDamage*SL+UwDamage*DF83)))",
    "EB83": "IF(INDEX($BF$6:$BF228,BV83)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF228,BV83+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ83,\n  CCUW, $DA83,\n  SCM, $DD83,\n  SCC, $DC83,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83, CF), 1),\n\n  DW, $DR83,\n  CL, $DS83,\n  SM, $DT83,\n  SLM, $DU83,\n  SL, $DQ83,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM83, UltCritCard),\n\nCY83 * (Critical * DO83 * SL + UwDamage * UWCritical)))",
    "EC83": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG228,BW83)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH83,\n  Rapid, DG83,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG228, BW83+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ83*$AQ$9),\n  SuperTower, $DL83,\n  Rend, $DN83,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM228,CC83), $DV83, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM83,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83, $DB83), 1),\n\n  DW, $DR83,\n  CL, $DS83,\n  SM, $DT83,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY83*(DE83*OtherDamage*SL+UWDamage*DF83)))",
    "ED83": "IF(OR($AO$25, INDEX($BH$6:$BH228,BX83)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH228,BX83+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL83, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI83*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM228,CC83), $DV83, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH83,\n  Rapid, DG83,\n  SuperTower, $DL83,\n  Rend, $DN83,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM83,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83, $DB83), 1),\n\n  DW, $DR83,\n  CL, $DS83,\n  SM, $DT83,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY83*(DE83*OtherDamage*SL+UWDamage*DF83)))",
    "EE83": "IF(INDEX($BI$6:$BI228,BY83)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK83, 0),\n  CF, $DB83,\n  CC, $CZ83,\n  CCUW, $DA83,\n  SCM, $DD83,\n  SCC, $AV$17+INDEX($BI$5:$BI228,BY83+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY83 * (Critical*DO83*$DQ83+DW83*UWCritical)))",
    "EF83": "IF(INDEX($BJ$6:$BJ228,BZ83)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK83*1%, 1),\n  CF, $DB83,\n  CC, $CZ83,\n  CCUW, $DA83,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ228,BZ83+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC83,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY83*(Critical*DO83*$DQ83+DW83*UWCritical)))",
    "EG83": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK228,CA83)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH83,\n  Rapid, DG83,\n  DPM, (1+$DI83*$DJ83*$AQ$9),\n  Rend, $DN83,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK228,CA83+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM83*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83, $DB83), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK228,CA83+1)-1))/(45-CM83*3),1),\n\n  SL, $DQ83,\n  DW, $DR83,\n  CL, $DS83,\n  SM, $DT83,\n  SLM, $DU83,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY83*(DE83*OtherDamage*SL+UwDamage*DF83)))",
    "EH83": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL228,CB83+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL228,CB83)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH83,\n  Rapid, DG83,\n  DPM, (1+$DI83*$DJ83*$AQ$9),\n  SuperTower, $DL83,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL228,CB83+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY83*(DE83*OtherDamage*$DQ83+DW83*DF83)))",
    "EI83": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM228,CC83)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83, $DB83), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK83),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV83, $AR$29), 0),\n\n  DW, $DR83,\n  CL, $DS83,\n  SM, $DT83,\n  SL, $DQ83,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM83, UltCritCard),\nCY83*(DE83*DO83*SL+UwDamage*DF83)))",
    "EJ83": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN228,CD83)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT83,\n  DamageMastery, $CS83,\n  DemonMastery, $CX83,\n  SPB, INDEX($BN$5:$BN228,CD83+1),\n  ITO, $CV83,\n  Shock, $CW83,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE83*DO83*$DQ83+DW83*DF83)))",
    "EK83": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO228,CE83)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT83,\n  DamageMastery, $CS83,\n  DemonMastery, $CX83,\n  SPB, $CU83,\n  ITO, INDEX($BO$5:$BO228,CE83+1),\n  Shock, $CW83,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE83*DO83*$DQ83+DW83*DF83)))",
    "EL83": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP228,CF83)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83, $DB83), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP83),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF83),\n  CL, $DS83,\n  SM, $DT83,\n  SLM, $DU83,\n  SL, $DQ83,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM83, UltCritCard),\nCY83*(DE83*DO83*SL+UwDamage*DF83)))",
    "EM83": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ228,CG83)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG83+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN83": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR228,CH83)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83, $DB83), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH83+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP83),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK83),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM228,CC83), SMHeat, $AR$29), 0),\n\n  DW, $DR83,\n  CL, $DS83,\n  SL, $DQ83,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM83, UltCritCard),\nCY83*(DE83*DO83*SL+UwDamage*DF83)))",
    "EO83": "IF(OR(CI83 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI83+1))",
    "EP83": "IF(OR($AO$25, CJ83 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ83+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE227,BU83),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL83, 1),\n  DPM, (1+$DI83*CardRangeMastery*$DJ83*$AQ$9),\n  SuperTower, $DL83,\n  Rend, $DN83,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83, $DB83), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR83,\n  SM, $DT83,\n  SLM, $DU83,\n  SL, $DQ83,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM83, UltCritCard),\n\nCY83*(DE83*OtherDamage*SL+UwDamage*DF83)))",
    "EQ83": "IF(OR(CK83 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK83+1)*1%, 1),\n  CF, $DB83,\n  CC, MIN(100%, $CZ83 + 1%),\n  CCUW, DA83 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ228,BZ83) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC83 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR83,\n  CL, $DS83,\n  SM, $DT83,\n  SLM, $DU83,\n  SL, $DQ83,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM83, UltCritCard),\n\nCY83 * (Critical*DO83*SL+UwDamage*UWCritical)))",
    "ER83": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL83 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH228,BX83),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL83+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI83*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM228,CC83), $DV83, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH83,\n  Rapid, DG83,\n  SuperTower, $DL83,\n  Rend, $DN83,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM83,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83, $DB83), 1),\n\n  DW, $DR83,\n  CL, $DS83,\n  SM, $DT83,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY83*(DE83*OtherDamage*SL+UWDamage*DF83)))",
    "ES83": "IF(OR(CM83 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH83,\n  Rapid, DG83,\n  RDPM, (1+$DI83*$DJ83*$AQ$9),\n  Rend, $DN83,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK228,CA83),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM83+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83, $DB83), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR83,\n  CL, $DS83,\n  SM, $DT83,\n  SLM, $DU83,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY83*(DE83*OtherDamage*SL+UwDamage*DF83)))",
    "ET83": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN83 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM83,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN83+1, $DB83), 1),\n\n  DW, $DR83,\n  CL, $DS83,\n  SM, $DT83,\n  SLM, $DU83,\n  SL, $DQ83,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY83*(DE83*DO83*SL+UWDamage*DF83)))",
    "EU83": "IF(OR(NOT($BA$3), NOT($BA$23), $CO83 > $BA$15), \"\", 1 + 0.5*(CO83+1))",
    "EW83": "IF(DZ83=\"\", \"\", LET(\n  Now, CT83,\n  Next, DZ83,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT83),\nFactor/Cost))",
    "EX83": "IF(EA83=\"\",\"\",(EA83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU83))",
    "EY83": "IF(EB83=\"\",\"\",(EB83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV83))",
    "EZ83": "IF(EC83=\"\",\"\",(EC83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW83))",
    "FA83": "IF(ED83=\"\",\"\",(ED83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX83))",
    "FB83": "IF(EE83=\"\",\"\",(EE83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY83))",
    "FC83": "IF(EF83=\"\",\"\",(EF83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ83))",
    "FD83": "IF(EG83=\"\",\"\",(EG83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA83))",
    "FE83": "IF(EH83=\"\",\"\",(EH83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB83))",
    "FF83": "IF(EI83=\"\",\"\",(EI83/$DX83-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC83+1, 1, CC83))))",
    "FG83": "IF(EJ83=\"\",\"\",(EJ83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD83))",
    "FH83": "IF(EK83=\"\",\"\",(EK83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE83))",
    "FI83": "IF(EL83=\"\",\"\",(EL83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF83))",
    "FJ83": "IF(EM83=\"\", \"\", LET(\n  Now, CW83,\n  Next, EM83,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG83),\nFactor/Cost))",
    "FK83": "IF(EN83=\"\",\"\",(EN83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH83))",
    "FL83": "IF(EO83=\"\", \"\", LET(\n  Now, CS83,\n  Next, EO83,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI83),\nFactor/Cost))",
    "FM83": "IF(EP83=\"\",\"\",(EP83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ83))",
    "FN83": "IF(EQ83=\"\",\"\",(EQ83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK83))",
    "FO83": "IF(ER83=\"\",\"\",(ER83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL83))",
    "FP83": "IF(ES83=\"\",\"\",(ES83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM83))",
    "FQ83": "IF(ET83=\"\",\"\",(ET83/$DX83-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN83))",
    "FR83": "IF(EU83=\"\", \"\", LET(\n  Now, CX83,\n  Next, EU83,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO83),\nFactor/Cost))",
    "FT83": "IF(COLUMN(EW83:FR83) = MIN(IF(EW83:FR83=MAX(EW83:FR83), COLUMN(EW83:FR83))), 1, \"\")",
    "D84": "IF(SUM(FT83:GP83),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F84)),\"Card Mastery\",F84),G84)/$D$5,\"\")",
    "F84": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT83:GP83),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT83:GP83=1)),)\"),\"Attack Speed\")",
    "G84": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT83:GP83),ARRAYFORMULA(FILTER(BT83:CP83 , FT83:GP83=1)),\"\"\"\")\"),19.0)",
    "I84": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT83:GP83),ARRAYFORMULA(FILTER(EW83:FS83 , FT83:GP83=1))*D$5,\"\"\"\")\"),0.016264494043955652)",
    "K84": "IF(H84<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D84)),)",
    "BC84": "BC83+1",
    "BD84": "BD83+BD$3",
    "BE84": "BE83+BE$3",
    "BF84": "BF83+BF$3",
    "BG84": "BG83+BG$3",
    "BH84": "BH83+BH$3",
    "BT84": "BT83+FT83",
    "BU84": "BU83+FU83",
    "BV84": "BV83+FV83",
    "BW84": "BW83+FW83",
    "BX84": "BX83+FX83",
    "BY84": "BY83+FY83",
    "BZ84": "BZ83+FZ83",
    "CA84": "CA83+GA83",
    "CB84": "CB83+GB83",
    "CC84": "CC83+GC83",
    "CD84": "CD83+GD83",
    "CE84": "CE83+GE83",
    "CF84": "CF83+GF83",
    "CG84": "CG83+GG83",
    "CH84": "CH83+GH83",
    "CI84": "CI83+GI83",
    "CJ84": "CJ83+GJ83",
    "CK84": "CK83+GK83",
    "CL84": "CL83+GL83",
    "CM84": "CM83+GM83",
    "CN84": "CN83+GN83",
    "CO84": "CO83+GO83",
    "CS84": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI84,1)",
    "CT84": "INDEX($BD$5:$BD229,BT84)",
    "CU84": "INDEX($BN$5:$BN229,CD84)",
    "CV84": "INDEX($BO$5:$BO229,CE84)",
    "CW84": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG84)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX84": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO84, 1)",
    "CY84": "LET(\n  Base, $CR$6,\n  Damage, $CT84,\n  DamageMastery, $CS84,\n  DemonMastery, $CX84,\n  SPB, $CU84,\n  ITO, $CV84,\n  Shock, $CW84,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ84": "MIN(100%, DA84)",
    "DA84": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK84*1%, 0)",
    "DB84": "LET(\n  Lab, 1+INDEX($BF$5:$BF229,BV84),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC84": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK84*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI229,BY84) + CardCritMastery)",
    "DD84": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK84*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ229,BZ84) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE84": "LET(\n  CF, $DB84,\n  CC, $CZ84,\n  SCM, $DD84,\n  SCC, $DC84,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF84": "LET(\n  CF, $DB84,\n  CC, $DA84,\n  SCM, $DD84,\n  SCC, $DC84,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG84": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH84)), 0)",
    "DH84": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ84*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE229,BU84),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI84": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG229, BW84), 1) + $AE$9)",
    "DJ84": "LET(\n  DpmLab, INDEX($BH$5:$BH229,BX84),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL84, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK84": "(1+$DI84*$DJ84*$AQ$9)",
    "DL84": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK229,CA84),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM84*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM84": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK229,CA84),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM84*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN84": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL229,CB84)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO84": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH84,\n  Rapid, DG84,\n  RDPM, DK84,\n  SuperTower, $DL84,\n  Rend, $DN84,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP84": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ84": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK84),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR84": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP84),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF84-1))",
    "DS84": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG84, DH84),0))",
    "DT84": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP84),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV84, $AR$29), 0))",
    "DU84": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK84),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM229,CC84), $DV84, $AR$29), 0))",
    "DV84": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH84), $AO$29)",
    "DW84": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM84,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84, $DB84), 1),\n\n  DW, $DR84,\n  CL, $DS84,\n  SM, $DT84,\n  SLM, $DU84,\n  SL, $DQ84,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX84": "CY84*(DE84*DO84*DQ84+DW84*DF84)",
    "DZ84": "IF(INDEX($BD$6:$BD229,BT84)=\"\", \"\", INDEX($BD$5:$BD229,BT84+1))",
    "EA84": "IF(OR($AO$25, INDEX($BE$6:$BE229,BU84)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ84)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE229,BU84+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI84*$DJ84*$AQ$9),\n  SuperTower, $DL84,\n  Rend, $DN84,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84, $DB84), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR84,\n  SM, $DT84,\n  SLM, $DU84,\n  SL, $DQ84,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM84, UltCritCard),\n\nCY84*(DE84*OtherDamage*SL+UwDamage*DF84)))",
    "EB84": "IF(INDEX($BF$6:$BF229,BV84)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF229,BV84+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ84,\n  CCUW, $DA84,\n  SCM, $DD84,\n  SCC, $DC84,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84, CF), 1),\n\n  DW, $DR84,\n  CL, $DS84,\n  SM, $DT84,\n  SLM, $DU84,\n  SL, $DQ84,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM84, UltCritCard),\n\nCY84 * (Critical * DO84 * SL + UwDamage * UWCritical)))",
    "EC84": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG229,BW84)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH84,\n  Rapid, DG84,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG229, BW84+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ84*$AQ$9),\n  SuperTower, $DL84,\n  Rend, $DN84,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM229,CC84), $DV84, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM84,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84, $DB84), 1),\n\n  DW, $DR84,\n  CL, $DS84,\n  SM, $DT84,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY84*(DE84*OtherDamage*SL+UWDamage*DF84)))",
    "ED84": "IF(OR($AO$25, INDEX($BH$6:$BH229,BX84)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH229,BX84+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL84, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI84*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM229,CC84), $DV84, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH84,\n  Rapid, DG84,\n  SuperTower, $DL84,\n  Rend, $DN84,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM84,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84, $DB84), 1),\n\n  DW, $DR84,\n  CL, $DS84,\n  SM, $DT84,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY84*(DE84*OtherDamage*SL+UWDamage*DF84)))",
    "EE84": "IF(INDEX($BI$6:$BI229,BY84)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK84, 0),\n  CF, $DB84,\n  CC, $CZ84,\n  CCUW, $DA84,\n  SCM, $DD84,\n  SCC, $AV$17+INDEX($BI$5:$BI229,BY84+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY84 * (Critical*DO84*$DQ84+DW84*UWCritical)))",
    "EF84": "IF(INDEX($BJ$6:$BJ229,BZ84)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK84*1%, 1),\n  CF, $DB84,\n  CC, $CZ84,\n  CCUW, $DA84,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ229,BZ84+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC84,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY84*(Critical*DO84*$DQ84+DW84*UWCritical)))",
    "EG84": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK229,CA84)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH84,\n  Rapid, DG84,\n  DPM, (1+$DI84*$DJ84*$AQ$9),\n  Rend, $DN84,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK229,CA84+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM84*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84, $DB84), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK229,CA84+1)-1))/(45-CM84*3),1),\n\n  SL, $DQ84,\n  DW, $DR84,\n  CL, $DS84,\n  SM, $DT84,\n  SLM, $DU84,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY84*(DE84*OtherDamage*SL+UwDamage*DF84)))",
    "EH84": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL229,CB84+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL229,CB84)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH84,\n  Rapid, DG84,\n  DPM, (1+$DI84*$DJ84*$AQ$9),\n  SuperTower, $DL84,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL229,CB84+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY84*(DE84*OtherDamage*$DQ84+DW84*DF84)))",
    "EI84": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM229,CC84)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84, $DB84), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK84),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV84, $AR$29), 0),\n\n  DW, $DR84,\n  CL, $DS84,\n  SM, $DT84,\n  SL, $DQ84,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM84, UltCritCard),\nCY84*(DE84*DO84*SL+UwDamage*DF84)))",
    "EJ84": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN229,CD84)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT84,\n  DamageMastery, $CS84,\n  DemonMastery, $CX84,\n  SPB, INDEX($BN$5:$BN229,CD84+1),\n  ITO, $CV84,\n  Shock, $CW84,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE84*DO84*$DQ84+DW84*DF84)))",
    "EK84": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO229,CE84)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT84,\n  DamageMastery, $CS84,\n  DemonMastery, $CX84,\n  SPB, $CU84,\n  ITO, INDEX($BO$5:$BO229,CE84+1),\n  Shock, $CW84,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE84*DO84*$DQ84+DW84*DF84)))",
    "EL84": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP229,CF84)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84, $DB84), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP84),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF84),\n  CL, $DS84,\n  SM, $DT84,\n  SLM, $DU84,\n  SL, $DQ84,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM84, UltCritCard),\nCY84*(DE84*DO84*SL+UwDamage*DF84)))",
    "EM84": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ229,CG84)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG84+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN84": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR229,CH84)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84, $DB84), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH84+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP84),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK84),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM229,CC84), SMHeat, $AR$29), 0),\n\n  DW, $DR84,\n  CL, $DS84,\n  SL, $DQ84,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM84, UltCritCard),\nCY84*(DE84*DO84*SL+UwDamage*DF84)))",
    "EO84": "IF(OR(CI84 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI84+1))",
    "EP84": "IF(OR($AO$25, CJ84 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ84+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE228,BU84),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL84, 1),\n  DPM, (1+$DI84*CardRangeMastery*$DJ84*$AQ$9),\n  SuperTower, $DL84,\n  Rend, $DN84,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84, $DB84), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR84,\n  SM, $DT84,\n  SLM, $DU84,\n  SL, $DQ84,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM84, UltCritCard),\n\nCY84*(DE84*OtherDamage*SL+UwDamage*DF84)))",
    "EQ84": "IF(OR(CK84 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK84+1)*1%, 1),\n  CF, $DB84,\n  CC, MIN(100%, $CZ84 + 1%),\n  CCUW, DA84 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ229,BZ84) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC84 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR84,\n  CL, $DS84,\n  SM, $DT84,\n  SLM, $DU84,\n  SL, $DQ84,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM84, UltCritCard),\n\nCY84 * (Critical*DO84*SL+UwDamage*UWCritical)))",
    "ER84": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL84 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH229,BX84),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL84+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI84*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM229,CC84), $DV84, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH84,\n  Rapid, DG84,\n  SuperTower, $DL84,\n  Rend, $DN84,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM84,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84, $DB84), 1),\n\n  DW, $DR84,\n  CL, $DS84,\n  SM, $DT84,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY84*(DE84*OtherDamage*SL+UWDamage*DF84)))",
    "ES84": "IF(OR(CM84 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH84,\n  Rapid, DG84,\n  RDPM, (1+$DI84*$DJ84*$AQ$9),\n  Rend, $DN84,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK229,CA84),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM84+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84, $DB84), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR84,\n  CL, $DS84,\n  SM, $DT84,\n  SLM, $DU84,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY84*(DE84*OtherDamage*SL+UwDamage*DF84)))",
    "ET84": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN84 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM84,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN84+1, $DB84), 1),\n\n  DW, $DR84,\n  CL, $DS84,\n  SM, $DT84,\n  SLM, $DU84,\n  SL, $DQ84,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY84*(DE84*DO84*SL+UWDamage*DF84)))",
    "EU84": "IF(OR(NOT($BA$3), NOT($BA$23), $CO84 > $BA$15), \"\", 1 + 0.5*(CO84+1))",
    "EW84": "IF(DZ84=\"\", \"\", LET(\n  Now, CT84,\n  Next, DZ84,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT84),\nFactor/Cost))",
    "EX84": "IF(EA84=\"\",\"\",(EA84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU84))",
    "EY84": "IF(EB84=\"\",\"\",(EB84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV84))",
    "EZ84": "IF(EC84=\"\",\"\",(EC84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW84))",
    "FA84": "IF(ED84=\"\",\"\",(ED84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX84))",
    "FB84": "IF(EE84=\"\",\"\",(EE84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY84))",
    "FC84": "IF(EF84=\"\",\"\",(EF84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ84))",
    "FD84": "IF(EG84=\"\",\"\",(EG84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA84))",
    "FE84": "IF(EH84=\"\",\"\",(EH84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB84))",
    "FF84": "IF(EI84=\"\",\"\",(EI84/$DX84-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC84+1, 1, CC84))))",
    "FG84": "IF(EJ84=\"\",\"\",(EJ84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD84))",
    "FH84": "IF(EK84=\"\",\"\",(EK84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE84))",
    "FI84": "IF(EL84=\"\",\"\",(EL84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF84))",
    "FJ84": "IF(EM84=\"\", \"\", LET(\n  Now, CW84,\n  Next, EM84,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG84),\nFactor/Cost))",
    "FK84": "IF(EN84=\"\",\"\",(EN84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH84))",
    "FL84": "IF(EO84=\"\", \"\", LET(\n  Now, CS84,\n  Next, EO84,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI84),\nFactor/Cost))",
    "FM84": "IF(EP84=\"\",\"\",(EP84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ84))",
    "FN84": "IF(EQ84=\"\",\"\",(EQ84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK84))",
    "FO84": "IF(ER84=\"\",\"\",(ER84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL84))",
    "FP84": "IF(ES84=\"\",\"\",(ES84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM84))",
    "FQ84": "IF(ET84=\"\",\"\",(ET84/$DX84-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN84))",
    "FR84": "IF(EU84=\"\", \"\", LET(\n  Now, CX84,\n  Next, EU84,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO84),\nFactor/Cost))",
    "FT84": "IF(COLUMN(EW84:FR84) = MIN(IF(EW84:FR84=MAX(EW84:FR84), COLUMN(EW84:FR84))), 1, \"\")",
    "D85": "IF(SUM(FT84:GP84),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F85)),\"Card Mastery\",F85),G85)/$D$5,\"\")",
    "F85": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT84:GP84),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT84:GP84=1)),)\"),\"Super Tower Bonus\")",
    "G85": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT84:GP84),ARRAYFORMULA(FILTER(BT84:CP84 , FT84:GP84=1)),\"\"\"\")\"),3.0)",
    "I85": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT84:GP84),ARRAYFORMULA(FILTER(EW84:FS84 , FT84:GP84=1))*D$5,\"\"\"\")\"),0.01562124552324329)",
    "K85": "IF(D76,FORMAT_TIME_YEAR(SUM($D$6:$D85)),)",
    "BC85": "BC84+1",
    "BD85": "BD84+BD$3",
    "BE85": "BE84+BE$3",
    "BF85": "BF84+BF$3",
    "BG85": "BG84+BG$3",
    "BH85": "BH84+BH$3",
    "BT85": "BT84+FT84",
    "BU85": "BU84+FU84",
    "BV85": "BV84+FV84",
    "BW85": "BW84+FW84",
    "BX85": "BX84+FX84",
    "BY85": "BY84+FY84",
    "BZ85": "BZ84+FZ84",
    "CA85": "CA84+GA84",
    "CB85": "CB84+GB84",
    "CC85": "CC84+GC84",
    "CD85": "CD84+GD84",
    "CE85": "CE84+GE84",
    "CF85": "CF84+GF84",
    "CG85": "CG84+GG84",
    "CH85": "CH84+GH84",
    "CI85": "CI84+GI84",
    "CJ85": "CJ84+GJ84",
    "CK85": "CK84+GK84",
    "CL85": "CL84+GL84",
    "CM85": "CM84+GM84",
    "CN85": "CN84+GN84",
    "CO85": "CO84+GO84",
    "CS85": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI85,1)",
    "CT85": "INDEX($BD$5:$BD230,BT85)",
    "CU85": "INDEX($BN$5:$BN230,CD85)",
    "CV85": "INDEX($BO$5:$BO230,CE85)",
    "CW85": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG85)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX85": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO85, 1)",
    "CY85": "LET(\n  Base, $CR$6,\n  Damage, $CT85,\n  DamageMastery, $CS85,\n  DemonMastery, $CX85,\n  SPB, $CU85,\n  ITO, $CV85,\n  Shock, $CW85,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ85": "MIN(100%, DA85)",
    "DA85": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK85*1%, 0)",
    "DB85": "LET(\n  Lab, 1+INDEX($BF$5:$BF230,BV85),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC85": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK85*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI230,BY85) + CardCritMastery)",
    "DD85": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK85*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ230,BZ85) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE85": "LET(\n  CF, $DB85,\n  CC, $CZ85,\n  SCM, $DD85,\n  SCC, $DC85,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF85": "LET(\n  CF, $DB85,\n  CC, $DA85,\n  SCM, $DD85,\n  SCC, $DC85,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG85": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH85)), 0)",
    "DH85": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ85*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE230,BU85),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI85": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG230, BW85), 1) + $AE$9)",
    "DJ85": "LET(\n  DpmLab, INDEX($BH$5:$BH230,BX85),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL85, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK85": "(1+$DI85*$DJ85*$AQ$9)",
    "DL85": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK230,CA85),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM85*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM85": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK230,CA85),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM85*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN85": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL230,CB85)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO85": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH85,\n  Rapid, DG85,\n  RDPM, DK85,\n  SuperTower, $DL85,\n  Rend, $DN85,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP85": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ85": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK85),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR85": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP85),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF85-1))",
    "DS85": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG85, DH85),0))",
    "DT85": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP85),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV85, $AR$29), 0))",
    "DU85": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK85),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM230,CC85), $DV85, $AR$29), 0))",
    "DV85": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH85), $AO$29)",
    "DW85": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM85,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85, $DB85), 1),\n\n  DW, $DR85,\n  CL, $DS85,\n  SM, $DT85,\n  SLM, $DU85,\n  SL, $DQ85,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX85": "CY85*(DE85*DO85*DQ85+DW85*DF85)",
    "DZ85": "IF(INDEX($BD$6:$BD230,BT85)=\"\", \"\", INDEX($BD$5:$BD230,BT85+1))",
    "EA85": "IF(OR($AO$25, INDEX($BE$6:$BE230,BU85)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ85)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE230,BU85+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI85*$DJ85*$AQ$9),\n  SuperTower, $DL85,\n  Rend, $DN85,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85, $DB85), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR85,\n  SM, $DT85,\n  SLM, $DU85,\n  SL, $DQ85,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM85, UltCritCard),\n\nCY85*(DE85*OtherDamage*SL+UwDamage*DF85)))",
    "EB85": "IF(INDEX($BF$6:$BF230,BV85)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF230,BV85+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ85,\n  CCUW, $DA85,\n  SCM, $DD85,\n  SCC, $DC85,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85, CF), 1),\n\n  DW, $DR85,\n  CL, $DS85,\n  SM, $DT85,\n  SLM, $DU85,\n  SL, $DQ85,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM85, UltCritCard),\n\nCY85 * (Critical * DO85 * SL + UwDamage * UWCritical)))",
    "EC85": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG230,BW85)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH85,\n  Rapid, DG85,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG230, BW85+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ85*$AQ$9),\n  SuperTower, $DL85,\n  Rend, $DN85,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM230,CC85), $DV85, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM85,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85, $DB85), 1),\n\n  DW, $DR85,\n  CL, $DS85,\n  SM, $DT85,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY85*(DE85*OtherDamage*SL+UWDamage*DF85)))",
    "ED85": "IF(OR($AO$25, INDEX($BH$6:$BH230,BX85)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH230,BX85+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL85, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI85*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM230,CC85), $DV85, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH85,\n  Rapid, DG85,\n  SuperTower, $DL85,\n  Rend, $DN85,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM85,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85, $DB85), 1),\n\n  DW, $DR85,\n  CL, $DS85,\n  SM, $DT85,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY85*(DE85*OtherDamage*SL+UWDamage*DF85)))",
    "EE85": "IF(INDEX($BI$6:$BI230,BY85)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK85, 0),\n  CF, $DB85,\n  CC, $CZ85,\n  CCUW, $DA85,\n  SCM, $DD85,\n  SCC, $AV$17+INDEX($BI$5:$BI230,BY85+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY85 * (Critical*DO85*$DQ85+DW85*UWCritical)))",
    "EF85": "IF(INDEX($BJ$6:$BJ230,BZ85)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK85*1%, 1),\n  CF, $DB85,\n  CC, $CZ85,\n  CCUW, $DA85,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ230,BZ85+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC85,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY85*(Critical*DO85*$DQ85+DW85*UWCritical)))",
    "EG85": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK230,CA85)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH85,\n  Rapid, DG85,\n  DPM, (1+$DI85*$DJ85*$AQ$9),\n  Rend, $DN85,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK230,CA85+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM85*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85, $DB85), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK230,CA85+1)-1))/(45-CM85*3),1),\n\n  SL, $DQ85,\n  DW, $DR85,\n  CL, $DS85,\n  SM, $DT85,\n  SLM, $DU85,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY85*(DE85*OtherDamage*SL+UwDamage*DF85)))",
    "EH85": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL230,CB85+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL230,CB85)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH85,\n  Rapid, DG85,\n  DPM, (1+$DI85*$DJ85*$AQ$9),\n  SuperTower, $DL85,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL230,CB85+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY85*(DE85*OtherDamage*$DQ85+DW85*DF85)))",
    "EI85": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM230,CC85)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85, $DB85), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK85),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV85, $AR$29), 0),\n\n  DW, $DR85,\n  CL, $DS85,\n  SM, $DT85,\n  SL, $DQ85,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM85, UltCritCard),\nCY85*(DE85*DO85*SL+UwDamage*DF85)))",
    "EJ85": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN230,CD85)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT85,\n  DamageMastery, $CS85,\n  DemonMastery, $CX85,\n  SPB, INDEX($BN$5:$BN230,CD85+1),\n  ITO, $CV85,\n  Shock, $CW85,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE85*DO85*$DQ85+DW85*DF85)))",
    "EK85": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO230,CE85)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT85,\n  DamageMastery, $CS85,\n  DemonMastery, $CX85,\n  SPB, $CU85,\n  ITO, INDEX($BO$5:$BO230,CE85+1),\n  Shock, $CW85,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE85*DO85*$DQ85+DW85*DF85)))",
    "EL85": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP230,CF85)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85, $DB85), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP85),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF85),\n  CL, $DS85,\n  SM, $DT85,\n  SLM, $DU85,\n  SL, $DQ85,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM85, UltCritCard),\nCY85*(DE85*DO85*SL+UwDamage*DF85)))",
    "EM85": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ230,CG85)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG85+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN85": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR230,CH85)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85, $DB85), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH85+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP85),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK85),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM230,CC85), SMHeat, $AR$29), 0),\n\n  DW, $DR85,\n  CL, $DS85,\n  SL, $DQ85,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM85, UltCritCard),\nCY85*(DE85*DO85*SL+UwDamage*DF85)))",
    "EO85": "IF(OR(CI85 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI85+1))",
    "EP85": "IF(OR($AO$25, CJ85 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ85+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE229,BU85),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL85, 1),\n  DPM, (1+$DI85*CardRangeMastery*$DJ85*$AQ$9),\n  SuperTower, $DL85,\n  Rend, $DN85,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85, $DB85), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR85,\n  SM, $DT85,\n  SLM, $DU85,\n  SL, $DQ85,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM85, UltCritCard),\n\nCY85*(DE85*OtherDamage*SL+UwDamage*DF85)))",
    "EQ85": "IF(OR(CK85 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK85+1)*1%, 1),\n  CF, $DB85,\n  CC, MIN(100%, $CZ85 + 1%),\n  CCUW, DA85 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ230,BZ85) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC85 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR85,\n  CL, $DS85,\n  SM, $DT85,\n  SLM, $DU85,\n  SL, $DQ85,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM85, UltCritCard),\n\nCY85 * (Critical*DO85*SL+UwDamage*UWCritical)))",
    "ER85": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL85 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH230,BX85),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL85+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI85*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM230,CC85), $DV85, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH85,\n  Rapid, DG85,\n  SuperTower, $DL85,\n  Rend, $DN85,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM85,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85, $DB85), 1),\n\n  DW, $DR85,\n  CL, $DS85,\n  SM, $DT85,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY85*(DE85*OtherDamage*SL+UWDamage*DF85)))",
    "ES85": "IF(OR(CM85 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH85,\n  Rapid, DG85,\n  RDPM, (1+$DI85*$DJ85*$AQ$9),\n  Rend, $DN85,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK230,CA85),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM85+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85, $DB85), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR85,\n  CL, $DS85,\n  SM, $DT85,\n  SLM, $DU85,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY85*(DE85*OtherDamage*SL+UwDamage*DF85)))",
    "ET85": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN85 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM85,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN85+1, $DB85), 1),\n\n  DW, $DR85,\n  CL, $DS85,\n  SM, $DT85,\n  SLM, $DU85,\n  SL, $DQ85,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY85*(DE85*DO85*SL+UWDamage*DF85)))",
    "EU85": "IF(OR(NOT($BA$3), NOT($BA$23), $CO85 > $BA$15), \"\", 1 + 0.5*(CO85+1))",
    "EW85": "IF(DZ85=\"\", \"\", LET(\n  Now, CT85,\n  Next, DZ85,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT85),\nFactor/Cost))",
    "EX85": "IF(EA85=\"\",\"\",(EA85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU85))",
    "EY85": "IF(EB85=\"\",\"\",(EB85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV85))",
    "EZ85": "IF(EC85=\"\",\"\",(EC85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW85))",
    "FA85": "IF(ED85=\"\",\"\",(ED85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX85))",
    "FB85": "IF(EE85=\"\",\"\",(EE85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY85))",
    "FC85": "IF(EF85=\"\",\"\",(EF85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ85))",
    "FD85": "IF(EG85=\"\",\"\",(EG85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA85))",
    "FE85": "IF(EH85=\"\",\"\",(EH85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB85))",
    "FF85": "IF(EI85=\"\",\"\",(EI85/$DX85-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC85+1, 1, CC85))))",
    "FG85": "IF(EJ85=\"\",\"\",(EJ85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD85))",
    "FH85": "IF(EK85=\"\",\"\",(EK85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE85))",
    "FI85": "IF(EL85=\"\",\"\",(EL85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF85))",
    "FJ85": "IF(EM85=\"\", \"\", LET(\n  Now, CW85,\n  Next, EM85,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG85),\nFactor/Cost))",
    "FK85": "IF(EN85=\"\",\"\",(EN85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH85))",
    "FL85": "IF(EO85=\"\", \"\", LET(\n  Now, CS85,\n  Next, EO85,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI85),\nFactor/Cost))",
    "FM85": "IF(EP85=\"\",\"\",(EP85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ85))",
    "FN85": "IF(EQ85=\"\",\"\",(EQ85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK85))",
    "FO85": "IF(ER85=\"\",\"\",(ER85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL85))",
    "FP85": "IF(ES85=\"\",\"\",(ES85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM85))",
    "FQ85": "IF(ET85=\"\",\"\",(ET85/$DX85-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN85))",
    "FR85": "IF(EU85=\"\", \"\", LET(\n  Now, CX85,\n  Next, EU85,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO85),\nFactor/Cost))",
    "FT85": "IF(COLUMN(EW85:FR85) = MIN(IF(EW85:FR85=MAX(EW85:FR85), COLUMN(EW85:FR85))), 1, \"\")",
    "D86": "IF(SUM(FT85:GP85),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F86)),\"Card Mastery\",F86),G86)/$D$5,\"\")",
    "F86": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT85:GP85),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT85:GP85=1)),)\"),\"Critical Factor\")",
    "G86": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT85:GP85),ARRAYFORMULA(FILTER(BT85:CP85 , FT85:GP85=1)),\"\"\"\")\"),22.0)",
    "I86": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT85:GP85),ARRAYFORMULA(FILTER(EW85:FS85 , FT85:GP85=1))*D$5,\"\"\"\")\"),0.014459256109048113)",
    "K86": "IF(H86<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D86)),)",
    "BC86": "BC85+1",
    "BD86": "BD85+BD$3",
    "BE86": "BE85+BE$3",
    "BF86": "BF85+BF$3",
    "BH86": "BH85+BH$3",
    "BS86": "BW86",
    "BT86": "BT85+FT85",
    "BU86": "BU85+FU85",
    "BV86": "BV85+FV85",
    "BW86": "BW85+FW85",
    "BX86": "BX85+FX85",
    "BY86": "BY85+FY85",
    "BZ86": "BZ85+FZ85",
    "CA86": "CA85+GA85",
    "CB86": "CB85+GB85",
    "CC86": "CC85+GC85",
    "CD86": "CD85+GD85",
    "CE86": "CE85+GE85",
    "CF86": "CF85+GF85",
    "CG86": "CG85+GG85",
    "CH86": "CH85+GH85",
    "CI86": "CI85+GI85",
    "CJ86": "CJ85+GJ85",
    "CK86": "CK85+GK85",
    "CL86": "CL85+GL85",
    "CM86": "CM85+GM85",
    "CN86": "CN85+GN85",
    "CO86": "CO85+GO85",
    "CS86": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI86,1)",
    "CT86": "INDEX($BD$5:$BD231,BT86)",
    "CU86": "INDEX($BN$5:$BN231,CD86)",
    "CV86": "INDEX($BO$5:$BO231,CE86)",
    "CW86": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG86)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX86": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO86, 1)",
    "CY86": "LET(\n  Base, $CR$6,\n  Damage, $CT86,\n  DamageMastery, $CS86,\n  DemonMastery, $CX86,\n  SPB, $CU86,\n  ITO, $CV86,\n  Shock, $CW86,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ86": "MIN(100%, DA86)",
    "DA86": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK86*1%, 0)",
    "DB86": "LET(\n  Lab, 1+INDEX($BF$5:$BF231,BV86),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC86": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK86*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI231,BY86) + CardCritMastery)",
    "DD86": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK86*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ231,BZ86) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE86": "LET(\n  CF, $DB86,\n  CC, $CZ86,\n  SCM, $DD86,\n  SCC, $DC86,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF86": "LET(\n  CF, $DB86,\n  CC, $DA86,\n  SCM, $DD86,\n  SCC, $DC86,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG86": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH86)), 0)",
    "DH86": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ86*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE231,BU86),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI86": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG231, BW86), 1) + $AE$9)",
    "DJ86": "LET(\n  DpmLab, INDEX($BH$5:$BH231,BX86),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL86, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK86": "(1+$DI86*$DJ86*$AQ$9)",
    "DL86": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK231,CA86),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM86*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM86": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK231,CA86),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM86*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN86": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL231,CB86)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO86": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH86,\n  Rapid, DG86,\n  RDPM, DK86,\n  SuperTower, $DL86,\n  Rend, $DN86,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP86": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ86": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK86),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR86": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP86),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF86-1))",
    "DS86": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG86, DH86),0))",
    "DT86": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP86),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV86, $AR$29), 0))",
    "DU86": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK86),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM231,CC86), $DV86, $AR$29), 0))",
    "DV86": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH86), $AO$29)",
    "DW86": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM86,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86, $DB86), 1),\n\n  DW, $DR86,\n  CL, $DS86,\n  SM, $DT86,\n  SLM, $DU86,\n  SL, $DQ86,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX86": "CY86*(DE86*DO86*DQ86+DW86*DF86)",
    "DZ86": "IF(INDEX($BD$6:$BD231,BT86)=\"\", \"\", INDEX($BD$5:$BD231,BT86+1))",
    "EA86": "IF(OR($AO$25, INDEX($BE$6:$BE231,BU86)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ86)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE231,BU86+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI86*$DJ86*$AQ$9),\n  SuperTower, $DL86,\n  Rend, $DN86,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86, $DB86), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR86,\n  SM, $DT86,\n  SLM, $DU86,\n  SL, $DQ86,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM86, UltCritCard),\n\nCY86*(DE86*OtherDamage*SL+UwDamage*DF86)))",
    "EB86": "IF(INDEX($BF$6:$BF231,BV86)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF231,BV86+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ86,\n  CCUW, $DA86,\n  SCM, $DD86,\n  SCC, $DC86,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86, CF), 1),\n\n  DW, $DR86,\n  CL, $DS86,\n  SM, $DT86,\n  SLM, $DU86,\n  SL, $DQ86,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM86, UltCritCard),\n\nCY86 * (Critical * DO86 * SL + UwDamage * UWCritical)))",
    "EC86": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG231,BW86)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH86,\n  Rapid, DG86,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG231, BW86+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ86*$AQ$9),\n  SuperTower, $DL86,\n  Rend, $DN86,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM231,CC86), $DV86, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM86,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86, $DB86), 1),\n\n  DW, $DR86,\n  CL, $DS86,\n  SM, $DT86,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY86*(DE86*OtherDamage*SL+UWDamage*DF86)))",
    "ED86": "IF(OR($AO$25, INDEX($BH$6:$BH231,BX86)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH231,BX86+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL86, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI86*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM231,CC86), $DV86, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH86,\n  Rapid, DG86,\n  SuperTower, $DL86,\n  Rend, $DN86,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM86,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86, $DB86), 1),\n\n  DW, $DR86,\n  CL, $DS86,\n  SM, $DT86,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY86*(DE86*OtherDamage*SL+UWDamage*DF86)))",
    "EE86": "IF(INDEX($BI$6:$BI231,BY86)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK86, 0),\n  CF, $DB86,\n  CC, $CZ86,\n  CCUW, $DA86,\n  SCM, $DD86,\n  SCC, $AV$17+INDEX($BI$5:$BI231,BY86+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY86 * (Critical*DO86*$DQ86+DW86*UWCritical)))",
    "EF86": "IF(INDEX($BJ$6:$BJ231,BZ86)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK86*1%, 1),\n  CF, $DB86,\n  CC, $CZ86,\n  CCUW, $DA86,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ231,BZ86+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC86,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY86*(Critical*DO86*$DQ86+DW86*UWCritical)))",
    "EG86": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK231,CA86)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH86,\n  Rapid, DG86,\n  DPM, (1+$DI86*$DJ86*$AQ$9),\n  Rend, $DN86,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK231,CA86+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM86*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86, $DB86), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK231,CA86+1)-1))/(45-CM86*3),1),\n\n  SL, $DQ86,\n  DW, $DR86,\n  CL, $DS86,\n  SM, $DT86,\n  SLM, $DU86,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY86*(DE86*OtherDamage*SL+UwDamage*DF86)))",
    "EH86": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL231,CB86+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL231,CB86)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH86,\n  Rapid, DG86,\n  DPM, (1+$DI86*$DJ86*$AQ$9),\n  SuperTower, $DL86,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL231,CB86+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY86*(DE86*OtherDamage*$DQ86+DW86*DF86)))",
    "EI86": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM231,CC86)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86, $DB86), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK86),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV86, $AR$29), 0),\n\n  DW, $DR86,\n  CL, $DS86,\n  SM, $DT86,\n  SL, $DQ86,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM86, UltCritCard),\nCY86*(DE86*DO86*SL+UwDamage*DF86)))",
    "EJ86": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN231,CD86)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT86,\n  DamageMastery, $CS86,\n  DemonMastery, $CX86,\n  SPB, INDEX($BN$5:$BN231,CD86+1),\n  ITO, $CV86,\n  Shock, $CW86,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE86*DO86*$DQ86+DW86*DF86)))",
    "EK86": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO231,CE86)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT86,\n  DamageMastery, $CS86,\n  DemonMastery, $CX86,\n  SPB, $CU86,\n  ITO, INDEX($BO$5:$BO231,CE86+1),\n  Shock, $CW86,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE86*DO86*$DQ86+DW86*DF86)))",
    "EL86": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP231,CF86)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86, $DB86), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP86),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF86),\n  CL, $DS86,\n  SM, $DT86,\n  SLM, $DU86,\n  SL, $DQ86,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM86, UltCritCard),\nCY86*(DE86*DO86*SL+UwDamage*DF86)))",
    "EM86": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ231,CG86)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG86+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN86": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR231,CH86)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86, $DB86), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH86+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP86),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK86),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM231,CC86), SMHeat, $AR$29), 0),\n\n  DW, $DR86,\n  CL, $DS86,\n  SL, $DQ86,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM86, UltCritCard),\nCY86*(DE86*DO86*SL+UwDamage*DF86)))",
    "EO86": "IF(OR(CI86 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI86+1))",
    "EP86": "IF(OR($AO$25, CJ86 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ86+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE230,BU86),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL86, 1),\n  DPM, (1+$DI86*CardRangeMastery*$DJ86*$AQ$9),\n  SuperTower, $DL86,\n  Rend, $DN86,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86, $DB86), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR86,\n  SM, $DT86,\n  SLM, $DU86,\n  SL, $DQ86,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM86, UltCritCard),\n\nCY86*(DE86*OtherDamage*SL+UwDamage*DF86)))",
    "EQ86": "IF(OR(CK86 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK86+1)*1%, 1),\n  CF, $DB86,\n  CC, MIN(100%, $CZ86 + 1%),\n  CCUW, DA86 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ231,BZ86) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC86 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR86,\n  CL, $DS86,\n  SM, $DT86,\n  SLM, $DU86,\n  SL, $DQ86,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM86, UltCritCard),\n\nCY86 * (Critical*DO86*SL+UwDamage*UWCritical)))",
    "ER86": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL86 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH231,BX86),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL86+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI86*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM231,CC86), $DV86, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH86,\n  Rapid, DG86,\n  SuperTower, $DL86,\n  Rend, $DN86,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM86,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86, $DB86), 1),\n\n  DW, $DR86,\n  CL, $DS86,\n  SM, $DT86,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY86*(DE86*OtherDamage*SL+UWDamage*DF86)))",
    "ES86": "IF(OR(CM86 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH86,\n  Rapid, DG86,\n  RDPM, (1+$DI86*$DJ86*$AQ$9),\n  Rend, $DN86,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK231,CA86),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM86+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86, $DB86), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR86,\n  CL, $DS86,\n  SM, $DT86,\n  SLM, $DU86,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY86*(DE86*OtherDamage*SL+UwDamage*DF86)))",
    "ET86": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN86 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM86,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN86+1, $DB86), 1),\n\n  DW, $DR86,\n  CL, $DS86,\n  SM, $DT86,\n  SLM, $DU86,\n  SL, $DQ86,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY86*(DE86*DO86*SL+UWDamage*DF86)))",
    "EU86": "IF(OR(NOT($BA$3), NOT($BA$23), $CO86 > $BA$15), \"\", 1 + 0.5*(CO86+1))",
    "EW86": "IF(DZ86=\"\", \"\", LET(\n  Now, CT86,\n  Next, DZ86,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT86),\nFactor/Cost))",
    "EX86": "IF(EA86=\"\",\"\",(EA86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU86))",
    "EY86": "IF(EB86=\"\",\"\",(EB86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV86))",
    "EZ86": "IF(EC86=\"\",\"\",(EC86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW86))",
    "FA86": "IF(ED86=\"\",\"\",(ED86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX86))",
    "FB86": "IF(EE86=\"\",\"\",(EE86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY86))",
    "FC86": "IF(EF86=\"\",\"\",(EF86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ86))",
    "FD86": "IF(EG86=\"\",\"\",(EG86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA86))",
    "FE86": "IF(EH86=\"\",\"\",(EH86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB86))",
    "FF86": "IF(EI86=\"\",\"\",(EI86/$DX86-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC86+1, 1, CC86))))",
    "FG86": "IF(EJ86=\"\",\"\",(EJ86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD86))",
    "FH86": "IF(EK86=\"\",\"\",(EK86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE86))",
    "FI86": "IF(EL86=\"\",\"\",(EL86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF86))",
    "FJ86": "IF(EM86=\"\", \"\", LET(\n  Now, CW86,\n  Next, EM86,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG86),\nFactor/Cost))",
    "FK86": "IF(EN86=\"\",\"\",(EN86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH86))",
    "FL86": "IF(EO86=\"\", \"\", LET(\n  Now, CS86,\n  Next, EO86,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI86),\nFactor/Cost))",
    "FM86": "IF(EP86=\"\",\"\",(EP86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ86))",
    "FN86": "IF(EQ86=\"\",\"\",(EQ86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK86))",
    "FO86": "IF(ER86=\"\",\"\",(ER86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL86))",
    "FP86": "IF(ES86=\"\",\"\",(ES86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM86))",
    "FQ86": "IF(ET86=\"\",\"\",(ET86/$DX86-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN86))",
    "FR86": "IF(EU86=\"\", \"\", LET(\n  Now, CX86,\n  Next, EU86,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO86),\nFactor/Cost))",
    "FT86": "IF(COLUMN(EW86:FR86) = MIN(IF(EW86:FR86=MAX(EW86:FR86), COLUMN(EW86:FR86))), 1, \"\")",
    "D87": "IF(SUM(FT86:GP86),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F87)),\"Card Mastery\",F87),G87)/$D$5,\"\")",
    "F87": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT86:GP86),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT86:GP86=1)),)\"),\"Damage\")",
    "G87": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT86:GP86),ARRAYFORMULA(FILTER(BT86:CP86 , FT86:GP86=1)),\"\"\"\")\"),20.0)",
    "I87": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT86:GP86),ARRAYFORMULA(FILTER(EW86:FS86 , FT86:GP86=1))*D$5,\"\"\"\")\"),0.014274668411348425)",
    "K87": "IF(H87<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D87)),)",
    "BC87": "BC86+1",
    "BD87": "BD86+BD$3",
    "BE87": "BE86+BE$3",
    "BF87": "BF86+BF$3",
    "BH87": "BH86+BH$3",
    "BS87": "BW87",
    "BT87": "BT86+FT86",
    "BU87": "BU86+FU86",
    "BV87": "BV86+FV86",
    "BW87": "BW86+FW86",
    "BX87": "BX86+FX86",
    "BY87": "BY86+FY86",
    "BZ87": "BZ86+FZ86",
    "CA87": "CA86+GA86",
    "CB87": "CB86+GB86",
    "CC87": "CC86+GC86",
    "CD87": "CD86+GD86",
    "CE87": "CE86+GE86",
    "CF87": "CF86+GF86",
    "CG87": "CG86+GG86",
    "CH87": "CH86+GH86",
    "CI87": "CI86+GI86",
    "CJ87": "CJ86+GJ86",
    "CK87": "CK86+GK86",
    "CL87": "CL86+GL86",
    "CM87": "CM86+GM86",
    "CN87": "CN86+GN86",
    "CO87": "CO86+GO86",
    "CS87": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI87,1)",
    "CT87": "INDEX($BD$5:$BD232,BT87)",
    "CU87": "INDEX($BN$5:$BN232,CD87)",
    "CV87": "INDEX($BO$5:$BO232,CE87)",
    "CW87": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG87)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX87": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO87, 1)",
    "CY87": "LET(\n  Base, $CR$6,\n  Damage, $CT87,\n  DamageMastery, $CS87,\n  DemonMastery, $CX87,\n  SPB, $CU87,\n  ITO, $CV87,\n  Shock, $CW87,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ87": "MIN(100%, DA87)",
    "DA87": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK87*1%, 0)",
    "DB87": "LET(\n  Lab, 1+INDEX($BF$5:$BF232,BV87),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC87": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK87*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI232,BY87) + CardCritMastery)",
    "DD87": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK87*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ232,BZ87) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE87": "LET(\n  CF, $DB87,\n  CC, $CZ87,\n  SCM, $DD87,\n  SCC, $DC87,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF87": "LET(\n  CF, $DB87,\n  CC, $DA87,\n  SCM, $DD87,\n  SCC, $DC87,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG87": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH87)), 0)",
    "DH87": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ87*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE232,BU87),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI87": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG232, BW87), 1) + $AE$9)",
    "DJ87": "LET(\n  DpmLab, INDEX($BH$5:$BH232,BX87),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL87, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK87": "(1+$DI87*$DJ87*$AQ$9)",
    "DL87": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK232,CA87),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM87*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM87": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK232,CA87),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM87*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN87": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL232,CB87)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO87": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH87,\n  Rapid, DG87,\n  RDPM, DK87,\n  SuperTower, $DL87,\n  Rend, $DN87,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP87": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ87": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK87),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR87": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP87),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF87-1))",
    "DS87": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG87, DH87),0))",
    "DT87": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP87),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV87, $AR$29), 0))",
    "DU87": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK87),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM232,CC87), $DV87, $AR$29), 0))",
    "DV87": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH87), $AO$29)",
    "DW87": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM87,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87, $DB87), 1),\n\n  DW, $DR87,\n  CL, $DS87,\n  SM, $DT87,\n  SLM, $DU87,\n  SL, $DQ87,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX87": "CY87*(DE87*DO87*DQ87+DW87*DF87)",
    "DZ87": "IF(INDEX($BD$6:$BD232,BT87)=\"\", \"\", INDEX($BD$5:$BD232,BT87+1))",
    "EA87": "IF(OR($AO$25, INDEX($BE$6:$BE232,BU87)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ87)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE232,BU87+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI87*$DJ87*$AQ$9),\n  SuperTower, $DL87,\n  Rend, $DN87,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87, $DB87), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR87,\n  SM, $DT87,\n  SLM, $DU87,\n  SL, $DQ87,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM87, UltCritCard),\n\nCY87*(DE87*OtherDamage*SL+UwDamage*DF87)))",
    "EB87": "IF(INDEX($BF$6:$BF232,BV87)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF232,BV87+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ87,\n  CCUW, $DA87,\n  SCM, $DD87,\n  SCC, $DC87,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87, CF), 1),\n\n  DW, $DR87,\n  CL, $DS87,\n  SM, $DT87,\n  SLM, $DU87,\n  SL, $DQ87,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM87, UltCritCard),\n\nCY87 * (Critical * DO87 * SL + UwDamage * UWCritical)))",
    "EC87": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG232,BW87)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH87,\n  Rapid, DG87,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG232, BW87+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ87*$AQ$9),\n  SuperTower, $DL87,\n  Rend, $DN87,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM232,CC87), $DV87, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM87,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87, $DB87), 1),\n\n  DW, $DR87,\n  CL, $DS87,\n  SM, $DT87,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY87*(DE87*OtherDamage*SL+UWDamage*DF87)))",
    "ED87": "IF(OR($AO$25, INDEX($BH$6:$BH232,BX87)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH232,BX87+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL87, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI87*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM232,CC87), $DV87, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH87,\n  Rapid, DG87,\n  SuperTower, $DL87,\n  Rend, $DN87,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM87,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87, $DB87), 1),\n\n  DW, $DR87,\n  CL, $DS87,\n  SM, $DT87,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY87*(DE87*OtherDamage*SL+UWDamage*DF87)))",
    "EE87": "IF(INDEX($BI$6:$BI232,BY87)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK87, 0),\n  CF, $DB87,\n  CC, $CZ87,\n  CCUW, $DA87,\n  SCM, $DD87,\n  SCC, $AV$17+INDEX($BI$5:$BI232,BY87+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY87 * (Critical*DO87*$DQ87+DW87*UWCritical)))",
    "EF87": "IF(INDEX($BJ$6:$BJ232,BZ87)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK87*1%, 1),\n  CF, $DB87,\n  CC, $CZ87,\n  CCUW, $DA87,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ232,BZ87+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC87,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY87*(Critical*DO87*$DQ87+DW87*UWCritical)))",
    "EG87": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK232,CA87)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH87,\n  Rapid, DG87,\n  DPM, (1+$DI87*$DJ87*$AQ$9),\n  Rend, $DN87,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK232,CA87+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM87*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87, $DB87), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK232,CA87+1)-1))/(45-CM87*3),1),\n\n  SL, $DQ87,\n  DW, $DR87,\n  CL, $DS87,\n  SM, $DT87,\n  SLM, $DU87,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY87*(DE87*OtherDamage*SL+UwDamage*DF87)))",
    "EH87": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL232,CB87+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL232,CB87)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH87,\n  Rapid, DG87,\n  DPM, (1+$DI87*$DJ87*$AQ$9),\n  SuperTower, $DL87,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL232,CB87+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY87*(DE87*OtherDamage*$DQ87+DW87*DF87)))",
    "EI87": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM232,CC87)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87, $DB87), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK87),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV87, $AR$29), 0),\n\n  DW, $DR87,\n  CL, $DS87,\n  SM, $DT87,\n  SL, $DQ87,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM87, UltCritCard),\nCY87*(DE87*DO87*SL+UwDamage*DF87)))",
    "EJ87": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN232,CD87)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT87,\n  DamageMastery, $CS87,\n  DemonMastery, $CX87,\n  SPB, INDEX($BN$5:$BN232,CD87+1),\n  ITO, $CV87,\n  Shock, $CW87,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE87*DO87*$DQ87+DW87*DF87)))",
    "EK87": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO232,CE87)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT87,\n  DamageMastery, $CS87,\n  DemonMastery, $CX87,\n  SPB, $CU87,\n  ITO, INDEX($BO$5:$BO232,CE87+1),\n  Shock, $CW87,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE87*DO87*$DQ87+DW87*DF87)))",
    "EL87": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP232,CF87)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87, $DB87), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP87),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF87),\n  CL, $DS87,\n  SM, $DT87,\n  SLM, $DU87,\n  SL, $DQ87,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM87, UltCritCard),\nCY87*(DE87*DO87*SL+UwDamage*DF87)))",
    "EM87": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ232,CG87)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG87+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN87": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR232,CH87)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87, $DB87), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH87+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP87),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK87),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM232,CC87), SMHeat, $AR$29), 0),\n\n  DW, $DR87,\n  CL, $DS87,\n  SL, $DQ87,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM87, UltCritCard),\nCY87*(DE87*DO87*SL+UwDamage*DF87)))",
    "EO87": "IF(OR(CI87 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI87+1))",
    "EP87": "IF(OR($AO$25, CJ87 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ87+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE231,BU87),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL87, 1),\n  DPM, (1+$DI87*CardRangeMastery*$DJ87*$AQ$9),\n  SuperTower, $DL87,\n  Rend, $DN87,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87, $DB87), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR87,\n  SM, $DT87,\n  SLM, $DU87,\n  SL, $DQ87,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM87, UltCritCard),\n\nCY87*(DE87*OtherDamage*SL+UwDamage*DF87)))",
    "EQ87": "IF(OR(CK87 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK87+1)*1%, 1),\n  CF, $DB87,\n  CC, MIN(100%, $CZ87 + 1%),\n  CCUW, DA87 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ232,BZ87) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC87 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR87,\n  CL, $DS87,\n  SM, $DT87,\n  SLM, $DU87,\n  SL, $DQ87,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM87, UltCritCard),\n\nCY87 * (Critical*DO87*SL+UwDamage*UWCritical)))",
    "ER87": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL87 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH232,BX87),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL87+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI87*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM232,CC87), $DV87, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH87,\n  Rapid, DG87,\n  SuperTower, $DL87,\n  Rend, $DN87,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM87,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87, $DB87), 1),\n\n  DW, $DR87,\n  CL, $DS87,\n  SM, $DT87,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY87*(DE87*OtherDamage*SL+UWDamage*DF87)))",
    "ES87": "IF(OR(CM87 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH87,\n  Rapid, DG87,\n  RDPM, (1+$DI87*$DJ87*$AQ$9),\n  Rend, $DN87,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK232,CA87),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM87+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87, $DB87), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR87,\n  CL, $DS87,\n  SM, $DT87,\n  SLM, $DU87,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY87*(DE87*OtherDamage*SL+UwDamage*DF87)))",
    "ET87": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN87 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM87,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN87+1, $DB87), 1),\n\n  DW, $DR87,\n  CL, $DS87,\n  SM, $DT87,\n  SLM, $DU87,\n  SL, $DQ87,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY87*(DE87*DO87*SL+UWDamage*DF87)))",
    "EU87": "IF(OR(NOT($BA$3), NOT($BA$23), $CO87 > $BA$15), \"\", 1 + 0.5*(CO87+1))",
    "EW87": "IF(DZ87=\"\", \"\", LET(\n  Now, CT87,\n  Next, DZ87,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT87),\nFactor/Cost))",
    "EX87": "IF(EA87=\"\",\"\",(EA87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU87))",
    "EY87": "IF(EB87=\"\",\"\",(EB87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV87))",
    "EZ87": "IF(EC87=\"\",\"\",(EC87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW87))",
    "FA87": "IF(ED87=\"\",\"\",(ED87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX87))",
    "FB87": "IF(EE87=\"\",\"\",(EE87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY87))",
    "FC87": "IF(EF87=\"\",\"\",(EF87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ87))",
    "FD87": "IF(EG87=\"\",\"\",(EG87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA87))",
    "FE87": "IF(EH87=\"\",\"\",(EH87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB87))",
    "FF87": "IF(EI87=\"\",\"\",(EI87/$DX87-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC87+1, 1, CC87))))",
    "FG87": "IF(EJ87=\"\",\"\",(EJ87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD87))",
    "FH87": "IF(EK87=\"\",\"\",(EK87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE87))",
    "FI87": "IF(EL87=\"\",\"\",(EL87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF87))",
    "FJ87": "IF(EM87=\"\", \"\", LET(\n  Now, CW87,\n  Next, EM87,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG87),\nFactor/Cost))",
    "FK87": "IF(EN87=\"\",\"\",(EN87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH87))",
    "FL87": "IF(EO87=\"\", \"\", LET(\n  Now, CS87,\n  Next, EO87,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI87),\nFactor/Cost))",
    "FM87": "IF(EP87=\"\",\"\",(EP87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ87))",
    "FN87": "IF(EQ87=\"\",\"\",(EQ87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK87))",
    "FO87": "IF(ER87=\"\",\"\",(ER87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL87))",
    "FP87": "IF(ES87=\"\",\"\",(ES87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM87))",
    "FQ87": "IF(ET87=\"\",\"\",(ET87/$DX87-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN87))",
    "FR87": "IF(EU87=\"\", \"\", LET(\n  Now, CX87,\n  Next, EU87,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO87),\nFactor/Cost))",
    "FT87": "IF(COLUMN(EW87:FR87) = MIN(IF(EW87:FR87=MAX(EW87:FR87), COLUMN(EW87:FR87))), 1, \"\")",
    "D88": "IF(SUM(FT87:GP87),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F88)),\"Card Mastery\",F88),G88)/$D$5,\"\")",
    "F88": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT87:GP87),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT87:GP87=1)),)\"),\"Attack Speed\")",
    "G88": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT87:GP87),ARRAYFORMULA(FILTER(BT87:CP87 , FT87:GP87=1)),\"\"\"\")\"),20.0)",
    "I88": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT87:GP87),ARRAYFORMULA(FILTER(EW87:FS87 , FT87:GP87=1))*D$5,\"\"\"\")\"),0.014136961426309338)",
    "K88": "IF(H88<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D88)),)",
    "BC88": "BC87+1",
    "BD88": "BD87+BD$3",
    "BE88": "BE87+BE$3",
    "BF88": "BF87+BF$3",
    "BH88": "BH87+BH$3",
    "BS88": "BW88",
    "BT88": "BT87+FT87",
    "BU88": "BU87+FU87",
    "BV88": "BV87+FV87",
    "BW88": "BW87+FW87",
    "BX88": "BX87+FX87",
    "BY88": "BY87+FY87",
    "BZ88": "BZ87+FZ87",
    "CA88": "CA87+GA87",
    "CB88": "CB87+GB87",
    "CC88": "CC87+GC87",
    "CD88": "CD87+GD87",
    "CE88": "CE87+GE87",
    "CF88": "CF87+GF87",
    "CG88": "CG87+GG87",
    "CH88": "CH87+GH87",
    "CI88": "CI87+GI87",
    "CJ88": "CJ87+GJ87",
    "CK88": "CK87+GK87",
    "CL88": "CL87+GL87",
    "CM88": "CM87+GM87",
    "CN88": "CN87+GN87",
    "CO88": "CO87+GO87",
    "CS88": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI88,1)",
    "CT88": "INDEX($BD$5:$BD233,BT88)",
    "CU88": "INDEX($BN$5:$BN233,CD88)",
    "CV88": "INDEX($BO$5:$BO233,CE88)",
    "CW88": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG88)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX88": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO88, 1)",
    "CY88": "LET(\n  Base, $CR$6,\n  Damage, $CT88,\n  DamageMastery, $CS88,\n  DemonMastery, $CX88,\n  SPB, $CU88,\n  ITO, $CV88,\n  Shock, $CW88,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ88": "MIN(100%, DA88)",
    "DA88": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK88*1%, 0)",
    "DB88": "LET(\n  Lab, 1+INDEX($BF$5:$BF233,BV88),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC88": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK88*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI233,BY88) + CardCritMastery)",
    "DD88": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK88*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ233,BZ88) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE88": "LET(\n  CF, $DB88,\n  CC, $CZ88,\n  SCM, $DD88,\n  SCC, $DC88,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF88": "LET(\n  CF, $DB88,\n  CC, $DA88,\n  SCM, $DD88,\n  SCC, $DC88,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG88": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH88)), 0)",
    "DH88": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ88*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE233,BU88),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI88": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG233, BW88), 1) + $AE$9)",
    "DJ88": "LET(\n  DpmLab, INDEX($BH$5:$BH233,BX88),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL88, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK88": "(1+$DI88*$DJ88*$AQ$9)",
    "DL88": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK233,CA88),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM88*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM88": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK233,CA88),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM88*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN88": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL233,CB88)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO88": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH88,\n  Rapid, DG88,\n  RDPM, DK88,\n  SuperTower, $DL88,\n  Rend, $DN88,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP88": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ88": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK88),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR88": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP88),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF88-1))",
    "DS88": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG88, DH88),0))",
    "DT88": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP88),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV88, $AR$29), 0))",
    "DU88": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK88),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM233,CC88), $DV88, $AR$29), 0))",
    "DV88": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH88), $AO$29)",
    "DW88": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM88,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88, $DB88), 1),\n\n  DW, $DR88,\n  CL, $DS88,\n  SM, $DT88,\n  SLM, $DU88,\n  SL, $DQ88,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX88": "CY88*(DE88*DO88*DQ88+DW88*DF88)",
    "DZ88": "IF(INDEX($BD$6:$BD233,BT88)=\"\", \"\", INDEX($BD$5:$BD233,BT88+1))",
    "EA88": "IF(OR($AO$25, INDEX($BE$6:$BE233,BU88)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ88)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE233,BU88+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI88*$DJ88*$AQ$9),\n  SuperTower, $DL88,\n  Rend, $DN88,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88, $DB88), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR88,\n  SM, $DT88,\n  SLM, $DU88,\n  SL, $DQ88,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM88, UltCritCard),\n\nCY88*(DE88*OtherDamage*SL+UwDamage*DF88)))",
    "EB88": "IF(INDEX($BF$6:$BF233,BV88)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF233,BV88+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ88,\n  CCUW, $DA88,\n  SCM, $DD88,\n  SCC, $DC88,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88, CF), 1),\n\n  DW, $DR88,\n  CL, $DS88,\n  SM, $DT88,\n  SLM, $DU88,\n  SL, $DQ88,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM88, UltCritCard),\n\nCY88 * (Critical * DO88 * SL + UwDamage * UWCritical)))",
    "EC88": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG233,BW88)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH88,\n  Rapid, DG88,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG233, BW88+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ88*$AQ$9),\n  SuperTower, $DL88,\n  Rend, $DN88,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM233,CC88), $DV88, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM88,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88, $DB88), 1),\n\n  DW, $DR88,\n  CL, $DS88,\n  SM, $DT88,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY88*(DE88*OtherDamage*SL+UWDamage*DF88)))",
    "ED88": "IF(OR($AO$25, INDEX($BH$6:$BH233,BX88)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH233,BX88+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL88, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI88*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM233,CC88), $DV88, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH88,\n  Rapid, DG88,\n  SuperTower, $DL88,\n  Rend, $DN88,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM88,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88, $DB88), 1),\n\n  DW, $DR88,\n  CL, $DS88,\n  SM, $DT88,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY88*(DE88*OtherDamage*SL+UWDamage*DF88)))",
    "EE88": "IF(INDEX($BI$6:$BI233,BY88)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK88, 0),\n  CF, $DB88,\n  CC, $CZ88,\n  CCUW, $DA88,\n  SCM, $DD88,\n  SCC, $AV$17+INDEX($BI$5:$BI233,BY88+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY88 * (Critical*DO88*$DQ88+DW88*UWCritical)))",
    "EF88": "IF(INDEX($BJ$6:$BJ233,BZ88)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK88*1%, 1),\n  CF, $DB88,\n  CC, $CZ88,\n  CCUW, $DA88,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ233,BZ88+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC88,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY88*(Critical*DO88*$DQ88+DW88*UWCritical)))",
    "EG88": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK233,CA88)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH88,\n  Rapid, DG88,\n  DPM, (1+$DI88*$DJ88*$AQ$9),\n  Rend, $DN88,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK233,CA88+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM88*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88, $DB88), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK233,CA88+1)-1))/(45-CM88*3),1),\n\n  SL, $DQ88,\n  DW, $DR88,\n  CL, $DS88,\n  SM, $DT88,\n  SLM, $DU88,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY88*(DE88*OtherDamage*SL+UwDamage*DF88)))",
    "EH88": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL233,CB88+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL233,CB88)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH88,\n  Rapid, DG88,\n  DPM, (1+$DI88*$DJ88*$AQ$9),\n  SuperTower, $DL88,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL233,CB88+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY88*(DE88*OtherDamage*$DQ88+DW88*DF88)))",
    "EI88": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM233,CC88)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88, $DB88), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK88),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV88, $AR$29), 0),\n\n  DW, $DR88,\n  CL, $DS88,\n  SM, $DT88,\n  SL, $DQ88,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM88, UltCritCard),\nCY88*(DE88*DO88*SL+UwDamage*DF88)))",
    "EJ88": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN233,CD88)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT88,\n  DamageMastery, $CS88,\n  DemonMastery, $CX88,\n  SPB, INDEX($BN$5:$BN233,CD88+1),\n  ITO, $CV88,\n  Shock, $CW88,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE88*DO88*$DQ88+DW88*DF88)))",
    "EK88": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO233,CE88)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT88,\n  DamageMastery, $CS88,\n  DemonMastery, $CX88,\n  SPB, $CU88,\n  ITO, INDEX($BO$5:$BO233,CE88+1),\n  Shock, $CW88,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE88*DO88*$DQ88+DW88*DF88)))",
    "EL88": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP233,CF88)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88, $DB88), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP88),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF88),\n  CL, $DS88,\n  SM, $DT88,\n  SLM, $DU88,\n  SL, $DQ88,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM88, UltCritCard),\nCY88*(DE88*DO88*SL+UwDamage*DF88)))",
    "EM88": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ233,CG88)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG88+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN88": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR233,CH88)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88, $DB88), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH88+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP88),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK88),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM233,CC88), SMHeat, $AR$29), 0),\n\n  DW, $DR88,\n  CL, $DS88,\n  SL, $DQ88,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM88, UltCritCard),\nCY88*(DE88*DO88*SL+UwDamage*DF88)))",
    "EO88": "IF(OR(CI88 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI88+1))",
    "EP88": "IF(OR($AO$25, CJ88 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ88+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE232,BU88),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL88, 1),\n  DPM, (1+$DI88*CardRangeMastery*$DJ88*$AQ$9),\n  SuperTower, $DL88,\n  Rend, $DN88,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88, $DB88), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR88,\n  SM, $DT88,\n  SLM, $DU88,\n  SL, $DQ88,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM88, UltCritCard),\n\nCY88*(DE88*OtherDamage*SL+UwDamage*DF88)))",
    "EQ88": "IF(OR(CK88 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK88+1)*1%, 1),\n  CF, $DB88,\n  CC, MIN(100%, $CZ88 + 1%),\n  CCUW, DA88 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ233,BZ88) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC88 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR88,\n  CL, $DS88,\n  SM, $DT88,\n  SLM, $DU88,\n  SL, $DQ88,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM88, UltCritCard),\n\nCY88 * (Critical*DO88*SL+UwDamage*UWCritical)))",
    "ER88": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL88 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH233,BX88),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL88+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI88*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM233,CC88), $DV88, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH88,\n  Rapid, DG88,\n  SuperTower, $DL88,\n  Rend, $DN88,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM88,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88, $DB88), 1),\n\n  DW, $DR88,\n  CL, $DS88,\n  SM, $DT88,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY88*(DE88*OtherDamage*SL+UWDamage*DF88)))",
    "ES88": "IF(OR(CM88 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH88,\n  Rapid, DG88,\n  RDPM, (1+$DI88*$DJ88*$AQ$9),\n  Rend, $DN88,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK233,CA88),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM88+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88, $DB88), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR88,\n  CL, $DS88,\n  SM, $DT88,\n  SLM, $DU88,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY88*(DE88*OtherDamage*SL+UwDamage*DF88)))",
    "ET88": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN88 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM88,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN88+1, $DB88), 1),\n\n  DW, $DR88,\n  CL, $DS88,\n  SM, $DT88,\n  SLM, $DU88,\n  SL, $DQ88,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY88*(DE88*DO88*SL+UWDamage*DF88)))",
    "EU88": "IF(OR(NOT($BA$3), NOT($BA$23), $CO88 > $BA$15), \"\", 1 + 0.5*(CO88+1))",
    "EW88": "IF(DZ88=\"\", \"\", LET(\n  Now, CT88,\n  Next, DZ88,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT88),\nFactor/Cost))",
    "EX88": "IF(EA88=\"\",\"\",(EA88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU88))",
    "EY88": "IF(EB88=\"\",\"\",(EB88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV88))",
    "EZ88": "IF(EC88=\"\",\"\",(EC88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW88))",
    "FA88": "IF(ED88=\"\",\"\",(ED88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX88))",
    "FB88": "IF(EE88=\"\",\"\",(EE88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY88))",
    "FC88": "IF(EF88=\"\",\"\",(EF88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ88))",
    "FD88": "IF(EG88=\"\",\"\",(EG88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA88))",
    "FE88": "IF(EH88=\"\",\"\",(EH88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB88))",
    "FF88": "IF(EI88=\"\",\"\",(EI88/$DX88-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC88+1, 1, CC88))))",
    "FG88": "IF(EJ88=\"\",\"\",(EJ88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD88))",
    "FH88": "IF(EK88=\"\",\"\",(EK88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE88))",
    "FI88": "IF(EL88=\"\",\"\",(EL88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF88))",
    "FJ88": "IF(EM88=\"\", \"\", LET(\n  Now, CW88,\n  Next, EM88,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG88),\nFactor/Cost))",
    "FK88": "IF(EN88=\"\",\"\",(EN88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH88))",
    "FL88": "IF(EO88=\"\", \"\", LET(\n  Now, CS88,\n  Next, EO88,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI88),\nFactor/Cost))",
    "FM88": "IF(EP88=\"\",\"\",(EP88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ88))",
    "FN88": "IF(EQ88=\"\",\"\",(EQ88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK88))",
    "FO88": "IF(ER88=\"\",\"\",(ER88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL88))",
    "FP88": "IF(ES88=\"\",\"\",(ES88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM88))",
    "FQ88": "IF(ET88=\"\",\"\",(ET88/$DX88-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN88))",
    "FR88": "IF(EU88=\"\", \"\", LET(\n  Now, CX88,\n  Next, EU88,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO88),\nFactor/Cost))",
    "FT88": "IF(COLUMN(EW88:FR88) = MIN(IF(EW88:FR88=MAX(EW88:FR88), COLUMN(EW88:FR88))), 1, \"\")",
    "D89": "IF(SUM(FT88:GP88),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F89)),\"Card Mastery\",F89),G89)/$D$5,\"\")",
    "F89": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT88:GP88),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT88:GP88=1)),)\"),\"Damage / Meter\")",
    "G89": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT88:GP88),ARRAYFORMULA(FILTER(BT88:CP88 , FT88:GP88=1)),\"\"\"\")\"),15.0)",
    "I89": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT88:GP88),ARRAYFORMULA(FILTER(EW88:FS88 , FT88:GP88=1))*D$5,\"\"\"\")\"),0.013840005097486055)",
    "K89": "IF(H89<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D89)),)",
    "BC89": "BC88+1",
    "BD89": "BD88+BD$3",
    "BE89": "BE88+BE$3",
    "BF89": "BF88+BF$3",
    "BH89": "BH88+BH$3",
    "BT89": "BT88+FT88",
    "BU89": "BU88+FU88",
    "BV89": "BV88+FV88",
    "BW89": "BW88+FW88",
    "BX89": "BX88+FX88",
    "BY89": "BY88+FY88",
    "BZ89": "BZ88+FZ88",
    "CA89": "CA88+GA88",
    "CB89": "CB88+GB88",
    "CC89": "CC88+GC88",
    "CD89": "CD88+GD88",
    "CE89": "CE88+GE88",
    "CF89": "CF88+GF88",
    "CG89": "CG88+GG88",
    "CH89": "CH88+GH88",
    "CI89": "CI88+GI88",
    "CJ89": "CJ88+GJ88",
    "CK89": "CK88+GK88",
    "CL89": "CL88+GL88",
    "CM89": "CM88+GM88",
    "CN89": "CN88+GN88",
    "CO89": "CO88+GO88",
    "CS89": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI89,1)",
    "CT89": "INDEX($BD$5:$BD234,BT89)",
    "CU89": "INDEX($BN$5:$BN234,CD89)",
    "CV89": "INDEX($BO$5:$BO234,CE89)",
    "CW89": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG89)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX89": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO89, 1)",
    "CY89": "LET(\n  Base, $CR$6,\n  Damage, $CT89,\n  DamageMastery, $CS89,\n  DemonMastery, $CX89,\n  SPB, $CU89,\n  ITO, $CV89,\n  Shock, $CW89,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ89": "MIN(100%, DA89)",
    "DA89": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK89*1%, 0)",
    "DB89": "LET(\n  Lab, 1+INDEX($BF$5:$BF234,BV89),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC89": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK89*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI234,BY89) + CardCritMastery)",
    "DD89": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK89*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ234,BZ89) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE89": "LET(\n  CF, $DB89,\n  CC, $CZ89,\n  SCM, $DD89,\n  SCC, $DC89,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF89": "LET(\n  CF, $DB89,\n  CC, $DA89,\n  SCM, $DD89,\n  SCC, $DC89,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG89": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH89)), 0)",
    "DH89": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ89*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE234,BU89),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI89": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG234, BW89), 1) + $AE$9)",
    "DJ89": "LET(\n  DpmLab, INDEX($BH$5:$BH234,BX89),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL89, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK89": "(1+$DI89*$DJ89*$AQ$9)",
    "DL89": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK234,CA89),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM89*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM89": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK234,CA89),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM89*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN89": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL234,CB89)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO89": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH89,\n  Rapid, DG89,\n  RDPM, DK89,\n  SuperTower, $DL89,\n  Rend, $DN89,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP89": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ89": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK89),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR89": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP89),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF89-1))",
    "DS89": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG89, DH89),0))",
    "DT89": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP89),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV89, $AR$29), 0))",
    "DU89": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK89),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM234,CC89), $DV89, $AR$29), 0))",
    "DV89": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH89), $AO$29)",
    "DW89": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM89,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89, $DB89), 1),\n\n  DW, $DR89,\n  CL, $DS89,\n  SM, $DT89,\n  SLM, $DU89,\n  SL, $DQ89,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX89": "CY89*(DE89*DO89*DQ89+DW89*DF89)",
    "DZ89": "IF(INDEX($BD$6:$BD234,BT89)=\"\", \"\", INDEX($BD$5:$BD234,BT89+1))",
    "EA89": "IF(OR($AO$25, INDEX($BE$6:$BE234,BU89)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ89)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE234,BU89+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI89*$DJ89*$AQ$9),\n  SuperTower, $DL89,\n  Rend, $DN89,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89, $DB89), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR89,\n  SM, $DT89,\n  SLM, $DU89,\n  SL, $DQ89,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM89, UltCritCard),\n\nCY89*(DE89*OtherDamage*SL+UwDamage*DF89)))",
    "EB89": "IF(INDEX($BF$6:$BF234,BV89)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF234,BV89+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ89,\n  CCUW, $DA89,\n  SCM, $DD89,\n  SCC, $DC89,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89, CF), 1),\n\n  DW, $DR89,\n  CL, $DS89,\n  SM, $DT89,\n  SLM, $DU89,\n  SL, $DQ89,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM89, UltCritCard),\n\nCY89 * (Critical * DO89 * SL + UwDamage * UWCritical)))",
    "EC89": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG234,BW89)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH89,\n  Rapid, DG89,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG234, BW89+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ89*$AQ$9),\n  SuperTower, $DL89,\n  Rend, $DN89,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM234,CC89), $DV89, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM89,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89, $DB89), 1),\n\n  DW, $DR89,\n  CL, $DS89,\n  SM, $DT89,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY89*(DE89*OtherDamage*SL+UWDamage*DF89)))",
    "ED89": "IF(OR($AO$25, INDEX($BH$6:$BH234,BX89)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH234,BX89+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL89, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI89*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM234,CC89), $DV89, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH89,\n  Rapid, DG89,\n  SuperTower, $DL89,\n  Rend, $DN89,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM89,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89, $DB89), 1),\n\n  DW, $DR89,\n  CL, $DS89,\n  SM, $DT89,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY89*(DE89*OtherDamage*SL+UWDamage*DF89)))",
    "EE89": "IF(INDEX($BI$6:$BI234,BY89)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK89, 0),\n  CF, $DB89,\n  CC, $CZ89,\n  CCUW, $DA89,\n  SCM, $DD89,\n  SCC, $AV$17+INDEX($BI$5:$BI234,BY89+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY89 * (Critical*DO89*$DQ89+DW89*UWCritical)))",
    "EF89": "IF(INDEX($BJ$6:$BJ234,BZ89)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK89*1%, 1),\n  CF, $DB89,\n  CC, $CZ89,\n  CCUW, $DA89,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ234,BZ89+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC89,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY89*(Critical*DO89*$DQ89+DW89*UWCritical)))",
    "EG89": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK234,CA89)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH89,\n  Rapid, DG89,\n  DPM, (1+$DI89*$DJ89*$AQ$9),\n  Rend, $DN89,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK234,CA89+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM89*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89, $DB89), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK234,CA89+1)-1))/(45-CM89*3),1),\n\n  SL, $DQ89,\n  DW, $DR89,\n  CL, $DS89,\n  SM, $DT89,\n  SLM, $DU89,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY89*(DE89*OtherDamage*SL+UwDamage*DF89)))",
    "EH89": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL234,CB89+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL234,CB89)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH89,\n  Rapid, DG89,\n  DPM, (1+$DI89*$DJ89*$AQ$9),\n  SuperTower, $DL89,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL234,CB89+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY89*(DE89*OtherDamage*$DQ89+DW89*DF89)))",
    "EI89": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM234,CC89)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89, $DB89), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK89),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV89, $AR$29), 0),\n\n  DW, $DR89,\n  CL, $DS89,\n  SM, $DT89,\n  SL, $DQ89,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM89, UltCritCard),\nCY89*(DE89*DO89*SL+UwDamage*DF89)))",
    "EJ89": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN234,CD89)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT89,\n  DamageMastery, $CS89,\n  DemonMastery, $CX89,\n  SPB, INDEX($BN$5:$BN234,CD89+1),\n  ITO, $CV89,\n  Shock, $CW89,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE89*DO89*$DQ89+DW89*DF89)))",
    "EK89": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO234,CE89)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT89,\n  DamageMastery, $CS89,\n  DemonMastery, $CX89,\n  SPB, $CU89,\n  ITO, INDEX($BO$5:$BO234,CE89+1),\n  Shock, $CW89,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE89*DO89*$DQ89+DW89*DF89)))",
    "EL89": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP234,CF89)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89, $DB89), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP89),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF89),\n  CL, $DS89,\n  SM, $DT89,\n  SLM, $DU89,\n  SL, $DQ89,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM89, UltCritCard),\nCY89*(DE89*DO89*SL+UwDamage*DF89)))",
    "EM89": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ234,CG89)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG89+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN89": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR234,CH89)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89, $DB89), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH89+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP89),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK89),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM234,CC89), SMHeat, $AR$29), 0),\n\n  DW, $DR89,\n  CL, $DS89,\n  SL, $DQ89,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM89, UltCritCard),\nCY89*(DE89*DO89*SL+UwDamage*DF89)))",
    "EO89": "IF(OR(CI89 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI89+1))",
    "EP89": "IF(OR($AO$25, CJ89 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ89+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE233,BU89),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL89, 1),\n  DPM, (1+$DI89*CardRangeMastery*$DJ89*$AQ$9),\n  SuperTower, $DL89,\n  Rend, $DN89,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89, $DB89), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR89,\n  SM, $DT89,\n  SLM, $DU89,\n  SL, $DQ89,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM89, UltCritCard),\n\nCY89*(DE89*OtherDamage*SL+UwDamage*DF89)))",
    "EQ89": "IF(OR(CK89 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK89+1)*1%, 1),\n  CF, $DB89,\n  CC, MIN(100%, $CZ89 + 1%),\n  CCUW, DA89 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ234,BZ89) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC89 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR89,\n  CL, $DS89,\n  SM, $DT89,\n  SLM, $DU89,\n  SL, $DQ89,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM89, UltCritCard),\n\nCY89 * (Critical*DO89*SL+UwDamage*UWCritical)))",
    "ER89": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL89 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH234,BX89),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL89+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI89*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM234,CC89), $DV89, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH89,\n  Rapid, DG89,\n  SuperTower, $DL89,\n  Rend, $DN89,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM89,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89, $DB89), 1),\n\n  DW, $DR89,\n  CL, $DS89,\n  SM, $DT89,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY89*(DE89*OtherDamage*SL+UWDamage*DF89)))",
    "ES89": "IF(OR(CM89 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH89,\n  Rapid, DG89,\n  RDPM, (1+$DI89*$DJ89*$AQ$9),\n  Rend, $DN89,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK234,CA89),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM89+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89, $DB89), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR89,\n  CL, $DS89,\n  SM, $DT89,\n  SLM, $DU89,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY89*(DE89*OtherDamage*SL+UwDamage*DF89)))",
    "ET89": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN89 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM89,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN89+1, $DB89), 1),\n\n  DW, $DR89,\n  CL, $DS89,\n  SM, $DT89,\n  SLM, $DU89,\n  SL, $DQ89,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY89*(DE89*DO89*SL+UWDamage*DF89)))",
    "EU89": "IF(OR(NOT($BA$3), NOT($BA$23), $CO89 > $BA$15), \"\", 1 + 0.5*(CO89+1))",
    "EW89": "IF(DZ89=\"\", \"\", LET(\n  Now, CT89,\n  Next, DZ89,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT89),\nFactor/Cost))",
    "EX89": "IF(EA89=\"\",\"\",(EA89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU89))",
    "EY89": "IF(EB89=\"\",\"\",(EB89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV89))",
    "EZ89": "IF(EC89=\"\",\"\",(EC89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW89))",
    "FA89": "IF(ED89=\"\",\"\",(ED89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX89))",
    "FB89": "IF(EE89=\"\",\"\",(EE89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY89))",
    "FC89": "IF(EF89=\"\",\"\",(EF89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ89))",
    "FD89": "IF(EG89=\"\",\"\",(EG89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA89))",
    "FE89": "IF(EH89=\"\",\"\",(EH89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB89))",
    "FF89": "IF(EI89=\"\",\"\",(EI89/$DX89-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC89+1, 1, CC89))))",
    "FG89": "IF(EJ89=\"\",\"\",(EJ89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD89))",
    "FH89": "IF(EK89=\"\",\"\",(EK89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE89))",
    "FI89": "IF(EL89=\"\",\"\",(EL89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF89))",
    "FJ89": "IF(EM89=\"\", \"\", LET(\n  Now, CW89,\n  Next, EM89,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG89),\nFactor/Cost))",
    "FK89": "IF(EN89=\"\",\"\",(EN89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH89))",
    "FL89": "IF(EO89=\"\", \"\", LET(\n  Now, CS89,\n  Next, EO89,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI89),\nFactor/Cost))",
    "FM89": "IF(EP89=\"\",\"\",(EP89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ89))",
    "FN89": "IF(EQ89=\"\",\"\",(EQ89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK89))",
    "FO89": "IF(ER89=\"\",\"\",(ER89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL89))",
    "FP89": "IF(ES89=\"\",\"\",(ES89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM89))",
    "FQ89": "IF(ET89=\"\",\"\",(ET89/$DX89-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN89))",
    "FR89": "IF(EU89=\"\", \"\", LET(\n  Now, CX89,\n  Next, EU89,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO89),\nFactor/Cost))",
    "FT89": "IF(COLUMN(EW89:FR89) = MIN(IF(EW89:FR89=MAX(EW89:FR89), COLUMN(EW89:FR89))), 1, \"\")",
    "D90": "IF(SUM(FT89:GP89),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F90)),\"Card Mastery\",F90),G90)/$D$5,\"\")",
    "F90": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT89:GP89),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT89:GP89=1)),)\"),\"Critical Factor\")",
    "G90": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT89:GP89),ARRAYFORMULA(FILTER(BT89:CP89 , FT89:GP89=1)),\"\"\"\")\"),23.0)",
    "I90": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT89:GP89),ARRAYFORMULA(FILTER(EW89:FS89 , FT89:GP89=1))*D$5,\"\"\"\")\"),0.012751719625267569)",
    "K90": "IF(H90<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D90)),)",
    "BC90": "BC89+1",
    "BD90": "BD89+BD$3",
    "BE90": "BE89+BE$3",
    "BF90": "BF89+BF$3",
    "BH90": "BH89+BH$3",
    "BT90": "BT89+FT89",
    "BU90": "BU89+FU89",
    "BV90": "BV89+FV89",
    "BW90": "BW89+FW89",
    "BX90": "BX89+FX89",
    "BY90": "BY89+FY89",
    "BZ90": "BZ89+FZ89",
    "CA90": "CA89+GA89",
    "CB90": "CB89+GB89",
    "CC90": "CC89+GC89",
    "CD90": "CD89+GD89",
    "CE90": "CE89+GE89",
    "CF90": "CF89+GF89",
    "CG90": "CG89+GG89",
    "CH90": "CH89+GH89",
    "CI90": "CI89+GI89",
    "CJ90": "CJ89+GJ89",
    "CK90": "CK89+GK89",
    "CL90": "CL89+GL89",
    "CM90": "CM89+GM89",
    "CN90": "CN89+GN89",
    "CO90": "CO89+GO89",
    "CS90": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI90,1)",
    "CT90": "INDEX($BD$5:$BD235,BT90)",
    "CU90": "INDEX($BN$5:$BN235,CD90)",
    "CV90": "INDEX($BO$5:$BO235,CE90)",
    "CW90": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG90)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX90": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO90, 1)",
    "CY90": "LET(\n  Base, $CR$6,\n  Damage, $CT90,\n  DamageMastery, $CS90,\n  DemonMastery, $CX90,\n  SPB, $CU90,\n  ITO, $CV90,\n  Shock, $CW90,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ90": "MIN(100%, DA90)",
    "DA90": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK90*1%, 0)",
    "DB90": "LET(\n  Lab, 1+INDEX($BF$5:$BF235,BV90),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC90": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK90*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI235,BY90) + CardCritMastery)",
    "DD90": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK90*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ235,BZ90) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE90": "LET(\n  CF, $DB90,\n  CC, $CZ90,\n  SCM, $DD90,\n  SCC, $DC90,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF90": "LET(\n  CF, $DB90,\n  CC, $DA90,\n  SCM, $DD90,\n  SCC, $DC90,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG90": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH90)), 0)",
    "DH90": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ90*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE235,BU90),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI90": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG235, BW90), 1) + $AE$9)",
    "DJ90": "LET(\n  DpmLab, INDEX($BH$5:$BH235,BX90),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL90, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK90": "(1+$DI90*$DJ90*$AQ$9)",
    "DL90": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK235,CA90),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM90*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM90": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK235,CA90),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM90*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN90": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL235,CB90)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO90": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH90,\n  Rapid, DG90,\n  RDPM, DK90,\n  SuperTower, $DL90,\n  Rend, $DN90,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP90": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ90": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK90),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR90": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP90),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF90-1))",
    "DS90": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG90, DH90),0))",
    "DT90": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP90),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV90, $AR$29), 0))",
    "DU90": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK90),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM235,CC90), $DV90, $AR$29), 0))",
    "DV90": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH90), $AO$29)",
    "DW90": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM90,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90, $DB90), 1),\n\n  DW, $DR90,\n  CL, $DS90,\n  SM, $DT90,\n  SLM, $DU90,\n  SL, $DQ90,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX90": "CY90*(DE90*DO90*DQ90+DW90*DF90)",
    "DZ90": "IF(INDEX($BD$6:$BD235,BT90)=\"\", \"\", INDEX($BD$5:$BD235,BT90+1))",
    "EA90": "IF(OR($AO$25, INDEX($BE$6:$BE235,BU90)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ90)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE235,BU90+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI90*$DJ90*$AQ$9),\n  SuperTower, $DL90,\n  Rend, $DN90,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90, $DB90), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR90,\n  SM, $DT90,\n  SLM, $DU90,\n  SL, $DQ90,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM90, UltCritCard),\n\nCY90*(DE90*OtherDamage*SL+UwDamage*DF90)))",
    "EB90": "IF(INDEX($BF$6:$BF235,BV90)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF235,BV90+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ90,\n  CCUW, $DA90,\n  SCM, $DD90,\n  SCC, $DC90,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90, CF), 1),\n\n  DW, $DR90,\n  CL, $DS90,\n  SM, $DT90,\n  SLM, $DU90,\n  SL, $DQ90,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM90, UltCritCard),\n\nCY90 * (Critical * DO90 * SL + UwDamage * UWCritical)))",
    "EC90": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG235,BW90)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH90,\n  Rapid, DG90,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG235, BW90+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ90*$AQ$9),\n  SuperTower, $DL90,\n  Rend, $DN90,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM235,CC90), $DV90, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM90,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90, $DB90), 1),\n\n  DW, $DR90,\n  CL, $DS90,\n  SM, $DT90,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY90*(DE90*OtherDamage*SL+UWDamage*DF90)))",
    "ED90": "IF(OR($AO$25, INDEX($BH$6:$BH235,BX90)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH235,BX90+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL90, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI90*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM235,CC90), $DV90, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH90,\n  Rapid, DG90,\n  SuperTower, $DL90,\n  Rend, $DN90,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM90,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90, $DB90), 1),\n\n  DW, $DR90,\n  CL, $DS90,\n  SM, $DT90,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY90*(DE90*OtherDamage*SL+UWDamage*DF90)))",
    "EE90": "IF(INDEX($BI$6:$BI235,BY90)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK90, 0),\n  CF, $DB90,\n  CC, $CZ90,\n  CCUW, $DA90,\n  SCM, $DD90,\n  SCC, $AV$17+INDEX($BI$5:$BI235,BY90+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY90 * (Critical*DO90*$DQ90+DW90*UWCritical)))",
    "EF90": "IF(INDEX($BJ$6:$BJ235,BZ90)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK90*1%, 1),\n  CF, $DB90,\n  CC, $CZ90,\n  CCUW, $DA90,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ235,BZ90+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC90,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY90*(Critical*DO90*$DQ90+DW90*UWCritical)))",
    "EG90": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK235,CA90)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH90,\n  Rapid, DG90,\n  DPM, (1+$DI90*$DJ90*$AQ$9),\n  Rend, $DN90,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK235,CA90+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM90*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90, $DB90), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK235,CA90+1)-1))/(45-CM90*3),1),\n\n  SL, $DQ90,\n  DW, $DR90,\n  CL, $DS90,\n  SM, $DT90,\n  SLM, $DU90,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY90*(DE90*OtherDamage*SL+UwDamage*DF90)))",
    "EH90": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL235,CB90+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL235,CB90)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH90,\n  Rapid, DG90,\n  DPM, (1+$DI90*$DJ90*$AQ$9),\n  SuperTower, $DL90,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL235,CB90+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY90*(DE90*OtherDamage*$DQ90+DW90*DF90)))",
    "EI90": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM235,CC90)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90, $DB90), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK90),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV90, $AR$29), 0),\n\n  DW, $DR90,\n  CL, $DS90,\n  SM, $DT90,\n  SL, $DQ90,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM90, UltCritCard),\nCY90*(DE90*DO90*SL+UwDamage*DF90)))",
    "EJ90": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN235,CD90)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT90,\n  DamageMastery, $CS90,\n  DemonMastery, $CX90,\n  SPB, INDEX($BN$5:$BN235,CD90+1),\n  ITO, $CV90,\n  Shock, $CW90,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE90*DO90*$DQ90+DW90*DF90)))",
    "EK90": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO235,CE90)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT90,\n  DamageMastery, $CS90,\n  DemonMastery, $CX90,\n  SPB, $CU90,\n  ITO, INDEX($BO$5:$BO235,CE90+1),\n  Shock, $CW90,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE90*DO90*$DQ90+DW90*DF90)))",
    "EL90": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP235,CF90)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90, $DB90), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP90),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF90),\n  CL, $DS90,\n  SM, $DT90,\n  SLM, $DU90,\n  SL, $DQ90,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM90, UltCritCard),\nCY90*(DE90*DO90*SL+UwDamage*DF90)))",
    "EM90": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ235,CG90)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG90+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN90": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR235,CH90)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90, $DB90), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH90+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP90),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK90),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM235,CC90), SMHeat, $AR$29), 0),\n\n  DW, $DR90,\n  CL, $DS90,\n  SL, $DQ90,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM90, UltCritCard),\nCY90*(DE90*DO90*SL+UwDamage*DF90)))",
    "EO90": "IF(OR(CI90 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI90+1))",
    "EP90": "IF(OR($AO$25, CJ90 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ90+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE234,BU90),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL90, 1),\n  DPM, (1+$DI90*CardRangeMastery*$DJ90*$AQ$9),\n  SuperTower, $DL90,\n  Rend, $DN90,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90, $DB90), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR90,\n  SM, $DT90,\n  SLM, $DU90,\n  SL, $DQ90,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM90, UltCritCard),\n\nCY90*(DE90*OtherDamage*SL+UwDamage*DF90)))",
    "EQ90": "IF(OR(CK90 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK90+1)*1%, 1),\n  CF, $DB90,\n  CC, MIN(100%, $CZ90 + 1%),\n  CCUW, DA90 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ235,BZ90) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC90 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR90,\n  CL, $DS90,\n  SM, $DT90,\n  SLM, $DU90,\n  SL, $DQ90,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM90, UltCritCard),\n\nCY90 * (Critical*DO90*SL+UwDamage*UWCritical)))",
    "ER90": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL90 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH235,BX90),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL90+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI90*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM235,CC90), $DV90, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH90,\n  Rapid, DG90,\n  SuperTower, $DL90,\n  Rend, $DN90,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM90,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90, $DB90), 1),\n\n  DW, $DR90,\n  CL, $DS90,\n  SM, $DT90,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY90*(DE90*OtherDamage*SL+UWDamage*DF90)))",
    "ES90": "IF(OR(CM90 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH90,\n  Rapid, DG90,\n  RDPM, (1+$DI90*$DJ90*$AQ$9),\n  Rend, $DN90,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK235,CA90),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM90+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90, $DB90), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR90,\n  CL, $DS90,\n  SM, $DT90,\n  SLM, $DU90,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY90*(DE90*OtherDamage*SL+UwDamage*DF90)))",
    "ET90": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN90 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM90,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN90+1, $DB90), 1),\n\n  DW, $DR90,\n  CL, $DS90,\n  SM, $DT90,\n  SLM, $DU90,\n  SL, $DQ90,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY90*(DE90*DO90*SL+UWDamage*DF90)))",
    "EU90": "IF(OR(NOT($BA$3), NOT($BA$23), $CO90 > $BA$15), \"\", 1 + 0.5*(CO90+1))",
    "EW90": "IF(DZ90=\"\", \"\", LET(\n  Now, CT90,\n  Next, DZ90,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT90),\nFactor/Cost))",
    "EX90": "IF(EA90=\"\",\"\",(EA90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU90))",
    "EY90": "IF(EB90=\"\",\"\",(EB90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV90))",
    "EZ90": "IF(EC90=\"\",\"\",(EC90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW90))",
    "FA90": "IF(ED90=\"\",\"\",(ED90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX90))",
    "FB90": "IF(EE90=\"\",\"\",(EE90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY90))",
    "FC90": "IF(EF90=\"\",\"\",(EF90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ90))",
    "FD90": "IF(EG90=\"\",\"\",(EG90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA90))",
    "FE90": "IF(EH90=\"\",\"\",(EH90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB90))",
    "FF90": "IF(EI90=\"\",\"\",(EI90/$DX90-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC90+1, 1, CC90))))",
    "FG90": "IF(EJ90=\"\",\"\",(EJ90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD90))",
    "FH90": "IF(EK90=\"\",\"\",(EK90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE90))",
    "FI90": "IF(EL90=\"\",\"\",(EL90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF90))",
    "FJ90": "IF(EM90=\"\", \"\", LET(\n  Now, CW90,\n  Next, EM90,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG90),\nFactor/Cost))",
    "FK90": "IF(EN90=\"\",\"\",(EN90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH90))",
    "FL90": "IF(EO90=\"\", \"\", LET(\n  Now, CS90,\n  Next, EO90,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI90),\nFactor/Cost))",
    "FM90": "IF(EP90=\"\",\"\",(EP90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ90))",
    "FN90": "IF(EQ90=\"\",\"\",(EQ90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK90))",
    "FO90": "IF(ER90=\"\",\"\",(ER90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL90))",
    "FP90": "IF(ES90=\"\",\"\",(ES90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM90))",
    "FQ90": "IF(ET90=\"\",\"\",(ET90/$DX90-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN90))",
    "FR90": "IF(EU90=\"\", \"\", LET(\n  Now, CX90,\n  Next, EU90,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO90),\nFactor/Cost))",
    "FT90": "IF(COLUMN(EW90:FR90) = MIN(IF(EW90:FR90=MAX(EW90:FR90), COLUMN(EW90:FR90))), 1, \"\")",
    "D91": "IF(SUM(FT90:GP90),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F91)),\"Card Mastery\",F91),G91)/$D$5,\"\")",
    "F91": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT90:GP90),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT90:GP90=1)),)\"),\"Damage\")",
    "G91": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT90:GP90),ARRAYFORMULA(FILTER(BT90:CP90 , FT90:GP90=1)),\"\"\"\")\"),21.0)",
    "I91": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT90:GP90),ARRAYFORMULA(FILTER(EW90:FS90 , FT90:GP90=1))*D$5,\"\"\"\")\"),0.012497830237805893)",
    "K91": "IF(H91<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D91)),)",
    "BC91": "BC90+1",
    "BD91": "BD90+BD$3",
    "BE91": "BE90+BE$3",
    "BF91": "BF90+BF$3",
    "BH91": "BH90+BH$3",
    "BT91": "BT90+FT90",
    "BU91": "BU90+FU90",
    "BV91": "BV90+FV90",
    "BW91": "BW90+FW90",
    "BX91": "BX90+FX90",
    "BY91": "BY90+FY90",
    "BZ91": "BZ90+FZ90",
    "CA91": "CA90+GA90",
    "CB91": "CB90+GB90",
    "CC91": "CC90+GC90",
    "CD91": "CD90+GD90",
    "CE91": "CE90+GE90",
    "CF91": "CF90+GF90",
    "CG91": "CG90+GG90",
    "CH91": "CH90+GH90",
    "CI91": "CI90+GI90",
    "CJ91": "CJ90+GJ90",
    "CK91": "CK90+GK90",
    "CL91": "CL90+GL90",
    "CM91": "CM90+GM90",
    "CN91": "CN90+GN90",
    "CO91": "CO90+GO90",
    "CS91": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI91,1)",
    "CT91": "INDEX($BD$5:$BD236,BT91)",
    "CU91": "INDEX($BN$5:$BN236,CD91)",
    "CV91": "INDEX($BO$5:$BO236,CE91)",
    "CW91": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG91)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX91": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO91, 1)",
    "CY91": "LET(\n  Base, $CR$6,\n  Damage, $CT91,\n  DamageMastery, $CS91,\n  DemonMastery, $CX91,\n  SPB, $CU91,\n  ITO, $CV91,\n  Shock, $CW91,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ91": "MIN(100%, DA91)",
    "DA91": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK91*1%, 0)",
    "DB91": "LET(\n  Lab, 1+INDEX($BF$5:$BF236,BV91),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC91": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK91*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI236,BY91) + CardCritMastery)",
    "DD91": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK91*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ236,BZ91) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE91": "LET(\n  CF, $DB91,\n  CC, $CZ91,\n  SCM, $DD91,\n  SCC, $DC91,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF91": "LET(\n  CF, $DB91,\n  CC, $DA91,\n  SCM, $DD91,\n  SCC, $DC91,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG91": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH91)), 0)",
    "DH91": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ91*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE236,BU91),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI91": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG236, BW91), 1) + $AE$9)",
    "DJ91": "LET(\n  DpmLab, INDEX($BH$5:$BH236,BX91),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL91, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK91": "(1+$DI91*$DJ91*$AQ$9)",
    "DL91": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK236,CA91),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM91*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM91": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK236,CA91),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM91*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN91": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL236,CB91)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO91": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH91,\n  Rapid, DG91,\n  RDPM, DK91,\n  SuperTower, $DL91,\n  Rend, $DN91,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP91": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ91": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK91),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR91": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP91),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF91-1))",
    "DS91": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG91, DH91),0))",
    "DT91": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP91),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV91, $AR$29), 0))",
    "DU91": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK91),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM236,CC91), $DV91, $AR$29), 0))",
    "DV91": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH91), $AO$29)",
    "DW91": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM91,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91, $DB91), 1),\n\n  DW, $DR91,\n  CL, $DS91,\n  SM, $DT91,\n  SLM, $DU91,\n  SL, $DQ91,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX91": "CY91*(DE91*DO91*DQ91+DW91*DF91)",
    "DZ91": "IF(INDEX($BD$6:$BD236,BT91)=\"\", \"\", INDEX($BD$5:$BD236,BT91+1))",
    "EA91": "IF(OR($AO$25, INDEX($BE$6:$BE236,BU91)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ91)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE236,BU91+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI91*$DJ91*$AQ$9),\n  SuperTower, $DL91,\n  Rend, $DN91,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91, $DB91), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR91,\n  SM, $DT91,\n  SLM, $DU91,\n  SL, $DQ91,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM91, UltCritCard),\n\nCY91*(DE91*OtherDamage*SL+UwDamage*DF91)))",
    "EB91": "IF(INDEX($BF$6:$BF236,BV91)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF236,BV91+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ91,\n  CCUW, $DA91,\n  SCM, $DD91,\n  SCC, $DC91,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91, CF), 1),\n\n  DW, $DR91,\n  CL, $DS91,\n  SM, $DT91,\n  SLM, $DU91,\n  SL, $DQ91,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM91, UltCritCard),\n\nCY91 * (Critical * DO91 * SL + UwDamage * UWCritical)))",
    "EC91": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG236,BW91)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH91,\n  Rapid, DG91,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG236, BW91+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ91*$AQ$9),\n  SuperTower, $DL91,\n  Rend, $DN91,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM236,CC91), $DV91, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM91,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91, $DB91), 1),\n\n  DW, $DR91,\n  CL, $DS91,\n  SM, $DT91,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY91*(DE91*OtherDamage*SL+UWDamage*DF91)))",
    "ED91": "IF(OR($AO$25, INDEX($BH$6:$BH236,BX91)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH236,BX91+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL91, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI91*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM236,CC91), $DV91, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH91,\n  Rapid, DG91,\n  SuperTower, $DL91,\n  Rend, $DN91,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM91,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91, $DB91), 1),\n\n  DW, $DR91,\n  CL, $DS91,\n  SM, $DT91,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY91*(DE91*OtherDamage*SL+UWDamage*DF91)))",
    "EE91": "IF(INDEX($BI$6:$BI236,BY91)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK91, 0),\n  CF, $DB91,\n  CC, $CZ91,\n  CCUW, $DA91,\n  SCM, $DD91,\n  SCC, $AV$17+INDEX($BI$5:$BI236,BY91+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY91 * (Critical*DO91*$DQ91+DW91*UWCritical)))",
    "EF91": "IF(INDEX($BJ$6:$BJ236,BZ91)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK91*1%, 1),\n  CF, $DB91,\n  CC, $CZ91,\n  CCUW, $DA91,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ236,BZ91+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC91,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY91*(Critical*DO91*$DQ91+DW91*UWCritical)))",
    "EG91": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK236,CA91)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH91,\n  Rapid, DG91,\n  DPM, (1+$DI91*$DJ91*$AQ$9),\n  Rend, $DN91,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK236,CA91+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM91*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91, $DB91), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK236,CA91+1)-1))/(45-CM91*3),1),\n\n  SL, $DQ91,\n  DW, $DR91,\n  CL, $DS91,\n  SM, $DT91,\n  SLM, $DU91,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY91*(DE91*OtherDamage*SL+UwDamage*DF91)))",
    "EH91": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL236,CB91+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL236,CB91)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH91,\n  Rapid, DG91,\n  DPM, (1+$DI91*$DJ91*$AQ$9),\n  SuperTower, $DL91,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL236,CB91+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY91*(DE91*OtherDamage*$DQ91+DW91*DF91)))",
    "EI91": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM236,CC91)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91, $DB91), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK91),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV91, $AR$29), 0),\n\n  DW, $DR91,\n  CL, $DS91,\n  SM, $DT91,\n  SL, $DQ91,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM91, UltCritCard),\nCY91*(DE91*DO91*SL+UwDamage*DF91)))",
    "EJ91": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN236,CD91)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT91,\n  DamageMastery, $CS91,\n  DemonMastery, $CX91,\n  SPB, INDEX($BN$5:$BN236,CD91+1),\n  ITO, $CV91,\n  Shock, $CW91,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE91*DO91*$DQ91+DW91*DF91)))",
    "EK91": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO236,CE91)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT91,\n  DamageMastery, $CS91,\n  DemonMastery, $CX91,\n  SPB, $CU91,\n  ITO, INDEX($BO$5:$BO236,CE91+1),\n  Shock, $CW91,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE91*DO91*$DQ91+DW91*DF91)))",
    "EL91": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP236,CF91)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91, $DB91), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP91),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF91),\n  CL, $DS91,\n  SM, $DT91,\n  SLM, $DU91,\n  SL, $DQ91,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM91, UltCritCard),\nCY91*(DE91*DO91*SL+UwDamage*DF91)))",
    "EM91": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ236,CG91)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG91+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN91": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR236,CH91)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91, $DB91), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH91+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP91),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK91),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM236,CC91), SMHeat, $AR$29), 0),\n\n  DW, $DR91,\n  CL, $DS91,\n  SL, $DQ91,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM91, UltCritCard),\nCY91*(DE91*DO91*SL+UwDamage*DF91)))",
    "EO91": "IF(OR(CI91 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI91+1))",
    "EP91": "IF(OR($AO$25, CJ91 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ91+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE235,BU91),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL91, 1),\n  DPM, (1+$DI91*CardRangeMastery*$DJ91*$AQ$9),\n  SuperTower, $DL91,\n  Rend, $DN91,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91, $DB91), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR91,\n  SM, $DT91,\n  SLM, $DU91,\n  SL, $DQ91,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM91, UltCritCard),\n\nCY91*(DE91*OtherDamage*SL+UwDamage*DF91)))",
    "EQ91": "IF(OR(CK91 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK91+1)*1%, 1),\n  CF, $DB91,\n  CC, MIN(100%, $CZ91 + 1%),\n  CCUW, DA91 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ236,BZ91) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC91 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR91,\n  CL, $DS91,\n  SM, $DT91,\n  SLM, $DU91,\n  SL, $DQ91,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM91, UltCritCard),\n\nCY91 * (Critical*DO91*SL+UwDamage*UWCritical)))",
    "ER91": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL91 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH236,BX91),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL91+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI91*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM236,CC91), $DV91, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH91,\n  Rapid, DG91,\n  SuperTower, $DL91,\n  Rend, $DN91,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM91,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91, $DB91), 1),\n\n  DW, $DR91,\n  CL, $DS91,\n  SM, $DT91,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY91*(DE91*OtherDamage*SL+UWDamage*DF91)))",
    "ES91": "IF(OR(CM91 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH91,\n  Rapid, DG91,\n  RDPM, (1+$DI91*$DJ91*$AQ$9),\n  Rend, $DN91,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK236,CA91),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM91+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91, $DB91), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR91,\n  CL, $DS91,\n  SM, $DT91,\n  SLM, $DU91,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY91*(DE91*OtherDamage*SL+UwDamage*DF91)))",
    "ET91": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN91 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM91,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN91+1, $DB91), 1),\n\n  DW, $DR91,\n  CL, $DS91,\n  SM, $DT91,\n  SLM, $DU91,\n  SL, $DQ91,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY91*(DE91*DO91*SL+UWDamage*DF91)))",
    "EU91": "IF(OR(NOT($BA$3), NOT($BA$23), $CO91 > $BA$15), \"\", 1 + 0.5*(CO91+1))",
    "EW91": "IF(DZ91=\"\", \"\", LET(\n  Now, CT91,\n  Next, DZ91,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT91),\nFactor/Cost))",
    "EX91": "IF(EA91=\"\",\"\",(EA91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU91))",
    "EY91": "IF(EB91=\"\",\"\",(EB91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV91))",
    "EZ91": "IF(EC91=\"\",\"\",(EC91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW91))",
    "FA91": "IF(ED91=\"\",\"\",(ED91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX91))",
    "FB91": "IF(EE91=\"\",\"\",(EE91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY91))",
    "FC91": "IF(EF91=\"\",\"\",(EF91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ91))",
    "FD91": "IF(EG91=\"\",\"\",(EG91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA91))",
    "FE91": "IF(EH91=\"\",\"\",(EH91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB91))",
    "FF91": "IF(EI91=\"\",\"\",(EI91/$DX91-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC91+1, 1, CC91))))",
    "FG91": "IF(EJ91=\"\",\"\",(EJ91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD91))",
    "FH91": "IF(EK91=\"\",\"\",(EK91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE91))",
    "FI91": "IF(EL91=\"\",\"\",(EL91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF91))",
    "FJ91": "IF(EM91=\"\", \"\", LET(\n  Now, CW91,\n  Next, EM91,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG91),\nFactor/Cost))",
    "FK91": "IF(EN91=\"\",\"\",(EN91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH91))",
    "FL91": "IF(EO91=\"\", \"\", LET(\n  Now, CS91,\n  Next, EO91,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI91),\nFactor/Cost))",
    "FM91": "IF(EP91=\"\",\"\",(EP91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ91))",
    "FN91": "IF(EQ91=\"\",\"\",(EQ91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK91))",
    "FO91": "IF(ER91=\"\",\"\",(ER91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL91))",
    "FP91": "IF(ES91=\"\",\"\",(ES91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM91))",
    "FQ91": "IF(ET91=\"\",\"\",(ET91/$DX91-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN91))",
    "FR91": "IF(EU91=\"\", \"\", LET(\n  Now, CX91,\n  Next, EU91,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO91),\nFactor/Cost))",
    "FT91": "IF(COLUMN(EW91:FR91) = MIN(IF(EW91:FR91=MAX(EW91:FR91), COLUMN(EW91:FR91))), 1, \"\")",
    "D92": "IF(SUM(FT91:GP91),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F92)),\"Card Mastery\",F92),G92)/$D$5,\"\")",
    "F92": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT91:GP91),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT91:GP91=1)),)\"),\"Attack Speed\")",
    "G92": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT91:GP91),ARRAYFORMULA(FILTER(BT91:CP91 , FT91:GP91=1)),\"\"\"\")\"),21.0)",
    "I92": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT91:GP91),ARRAYFORMULA(FILTER(EW91:FS91 , FT91:GP91=1))*D$5,\"\"\"\")\"),0.012362357611744855)",
    "K92": "IF(H92<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D92)),)",
    "BC92": "BC91+1",
    "BD92": "BD91+BD$3",
    "BE92": "BE91+BE$3",
    "BF92": "BF91+BF$3",
    "BH92": "BH91+BH$3",
    "BT92": "BT91+FT91",
    "BU92": "BU91+FU91",
    "BV92": "BV91+FV91",
    "BW92": "BW91+FW91",
    "BX92": "BX91+FX91",
    "BY92": "BY91+FY91",
    "BZ92": "BZ91+FZ91",
    "CA92": "CA91+GA91",
    "CB92": "CB91+GB91",
    "CC92": "CC91+GC91",
    "CD92": "CD91+GD91",
    "CE92": "CE91+GE91",
    "CF92": "CF91+GF91",
    "CG92": "CG91+GG91",
    "CH92": "CH91+GH91",
    "CI92": "CI91+GI91",
    "CJ92": "CJ91+GJ91",
    "CK92": "CK91+GK91",
    "CL92": "CL91+GL91",
    "CM92": "CM91+GM91",
    "CN92": "CN91+GN91",
    "CO92": "CO91+GO91",
    "CS92": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI92,1)",
    "CT92": "INDEX($BD$5:$BD237,BT92)",
    "CU92": "INDEX($BN$5:$BN237,CD92)",
    "CV92": "INDEX($BO$5:$BO237,CE92)",
    "CW92": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG92)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX92": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO92, 1)",
    "CY92": "LET(\n  Base, $CR$6,\n  Damage, $CT92,\n  DamageMastery, $CS92,\n  DemonMastery, $CX92,\n  SPB, $CU92,\n  ITO, $CV92,\n  Shock, $CW92,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ92": "MIN(100%, DA92)",
    "DA92": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK92*1%, 0)",
    "DB92": "LET(\n  Lab, 1+INDEX($BF$5:$BF237,BV92),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC92": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK92*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI237,BY92) + CardCritMastery)",
    "DD92": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK92*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ237,BZ92) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE92": "LET(\n  CF, $DB92,\n  CC, $CZ92,\n  SCM, $DD92,\n  SCC, $DC92,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF92": "LET(\n  CF, $DB92,\n  CC, $DA92,\n  SCM, $DD92,\n  SCC, $DC92,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG92": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH92)), 0)",
    "DH92": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ92*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE237,BU92),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI92": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG237, BW92), 1) + $AE$9)",
    "DJ92": "LET(\n  DpmLab, INDEX($BH$5:$BH237,BX92),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL92, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK92": "(1+$DI92*$DJ92*$AQ$9)",
    "DL92": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK237,CA92),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM92*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM92": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK237,CA92),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM92*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN92": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL237,CB92)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO92": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH92,\n  Rapid, DG92,\n  RDPM, DK92,\n  SuperTower, $DL92,\n  Rend, $DN92,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP92": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ92": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK92),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR92": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP92),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF92-1))",
    "DS92": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG92, DH92),0))",
    "DT92": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP92),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV92, $AR$29), 0))",
    "DU92": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK92),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM237,CC92), $DV92, $AR$29), 0))",
    "DV92": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH92), $AO$29)",
    "DW92": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM92,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92, $DB92), 1),\n\n  DW, $DR92,\n  CL, $DS92,\n  SM, $DT92,\n  SLM, $DU92,\n  SL, $DQ92,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX92": "CY92*(DE92*DO92*DQ92+DW92*DF92)",
    "DZ92": "IF(INDEX($BD$6:$BD237,BT92)=\"\", \"\", INDEX($BD$5:$BD237,BT92+1))",
    "EA92": "IF(OR($AO$25, INDEX($BE$6:$BE237,BU92)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ92)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE237,BU92+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI92*$DJ92*$AQ$9),\n  SuperTower, $DL92,\n  Rend, $DN92,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92, $DB92), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR92,\n  SM, $DT92,\n  SLM, $DU92,\n  SL, $DQ92,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM92, UltCritCard),\n\nCY92*(DE92*OtherDamage*SL+UwDamage*DF92)))",
    "EB92": "IF(INDEX($BF$6:$BF237,BV92)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF237,BV92+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ92,\n  CCUW, $DA92,\n  SCM, $DD92,\n  SCC, $DC92,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92, CF), 1),\n\n  DW, $DR92,\n  CL, $DS92,\n  SM, $DT92,\n  SLM, $DU92,\n  SL, $DQ92,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM92, UltCritCard),\n\nCY92 * (Critical * DO92 * SL + UwDamage * UWCritical)))",
    "EC92": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG237,BW92)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH92,\n  Rapid, DG92,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG237, BW92+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ92*$AQ$9),\n  SuperTower, $DL92,\n  Rend, $DN92,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM237,CC92), $DV92, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM92,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92, $DB92), 1),\n\n  DW, $DR92,\n  CL, $DS92,\n  SM, $DT92,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY92*(DE92*OtherDamage*SL+UWDamage*DF92)))",
    "ED92": "IF(OR($AO$25, INDEX($BH$6:$BH237,BX92)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH237,BX92+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL92, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI92*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM237,CC92), $DV92, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH92,\n  Rapid, DG92,\n  SuperTower, $DL92,\n  Rend, $DN92,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM92,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92, $DB92), 1),\n\n  DW, $DR92,\n  CL, $DS92,\n  SM, $DT92,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY92*(DE92*OtherDamage*SL+UWDamage*DF92)))",
    "EE92": "IF(INDEX($BI$6:$BI237,BY92)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK92, 0),\n  CF, $DB92,\n  CC, $CZ92,\n  CCUW, $DA92,\n  SCM, $DD92,\n  SCC, $AV$17+INDEX($BI$5:$BI237,BY92+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY92 * (Critical*DO92*$DQ92+DW92*UWCritical)))",
    "EF92": "IF(INDEX($BJ$6:$BJ237,BZ92)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK92*1%, 1),\n  CF, $DB92,\n  CC, $CZ92,\n  CCUW, $DA92,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ237,BZ92+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC92,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY92*(Critical*DO92*$DQ92+DW92*UWCritical)))",
    "EG92": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK237,CA92)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH92,\n  Rapid, DG92,\n  DPM, (1+$DI92*$DJ92*$AQ$9),\n  Rend, $DN92,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK237,CA92+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM92*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92, $DB92), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK237,CA92+1)-1))/(45-CM92*3),1),\n\n  SL, $DQ92,\n  DW, $DR92,\n  CL, $DS92,\n  SM, $DT92,\n  SLM, $DU92,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY92*(DE92*OtherDamage*SL+UwDamage*DF92)))",
    "EH92": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL237,CB92+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL237,CB92)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH92,\n  Rapid, DG92,\n  DPM, (1+$DI92*$DJ92*$AQ$9),\n  SuperTower, $DL92,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL237,CB92+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY92*(DE92*OtherDamage*$DQ92+DW92*DF92)))",
    "EI92": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM237,CC92)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92, $DB92), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK92),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV92, $AR$29), 0),\n\n  DW, $DR92,\n  CL, $DS92,\n  SM, $DT92,\n  SL, $DQ92,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM92, UltCritCard),\nCY92*(DE92*DO92*SL+UwDamage*DF92)))",
    "EJ92": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN237,CD92)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT92,\n  DamageMastery, $CS92,\n  DemonMastery, $CX92,\n  SPB, INDEX($BN$5:$BN237,CD92+1),\n  ITO, $CV92,\n  Shock, $CW92,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE92*DO92*$DQ92+DW92*DF92)))",
    "EK92": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO237,CE92)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT92,\n  DamageMastery, $CS92,\n  DemonMastery, $CX92,\n  SPB, $CU92,\n  ITO, INDEX($BO$5:$BO237,CE92+1),\n  Shock, $CW92,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE92*DO92*$DQ92+DW92*DF92)))",
    "EL92": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP237,CF92)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92, $DB92), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP92),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF92),\n  CL, $DS92,\n  SM, $DT92,\n  SLM, $DU92,\n  SL, $DQ92,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM92, UltCritCard),\nCY92*(DE92*DO92*SL+UwDamage*DF92)))",
    "EM92": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ237,CG92)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG92+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN92": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR237,CH92)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92, $DB92), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH92+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP92),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK92),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM237,CC92), SMHeat, $AR$29), 0),\n\n  DW, $DR92,\n  CL, $DS92,\n  SL, $DQ92,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM92, UltCritCard),\nCY92*(DE92*DO92*SL+UwDamage*DF92)))",
    "EO92": "IF(OR(CI92 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI92+1))",
    "EP92": "IF(OR($AO$25, CJ92 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ92+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE236,BU92),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL92, 1),\n  DPM, (1+$DI92*CardRangeMastery*$DJ92*$AQ$9),\n  SuperTower, $DL92,\n  Rend, $DN92,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92, $DB92), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR92,\n  SM, $DT92,\n  SLM, $DU92,\n  SL, $DQ92,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM92, UltCritCard),\n\nCY92*(DE92*OtherDamage*SL+UwDamage*DF92)))",
    "EQ92": "IF(OR(CK92 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK92+1)*1%, 1),\n  CF, $DB92,\n  CC, MIN(100%, $CZ92 + 1%),\n  CCUW, DA92 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ237,BZ92) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC92 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR92,\n  CL, $DS92,\n  SM, $DT92,\n  SLM, $DU92,\n  SL, $DQ92,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM92, UltCritCard),\n\nCY92 * (Critical*DO92*SL+UwDamage*UWCritical)))",
    "ER92": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL92 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH237,BX92),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL92+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI92*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM237,CC92), $DV92, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH92,\n  Rapid, DG92,\n  SuperTower, $DL92,\n  Rend, $DN92,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM92,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92, $DB92), 1),\n\n  DW, $DR92,\n  CL, $DS92,\n  SM, $DT92,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY92*(DE92*OtherDamage*SL+UWDamage*DF92)))",
    "ES92": "IF(OR(CM92 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH92,\n  Rapid, DG92,\n  RDPM, (1+$DI92*$DJ92*$AQ$9),\n  Rend, $DN92,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK237,CA92),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM92+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92, $DB92), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR92,\n  CL, $DS92,\n  SM, $DT92,\n  SLM, $DU92,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY92*(DE92*OtherDamage*SL+UwDamage*DF92)))",
    "ET92": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN92 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM92,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN92+1, $DB92), 1),\n\n  DW, $DR92,\n  CL, $DS92,\n  SM, $DT92,\n  SLM, $DU92,\n  SL, $DQ92,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY92*(DE92*DO92*SL+UWDamage*DF92)))",
    "EU92": "IF(OR(NOT($BA$3), NOT($BA$23), $CO92 > $BA$15), \"\", 1 + 0.5*(CO92+1))",
    "EW92": "IF(DZ92=\"\", \"\", LET(\n  Now, CT92,\n  Next, DZ92,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT92),\nFactor/Cost))",
    "EX92": "IF(EA92=\"\",\"\",(EA92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU92))",
    "EY92": "IF(EB92=\"\",\"\",(EB92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV92))",
    "EZ92": "IF(EC92=\"\",\"\",(EC92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW92))",
    "FA92": "IF(ED92=\"\",\"\",(ED92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX92))",
    "FB92": "IF(EE92=\"\",\"\",(EE92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY92))",
    "FC92": "IF(EF92=\"\",\"\",(EF92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ92))",
    "FD92": "IF(EG92=\"\",\"\",(EG92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA92))",
    "FE92": "IF(EH92=\"\",\"\",(EH92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB92))",
    "FF92": "IF(EI92=\"\",\"\",(EI92/$DX92-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC92+1, 1, CC92))))",
    "FG92": "IF(EJ92=\"\",\"\",(EJ92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD92))",
    "FH92": "IF(EK92=\"\",\"\",(EK92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE92))",
    "FI92": "IF(EL92=\"\",\"\",(EL92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF92))",
    "FJ92": "IF(EM92=\"\", \"\", LET(\n  Now, CW92,\n  Next, EM92,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG92),\nFactor/Cost))",
    "FK92": "IF(EN92=\"\",\"\",(EN92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH92))",
    "FL92": "IF(EO92=\"\", \"\", LET(\n  Now, CS92,\n  Next, EO92,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI92),\nFactor/Cost))",
    "FM92": "IF(EP92=\"\",\"\",(EP92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ92))",
    "FN92": "IF(EQ92=\"\",\"\",(EQ92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK92))",
    "FO92": "IF(ER92=\"\",\"\",(ER92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL92))",
    "FP92": "IF(ES92=\"\",\"\",(ES92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM92))",
    "FQ92": "IF(ET92=\"\",\"\",(ET92/$DX92-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN92))",
    "FR92": "IF(EU92=\"\", \"\", LET(\n  Now, CX92,\n  Next, EU92,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO92),\nFactor/Cost))",
    "FT92": "IF(COLUMN(EW92:FR92) = MIN(IF(EW92:FR92=MAX(EW92:FR92), COLUMN(EW92:FR92))), 1, \"\")",
    "D93": "IF(SUM(FT92:GP92),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F93)),\"Card Mastery\",F93),G93)/$D$5,\"\")",
    "F93": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT92:GP92),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT92:GP92=1)),)\"),\"Damage / Meter\")",
    "G93": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT92:GP92),ARRAYFORMULA(FILTER(BT92:CP92 , FT92:GP92=1)),\"\"\"\")\"),16.0)",
    "I93": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT92:GP92),ARRAYFORMULA(FILTER(EW92:FS92 , FT92:GP92=1))*D$5,\"\"\"\")\"),0.011752759756524298)",
    "K93": "IF(H93<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D93)),)",
    "BC93": "BC92+1",
    "BD93": "BD92+BD$3",
    "BE93": "BE92+BE$3",
    "BF93": "BF92+BF$3",
    "BH93": "BH92+BH$3",
    "BT93": "BT92+FT92",
    "BU93": "BU92+FU92",
    "BV93": "BV92+FV92",
    "BW93": "BW92+FW92",
    "BX93": "BX92+FX92",
    "BY93": "BY92+FY92",
    "BZ93": "BZ92+FZ92",
    "CA93": "CA92+GA92",
    "CB93": "CB92+GB92",
    "CC93": "CC92+GC92",
    "CD93": "CD92+GD92",
    "CE93": "CE92+GE92",
    "CF93": "CF92+GF92",
    "CG93": "CG92+GG92",
    "CH93": "CH92+GH92",
    "CI93": "CI92+GI92",
    "CJ93": "CJ92+GJ92",
    "CK93": "CK92+GK92",
    "CL93": "CL92+GL92",
    "CM93": "CM92+GM92",
    "CN93": "CN92+GN92",
    "CO93": "CO92+GO92",
    "CS93": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI93,1)",
    "CT93": "INDEX($BD$5:$BD238,BT93)",
    "CU93": "INDEX($BN$5:$BN238,CD93)",
    "CV93": "INDEX($BO$5:$BO238,CE93)",
    "CW93": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG93)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX93": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO93, 1)",
    "CY93": "LET(\n  Base, $CR$6,\n  Damage, $CT93,\n  DamageMastery, $CS93,\n  DemonMastery, $CX93,\n  SPB, $CU93,\n  ITO, $CV93,\n  Shock, $CW93,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ93": "MIN(100%, DA93)",
    "DA93": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK93*1%, 0)",
    "DB93": "LET(\n  Lab, 1+INDEX($BF$5:$BF238,BV93),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC93": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK93*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI238,BY93) + CardCritMastery)",
    "DD93": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK93*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ238,BZ93) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE93": "LET(\n  CF, $DB93,\n  CC, $CZ93,\n  SCM, $DD93,\n  SCC, $DC93,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF93": "LET(\n  CF, $DB93,\n  CC, $DA93,\n  SCM, $DD93,\n  SCC, $DC93,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG93": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH93)), 0)",
    "DH93": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ93*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE238,BU93),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI93": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG238, BW93), 1) + $AE$9)",
    "DJ93": "LET(\n  DpmLab, INDEX($BH$5:$BH238,BX93),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL93, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK93": "(1+$DI93*$DJ93*$AQ$9)",
    "DL93": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK238,CA93),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM93*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM93": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK238,CA93),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM93*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN93": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL238,CB93)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO93": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH93,\n  Rapid, DG93,\n  RDPM, DK93,\n  SuperTower, $DL93,\n  Rend, $DN93,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP93": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ93": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK93),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR93": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP93),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF93-1))",
    "DS93": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG93, DH93),0))",
    "DT93": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP93),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV93, $AR$29), 0))",
    "DU93": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK93),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM238,CC93), $DV93, $AR$29), 0))",
    "DV93": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH93), $AO$29)",
    "DW93": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM93,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93, $DB93), 1),\n\n  DW, $DR93,\n  CL, $DS93,\n  SM, $DT93,\n  SLM, $DU93,\n  SL, $DQ93,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX93": "CY93*(DE93*DO93*DQ93+DW93*DF93)",
    "DZ93": "IF(INDEX($BD$6:$BD238,BT93)=\"\", \"\", INDEX($BD$5:$BD238,BT93+1))",
    "EA93": "IF(OR($AO$25, INDEX($BE$6:$BE238,BU93)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ93)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE238,BU93+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI93*$DJ93*$AQ$9),\n  SuperTower, $DL93,\n  Rend, $DN93,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93, $DB93), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR93,\n  SM, $DT93,\n  SLM, $DU93,\n  SL, $DQ93,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM93, UltCritCard),\n\nCY93*(DE93*OtherDamage*SL+UwDamage*DF93)))",
    "EB93": "IF(INDEX($BF$6:$BF238,BV93)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF238,BV93+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ93,\n  CCUW, $DA93,\n  SCM, $DD93,\n  SCC, $DC93,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93, CF), 1),\n\n  DW, $DR93,\n  CL, $DS93,\n  SM, $DT93,\n  SLM, $DU93,\n  SL, $DQ93,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM93, UltCritCard),\n\nCY93 * (Critical * DO93 * SL + UwDamage * UWCritical)))",
    "EC93": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG238,BW93)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH93,\n  Rapid, DG93,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG238, BW93+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ93*$AQ$9),\n  SuperTower, $DL93,\n  Rend, $DN93,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM238,CC93), $DV93, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM93,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93, $DB93), 1),\n\n  DW, $DR93,\n  CL, $DS93,\n  SM, $DT93,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY93*(DE93*OtherDamage*SL+UWDamage*DF93)))",
    "ED93": "IF(OR($AO$25, INDEX($BH$6:$BH238,BX93)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH238,BX93+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL93, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI93*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM238,CC93), $DV93, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH93,\n  Rapid, DG93,\n  SuperTower, $DL93,\n  Rend, $DN93,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM93,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93, $DB93), 1),\n\n  DW, $DR93,\n  CL, $DS93,\n  SM, $DT93,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY93*(DE93*OtherDamage*SL+UWDamage*DF93)))",
    "EE93": "IF(INDEX($BI$6:$BI238,BY93)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK93, 0),\n  CF, $DB93,\n  CC, $CZ93,\n  CCUW, $DA93,\n  SCM, $DD93,\n  SCC, $AV$17+INDEX($BI$5:$BI238,BY93+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY93 * (Critical*DO93*$DQ93+DW93*UWCritical)))",
    "EF93": "IF(INDEX($BJ$6:$BJ238,BZ93)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK93*1%, 1),\n  CF, $DB93,\n  CC, $CZ93,\n  CCUW, $DA93,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ238,BZ93+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC93,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY93*(Critical*DO93*$DQ93+DW93*UWCritical)))",
    "EG93": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK238,CA93)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH93,\n  Rapid, DG93,\n  DPM, (1+$DI93*$DJ93*$AQ$9),\n  Rend, $DN93,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK238,CA93+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM93*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93, $DB93), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK238,CA93+1)-1))/(45-CM93*3),1),\n\n  SL, $DQ93,\n  DW, $DR93,\n  CL, $DS93,\n  SM, $DT93,\n  SLM, $DU93,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY93*(DE93*OtherDamage*SL+UwDamage*DF93)))",
    "EH93": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL238,CB93+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL238,CB93)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH93,\n  Rapid, DG93,\n  DPM, (1+$DI93*$DJ93*$AQ$9),\n  SuperTower, $DL93,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL238,CB93+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY93*(DE93*OtherDamage*$DQ93+DW93*DF93)))",
    "EI93": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM238,CC93)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93, $DB93), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK93),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV93, $AR$29), 0),\n\n  DW, $DR93,\n  CL, $DS93,\n  SM, $DT93,\n  SL, $DQ93,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM93, UltCritCard),\nCY93*(DE93*DO93*SL+UwDamage*DF93)))",
    "EJ93": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN238,CD93)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT93,\n  DamageMastery, $CS93,\n  DemonMastery, $CX93,\n  SPB, INDEX($BN$5:$BN238,CD93+1),\n  ITO, $CV93,\n  Shock, $CW93,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE93*DO93*$DQ93+DW93*DF93)))",
    "EK93": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO238,CE93)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT93,\n  DamageMastery, $CS93,\n  DemonMastery, $CX93,\n  SPB, $CU93,\n  ITO, INDEX($BO$5:$BO238,CE93+1),\n  Shock, $CW93,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE93*DO93*$DQ93+DW93*DF93)))",
    "EL93": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP238,CF93)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93, $DB93), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP93),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF93),\n  CL, $DS93,\n  SM, $DT93,\n  SLM, $DU93,\n  SL, $DQ93,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM93, UltCritCard),\nCY93*(DE93*DO93*SL+UwDamage*DF93)))",
    "EM93": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ238,CG93)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG93+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN93": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR238,CH93)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93, $DB93), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH93+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP93),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK93),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM238,CC93), SMHeat, $AR$29), 0),\n\n  DW, $DR93,\n  CL, $DS93,\n  SL, $DQ93,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM93, UltCritCard),\nCY93*(DE93*DO93*SL+UwDamage*DF93)))",
    "EO93": "IF(OR(CI93 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI93+1))",
    "EP93": "IF(OR($AO$25, CJ93 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ93+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE237,BU93),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL93, 1),\n  DPM, (1+$DI93*CardRangeMastery*$DJ93*$AQ$9),\n  SuperTower, $DL93,\n  Rend, $DN93,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93, $DB93), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR93,\n  SM, $DT93,\n  SLM, $DU93,\n  SL, $DQ93,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM93, UltCritCard),\n\nCY93*(DE93*OtherDamage*SL+UwDamage*DF93)))",
    "EQ93": "IF(OR(CK93 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK93+1)*1%, 1),\n  CF, $DB93,\n  CC, MIN(100%, $CZ93 + 1%),\n  CCUW, DA93 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ238,BZ93) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC93 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR93,\n  CL, $DS93,\n  SM, $DT93,\n  SLM, $DU93,\n  SL, $DQ93,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM93, UltCritCard),\n\nCY93 * (Critical*DO93*SL+UwDamage*UWCritical)))",
    "ER93": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL93 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH238,BX93),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL93+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI93*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM238,CC93), $DV93, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH93,\n  Rapid, DG93,\n  SuperTower, $DL93,\n  Rend, $DN93,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM93,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93, $DB93), 1),\n\n  DW, $DR93,\n  CL, $DS93,\n  SM, $DT93,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY93*(DE93*OtherDamage*SL+UWDamage*DF93)))",
    "ES93": "IF(OR(CM93 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH93,\n  Rapid, DG93,\n  RDPM, (1+$DI93*$DJ93*$AQ$9),\n  Rend, $DN93,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK238,CA93),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM93+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93, $DB93), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR93,\n  CL, $DS93,\n  SM, $DT93,\n  SLM, $DU93,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY93*(DE93*OtherDamage*SL+UwDamage*DF93)))",
    "ET93": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN93 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM93,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN93+1, $DB93), 1),\n\n  DW, $DR93,\n  CL, $DS93,\n  SM, $DT93,\n  SLM, $DU93,\n  SL, $DQ93,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY93*(DE93*DO93*SL+UWDamage*DF93)))",
    "EU93": "IF(OR(NOT($BA$3), NOT($BA$23), $CO93 > $BA$15), \"\", 1 + 0.5*(CO93+1))",
    "EW93": "IF(DZ93=\"\", \"\", LET(\n  Now, CT93,\n  Next, DZ93,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT93),\nFactor/Cost))",
    "EX93": "IF(EA93=\"\",\"\",(EA93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU93))",
    "EY93": "IF(EB93=\"\",\"\",(EB93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV93))",
    "EZ93": "IF(EC93=\"\",\"\",(EC93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW93))",
    "FA93": "IF(ED93=\"\",\"\",(ED93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX93))",
    "FB93": "IF(EE93=\"\",\"\",(EE93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY93))",
    "FC93": "IF(EF93=\"\",\"\",(EF93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ93))",
    "FD93": "IF(EG93=\"\",\"\",(EG93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA93))",
    "FE93": "IF(EH93=\"\",\"\",(EH93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB93))",
    "FF93": "IF(EI93=\"\",\"\",(EI93/$DX93-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC93+1, 1, CC93))))",
    "FG93": "IF(EJ93=\"\",\"\",(EJ93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD93))",
    "FH93": "IF(EK93=\"\",\"\",(EK93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE93))",
    "FI93": "IF(EL93=\"\",\"\",(EL93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF93))",
    "FJ93": "IF(EM93=\"\", \"\", LET(\n  Now, CW93,\n  Next, EM93,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG93),\nFactor/Cost))",
    "FK93": "IF(EN93=\"\",\"\",(EN93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH93))",
    "FL93": "IF(EO93=\"\", \"\", LET(\n  Now, CS93,\n  Next, EO93,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI93),\nFactor/Cost))",
    "FM93": "IF(EP93=\"\",\"\",(EP93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ93))",
    "FN93": "IF(EQ93=\"\",\"\",(EQ93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK93))",
    "FO93": "IF(ER93=\"\",\"\",(ER93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL93))",
    "FP93": "IF(ES93=\"\",\"\",(ES93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM93))",
    "FQ93": "IF(ET93=\"\",\"\",(ET93/$DX93-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN93))",
    "FR93": "IF(EU93=\"\", \"\", LET(\n  Now, CX93,\n  Next, EU93,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO93),\nFactor/Cost))",
    "FT93": "IF(COLUMN(EW93:FR93) = MIN(IF(EW93:FR93=MAX(EW93:FR93), COLUMN(EW93:FR93))), 1, \"\")",
    "D94": "IF(SUM(FT93:GP93),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F94)),\"Card Mastery\",F94),G94)/$D$5,\"\")",
    "F94": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT93:GP93),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT93:GP93=1)),)\"),\"Standard Perks Bonus\")",
    "G94": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT93:GP93),ARRAYFORMULA(FILTER(BT93:CP93 , FT93:GP93=1)),\"\"\"\")\"),5.0)",
    "I94": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT93:GP93),ARRAYFORMULA(FILTER(EW93:FS93 , FT93:GP93=1))*D$5,\"\"\"\")\"),0.011714174150722333)",
    "K94": "IF(H94<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D94)),)",
    "BC94": "BC93+1",
    "BD94": "BD93+BD$3",
    "BE94": "BE93+BE$3",
    "BF94": "BF93+BF$3",
    "BH94": "BH93+BH$3",
    "BT94": "BT93+FT93",
    "BU94": "BU93+FU93",
    "BV94": "BV93+FV93",
    "BW94": "BW93+FW93",
    "BX94": "BX93+FX93",
    "BY94": "BY93+FY93",
    "BZ94": "BZ93+FZ93",
    "CA94": "CA93+GA93",
    "CB94": "CB93+GB93",
    "CC94": "CC93+GC93",
    "CD94": "CD93+GD93",
    "CE94": "CE93+GE93",
    "CF94": "CF93+GF93",
    "CG94": "CG93+GG93",
    "CH94": "CH93+GH93",
    "CI94": "CI93+GI93",
    "CJ94": "CJ93+GJ93",
    "CK94": "CK93+GK93",
    "CL94": "CL93+GL93",
    "CM94": "CM93+GM93",
    "CN94": "CN93+GN93",
    "CO94": "CO93+GO93",
    "CS94": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI94,1)",
    "CT94": "INDEX($BD$5:$BD239,BT94)",
    "CU94": "INDEX($BN$5:$BN239,CD94)",
    "CV94": "INDEX($BO$5:$BO239,CE94)",
    "CW94": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG94)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX94": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO94, 1)",
    "CY94": "LET(\n  Base, $CR$6,\n  Damage, $CT94,\n  DamageMastery, $CS94,\n  DemonMastery, $CX94,\n  SPB, $CU94,\n  ITO, $CV94,\n  Shock, $CW94,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ94": "MIN(100%, DA94)",
    "DA94": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK94*1%, 0)",
    "DB94": "LET(\n  Lab, 1+INDEX($BF$5:$BF239,BV94),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC94": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK94*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI239,BY94) + CardCritMastery)",
    "DD94": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK94*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ239,BZ94) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE94": "LET(\n  CF, $DB94,\n  CC, $CZ94,\n  SCM, $DD94,\n  SCC, $DC94,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF94": "LET(\n  CF, $DB94,\n  CC, $DA94,\n  SCM, $DD94,\n  SCC, $DC94,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG94": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH94)), 0)",
    "DH94": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ94*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE239,BU94),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI94": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG239, BW94), 1) + $AE$9)",
    "DJ94": "LET(\n  DpmLab, INDEX($BH$5:$BH239,BX94),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL94, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK94": "(1+$DI94*$DJ94*$AQ$9)",
    "DL94": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK239,CA94),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM94*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM94": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK239,CA94),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM94*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN94": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL239,CB94)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO94": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH94,\n  Rapid, DG94,\n  RDPM, DK94,\n  SuperTower, $DL94,\n  Rend, $DN94,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP94": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ94": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK94),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR94": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP94),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF94-1))",
    "DS94": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG94, DH94),0))",
    "DT94": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP94),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV94, $AR$29), 0))",
    "DU94": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK94),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM239,CC94), $DV94, $AR$29), 0))",
    "DV94": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH94), $AO$29)",
    "DW94": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM94,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94, $DB94), 1),\n\n  DW, $DR94,\n  CL, $DS94,\n  SM, $DT94,\n  SLM, $DU94,\n  SL, $DQ94,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX94": "CY94*(DE94*DO94*DQ94+DW94*DF94)",
    "DZ94": "IF(INDEX($BD$6:$BD239,BT94)=\"\", \"\", INDEX($BD$5:$BD239,BT94+1))",
    "EA94": "IF(OR($AO$25, INDEX($BE$6:$BE239,BU94)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ94)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE239,BU94+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI94*$DJ94*$AQ$9),\n  SuperTower, $DL94,\n  Rend, $DN94,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94, $DB94), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR94,\n  SM, $DT94,\n  SLM, $DU94,\n  SL, $DQ94,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM94, UltCritCard),\n\nCY94*(DE94*OtherDamage*SL+UwDamage*DF94)))",
    "EB94": "IF(INDEX($BF$6:$BF239,BV94)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF239,BV94+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ94,\n  CCUW, $DA94,\n  SCM, $DD94,\n  SCC, $DC94,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94, CF), 1),\n\n  DW, $DR94,\n  CL, $DS94,\n  SM, $DT94,\n  SLM, $DU94,\n  SL, $DQ94,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM94, UltCritCard),\n\nCY94 * (Critical * DO94 * SL + UwDamage * UWCritical)))",
    "EC94": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG239,BW94)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH94,\n  Rapid, DG94,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG239, BW94+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ94*$AQ$9),\n  SuperTower, $DL94,\n  Rend, $DN94,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM239,CC94), $DV94, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM94,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94, $DB94), 1),\n\n  DW, $DR94,\n  CL, $DS94,\n  SM, $DT94,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY94*(DE94*OtherDamage*SL+UWDamage*DF94)))",
    "ED94": "IF(OR($AO$25, INDEX($BH$6:$BH239,BX94)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH239,BX94+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL94, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI94*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM239,CC94), $DV94, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH94,\n  Rapid, DG94,\n  SuperTower, $DL94,\n  Rend, $DN94,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM94,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94, $DB94), 1),\n\n  DW, $DR94,\n  CL, $DS94,\n  SM, $DT94,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY94*(DE94*OtherDamage*SL+UWDamage*DF94)))",
    "EE94": "IF(INDEX($BI$6:$BI239,BY94)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK94, 0),\n  CF, $DB94,\n  CC, $CZ94,\n  CCUW, $DA94,\n  SCM, $DD94,\n  SCC, $AV$17+INDEX($BI$5:$BI239,BY94+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY94 * (Critical*DO94*$DQ94+DW94*UWCritical)))",
    "EF94": "IF(INDEX($BJ$6:$BJ239,BZ94)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK94*1%, 1),\n  CF, $DB94,\n  CC, $CZ94,\n  CCUW, $DA94,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ239,BZ94+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC94,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY94*(Critical*DO94*$DQ94+DW94*UWCritical)))",
    "EG94": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK239,CA94)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH94,\n  Rapid, DG94,\n  DPM, (1+$DI94*$DJ94*$AQ$9),\n  Rend, $DN94,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK239,CA94+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM94*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94, $DB94), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK239,CA94+1)-1))/(45-CM94*3),1),\n\n  SL, $DQ94,\n  DW, $DR94,\n  CL, $DS94,\n  SM, $DT94,\n  SLM, $DU94,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY94*(DE94*OtherDamage*SL+UwDamage*DF94)))",
    "EH94": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL239,CB94+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL239,CB94)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH94,\n  Rapid, DG94,\n  DPM, (1+$DI94*$DJ94*$AQ$9),\n  SuperTower, $DL94,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL239,CB94+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY94*(DE94*OtherDamage*$DQ94+DW94*DF94)))",
    "EI94": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM239,CC94)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94, $DB94), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK94),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV94, $AR$29), 0),\n\n  DW, $DR94,\n  CL, $DS94,\n  SM, $DT94,\n  SL, $DQ94,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM94, UltCritCard),\nCY94*(DE94*DO94*SL+UwDamage*DF94)))",
    "EJ94": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN239,CD94)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT94,\n  DamageMastery, $CS94,\n  DemonMastery, $CX94,\n  SPB, INDEX($BN$5:$BN239,CD94+1),\n  ITO, $CV94,\n  Shock, $CW94,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE94*DO94*$DQ94+DW94*DF94)))",
    "EK94": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO239,CE94)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT94,\n  DamageMastery, $CS94,\n  DemonMastery, $CX94,\n  SPB, $CU94,\n  ITO, INDEX($BO$5:$BO239,CE94+1),\n  Shock, $CW94,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE94*DO94*$DQ94+DW94*DF94)))",
    "EL94": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP239,CF94)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94, $DB94), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP94),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF94),\n  CL, $DS94,\n  SM, $DT94,\n  SLM, $DU94,\n  SL, $DQ94,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM94, UltCritCard),\nCY94*(DE94*DO94*SL+UwDamage*DF94)))",
    "EM94": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ239,CG94)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG94+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN94": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR239,CH94)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94, $DB94), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH94+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP94),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK94),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM239,CC94), SMHeat, $AR$29), 0),\n\n  DW, $DR94,\n  CL, $DS94,\n  SL, $DQ94,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM94, UltCritCard),\nCY94*(DE94*DO94*SL+UwDamage*DF94)))",
    "EO94": "IF(OR(CI94 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI94+1))",
    "EP94": "IF(OR($AO$25, CJ94 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ94+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE238,BU94),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL94, 1),\n  DPM, (1+$DI94*CardRangeMastery*$DJ94*$AQ$9),\n  SuperTower, $DL94,\n  Rend, $DN94,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94, $DB94), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR94,\n  SM, $DT94,\n  SLM, $DU94,\n  SL, $DQ94,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM94, UltCritCard),\n\nCY94*(DE94*OtherDamage*SL+UwDamage*DF94)))",
    "EQ94": "IF(OR(CK94 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK94+1)*1%, 1),\n  CF, $DB94,\n  CC, MIN(100%, $CZ94 + 1%),\n  CCUW, DA94 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ239,BZ94) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC94 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR94,\n  CL, $DS94,\n  SM, $DT94,\n  SLM, $DU94,\n  SL, $DQ94,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM94, UltCritCard),\n\nCY94 * (Critical*DO94*SL+UwDamage*UWCritical)))",
    "ER94": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL94 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH239,BX94),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL94+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI94*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM239,CC94), $DV94, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH94,\n  Rapid, DG94,\n  SuperTower, $DL94,\n  Rend, $DN94,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM94,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94, $DB94), 1),\n\n  DW, $DR94,\n  CL, $DS94,\n  SM, $DT94,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY94*(DE94*OtherDamage*SL+UWDamage*DF94)))",
    "ES94": "IF(OR(CM94 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH94,\n  Rapid, DG94,\n  RDPM, (1+$DI94*$DJ94*$AQ$9),\n  Rend, $DN94,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK239,CA94),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM94+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94, $DB94), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR94,\n  CL, $DS94,\n  SM, $DT94,\n  SLM, $DU94,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY94*(DE94*OtherDamage*SL+UwDamage*DF94)))",
    "ET94": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN94 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM94,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN94+1, $DB94), 1),\n\n  DW, $DR94,\n  CL, $DS94,\n  SM, $DT94,\n  SLM, $DU94,\n  SL, $DQ94,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY94*(DE94*DO94*SL+UWDamage*DF94)))",
    "EU94": "IF(OR(NOT($BA$3), NOT($BA$23), $CO94 > $BA$15), \"\", 1 + 0.5*(CO94+1))",
    "EW94": "IF(DZ94=\"\", \"\", LET(\n  Now, CT94,\n  Next, DZ94,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT94),\nFactor/Cost))",
    "EX94": "IF(EA94=\"\",\"\",(EA94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU94))",
    "EY94": "IF(EB94=\"\",\"\",(EB94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV94))",
    "EZ94": "IF(EC94=\"\",\"\",(EC94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW94))",
    "FA94": "IF(ED94=\"\",\"\",(ED94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX94))",
    "FB94": "IF(EE94=\"\",\"\",(EE94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY94))",
    "FC94": "IF(EF94=\"\",\"\",(EF94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ94))",
    "FD94": "IF(EG94=\"\",\"\",(EG94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA94))",
    "FE94": "IF(EH94=\"\",\"\",(EH94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB94))",
    "FF94": "IF(EI94=\"\",\"\",(EI94/$DX94-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC94+1, 1, CC94))))",
    "FG94": "IF(EJ94=\"\",\"\",(EJ94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD94))",
    "FH94": "IF(EK94=\"\",\"\",(EK94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE94))",
    "FI94": "IF(EL94=\"\",\"\",(EL94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF94))",
    "FJ94": "IF(EM94=\"\", \"\", LET(\n  Now, CW94,\n  Next, EM94,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG94),\nFactor/Cost))",
    "FK94": "IF(EN94=\"\",\"\",(EN94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH94))",
    "FL94": "IF(EO94=\"\", \"\", LET(\n  Now, CS94,\n  Next, EO94,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI94),\nFactor/Cost))",
    "FM94": "IF(EP94=\"\",\"\",(EP94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ94))",
    "FN94": "IF(EQ94=\"\",\"\",(EQ94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK94))",
    "FO94": "IF(ER94=\"\",\"\",(ER94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL94))",
    "FP94": "IF(ES94=\"\",\"\",(ES94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM94))",
    "FQ94": "IF(ET94=\"\",\"\",(ET94/$DX94-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN94))",
    "FR94": "IF(EU94=\"\", \"\", LET(\n  Now, CX94,\n  Next, EU94,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO94),\nFactor/Cost))",
    "FT94": "IF(COLUMN(EW94:FR94) = MIN(IF(EW94:FR94=MAX(EW94:FR94), COLUMN(EW94:FR94))), 1, \"\")",
    "D95": "IF(SUM(FT94:GP94),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F95)),\"Card Mastery\",F95),G95)/$D$5,\"\")",
    "F95": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT94:GP94),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT94:GP94=1)),)\"),\"Critical Factor\")",
    "G95": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT94:GP94),ARRAYFORMULA(FILTER(BT94:CP94 , FT94:GP94=1)),\"\"\"\")\"),24.0)",
    "I95": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT94:GP94),ARRAYFORMULA(FILTER(EW94:FS94 , FT94:GP94=1))*D$5,\"\"\"\")\"),0.011298338190907932)",
    "K95": "IF(D86,FORMAT_TIME_YEAR(SUM($D$6:$D95)),)",
    "BC95": "BC94+1",
    "BD95": "BD94+BD$3",
    "BE95": "BE94+BE$3",
    "BF95": "BF94+BF$3",
    "BH95": "BH94+BH$3",
    "BT95": "BT94+FT94",
    "BU95": "BU94+FU94",
    "BV95": "BV94+FV94",
    "BW95": "BW94+FW94",
    "BX95": "BX94+FX94",
    "BY95": "BY94+FY94",
    "BZ95": "BZ94+FZ94",
    "CA95": "CA94+GA94",
    "CB95": "CB94+GB94",
    "CC95": "CC94+GC94",
    "CD95": "CD94+GD94",
    "CE95": "CE94+GE94",
    "CF95": "CF94+GF94",
    "CG95": "CG94+GG94",
    "CH95": "CH94+GH94",
    "CI95": "CI94+GI94",
    "CJ95": "CJ94+GJ94",
    "CK95": "CK94+GK94",
    "CL95": "CL94+GL94",
    "CM95": "CM94+GM94",
    "CN95": "CN94+GN94",
    "CO95": "CO94+GO94",
    "CS95": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI95,1)",
    "CT95": "INDEX($BD$5:$BD240,BT95)",
    "CU95": "INDEX($BN$5:$BN240,CD95)",
    "CV95": "INDEX($BO$5:$BO240,CE95)",
    "CW95": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG95)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX95": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO95, 1)",
    "CY95": "LET(\n  Base, $CR$6,\n  Damage, $CT95,\n  DamageMastery, $CS95,\n  DemonMastery, $CX95,\n  SPB, $CU95,\n  ITO, $CV95,\n  Shock, $CW95,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ95": "MIN(100%, DA95)",
    "DA95": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK95*1%, 0)",
    "DB95": "LET(\n  Lab, 1+INDEX($BF$5:$BF240,BV95),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC95": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK95*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI240,BY95) + CardCritMastery)",
    "DD95": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK95*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ240,BZ95) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE95": "LET(\n  CF, $DB95,\n  CC, $CZ95,\n  SCM, $DD95,\n  SCC, $DC95,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF95": "LET(\n  CF, $DB95,\n  CC, $DA95,\n  SCM, $DD95,\n  SCC, $DC95,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG95": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH95)), 0)",
    "DH95": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ95*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE240,BU95),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI95": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG240, BW95), 1) + $AE$9)",
    "DJ95": "LET(\n  DpmLab, INDEX($BH$5:$BH240,BX95),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL95, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK95": "(1+$DI95*$DJ95*$AQ$9)",
    "DL95": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK240,CA95),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM95*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM95": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK240,CA95),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM95*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN95": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL240,CB95)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO95": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH95,\n  Rapid, DG95,\n  RDPM, DK95,\n  SuperTower, $DL95,\n  Rend, $DN95,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP95": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ95": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK95),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR95": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP95),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF95-1))",
    "DS95": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG95, DH95),0))",
    "DT95": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP95),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV95, $AR$29), 0))",
    "DU95": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK95),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM240,CC95), $DV95, $AR$29), 0))",
    "DV95": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH95), $AO$29)",
    "DW95": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM95,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95, $DB95), 1),\n\n  DW, $DR95,\n  CL, $DS95,\n  SM, $DT95,\n  SLM, $DU95,\n  SL, $DQ95,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX95": "CY95*(DE95*DO95*DQ95+DW95*DF95)",
    "DZ95": "IF(INDEX($BD$6:$BD240,BT95)=\"\", \"\", INDEX($BD$5:$BD240,BT95+1))",
    "EA95": "IF(OR($AO$25, INDEX($BE$6:$BE240,BU95)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ95)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE240,BU95+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI95*$DJ95*$AQ$9),\n  SuperTower, $DL95,\n  Rend, $DN95,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95, $DB95), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR95,\n  SM, $DT95,\n  SLM, $DU95,\n  SL, $DQ95,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM95, UltCritCard),\n\nCY95*(DE95*OtherDamage*SL+UwDamage*DF95)))",
    "EB95": "IF(INDEX($BF$6:$BF240,BV95)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF240,BV95+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ95,\n  CCUW, $DA95,\n  SCM, $DD95,\n  SCC, $DC95,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95, CF), 1),\n\n  DW, $DR95,\n  CL, $DS95,\n  SM, $DT95,\n  SLM, $DU95,\n  SL, $DQ95,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM95, UltCritCard),\n\nCY95 * (Critical * DO95 * SL + UwDamage * UWCritical)))",
    "EC95": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG240,BW95)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH95,\n  Rapid, DG95,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG240, BW95+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ95*$AQ$9),\n  SuperTower, $DL95,\n  Rend, $DN95,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM240,CC95), $DV95, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM95,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95, $DB95), 1),\n\n  DW, $DR95,\n  CL, $DS95,\n  SM, $DT95,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY95*(DE95*OtherDamage*SL+UWDamage*DF95)))",
    "ED95": "IF(OR($AO$25, INDEX($BH$6:$BH240,BX95)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH240,BX95+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL95, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI95*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM240,CC95), $DV95, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH95,\n  Rapid, DG95,\n  SuperTower, $DL95,\n  Rend, $DN95,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM95,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95, $DB95), 1),\n\n  DW, $DR95,\n  CL, $DS95,\n  SM, $DT95,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY95*(DE95*OtherDamage*SL+UWDamage*DF95)))",
    "EE95": "IF(INDEX($BI$6:$BI240,BY95)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK95, 0),\n  CF, $DB95,\n  CC, $CZ95,\n  CCUW, $DA95,\n  SCM, $DD95,\n  SCC, $AV$17+INDEX($BI$5:$BI240,BY95+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY95 * (Critical*DO95*$DQ95+DW95*UWCritical)))",
    "EF95": "IF(INDEX($BJ$6:$BJ240,BZ95)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK95*1%, 1),\n  CF, $DB95,\n  CC, $CZ95,\n  CCUW, $DA95,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ240,BZ95+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC95,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY95*(Critical*DO95*$DQ95+DW95*UWCritical)))",
    "EG95": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK240,CA95)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH95,\n  Rapid, DG95,\n  DPM, (1+$DI95*$DJ95*$AQ$9),\n  Rend, $DN95,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK240,CA95+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM95*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95, $DB95), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK240,CA95+1)-1))/(45-CM95*3),1),\n\n  SL, $DQ95,\n  DW, $DR95,\n  CL, $DS95,\n  SM, $DT95,\n  SLM, $DU95,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY95*(DE95*OtherDamage*SL+UwDamage*DF95)))",
    "EH95": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL240,CB95+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL240,CB95)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH95,\n  Rapid, DG95,\n  DPM, (1+$DI95*$DJ95*$AQ$9),\n  SuperTower, $DL95,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL240,CB95+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY95*(DE95*OtherDamage*$DQ95+DW95*DF95)))",
    "EI95": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM240,CC95)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95, $DB95), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK95),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV95, $AR$29), 0),\n\n  DW, $DR95,\n  CL, $DS95,\n  SM, $DT95,\n  SL, $DQ95,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM95, UltCritCard),\nCY95*(DE95*DO95*SL+UwDamage*DF95)))",
    "EJ95": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN240,CD95)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT95,\n  DamageMastery, $CS95,\n  DemonMastery, $CX95,\n  SPB, INDEX($BN$5:$BN240,CD95+1),\n  ITO, $CV95,\n  Shock, $CW95,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE95*DO95*$DQ95+DW95*DF95)))",
    "EK95": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO240,CE95)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT95,\n  DamageMastery, $CS95,\n  DemonMastery, $CX95,\n  SPB, $CU95,\n  ITO, INDEX($BO$5:$BO240,CE95+1),\n  Shock, $CW95,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE95*DO95*$DQ95+DW95*DF95)))",
    "EL95": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP240,CF95)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95, $DB95), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP95),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF95),\n  CL, $DS95,\n  SM, $DT95,\n  SLM, $DU95,\n  SL, $DQ95,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM95, UltCritCard),\nCY95*(DE95*DO95*SL+UwDamage*DF95)))",
    "EM95": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ240,CG95)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG95+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN95": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR240,CH95)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95, $DB95), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH95+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP95),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK95),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM240,CC95), SMHeat, $AR$29), 0),\n\n  DW, $DR95,\n  CL, $DS95,\n  SL, $DQ95,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM95, UltCritCard),\nCY95*(DE95*DO95*SL+UwDamage*DF95)))",
    "EO95": "IF(OR(CI95 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI95+1))",
    "EP95": "IF(OR($AO$25, CJ95 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ95+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE239,BU95),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL95, 1),\n  DPM, (1+$DI95*CardRangeMastery*$DJ95*$AQ$9),\n  SuperTower, $DL95,\n  Rend, $DN95,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95, $DB95), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR95,\n  SM, $DT95,\n  SLM, $DU95,\n  SL, $DQ95,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM95, UltCritCard),\n\nCY95*(DE95*OtherDamage*SL+UwDamage*DF95)))",
    "EQ95": "IF(OR(CK95 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK95+1)*1%, 1),\n  CF, $DB95,\n  CC, MIN(100%, $CZ95 + 1%),\n  CCUW, DA95 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ240,BZ95) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC95 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR95,\n  CL, $DS95,\n  SM, $DT95,\n  SLM, $DU95,\n  SL, $DQ95,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM95, UltCritCard),\n\nCY95 * (Critical*DO95*SL+UwDamage*UWCritical)))",
    "ER95": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL95 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH240,BX95),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL95+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI95*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM240,CC95), $DV95, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH95,\n  Rapid, DG95,\n  SuperTower, $DL95,\n  Rend, $DN95,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM95,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95, $DB95), 1),\n\n  DW, $DR95,\n  CL, $DS95,\n  SM, $DT95,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY95*(DE95*OtherDamage*SL+UWDamage*DF95)))",
    "ES95": "IF(OR(CM95 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH95,\n  Rapid, DG95,\n  RDPM, (1+$DI95*$DJ95*$AQ$9),\n  Rend, $DN95,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK240,CA95),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM95+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95, $DB95), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR95,\n  CL, $DS95,\n  SM, $DT95,\n  SLM, $DU95,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY95*(DE95*OtherDamage*SL+UwDamage*DF95)))",
    "ET95": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN95 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM95,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN95+1, $DB95), 1),\n\n  DW, $DR95,\n  CL, $DS95,\n  SM, $DT95,\n  SLM, $DU95,\n  SL, $DQ95,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY95*(DE95*DO95*SL+UWDamage*DF95)))",
    "EU95": "IF(OR(NOT($BA$3), NOT($BA$23), $CO95 > $BA$15), \"\", 1 + 0.5*(CO95+1))",
    "EW95": "IF(DZ95=\"\", \"\", LET(\n  Now, CT95,\n  Next, DZ95,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT95),\nFactor/Cost))",
    "EX95": "IF(EA95=\"\",\"\",(EA95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU95))",
    "EY95": "IF(EB95=\"\",\"\",(EB95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV95))",
    "EZ95": "IF(EC95=\"\",\"\",(EC95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW95))",
    "FA95": "IF(ED95=\"\",\"\",(ED95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX95))",
    "FB95": "IF(EE95=\"\",\"\",(EE95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY95))",
    "FC95": "IF(EF95=\"\",\"\",(EF95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ95))",
    "FD95": "IF(EG95=\"\",\"\",(EG95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA95))",
    "FE95": "IF(EH95=\"\",\"\",(EH95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB95))",
    "FF95": "IF(EI95=\"\",\"\",(EI95/$DX95-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC95+1, 1, CC95))))",
    "FG95": "IF(EJ95=\"\",\"\",(EJ95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD95))",
    "FH95": "IF(EK95=\"\",\"\",(EK95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE95))",
    "FI95": "IF(EL95=\"\",\"\",(EL95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF95))",
    "FJ95": "IF(EM95=\"\", \"\", LET(\n  Now, CW95,\n  Next, EM95,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG95),\nFactor/Cost))",
    "FK95": "IF(EN95=\"\",\"\",(EN95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH95))",
    "FL95": "IF(EO95=\"\", \"\", LET(\n  Now, CS95,\n  Next, EO95,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI95),\nFactor/Cost))",
    "FM95": "IF(EP95=\"\",\"\",(EP95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ95))",
    "FN95": "IF(EQ95=\"\",\"\",(EQ95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK95))",
    "FO95": "IF(ER95=\"\",\"\",(ER95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL95))",
    "FP95": "IF(ES95=\"\",\"\",(ES95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM95))",
    "FQ95": "IF(ET95=\"\",\"\",(ET95/$DX95-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN95))",
    "FR95": "IF(EU95=\"\", \"\", LET(\n  Now, CX95,\n  Next, EU95,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO95),\nFactor/Cost))",
    "FT95": "IF(COLUMN(EW95:FR95) = MIN(IF(EW95:FR95=MAX(EW95:FR95), COLUMN(EW95:FR95))), 1, \"\")",
    "D96": "IF(SUM(FT95:GP95),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F96)),\"Card Mastery\",F96),G96)/$D$5,\"\")",
    "F96": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT95:GP95),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT95:GP95=1)),)\"),\"Damage\")",
    "G96": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT95:GP95),ARRAYFORMULA(FILTER(BT95:CP95 , FT95:GP95=1)),\"\"\"\")\"),22.0)",
    "I96": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT95:GP95),ARRAYFORMULA(FILTER(EW95:FS95 , FT95:GP95=1))*D$5,\"\"\"\")\"),0.01099874736488343)",
    "K96": "IF(H96<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D96)),)",
    "BC96": "BC95+1",
    "BD96": "BD95+BD$3",
    "BE96": "BE95+BE$3",
    "BF96": "BF95+BF$3",
    "BH96": "BH95+BH$3",
    "BT96": "BT95+FT95",
    "BU96": "BU95+FU95",
    "BV96": "BV95+FV95",
    "BW96": "BW95+FW95",
    "BX96": "BX95+FX95",
    "BY96": "BY95+FY95",
    "BZ96": "BZ95+FZ95",
    "CA96": "CA95+GA95",
    "CB96": "CB95+GB95",
    "CC96": "CC95+GC95",
    "CD96": "CD95+GD95",
    "CE96": "CE95+GE95",
    "CF96": "CF95+GF95",
    "CG96": "CG95+GG95",
    "CH96": "CH95+GH95",
    "CI96": "CI95+GI95",
    "CJ96": "CJ95+GJ95",
    "CK96": "CK95+GK95",
    "CL96": "CL95+GL95",
    "CM96": "CM95+GM95",
    "CN96": "CN95+GN95",
    "CO96": "CO95+GO95",
    "CS96": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI96,1)",
    "CT96": "INDEX($BD$5:$BD241,BT96)",
    "CU96": "INDEX($BN$5:$BN241,CD96)",
    "CV96": "INDEX($BO$5:$BO241,CE96)",
    "CW96": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG96)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX96": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO96, 1)",
    "CY96": "LET(\n  Base, $CR$6,\n  Damage, $CT96,\n  DamageMastery, $CS96,\n  DemonMastery, $CX96,\n  SPB, $CU96,\n  ITO, $CV96,\n  Shock, $CW96,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ96": "MIN(100%, DA96)",
    "DA96": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK96*1%, 0)",
    "DB96": "LET(\n  Lab, 1+INDEX($BF$5:$BF241,BV96),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC96": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK96*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI241,BY96) + CardCritMastery)",
    "DD96": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK96*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ241,BZ96) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE96": "LET(\n  CF, $DB96,\n  CC, $CZ96,\n  SCM, $DD96,\n  SCC, $DC96,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF96": "LET(\n  CF, $DB96,\n  CC, $DA96,\n  SCM, $DD96,\n  SCC, $DC96,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG96": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH96)), 0)",
    "DH96": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ96*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE241,BU96),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI96": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG241, BW96), 1) + $AE$9)",
    "DJ96": "LET(\n  DpmLab, INDEX($BH$5:$BH241,BX96),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL96, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK96": "(1+$DI96*$DJ96*$AQ$9)",
    "DL96": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK241,CA96),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM96*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM96": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK241,CA96),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM96*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN96": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL241,CB96)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO96": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH96,\n  Rapid, DG96,\n  RDPM, DK96,\n  SuperTower, $DL96,\n  Rend, $DN96,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP96": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ96": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK96),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR96": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP96),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF96-1))",
    "DS96": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG96, DH96),0))",
    "DT96": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP96),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV96, $AR$29), 0))",
    "DU96": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK96),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM241,CC96), $DV96, $AR$29), 0))",
    "DV96": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH96), $AO$29)",
    "DW96": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM96,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96, $DB96), 1),\n\n  DW, $DR96,\n  CL, $DS96,\n  SM, $DT96,\n  SLM, $DU96,\n  SL, $DQ96,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX96": "CY96*(DE96*DO96*DQ96+DW96*DF96)",
    "DZ96": "IF(INDEX($BD$6:$BD241,BT96)=\"\", \"\", INDEX($BD$5:$BD241,BT96+1))",
    "EA96": "IF(OR($AO$25, INDEX($BE$6:$BE241,BU96)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ96)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE241,BU96+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI96*$DJ96*$AQ$9),\n  SuperTower, $DL96,\n  Rend, $DN96,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96, $DB96), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR96,\n  SM, $DT96,\n  SLM, $DU96,\n  SL, $DQ96,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM96, UltCritCard),\n\nCY96*(DE96*OtherDamage*SL+UwDamage*DF96)))",
    "EB96": "IF(INDEX($BF$6:$BF241,BV96)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF241,BV96+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ96,\n  CCUW, $DA96,\n  SCM, $DD96,\n  SCC, $DC96,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96, CF), 1),\n\n  DW, $DR96,\n  CL, $DS96,\n  SM, $DT96,\n  SLM, $DU96,\n  SL, $DQ96,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM96, UltCritCard),\n\nCY96 * (Critical * DO96 * SL + UwDamage * UWCritical)))",
    "EC96": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG241,BW96)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH96,\n  Rapid, DG96,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG241, BW96+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ96*$AQ$9),\n  SuperTower, $DL96,\n  Rend, $DN96,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM241,CC96), $DV96, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM96,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96, $DB96), 1),\n\n  DW, $DR96,\n  CL, $DS96,\n  SM, $DT96,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY96*(DE96*OtherDamage*SL+UWDamage*DF96)))",
    "ED96": "IF(OR($AO$25, INDEX($BH$6:$BH241,BX96)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH241,BX96+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL96, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI96*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM241,CC96), $DV96, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH96,\n  Rapid, DG96,\n  SuperTower, $DL96,\n  Rend, $DN96,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM96,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96, $DB96), 1),\n\n  DW, $DR96,\n  CL, $DS96,\n  SM, $DT96,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY96*(DE96*OtherDamage*SL+UWDamage*DF96)))",
    "EE96": "IF(INDEX($BI$6:$BI241,BY96)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK96, 0),\n  CF, $DB96,\n  CC, $CZ96,\n  CCUW, $DA96,\n  SCM, $DD96,\n  SCC, $AV$17+INDEX($BI$5:$BI241,BY96+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY96 * (Critical*DO96*$DQ96+DW96*UWCritical)))",
    "EF96": "IF(INDEX($BJ$6:$BJ241,BZ96)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK96*1%, 1),\n  CF, $DB96,\n  CC, $CZ96,\n  CCUW, $DA96,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ241,BZ96+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC96,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY96*(Critical*DO96*$DQ96+DW96*UWCritical)))",
    "EG96": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK241,CA96)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH96,\n  Rapid, DG96,\n  DPM, (1+$DI96*$DJ96*$AQ$9),\n  Rend, $DN96,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK241,CA96+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM96*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96, $DB96), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK241,CA96+1)-1))/(45-CM96*3),1),\n\n  SL, $DQ96,\n  DW, $DR96,\n  CL, $DS96,\n  SM, $DT96,\n  SLM, $DU96,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY96*(DE96*OtherDamage*SL+UwDamage*DF96)))",
    "EH96": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL241,CB96+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL241,CB96)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH96,\n  Rapid, DG96,\n  DPM, (1+$DI96*$DJ96*$AQ$9),\n  SuperTower, $DL96,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL241,CB96+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY96*(DE96*OtherDamage*$DQ96+DW96*DF96)))",
    "EI96": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM241,CC96)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96, $DB96), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK96),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV96, $AR$29), 0),\n\n  DW, $DR96,\n  CL, $DS96,\n  SM, $DT96,\n  SL, $DQ96,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM96, UltCritCard),\nCY96*(DE96*DO96*SL+UwDamage*DF96)))",
    "EJ96": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN241,CD96)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT96,\n  DamageMastery, $CS96,\n  DemonMastery, $CX96,\n  SPB, INDEX($BN$5:$BN241,CD96+1),\n  ITO, $CV96,\n  Shock, $CW96,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE96*DO96*$DQ96+DW96*DF96)))",
    "EK96": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO241,CE96)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT96,\n  DamageMastery, $CS96,\n  DemonMastery, $CX96,\n  SPB, $CU96,\n  ITO, INDEX($BO$5:$BO241,CE96+1),\n  Shock, $CW96,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE96*DO96*$DQ96+DW96*DF96)))",
    "EL96": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP241,CF96)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96, $DB96), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP96),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF96),\n  CL, $DS96,\n  SM, $DT96,\n  SLM, $DU96,\n  SL, $DQ96,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM96, UltCritCard),\nCY96*(DE96*DO96*SL+UwDamage*DF96)))",
    "EM96": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ241,CG96)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG96+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN96": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR241,CH96)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96, $DB96), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH96+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP96),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK96),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM241,CC96), SMHeat, $AR$29), 0),\n\n  DW, $DR96,\n  CL, $DS96,\n  SL, $DQ96,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM96, UltCritCard),\nCY96*(DE96*DO96*SL+UwDamage*DF96)))",
    "EO96": "IF(OR(CI96 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI96+1))",
    "EP96": "IF(OR($AO$25, CJ96 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ96+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE240,BU96),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL96, 1),\n  DPM, (1+$DI96*CardRangeMastery*$DJ96*$AQ$9),\n  SuperTower, $DL96,\n  Rend, $DN96,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96, $DB96), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR96,\n  SM, $DT96,\n  SLM, $DU96,\n  SL, $DQ96,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM96, UltCritCard),\n\nCY96*(DE96*OtherDamage*SL+UwDamage*DF96)))",
    "EQ96": "IF(OR(CK96 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK96+1)*1%, 1),\n  CF, $DB96,\n  CC, MIN(100%, $CZ96 + 1%),\n  CCUW, DA96 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ241,BZ96) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC96 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR96,\n  CL, $DS96,\n  SM, $DT96,\n  SLM, $DU96,\n  SL, $DQ96,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM96, UltCritCard),\n\nCY96 * (Critical*DO96*SL+UwDamage*UWCritical)))",
    "ER96": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL96 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH241,BX96),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL96+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI96*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM241,CC96), $DV96, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH96,\n  Rapid, DG96,\n  SuperTower, $DL96,\n  Rend, $DN96,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM96,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96, $DB96), 1),\n\n  DW, $DR96,\n  CL, $DS96,\n  SM, $DT96,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY96*(DE96*OtherDamage*SL+UWDamage*DF96)))",
    "ES96": "IF(OR(CM96 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH96,\n  Rapid, DG96,\n  RDPM, (1+$DI96*$DJ96*$AQ$9),\n  Rend, $DN96,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK241,CA96),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM96+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96, $DB96), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR96,\n  CL, $DS96,\n  SM, $DT96,\n  SLM, $DU96,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY96*(DE96*OtherDamage*SL+UwDamage*DF96)))",
    "ET96": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN96 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM96,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN96+1, $DB96), 1),\n\n  DW, $DR96,\n  CL, $DS96,\n  SM, $DT96,\n  SLM, $DU96,\n  SL, $DQ96,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY96*(DE96*DO96*SL+UWDamage*DF96)))",
    "EU96": "IF(OR(NOT($BA$3), NOT($BA$23), $CO96 > $BA$15), \"\", 1 + 0.5*(CO96+1))",
    "EW96": "IF(DZ96=\"\", \"\", LET(\n  Now, CT96,\n  Next, DZ96,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT96),\nFactor/Cost))",
    "EX96": "IF(EA96=\"\",\"\",(EA96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU96))",
    "EY96": "IF(EB96=\"\",\"\",(EB96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV96))",
    "EZ96": "IF(EC96=\"\",\"\",(EC96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW96))",
    "FA96": "IF(ED96=\"\",\"\",(ED96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX96))",
    "FB96": "IF(EE96=\"\",\"\",(EE96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY96))",
    "FC96": "IF(EF96=\"\",\"\",(EF96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ96))",
    "FD96": "IF(EG96=\"\",\"\",(EG96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA96))",
    "FE96": "IF(EH96=\"\",\"\",(EH96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB96))",
    "FF96": "IF(EI96=\"\",\"\",(EI96/$DX96-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC96+1, 1, CC96))))",
    "FG96": "IF(EJ96=\"\",\"\",(EJ96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD96))",
    "FH96": "IF(EK96=\"\",\"\",(EK96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE96))",
    "FI96": "IF(EL96=\"\",\"\",(EL96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF96))",
    "FJ96": "IF(EM96=\"\", \"\", LET(\n  Now, CW96,\n  Next, EM96,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG96),\nFactor/Cost))",
    "FK96": "IF(EN96=\"\",\"\",(EN96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH96))",
    "FL96": "IF(EO96=\"\", \"\", LET(\n  Now, CS96,\n  Next, EO96,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI96),\nFactor/Cost))",
    "FM96": "IF(EP96=\"\",\"\",(EP96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ96))",
    "FN96": "IF(EQ96=\"\",\"\",(EQ96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK96))",
    "FO96": "IF(ER96=\"\",\"\",(ER96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL96))",
    "FP96": "IF(ES96=\"\",\"\",(ES96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM96))",
    "FQ96": "IF(ET96=\"\",\"\",(ET96/$DX96-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN96))",
    "FR96": "IF(EU96=\"\", \"\", LET(\n  Now, CX96,\n  Next, EU96,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO96),\nFactor/Cost))",
    "FT96": "IF(COLUMN(EW96:FR96) = MIN(IF(EW96:FR96=MAX(EW96:FR96), COLUMN(EW96:FR96))), 1, \"\")",
    "D97": "IF(SUM(FT96:GP96),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F97)),\"Card Mastery\",F97),G97)/$D$5,\"\")",
    "F97": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT96:GP96),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT96:GP96=1)),)\"),\"Super Tower Bonus\")",
    "G97": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT96:GP96),ARRAYFORMULA(FILTER(BT96:CP96 , FT96:GP96=1)),\"\"\"\")\"),4.0)",
    "I97": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT96:GP96),ARRAYFORMULA(FILTER(EW96:FS96 , FT96:GP96=1))*D$5,\"\"\"\")\"),0.010920418895766748)",
    "K97": "IF(H97<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D97)),)",
    "BC97": "BC96+1",
    "BD97": "BD96+BD$3",
    "BE97": "BE96+BE$3",
    "BF97": "BF96+BF$3",
    "BH97": "BH96+BH$3",
    "BT97": "BT96+FT96",
    "BU97": "BU96+FU96",
    "BV97": "BV96+FV96",
    "BW97": "BW96+FW96",
    "BX97": "BX96+FX96",
    "BY97": "BY96+FY96",
    "BZ97": "BZ96+FZ96",
    "CA97": "CA96+GA96",
    "CB97": "CB96+GB96",
    "CC97": "CC96+GC96",
    "CD97": "CD96+GD96",
    "CE97": "CE96+GE96",
    "CF97": "CF96+GF96",
    "CG97": "CG96+GG96",
    "CH97": "CH96+GH96",
    "CI97": "CI96+GI96",
    "CJ97": "CJ96+GJ96",
    "CK97": "CK96+GK96",
    "CL97": "CL96+GL96",
    "CM97": "CM96+GM96",
    "CN97": "CN96+GN96",
    "CO97": "CO96+GO96",
    "CS97": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI97,1)",
    "CT97": "INDEX($BD$5:$BD242,BT97)",
    "CU97": "INDEX($BN$5:$BN242,CD97)",
    "CV97": "INDEX($BO$5:$BO242,CE97)",
    "CW97": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG97)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX97": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO97, 1)",
    "CY97": "LET(\n  Base, $CR$6,\n  Damage, $CT97,\n  DamageMastery, $CS97,\n  DemonMastery, $CX97,\n  SPB, $CU97,\n  ITO, $CV97,\n  Shock, $CW97,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ97": "MIN(100%, DA97)",
    "DA97": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK97*1%, 0)",
    "DB97": "LET(\n  Lab, 1+INDEX($BF$5:$BF242,BV97),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC97": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK97*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI242,BY97) + CardCritMastery)",
    "DD97": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK97*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ242,BZ97) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE97": "LET(\n  CF, $DB97,\n  CC, $CZ97,\n  SCM, $DD97,\n  SCC, $DC97,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF97": "LET(\n  CF, $DB97,\n  CC, $DA97,\n  SCM, $DD97,\n  SCC, $DC97,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG97": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH97)), 0)",
    "DH97": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ97*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE242,BU97),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI97": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG242, BW97), 1) + $AE$9)",
    "DJ97": "LET(\n  DpmLab, INDEX($BH$5:$BH242,BX97),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL97, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK97": "(1+$DI97*$DJ97*$AQ$9)",
    "DL97": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK242,CA97),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM97*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM97": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK242,CA97),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM97*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN97": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL242,CB97)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO97": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH97,\n  Rapid, DG97,\n  RDPM, DK97,\n  SuperTower, $DL97,\n  Rend, $DN97,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP97": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ97": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK97),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR97": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP97),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF97-1))",
    "DS97": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG97, DH97),0))",
    "DT97": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP97),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV97, $AR$29), 0))",
    "DU97": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK97),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM242,CC97), $DV97, $AR$29), 0))",
    "DV97": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH97), $AO$29)",
    "DW97": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM97,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97, $DB97), 1),\n\n  DW, $DR97,\n  CL, $DS97,\n  SM, $DT97,\n  SLM, $DU97,\n  SL, $DQ97,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX97": "CY97*(DE97*DO97*DQ97+DW97*DF97)",
    "DZ97": "IF(INDEX($BD$6:$BD242,BT97)=\"\", \"\", INDEX($BD$5:$BD242,BT97+1))",
    "EA97": "IF(OR($AO$25, INDEX($BE$6:$BE242,BU97)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ97)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE242,BU97+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI97*$DJ97*$AQ$9),\n  SuperTower, $DL97,\n  Rend, $DN97,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97, $DB97), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR97,\n  SM, $DT97,\n  SLM, $DU97,\n  SL, $DQ97,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM97, UltCritCard),\n\nCY97*(DE97*OtherDamage*SL+UwDamage*DF97)))",
    "EB97": "IF(INDEX($BF$6:$BF242,BV97)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF242,BV97+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ97,\n  CCUW, $DA97,\n  SCM, $DD97,\n  SCC, $DC97,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97, CF), 1),\n\n  DW, $DR97,\n  CL, $DS97,\n  SM, $DT97,\n  SLM, $DU97,\n  SL, $DQ97,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM97, UltCritCard),\n\nCY97 * (Critical * DO97 * SL + UwDamage * UWCritical)))",
    "EC97": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG242,BW97)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH97,\n  Rapid, DG97,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG242, BW97+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ97*$AQ$9),\n  SuperTower, $DL97,\n  Rend, $DN97,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM242,CC97), $DV97, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM97,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97, $DB97), 1),\n\n  DW, $DR97,\n  CL, $DS97,\n  SM, $DT97,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY97*(DE97*OtherDamage*SL+UWDamage*DF97)))",
    "ED97": "IF(OR($AO$25, INDEX($BH$6:$BH242,BX97)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH242,BX97+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL97, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI97*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM242,CC97), $DV97, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH97,\n  Rapid, DG97,\n  SuperTower, $DL97,\n  Rend, $DN97,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM97,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97, $DB97), 1),\n\n  DW, $DR97,\n  CL, $DS97,\n  SM, $DT97,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY97*(DE97*OtherDamage*SL+UWDamage*DF97)))",
    "EE97": "IF(INDEX($BI$6:$BI242,BY97)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK97, 0),\n  CF, $DB97,\n  CC, $CZ97,\n  CCUW, $DA97,\n  SCM, $DD97,\n  SCC, $AV$17+INDEX($BI$5:$BI242,BY97+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY97 * (Critical*DO97*$DQ97+DW97*UWCritical)))",
    "EF97": "IF(INDEX($BJ$6:$BJ242,BZ97)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK97*1%, 1),\n  CF, $DB97,\n  CC, $CZ97,\n  CCUW, $DA97,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ242,BZ97+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC97,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY97*(Critical*DO97*$DQ97+DW97*UWCritical)))",
    "EG97": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK242,CA97)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH97,\n  Rapid, DG97,\n  DPM, (1+$DI97*$DJ97*$AQ$9),\n  Rend, $DN97,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK242,CA97+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM97*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97, $DB97), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK242,CA97+1)-1))/(45-CM97*3),1),\n\n  SL, $DQ97,\n  DW, $DR97,\n  CL, $DS97,\n  SM, $DT97,\n  SLM, $DU97,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY97*(DE97*OtherDamage*SL+UwDamage*DF97)))",
    "EH97": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL242,CB97+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL242,CB97)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH97,\n  Rapid, DG97,\n  DPM, (1+$DI97*$DJ97*$AQ$9),\n  SuperTower, $DL97,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL242,CB97+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY97*(DE97*OtherDamage*$DQ97+DW97*DF97)))",
    "EI97": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM242,CC97)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97, $DB97), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK97),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV97, $AR$29), 0),\n\n  DW, $DR97,\n  CL, $DS97,\n  SM, $DT97,\n  SL, $DQ97,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM97, UltCritCard),\nCY97*(DE97*DO97*SL+UwDamage*DF97)))",
    "EJ97": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN242,CD97)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT97,\n  DamageMastery, $CS97,\n  DemonMastery, $CX97,\n  SPB, INDEX($BN$5:$BN242,CD97+1),\n  ITO, $CV97,\n  Shock, $CW97,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE97*DO97*$DQ97+DW97*DF97)))",
    "EK97": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO242,CE97)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT97,\n  DamageMastery, $CS97,\n  DemonMastery, $CX97,\n  SPB, $CU97,\n  ITO, INDEX($BO$5:$BO242,CE97+1),\n  Shock, $CW97,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE97*DO97*$DQ97+DW97*DF97)))",
    "EL97": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP242,CF97)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97, $DB97), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP97),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF97),\n  CL, $DS97,\n  SM, $DT97,\n  SLM, $DU97,\n  SL, $DQ97,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM97, UltCritCard),\nCY97*(DE97*DO97*SL+UwDamage*DF97)))",
    "EM97": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ242,CG97)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG97+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN97": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR242,CH97)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97, $DB97), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH97+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP97),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK97),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM242,CC97), SMHeat, $AR$29), 0),\n\n  DW, $DR97,\n  CL, $DS97,\n  SL, $DQ97,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM97, UltCritCard),\nCY97*(DE97*DO97*SL+UwDamage*DF97)))",
    "EO97": "IF(OR(CI97 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI97+1))",
    "EP97": "IF(OR($AO$25, CJ97 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ97+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE241,BU97),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL97, 1),\n  DPM, (1+$DI97*CardRangeMastery*$DJ97*$AQ$9),\n  SuperTower, $DL97,\n  Rend, $DN97,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97, $DB97), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR97,\n  SM, $DT97,\n  SLM, $DU97,\n  SL, $DQ97,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM97, UltCritCard),\n\nCY97*(DE97*OtherDamage*SL+UwDamage*DF97)))",
    "EQ97": "IF(OR(CK97 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK97+1)*1%, 1),\n  CF, $DB97,\n  CC, MIN(100%, $CZ97 + 1%),\n  CCUW, DA97 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ242,BZ97) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC97 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR97,\n  CL, $DS97,\n  SM, $DT97,\n  SLM, $DU97,\n  SL, $DQ97,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM97, UltCritCard),\n\nCY97 * (Critical*DO97*SL+UwDamage*UWCritical)))",
    "ER97": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL97 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH242,BX97),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL97+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI97*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM242,CC97), $DV97, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH97,\n  Rapid, DG97,\n  SuperTower, $DL97,\n  Rend, $DN97,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM97,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97, $DB97), 1),\n\n  DW, $DR97,\n  CL, $DS97,\n  SM, $DT97,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY97*(DE97*OtherDamage*SL+UWDamage*DF97)))",
    "ES97": "IF(OR(CM97 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH97,\n  Rapid, DG97,\n  RDPM, (1+$DI97*$DJ97*$AQ$9),\n  Rend, $DN97,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK242,CA97),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM97+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97, $DB97), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR97,\n  CL, $DS97,\n  SM, $DT97,\n  SLM, $DU97,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY97*(DE97*OtherDamage*SL+UwDamage*DF97)))",
    "ET97": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN97 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM97,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN97+1, $DB97), 1),\n\n  DW, $DR97,\n  CL, $DS97,\n  SM, $DT97,\n  SLM, $DU97,\n  SL, $DQ97,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY97*(DE97*DO97*SL+UWDamage*DF97)))",
    "EU97": "IF(OR(NOT($BA$3), NOT($BA$23), $CO97 > $BA$15), \"\", 1 + 0.5*(CO97+1))",
    "EW97": "IF(DZ97=\"\", \"\", LET(\n  Now, CT97,\n  Next, DZ97,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT97),\nFactor/Cost))",
    "EX97": "IF(EA97=\"\",\"\",(EA97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU97))",
    "EY97": "IF(EB97=\"\",\"\",(EB97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV97))",
    "EZ97": "IF(EC97=\"\",\"\",(EC97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW97))",
    "FA97": "IF(ED97=\"\",\"\",(ED97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX97))",
    "FB97": "IF(EE97=\"\",\"\",(EE97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY97))",
    "FC97": "IF(EF97=\"\",\"\",(EF97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ97))",
    "FD97": "IF(EG97=\"\",\"\",(EG97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA97))",
    "FE97": "IF(EH97=\"\",\"\",(EH97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB97))",
    "FF97": "IF(EI97=\"\",\"\",(EI97/$DX97-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC97+1, 1, CC97))))",
    "FG97": "IF(EJ97=\"\",\"\",(EJ97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD97))",
    "FH97": "IF(EK97=\"\",\"\",(EK97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE97))",
    "FI97": "IF(EL97=\"\",\"\",(EL97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF97))",
    "FJ97": "IF(EM97=\"\", \"\", LET(\n  Now, CW97,\n  Next, EM97,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG97),\nFactor/Cost))",
    "FK97": "IF(EN97=\"\",\"\",(EN97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH97))",
    "FL97": "IF(EO97=\"\", \"\", LET(\n  Now, CS97,\n  Next, EO97,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI97),\nFactor/Cost))",
    "FM97": "IF(EP97=\"\",\"\",(EP97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ97))",
    "FN97": "IF(EQ97=\"\",\"\",(EQ97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK97))",
    "FO97": "IF(ER97=\"\",\"\",(ER97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL97))",
    "FP97": "IF(ES97=\"\",\"\",(ES97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM97))",
    "FQ97": "IF(ET97=\"\",\"\",(ET97/$DX97-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN97))",
    "FR97": "IF(EU97=\"\", \"\", LET(\n  Now, CX97,\n  Next, EU97,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO97),\nFactor/Cost))",
    "FT97": "IF(COLUMN(EW97:FR97) = MIN(IF(EW97:FR97=MAX(EW97:FR97), COLUMN(EW97:FR97))), 1, \"\")",
    "D98": "IF(SUM(FT97:GP97),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F98)),\"Card Mastery\",F98),G98)/$D$5,\"\")",
    "F98": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT97:GP97),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT97:GP97=1)),)\"),\"Attack Speed\")",
    "G98": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT97:GP97),ARRAYFORMULA(FILTER(BT97:CP97 , FT97:GP97=1)),\"\"\"\")\"),22.0)",
    "I98": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT97:GP97),ARRAYFORMULA(FILTER(EW97:FS97 , FT97:GP97=1))*D$5,\"\"\"\")\"),0.010866669065385732)",
    "K98": "IF(H98<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D98)),)",
    "BC98": "BC97+1",
    "BD98": "BD97+BD$3",
    "BE98": "BE97+BE$3",
    "BF98": "BF97+BF$3",
    "BH98": "BH97+BH$3",
    "BT98": "BT97+FT97",
    "BU98": "BU97+FU97",
    "BV98": "BV97+FV97",
    "BW98": "BW97+FW97",
    "BX98": "BX97+FX97",
    "BY98": "BY97+FY97",
    "BZ98": "BZ97+FZ97",
    "CA98": "CA97+GA97",
    "CB98": "CB97+GB97",
    "CC98": "CC97+GC97",
    "CD98": "CD97+GD97",
    "CE98": "CE97+GE97",
    "CF98": "CF97+GF97",
    "CG98": "CG97+GG97",
    "CH98": "CH97+GH97",
    "CI98": "CI97+GI97",
    "CJ98": "CJ97+GJ97",
    "CK98": "CK97+GK97",
    "CL98": "CL97+GL97",
    "CM98": "CM97+GM97",
    "CN98": "CN97+GN97",
    "CO98": "CO97+GO97",
    "CS98": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI98,1)",
    "CT98": "INDEX($BD$5:$BD243,BT98)",
    "CU98": "INDEX($BN$5:$BN243,CD98)",
    "CV98": "INDEX($BO$5:$BO243,CE98)",
    "CW98": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG98)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX98": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO98, 1)",
    "CY98": "LET(\n  Base, $CR$6,\n  Damage, $CT98,\n  DamageMastery, $CS98,\n  DemonMastery, $CX98,\n  SPB, $CU98,\n  ITO, $CV98,\n  Shock, $CW98,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ98": "MIN(100%, DA98)",
    "DA98": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK98*1%, 0)",
    "DB98": "LET(\n  Lab, 1+INDEX($BF$5:$BF243,BV98),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC98": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK98*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI243,BY98) + CardCritMastery)",
    "DD98": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK98*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ243,BZ98) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE98": "LET(\n  CF, $DB98,\n  CC, $CZ98,\n  SCM, $DD98,\n  SCC, $DC98,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF98": "LET(\n  CF, $DB98,\n  CC, $DA98,\n  SCM, $DD98,\n  SCC, $DC98,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG98": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH98)), 0)",
    "DH98": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ98*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE243,BU98),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI98": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG243, BW98), 1) + $AE$9)",
    "DJ98": "LET(\n  DpmLab, INDEX($BH$5:$BH243,BX98),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL98, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK98": "(1+$DI98*$DJ98*$AQ$9)",
    "DL98": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK243,CA98),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM98*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM98": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK243,CA98),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM98*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN98": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL243,CB98)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO98": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH98,\n  Rapid, DG98,\n  RDPM, DK98,\n  SuperTower, $DL98,\n  Rend, $DN98,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP98": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ98": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK98),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR98": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP98),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF98-1))",
    "DS98": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG98, DH98),0))",
    "DT98": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP98),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV98, $AR$29), 0))",
    "DU98": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK98),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM243,CC98), $DV98, $AR$29), 0))",
    "DV98": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH98), $AO$29)",
    "DW98": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM98,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98, $DB98), 1),\n\n  DW, $DR98,\n  CL, $DS98,\n  SM, $DT98,\n  SLM, $DU98,\n  SL, $DQ98,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX98": "CY98*(DE98*DO98*DQ98+DW98*DF98)",
    "DZ98": "IF(INDEX($BD$6:$BD243,BT98)=\"\", \"\", INDEX($BD$5:$BD243,BT98+1))",
    "EA98": "IF(OR($AO$25, INDEX($BE$6:$BE243,BU98)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ98)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE243,BU98+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI98*$DJ98*$AQ$9),\n  SuperTower, $DL98,\n  Rend, $DN98,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98, $DB98), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR98,\n  SM, $DT98,\n  SLM, $DU98,\n  SL, $DQ98,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM98, UltCritCard),\n\nCY98*(DE98*OtherDamage*SL+UwDamage*DF98)))",
    "EB98": "IF(INDEX($BF$6:$BF243,BV98)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF243,BV98+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ98,\n  CCUW, $DA98,\n  SCM, $DD98,\n  SCC, $DC98,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98, CF), 1),\n\n  DW, $DR98,\n  CL, $DS98,\n  SM, $DT98,\n  SLM, $DU98,\n  SL, $DQ98,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM98, UltCritCard),\n\nCY98 * (Critical * DO98 * SL + UwDamage * UWCritical)))",
    "EC98": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG243,BW98)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH98,\n  Rapid, DG98,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG243, BW98+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ98*$AQ$9),\n  SuperTower, $DL98,\n  Rend, $DN98,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM243,CC98), $DV98, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM98,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98, $DB98), 1),\n\n  DW, $DR98,\n  CL, $DS98,\n  SM, $DT98,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY98*(DE98*OtherDamage*SL+UWDamage*DF98)))",
    "ED98": "IF(OR($AO$25, INDEX($BH$6:$BH243,BX98)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH243,BX98+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL98, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI98*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM243,CC98), $DV98, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH98,\n  Rapid, DG98,\n  SuperTower, $DL98,\n  Rend, $DN98,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM98,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98, $DB98), 1),\n\n  DW, $DR98,\n  CL, $DS98,\n  SM, $DT98,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY98*(DE98*OtherDamage*SL+UWDamage*DF98)))",
    "EE98": "IF(INDEX($BI$6:$BI243,BY98)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK98, 0),\n  CF, $DB98,\n  CC, $CZ98,\n  CCUW, $DA98,\n  SCM, $DD98,\n  SCC, $AV$17+INDEX($BI$5:$BI243,BY98+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY98 * (Critical*DO98*$DQ98+DW98*UWCritical)))",
    "EF98": "IF(INDEX($BJ$6:$BJ243,BZ98)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK98*1%, 1),\n  CF, $DB98,\n  CC, $CZ98,\n  CCUW, $DA98,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ243,BZ98+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC98,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY98*(Critical*DO98*$DQ98+DW98*UWCritical)))",
    "EG98": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK243,CA98)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH98,\n  Rapid, DG98,\n  DPM, (1+$DI98*$DJ98*$AQ$9),\n  Rend, $DN98,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK243,CA98+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM98*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98, $DB98), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK243,CA98+1)-1))/(45-CM98*3),1),\n\n  SL, $DQ98,\n  DW, $DR98,\n  CL, $DS98,\n  SM, $DT98,\n  SLM, $DU98,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY98*(DE98*OtherDamage*SL+UwDamage*DF98)))",
    "EH98": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL243,CB98+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL243,CB98)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH98,\n  Rapid, DG98,\n  DPM, (1+$DI98*$DJ98*$AQ$9),\n  SuperTower, $DL98,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL243,CB98+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY98*(DE98*OtherDamage*$DQ98+DW98*DF98)))",
    "EI98": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM243,CC98)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98, $DB98), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK98),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV98, $AR$29), 0),\n\n  DW, $DR98,\n  CL, $DS98,\n  SM, $DT98,\n  SL, $DQ98,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM98, UltCritCard),\nCY98*(DE98*DO98*SL+UwDamage*DF98)))",
    "EJ98": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN243,CD98)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT98,\n  DamageMastery, $CS98,\n  DemonMastery, $CX98,\n  SPB, INDEX($BN$5:$BN243,CD98+1),\n  ITO, $CV98,\n  Shock, $CW98,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE98*DO98*$DQ98+DW98*DF98)))",
    "EK98": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO243,CE98)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT98,\n  DamageMastery, $CS98,\n  DemonMastery, $CX98,\n  SPB, $CU98,\n  ITO, INDEX($BO$5:$BO243,CE98+1),\n  Shock, $CW98,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE98*DO98*$DQ98+DW98*DF98)))",
    "EL98": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP243,CF98)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98, $DB98), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP98),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF98),\n  CL, $DS98,\n  SM, $DT98,\n  SLM, $DU98,\n  SL, $DQ98,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM98, UltCritCard),\nCY98*(DE98*DO98*SL+UwDamage*DF98)))",
    "EM98": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ243,CG98)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG98+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN98": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR243,CH98)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98, $DB98), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH98+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP98),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK98),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM243,CC98), SMHeat, $AR$29), 0),\n\n  DW, $DR98,\n  CL, $DS98,\n  SL, $DQ98,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM98, UltCritCard),\nCY98*(DE98*DO98*SL+UwDamage*DF98)))",
    "EO98": "IF(OR(CI98 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI98+1))",
    "EP98": "IF(OR($AO$25, CJ98 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ98+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE242,BU98),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL98, 1),\n  DPM, (1+$DI98*CardRangeMastery*$DJ98*$AQ$9),\n  SuperTower, $DL98,\n  Rend, $DN98,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98, $DB98), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR98,\n  SM, $DT98,\n  SLM, $DU98,\n  SL, $DQ98,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM98, UltCritCard),\n\nCY98*(DE98*OtherDamage*SL+UwDamage*DF98)))",
    "EQ98": "IF(OR(CK98 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK98+1)*1%, 1),\n  CF, $DB98,\n  CC, MIN(100%, $CZ98 + 1%),\n  CCUW, DA98 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ243,BZ98) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC98 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR98,\n  CL, $DS98,\n  SM, $DT98,\n  SLM, $DU98,\n  SL, $DQ98,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM98, UltCritCard),\n\nCY98 * (Critical*DO98*SL+UwDamage*UWCritical)))",
    "ER98": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL98 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH243,BX98),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL98+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI98*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM243,CC98), $DV98, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH98,\n  Rapid, DG98,\n  SuperTower, $DL98,\n  Rend, $DN98,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM98,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98, $DB98), 1),\n\n  DW, $DR98,\n  CL, $DS98,\n  SM, $DT98,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY98*(DE98*OtherDamage*SL+UWDamage*DF98)))",
    "ES98": "IF(OR(CM98 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH98,\n  Rapid, DG98,\n  RDPM, (1+$DI98*$DJ98*$AQ$9),\n  Rend, $DN98,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK243,CA98),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM98+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98, $DB98), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR98,\n  CL, $DS98,\n  SM, $DT98,\n  SLM, $DU98,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY98*(DE98*OtherDamage*SL+UwDamage*DF98)))",
    "ET98": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN98 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM98,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN98+1, $DB98), 1),\n\n  DW, $DR98,\n  CL, $DS98,\n  SM, $DT98,\n  SLM, $DU98,\n  SL, $DQ98,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY98*(DE98*DO98*SL+UWDamage*DF98)))",
    "EU98": "IF(OR(NOT($BA$3), NOT($BA$23), $CO98 > $BA$15), \"\", 1 + 0.5*(CO98+1))",
    "EW98": "IF(DZ98=\"\", \"\", LET(\n  Now, CT98,\n  Next, DZ98,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT98),\nFactor/Cost))",
    "EX98": "IF(EA98=\"\",\"\",(EA98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU98))",
    "EY98": "IF(EB98=\"\",\"\",(EB98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV98))",
    "EZ98": "IF(EC98=\"\",\"\",(EC98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW98))",
    "FA98": "IF(ED98=\"\",\"\",(ED98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX98))",
    "FB98": "IF(EE98=\"\",\"\",(EE98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY98))",
    "FC98": "IF(EF98=\"\",\"\",(EF98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ98))",
    "FD98": "IF(EG98=\"\",\"\",(EG98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA98))",
    "FE98": "IF(EH98=\"\",\"\",(EH98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB98))",
    "FF98": "IF(EI98=\"\",\"\",(EI98/$DX98-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC98+1, 1, CC98))))",
    "FG98": "IF(EJ98=\"\",\"\",(EJ98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD98))",
    "FH98": "IF(EK98=\"\",\"\",(EK98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE98))",
    "FI98": "IF(EL98=\"\",\"\",(EL98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF98))",
    "FJ98": "IF(EM98=\"\", \"\", LET(\n  Now, CW98,\n  Next, EM98,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG98),\nFactor/Cost))",
    "FK98": "IF(EN98=\"\",\"\",(EN98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH98))",
    "FL98": "IF(EO98=\"\", \"\", LET(\n  Now, CS98,\n  Next, EO98,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI98),\nFactor/Cost))",
    "FM98": "IF(EP98=\"\",\"\",(EP98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ98))",
    "FN98": "IF(EQ98=\"\",\"\",(EQ98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK98))",
    "FO98": "IF(ER98=\"\",\"\",(ER98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL98))",
    "FP98": "IF(ES98=\"\",\"\",(ES98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM98))",
    "FQ98": "IF(ET98=\"\",\"\",(ET98/$DX98-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN98))",
    "FR98": "IF(EU98=\"\", \"\", LET(\n  Now, CX98,\n  Next, EU98,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO98),\nFactor/Cost))",
    "FT98": "IF(COLUMN(EW98:FR98) = MIN(IF(EW98:FR98=MAX(EW98:FR98), COLUMN(EW98:FR98))), 1, \"\")",
    "D99": "IF(SUM(FT98:GP98),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F99)),\"Card Mastery\",F99),G99)/$D$5,\"\")",
    "F99": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT98:GP98),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT98:GP98=1)),)\"),\"Damage / Meter\")",
    "G99": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT98:GP98),ARRAYFORMULA(FILTER(BT98:CP98 , FT98:GP98=1)),\"\"\"\")\"),17.0)",
    "I99": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT98:GP98),ARRAYFORMULA(FILTER(EW98:FS98 , FT98:GP98=1))*D$5,\"\"\"\")\"),0.01008804333653616)",
    "K99": "IF(H99<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D99)),)",
    "BC99": "BC98+1",
    "BD99": "BD98+BD$3",
    "BE99": "BE98+BE$3",
    "BF99": "BF98+BF$3",
    "BH99": "BH98+BH$3",
    "BT99": "BT98+FT98",
    "BU99": "BU98+FU98",
    "BV99": "BV98+FV98",
    "BW99": "BW98+FW98",
    "BX99": "BX98+FX98",
    "BY99": "BY98+FY98",
    "BZ99": "BZ98+FZ98",
    "CA99": "CA98+GA98",
    "CB99": "CB98+GB98",
    "CC99": "CC98+GC98",
    "CD99": "CD98+GD98",
    "CE99": "CE98+GE98",
    "CF99": "CF98+GF98",
    "CG99": "CG98+GG98",
    "CH99": "CH98+GH98",
    "CI99": "CI98+GI98",
    "CJ99": "CJ98+GJ98",
    "CK99": "CK98+GK98",
    "CL99": "CL98+GL98",
    "CM99": "CM98+GM98",
    "CN99": "CN98+GN98",
    "CO99": "CO98+GO98",
    "CS99": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI99,1)",
    "CT99": "INDEX($BD$5:$BD244,BT99)",
    "CU99": "INDEX($BN$5:$BN244,CD99)",
    "CV99": "INDEX($BO$5:$BO244,CE99)",
    "CW99": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG99)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX99": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO99, 1)",
    "CY99": "LET(\n  Base, $CR$6,\n  Damage, $CT99,\n  DamageMastery, $CS99,\n  DemonMastery, $CX99,\n  SPB, $CU99,\n  ITO, $CV99,\n  Shock, $CW99,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ99": "MIN(100%, DA99)",
    "DA99": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK99*1%, 0)",
    "DB99": "LET(\n  Lab, 1+INDEX($BF$5:$BF244,BV99),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC99": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK99*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI244,BY99) + CardCritMastery)",
    "DD99": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK99*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ244,BZ99) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE99": "LET(\n  CF, $DB99,\n  CC, $CZ99,\n  SCM, $DD99,\n  SCC, $DC99,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF99": "LET(\n  CF, $DB99,\n  CC, $DA99,\n  SCM, $DD99,\n  SCC, $DC99,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG99": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH99)), 0)",
    "DH99": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ99*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE244,BU99),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI99": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG244, BW99), 1) + $AE$9)",
    "DJ99": "LET(\n  DpmLab, INDEX($BH$5:$BH244,BX99),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL99, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK99": "(1+$DI99*$DJ99*$AQ$9)",
    "DL99": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK244,CA99),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM99*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM99": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK244,CA99),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM99*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN99": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL244,CB99)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO99": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH99,\n  Rapid, DG99,\n  RDPM, DK99,\n  SuperTower, $DL99,\n  Rend, $DN99,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP99": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ99": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK99),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR99": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP99),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF99-1))",
    "DS99": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG99, DH99),0))",
    "DT99": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP99),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV99, $AR$29), 0))",
    "DU99": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK99),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM244,CC99), $DV99, $AR$29), 0))",
    "DV99": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH99), $AO$29)",
    "DW99": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM99,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99, $DB99), 1),\n\n  DW, $DR99,\n  CL, $DS99,\n  SM, $DT99,\n  SLM, $DU99,\n  SL, $DQ99,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX99": "CY99*(DE99*DO99*DQ99+DW99*DF99)",
    "DZ99": "IF(INDEX($BD$6:$BD244,BT99)=\"\", \"\", INDEX($BD$5:$BD244,BT99+1))",
    "EA99": "IF(OR($AO$25, INDEX($BE$6:$BE244,BU99)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ99)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE244,BU99+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI99*$DJ99*$AQ$9),\n  SuperTower, $DL99,\n  Rend, $DN99,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99, $DB99), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR99,\n  SM, $DT99,\n  SLM, $DU99,\n  SL, $DQ99,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM99, UltCritCard),\n\nCY99*(DE99*OtherDamage*SL+UwDamage*DF99)))",
    "EB99": "IF(INDEX($BF$6:$BF244,BV99)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF244,BV99+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ99,\n  CCUW, $DA99,\n  SCM, $DD99,\n  SCC, $DC99,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99, CF), 1),\n\n  DW, $DR99,\n  CL, $DS99,\n  SM, $DT99,\n  SLM, $DU99,\n  SL, $DQ99,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM99, UltCritCard),\n\nCY99 * (Critical * DO99 * SL + UwDamage * UWCritical)))",
    "EC99": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG244,BW99)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH99,\n  Rapid, DG99,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG244, BW99+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ99*$AQ$9),\n  SuperTower, $DL99,\n  Rend, $DN99,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM244,CC99), $DV99, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM99,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99, $DB99), 1),\n\n  DW, $DR99,\n  CL, $DS99,\n  SM, $DT99,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY99*(DE99*OtherDamage*SL+UWDamage*DF99)))",
    "ED99": "IF(OR($AO$25, INDEX($BH$6:$BH244,BX99)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH244,BX99+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL99, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI99*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM244,CC99), $DV99, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH99,\n  Rapid, DG99,\n  SuperTower, $DL99,\n  Rend, $DN99,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM99,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99, $DB99), 1),\n\n  DW, $DR99,\n  CL, $DS99,\n  SM, $DT99,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY99*(DE99*OtherDamage*SL+UWDamage*DF99)))",
    "EE99": "IF(INDEX($BI$6:$BI244,BY99)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK99, 0),\n  CF, $DB99,\n  CC, $CZ99,\n  CCUW, $DA99,\n  SCM, $DD99,\n  SCC, $AV$17+INDEX($BI$5:$BI244,BY99+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY99 * (Critical*DO99*$DQ99+DW99*UWCritical)))",
    "EF99": "IF(INDEX($BJ$6:$BJ244,BZ99)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK99*1%, 1),\n  CF, $DB99,\n  CC, $CZ99,\n  CCUW, $DA99,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ244,BZ99+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC99,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY99*(Critical*DO99*$DQ99+DW99*UWCritical)))",
    "EG99": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK244,CA99)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH99,\n  Rapid, DG99,\n  DPM, (1+$DI99*$DJ99*$AQ$9),\n  Rend, $DN99,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK244,CA99+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM99*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99, $DB99), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK244,CA99+1)-1))/(45-CM99*3),1),\n\n  SL, $DQ99,\n  DW, $DR99,\n  CL, $DS99,\n  SM, $DT99,\n  SLM, $DU99,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY99*(DE99*OtherDamage*SL+UwDamage*DF99)))",
    "EH99": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL244,CB99+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL244,CB99)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH99,\n  Rapid, DG99,\n  DPM, (1+$DI99*$DJ99*$AQ$9),\n  SuperTower, $DL99,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL244,CB99+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY99*(DE99*OtherDamage*$DQ99+DW99*DF99)))",
    "EI99": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM244,CC99)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99, $DB99), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK99),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV99, $AR$29), 0),\n\n  DW, $DR99,\n  CL, $DS99,\n  SM, $DT99,\n  SL, $DQ99,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM99, UltCritCard),\nCY99*(DE99*DO99*SL+UwDamage*DF99)))",
    "EJ99": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN244,CD99)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT99,\n  DamageMastery, $CS99,\n  DemonMastery, $CX99,\n  SPB, INDEX($BN$5:$BN244,CD99+1),\n  ITO, $CV99,\n  Shock, $CW99,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE99*DO99*$DQ99+DW99*DF99)))",
    "EK99": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO244,CE99)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT99,\n  DamageMastery, $CS99,\n  DemonMastery, $CX99,\n  SPB, $CU99,\n  ITO, INDEX($BO$5:$BO244,CE99+1),\n  Shock, $CW99,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE99*DO99*$DQ99+DW99*DF99)))",
    "EL99": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP244,CF99)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99, $DB99), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP99),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF99),\n  CL, $DS99,\n  SM, $DT99,\n  SLM, $DU99,\n  SL, $DQ99,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM99, UltCritCard),\nCY99*(DE99*DO99*SL+UwDamage*DF99)))",
    "EM99": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ244,CG99)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG99+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN99": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR244,CH99)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99, $DB99), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH99+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP99),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK99),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM244,CC99), SMHeat, $AR$29), 0),\n\n  DW, $DR99,\n  CL, $DS99,\n  SL, $DQ99,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM99, UltCritCard),\nCY99*(DE99*DO99*SL+UwDamage*DF99)))",
    "EO99": "IF(OR(CI99 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI99+1))",
    "EP99": "IF(OR($AO$25, CJ99 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ99+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE243,BU99),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL99, 1),\n  DPM, (1+$DI99*CardRangeMastery*$DJ99*$AQ$9),\n  SuperTower, $DL99,\n  Rend, $DN99,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99, $DB99), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR99,\n  SM, $DT99,\n  SLM, $DU99,\n  SL, $DQ99,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM99, UltCritCard),\n\nCY99*(DE99*OtherDamage*SL+UwDamage*DF99)))",
    "EQ99": "IF(OR(CK99 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK99+1)*1%, 1),\n  CF, $DB99,\n  CC, MIN(100%, $CZ99 + 1%),\n  CCUW, DA99 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ244,BZ99) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC99 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR99,\n  CL, $DS99,\n  SM, $DT99,\n  SLM, $DU99,\n  SL, $DQ99,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM99, UltCritCard),\n\nCY99 * (Critical*DO99*SL+UwDamage*UWCritical)))",
    "ER99": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL99 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH244,BX99),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL99+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI99*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM244,CC99), $DV99, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH99,\n  Rapid, DG99,\n  SuperTower, $DL99,\n  Rend, $DN99,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM99,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99, $DB99), 1),\n\n  DW, $DR99,\n  CL, $DS99,\n  SM, $DT99,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY99*(DE99*OtherDamage*SL+UWDamage*DF99)))",
    "ES99": "IF(OR(CM99 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH99,\n  Rapid, DG99,\n  RDPM, (1+$DI99*$DJ99*$AQ$9),\n  Rend, $DN99,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK244,CA99),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM99+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99, $DB99), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR99,\n  CL, $DS99,\n  SM, $DT99,\n  SLM, $DU99,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY99*(DE99*OtherDamage*SL+UwDamage*DF99)))",
    "ET99": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN99 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM99,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN99+1, $DB99), 1),\n\n  DW, $DR99,\n  CL, $DS99,\n  SM, $DT99,\n  SLM, $DU99,\n  SL, $DQ99,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY99*(DE99*DO99*SL+UWDamage*DF99)))",
    "EU99": "IF(OR(NOT($BA$3), NOT($BA$23), $CO99 > $BA$15), \"\", 1 + 0.5*(CO99+1))",
    "EW99": "IF(DZ99=\"\", \"\", LET(\n  Now, CT99,\n  Next, DZ99,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT99),\nFactor/Cost))",
    "EX99": "IF(EA99=\"\",\"\",(EA99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU99))",
    "EY99": "IF(EB99=\"\",\"\",(EB99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV99))",
    "EZ99": "IF(EC99=\"\",\"\",(EC99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW99))",
    "FA99": "IF(ED99=\"\",\"\",(ED99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX99))",
    "FB99": "IF(EE99=\"\",\"\",(EE99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY99))",
    "FC99": "IF(EF99=\"\",\"\",(EF99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ99))",
    "FD99": "IF(EG99=\"\",\"\",(EG99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA99))",
    "FE99": "IF(EH99=\"\",\"\",(EH99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB99))",
    "FF99": "IF(EI99=\"\",\"\",(EI99/$DX99-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC99+1, 1, CC99))))",
    "FG99": "IF(EJ99=\"\",\"\",(EJ99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD99))",
    "FH99": "IF(EK99=\"\",\"\",(EK99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE99))",
    "FI99": "IF(EL99=\"\",\"\",(EL99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF99))",
    "FJ99": "IF(EM99=\"\", \"\", LET(\n  Now, CW99,\n  Next, EM99,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG99),\nFactor/Cost))",
    "FK99": "IF(EN99=\"\",\"\",(EN99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH99))",
    "FL99": "IF(EO99=\"\", \"\", LET(\n  Now, CS99,\n  Next, EO99,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI99),\nFactor/Cost))",
    "FM99": "IF(EP99=\"\",\"\",(EP99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ99))",
    "FN99": "IF(EQ99=\"\",\"\",(EQ99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK99))",
    "FO99": "IF(ER99=\"\",\"\",(ER99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL99))",
    "FP99": "IF(ES99=\"\",\"\",(ES99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM99))",
    "FQ99": "IF(ET99=\"\",\"\",(ET99/$DX99-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN99))",
    "FR99": "IF(EU99=\"\", \"\", LET(\n  Now, CX99,\n  Next, EU99,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO99),\nFactor/Cost))",
    "FT99": "IF(COLUMN(EW99:FR99) = MIN(IF(EW99:FR99=MAX(EW99:FR99), COLUMN(EW99:FR99))), 1, \"\")",
    "D100": "IF(SUM(FT99:GP99),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F100)),\"Card Mastery\",F100),G100)/$D$5,\"\")",
    "F100": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT99:GP99),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT99:GP99=1)),)\"),\"Critical Factor\")",
    "G100": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT99:GP99),ARRAYFORMULA(FILTER(BT99:CP99 , FT99:GP99=1)),\"\"\"\")\"),25.0)",
    "I100": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT99:GP99),ARRAYFORMULA(FILTER(EW99:FS99 , FT99:GP99=1))*D$5,\"\"\"\")\"),0.010053369272204805)",
    "K100": "IF(H100<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D100)),)",
    "BC100": "BC99+1",
    "BD100": "BD99+BD$3",
    "BE100": "BE99+BE$3",
    "BF100": "BF99+BF$3",
    "BH100": "BH99+BH$3",
    "BT100": "BT99+FT99",
    "BU100": "BU99+FU99",
    "BV100": "BV99+FV99",
    "BW100": "BW99+FW99",
    "BX100": "BX99+FX99",
    "BY100": "BY99+FY99",
    "BZ100": "BZ99+FZ99",
    "CA100": "CA99+GA99",
    "CB100": "CB99+GB99",
    "CC100": "CC99+GC99",
    "CD100": "CD99+GD99",
    "CE100": "CE99+GE99",
    "CF100": "CF99+GF99",
    "CG100": "CG99+GG99",
    "CH100": "CH99+GH99",
    "CI100": "CI99+GI99",
    "CJ100": "CJ99+GJ99",
    "CK100": "CK99+GK99",
    "CL100": "CL99+GL99",
    "CM100": "CM99+GM99",
    "CN100": "CN99+GN99",
    "CO100": "CO99+GO99",
    "CS100": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI100,1)",
    "CT100": "INDEX($BD$5:$BD245,BT100)",
    "CU100": "INDEX($BN$5:$BN245,CD100)",
    "CV100": "INDEX($BO$5:$BO245,CE100)",
    "CW100": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG100)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX100": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO100, 1)",
    "CY100": "LET(\n  Base, $CR$6,\n  Damage, $CT100,\n  DamageMastery, $CS100,\n  DemonMastery, $CX100,\n  SPB, $CU100,\n  ITO, $CV100,\n  Shock, $CW100,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ100": "MIN(100%, DA100)",
    "DA100": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK100*1%, 0)",
    "DB100": "LET(\n  Lab, 1+INDEX($BF$5:$BF245,BV100),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC100": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK100*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI245,BY100) + CardCritMastery)",
    "DD100": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK100*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ245,BZ100) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE100": "LET(\n  CF, $DB100,\n  CC, $CZ100,\n  SCM, $DD100,\n  SCC, $DC100,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF100": "LET(\n  CF, $DB100,\n  CC, $DA100,\n  SCM, $DD100,\n  SCC, $DC100,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG100": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH100)), 0)",
    "DH100": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ100*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE245,BU100),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI100": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG245, BW100), 1) + $AE$9)",
    "DJ100": "LET(\n  DpmLab, INDEX($BH$5:$BH245,BX100),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL100, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK100": "(1+$DI100*$DJ100*$AQ$9)",
    "DL100": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK245,CA100),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM100*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM100": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK245,CA100),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM100*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN100": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL245,CB100)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO100": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH100,\n  Rapid, DG100,\n  RDPM, DK100,\n  SuperTower, $DL100,\n  Rend, $DN100,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP100": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ100": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK100),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR100": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP100),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF100-1))",
    "DS100": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG100, DH100),0))",
    "DT100": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP100),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV100, $AR$29), 0))",
    "DU100": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK100),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM245,CC100), $DV100, $AR$29), 0))",
    "DV100": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH100), $AO$29)",
    "DW100": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM100,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100, $DB100), 1),\n\n  DW, $DR100,\n  CL, $DS100,\n  SM, $DT100,\n  SLM, $DU100,\n  SL, $DQ100,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX100": "CY100*(DE100*DO100*DQ100+DW100*DF100)",
    "DZ100": "IF(INDEX($BD$6:$BD245,BT100)=\"\", \"\", INDEX($BD$5:$BD245,BT100+1))",
    "EA100": "IF(OR($AO$25, INDEX($BE$6:$BE245,BU100)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ100)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE245,BU100+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI100*$DJ100*$AQ$9),\n  SuperTower, $DL100,\n  Rend, $DN100,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100, $DB100), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR100,\n  SM, $DT100,\n  SLM, $DU100,\n  SL, $DQ100,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM100, UltCritCard),\n\nCY100*(DE100*OtherDamage*SL+UwDamage*DF100)))",
    "EB100": "IF(INDEX($BF$6:$BF245,BV100)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF245,BV100+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ100,\n  CCUW, $DA100,\n  SCM, $DD100,\n  SCC, $DC100,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100, CF), 1),\n\n  DW, $DR100,\n  CL, $DS100,\n  SM, $DT100,\n  SLM, $DU100,\n  SL, $DQ100,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM100, UltCritCard),\n\nCY100 * (Critical * DO100 * SL + UwDamage * UWCritical)))",
    "EC100": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG245,BW100)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH100,\n  Rapid, DG100,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG245, BW100+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ100*$AQ$9),\n  SuperTower, $DL100,\n  Rend, $DN100,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM245,CC100), $DV100, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM100,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100, $DB100), 1),\n\n  DW, $DR100,\n  CL, $DS100,\n  SM, $DT100,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY100*(DE100*OtherDamage*SL+UWDamage*DF100)))",
    "ED100": "IF(OR($AO$25, INDEX($BH$6:$BH245,BX100)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH245,BX100+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL100, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI100*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM245,CC100), $DV100, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH100,\n  Rapid, DG100,\n  SuperTower, $DL100,\n  Rend, $DN100,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM100,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100, $DB100), 1),\n\n  DW, $DR100,\n  CL, $DS100,\n  SM, $DT100,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY100*(DE100*OtherDamage*SL+UWDamage*DF100)))",
    "EE100": "IF(INDEX($BI$6:$BI245,BY100)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK100, 0),\n  CF, $DB100,\n  CC, $CZ100,\n  CCUW, $DA100,\n  SCM, $DD100,\n  SCC, $AV$17+INDEX($BI$5:$BI245,BY100+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY100 * (Critical*DO100*$DQ100+DW100*UWCritical)))",
    "EF100": "IF(INDEX($BJ$6:$BJ245,BZ100)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK100*1%, 1),\n  CF, $DB100,\n  CC, $CZ100,\n  CCUW, $DA100,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ245,BZ100+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC100,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY100*(Critical*DO100*$DQ100+DW100*UWCritical)))",
    "EG100": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK245,CA100)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH100,\n  Rapid, DG100,\n  DPM, (1+$DI100*$DJ100*$AQ$9),\n  Rend, $DN100,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK245,CA100+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM100*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100, $DB100), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK245,CA100+1)-1))/(45-CM100*3),1),\n\n  SL, $DQ100,\n  DW, $DR100,\n  CL, $DS100,\n  SM, $DT100,\n  SLM, $DU100,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY100*(DE100*OtherDamage*SL+UwDamage*DF100)))",
    "EH100": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL245,CB100+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL245,CB100)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH100,\n  Rapid, DG100,\n  DPM, (1+$DI100*$DJ100*$AQ$9),\n  SuperTower, $DL100,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL245,CB100+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY100*(DE100*OtherDamage*$DQ100+DW100*DF100)))",
    "EI100": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM245,CC100)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100, $DB100), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK100),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV100, $AR$29), 0),\n\n  DW, $DR100,\n  CL, $DS100,\n  SM, $DT100,\n  SL, $DQ100,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM100, UltCritCard),\nCY100*(DE100*DO100*SL+UwDamage*DF100)))",
    "EJ100": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN245,CD100)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT100,\n  DamageMastery, $CS100,\n  DemonMastery, $CX100,\n  SPB, INDEX($BN$5:$BN245,CD100+1),\n  ITO, $CV100,\n  Shock, $CW100,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE100*DO100*$DQ100+DW100*DF100)))",
    "EK100": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO245,CE100)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT100,\n  DamageMastery, $CS100,\n  DemonMastery, $CX100,\n  SPB, $CU100,\n  ITO, INDEX($BO$5:$BO245,CE100+1),\n  Shock, $CW100,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE100*DO100*$DQ100+DW100*DF100)))",
    "EL100": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP245,CF100)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100, $DB100), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP100),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF100),\n  CL, $DS100,\n  SM, $DT100,\n  SLM, $DU100,\n  SL, $DQ100,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM100, UltCritCard),\nCY100*(DE100*DO100*SL+UwDamage*DF100)))",
    "EM100": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ245,CG100)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG100+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN100": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR245,CH100)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100, $DB100), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH100+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP100),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK100),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM245,CC100), SMHeat, $AR$29), 0),\n\n  DW, $DR100,\n  CL, $DS100,\n  SL, $DQ100,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM100, UltCritCard),\nCY100*(DE100*DO100*SL+UwDamage*DF100)))",
    "EO100": "IF(OR(CI100 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI100+1))",
    "EP100": "IF(OR($AO$25, CJ100 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ100+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE244,BU100),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL100, 1),\n  DPM, (1+$DI100*CardRangeMastery*$DJ100*$AQ$9),\n  SuperTower, $DL100,\n  Rend, $DN100,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100, $DB100), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR100,\n  SM, $DT100,\n  SLM, $DU100,\n  SL, $DQ100,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM100, UltCritCard),\n\nCY100*(DE100*OtherDamage*SL+UwDamage*DF100)))",
    "EQ100": "IF(OR(CK100 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK100+1)*1%, 1),\n  CF, $DB100,\n  CC, MIN(100%, $CZ100 + 1%),\n  CCUW, DA100 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ245,BZ100) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC100 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR100,\n  CL, $DS100,\n  SM, $DT100,\n  SLM, $DU100,\n  SL, $DQ100,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM100, UltCritCard),\n\nCY100 * (Critical*DO100*SL+UwDamage*UWCritical)))",
    "ER100": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL100 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH245,BX100),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL100+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI100*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM245,CC100), $DV100, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH100,\n  Rapid, DG100,\n  SuperTower, $DL100,\n  Rend, $DN100,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM100,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100, $DB100), 1),\n\n  DW, $DR100,\n  CL, $DS100,\n  SM, $DT100,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY100*(DE100*OtherDamage*SL+UWDamage*DF100)))",
    "ES100": "IF(OR(CM100 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH100,\n  Rapid, DG100,\n  RDPM, (1+$DI100*$DJ100*$AQ$9),\n  Rend, $DN100,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK245,CA100),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM100+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100, $DB100), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR100,\n  CL, $DS100,\n  SM, $DT100,\n  SLM, $DU100,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY100*(DE100*OtherDamage*SL+UwDamage*DF100)))",
    "ET100": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN100 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM100,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN100+1, $DB100), 1),\n\n  DW, $DR100,\n  CL, $DS100,\n  SM, $DT100,\n  SLM, $DU100,\n  SL, $DQ100,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY100*(DE100*DO100*SL+UWDamage*DF100)))",
    "EU100": "IF(OR(NOT($BA$3), NOT($BA$23), $CO100 > $BA$15), \"\", 1 + 0.5*(CO100+1))",
    "EW100": "IF(DZ100=\"\", \"\", LET(\n  Now, CT100,\n  Next, DZ100,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT100),\nFactor/Cost))",
    "EX100": "IF(EA100=\"\",\"\",(EA100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU100))",
    "EY100": "IF(EB100=\"\",\"\",(EB100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV100))",
    "EZ100": "IF(EC100=\"\",\"\",(EC100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW100))",
    "FA100": "IF(ED100=\"\",\"\",(ED100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX100))",
    "FB100": "IF(EE100=\"\",\"\",(EE100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY100))",
    "FC100": "IF(EF100=\"\",\"\",(EF100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ100))",
    "FD100": "IF(EG100=\"\",\"\",(EG100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA100))",
    "FE100": "IF(EH100=\"\",\"\",(EH100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB100))",
    "FF100": "IF(EI100=\"\",\"\",(EI100/$DX100-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC100+1, 1, CC100))))",
    "FG100": "IF(EJ100=\"\",\"\",(EJ100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD100))",
    "FH100": "IF(EK100=\"\",\"\",(EK100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE100))",
    "FI100": "IF(EL100=\"\",\"\",(EL100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF100))",
    "FJ100": "IF(EM100=\"\", \"\", LET(\n  Now, CW100,\n  Next, EM100,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG100),\nFactor/Cost))",
    "FK100": "IF(EN100=\"\",\"\",(EN100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH100))",
    "FL100": "IF(EO100=\"\", \"\", LET(\n  Now, CS100,\n  Next, EO100,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI100),\nFactor/Cost))",
    "FM100": "IF(EP100=\"\",\"\",(EP100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ100))",
    "FN100": "IF(EQ100=\"\",\"\",(EQ100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK100))",
    "FO100": "IF(ER100=\"\",\"\",(ER100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL100))",
    "FP100": "IF(ES100=\"\",\"\",(ES100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM100))",
    "FQ100": "IF(ET100=\"\",\"\",(ET100/$DX100-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN100))",
    "FR100": "IF(EU100=\"\", \"\", LET(\n  Now, CX100,\n  Next, EU100,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO100),\nFactor/Cost))",
    "FT100": "IF(COLUMN(EW100:FR100) = MIN(IF(EW100:FR100=MAX(EW100:FR100), COLUMN(EW100:FR100))), 1, \"\")",
    "D101": "IF(SUM(FT100:GP100),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F101)),\"Card Mastery\",F101),G101)/$D$5,\"\")",
    "F101": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT100:GP100),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT100:GP100=1)),)\"),\"Damage\")",
    "G101": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT100:GP100),ARRAYFORMULA(FILTER(BT100:CP100 , FT100:GP100=1)),\"\"\"\")\"),23.0)",
    "I101": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT100:GP100),ARRAYFORMULA(FILTER(EW100:FS100 , FT100:GP100=1))*D$5,\"\"\"\")\"),0.009737098344693246)",
    "K101": "IF(H101<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D101)),)",
    "BC101": "BC100+1",
    "BD101": "BD100+BD$3",
    "BE101": "BE100+BE$3",
    "BF101": "BF100+BF$3",
    "BH101": "BH100+BH$3",
    "BT101": "BT100+FT100",
    "BU101": "BU100+FU100",
    "BV101": "BV100+FV100",
    "BW101": "BW100+FW100",
    "BX101": "BX100+FX100",
    "BY101": "BY100+FY100",
    "BZ101": "BZ100+FZ100",
    "CA101": "CA100+GA100",
    "CB101": "CB100+GB100",
    "CC101": "CC100+GC100",
    "CD101": "CD100+GD100",
    "CE101": "CE100+GE100",
    "CF101": "CF100+GF100",
    "CG101": "CG100+GG100",
    "CH101": "CH100+GH100",
    "CI101": "CI100+GI100",
    "CJ101": "CJ100+GJ100",
    "CK101": "CK100+GK100",
    "CL101": "CL100+GL100",
    "CM101": "CM100+GM100",
    "CN101": "CN100+GN100",
    "CO101": "CO100+GO100",
    "CS101": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI101,1)",
    "CT101": "INDEX($BD$5:$BD246,BT101)",
    "CU101": "INDEX($BN$5:$BN246,CD101)",
    "CV101": "INDEX($BO$5:$BO246,CE101)",
    "CW101": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG101)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX101": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO101, 1)",
    "CY101": "LET(\n  Base, $CR$6,\n  Damage, $CT101,\n  DamageMastery, $CS101,\n  DemonMastery, $CX101,\n  SPB, $CU101,\n  ITO, $CV101,\n  Shock, $CW101,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ101": "MIN(100%, DA101)",
    "DA101": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK101*1%, 0)",
    "DB101": "LET(\n  Lab, 1+INDEX($BF$5:$BF246,BV101),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC101": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK101*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI246,BY101) + CardCritMastery)",
    "DD101": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK101*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ246,BZ101) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE101": "LET(\n  CF, $DB101,\n  CC, $CZ101,\n  SCM, $DD101,\n  SCC, $DC101,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF101": "LET(\n  CF, $DB101,\n  CC, $DA101,\n  SCM, $DD101,\n  SCC, $DC101,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG101": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH101)), 0)",
    "DH101": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ101*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE246,BU101),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI101": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG246, BW101), 1) + $AE$9)",
    "DJ101": "LET(\n  DpmLab, INDEX($BH$5:$BH246,BX101),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL101, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK101": "(1+$DI101*$DJ101*$AQ$9)",
    "DL101": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK246,CA101),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM101*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM101": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK246,CA101),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM101*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN101": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL246,CB101)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO101": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH101,\n  Rapid, DG101,\n  RDPM, DK101,\n  SuperTower, $DL101,\n  Rend, $DN101,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP101": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ101": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK101),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR101": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP101),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF101-1))",
    "DS101": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG101, DH101),0))",
    "DT101": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP101),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV101, $AR$29), 0))",
    "DU101": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK101),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM246,CC101), $DV101, $AR$29), 0))",
    "DV101": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH101), $AO$29)",
    "DW101": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM101,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101, $DB101), 1),\n\n  DW, $DR101,\n  CL, $DS101,\n  SM, $DT101,\n  SLM, $DU101,\n  SL, $DQ101,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX101": "CY101*(DE101*DO101*DQ101+DW101*DF101)",
    "DZ101": "IF(INDEX($BD$6:$BD246,BT101)=\"\", \"\", INDEX($BD$5:$BD246,BT101+1))",
    "EA101": "IF(OR($AO$25, INDEX($BE$6:$BE246,BU101)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ101)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE246,BU101+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI101*$DJ101*$AQ$9),\n  SuperTower, $DL101,\n  Rend, $DN101,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101, $DB101), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR101,\n  SM, $DT101,\n  SLM, $DU101,\n  SL, $DQ101,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM101, UltCritCard),\n\nCY101*(DE101*OtherDamage*SL+UwDamage*DF101)))",
    "EB101": "IF(INDEX($BF$6:$BF246,BV101)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF246,BV101+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ101,\n  CCUW, $DA101,\n  SCM, $DD101,\n  SCC, $DC101,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101, CF), 1),\n\n  DW, $DR101,\n  CL, $DS101,\n  SM, $DT101,\n  SLM, $DU101,\n  SL, $DQ101,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM101, UltCritCard),\n\nCY101 * (Critical * DO101 * SL + UwDamage * UWCritical)))",
    "EC101": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG246,BW101)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH101,\n  Rapid, DG101,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG246, BW101+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ101*$AQ$9),\n  SuperTower, $DL101,\n  Rend, $DN101,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM246,CC101), $DV101, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM101,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101, $DB101), 1),\n\n  DW, $DR101,\n  CL, $DS101,\n  SM, $DT101,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY101*(DE101*OtherDamage*SL+UWDamage*DF101)))",
    "ED101": "IF(OR($AO$25, INDEX($BH$6:$BH246,BX101)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH246,BX101+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL101, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI101*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM246,CC101), $DV101, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH101,\n  Rapid, DG101,\n  SuperTower, $DL101,\n  Rend, $DN101,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM101,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101, $DB101), 1),\n\n  DW, $DR101,\n  CL, $DS101,\n  SM, $DT101,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY101*(DE101*OtherDamage*SL+UWDamage*DF101)))",
    "EE101": "IF(INDEX($BI$6:$BI246,BY101)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK101, 0),\n  CF, $DB101,\n  CC, $CZ101,\n  CCUW, $DA101,\n  SCM, $DD101,\n  SCC, $AV$17+INDEX($BI$5:$BI246,BY101+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY101 * (Critical*DO101*$DQ101+DW101*UWCritical)))",
    "EF101": "IF(INDEX($BJ$6:$BJ246,BZ101)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK101*1%, 1),\n  CF, $DB101,\n  CC, $CZ101,\n  CCUW, $DA101,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ246,BZ101+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC101,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY101*(Critical*DO101*$DQ101+DW101*UWCritical)))",
    "EG101": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK246,CA101)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH101,\n  Rapid, DG101,\n  DPM, (1+$DI101*$DJ101*$AQ$9),\n  Rend, $DN101,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK246,CA101+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM101*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101, $DB101), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK246,CA101+1)-1))/(45-CM101*3),1),\n\n  SL, $DQ101,\n  DW, $DR101,\n  CL, $DS101,\n  SM, $DT101,\n  SLM, $DU101,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY101*(DE101*OtherDamage*SL+UwDamage*DF101)))",
    "EH101": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL246,CB101+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL246,CB101)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH101,\n  Rapid, DG101,\n  DPM, (1+$DI101*$DJ101*$AQ$9),\n  SuperTower, $DL101,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL246,CB101+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY101*(DE101*OtherDamage*$DQ101+DW101*DF101)))",
    "EI101": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM246,CC101)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101, $DB101), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK101),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV101, $AR$29), 0),\n\n  DW, $DR101,\n  CL, $DS101,\n  SM, $DT101,\n  SL, $DQ101,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM101, UltCritCard),\nCY101*(DE101*DO101*SL+UwDamage*DF101)))",
    "EJ101": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN246,CD101)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT101,\n  DamageMastery, $CS101,\n  DemonMastery, $CX101,\n  SPB, INDEX($BN$5:$BN246,CD101+1),\n  ITO, $CV101,\n  Shock, $CW101,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE101*DO101*$DQ101+DW101*DF101)))",
    "EK101": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO246,CE101)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT101,\n  DamageMastery, $CS101,\n  DemonMastery, $CX101,\n  SPB, $CU101,\n  ITO, INDEX($BO$5:$BO246,CE101+1),\n  Shock, $CW101,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE101*DO101*$DQ101+DW101*DF101)))",
    "EL101": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP246,CF101)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101, $DB101), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP101),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF101),\n  CL, $DS101,\n  SM, $DT101,\n  SLM, $DU101,\n  SL, $DQ101,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM101, UltCritCard),\nCY101*(DE101*DO101*SL+UwDamage*DF101)))",
    "EM101": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ246,CG101)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG101+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN101": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR246,CH101)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101, $DB101), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH101+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP101),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK101),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM246,CC101), SMHeat, $AR$29), 0),\n\n  DW, $DR101,\n  CL, $DS101,\n  SL, $DQ101,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM101, UltCritCard),\nCY101*(DE101*DO101*SL+UwDamage*DF101)))",
    "EO101": "IF(OR(CI101 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI101+1))",
    "EP101": "IF(OR($AO$25, CJ101 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ101+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE245,BU101),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL101, 1),\n  DPM, (1+$DI101*CardRangeMastery*$DJ101*$AQ$9),\n  SuperTower, $DL101,\n  Rend, $DN101,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101, $DB101), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR101,\n  SM, $DT101,\n  SLM, $DU101,\n  SL, $DQ101,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM101, UltCritCard),\n\nCY101*(DE101*OtherDamage*SL+UwDamage*DF101)))",
    "EQ101": "IF(OR(CK101 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK101+1)*1%, 1),\n  CF, $DB101,\n  CC, MIN(100%, $CZ101 + 1%),\n  CCUW, DA101 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ246,BZ101) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC101 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR101,\n  CL, $DS101,\n  SM, $DT101,\n  SLM, $DU101,\n  SL, $DQ101,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM101, UltCritCard),\n\nCY101 * (Critical*DO101*SL+UwDamage*UWCritical)))",
    "ER101": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL101 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH246,BX101),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL101+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI101*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM246,CC101), $DV101, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH101,\n  Rapid, DG101,\n  SuperTower, $DL101,\n  Rend, $DN101,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM101,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101, $DB101), 1),\n\n  DW, $DR101,\n  CL, $DS101,\n  SM, $DT101,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY101*(DE101*OtherDamage*SL+UWDamage*DF101)))",
    "ES101": "IF(OR(CM101 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH101,\n  Rapid, DG101,\n  RDPM, (1+$DI101*$DJ101*$AQ$9),\n  Rend, $DN101,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK246,CA101),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM101+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101, $DB101), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR101,\n  CL, $DS101,\n  SM, $DT101,\n  SLM, $DU101,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY101*(DE101*OtherDamage*SL+UwDamage*DF101)))",
    "ET101": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN101 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM101,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN101+1, $DB101), 1),\n\n  DW, $DR101,\n  CL, $DS101,\n  SM, $DT101,\n  SLM, $DU101,\n  SL, $DQ101,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY101*(DE101*DO101*SL+UWDamage*DF101)))",
    "EU101": "IF(OR(NOT($BA$3), NOT($BA$23), $CO101 > $BA$15), \"\", 1 + 0.5*(CO101+1))",
    "EW101": "IF(DZ101=\"\", \"\", LET(\n  Now, CT101,\n  Next, DZ101,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT101),\nFactor/Cost))",
    "EX101": "IF(EA101=\"\",\"\",(EA101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU101))",
    "EY101": "IF(EB101=\"\",\"\",(EB101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV101))",
    "EZ101": "IF(EC101=\"\",\"\",(EC101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW101))",
    "FA101": "IF(ED101=\"\",\"\",(ED101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX101))",
    "FB101": "IF(EE101=\"\",\"\",(EE101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY101))",
    "FC101": "IF(EF101=\"\",\"\",(EF101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ101))",
    "FD101": "IF(EG101=\"\",\"\",(EG101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA101))",
    "FE101": "IF(EH101=\"\",\"\",(EH101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB101))",
    "FF101": "IF(EI101=\"\",\"\",(EI101/$DX101-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC101+1, 1, CC101))))",
    "FG101": "IF(EJ101=\"\",\"\",(EJ101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD101))",
    "FH101": "IF(EK101=\"\",\"\",(EK101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE101))",
    "FI101": "IF(EL101=\"\",\"\",(EL101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF101))",
    "FJ101": "IF(EM101=\"\", \"\", LET(\n  Now, CW101,\n  Next, EM101,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG101),\nFactor/Cost))",
    "FK101": "IF(EN101=\"\",\"\",(EN101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH101))",
    "FL101": "IF(EO101=\"\", \"\", LET(\n  Now, CS101,\n  Next, EO101,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI101),\nFactor/Cost))",
    "FM101": "IF(EP101=\"\",\"\",(EP101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ101))",
    "FN101": "IF(EQ101=\"\",\"\",(EQ101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK101))",
    "FO101": "IF(ER101=\"\",\"\",(ER101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL101))",
    "FP101": "IF(ES101=\"\",\"\",(ES101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM101))",
    "FQ101": "IF(ET101=\"\",\"\",(ET101/$DX101-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN101))",
    "FR101": "IF(EU101=\"\", \"\", LET(\n  Now, CX101,\n  Next, EU101,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO101),\nFactor/Cost))",
    "FT101": "IF(COLUMN(EW101:FR101) = MIN(IF(EW101:FR101=MAX(EW101:FR101), COLUMN(EW101:FR101))), 1, \"\")",
    "D102": "IF(SUM(FT101:GP101),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F102)),\"Card Mastery\",F102),G102)/$D$5,\"\")",
    "F102": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT101:GP101),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT101:GP101=1)),)\"),\"Attack Speed\")",
    "G102": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT101:GP101),ARRAYFORMULA(FILTER(BT101:CP101 , FT101:GP101=1)),\"\"\"\")\"),23.0)",
    "I102": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT101:GP101),ARRAYFORMULA(FILTER(EW101:FS101 , FT101:GP101=1))*D$5,\"\"\"\")\"),0.009608724678823375)",
    "K102": "IF(H102<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D102)),)",
    "BC102": "BC101+1",
    "BD102": "BD101+BD$3",
    "BE102": "BE101+BE$3",
    "BF102": "BF101+BF$3",
    "BH102": "BH101+BH$3",
    "BT102": "BT101+FT101",
    "BU102": "BU101+FU101",
    "BV102": "BV101+FV101",
    "BW102": "BW101+FW101",
    "BX102": "BX101+FX101",
    "BY102": "BY101+FY101",
    "BZ102": "BZ101+FZ101",
    "CA102": "CA101+GA101",
    "CB102": "CB101+GB101",
    "CC102": "CC101+GC101",
    "CD102": "CD101+GD101",
    "CE102": "CE101+GE101",
    "CF102": "CF101+GF101",
    "CG102": "CG101+GG101",
    "CH102": "CH101+GH101",
    "CI102": "CI101+GI101",
    "CJ102": "CJ101+GJ101",
    "CK102": "CK101+GK101",
    "CL102": "CL101+GL101",
    "CM102": "CM101+GM101",
    "CN102": "CN101+GN101",
    "CO102": "CO101+GO101",
    "CS102": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI102,1)",
    "CT102": "INDEX($BD$5:$BD247,BT102)",
    "CU102": "INDEX($BN$5:$BN247,CD102)",
    "CV102": "INDEX($BO$5:$BO247,CE102)",
    "CW102": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG102)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX102": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO102, 1)",
    "CY102": "LET(\n  Base, $CR$6,\n  Damage, $CT102,\n  DamageMastery, $CS102,\n  DemonMastery, $CX102,\n  SPB, $CU102,\n  ITO, $CV102,\n  Shock, $CW102,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ102": "MIN(100%, DA102)",
    "DA102": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK102*1%, 0)",
    "DB102": "LET(\n  Lab, 1+INDEX($BF$5:$BF247,BV102),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC102": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK102*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI247,BY102) + CardCritMastery)",
    "DD102": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK102*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ247,BZ102) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE102": "LET(\n  CF, $DB102,\n  CC, $CZ102,\n  SCM, $DD102,\n  SCC, $DC102,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF102": "LET(\n  CF, $DB102,\n  CC, $DA102,\n  SCM, $DD102,\n  SCC, $DC102,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG102": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH102)), 0)",
    "DH102": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ102*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE247,BU102),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI102": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG247, BW102), 1) + $AE$9)",
    "DJ102": "LET(\n  DpmLab, INDEX($BH$5:$BH247,BX102),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL102, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK102": "(1+$DI102*$DJ102*$AQ$9)",
    "DL102": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK247,CA102),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM102*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM102": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK247,CA102),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM102*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN102": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL247,CB102)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO102": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH102,\n  Rapid, DG102,\n  RDPM, DK102,\n  SuperTower, $DL102,\n  Rend, $DN102,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP102": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ102": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK102),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR102": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP102),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF102-1))",
    "DS102": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG102, DH102),0))",
    "DT102": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP102),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV102, $AR$29), 0))",
    "DU102": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK102),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM247,CC102), $DV102, $AR$29), 0))",
    "DV102": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH102), $AO$29)",
    "DW102": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM102,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102, $DB102), 1),\n\n  DW, $DR102,\n  CL, $DS102,\n  SM, $DT102,\n  SLM, $DU102,\n  SL, $DQ102,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX102": "CY102*(DE102*DO102*DQ102+DW102*DF102)",
    "DZ102": "IF(INDEX($BD$6:$BD247,BT102)=\"\", \"\", INDEX($BD$5:$BD247,BT102+1))",
    "EA102": "IF(OR($AO$25, INDEX($BE$6:$BE247,BU102)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ102)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE247,BU102+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI102*$DJ102*$AQ$9),\n  SuperTower, $DL102,\n  Rend, $DN102,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102, $DB102), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR102,\n  SM, $DT102,\n  SLM, $DU102,\n  SL, $DQ102,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM102, UltCritCard),\n\nCY102*(DE102*OtherDamage*SL+UwDamage*DF102)))",
    "EB102": "IF(INDEX($BF$6:$BF247,BV102)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF247,BV102+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ102,\n  CCUW, $DA102,\n  SCM, $DD102,\n  SCC, $DC102,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102, CF), 1),\n\n  DW, $DR102,\n  CL, $DS102,\n  SM, $DT102,\n  SLM, $DU102,\n  SL, $DQ102,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM102, UltCritCard),\n\nCY102 * (Critical * DO102 * SL + UwDamage * UWCritical)))",
    "EC102": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG247,BW102)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH102,\n  Rapid, DG102,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG247, BW102+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ102*$AQ$9),\n  SuperTower, $DL102,\n  Rend, $DN102,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM247,CC102), $DV102, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM102,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102, $DB102), 1),\n\n  DW, $DR102,\n  CL, $DS102,\n  SM, $DT102,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY102*(DE102*OtherDamage*SL+UWDamage*DF102)))",
    "ED102": "IF(OR($AO$25, INDEX($BH$6:$BH247,BX102)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH247,BX102+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL102, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI102*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM247,CC102), $DV102, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH102,\n  Rapid, DG102,\n  SuperTower, $DL102,\n  Rend, $DN102,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM102,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102, $DB102), 1),\n\n  DW, $DR102,\n  CL, $DS102,\n  SM, $DT102,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY102*(DE102*OtherDamage*SL+UWDamage*DF102)))",
    "EE102": "IF(INDEX($BI$6:$BI247,BY102)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK102, 0),\n  CF, $DB102,\n  CC, $CZ102,\n  CCUW, $DA102,\n  SCM, $DD102,\n  SCC, $AV$17+INDEX($BI$5:$BI247,BY102+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY102 * (Critical*DO102*$DQ102+DW102*UWCritical)))",
    "EF102": "IF(INDEX($BJ$6:$BJ247,BZ102)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK102*1%, 1),\n  CF, $DB102,\n  CC, $CZ102,\n  CCUW, $DA102,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ247,BZ102+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC102,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY102*(Critical*DO102*$DQ102+DW102*UWCritical)))",
    "EG102": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK247,CA102)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH102,\n  Rapid, DG102,\n  DPM, (1+$DI102*$DJ102*$AQ$9),\n  Rend, $DN102,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK247,CA102+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM102*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102, $DB102), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK247,CA102+1)-1))/(45-CM102*3),1),\n\n  SL, $DQ102,\n  DW, $DR102,\n  CL, $DS102,\n  SM, $DT102,\n  SLM, $DU102,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY102*(DE102*OtherDamage*SL+UwDamage*DF102)))",
    "EH102": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL247,CB102+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL247,CB102)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH102,\n  Rapid, DG102,\n  DPM, (1+$DI102*$DJ102*$AQ$9),\n  SuperTower, $DL102,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL247,CB102+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY102*(DE102*OtherDamage*$DQ102+DW102*DF102)))",
    "EI102": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM247,CC102)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102, $DB102), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK102),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV102, $AR$29), 0),\n\n  DW, $DR102,\n  CL, $DS102,\n  SM, $DT102,\n  SL, $DQ102,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM102, UltCritCard),\nCY102*(DE102*DO102*SL+UwDamage*DF102)))",
    "EJ102": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN247,CD102)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT102,\n  DamageMastery, $CS102,\n  DemonMastery, $CX102,\n  SPB, INDEX($BN$5:$BN247,CD102+1),\n  ITO, $CV102,\n  Shock, $CW102,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE102*DO102*$DQ102+DW102*DF102)))",
    "EK102": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO247,CE102)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT102,\n  DamageMastery, $CS102,\n  DemonMastery, $CX102,\n  SPB, $CU102,\n  ITO, INDEX($BO$5:$BO247,CE102+1),\n  Shock, $CW102,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE102*DO102*$DQ102+DW102*DF102)))",
    "EL102": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP247,CF102)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102, $DB102), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP102),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF102),\n  CL, $DS102,\n  SM, $DT102,\n  SLM, $DU102,\n  SL, $DQ102,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM102, UltCritCard),\nCY102*(DE102*DO102*SL+UwDamage*DF102)))",
    "EM102": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ247,CG102)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG102+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN102": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR247,CH102)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102, $DB102), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH102+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP102),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK102),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM247,CC102), SMHeat, $AR$29), 0),\n\n  DW, $DR102,\n  CL, $DS102,\n  SL, $DQ102,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM102, UltCritCard),\nCY102*(DE102*DO102*SL+UwDamage*DF102)))",
    "EO102": "IF(OR(CI102 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI102+1))",
    "EP102": "IF(OR($AO$25, CJ102 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ102+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE246,BU102),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL102, 1),\n  DPM, (1+$DI102*CardRangeMastery*$DJ102*$AQ$9),\n  SuperTower, $DL102,\n  Rend, $DN102,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102, $DB102), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR102,\n  SM, $DT102,\n  SLM, $DU102,\n  SL, $DQ102,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM102, UltCritCard),\n\nCY102*(DE102*OtherDamage*SL+UwDamage*DF102)))",
    "EQ102": "IF(OR(CK102 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK102+1)*1%, 1),\n  CF, $DB102,\n  CC, MIN(100%, $CZ102 + 1%),\n  CCUW, DA102 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ247,BZ102) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC102 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR102,\n  CL, $DS102,\n  SM, $DT102,\n  SLM, $DU102,\n  SL, $DQ102,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM102, UltCritCard),\n\nCY102 * (Critical*DO102*SL+UwDamage*UWCritical)))",
    "ER102": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL102 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH247,BX102),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL102+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI102*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM247,CC102), $DV102, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH102,\n  Rapid, DG102,\n  SuperTower, $DL102,\n  Rend, $DN102,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM102,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102, $DB102), 1),\n\n  DW, $DR102,\n  CL, $DS102,\n  SM, $DT102,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY102*(DE102*OtherDamage*SL+UWDamage*DF102)))",
    "ES102": "IF(OR(CM102 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH102,\n  Rapid, DG102,\n  RDPM, (1+$DI102*$DJ102*$AQ$9),\n  Rend, $DN102,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK247,CA102),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM102+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102, $DB102), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR102,\n  CL, $DS102,\n  SM, $DT102,\n  SLM, $DU102,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY102*(DE102*OtherDamage*SL+UwDamage*DF102)))",
    "ET102": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN102 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM102,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN102+1, $DB102), 1),\n\n  DW, $DR102,\n  CL, $DS102,\n  SM, $DT102,\n  SLM, $DU102,\n  SL, $DQ102,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY102*(DE102*DO102*SL+UWDamage*DF102)))",
    "EU102": "IF(OR(NOT($BA$3), NOT($BA$23), $CO102 > $BA$15), \"\", 1 + 0.5*(CO102+1))",
    "EW102": "IF(DZ102=\"\", \"\", LET(\n  Now, CT102,\n  Next, DZ102,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT102),\nFactor/Cost))",
    "EX102": "IF(EA102=\"\",\"\",(EA102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU102))",
    "EY102": "IF(EB102=\"\",\"\",(EB102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV102))",
    "EZ102": "IF(EC102=\"\",\"\",(EC102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW102))",
    "FA102": "IF(ED102=\"\",\"\",(ED102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX102))",
    "FB102": "IF(EE102=\"\",\"\",(EE102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY102))",
    "FC102": "IF(EF102=\"\",\"\",(EF102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ102))",
    "FD102": "IF(EG102=\"\",\"\",(EG102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA102))",
    "FE102": "IF(EH102=\"\",\"\",(EH102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB102))",
    "FF102": "IF(EI102=\"\",\"\",(EI102/$DX102-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC102+1, 1, CC102))))",
    "FG102": "IF(EJ102=\"\",\"\",(EJ102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD102))",
    "FH102": "IF(EK102=\"\",\"\",(EK102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE102))",
    "FI102": "IF(EL102=\"\",\"\",(EL102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF102))",
    "FJ102": "IF(EM102=\"\", \"\", LET(\n  Now, CW102,\n  Next, EM102,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG102),\nFactor/Cost))",
    "FK102": "IF(EN102=\"\",\"\",(EN102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH102))",
    "FL102": "IF(EO102=\"\", \"\", LET(\n  Now, CS102,\n  Next, EO102,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI102),\nFactor/Cost))",
    "FM102": "IF(EP102=\"\",\"\",(EP102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ102))",
    "FN102": "IF(EQ102=\"\",\"\",(EQ102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK102))",
    "FO102": "IF(ER102=\"\",\"\",(ER102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL102))",
    "FP102": "IF(ES102=\"\",\"\",(ES102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM102))",
    "FQ102": "IF(ET102=\"\",\"\",(ET102/$DX102-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN102))",
    "FR102": "IF(EU102=\"\", \"\", LET(\n  Now, CX102,\n  Next, EU102,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO102),\nFactor/Cost))",
    "FT102": "IF(COLUMN(EW102:FR102) = MIN(IF(EW102:FR102=MAX(EW102:FR102), COLUMN(EW102:FR102))), 1, \"\")",
    "D103": "IF(SUM(FT102:GP102),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F103)),\"Card Mastery\",F103),G103)/$D$5,\"\")",
    "F103": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT102:GP102),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT102:GP102=1)),)\"),\"Improve Trade-off Perks\")",
    "G103": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT102:GP102),ARRAYFORMULA(FILTER(BT102:CP102 , FT102:GP102=1)),\"\"\"\")\"),1.0)",
    "I103": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT102:GP102),ARRAYFORMULA(FILTER(EW102:FS102 , FT102:GP102=1))*D$5,\"\"\"\")\"),0.009606404269513017)",
    "K103": "IF(H103<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D103)),)",
    "BC103": "BC102+1",
    "BD103": "BD102+BD$3",
    "BE103": "BE102+BE$3",
    "BF103": "BF102+BF$3",
    "BH103": "BH102+BH$3",
    "BT103": "BT102+FT102",
    "BU103": "BU102+FU102",
    "BV103": "BV102+FV102",
    "BW103": "BW102+FW102",
    "BX103": "BX102+FX102",
    "BY103": "BY102+FY102",
    "BZ103": "BZ102+FZ102",
    "CA103": "CA102+GA102",
    "CB103": "CB102+GB102",
    "CC103": "CC102+GC102",
    "CD103": "CD102+GD102",
    "CE103": "CE102+GE102",
    "CF103": "CF102+GF102",
    "CG103": "CG102+GG102",
    "CH103": "CH102+GH102",
    "CI103": "CI102+GI102",
    "CJ103": "CJ102+GJ102",
    "CK103": "CK102+GK102",
    "CL103": "CL102+GL102",
    "CM103": "CM102+GM102",
    "CN103": "CN102+GN102",
    "CO103": "CO102+GO102",
    "CS103": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI103,1)",
    "CT103": "INDEX($BD$5:$BD248,BT103)",
    "CU103": "INDEX($BN$5:$BN248,CD103)",
    "CV103": "INDEX($BO$5:$BO248,CE103)",
    "CW103": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG103)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX103": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO103, 1)",
    "CY103": "LET(\n  Base, $CR$6,\n  Damage, $CT103,\n  DamageMastery, $CS103,\n  DemonMastery, $CX103,\n  SPB, $CU103,\n  ITO, $CV103,\n  Shock, $CW103,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ103": "MIN(100%, DA103)",
    "DA103": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK103*1%, 0)",
    "DB103": "LET(\n  Lab, 1+INDEX($BF$5:$BF248,BV103),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC103": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK103*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI248,BY103) + CardCritMastery)",
    "DD103": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK103*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ248,BZ103) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE103": "LET(\n  CF, $DB103,\n  CC, $CZ103,\n  SCM, $DD103,\n  SCC, $DC103,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF103": "LET(\n  CF, $DB103,\n  CC, $DA103,\n  SCM, $DD103,\n  SCC, $DC103,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG103": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH103)), 0)",
    "DH103": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ103*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE248,BU103),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI103": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG248, BW103), 1) + $AE$9)",
    "DJ103": "LET(\n  DpmLab, INDEX($BH$5:$BH248,BX103),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL103, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK103": "(1+$DI103*$DJ103*$AQ$9)",
    "DL103": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK248,CA103),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM103*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM103": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK248,CA103),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM103*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN103": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL248,CB103)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO103": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH103,\n  Rapid, DG103,\n  RDPM, DK103,\n  SuperTower, $DL103,\n  Rend, $DN103,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP103": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ103": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK103),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR103": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP103),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF103-1))",
    "DS103": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG103, DH103),0))",
    "DT103": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP103),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV103, $AR$29), 0))",
    "DU103": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK103),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM248,CC103), $DV103, $AR$29), 0))",
    "DV103": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH103), $AO$29)",
    "DW103": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM103,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103, $DB103), 1),\n\n  DW, $DR103,\n  CL, $DS103,\n  SM, $DT103,\n  SLM, $DU103,\n  SL, $DQ103,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX103": "CY103*(DE103*DO103*DQ103+DW103*DF103)",
    "DZ103": "IF(INDEX($BD$6:$BD248,BT103)=\"\", \"\", INDEX($BD$5:$BD248,BT103+1))",
    "EA103": "IF(OR($AO$25, INDEX($BE$6:$BE248,BU103)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ103)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE248,BU103+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI103*$DJ103*$AQ$9),\n  SuperTower, $DL103,\n  Rend, $DN103,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103, $DB103), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR103,\n  SM, $DT103,\n  SLM, $DU103,\n  SL, $DQ103,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM103, UltCritCard),\n\nCY103*(DE103*OtherDamage*SL+UwDamage*DF103)))",
    "EB103": "IF(INDEX($BF$6:$BF248,BV103)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF248,BV103+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ103,\n  CCUW, $DA103,\n  SCM, $DD103,\n  SCC, $DC103,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103, CF), 1),\n\n  DW, $DR103,\n  CL, $DS103,\n  SM, $DT103,\n  SLM, $DU103,\n  SL, $DQ103,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM103, UltCritCard),\n\nCY103 * (Critical * DO103 * SL + UwDamage * UWCritical)))",
    "EC103": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG248,BW103)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH103,\n  Rapid, DG103,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG248, BW103+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ103*$AQ$9),\n  SuperTower, $DL103,\n  Rend, $DN103,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM248,CC103), $DV103, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM103,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103, $DB103), 1),\n\n  DW, $DR103,\n  CL, $DS103,\n  SM, $DT103,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY103*(DE103*OtherDamage*SL+UWDamage*DF103)))",
    "ED103": "IF(OR($AO$25, INDEX($BH$6:$BH248,BX103)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH248,BX103+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL103, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI103*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM248,CC103), $DV103, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH103,\n  Rapid, DG103,\n  SuperTower, $DL103,\n  Rend, $DN103,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM103,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103, $DB103), 1),\n\n  DW, $DR103,\n  CL, $DS103,\n  SM, $DT103,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY103*(DE103*OtherDamage*SL+UWDamage*DF103)))",
    "EE103": "IF(INDEX($BI$6:$BI248,BY103)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK103, 0),\n  CF, $DB103,\n  CC, $CZ103,\n  CCUW, $DA103,\n  SCM, $DD103,\n  SCC, $AV$17+INDEX($BI$5:$BI248,BY103+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY103 * (Critical*DO103*$DQ103+DW103*UWCritical)))",
    "EF103": "IF(INDEX($BJ$6:$BJ248,BZ103)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK103*1%, 1),\n  CF, $DB103,\n  CC, $CZ103,\n  CCUW, $DA103,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ248,BZ103+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC103,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY103*(Critical*DO103*$DQ103+DW103*UWCritical)))",
    "EG103": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK248,CA103)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH103,\n  Rapid, DG103,\n  DPM, (1+$DI103*$DJ103*$AQ$9),\n  Rend, $DN103,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK248,CA103+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM103*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103, $DB103), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK248,CA103+1)-1))/(45-CM103*3),1),\n\n  SL, $DQ103,\n  DW, $DR103,\n  CL, $DS103,\n  SM, $DT103,\n  SLM, $DU103,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY103*(DE103*OtherDamage*SL+UwDamage*DF103)))",
    "EH103": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL248,CB103+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL248,CB103)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH103,\n  Rapid, DG103,\n  DPM, (1+$DI103*$DJ103*$AQ$9),\n  SuperTower, $DL103,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL248,CB103+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY103*(DE103*OtherDamage*$DQ103+DW103*DF103)))",
    "EI103": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM248,CC103)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103, $DB103), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK103),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV103, $AR$29), 0),\n\n  DW, $DR103,\n  CL, $DS103,\n  SM, $DT103,\n  SL, $DQ103,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM103, UltCritCard),\nCY103*(DE103*DO103*SL+UwDamage*DF103)))",
    "EJ103": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN248,CD103)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT103,\n  DamageMastery, $CS103,\n  DemonMastery, $CX103,\n  SPB, INDEX($BN$5:$BN248,CD103+1),\n  ITO, $CV103,\n  Shock, $CW103,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE103*DO103*$DQ103+DW103*DF103)))",
    "EK103": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO248,CE103)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT103,\n  DamageMastery, $CS103,\n  DemonMastery, $CX103,\n  SPB, $CU103,\n  ITO, INDEX($BO$5:$BO248,CE103+1),\n  Shock, $CW103,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE103*DO103*$DQ103+DW103*DF103)))",
    "EL103": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP248,CF103)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103, $DB103), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP103),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF103),\n  CL, $DS103,\n  SM, $DT103,\n  SLM, $DU103,\n  SL, $DQ103,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM103, UltCritCard),\nCY103*(DE103*DO103*SL+UwDamage*DF103)))",
    "EM103": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ248,CG103)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG103+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN103": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR248,CH103)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103, $DB103), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH103+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP103),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK103),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM248,CC103), SMHeat, $AR$29), 0),\n\n  DW, $DR103,\n  CL, $DS103,\n  SL, $DQ103,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM103, UltCritCard),\nCY103*(DE103*DO103*SL+UwDamage*DF103)))",
    "EO103": "IF(OR(CI103 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI103+1))",
    "EP103": "IF(OR($AO$25, CJ103 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ103+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE247,BU103),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL103, 1),\n  DPM, (1+$DI103*CardRangeMastery*$DJ103*$AQ$9),\n  SuperTower, $DL103,\n  Rend, $DN103,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103, $DB103), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR103,\n  SM, $DT103,\n  SLM, $DU103,\n  SL, $DQ103,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM103, UltCritCard),\n\nCY103*(DE103*OtherDamage*SL+UwDamage*DF103)))",
    "EQ103": "IF(OR(CK103 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK103+1)*1%, 1),\n  CF, $DB103,\n  CC, MIN(100%, $CZ103 + 1%),\n  CCUW, DA103 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ248,BZ103) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC103 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR103,\n  CL, $DS103,\n  SM, $DT103,\n  SLM, $DU103,\n  SL, $DQ103,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM103, UltCritCard),\n\nCY103 * (Critical*DO103*SL+UwDamage*UWCritical)))",
    "ER103": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL103 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH248,BX103),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL103+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI103*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM248,CC103), $DV103, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH103,\n  Rapid, DG103,\n  SuperTower, $DL103,\n  Rend, $DN103,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM103,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103, $DB103), 1),\n\n  DW, $DR103,\n  CL, $DS103,\n  SM, $DT103,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY103*(DE103*OtherDamage*SL+UWDamage*DF103)))",
    "ES103": "IF(OR(CM103 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH103,\n  Rapid, DG103,\n  RDPM, (1+$DI103*$DJ103*$AQ$9),\n  Rend, $DN103,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK248,CA103),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM103+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103, $DB103), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR103,\n  CL, $DS103,\n  SM, $DT103,\n  SLM, $DU103,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY103*(DE103*OtherDamage*SL+UwDamage*DF103)))",
    "ET103": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN103 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM103,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN103+1, $DB103), 1),\n\n  DW, $DR103,\n  CL, $DS103,\n  SM, $DT103,\n  SLM, $DU103,\n  SL, $DQ103,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY103*(DE103*DO103*SL+UWDamage*DF103)))",
    "EU103": "IF(OR(NOT($BA$3), NOT($BA$23), $CO103 > $BA$15), \"\", 1 + 0.5*(CO103+1))",
    "EW103": "IF(DZ103=\"\", \"\", LET(\n  Now, CT103,\n  Next, DZ103,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT103),\nFactor/Cost))",
    "EX103": "IF(EA103=\"\",\"\",(EA103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU103))",
    "EY103": "IF(EB103=\"\",\"\",(EB103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV103))",
    "EZ103": "IF(EC103=\"\",\"\",(EC103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW103))",
    "FA103": "IF(ED103=\"\",\"\",(ED103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX103))",
    "FB103": "IF(EE103=\"\",\"\",(EE103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY103))",
    "FC103": "IF(EF103=\"\",\"\",(EF103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ103))",
    "FD103": "IF(EG103=\"\",\"\",(EG103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA103))",
    "FE103": "IF(EH103=\"\",\"\",(EH103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB103))",
    "FF103": "IF(EI103=\"\",\"\",(EI103/$DX103-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC103+1, 1, CC103))))",
    "FG103": "IF(EJ103=\"\",\"\",(EJ103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD103))",
    "FH103": "IF(EK103=\"\",\"\",(EK103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE103))",
    "FI103": "IF(EL103=\"\",\"\",(EL103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF103))",
    "FJ103": "IF(EM103=\"\", \"\", LET(\n  Now, CW103,\n  Next, EM103,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG103),\nFactor/Cost))",
    "FK103": "IF(EN103=\"\",\"\",(EN103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH103))",
    "FL103": "IF(EO103=\"\", \"\", LET(\n  Now, CS103,\n  Next, EO103,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI103),\nFactor/Cost))",
    "FM103": "IF(EP103=\"\",\"\",(EP103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ103))",
    "FN103": "IF(EQ103=\"\",\"\",(EQ103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK103))",
    "FO103": "IF(ER103=\"\",\"\",(ER103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL103))",
    "FP103": "IF(ES103=\"\",\"\",(ES103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM103))",
    "FQ103": "IF(ET103=\"\",\"\",(ET103/$DX103-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN103))",
    "FR103": "IF(EU103=\"\", \"\", LET(\n  Now, CX103,\n  Next, EU103,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO103),\nFactor/Cost))",
    "FT103": "IF(COLUMN(EW103:FR103) = MIN(IF(EW103:FR103=MAX(EW103:FR103), COLUMN(EW103:FR103))), 1, \"\")",
    "D104": "IF(SUM(FT103:GP103),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F104)),\"Card Mastery\",F104),G104)/$D$5,\"\")",
    "F104": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT103:GP103),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT103:GP103=1)),)\"),\"Critical Factor\")",
    "G104": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT103:GP103),ARRAYFORMULA(FILTER(BT103:CP103 , FT103:GP103=1)),\"\"\"\")\"),26.0)",
    "I104": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT103:GP103),ARRAYFORMULA(FILTER(EW103:FS103 , FT103:GP103=1))*D$5,\"\"\"\")\"),0.00898893689006226)",
    "K104": "IF(H104<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D104)),)",
    "BC104": "BC103+1",
    "BD104": "BD103+BD$3",
    "BE104": "BE103+BE$3",
    "BF104": "BF103+BF$3",
    "BH104": "BH103+BH$3",
    "BT104": "BT103+FT103",
    "BU104": "BU103+FU103",
    "BV104": "BV103+FV103",
    "BW104": "BW103+FW103",
    "BX104": "BX103+FX103",
    "BY104": "BY103+FY103",
    "BZ104": "BZ103+FZ103",
    "CA104": "CA103+GA103",
    "CB104": "CB103+GB103",
    "CC104": "CC103+GC103",
    "CD104": "CD103+GD103",
    "CE104": "CE103+GE103",
    "CF104": "CF103+GF103",
    "CG104": "CG103+GG103",
    "CH104": "CH103+GH103",
    "CI104": "CI103+GI103",
    "CJ104": "CJ103+GJ103",
    "CK104": "CK103+GK103",
    "CL104": "CL103+GL103",
    "CM104": "CM103+GM103",
    "CN104": "CN103+GN103",
    "CO104": "CO103+GO103",
    "CS104": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI104,1)",
    "CT104": "INDEX($BD$5:$BD249,BT104)",
    "CU104": "INDEX($BN$5:$BN249,CD104)",
    "CV104": "INDEX($BO$5:$BO249,CE104)",
    "CW104": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG104)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX104": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO104, 1)",
    "CY104": "LET(\n  Base, $CR$6,\n  Damage, $CT104,\n  DamageMastery, $CS104,\n  DemonMastery, $CX104,\n  SPB, $CU104,\n  ITO, $CV104,\n  Shock, $CW104,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ104": "MIN(100%, DA104)",
    "DA104": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK104*1%, 0)",
    "DB104": "LET(\n  Lab, 1+INDEX($BF$5:$BF249,BV104),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC104": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK104*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI249,BY104) + CardCritMastery)",
    "DD104": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK104*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ249,BZ104) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE104": "LET(\n  CF, $DB104,\n  CC, $CZ104,\n  SCM, $DD104,\n  SCC, $DC104,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF104": "LET(\n  CF, $DB104,\n  CC, $DA104,\n  SCM, $DD104,\n  SCC, $DC104,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG104": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH104)), 0)",
    "DH104": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ104*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE249,BU104),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI104": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG249, BW104), 1) + $AE$9)",
    "DJ104": "LET(\n  DpmLab, INDEX($BH$5:$BH249,BX104),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL104, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK104": "(1+$DI104*$DJ104*$AQ$9)",
    "DL104": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK249,CA104),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM104*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM104": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK249,CA104),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM104*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN104": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL249,CB104)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO104": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH104,\n  Rapid, DG104,\n  RDPM, DK104,\n  SuperTower, $DL104,\n  Rend, $DN104,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP104": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ104": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK104),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR104": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP104),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF104-1))",
    "DS104": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG104, DH104),0))",
    "DT104": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP104),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV104, $AR$29), 0))",
    "DU104": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK104),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM249,CC104), $DV104, $AR$29), 0))",
    "DV104": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH104), $AO$29)",
    "DW104": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM104,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104, $DB104), 1),\n\n  DW, $DR104,\n  CL, $DS104,\n  SM, $DT104,\n  SLM, $DU104,\n  SL, $DQ104,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX104": "CY104*(DE104*DO104*DQ104+DW104*DF104)",
    "DZ104": "IF(INDEX($BD$6:$BD249,BT104)=\"\", \"\", INDEX($BD$5:$BD249,BT104+1))",
    "EA104": "IF(OR($AO$25, INDEX($BE$6:$BE249,BU104)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ104)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE249,BU104+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI104*$DJ104*$AQ$9),\n  SuperTower, $DL104,\n  Rend, $DN104,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104, $DB104), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR104,\n  SM, $DT104,\n  SLM, $DU104,\n  SL, $DQ104,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM104, UltCritCard),\n\nCY104*(DE104*OtherDamage*SL+UwDamage*DF104)))",
    "EB104": "IF(INDEX($BF$6:$BF249,BV104)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF249,BV104+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ104,\n  CCUW, $DA104,\n  SCM, $DD104,\n  SCC, $DC104,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104, CF), 1),\n\n  DW, $DR104,\n  CL, $DS104,\n  SM, $DT104,\n  SLM, $DU104,\n  SL, $DQ104,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM104, UltCritCard),\n\nCY104 * (Critical * DO104 * SL + UwDamage * UWCritical)))",
    "EC104": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG249,BW104)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH104,\n  Rapid, DG104,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG249, BW104+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ104*$AQ$9),\n  SuperTower, $DL104,\n  Rend, $DN104,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM249,CC104), $DV104, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM104,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104, $DB104), 1),\n\n  DW, $DR104,\n  CL, $DS104,\n  SM, $DT104,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY104*(DE104*OtherDamage*SL+UWDamage*DF104)))",
    "ED104": "IF(OR($AO$25, INDEX($BH$6:$BH249,BX104)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH249,BX104+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL104, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI104*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM249,CC104), $DV104, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH104,\n  Rapid, DG104,\n  SuperTower, $DL104,\n  Rend, $DN104,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM104,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104, $DB104), 1),\n\n  DW, $DR104,\n  CL, $DS104,\n  SM, $DT104,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY104*(DE104*OtherDamage*SL+UWDamage*DF104)))",
    "EE104": "IF(INDEX($BI$6:$BI249,BY104)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK104, 0),\n  CF, $DB104,\n  CC, $CZ104,\n  CCUW, $DA104,\n  SCM, $DD104,\n  SCC, $AV$17+INDEX($BI$5:$BI249,BY104+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY104 * (Critical*DO104*$DQ104+DW104*UWCritical)))",
    "EF104": "IF(INDEX($BJ$6:$BJ249,BZ104)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK104*1%, 1),\n  CF, $DB104,\n  CC, $CZ104,\n  CCUW, $DA104,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ249,BZ104+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC104,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY104*(Critical*DO104*$DQ104+DW104*UWCritical)))",
    "EG104": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK249,CA104)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH104,\n  Rapid, DG104,\n  DPM, (1+$DI104*$DJ104*$AQ$9),\n  Rend, $DN104,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK249,CA104+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM104*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104, $DB104), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK249,CA104+1)-1))/(45-CM104*3),1),\n\n  SL, $DQ104,\n  DW, $DR104,\n  CL, $DS104,\n  SM, $DT104,\n  SLM, $DU104,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY104*(DE104*OtherDamage*SL+UwDamage*DF104)))",
    "EH104": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL249,CB104+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL249,CB104)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH104,\n  Rapid, DG104,\n  DPM, (1+$DI104*$DJ104*$AQ$9),\n  SuperTower, $DL104,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL249,CB104+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY104*(DE104*OtherDamage*$DQ104+DW104*DF104)))",
    "EI104": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM249,CC104)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104, $DB104), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK104),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV104, $AR$29), 0),\n\n  DW, $DR104,\n  CL, $DS104,\n  SM, $DT104,\n  SL, $DQ104,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM104, UltCritCard),\nCY104*(DE104*DO104*SL+UwDamage*DF104)))",
    "EJ104": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN249,CD104)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT104,\n  DamageMastery, $CS104,\n  DemonMastery, $CX104,\n  SPB, INDEX($BN$5:$BN249,CD104+1),\n  ITO, $CV104,\n  Shock, $CW104,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE104*DO104*$DQ104+DW104*DF104)))",
    "EK104": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO249,CE104)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT104,\n  DamageMastery, $CS104,\n  DemonMastery, $CX104,\n  SPB, $CU104,\n  ITO, INDEX($BO$5:$BO249,CE104+1),\n  Shock, $CW104,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE104*DO104*$DQ104+DW104*DF104)))",
    "EL104": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP249,CF104)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104, $DB104), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP104),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF104),\n  CL, $DS104,\n  SM, $DT104,\n  SLM, $DU104,\n  SL, $DQ104,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM104, UltCritCard),\nCY104*(DE104*DO104*SL+UwDamage*DF104)))",
    "EM104": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ249,CG104)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG104+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN104": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR249,CH104)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104, $DB104), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH104+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP104),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK104),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM249,CC104), SMHeat, $AR$29), 0),\n\n  DW, $DR104,\n  CL, $DS104,\n  SL, $DQ104,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM104, UltCritCard),\nCY104*(DE104*DO104*SL+UwDamage*DF104)))",
    "EO104": "IF(OR(CI104 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI104+1))",
    "EP104": "IF(OR($AO$25, CJ104 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ104+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE248,BU104),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL104, 1),\n  DPM, (1+$DI104*CardRangeMastery*$DJ104*$AQ$9),\n  SuperTower, $DL104,\n  Rend, $DN104,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104, $DB104), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR104,\n  SM, $DT104,\n  SLM, $DU104,\n  SL, $DQ104,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM104, UltCritCard),\n\nCY104*(DE104*OtherDamage*SL+UwDamage*DF104)))",
    "EQ104": "IF(OR(CK104 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK104+1)*1%, 1),\n  CF, $DB104,\n  CC, MIN(100%, $CZ104 + 1%),\n  CCUW, DA104 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ249,BZ104) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC104 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR104,\n  CL, $DS104,\n  SM, $DT104,\n  SLM, $DU104,\n  SL, $DQ104,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM104, UltCritCard),\n\nCY104 * (Critical*DO104*SL+UwDamage*UWCritical)))",
    "ER104": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL104 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH249,BX104),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL104+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI104*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM249,CC104), $DV104, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH104,\n  Rapid, DG104,\n  SuperTower, $DL104,\n  Rend, $DN104,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM104,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104, $DB104), 1),\n\n  DW, $DR104,\n  CL, $DS104,\n  SM, $DT104,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY104*(DE104*OtherDamage*SL+UWDamage*DF104)))",
    "ES104": "IF(OR(CM104 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH104,\n  Rapid, DG104,\n  RDPM, (1+$DI104*$DJ104*$AQ$9),\n  Rend, $DN104,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK249,CA104),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM104+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104, $DB104), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR104,\n  CL, $DS104,\n  SM, $DT104,\n  SLM, $DU104,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY104*(DE104*OtherDamage*SL+UwDamage*DF104)))",
    "ET104": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN104 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM104,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN104+1, $DB104), 1),\n\n  DW, $DR104,\n  CL, $DS104,\n  SM, $DT104,\n  SLM, $DU104,\n  SL, $DQ104,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY104*(DE104*DO104*SL+UWDamage*DF104)))",
    "EU104": "IF(OR(NOT($BA$3), NOT($BA$23), $CO104 > $BA$15), \"\", 1 + 0.5*(CO104+1))",
    "EW104": "IF(DZ104=\"\", \"\", LET(\n  Now, CT104,\n  Next, DZ104,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT104),\nFactor/Cost))",
    "EX104": "IF(EA104=\"\",\"\",(EA104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU104))",
    "EY104": "IF(EB104=\"\",\"\",(EB104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV104))",
    "EZ104": "IF(EC104=\"\",\"\",(EC104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW104))",
    "FA104": "IF(ED104=\"\",\"\",(ED104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX104))",
    "FB104": "IF(EE104=\"\",\"\",(EE104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY104))",
    "FC104": "IF(EF104=\"\",\"\",(EF104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ104))",
    "FD104": "IF(EG104=\"\",\"\",(EG104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA104))",
    "FE104": "IF(EH104=\"\",\"\",(EH104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB104))",
    "FF104": "IF(EI104=\"\",\"\",(EI104/$DX104-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC104+1, 1, CC104))))",
    "FG104": "IF(EJ104=\"\",\"\",(EJ104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD104))",
    "FH104": "IF(EK104=\"\",\"\",(EK104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE104))",
    "FI104": "IF(EL104=\"\",\"\",(EL104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF104))",
    "FJ104": "IF(EM104=\"\", \"\", LET(\n  Now, CW104,\n  Next, EM104,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG104),\nFactor/Cost))",
    "FK104": "IF(EN104=\"\",\"\",(EN104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH104))",
    "FL104": "IF(EO104=\"\", \"\", LET(\n  Now, CS104,\n  Next, EO104,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI104),\nFactor/Cost))",
    "FM104": "IF(EP104=\"\",\"\",(EP104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ104))",
    "FN104": "IF(EQ104=\"\",\"\",(EQ104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK104))",
    "FO104": "IF(ER104=\"\",\"\",(ER104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL104))",
    "FP104": "IF(ES104=\"\",\"\",(ES104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM104))",
    "FQ104": "IF(ET104=\"\",\"\",(ET104/$DX104-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN104))",
    "FR104": "IF(EU104=\"\", \"\", LET(\n  Now, CX104,\n  Next, EU104,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO104),\nFactor/Cost))",
    "FT104": "IF(COLUMN(EW104:FR104) = MIN(IF(EW104:FR104=MAX(EW104:FR104), COLUMN(EW104:FR104))), 1, \"\")",
    "D105": "IF(SUM(FT104:GP104),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F105)),\"Card Mastery\",F105),G105)/$D$5,\"\")",
    "F105": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT104:GP104),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT104:GP104=1)),)\"),\"Damage / Meter\")",
    "G105": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT104:GP104),ARRAYFORMULA(FILTER(BT104:CP104 , FT104:GP104=1)),\"\"\"\")\"),18.0)",
    "I105": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT104:GP104),ARRAYFORMULA(FILTER(EW104:FS104 , FT104:GP104=1))*D$5,\"\"\"\")\"),0.008714169142310131)",
    "K105": "IF(D96,FORMAT_TIME_YEAR(SUM($D$6:$D105)),)",
    "BC105": "BC104+1",
    "BD105": "BD104+BD$3",
    "BT105": "BT104+FT104",
    "BU105": "BU104+FU104",
    "BV105": "BV104+FV104",
    "BW105": "BW104+FW104",
    "BX105": "BX104+FX104",
    "BY105": "BY104+FY104",
    "BZ105": "BZ104+FZ104",
    "CA105": "CA104+GA104",
    "CB105": "CB104+GB104",
    "CC105": "CC104+GC104",
    "CD105": "CD104+GD104",
    "CE105": "CE104+GE104",
    "CF105": "CF104+GF104",
    "CG105": "CG104+GG104",
    "CH105": "CH104+GH104",
    "CI105": "CI104+GI104",
    "CJ105": "CJ104+GJ104",
    "CK105": "CK104+GK104",
    "CL105": "CL104+GL104",
    "CM105": "CM104+GM104",
    "CN105": "CN104+GN104",
    "CO105": "CO104+GO104",
    "CS105": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI105,1)",
    "CT105": "INDEX($BD$5:$BD250,BT105)",
    "CU105": "INDEX($BN$5:$BN250,CD105)",
    "CV105": "INDEX($BO$5:$BO250,CE105)",
    "CW105": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG105)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX105": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO105, 1)",
    "CY105": "LET(\n  Base, $CR$6,\n  Damage, $CT105,\n  DamageMastery, $CS105,\n  DemonMastery, $CX105,\n  SPB, $CU105,\n  ITO, $CV105,\n  Shock, $CW105,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ105": "MIN(100%, DA105)",
    "DA105": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK105*1%, 0)",
    "DB105": "LET(\n  Lab, 1+INDEX($BF$5:$BF250,BV105),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC105": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK105*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI250,BY105) + CardCritMastery)",
    "DD105": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK105*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ250,BZ105) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE105": "LET(\n  CF, $DB105,\n  CC, $CZ105,\n  SCM, $DD105,\n  SCC, $DC105,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF105": "LET(\n  CF, $DB105,\n  CC, $DA105,\n  SCM, $DD105,\n  SCC, $DC105,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG105": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH105)), 0)",
    "DH105": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ105*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE250,BU105),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI105": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG250, BW105), 1) + $AE$9)",
    "DJ105": "LET(\n  DpmLab, INDEX($BH$5:$BH250,BX105),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL105, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK105": "(1+$DI105*$DJ105*$AQ$9)",
    "DL105": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK250,CA105),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM105*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM105": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK250,CA105),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM105*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN105": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL250,CB105)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO105": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH105,\n  Rapid, DG105,\n  RDPM, DK105,\n  SuperTower, $DL105,\n  Rend, $DN105,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP105": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ105": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK105),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR105": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP105),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF105-1))",
    "DS105": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG105, DH105),0))",
    "DT105": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP105),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV105, $AR$29), 0))",
    "DU105": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK105),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM250,CC105), $DV105, $AR$29), 0))",
    "DV105": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH105), $AO$29)",
    "DW105": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM105,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105, $DB105), 1),\n\n  DW, $DR105,\n  CL, $DS105,\n  SM, $DT105,\n  SLM, $DU105,\n  SL, $DQ105,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX105": "CY105*(DE105*DO105*DQ105+DW105*DF105)",
    "DZ105": "IF(INDEX($BD$6:$BD250,BT105)=\"\", \"\", INDEX($BD$5:$BD250,BT105+1))",
    "EA105": "IF(OR($AO$25, INDEX($BE$6:$BE250,BU105)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ105)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE250,BU105+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI105*$DJ105*$AQ$9),\n  SuperTower, $DL105,\n  Rend, $DN105,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105, $DB105), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR105,\n  SM, $DT105,\n  SLM, $DU105,\n  SL, $DQ105,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM105, UltCritCard),\n\nCY105*(DE105*OtherDamage*SL+UwDamage*DF105)))",
    "EB105": "IF(INDEX($BF$6:$BF250,BV105)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF250,BV105+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ105,\n  CCUW, $DA105,\n  SCM, $DD105,\n  SCC, $DC105,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105, CF), 1),\n\n  DW, $DR105,\n  CL, $DS105,\n  SM, $DT105,\n  SLM, $DU105,\n  SL, $DQ105,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM105, UltCritCard),\n\nCY105 * (Critical * DO105 * SL + UwDamage * UWCritical)))",
    "EC105": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG250,BW105)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH105,\n  Rapid, DG105,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG250, BW105+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ105*$AQ$9),\n  SuperTower, $DL105,\n  Rend, $DN105,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM250,CC105), $DV105, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM105,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105, $DB105), 1),\n\n  DW, $DR105,\n  CL, $DS105,\n  SM, $DT105,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY105*(DE105*OtherDamage*SL+UWDamage*DF105)))",
    "ED105": "IF(OR($AO$25, INDEX($BH$6:$BH250,BX105)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH250,BX105+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL105, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI105*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM250,CC105), $DV105, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH105,\n  Rapid, DG105,\n  SuperTower, $DL105,\n  Rend, $DN105,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM105,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105, $DB105), 1),\n\n  DW, $DR105,\n  CL, $DS105,\n  SM, $DT105,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY105*(DE105*OtherDamage*SL+UWDamage*DF105)))",
    "EE105": "IF(INDEX($BI$6:$BI250,BY105)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK105, 0),\n  CF, $DB105,\n  CC, $CZ105,\n  CCUW, $DA105,\n  SCM, $DD105,\n  SCC, $AV$17+INDEX($BI$5:$BI250,BY105+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY105 * (Critical*DO105*$DQ105+DW105*UWCritical)))",
    "EF105": "IF(INDEX($BJ$6:$BJ250,BZ105)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK105*1%, 1),\n  CF, $DB105,\n  CC, $CZ105,\n  CCUW, $DA105,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ250,BZ105+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC105,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY105*(Critical*DO105*$DQ105+DW105*UWCritical)))",
    "EG105": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK250,CA105)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH105,\n  Rapid, DG105,\n  DPM, (1+$DI105*$DJ105*$AQ$9),\n  Rend, $DN105,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK250,CA105+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM105*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105, $DB105), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK250,CA105+1)-1))/(45-CM105*3),1),\n\n  SL, $DQ105,\n  DW, $DR105,\n  CL, $DS105,\n  SM, $DT105,\n  SLM, $DU105,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY105*(DE105*OtherDamage*SL+UwDamage*DF105)))",
    "EH105": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL250,CB105+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL250,CB105)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH105,\n  Rapid, DG105,\n  DPM, (1+$DI105*$DJ105*$AQ$9),\n  SuperTower, $DL105,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL250,CB105+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY105*(DE105*OtherDamage*$DQ105+DW105*DF105)))",
    "EI105": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM250,CC105)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105, $DB105), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK105),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV105, $AR$29), 0),\n\n  DW, $DR105,\n  CL, $DS105,\n  SM, $DT105,\n  SL, $DQ105,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM105, UltCritCard),\nCY105*(DE105*DO105*SL+UwDamage*DF105)))",
    "EJ105": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN250,CD105)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT105,\n  DamageMastery, $CS105,\n  DemonMastery, $CX105,\n  SPB, INDEX($BN$5:$BN250,CD105+1),\n  ITO, $CV105,\n  Shock, $CW105,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE105*DO105*$DQ105+DW105*DF105)))",
    "EK105": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO250,CE105)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT105,\n  DamageMastery, $CS105,\n  DemonMastery, $CX105,\n  SPB, $CU105,\n  ITO, INDEX($BO$5:$BO250,CE105+1),\n  Shock, $CW105,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE105*DO105*$DQ105+DW105*DF105)))",
    "EL105": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP250,CF105)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105, $DB105), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP105),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF105),\n  CL, $DS105,\n  SM, $DT105,\n  SLM, $DU105,\n  SL, $DQ105,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM105, UltCritCard),\nCY105*(DE105*DO105*SL+UwDamage*DF105)))",
    "EM105": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ250,CG105)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG105+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN105": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR250,CH105)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105, $DB105), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH105+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP105),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK105),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM250,CC105), SMHeat, $AR$29), 0),\n\n  DW, $DR105,\n  CL, $DS105,\n  SL, $DQ105,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM105, UltCritCard),\nCY105*(DE105*DO105*SL+UwDamage*DF105)))",
    "EO105": "IF(OR(CI105 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI105+1))",
    "EP105": "IF(OR($AO$25, CJ105 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ105+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE249,BU105),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL105, 1),\n  DPM, (1+$DI105*CardRangeMastery*$DJ105*$AQ$9),\n  SuperTower, $DL105,\n  Rend, $DN105,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105, $DB105), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR105,\n  SM, $DT105,\n  SLM, $DU105,\n  SL, $DQ105,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM105, UltCritCard),\n\nCY105*(DE105*OtherDamage*SL+UwDamage*DF105)))",
    "EQ105": "IF(OR(CK105 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK105+1)*1%, 1),\n  CF, $DB105,\n  CC, MIN(100%, $CZ105 + 1%),\n  CCUW, DA105 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ250,BZ105) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC105 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR105,\n  CL, $DS105,\n  SM, $DT105,\n  SLM, $DU105,\n  SL, $DQ105,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM105, UltCritCard),\n\nCY105 * (Critical*DO105*SL+UwDamage*UWCritical)))",
    "ER105": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL105 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH250,BX105),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL105+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI105*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM250,CC105), $DV105, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH105,\n  Rapid, DG105,\n  SuperTower, $DL105,\n  Rend, $DN105,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM105,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105, $DB105), 1),\n\n  DW, $DR105,\n  CL, $DS105,\n  SM, $DT105,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY105*(DE105*OtherDamage*SL+UWDamage*DF105)))",
    "ES105": "IF(OR(CM105 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH105,\n  Rapid, DG105,\n  RDPM, (1+$DI105*$DJ105*$AQ$9),\n  Rend, $DN105,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK250,CA105),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM105+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105, $DB105), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR105,\n  CL, $DS105,\n  SM, $DT105,\n  SLM, $DU105,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY105*(DE105*OtherDamage*SL+UwDamage*DF105)))",
    "ET105": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN105 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM105,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN105+1, $DB105), 1),\n\n  DW, $DR105,\n  CL, $DS105,\n  SM, $DT105,\n  SLM, $DU105,\n  SL, $DQ105,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY105*(DE105*DO105*SL+UWDamage*DF105)))",
    "EU105": "IF(OR(NOT($BA$3), NOT($BA$23), $CO105 > $BA$15), \"\", 1 + 0.5*(CO105+1))",
    "EW105": "IF(DZ105=\"\", \"\", LET(\n  Now, CT105,\n  Next, DZ105,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT105),\nFactor/Cost))",
    "EX105": "IF(EA105=\"\",\"\",(EA105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU105))",
    "EY105": "IF(EB105=\"\",\"\",(EB105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV105))",
    "EZ105": "IF(EC105=\"\",\"\",(EC105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW105))",
    "FA105": "IF(ED105=\"\",\"\",(ED105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX105))",
    "FB105": "IF(EE105=\"\",\"\",(EE105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY105))",
    "FC105": "IF(EF105=\"\",\"\",(EF105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ105))",
    "FD105": "IF(EG105=\"\",\"\",(EG105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA105))",
    "FE105": "IF(EH105=\"\",\"\",(EH105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB105))",
    "FF105": "IF(EI105=\"\",\"\",(EI105/$DX105-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC105+1, 1, CC105))))",
    "FG105": "IF(EJ105=\"\",\"\",(EJ105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD105))",
    "FH105": "IF(EK105=\"\",\"\",(EK105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE105))",
    "FI105": "IF(EL105=\"\",\"\",(EL105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF105))",
    "FJ105": "IF(EM105=\"\", \"\", LET(\n  Now, CW105,\n  Next, EM105,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG105),\nFactor/Cost))",
    "FK105": "IF(EN105=\"\",\"\",(EN105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH105))",
    "FL105": "IF(EO105=\"\", \"\", LET(\n  Now, CS105,\n  Next, EO105,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI105),\nFactor/Cost))",
    "FM105": "IF(EP105=\"\",\"\",(EP105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ105))",
    "FN105": "IF(EQ105=\"\",\"\",(EQ105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK105))",
    "FO105": "IF(ER105=\"\",\"\",(ER105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL105))",
    "FP105": "IF(ES105=\"\",\"\",(ES105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM105))",
    "FQ105": "IF(ET105=\"\",\"\",(ET105/$DX105-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN105))",
    "FR105": "IF(EU105=\"\", \"\", LET(\n  Now, CX105,\n  Next, EU105,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO105),\nFactor/Cost))",
    "FT105": "IF(COLUMN(EW105:FR105) = MIN(IF(EW105:FR105=MAX(EW105:FR105), COLUMN(EW105:FR105))), 1, \"\")",
    "D106": "IF(SUM(FT105:GP105),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F106)),\"Card Mastery\",F106),G106)/$D$5,\"\")",
    "F106": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT105:GP105),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT105:GP105=1)),)\"),\"Damage\")",
    "G106": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT105:GP105),ARRAYFORMULA(FILTER(BT105:CP105 , FT105:GP105=1)),\"\"\"\")\"),24.0)",
    "I106": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT105:GP105),ARRAYFORMULA(FILTER(EW105:FS105 , FT105:GP105=1))*D$5,\"\"\"\")\"),0.00865936233417926)",
    "K106": "IF(H106<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D106)),)",
    "BT106": "BT105+FT105",
    "BU106": "BU105+FU105",
    "BV106": "BV105+FV105",
    "BW106": "BW105+FW105",
    "BX106": "BX105+FX105",
    "BY106": "BY105+FY105",
    "BZ106": "BZ105+FZ105",
    "CA106": "CA105+GA105",
    "CB106": "CB105+GB105",
    "CC106": "CC105+GC105",
    "CD106": "CD105+GD105",
    "CE106": "CE105+GE105",
    "CF106": "CF105+GF105",
    "CG106": "CG105+GG105",
    "CH106": "CH105+GH105",
    "CI106": "CI105+GI105",
    "CJ106": "CJ105+GJ105",
    "CK106": "CK105+GK105",
    "CL106": "CL105+GL105",
    "CM106": "CM105+GM105",
    "CN106": "CN105+GN105",
    "CO106": "CO105+GO105",
    "CS106": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI106,1)",
    "CT106": "INDEX($BD$5:$BD251,BT106)",
    "CU106": "INDEX($BN$5:$BN251,CD106)",
    "CV106": "INDEX($BO$5:$BO251,CE106)",
    "CW106": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG106)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX106": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO106, 1)",
    "CY106": "LET(\n  Base, $CR$6,\n  Damage, $CT106,\n  DamageMastery, $CS106,\n  DemonMastery, $CX106,\n  SPB, $CU106,\n  ITO, $CV106,\n  Shock, $CW106,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ106": "MIN(100%, DA106)",
    "DA106": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK106*1%, 0)",
    "DB106": "LET(\n  Lab, 1+INDEX($BF$5:$BF251,BV106),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC106": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK106*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI251,BY106) + CardCritMastery)",
    "DD106": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK106*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ251,BZ106) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE106": "LET(\n  CF, $DB106,\n  CC, $CZ106,\n  SCM, $DD106,\n  SCC, $DC106,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF106": "LET(\n  CF, $DB106,\n  CC, $DA106,\n  SCM, $DD106,\n  SCC, $DC106,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG106": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH106)), 0)",
    "DH106": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ106*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE251,BU106),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI106": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG251, BW106), 1) + $AE$9)",
    "DJ106": "LET(\n  DpmLab, INDEX($BH$5:$BH251,BX106),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL106, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK106": "(1+$DI106*$DJ106*$AQ$9)",
    "DL106": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK251,CA106),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM106*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM106": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK251,CA106),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM106*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN106": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL251,CB106)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO106": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH106,\n  Rapid, DG106,\n  RDPM, DK106,\n  SuperTower, $DL106,\n  Rend, $DN106,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP106": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ106": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK106),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR106": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP106),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF106-1))",
    "DS106": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG106, DH106),0))",
    "DT106": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP106),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV106, $AR$29), 0))",
    "DU106": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK106),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM251,CC106), $DV106, $AR$29), 0))",
    "DV106": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH106), $AO$29)",
    "DW106": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM106,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106, $DB106), 1),\n\n  DW, $DR106,\n  CL, $DS106,\n  SM, $DT106,\n  SLM, $DU106,\n  SL, $DQ106,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX106": "CY106*(DE106*DO106*DQ106+DW106*DF106)",
    "DZ106": "IF(INDEX($BD$6:$BD251,BT106)=\"\", \"\", INDEX($BD$5:$BD251,BT106+1))",
    "EA106": "IF(OR($AO$25, INDEX($BE$6:$BE251,BU106)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ106)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE251,BU106+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI106*$DJ106*$AQ$9),\n  SuperTower, $DL106,\n  Rend, $DN106,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106, $DB106), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR106,\n  SM, $DT106,\n  SLM, $DU106,\n  SL, $DQ106,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM106, UltCritCard),\n\nCY106*(DE106*OtherDamage*SL+UwDamage*DF106)))",
    "EB106": "IF(INDEX($BF$6:$BF251,BV106)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF251,BV106+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ106,\n  CCUW, $DA106,\n  SCM, $DD106,\n  SCC, $DC106,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106, CF), 1),\n\n  DW, $DR106,\n  CL, $DS106,\n  SM, $DT106,\n  SLM, $DU106,\n  SL, $DQ106,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM106, UltCritCard),\n\nCY106 * (Critical * DO106 * SL + UwDamage * UWCritical)))",
    "EC106": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG251,BW106)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH106,\n  Rapid, DG106,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG251, BW106+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ106*$AQ$9),\n  SuperTower, $DL106,\n  Rend, $DN106,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM251,CC106), $DV106, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM106,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106, $DB106), 1),\n\n  DW, $DR106,\n  CL, $DS106,\n  SM, $DT106,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY106*(DE106*OtherDamage*SL+UWDamage*DF106)))",
    "ED106": "IF(OR($AO$25, INDEX($BH$6:$BH251,BX106)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH251,BX106+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL106, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI106*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM251,CC106), $DV106, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH106,\n  Rapid, DG106,\n  SuperTower, $DL106,\n  Rend, $DN106,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM106,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106, $DB106), 1),\n\n  DW, $DR106,\n  CL, $DS106,\n  SM, $DT106,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY106*(DE106*OtherDamage*SL+UWDamage*DF106)))",
    "EE106": "IF(INDEX($BI$6:$BI251,BY106)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK106, 0),\n  CF, $DB106,\n  CC, $CZ106,\n  CCUW, $DA106,\n  SCM, $DD106,\n  SCC, $AV$17+INDEX($BI$5:$BI251,BY106+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY106 * (Critical*DO106*$DQ106+DW106*UWCritical)))",
    "EF106": "IF(INDEX($BJ$6:$BJ251,BZ106)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK106*1%, 1),\n  CF, $DB106,\n  CC, $CZ106,\n  CCUW, $DA106,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ251,BZ106+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC106,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY106*(Critical*DO106*$DQ106+DW106*UWCritical)))",
    "EG106": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK251,CA106)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH106,\n  Rapid, DG106,\n  DPM, (1+$DI106*$DJ106*$AQ$9),\n  Rend, $DN106,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK251,CA106+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM106*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106, $DB106), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK251,CA106+1)-1))/(45-CM106*3),1),\n\n  SL, $DQ106,\n  DW, $DR106,\n  CL, $DS106,\n  SM, $DT106,\n  SLM, $DU106,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY106*(DE106*OtherDamage*SL+UwDamage*DF106)))",
    "EH106": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL251,CB106+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL251,CB106)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH106,\n  Rapid, DG106,\n  DPM, (1+$DI106*$DJ106*$AQ$9),\n  SuperTower, $DL106,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL251,CB106+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY106*(DE106*OtherDamage*$DQ106+DW106*DF106)))",
    "EI106": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM251,CC106)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106, $DB106), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK106),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV106, $AR$29), 0),\n\n  DW, $DR106,\n  CL, $DS106,\n  SM, $DT106,\n  SL, $DQ106,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM106, UltCritCard),\nCY106*(DE106*DO106*SL+UwDamage*DF106)))",
    "EJ106": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN251,CD106)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT106,\n  DamageMastery, $CS106,\n  DemonMastery, $CX106,\n  SPB, INDEX($BN$5:$BN251,CD106+1),\n  ITO, $CV106,\n  Shock, $CW106,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE106*DO106*$DQ106+DW106*DF106)))",
    "EK106": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO251,CE106)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT106,\n  DamageMastery, $CS106,\n  DemonMastery, $CX106,\n  SPB, $CU106,\n  ITO, INDEX($BO$5:$BO251,CE106+1),\n  Shock, $CW106,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE106*DO106*$DQ106+DW106*DF106)))",
    "EL106": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP251,CF106)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106, $DB106), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP106),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF106),\n  CL, $DS106,\n  SM, $DT106,\n  SLM, $DU106,\n  SL, $DQ106,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM106, UltCritCard),\nCY106*(DE106*DO106*SL+UwDamage*DF106)))",
    "EM106": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ251,CG106)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG106+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN106": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR251,CH106)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106, $DB106), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH106+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP106),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK106),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM251,CC106), SMHeat, $AR$29), 0),\n\n  DW, $DR106,\n  CL, $DS106,\n  SL, $DQ106,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM106, UltCritCard),\nCY106*(DE106*DO106*SL+UwDamage*DF106)))",
    "EO106": "IF(OR(CI106 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI106+1))",
    "EP106": "IF(OR($AO$25, CJ106 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ106+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE250,BU106),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL106, 1),\n  DPM, (1+$DI106*CardRangeMastery*$DJ106*$AQ$9),\n  SuperTower, $DL106,\n  Rend, $DN106,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106, $DB106), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR106,\n  SM, $DT106,\n  SLM, $DU106,\n  SL, $DQ106,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM106, UltCritCard),\n\nCY106*(DE106*OtherDamage*SL+UwDamage*DF106)))",
    "EQ106": "IF(OR(CK106 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK106+1)*1%, 1),\n  CF, $DB106,\n  CC, MIN(100%, $CZ106 + 1%),\n  CCUW, DA106 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ251,BZ106) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC106 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR106,\n  CL, $DS106,\n  SM, $DT106,\n  SLM, $DU106,\n  SL, $DQ106,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM106, UltCritCard),\n\nCY106 * (Critical*DO106*SL+UwDamage*UWCritical)))",
    "ER106": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL106 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH251,BX106),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL106+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI106*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM251,CC106), $DV106, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH106,\n  Rapid, DG106,\n  SuperTower, $DL106,\n  Rend, $DN106,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM106,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106, $DB106), 1),\n\n  DW, $DR106,\n  CL, $DS106,\n  SM, $DT106,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY106*(DE106*OtherDamage*SL+UWDamage*DF106)))",
    "ES106": "IF(OR(CM106 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH106,\n  Rapid, DG106,\n  RDPM, (1+$DI106*$DJ106*$AQ$9),\n  Rend, $DN106,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK251,CA106),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM106+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106, $DB106), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR106,\n  CL, $DS106,\n  SM, $DT106,\n  SLM, $DU106,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY106*(DE106*OtherDamage*SL+UwDamage*DF106)))",
    "ET106": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN106 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM106,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN106+1, $DB106), 1),\n\n  DW, $DR106,\n  CL, $DS106,\n  SM, $DT106,\n  SLM, $DU106,\n  SL, $DQ106,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY106*(DE106*DO106*SL+UWDamage*DF106)))",
    "EU106": "IF(OR(NOT($BA$3), NOT($BA$23), $CO106 > $BA$15), \"\", 1 + 0.5*(CO106+1))",
    "EW106": "IF(DZ106=\"\", \"\", LET(\n  Now, CT106,\n  Next, DZ106,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT106),\nFactor/Cost))",
    "EX106": "IF(EA106=\"\",\"\",(EA106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU106))",
    "EY106": "IF(EB106=\"\",\"\",(EB106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV106))",
    "EZ106": "IF(EC106=\"\",\"\",(EC106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW106))",
    "FA106": "IF(ED106=\"\",\"\",(ED106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX106))",
    "FB106": "IF(EE106=\"\",\"\",(EE106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY106))",
    "FC106": "IF(EF106=\"\",\"\",(EF106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ106))",
    "FD106": "IF(EG106=\"\",\"\",(EG106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA106))",
    "FE106": "IF(EH106=\"\",\"\",(EH106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB106))",
    "FF106": "IF(EI106=\"\",\"\",(EI106/$DX106-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC106+1, 1, CC106))))",
    "FG106": "IF(EJ106=\"\",\"\",(EJ106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD106))",
    "FH106": "IF(EK106=\"\",\"\",(EK106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE106))",
    "FI106": "IF(EL106=\"\",\"\",(EL106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF106))",
    "FJ106": "IF(EM106=\"\", \"\", LET(\n  Now, CW106,\n  Next, EM106,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG106),\nFactor/Cost))",
    "FK106": "IF(EN106=\"\",\"\",(EN106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH106))",
    "FL106": "IF(EO106=\"\", \"\", LET(\n  Now, CS106,\n  Next, EO106,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI106),\nFactor/Cost))",
    "FM106": "IF(EP106=\"\",\"\",(EP106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ106))",
    "FN106": "IF(EQ106=\"\",\"\",(EQ106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK106))",
    "FO106": "IF(ER106=\"\",\"\",(ER106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL106))",
    "FP106": "IF(ES106=\"\",\"\",(ES106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM106))",
    "FQ106": "IF(ET106=\"\",\"\",(ET106/$DX106-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN106))",
    "FR106": "IF(EU106=\"\", \"\", LET(\n  Now, CX106,\n  Next, EU106,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO106),\nFactor/Cost))",
    "FT106": "IF(COLUMN(EW106:FR106) = MIN(IF(EW106:FR106=MAX(EW106:FR106), COLUMN(EW106:FR106))), 1, \"\")",
    "D107": "IF(SUM(FT106:GP106),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F107)),\"Card Mastery\",F107),G107)/$D$5,\"\")",
    "F107": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT106:GP106),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT106:GP106=1)),)\"),\"Standard Perks Bonus\")",
    "G107": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT106:GP106),ARRAYFORMULA(FILTER(BT106:CP106 , FT106:GP106=1)),\"\"\"\")\"),6.0)",
    "I107": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT106:GP106),ARRAYFORMULA(FILTER(EW106:FS106 , FT106:GP106=1))*D$5,\"\"\"\")\"),0.008614501076812603)",
    "K107": "IF(H107<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D107)),)",
    "BT107": "BT106+FT106",
    "BU107": "BU106+FU106",
    "BV107": "BV106+FV106",
    "BW107": "BW106+FW106",
    "BX107": "BX106+FX106",
    "BY107": "BY106+FY106",
    "BZ107": "BZ106+FZ106",
    "CA107": "CA106+GA106",
    "CB107": "CB106+GB106",
    "CC107": "CC106+GC106",
    "CD107": "CD106+GD106",
    "CE107": "CE106+GE106",
    "CF107": "CF106+GF106",
    "CG107": "CG106+GG106",
    "CH107": "CH106+GH106",
    "CI107": "CI106+GI106",
    "CJ107": "CJ106+GJ106",
    "CK107": "CK106+GK106",
    "CL107": "CL106+GL106",
    "CM107": "CM106+GM106",
    "CN107": "CN106+GN106",
    "CO107": "CO106+GO106",
    "CS107": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI107,1)",
    "CT107": "INDEX($BD$5:$BD252,BT107)",
    "CU107": "INDEX($BN$5:$BN252,CD107)",
    "CV107": "INDEX($BO$5:$BO252,CE107)",
    "CW107": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG107)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX107": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO107, 1)",
    "CY107": "LET(\n  Base, $CR$6,\n  Damage, $CT107,\n  DamageMastery, $CS107,\n  DemonMastery, $CX107,\n  SPB, $CU107,\n  ITO, $CV107,\n  Shock, $CW107,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ107": "MIN(100%, DA107)",
    "DA107": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK107*1%, 0)",
    "DB107": "LET(\n  Lab, 1+INDEX($BF$5:$BF252,BV107),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC107": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK107*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI252,BY107) + CardCritMastery)",
    "DD107": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK107*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ252,BZ107) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE107": "LET(\n  CF, $DB107,\n  CC, $CZ107,\n  SCM, $DD107,\n  SCC, $DC107,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF107": "LET(\n  CF, $DB107,\n  CC, $DA107,\n  SCM, $DD107,\n  SCC, $DC107,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG107": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH107)), 0)",
    "DH107": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ107*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE252,BU107),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI107": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG252, BW107), 1) + $AE$9)",
    "DJ107": "LET(\n  DpmLab, INDEX($BH$5:$BH252,BX107),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL107, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK107": "(1+$DI107*$DJ107*$AQ$9)",
    "DL107": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK252,CA107),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM107*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM107": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK252,CA107),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM107*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN107": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL252,CB107)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO107": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH107,\n  Rapid, DG107,\n  RDPM, DK107,\n  SuperTower, $DL107,\n  Rend, $DN107,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP107": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ107": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK107),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR107": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP107),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF107-1))",
    "DS107": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG107, DH107),0))",
    "DT107": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP107),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV107, $AR$29), 0))",
    "DU107": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK107),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM252,CC107), $DV107, $AR$29), 0))",
    "DV107": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH107), $AO$29)",
    "DW107": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM107,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107, $DB107), 1),\n\n  DW, $DR107,\n  CL, $DS107,\n  SM, $DT107,\n  SLM, $DU107,\n  SL, $DQ107,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX107": "CY107*(DE107*DO107*DQ107+DW107*DF107)",
    "DZ107": "IF(INDEX($BD$6:$BD252,BT107)=\"\", \"\", INDEX($BD$5:$BD252,BT107+1))",
    "EA107": "IF(OR($AO$25, INDEX($BE$6:$BE252,BU107)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ107)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE252,BU107+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI107*$DJ107*$AQ$9),\n  SuperTower, $DL107,\n  Rend, $DN107,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107, $DB107), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR107,\n  SM, $DT107,\n  SLM, $DU107,\n  SL, $DQ107,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM107, UltCritCard),\n\nCY107*(DE107*OtherDamage*SL+UwDamage*DF107)))",
    "EB107": "IF(INDEX($BF$6:$BF252,BV107)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF252,BV107+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ107,\n  CCUW, $DA107,\n  SCM, $DD107,\n  SCC, $DC107,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107, CF), 1),\n\n  DW, $DR107,\n  CL, $DS107,\n  SM, $DT107,\n  SLM, $DU107,\n  SL, $DQ107,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM107, UltCritCard),\n\nCY107 * (Critical * DO107 * SL + UwDamage * UWCritical)))",
    "EC107": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG252,BW107)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH107,\n  Rapid, DG107,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG252, BW107+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ107*$AQ$9),\n  SuperTower, $DL107,\n  Rend, $DN107,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM252,CC107), $DV107, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM107,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107, $DB107), 1),\n\n  DW, $DR107,\n  CL, $DS107,\n  SM, $DT107,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY107*(DE107*OtherDamage*SL+UWDamage*DF107)))",
    "ED107": "IF(OR($AO$25, INDEX($BH$6:$BH252,BX107)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH252,BX107+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL107, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI107*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM252,CC107), $DV107, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH107,\n  Rapid, DG107,\n  SuperTower, $DL107,\n  Rend, $DN107,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM107,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107, $DB107), 1),\n\n  DW, $DR107,\n  CL, $DS107,\n  SM, $DT107,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY107*(DE107*OtherDamage*SL+UWDamage*DF107)))",
    "EE107": "IF(INDEX($BI$6:$BI252,BY107)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK107, 0),\n  CF, $DB107,\n  CC, $CZ107,\n  CCUW, $DA107,\n  SCM, $DD107,\n  SCC, $AV$17+INDEX($BI$5:$BI252,BY107+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY107 * (Critical*DO107*$DQ107+DW107*UWCritical)))",
    "EF107": "IF(INDEX($BJ$6:$BJ252,BZ107)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK107*1%, 1),\n  CF, $DB107,\n  CC, $CZ107,\n  CCUW, $DA107,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ252,BZ107+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC107,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY107*(Critical*DO107*$DQ107+DW107*UWCritical)))",
    "EG107": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK252,CA107)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH107,\n  Rapid, DG107,\n  DPM, (1+$DI107*$DJ107*$AQ$9),\n  Rend, $DN107,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK252,CA107+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM107*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107, $DB107), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK252,CA107+1)-1))/(45-CM107*3),1),\n\n  SL, $DQ107,\n  DW, $DR107,\n  CL, $DS107,\n  SM, $DT107,\n  SLM, $DU107,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY107*(DE107*OtherDamage*SL+UwDamage*DF107)))",
    "EH107": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL252,CB107+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL252,CB107)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH107,\n  Rapid, DG107,\n  DPM, (1+$DI107*$DJ107*$AQ$9),\n  SuperTower, $DL107,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL252,CB107+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY107*(DE107*OtherDamage*$DQ107+DW107*DF107)))",
    "EI107": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM252,CC107)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107, $DB107), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK107),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV107, $AR$29), 0),\n\n  DW, $DR107,\n  CL, $DS107,\n  SM, $DT107,\n  SL, $DQ107,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM107, UltCritCard),\nCY107*(DE107*DO107*SL+UwDamage*DF107)))",
    "EJ107": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN252,CD107)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT107,\n  DamageMastery, $CS107,\n  DemonMastery, $CX107,\n  SPB, INDEX($BN$5:$BN252,CD107+1),\n  ITO, $CV107,\n  Shock, $CW107,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE107*DO107*$DQ107+DW107*DF107)))",
    "EK107": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO252,CE107)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT107,\n  DamageMastery, $CS107,\n  DemonMastery, $CX107,\n  SPB, $CU107,\n  ITO, INDEX($BO$5:$BO252,CE107+1),\n  Shock, $CW107,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE107*DO107*$DQ107+DW107*DF107)))",
    "EL107": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP252,CF107)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107, $DB107), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP107),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF107),\n  CL, $DS107,\n  SM, $DT107,\n  SLM, $DU107,\n  SL, $DQ107,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM107, UltCritCard),\nCY107*(DE107*DO107*SL+UwDamage*DF107)))",
    "EM107": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ252,CG107)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG107+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN107": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR252,CH107)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107, $DB107), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH107+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP107),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK107),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM252,CC107), SMHeat, $AR$29), 0),\n\n  DW, $DR107,\n  CL, $DS107,\n  SL, $DQ107,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM107, UltCritCard),\nCY107*(DE107*DO107*SL+UwDamage*DF107)))",
    "EO107": "IF(OR(CI107 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI107+1))",
    "EP107": "IF(OR($AO$25, CJ107 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ107+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE251,BU107),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL107, 1),\n  DPM, (1+$DI107*CardRangeMastery*$DJ107*$AQ$9),\n  SuperTower, $DL107,\n  Rend, $DN107,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107, $DB107), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR107,\n  SM, $DT107,\n  SLM, $DU107,\n  SL, $DQ107,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM107, UltCritCard),\n\nCY107*(DE107*OtherDamage*SL+UwDamage*DF107)))",
    "EQ107": "IF(OR(CK107 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK107+1)*1%, 1),\n  CF, $DB107,\n  CC, MIN(100%, $CZ107 + 1%),\n  CCUW, DA107 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ252,BZ107) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC107 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR107,\n  CL, $DS107,\n  SM, $DT107,\n  SLM, $DU107,\n  SL, $DQ107,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM107, UltCritCard),\n\nCY107 * (Critical*DO107*SL+UwDamage*UWCritical)))",
    "ER107": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL107 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH252,BX107),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL107+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI107*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM252,CC107), $DV107, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH107,\n  Rapid, DG107,\n  SuperTower, $DL107,\n  Rend, $DN107,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM107,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107, $DB107), 1),\n\n  DW, $DR107,\n  CL, $DS107,\n  SM, $DT107,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY107*(DE107*OtherDamage*SL+UWDamage*DF107)))",
    "ES107": "IF(OR(CM107 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH107,\n  Rapid, DG107,\n  RDPM, (1+$DI107*$DJ107*$AQ$9),\n  Rend, $DN107,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK252,CA107),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM107+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107, $DB107), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR107,\n  CL, $DS107,\n  SM, $DT107,\n  SLM, $DU107,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY107*(DE107*OtherDamage*SL+UwDamage*DF107)))",
    "ET107": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN107 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM107,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN107+1, $DB107), 1),\n\n  DW, $DR107,\n  CL, $DS107,\n  SM, $DT107,\n  SLM, $DU107,\n  SL, $DQ107,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY107*(DE107*DO107*SL+UWDamage*DF107)))",
    "EU107": "IF(OR(NOT($BA$3), NOT($BA$23), $CO107 > $BA$15), \"\", 1 + 0.5*(CO107+1))",
    "EW107": "IF(DZ107=\"\", \"\", LET(\n  Now, CT107,\n  Next, DZ107,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT107),\nFactor/Cost))",
    "EX107": "IF(EA107=\"\",\"\",(EA107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU107))",
    "EY107": "IF(EB107=\"\",\"\",(EB107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV107))",
    "EZ107": "IF(EC107=\"\",\"\",(EC107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW107))",
    "FA107": "IF(ED107=\"\",\"\",(ED107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX107))",
    "FB107": "IF(EE107=\"\",\"\",(EE107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY107))",
    "FC107": "IF(EF107=\"\",\"\",(EF107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ107))",
    "FD107": "IF(EG107=\"\",\"\",(EG107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA107))",
    "FE107": "IF(EH107=\"\",\"\",(EH107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB107))",
    "FF107": "IF(EI107=\"\",\"\",(EI107/$DX107-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC107+1, 1, CC107))))",
    "FG107": "IF(EJ107=\"\",\"\",(EJ107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD107))",
    "FH107": "IF(EK107=\"\",\"\",(EK107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE107))",
    "FI107": "IF(EL107=\"\",\"\",(EL107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF107))",
    "FJ107": "IF(EM107=\"\", \"\", LET(\n  Now, CW107,\n  Next, EM107,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG107),\nFactor/Cost))",
    "FK107": "IF(EN107=\"\",\"\",(EN107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH107))",
    "FL107": "IF(EO107=\"\", \"\", LET(\n  Now, CS107,\n  Next, EO107,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI107),\nFactor/Cost))",
    "FM107": "IF(EP107=\"\",\"\",(EP107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ107))",
    "FN107": "IF(EQ107=\"\",\"\",(EQ107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK107))",
    "FO107": "IF(ER107=\"\",\"\",(ER107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL107))",
    "FP107": "IF(ES107=\"\",\"\",(ES107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM107))",
    "FQ107": "IF(ET107=\"\",\"\",(ET107/$DX107-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN107))",
    "FR107": "IF(EU107=\"\", \"\", LET(\n  Now, CX107,\n  Next, EU107,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO107),\nFactor/Cost))",
    "FT107": "IF(COLUMN(EW107:FR107) = MIN(IF(EW107:FR107=MAX(EW107:FR107), COLUMN(EW107:FR107))), 1, \"\")",
    "D108": "IF(SUM(FT107:GP107),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F108)),\"Card Mastery\",F108),G108)/$D$5,\"\")",
    "F108": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT107:GP107),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT107:GP107=1)),)\"),\"Attack Speed\")",
    "G108": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT107:GP107),ARRAYFORMULA(FILTER(BT107:CP107 , FT107:GP107=1)),\"\"\"\")\"),24.0)",
    "I108": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT107:GP107),ARRAYFORMULA(FILTER(EW107:FS107 , FT107:GP107=1))*D$5,\"\"\"\")\"),0.008535090546839385)",
    "K108": "IF(H108<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D108)),)",
    "BT108": "BT107+FT107",
    "BU108": "BU107+FU107",
    "BV108": "BV107+FV107",
    "BW108": "BW107+FW107",
    "BX108": "BX107+FX107",
    "BY108": "BY107+FY107",
    "BZ108": "BZ107+FZ107",
    "CA108": "CA107+GA107",
    "CB108": "CB107+GB107",
    "CC108": "CC107+GC107",
    "CD108": "CD107+GD107",
    "CE108": "CE107+GE107",
    "CF108": "CF107+GF107",
    "CG108": "CG107+GG107",
    "CH108": "CH107+GH107",
    "CI108": "CI107+GI107",
    "CJ108": "CJ107+GJ107",
    "CK108": "CK107+GK107",
    "CL108": "CL107+GL107",
    "CM108": "CM107+GM107",
    "CN108": "CN107+GN107",
    "CO108": "CO107+GO107",
    "CS108": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI108,1)",
    "CT108": "INDEX($BD$5:$BD253,BT108)",
    "CU108": "INDEX($BN$5:$BN253,CD108)",
    "CV108": "INDEX($BO$5:$BO253,CE108)",
    "CW108": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG108)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX108": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO108, 1)",
    "CY108": "LET(\n  Base, $CR$6,\n  Damage, $CT108,\n  DamageMastery, $CS108,\n  DemonMastery, $CX108,\n  SPB, $CU108,\n  ITO, $CV108,\n  Shock, $CW108,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ108": "MIN(100%, DA108)",
    "DA108": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK108*1%, 0)",
    "DB108": "LET(\n  Lab, 1+INDEX($BF$5:$BF253,BV108),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC108": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK108*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI253,BY108) + CardCritMastery)",
    "DD108": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK108*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ253,BZ108) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE108": "LET(\n  CF, $DB108,\n  CC, $CZ108,\n  SCM, $DD108,\n  SCC, $DC108,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF108": "LET(\n  CF, $DB108,\n  CC, $DA108,\n  SCM, $DD108,\n  SCC, $DC108,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG108": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH108)), 0)",
    "DH108": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ108*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE253,BU108),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI108": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG253, BW108), 1) + $AE$9)",
    "DJ108": "LET(\n  DpmLab, INDEX($BH$5:$BH253,BX108),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL108, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK108": "(1+$DI108*$DJ108*$AQ$9)",
    "DL108": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK253,CA108),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM108*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM108": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK253,CA108),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM108*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN108": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL253,CB108)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO108": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH108,\n  Rapid, DG108,\n  RDPM, DK108,\n  SuperTower, $DL108,\n  Rend, $DN108,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP108": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ108": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK108),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR108": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP108),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF108-1))",
    "DS108": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG108, DH108),0))",
    "DT108": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP108),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV108, $AR$29), 0))",
    "DU108": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK108),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM253,CC108), $DV108, $AR$29), 0))",
    "DV108": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH108), $AO$29)",
    "DW108": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM108,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108, $DB108), 1),\n\n  DW, $DR108,\n  CL, $DS108,\n  SM, $DT108,\n  SLM, $DU108,\n  SL, $DQ108,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX108": "CY108*(DE108*DO108*DQ108+DW108*DF108)",
    "DZ108": "IF(INDEX($BD$6:$BD253,BT108)=\"\", \"\", INDEX($BD$5:$BD253,BT108+1))",
    "EA108": "IF(OR($AO$25, INDEX($BE$6:$BE253,BU108)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ108)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE253,BU108+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI108*$DJ108*$AQ$9),\n  SuperTower, $DL108,\n  Rend, $DN108,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108, $DB108), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR108,\n  SM, $DT108,\n  SLM, $DU108,\n  SL, $DQ108,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM108, UltCritCard),\n\nCY108*(DE108*OtherDamage*SL+UwDamage*DF108)))",
    "EB108": "IF(INDEX($BF$6:$BF253,BV108)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF253,BV108+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ108,\n  CCUW, $DA108,\n  SCM, $DD108,\n  SCC, $DC108,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108, CF), 1),\n\n  DW, $DR108,\n  CL, $DS108,\n  SM, $DT108,\n  SLM, $DU108,\n  SL, $DQ108,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM108, UltCritCard),\n\nCY108 * (Critical * DO108 * SL + UwDamage * UWCritical)))",
    "EC108": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG253,BW108)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH108,\n  Rapid, DG108,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG253, BW108+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ108*$AQ$9),\n  SuperTower, $DL108,\n  Rend, $DN108,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM253,CC108), $DV108, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM108,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108, $DB108), 1),\n\n  DW, $DR108,\n  CL, $DS108,\n  SM, $DT108,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY108*(DE108*OtherDamage*SL+UWDamage*DF108)))",
    "ED108": "IF(OR($AO$25, INDEX($BH$6:$BH253,BX108)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH253,BX108+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL108, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI108*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM253,CC108), $DV108, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH108,\n  Rapid, DG108,\n  SuperTower, $DL108,\n  Rend, $DN108,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM108,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108, $DB108), 1),\n\n  DW, $DR108,\n  CL, $DS108,\n  SM, $DT108,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY108*(DE108*OtherDamage*SL+UWDamage*DF108)))",
    "EE108": "IF(INDEX($BI$6:$BI253,BY108)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK108, 0),\n  CF, $DB108,\n  CC, $CZ108,\n  CCUW, $DA108,\n  SCM, $DD108,\n  SCC, $AV$17+INDEX($BI$5:$BI253,BY108+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY108 * (Critical*DO108*$DQ108+DW108*UWCritical)))",
    "EF108": "IF(INDEX($BJ$6:$BJ253,BZ108)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK108*1%, 1),\n  CF, $DB108,\n  CC, $CZ108,\n  CCUW, $DA108,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ253,BZ108+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC108,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY108*(Critical*DO108*$DQ108+DW108*UWCritical)))",
    "EG108": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK253,CA108)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH108,\n  Rapid, DG108,\n  DPM, (1+$DI108*$DJ108*$AQ$9),\n  Rend, $DN108,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK253,CA108+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM108*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108, $DB108), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK253,CA108+1)-1))/(45-CM108*3),1),\n\n  SL, $DQ108,\n  DW, $DR108,\n  CL, $DS108,\n  SM, $DT108,\n  SLM, $DU108,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY108*(DE108*OtherDamage*SL+UwDamage*DF108)))",
    "EH108": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL253,CB108+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL253,CB108)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH108,\n  Rapid, DG108,\n  DPM, (1+$DI108*$DJ108*$AQ$9),\n  SuperTower, $DL108,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL253,CB108+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY108*(DE108*OtherDamage*$DQ108+DW108*DF108)))",
    "EI108": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM253,CC108)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108, $DB108), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK108),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV108, $AR$29), 0),\n\n  DW, $DR108,\n  CL, $DS108,\n  SM, $DT108,\n  SL, $DQ108,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM108, UltCritCard),\nCY108*(DE108*DO108*SL+UwDamage*DF108)))",
    "EJ108": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN253,CD108)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT108,\n  DamageMastery, $CS108,\n  DemonMastery, $CX108,\n  SPB, INDEX($BN$5:$BN253,CD108+1),\n  ITO, $CV108,\n  Shock, $CW108,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE108*DO108*$DQ108+DW108*DF108)))",
    "EK108": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO253,CE108)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT108,\n  DamageMastery, $CS108,\n  DemonMastery, $CX108,\n  SPB, $CU108,\n  ITO, INDEX($BO$5:$BO253,CE108+1),\n  Shock, $CW108,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE108*DO108*$DQ108+DW108*DF108)))",
    "EL108": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP253,CF108)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108, $DB108), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP108),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF108),\n  CL, $DS108,\n  SM, $DT108,\n  SLM, $DU108,\n  SL, $DQ108,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM108, UltCritCard),\nCY108*(DE108*DO108*SL+UwDamage*DF108)))",
    "EM108": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ253,CG108)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG108+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN108": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR253,CH108)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108, $DB108), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH108+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP108),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK108),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM253,CC108), SMHeat, $AR$29), 0),\n\n  DW, $DR108,\n  CL, $DS108,\n  SL, $DQ108,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM108, UltCritCard),\nCY108*(DE108*DO108*SL+UwDamage*DF108)))",
    "EO108": "IF(OR(CI108 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI108+1))",
    "EP108": "IF(OR($AO$25, CJ108 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ108+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE252,BU108),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL108, 1),\n  DPM, (1+$DI108*CardRangeMastery*$DJ108*$AQ$9),\n  SuperTower, $DL108,\n  Rend, $DN108,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108, $DB108), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR108,\n  SM, $DT108,\n  SLM, $DU108,\n  SL, $DQ108,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM108, UltCritCard),\n\nCY108*(DE108*OtherDamage*SL+UwDamage*DF108)))",
    "EQ108": "IF(OR(CK108 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK108+1)*1%, 1),\n  CF, $DB108,\n  CC, MIN(100%, $CZ108 + 1%),\n  CCUW, DA108 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ253,BZ108) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC108 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR108,\n  CL, $DS108,\n  SM, $DT108,\n  SLM, $DU108,\n  SL, $DQ108,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM108, UltCritCard),\n\nCY108 * (Critical*DO108*SL+UwDamage*UWCritical)))",
    "ER108": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL108 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH253,BX108),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL108+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI108*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM253,CC108), $DV108, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH108,\n  Rapid, DG108,\n  SuperTower, $DL108,\n  Rend, $DN108,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM108,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108, $DB108), 1),\n\n  DW, $DR108,\n  CL, $DS108,\n  SM, $DT108,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY108*(DE108*OtherDamage*SL+UWDamage*DF108)))",
    "ES108": "IF(OR(CM108 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH108,\n  Rapid, DG108,\n  RDPM, (1+$DI108*$DJ108*$AQ$9),\n  Rend, $DN108,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK253,CA108),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM108+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108, $DB108), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR108,\n  CL, $DS108,\n  SM, $DT108,\n  SLM, $DU108,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY108*(DE108*OtherDamage*SL+UwDamage*DF108)))",
    "ET108": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN108 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM108,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN108+1, $DB108), 1),\n\n  DW, $DR108,\n  CL, $DS108,\n  SM, $DT108,\n  SLM, $DU108,\n  SL, $DQ108,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY108*(DE108*DO108*SL+UWDamage*DF108)))",
    "EU108": "IF(OR(NOT($BA$3), NOT($BA$23), $CO108 > $BA$15), \"\", 1 + 0.5*(CO108+1))",
    "EW108": "IF(DZ108=\"\", \"\", LET(\n  Now, CT108,\n  Next, DZ108,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT108),\nFactor/Cost))",
    "EX108": "IF(EA108=\"\",\"\",(EA108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU108))",
    "EY108": "IF(EB108=\"\",\"\",(EB108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV108))",
    "EZ108": "IF(EC108=\"\",\"\",(EC108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW108))",
    "FA108": "IF(ED108=\"\",\"\",(ED108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX108))",
    "FB108": "IF(EE108=\"\",\"\",(EE108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY108))",
    "FC108": "IF(EF108=\"\",\"\",(EF108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ108))",
    "FD108": "IF(EG108=\"\",\"\",(EG108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA108))",
    "FE108": "IF(EH108=\"\",\"\",(EH108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB108))",
    "FF108": "IF(EI108=\"\",\"\",(EI108/$DX108-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC108+1, 1, CC108))))",
    "FG108": "IF(EJ108=\"\",\"\",(EJ108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD108))",
    "FH108": "IF(EK108=\"\",\"\",(EK108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE108))",
    "FI108": "IF(EL108=\"\",\"\",(EL108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF108))",
    "FJ108": "IF(EM108=\"\", \"\", LET(\n  Now, CW108,\n  Next, EM108,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG108),\nFactor/Cost))",
    "FK108": "IF(EN108=\"\",\"\",(EN108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH108))",
    "FL108": "IF(EO108=\"\", \"\", LET(\n  Now, CS108,\n  Next, EO108,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI108),\nFactor/Cost))",
    "FM108": "IF(EP108=\"\",\"\",(EP108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ108))",
    "FN108": "IF(EQ108=\"\",\"\",(EQ108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK108))",
    "FO108": "IF(ER108=\"\",\"\",(ER108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL108))",
    "FP108": "IF(ES108=\"\",\"\",(ES108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM108))",
    "FQ108": "IF(ET108=\"\",\"\",(ET108/$DX108-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN108))",
    "FR108": "IF(EU108=\"\", \"\", LET(\n  Now, CX108,\n  Next, EU108,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO108),\nFactor/Cost))",
    "FT108": "IF(COLUMN(EW108:FR108) = MIN(IF(EW108:FR108=MAX(EW108:FR108), COLUMN(EW108:FR108))), 1, \"\")",
    "D109": "IF(SUM(FT108:GP108),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F109)),\"Card Mastery\",F109),G109)/$D$5,\"\")",
    "F109": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT108:GP108),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT108:GP108=1)),)\"),\"Super Tower Bonus\")",
    "G109": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT108:GP108),ARRAYFORMULA(FILTER(BT108:CP108 , FT108:GP108=1)),\"\"\"\")\"),5.0)",
    "I109": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT108:GP108),ARRAYFORMULA(FILTER(EW108:FS108 , FT108:GP108=1))*D$5,\"\"\"\")\"),0.008163488322735451)",
    "K109": "IF(H109<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D109)),)",
    "BT109": "BT108+FT108",
    "BU109": "BU108+FU108",
    "BV109": "BV108+FV108",
    "BW109": "BW108+FW108",
    "BX109": "BX108+FX108",
    "BY109": "BY108+FY108",
    "BZ109": "BZ108+FZ108",
    "CA109": "CA108+GA108",
    "CB109": "CB108+GB108",
    "CC109": "CC108+GC108",
    "CD109": "CD108+GD108",
    "CE109": "CE108+GE108",
    "CF109": "CF108+GF108",
    "CG109": "CG108+GG108",
    "CH109": "CH108+GH108",
    "CI109": "CI108+GI108",
    "CJ109": "CJ108+GJ108",
    "CK109": "CK108+GK108",
    "CL109": "CL108+GL108",
    "CM109": "CM108+GM108",
    "CN109": "CN108+GN108",
    "CO109": "CO108+GO108",
    "CS109": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI109,1)",
    "CT109": "INDEX($BD$5:$BD254,BT109)",
    "CU109": "INDEX($BN$5:$BN254,CD109)",
    "CV109": "INDEX($BO$5:$BO254,CE109)",
    "CW109": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG109)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX109": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO109, 1)",
    "CY109": "LET(\n  Base, $CR$6,\n  Damage, $CT109,\n  DamageMastery, $CS109,\n  DemonMastery, $CX109,\n  SPB, $CU109,\n  ITO, $CV109,\n  Shock, $CW109,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ109": "MIN(100%, DA109)",
    "DA109": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK109*1%, 0)",
    "DB109": "LET(\n  Lab, 1+INDEX($BF$5:$BF254,BV109),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC109": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK109*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI254,BY109) + CardCritMastery)",
    "DD109": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK109*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ254,BZ109) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE109": "LET(\n  CF, $DB109,\n  CC, $CZ109,\n  SCM, $DD109,\n  SCC, $DC109,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF109": "LET(\n  CF, $DB109,\n  CC, $DA109,\n  SCM, $DD109,\n  SCC, $DC109,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG109": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH109)), 0)",
    "DH109": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ109*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE254,BU109),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI109": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG254, BW109), 1) + $AE$9)",
    "DJ109": "LET(\n  DpmLab, INDEX($BH$5:$BH254,BX109),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL109, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK109": "(1+$DI109*$DJ109*$AQ$9)",
    "DL109": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK254,CA109),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM109*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM109": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK254,CA109),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM109*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN109": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL254,CB109)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO109": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH109,\n  Rapid, DG109,\n  RDPM, DK109,\n  SuperTower, $DL109,\n  Rend, $DN109,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP109": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ109": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK109),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR109": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP109),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF109-1))",
    "DS109": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG109, DH109),0))",
    "DT109": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP109),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV109, $AR$29), 0))",
    "DU109": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK109),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM254,CC109), $DV109, $AR$29), 0))",
    "DV109": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH109), $AO$29)",
    "DW109": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM109,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109, $DB109), 1),\n\n  DW, $DR109,\n  CL, $DS109,\n  SM, $DT109,\n  SLM, $DU109,\n  SL, $DQ109,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX109": "CY109*(DE109*DO109*DQ109+DW109*DF109)",
    "DZ109": "IF(INDEX($BD$6:$BD254,BT109)=\"\", \"\", INDEX($BD$5:$BD254,BT109+1))",
    "EA109": "IF(OR($AO$25, INDEX($BE$6:$BE254,BU109)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ109)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE254,BU109+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI109*$DJ109*$AQ$9),\n  SuperTower, $DL109,\n  Rend, $DN109,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109, $DB109), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR109,\n  SM, $DT109,\n  SLM, $DU109,\n  SL, $DQ109,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM109, UltCritCard),\n\nCY109*(DE109*OtherDamage*SL+UwDamage*DF109)))",
    "EB109": "IF(INDEX($BF$6:$BF254,BV109)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF254,BV109+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ109,\n  CCUW, $DA109,\n  SCM, $DD109,\n  SCC, $DC109,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109, CF), 1),\n\n  DW, $DR109,\n  CL, $DS109,\n  SM, $DT109,\n  SLM, $DU109,\n  SL, $DQ109,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM109, UltCritCard),\n\nCY109 * (Critical * DO109 * SL + UwDamage * UWCritical)))",
    "EC109": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG254,BW109)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH109,\n  Rapid, DG109,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG254, BW109+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ109*$AQ$9),\n  SuperTower, $DL109,\n  Rend, $DN109,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM254,CC109), $DV109, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM109,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109, $DB109), 1),\n\n  DW, $DR109,\n  CL, $DS109,\n  SM, $DT109,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY109*(DE109*OtherDamage*SL+UWDamage*DF109)))",
    "ED109": "IF(OR($AO$25, INDEX($BH$6:$BH254,BX109)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH254,BX109+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL109, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI109*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM254,CC109), $DV109, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH109,\n  Rapid, DG109,\n  SuperTower, $DL109,\n  Rend, $DN109,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM109,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109, $DB109), 1),\n\n  DW, $DR109,\n  CL, $DS109,\n  SM, $DT109,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY109*(DE109*OtherDamage*SL+UWDamage*DF109)))",
    "EE109": "IF(INDEX($BI$6:$BI254,BY109)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK109, 0),\n  CF, $DB109,\n  CC, $CZ109,\n  CCUW, $DA109,\n  SCM, $DD109,\n  SCC, $AV$17+INDEX($BI$5:$BI254,BY109+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY109 * (Critical*DO109*$DQ109+DW109*UWCritical)))",
    "EF109": "IF(INDEX($BJ$6:$BJ254,BZ109)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK109*1%, 1),\n  CF, $DB109,\n  CC, $CZ109,\n  CCUW, $DA109,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ254,BZ109+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC109,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY109*(Critical*DO109*$DQ109+DW109*UWCritical)))",
    "EG109": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK254,CA109)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH109,\n  Rapid, DG109,\n  DPM, (1+$DI109*$DJ109*$AQ$9),\n  Rend, $DN109,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK254,CA109+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM109*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109, $DB109), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK254,CA109+1)-1))/(45-CM109*3),1),\n\n  SL, $DQ109,\n  DW, $DR109,\n  CL, $DS109,\n  SM, $DT109,\n  SLM, $DU109,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY109*(DE109*OtherDamage*SL+UwDamage*DF109)))",
    "EH109": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL254,CB109+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL254,CB109)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH109,\n  Rapid, DG109,\n  DPM, (1+$DI109*$DJ109*$AQ$9),\n  SuperTower, $DL109,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL254,CB109+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY109*(DE109*OtherDamage*$DQ109+DW109*DF109)))",
    "EI109": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM254,CC109)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109, $DB109), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK109),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV109, $AR$29), 0),\n\n  DW, $DR109,\n  CL, $DS109,\n  SM, $DT109,\n  SL, $DQ109,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM109, UltCritCard),\nCY109*(DE109*DO109*SL+UwDamage*DF109)))",
    "EJ109": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN254,CD109)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT109,\n  DamageMastery, $CS109,\n  DemonMastery, $CX109,\n  SPB, INDEX($BN$5:$BN254,CD109+1),\n  ITO, $CV109,\n  Shock, $CW109,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE109*DO109*$DQ109+DW109*DF109)))",
    "EK109": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO254,CE109)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT109,\n  DamageMastery, $CS109,\n  DemonMastery, $CX109,\n  SPB, $CU109,\n  ITO, INDEX($BO$5:$BO254,CE109+1),\n  Shock, $CW109,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE109*DO109*$DQ109+DW109*DF109)))",
    "EL109": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP254,CF109)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109, $DB109), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP109),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF109),\n  CL, $DS109,\n  SM, $DT109,\n  SLM, $DU109,\n  SL, $DQ109,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM109, UltCritCard),\nCY109*(DE109*DO109*SL+UwDamage*DF109)))",
    "EM109": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ254,CG109)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG109+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN109": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR254,CH109)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109, $DB109), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH109+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP109),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK109),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM254,CC109), SMHeat, $AR$29), 0),\n\n  DW, $DR109,\n  CL, $DS109,\n  SL, $DQ109,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM109, UltCritCard),\nCY109*(DE109*DO109*SL+UwDamage*DF109)))",
    "EO109": "IF(OR(CI109 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI109+1))",
    "EP109": "IF(OR($AO$25, CJ109 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ109+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE253,BU109),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL109, 1),\n  DPM, (1+$DI109*CardRangeMastery*$DJ109*$AQ$9),\n  SuperTower, $DL109,\n  Rend, $DN109,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109, $DB109), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR109,\n  SM, $DT109,\n  SLM, $DU109,\n  SL, $DQ109,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM109, UltCritCard),\n\nCY109*(DE109*OtherDamage*SL+UwDamage*DF109)))",
    "EQ109": "IF(OR(CK109 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK109+1)*1%, 1),\n  CF, $DB109,\n  CC, MIN(100%, $CZ109 + 1%),\n  CCUW, DA109 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ254,BZ109) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC109 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR109,\n  CL, $DS109,\n  SM, $DT109,\n  SLM, $DU109,\n  SL, $DQ109,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM109, UltCritCard),\n\nCY109 * (Critical*DO109*SL+UwDamage*UWCritical)))",
    "ER109": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL109 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH254,BX109),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL109+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI109*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM254,CC109), $DV109, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH109,\n  Rapid, DG109,\n  SuperTower, $DL109,\n  Rend, $DN109,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM109,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109, $DB109), 1),\n\n  DW, $DR109,\n  CL, $DS109,\n  SM, $DT109,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY109*(DE109*OtherDamage*SL+UWDamage*DF109)))",
    "ES109": "IF(OR(CM109 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH109,\n  Rapid, DG109,\n  RDPM, (1+$DI109*$DJ109*$AQ$9),\n  Rend, $DN109,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK254,CA109),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM109+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109, $DB109), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR109,\n  CL, $DS109,\n  SM, $DT109,\n  SLM, $DU109,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY109*(DE109*OtherDamage*SL+UwDamage*DF109)))",
    "ET109": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN109 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM109,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN109+1, $DB109), 1),\n\n  DW, $DR109,\n  CL, $DS109,\n  SM, $DT109,\n  SLM, $DU109,\n  SL, $DQ109,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY109*(DE109*DO109*SL+UWDamage*DF109)))",
    "EU109": "IF(OR(NOT($BA$3), NOT($BA$23), $CO109 > $BA$15), \"\", 1 + 0.5*(CO109+1))",
    "EW109": "IF(DZ109=\"\", \"\", LET(\n  Now, CT109,\n  Next, DZ109,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT109),\nFactor/Cost))",
    "EX109": "IF(EA109=\"\",\"\",(EA109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU109))",
    "EY109": "IF(EB109=\"\",\"\",(EB109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV109))",
    "EZ109": "IF(EC109=\"\",\"\",(EC109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW109))",
    "FA109": "IF(ED109=\"\",\"\",(ED109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX109))",
    "FB109": "IF(EE109=\"\",\"\",(EE109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY109))",
    "FC109": "IF(EF109=\"\",\"\",(EF109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ109))",
    "FD109": "IF(EG109=\"\",\"\",(EG109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA109))",
    "FE109": "IF(EH109=\"\",\"\",(EH109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB109))",
    "FF109": "IF(EI109=\"\",\"\",(EI109/$DX109-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC109+1, 1, CC109))))",
    "FG109": "IF(EJ109=\"\",\"\",(EJ109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD109))",
    "FH109": "IF(EK109=\"\",\"\",(EK109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE109))",
    "FI109": "IF(EL109=\"\",\"\",(EL109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF109))",
    "FJ109": "IF(EM109=\"\", \"\", LET(\n  Now, CW109,\n  Next, EM109,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG109),\nFactor/Cost))",
    "FK109": "IF(EN109=\"\",\"\",(EN109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH109))",
    "FL109": "IF(EO109=\"\", \"\", LET(\n  Now, CS109,\n  Next, EO109,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI109),\nFactor/Cost))",
    "FM109": "IF(EP109=\"\",\"\",(EP109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ109))",
    "FN109": "IF(EQ109=\"\",\"\",(EQ109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK109))",
    "FO109": "IF(ER109=\"\",\"\",(ER109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL109))",
    "FP109": "IF(ES109=\"\",\"\",(ES109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM109))",
    "FQ109": "IF(ET109=\"\",\"\",(ET109/$DX109-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN109))",
    "FR109": "IF(EU109=\"\", \"\", LET(\n  Now, CX109,\n  Next, EU109,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO109),\nFactor/Cost))",
    "FT109": "IF(COLUMN(EW109:FR109) = MIN(IF(EW109:FR109=MAX(EW109:FR109), COLUMN(EW109:FR109))), 1, \"\")",
    "D110": "IF(SUM(FT109:GP109),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F110)),\"Card Mastery\",F110),G110)/$D$5,\"\")",
    "F110": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT109:GP109),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT109:GP109=1)),)\"),\"Critical Factor\")",
    "G110": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT109:GP109),ARRAYFORMULA(FILTER(BT109:CP109 , FT109:GP109=1)),\"\"\"\")\"),27.0)",
    "I110": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT109:GP109),ARRAYFORMULA(FILTER(EW109:FS109 , FT109:GP109=1))*D$5,\"\"\"\")\"),0.008063930765442562)",
    "K110": "IF(H110<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D110)),)",
    "BT110": "BT109+FT109",
    "BU110": "BU109+FU109",
    "BV110": "BV109+FV109",
    "BW110": "BW109+FW109",
    "BX110": "BX109+FX109",
    "BY110": "BY109+FY109",
    "BZ110": "BZ109+FZ109",
    "CA110": "CA109+GA109",
    "CB110": "CB109+GB109",
    "CC110": "CC109+GC109",
    "CD110": "CD109+GD109",
    "CE110": "CE109+GE109",
    "CF110": "CF109+GF109",
    "CG110": "CG109+GG109",
    "CH110": "CH109+GH109",
    "CI110": "CI109+GI109",
    "CJ110": "CJ109+GJ109",
    "CK110": "CK109+GK109",
    "CL110": "CL109+GL109",
    "CM110": "CM109+GM109",
    "CN110": "CN109+GN109",
    "CO110": "CO109+GO109",
    "CS110": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI110,1)",
    "CT110": "INDEX($BD$5:$BD255,BT110)",
    "CU110": "INDEX($BN$5:$BN255,CD110)",
    "CV110": "INDEX($BO$5:$BO255,CE110)",
    "CW110": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG110)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX110": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO110, 1)",
    "CY110": "LET(\n  Base, $CR$6,\n  Damage, $CT110,\n  DamageMastery, $CS110,\n  DemonMastery, $CX110,\n  SPB, $CU110,\n  ITO, $CV110,\n  Shock, $CW110,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ110": "MIN(100%, DA110)",
    "DA110": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK110*1%, 0)",
    "DB110": "LET(\n  Lab, 1+INDEX($BF$5:$BF255,BV110),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC110": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK110*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI255,BY110) + CardCritMastery)",
    "DD110": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK110*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ255,BZ110) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE110": "LET(\n  CF, $DB110,\n  CC, $CZ110,\n  SCM, $DD110,\n  SCC, $DC110,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF110": "LET(\n  CF, $DB110,\n  CC, $DA110,\n  SCM, $DD110,\n  SCC, $DC110,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG110": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH110)), 0)",
    "DH110": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ110*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE255,BU110),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI110": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG255, BW110), 1) + $AE$9)",
    "DJ110": "LET(\n  DpmLab, INDEX($BH$5:$BH255,BX110),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL110, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK110": "(1+$DI110*$DJ110*$AQ$9)",
    "DL110": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK255,CA110),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM110*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM110": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK255,CA110),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM110*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN110": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL255,CB110)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO110": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH110,\n  Rapid, DG110,\n  RDPM, DK110,\n  SuperTower, $DL110,\n  Rend, $DN110,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP110": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ110": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK110),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR110": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP110),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF110-1))",
    "DS110": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG110, DH110),0))",
    "DT110": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP110),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV110, $AR$29), 0))",
    "DU110": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK110),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM255,CC110), $DV110, $AR$29), 0))",
    "DV110": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH110), $AO$29)",
    "DW110": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM110,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110, $DB110), 1),\n\n  DW, $DR110,\n  CL, $DS110,\n  SM, $DT110,\n  SLM, $DU110,\n  SL, $DQ110,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX110": "CY110*(DE110*DO110*DQ110+DW110*DF110)",
    "DZ110": "IF(INDEX($BD$6:$BD255,BT110)=\"\", \"\", INDEX($BD$5:$BD255,BT110+1))",
    "EA110": "IF(OR($AO$25, INDEX($BE$6:$BE255,BU110)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ110)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE255,BU110+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI110*$DJ110*$AQ$9),\n  SuperTower, $DL110,\n  Rend, $DN110,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110, $DB110), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR110,\n  SM, $DT110,\n  SLM, $DU110,\n  SL, $DQ110,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM110, UltCritCard),\n\nCY110*(DE110*OtherDamage*SL+UwDamage*DF110)))",
    "EB110": "IF(INDEX($BF$6:$BF255,BV110)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF255,BV110+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ110,\n  CCUW, $DA110,\n  SCM, $DD110,\n  SCC, $DC110,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110, CF), 1),\n\n  DW, $DR110,\n  CL, $DS110,\n  SM, $DT110,\n  SLM, $DU110,\n  SL, $DQ110,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM110, UltCritCard),\n\nCY110 * (Critical * DO110 * SL + UwDamage * UWCritical)))",
    "EC110": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG255,BW110)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH110,\n  Rapid, DG110,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG255, BW110+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ110*$AQ$9),\n  SuperTower, $DL110,\n  Rend, $DN110,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM255,CC110), $DV110, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM110,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110, $DB110), 1),\n\n  DW, $DR110,\n  CL, $DS110,\n  SM, $DT110,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY110*(DE110*OtherDamage*SL+UWDamage*DF110)))",
    "ED110": "IF(OR($AO$25, INDEX($BH$6:$BH255,BX110)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH255,BX110+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL110, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI110*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM255,CC110), $DV110, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH110,\n  Rapid, DG110,\n  SuperTower, $DL110,\n  Rend, $DN110,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM110,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110, $DB110), 1),\n\n  DW, $DR110,\n  CL, $DS110,\n  SM, $DT110,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY110*(DE110*OtherDamage*SL+UWDamage*DF110)))",
    "EE110": "IF(INDEX($BI$6:$BI255,BY110)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK110, 0),\n  CF, $DB110,\n  CC, $CZ110,\n  CCUW, $DA110,\n  SCM, $DD110,\n  SCC, $AV$17+INDEX($BI$5:$BI255,BY110+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY110 * (Critical*DO110*$DQ110+DW110*UWCritical)))",
    "EF110": "IF(INDEX($BJ$6:$BJ255,BZ110)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK110*1%, 1),\n  CF, $DB110,\n  CC, $CZ110,\n  CCUW, $DA110,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ255,BZ110+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC110,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY110*(Critical*DO110*$DQ110+DW110*UWCritical)))",
    "EG110": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK255,CA110)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH110,\n  Rapid, DG110,\n  DPM, (1+$DI110*$DJ110*$AQ$9),\n  Rend, $DN110,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK255,CA110+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM110*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110, $DB110), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK255,CA110+1)-1))/(45-CM110*3),1),\n\n  SL, $DQ110,\n  DW, $DR110,\n  CL, $DS110,\n  SM, $DT110,\n  SLM, $DU110,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY110*(DE110*OtherDamage*SL+UwDamage*DF110)))",
    "EH110": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL255,CB110+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL255,CB110)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH110,\n  Rapid, DG110,\n  DPM, (1+$DI110*$DJ110*$AQ$9),\n  SuperTower, $DL110,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL255,CB110+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY110*(DE110*OtherDamage*$DQ110+DW110*DF110)))",
    "EI110": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM255,CC110)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110, $DB110), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK110),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV110, $AR$29), 0),\n\n  DW, $DR110,\n  CL, $DS110,\n  SM, $DT110,\n  SL, $DQ110,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM110, UltCritCard),\nCY110*(DE110*DO110*SL+UwDamage*DF110)))",
    "EJ110": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN255,CD110)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT110,\n  DamageMastery, $CS110,\n  DemonMastery, $CX110,\n  SPB, INDEX($BN$5:$BN255,CD110+1),\n  ITO, $CV110,\n  Shock, $CW110,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE110*DO110*$DQ110+DW110*DF110)))",
    "EK110": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO255,CE110)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT110,\n  DamageMastery, $CS110,\n  DemonMastery, $CX110,\n  SPB, $CU110,\n  ITO, INDEX($BO$5:$BO255,CE110+1),\n  Shock, $CW110,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE110*DO110*$DQ110+DW110*DF110)))",
    "EL110": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP255,CF110)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110, $DB110), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP110),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF110),\n  CL, $DS110,\n  SM, $DT110,\n  SLM, $DU110,\n  SL, $DQ110,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM110, UltCritCard),\nCY110*(DE110*DO110*SL+UwDamage*DF110)))",
    "EM110": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ255,CG110)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG110+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN110": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR255,CH110)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110, $DB110), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH110+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP110),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK110),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM255,CC110), SMHeat, $AR$29), 0),\n\n  DW, $DR110,\n  CL, $DS110,\n  SL, $DQ110,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM110, UltCritCard),\nCY110*(DE110*DO110*SL+UwDamage*DF110)))",
    "EO110": "IF(OR(CI110 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI110+1))",
    "EP110": "IF(OR($AO$25, CJ110 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ110+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE254,BU110),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL110, 1),\n  DPM, (1+$DI110*CardRangeMastery*$DJ110*$AQ$9),\n  SuperTower, $DL110,\n  Rend, $DN110,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110, $DB110), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR110,\n  SM, $DT110,\n  SLM, $DU110,\n  SL, $DQ110,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM110, UltCritCard),\n\nCY110*(DE110*OtherDamage*SL+UwDamage*DF110)))",
    "EQ110": "IF(OR(CK110 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK110+1)*1%, 1),\n  CF, $DB110,\n  CC, MIN(100%, $CZ110 + 1%),\n  CCUW, DA110 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ255,BZ110) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC110 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR110,\n  CL, $DS110,\n  SM, $DT110,\n  SLM, $DU110,\n  SL, $DQ110,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM110, UltCritCard),\n\nCY110 * (Critical*DO110*SL+UwDamage*UWCritical)))",
    "ER110": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL110 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH255,BX110),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL110+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI110*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM255,CC110), $DV110, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH110,\n  Rapid, DG110,\n  SuperTower, $DL110,\n  Rend, $DN110,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM110,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110, $DB110), 1),\n\n  DW, $DR110,\n  CL, $DS110,\n  SM, $DT110,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY110*(DE110*OtherDamage*SL+UWDamage*DF110)))",
    "ES110": "IF(OR(CM110 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH110,\n  Rapid, DG110,\n  RDPM, (1+$DI110*$DJ110*$AQ$9),\n  Rend, $DN110,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK255,CA110),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM110+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110, $DB110), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR110,\n  CL, $DS110,\n  SM, $DT110,\n  SLM, $DU110,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY110*(DE110*OtherDamage*SL+UwDamage*DF110)))",
    "ET110": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN110 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM110,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN110+1, $DB110), 1),\n\n  DW, $DR110,\n  CL, $DS110,\n  SM, $DT110,\n  SLM, $DU110,\n  SL, $DQ110,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY110*(DE110*DO110*SL+UWDamage*DF110)))",
    "EU110": "IF(OR(NOT($BA$3), NOT($BA$23), $CO110 > $BA$15), \"\", 1 + 0.5*(CO110+1))",
    "EW110": "IF(DZ110=\"\", \"\", LET(\n  Now, CT110,\n  Next, DZ110,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT110),\nFactor/Cost))",
    "EX110": "IF(EA110=\"\",\"\",(EA110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU110))",
    "EY110": "IF(EB110=\"\",\"\",(EB110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV110))",
    "EZ110": "IF(EC110=\"\",\"\",(EC110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW110))",
    "FA110": "IF(ED110=\"\",\"\",(ED110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX110))",
    "FB110": "IF(EE110=\"\",\"\",(EE110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY110))",
    "FC110": "IF(EF110=\"\",\"\",(EF110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ110))",
    "FD110": "IF(EG110=\"\",\"\",(EG110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA110))",
    "FE110": "IF(EH110=\"\",\"\",(EH110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB110))",
    "FF110": "IF(EI110=\"\",\"\",(EI110/$DX110-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC110+1, 1, CC110))))",
    "FG110": "IF(EJ110=\"\",\"\",(EJ110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD110))",
    "FH110": "IF(EK110=\"\",\"\",(EK110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE110))",
    "FI110": "IF(EL110=\"\",\"\",(EL110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF110))",
    "FJ110": "IF(EM110=\"\", \"\", LET(\n  Now, CW110,\n  Next, EM110,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG110),\nFactor/Cost))",
    "FK110": "IF(EN110=\"\",\"\",(EN110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH110))",
    "FL110": "IF(EO110=\"\", \"\", LET(\n  Now, CS110,\n  Next, EO110,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI110),\nFactor/Cost))",
    "FM110": "IF(EP110=\"\",\"\",(EP110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ110))",
    "FN110": "IF(EQ110=\"\",\"\",(EQ110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK110))",
    "FO110": "IF(ER110=\"\",\"\",(ER110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL110))",
    "FP110": "IF(ES110=\"\",\"\",(ES110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM110))",
    "FQ110": "IF(ET110=\"\",\"\",(ET110/$DX110-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN110))",
    "FR110": "IF(EU110=\"\", \"\", LET(\n  Now, CX110,\n  Next, EU110,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO110),\nFactor/Cost))",
    "FT110": "IF(COLUMN(EW110:FR110) = MIN(IF(EW110:FR110=MAX(EW110:FR110), COLUMN(EW110:FR110))), 1, \"\")",
    "D111": "IF(SUM(FT110:GP110),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F111)),\"Card Mastery\",F111),G111)/$D$5,\"\")",
    "F111": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT110:GP110),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT110:GP110=1)),)\"),\"Damage\")",
    "G111": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT110:GP110),ARRAYFORMULA(FILTER(BT110:CP110 , FT110:GP110=1)),\"\"\"\")\"),25.0)",
    "I111": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT110:GP110),ARRAYFORMULA(FILTER(EW110:FS110 , FT110:GP110=1))*D$5,\"\"\"\")\"),0.007734284363855159)",
    "K111": "IF(H111<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D111)),)",
    "BT111": "BT110+FT110",
    "BU111": "BU110+FU110",
    "BV111": "BV110+FV110",
    "BW111": "BW110+FW110",
    "BX111": "BX110+FX110",
    "BY111": "BY110+FY110",
    "BZ111": "BZ110+FZ110",
    "CA111": "CA110+GA110",
    "CB111": "CB110+GB110",
    "CC111": "CC110+GC110",
    "CD111": "CD110+GD110",
    "CE111": "CE110+GE110",
    "CF111": "CF110+GF110",
    "CG111": "CG110+GG110",
    "CH111": "CH110+GH110",
    "CI111": "CI110+GI110",
    "CJ111": "CJ110+GJ110",
    "CK111": "CK110+GK110",
    "CL111": "CL110+GL110",
    "CM111": "CM110+GM110",
    "CN111": "CN110+GN110",
    "CO111": "CO110+GO110",
    "CS111": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI111,1)",
    "CT111": "INDEX($BD$5:$BD256,BT111)",
    "CU111": "INDEX($BN$5:$BN256,CD111)",
    "CV111": "INDEX($BO$5:$BO256,CE111)",
    "CW111": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG111)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX111": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO111, 1)",
    "CY111": "LET(\n  Base, $CR$6,\n  Damage, $CT111,\n  DamageMastery, $CS111,\n  DemonMastery, $CX111,\n  SPB, $CU111,\n  ITO, $CV111,\n  Shock, $CW111,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ111": "MIN(100%, DA111)",
    "DA111": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK111*1%, 0)",
    "DB111": "LET(\n  Lab, 1+INDEX($BF$5:$BF256,BV111),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC111": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK111*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI256,BY111) + CardCritMastery)",
    "DD111": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK111*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ256,BZ111) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE111": "LET(\n  CF, $DB111,\n  CC, $CZ111,\n  SCM, $DD111,\n  SCC, $DC111,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF111": "LET(\n  CF, $DB111,\n  CC, $DA111,\n  SCM, $DD111,\n  SCC, $DC111,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG111": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH111)), 0)",
    "DH111": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ111*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE256,BU111),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI111": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG256, BW111), 1) + $AE$9)",
    "DJ111": "LET(\n  DpmLab, INDEX($BH$5:$BH256,BX111),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL111, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK111": "(1+$DI111*$DJ111*$AQ$9)",
    "DL111": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK256,CA111),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM111*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM111": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK256,CA111),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM111*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN111": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL256,CB111)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO111": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH111,\n  Rapid, DG111,\n  RDPM, DK111,\n  SuperTower, $DL111,\n  Rend, $DN111,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP111": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ111": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK111),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR111": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP111),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF111-1))",
    "DS111": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG111, DH111),0))",
    "DT111": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP111),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV111, $AR$29), 0))",
    "DU111": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK111),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM256,CC111), $DV111, $AR$29), 0))",
    "DV111": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH111), $AO$29)",
    "DW111": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM111,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111, $DB111), 1),\n\n  DW, $DR111,\n  CL, $DS111,\n  SM, $DT111,\n  SLM, $DU111,\n  SL, $DQ111,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX111": "CY111*(DE111*DO111*DQ111+DW111*DF111)",
    "DZ111": "IF(INDEX($BD$6:$BD256,BT111)=\"\", \"\", INDEX($BD$5:$BD256,BT111+1))",
    "EA111": "IF(OR($AO$25, INDEX($BE$6:$BE256,BU111)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ111)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE256,BU111+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI111*$DJ111*$AQ$9),\n  SuperTower, $DL111,\n  Rend, $DN111,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111, $DB111), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR111,\n  SM, $DT111,\n  SLM, $DU111,\n  SL, $DQ111,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM111, UltCritCard),\n\nCY111*(DE111*OtherDamage*SL+UwDamage*DF111)))",
    "EB111": "IF(INDEX($BF$6:$BF256,BV111)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF256,BV111+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ111,\n  CCUW, $DA111,\n  SCM, $DD111,\n  SCC, $DC111,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111, CF), 1),\n\n  DW, $DR111,\n  CL, $DS111,\n  SM, $DT111,\n  SLM, $DU111,\n  SL, $DQ111,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM111, UltCritCard),\n\nCY111 * (Critical * DO111 * SL + UwDamage * UWCritical)))",
    "EC111": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG256,BW111)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH111,\n  Rapid, DG111,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG256, BW111+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ111*$AQ$9),\n  SuperTower, $DL111,\n  Rend, $DN111,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM256,CC111), $DV111, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM111,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111, $DB111), 1),\n\n  DW, $DR111,\n  CL, $DS111,\n  SM, $DT111,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY111*(DE111*OtherDamage*SL+UWDamage*DF111)))",
    "ED111": "IF(OR($AO$25, INDEX($BH$6:$BH256,BX111)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH256,BX111+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL111, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI111*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM256,CC111), $DV111, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH111,\n  Rapid, DG111,\n  SuperTower, $DL111,\n  Rend, $DN111,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM111,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111, $DB111), 1),\n\n  DW, $DR111,\n  CL, $DS111,\n  SM, $DT111,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY111*(DE111*OtherDamage*SL+UWDamage*DF111)))",
    "EE111": "IF(INDEX($BI$6:$BI256,BY111)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK111, 0),\n  CF, $DB111,\n  CC, $CZ111,\n  CCUW, $DA111,\n  SCM, $DD111,\n  SCC, $AV$17+INDEX($BI$5:$BI256,BY111+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY111 * (Critical*DO111*$DQ111+DW111*UWCritical)))",
    "EF111": "IF(INDEX($BJ$6:$BJ256,BZ111)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK111*1%, 1),\n  CF, $DB111,\n  CC, $CZ111,\n  CCUW, $DA111,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ256,BZ111+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC111,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY111*(Critical*DO111*$DQ111+DW111*UWCritical)))",
    "EG111": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK256,CA111)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH111,\n  Rapid, DG111,\n  DPM, (1+$DI111*$DJ111*$AQ$9),\n  Rend, $DN111,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK256,CA111+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM111*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111, $DB111), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK256,CA111+1)-1))/(45-CM111*3),1),\n\n  SL, $DQ111,\n  DW, $DR111,\n  CL, $DS111,\n  SM, $DT111,\n  SLM, $DU111,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY111*(DE111*OtherDamage*SL+UwDamage*DF111)))",
    "EH111": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL256,CB111+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL256,CB111)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH111,\n  Rapid, DG111,\n  DPM, (1+$DI111*$DJ111*$AQ$9),\n  SuperTower, $DL111,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL256,CB111+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY111*(DE111*OtherDamage*$DQ111+DW111*DF111)))",
    "EI111": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM256,CC111)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111, $DB111), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK111),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV111, $AR$29), 0),\n\n  DW, $DR111,\n  CL, $DS111,\n  SM, $DT111,\n  SL, $DQ111,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM111, UltCritCard),\nCY111*(DE111*DO111*SL+UwDamage*DF111)))",
    "EJ111": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN256,CD111)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT111,\n  DamageMastery, $CS111,\n  DemonMastery, $CX111,\n  SPB, INDEX($BN$5:$BN256,CD111+1),\n  ITO, $CV111,\n  Shock, $CW111,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE111*DO111*$DQ111+DW111*DF111)))",
    "EK111": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO256,CE111)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT111,\n  DamageMastery, $CS111,\n  DemonMastery, $CX111,\n  SPB, $CU111,\n  ITO, INDEX($BO$5:$BO256,CE111+1),\n  Shock, $CW111,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE111*DO111*$DQ111+DW111*DF111)))",
    "EL111": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP256,CF111)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111, $DB111), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP111),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF111),\n  CL, $DS111,\n  SM, $DT111,\n  SLM, $DU111,\n  SL, $DQ111,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM111, UltCritCard),\nCY111*(DE111*DO111*SL+UwDamage*DF111)))",
    "EM111": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ256,CG111)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG111+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN111": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR256,CH111)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111, $DB111), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH111+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP111),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK111),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM256,CC111), SMHeat, $AR$29), 0),\n\n  DW, $DR111,\n  CL, $DS111,\n  SL, $DQ111,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM111, UltCritCard),\nCY111*(DE111*DO111*SL+UwDamage*DF111)))",
    "EO111": "IF(OR(CI111 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI111+1))",
    "EP111": "IF(OR($AO$25, CJ111 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ111+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE255,BU111),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL111, 1),\n  DPM, (1+$DI111*CardRangeMastery*$DJ111*$AQ$9),\n  SuperTower, $DL111,\n  Rend, $DN111,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111, $DB111), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR111,\n  SM, $DT111,\n  SLM, $DU111,\n  SL, $DQ111,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM111, UltCritCard),\n\nCY111*(DE111*OtherDamage*SL+UwDamage*DF111)))",
    "EQ111": "IF(OR(CK111 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK111+1)*1%, 1),\n  CF, $DB111,\n  CC, MIN(100%, $CZ111 + 1%),\n  CCUW, DA111 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ256,BZ111) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC111 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR111,\n  CL, $DS111,\n  SM, $DT111,\n  SLM, $DU111,\n  SL, $DQ111,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM111, UltCritCard),\n\nCY111 * (Critical*DO111*SL+UwDamage*UWCritical)))",
    "ER111": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL111 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH256,BX111),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL111+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI111*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM256,CC111), $DV111, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH111,\n  Rapid, DG111,\n  SuperTower, $DL111,\n  Rend, $DN111,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM111,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111, $DB111), 1),\n\n  DW, $DR111,\n  CL, $DS111,\n  SM, $DT111,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY111*(DE111*OtherDamage*SL+UWDamage*DF111)))",
    "ES111": "IF(OR(CM111 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH111,\n  Rapid, DG111,\n  RDPM, (1+$DI111*$DJ111*$AQ$9),\n  Rend, $DN111,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK256,CA111),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM111+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111, $DB111), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR111,\n  CL, $DS111,\n  SM, $DT111,\n  SLM, $DU111,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY111*(DE111*OtherDamage*SL+UwDamage*DF111)))",
    "ET111": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN111 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM111,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN111+1, $DB111), 1),\n\n  DW, $DR111,\n  CL, $DS111,\n  SM, $DT111,\n  SLM, $DU111,\n  SL, $DQ111,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY111*(DE111*DO111*SL+UWDamage*DF111)))",
    "EU111": "IF(OR(NOT($BA$3), NOT($BA$23), $CO111 > $BA$15), \"\", 1 + 0.5*(CO111+1))",
    "EW111": "IF(DZ111=\"\", \"\", LET(\n  Now, CT111,\n  Next, DZ111,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT111),\nFactor/Cost))",
    "EX111": "IF(EA111=\"\",\"\",(EA111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU111))",
    "EY111": "IF(EB111=\"\",\"\",(EB111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV111))",
    "EZ111": "IF(EC111=\"\",\"\",(EC111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW111))",
    "FA111": "IF(ED111=\"\",\"\",(ED111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX111))",
    "FB111": "IF(EE111=\"\",\"\",(EE111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY111))",
    "FC111": "IF(EF111=\"\",\"\",(EF111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ111))",
    "FD111": "IF(EG111=\"\",\"\",(EG111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA111))",
    "FE111": "IF(EH111=\"\",\"\",(EH111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB111))",
    "FF111": "IF(EI111=\"\",\"\",(EI111/$DX111-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC111+1, 1, CC111))))",
    "FG111": "IF(EJ111=\"\",\"\",(EJ111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD111))",
    "FH111": "IF(EK111=\"\",\"\",(EK111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE111))",
    "FI111": "IF(EL111=\"\",\"\",(EL111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF111))",
    "FJ111": "IF(EM111=\"\", \"\", LET(\n  Now, CW111,\n  Next, EM111,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG111),\nFactor/Cost))",
    "FK111": "IF(EN111=\"\",\"\",(EN111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH111))",
    "FL111": "IF(EO111=\"\", \"\", LET(\n  Now, CS111,\n  Next, EO111,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI111),\nFactor/Cost))",
    "FM111": "IF(EP111=\"\",\"\",(EP111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ111))",
    "FN111": "IF(EQ111=\"\",\"\",(EQ111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK111))",
    "FO111": "IF(ER111=\"\",\"\",(ER111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL111))",
    "FP111": "IF(ES111=\"\",\"\",(ES111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM111))",
    "FQ111": "IF(ET111=\"\",\"\",(ET111/$DX111-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN111))",
    "FR111": "IF(EU111=\"\", \"\", LET(\n  Now, CX111,\n  Next, EU111,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO111),\nFactor/Cost))",
    "FT111": "IF(COLUMN(EW111:FR111) = MIN(IF(EW111:FR111=MAX(EW111:FR111), COLUMN(EW111:FR111))), 1, \"\")",
    "D112": "IF(SUM(FT111:GP111),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F112)),\"Card Mastery\",F112),G112)/$D$5,\"\")",
    "F112": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT111:GP111),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT111:GP111=1)),)\"),\"Attack Speed\")",
    "G112": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT111:GP111),ARRAYFORMULA(FILTER(BT111:CP111 , FT111:GP111=1)),\"\"\"\")\"),25.0)",
    "I112": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT111:GP111),ARRAYFORMULA(FILTER(EW111:FS111 , FT111:GP111=1))*D$5,\"\"\"\")\"),0.007614377663250969)",
    "K112": "IF(H112<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D112)),)",
    "BT112": "BT111+FT111",
    "BU112": "BU111+FU111",
    "BV112": "BV111+FV111",
    "BW112": "BW111+FW111",
    "BX112": "BX111+FX111",
    "BY112": "BY111+FY111",
    "BZ112": "BZ111+FZ111",
    "CA112": "CA111+GA111",
    "CB112": "CB111+GB111",
    "CC112": "CC111+GC111",
    "CD112": "CD111+GD111",
    "CE112": "CE111+GE111",
    "CF112": "CF111+GF111",
    "CG112": "CG111+GG111",
    "CH112": "CH111+GH111",
    "CI112": "CI111+GI111",
    "CJ112": "CJ111+GJ111",
    "CK112": "CK111+GK111",
    "CL112": "CL111+GL111",
    "CM112": "CM111+GM111",
    "CN112": "CN111+GN111",
    "CO112": "CO111+GO111",
    "CS112": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI112,1)",
    "CT112": "INDEX($BD$5:$BD257,BT112)",
    "CU112": "INDEX($BN$5:$BN257,CD112)",
    "CV112": "INDEX($BO$5:$BO257,CE112)",
    "CW112": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG112)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX112": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO112, 1)",
    "CY112": "LET(\n  Base, $CR$6,\n  Damage, $CT112,\n  DamageMastery, $CS112,\n  DemonMastery, $CX112,\n  SPB, $CU112,\n  ITO, $CV112,\n  Shock, $CW112,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ112": "MIN(100%, DA112)",
    "DA112": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK112*1%, 0)",
    "DB112": "LET(\n  Lab, 1+INDEX($BF$5:$BF257,BV112),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC112": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK112*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI257,BY112) + CardCritMastery)",
    "DD112": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK112*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ257,BZ112) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE112": "LET(\n  CF, $DB112,\n  CC, $CZ112,\n  SCM, $DD112,\n  SCC, $DC112,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF112": "LET(\n  CF, $DB112,\n  CC, $DA112,\n  SCM, $DD112,\n  SCC, $DC112,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG112": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH112)), 0)",
    "DH112": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ112*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE257,BU112),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI112": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG257, BW112), 1) + $AE$9)",
    "DJ112": "LET(\n  DpmLab, INDEX($BH$5:$BH257,BX112),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL112, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK112": "(1+$DI112*$DJ112*$AQ$9)",
    "DL112": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK257,CA112),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM112*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM112": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK257,CA112),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM112*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN112": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL257,CB112)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO112": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH112,\n  Rapid, DG112,\n  RDPM, DK112,\n  SuperTower, $DL112,\n  Rend, $DN112,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP112": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ112": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK112),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR112": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP112),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF112-1))",
    "DS112": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG112, DH112),0))",
    "DT112": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP112),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV112, $AR$29), 0))",
    "DU112": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK112),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM257,CC112), $DV112, $AR$29), 0))",
    "DV112": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH112), $AO$29)",
    "DW112": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM112,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112, $DB112), 1),\n\n  DW, $DR112,\n  CL, $DS112,\n  SM, $DT112,\n  SLM, $DU112,\n  SL, $DQ112,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX112": "CY112*(DE112*DO112*DQ112+DW112*DF112)",
    "DZ112": "IF(INDEX($BD$6:$BD257,BT112)=\"\", \"\", INDEX($BD$5:$BD257,BT112+1))",
    "EA112": "IF(OR($AO$25, INDEX($BE$6:$BE257,BU112)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ112)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE257,BU112+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI112*$DJ112*$AQ$9),\n  SuperTower, $DL112,\n  Rend, $DN112,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112, $DB112), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR112,\n  SM, $DT112,\n  SLM, $DU112,\n  SL, $DQ112,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM112, UltCritCard),\n\nCY112*(DE112*OtherDamage*SL+UwDamage*DF112)))",
    "EB112": "IF(INDEX($BF$6:$BF257,BV112)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF257,BV112+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ112,\n  CCUW, $DA112,\n  SCM, $DD112,\n  SCC, $DC112,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112, CF), 1),\n\n  DW, $DR112,\n  CL, $DS112,\n  SM, $DT112,\n  SLM, $DU112,\n  SL, $DQ112,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM112, UltCritCard),\n\nCY112 * (Critical * DO112 * SL + UwDamage * UWCritical)))",
    "EC112": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG257,BW112)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH112,\n  Rapid, DG112,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG257, BW112+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ112*$AQ$9),\n  SuperTower, $DL112,\n  Rend, $DN112,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM257,CC112), $DV112, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM112,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112, $DB112), 1),\n\n  DW, $DR112,\n  CL, $DS112,\n  SM, $DT112,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY112*(DE112*OtherDamage*SL+UWDamage*DF112)))",
    "ED112": "IF(OR($AO$25, INDEX($BH$6:$BH257,BX112)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH257,BX112+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL112, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI112*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM257,CC112), $DV112, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH112,\n  Rapid, DG112,\n  SuperTower, $DL112,\n  Rend, $DN112,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM112,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112, $DB112), 1),\n\n  DW, $DR112,\n  CL, $DS112,\n  SM, $DT112,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY112*(DE112*OtherDamage*SL+UWDamage*DF112)))",
    "EE112": "IF(INDEX($BI$6:$BI257,BY112)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK112, 0),\n  CF, $DB112,\n  CC, $CZ112,\n  CCUW, $DA112,\n  SCM, $DD112,\n  SCC, $AV$17+INDEX($BI$5:$BI257,BY112+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY112 * (Critical*DO112*$DQ112+DW112*UWCritical)))",
    "EF112": "IF(INDEX($BJ$6:$BJ257,BZ112)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK112*1%, 1),\n  CF, $DB112,\n  CC, $CZ112,\n  CCUW, $DA112,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ257,BZ112+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC112,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY112*(Critical*DO112*$DQ112+DW112*UWCritical)))",
    "EG112": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK257,CA112)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH112,\n  Rapid, DG112,\n  DPM, (1+$DI112*$DJ112*$AQ$9),\n  Rend, $DN112,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK257,CA112+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM112*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112, $DB112), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK257,CA112+1)-1))/(45-CM112*3),1),\n\n  SL, $DQ112,\n  DW, $DR112,\n  CL, $DS112,\n  SM, $DT112,\n  SLM, $DU112,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY112*(DE112*OtherDamage*SL+UwDamage*DF112)))",
    "EH112": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL257,CB112+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL257,CB112)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH112,\n  Rapid, DG112,\n  DPM, (1+$DI112*$DJ112*$AQ$9),\n  SuperTower, $DL112,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL257,CB112+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY112*(DE112*OtherDamage*$DQ112+DW112*DF112)))",
    "EI112": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM257,CC112)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112, $DB112), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK112),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV112, $AR$29), 0),\n\n  DW, $DR112,\n  CL, $DS112,\n  SM, $DT112,\n  SL, $DQ112,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM112, UltCritCard),\nCY112*(DE112*DO112*SL+UwDamage*DF112)))",
    "EJ112": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN257,CD112)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT112,\n  DamageMastery, $CS112,\n  DemonMastery, $CX112,\n  SPB, INDEX($BN$5:$BN257,CD112+1),\n  ITO, $CV112,\n  Shock, $CW112,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE112*DO112*$DQ112+DW112*DF112)))",
    "EK112": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO257,CE112)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT112,\n  DamageMastery, $CS112,\n  DemonMastery, $CX112,\n  SPB, $CU112,\n  ITO, INDEX($BO$5:$BO257,CE112+1),\n  Shock, $CW112,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE112*DO112*$DQ112+DW112*DF112)))",
    "EL112": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP257,CF112)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112, $DB112), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP112),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF112),\n  CL, $DS112,\n  SM, $DT112,\n  SLM, $DU112,\n  SL, $DQ112,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM112, UltCritCard),\nCY112*(DE112*DO112*SL+UwDamage*DF112)))",
    "EM112": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ257,CG112)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG112+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN112": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR257,CH112)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112, $DB112), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH112+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP112),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK112),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM257,CC112), SMHeat, $AR$29), 0),\n\n  DW, $DR112,\n  CL, $DS112,\n  SL, $DQ112,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM112, UltCritCard),\nCY112*(DE112*DO112*SL+UwDamage*DF112)))",
    "EO112": "IF(OR(CI112 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI112+1))",
    "EP112": "IF(OR($AO$25, CJ112 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ112+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE256,BU112),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL112, 1),\n  DPM, (1+$DI112*CardRangeMastery*$DJ112*$AQ$9),\n  SuperTower, $DL112,\n  Rend, $DN112,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112, $DB112), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR112,\n  SM, $DT112,\n  SLM, $DU112,\n  SL, $DQ112,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM112, UltCritCard),\n\nCY112*(DE112*OtherDamage*SL+UwDamage*DF112)))",
    "EQ112": "IF(OR(CK112 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK112+1)*1%, 1),\n  CF, $DB112,\n  CC, MIN(100%, $CZ112 + 1%),\n  CCUW, DA112 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ257,BZ112) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC112 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR112,\n  CL, $DS112,\n  SM, $DT112,\n  SLM, $DU112,\n  SL, $DQ112,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM112, UltCritCard),\n\nCY112 * (Critical*DO112*SL+UwDamage*UWCritical)))",
    "ER112": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL112 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH257,BX112),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL112+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI112*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM257,CC112), $DV112, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH112,\n  Rapid, DG112,\n  SuperTower, $DL112,\n  Rend, $DN112,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM112,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112, $DB112), 1),\n\n  DW, $DR112,\n  CL, $DS112,\n  SM, $DT112,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY112*(DE112*OtherDamage*SL+UWDamage*DF112)))",
    "ES112": "IF(OR(CM112 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH112,\n  Rapid, DG112,\n  RDPM, (1+$DI112*$DJ112*$AQ$9),\n  Rend, $DN112,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK257,CA112),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM112+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112, $DB112), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR112,\n  CL, $DS112,\n  SM, $DT112,\n  SLM, $DU112,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY112*(DE112*OtherDamage*SL+UwDamage*DF112)))",
    "ET112": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN112 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM112,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN112+1, $DB112), 1),\n\n  DW, $DR112,\n  CL, $DS112,\n  SM, $DT112,\n  SLM, $DU112,\n  SL, $DQ112,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY112*(DE112*DO112*SL+UWDamage*DF112)))",
    "EU112": "IF(OR(NOT($BA$3), NOT($BA$23), $CO112 > $BA$15), \"\", 1 + 0.5*(CO112+1))",
    "EW112": "IF(DZ112=\"\", \"\", LET(\n  Now, CT112,\n  Next, DZ112,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT112),\nFactor/Cost))",
    "EX112": "IF(EA112=\"\",\"\",(EA112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU112))",
    "EY112": "IF(EB112=\"\",\"\",(EB112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV112))",
    "EZ112": "IF(EC112=\"\",\"\",(EC112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW112))",
    "FA112": "IF(ED112=\"\",\"\",(ED112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX112))",
    "FB112": "IF(EE112=\"\",\"\",(EE112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY112))",
    "FC112": "IF(EF112=\"\",\"\",(EF112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ112))",
    "FD112": "IF(EG112=\"\",\"\",(EG112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA112))",
    "FE112": "IF(EH112=\"\",\"\",(EH112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB112))",
    "FF112": "IF(EI112=\"\",\"\",(EI112/$DX112-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC112+1, 1, CC112))))",
    "FG112": "IF(EJ112=\"\",\"\",(EJ112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD112))",
    "FH112": "IF(EK112=\"\",\"\",(EK112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE112))",
    "FI112": "IF(EL112=\"\",\"\",(EL112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF112))",
    "FJ112": "IF(EM112=\"\", \"\", LET(\n  Now, CW112,\n  Next, EM112,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG112),\nFactor/Cost))",
    "FK112": "IF(EN112=\"\",\"\",(EN112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH112))",
    "FL112": "IF(EO112=\"\", \"\", LET(\n  Now, CS112,\n  Next, EO112,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI112),\nFactor/Cost))",
    "FM112": "IF(EP112=\"\",\"\",(EP112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ112))",
    "FN112": "IF(EQ112=\"\",\"\",(EQ112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK112))",
    "FO112": "IF(ER112=\"\",\"\",(ER112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL112))",
    "FP112": "IF(ES112=\"\",\"\",(ES112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM112))",
    "FQ112": "IF(ET112=\"\",\"\",(ET112/$DX112-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN112))",
    "FR112": "IF(EU112=\"\", \"\", LET(\n  Now, CX112,\n  Next, EU112,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO112),\nFactor/Cost))",
    "FT112": "IF(COLUMN(EW112:FR112) = MIN(IF(EW112:FR112=MAX(EW112:FR112), COLUMN(EW112:FR112))), 1, \"\")",
    "D113": "IF(SUM(FT112:GP112),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F113)),\"Card Mastery\",F113),G113)/$D$5,\"\")",
    "F113": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT112:GP112),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT112:GP112=1)),)\"),\"Damage / Meter\")",
    "G113": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT112:GP112),ARRAYFORMULA(FILTER(BT112:CP112 , FT112:GP112=1)),\"\"\"\")\"),19.0)",
    "I113": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT112:GP112),ARRAYFORMULA(FILTER(EW112:FS112 , FT112:GP112=1))*D$5,\"\"\"\")\"),0.00760052187147741)",
    "K113": "IF(H113<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D113)),)",
    "BT113": "BT112+FT112",
    "BU113": "BU112+FU112",
    "BV113": "BV112+FV112",
    "BW113": "BW112+FW112",
    "BX113": "BX112+FX112",
    "BY113": "BY112+FY112",
    "BZ113": "BZ112+FZ112",
    "CA113": "CA112+GA112",
    "CB113": "CB112+GB112",
    "CC113": "CC112+GC112",
    "CD113": "CD112+GD112",
    "CE113": "CE112+GE112",
    "CF113": "CF112+GF112",
    "CG113": "CG112+GG112",
    "CH113": "CH112+GH112",
    "CI113": "CI112+GI112",
    "CJ113": "CJ112+GJ112",
    "CK113": "CK112+GK112",
    "CL113": "CL112+GL112",
    "CM113": "CM112+GM112",
    "CN113": "CN112+GN112",
    "CO113": "CO112+GO112",
    "CS113": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI113,1)",
    "CT113": "INDEX($BD$5:$BD258,BT113)",
    "CU113": "INDEX($BN$5:$BN258,CD113)",
    "CV113": "INDEX($BO$5:$BO258,CE113)",
    "CW113": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG113)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX113": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO113, 1)",
    "CY113": "LET(\n  Base, $CR$6,\n  Damage, $CT113,\n  DamageMastery, $CS113,\n  DemonMastery, $CX113,\n  SPB, $CU113,\n  ITO, $CV113,\n  Shock, $CW113,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ113": "MIN(100%, DA113)",
    "DA113": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK113*1%, 0)",
    "DB113": "LET(\n  Lab, 1+INDEX($BF$5:$BF258,BV113),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC113": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK113*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI258,BY113) + CardCritMastery)",
    "DD113": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK113*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ258,BZ113) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE113": "LET(\n  CF, $DB113,\n  CC, $CZ113,\n  SCM, $DD113,\n  SCC, $DC113,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF113": "LET(\n  CF, $DB113,\n  CC, $DA113,\n  SCM, $DD113,\n  SCC, $DC113,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG113": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH113)), 0)",
    "DH113": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ113*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE258,BU113),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI113": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG258, BW113), 1) + $AE$9)",
    "DJ113": "LET(\n  DpmLab, INDEX($BH$5:$BH258,BX113),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL113, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK113": "(1+$DI113*$DJ113*$AQ$9)",
    "DL113": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK258,CA113),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM113*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM113": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK258,CA113),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM113*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN113": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL258,CB113)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO113": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH113,\n  Rapid, DG113,\n  RDPM, DK113,\n  SuperTower, $DL113,\n  Rend, $DN113,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP113": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ113": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK113),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR113": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP113),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF113-1))",
    "DS113": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG113, DH113),0))",
    "DT113": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP113),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV113, $AR$29), 0))",
    "DU113": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK113),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM258,CC113), $DV113, $AR$29), 0))",
    "DV113": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH113), $AO$29)",
    "DW113": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM113,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113, $DB113), 1),\n\n  DW, $DR113,\n  CL, $DS113,\n  SM, $DT113,\n  SLM, $DU113,\n  SL, $DQ113,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX113": "CY113*(DE113*DO113*DQ113+DW113*DF113)",
    "DZ113": "IF(INDEX($BD$6:$BD258,BT113)=\"\", \"\", INDEX($BD$5:$BD258,BT113+1))",
    "EA113": "IF(OR($AO$25, INDEX($BE$6:$BE258,BU113)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ113)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE258,BU113+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI113*$DJ113*$AQ$9),\n  SuperTower, $DL113,\n  Rend, $DN113,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113, $DB113), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR113,\n  SM, $DT113,\n  SLM, $DU113,\n  SL, $DQ113,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM113, UltCritCard),\n\nCY113*(DE113*OtherDamage*SL+UwDamage*DF113)))",
    "EB113": "IF(INDEX($BF$6:$BF258,BV113)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF258,BV113+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ113,\n  CCUW, $DA113,\n  SCM, $DD113,\n  SCC, $DC113,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113, CF), 1),\n\n  DW, $DR113,\n  CL, $DS113,\n  SM, $DT113,\n  SLM, $DU113,\n  SL, $DQ113,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM113, UltCritCard),\n\nCY113 * (Critical * DO113 * SL + UwDamage * UWCritical)))",
    "EC113": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG258,BW113)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH113,\n  Rapid, DG113,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG258, BW113+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ113*$AQ$9),\n  SuperTower, $DL113,\n  Rend, $DN113,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM258,CC113), $DV113, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM113,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113, $DB113), 1),\n\n  DW, $DR113,\n  CL, $DS113,\n  SM, $DT113,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY113*(DE113*OtherDamage*SL+UWDamage*DF113)))",
    "ED113": "IF(OR($AO$25, INDEX($BH$6:$BH258,BX113)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH258,BX113+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL113, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI113*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM258,CC113), $DV113, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH113,\n  Rapid, DG113,\n  SuperTower, $DL113,\n  Rend, $DN113,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM113,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113, $DB113), 1),\n\n  DW, $DR113,\n  CL, $DS113,\n  SM, $DT113,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY113*(DE113*OtherDamage*SL+UWDamage*DF113)))",
    "EE113": "IF(INDEX($BI$6:$BI258,BY113)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK113, 0),\n  CF, $DB113,\n  CC, $CZ113,\n  CCUW, $DA113,\n  SCM, $DD113,\n  SCC, $AV$17+INDEX($BI$5:$BI258,BY113+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY113 * (Critical*DO113*$DQ113+DW113*UWCritical)))",
    "EF113": "IF(INDEX($BJ$6:$BJ258,BZ113)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK113*1%, 1),\n  CF, $DB113,\n  CC, $CZ113,\n  CCUW, $DA113,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ258,BZ113+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC113,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY113*(Critical*DO113*$DQ113+DW113*UWCritical)))",
    "EG113": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK258,CA113)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH113,\n  Rapid, DG113,\n  DPM, (1+$DI113*$DJ113*$AQ$9),\n  Rend, $DN113,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK258,CA113+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM113*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113, $DB113), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK258,CA113+1)-1))/(45-CM113*3),1),\n\n  SL, $DQ113,\n  DW, $DR113,\n  CL, $DS113,\n  SM, $DT113,\n  SLM, $DU113,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY113*(DE113*OtherDamage*SL+UwDamage*DF113)))",
    "EH113": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL258,CB113+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL258,CB113)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH113,\n  Rapid, DG113,\n  DPM, (1+$DI113*$DJ113*$AQ$9),\n  SuperTower, $DL113,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL258,CB113+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY113*(DE113*OtherDamage*$DQ113+DW113*DF113)))",
    "EI113": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM258,CC113)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113, $DB113), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK113),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV113, $AR$29), 0),\n\n  DW, $DR113,\n  CL, $DS113,\n  SM, $DT113,\n  SL, $DQ113,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM113, UltCritCard),\nCY113*(DE113*DO113*SL+UwDamage*DF113)))",
    "EJ113": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN258,CD113)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT113,\n  DamageMastery, $CS113,\n  DemonMastery, $CX113,\n  SPB, INDEX($BN$5:$BN258,CD113+1),\n  ITO, $CV113,\n  Shock, $CW113,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE113*DO113*$DQ113+DW113*DF113)))",
    "EK113": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO258,CE113)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT113,\n  DamageMastery, $CS113,\n  DemonMastery, $CX113,\n  SPB, $CU113,\n  ITO, INDEX($BO$5:$BO258,CE113+1),\n  Shock, $CW113,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE113*DO113*$DQ113+DW113*DF113)))",
    "EL113": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP258,CF113)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113, $DB113), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP113),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF113),\n  CL, $DS113,\n  SM, $DT113,\n  SLM, $DU113,\n  SL, $DQ113,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM113, UltCritCard),\nCY113*(DE113*DO113*SL+UwDamage*DF113)))",
    "EM113": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ258,CG113)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG113+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN113": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR258,CH113)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113, $DB113), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH113+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP113),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK113),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM258,CC113), SMHeat, $AR$29), 0),\n\n  DW, $DR113,\n  CL, $DS113,\n  SL, $DQ113,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM113, UltCritCard),\nCY113*(DE113*DO113*SL+UwDamage*DF113)))",
    "EO113": "IF(OR(CI113 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI113+1))",
    "EP113": "IF(OR($AO$25, CJ113 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ113+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE257,BU113),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL113, 1),\n  DPM, (1+$DI113*CardRangeMastery*$DJ113*$AQ$9),\n  SuperTower, $DL113,\n  Rend, $DN113,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113, $DB113), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR113,\n  SM, $DT113,\n  SLM, $DU113,\n  SL, $DQ113,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM113, UltCritCard),\n\nCY113*(DE113*OtherDamage*SL+UwDamage*DF113)))",
    "EQ113": "IF(OR(CK113 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK113+1)*1%, 1),\n  CF, $DB113,\n  CC, MIN(100%, $CZ113 + 1%),\n  CCUW, DA113 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ258,BZ113) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC113 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR113,\n  CL, $DS113,\n  SM, $DT113,\n  SLM, $DU113,\n  SL, $DQ113,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM113, UltCritCard),\n\nCY113 * (Critical*DO113*SL+UwDamage*UWCritical)))",
    "ER113": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL113 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH258,BX113),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL113+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI113*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM258,CC113), $DV113, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH113,\n  Rapid, DG113,\n  SuperTower, $DL113,\n  Rend, $DN113,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM113,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113, $DB113), 1),\n\n  DW, $DR113,\n  CL, $DS113,\n  SM, $DT113,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY113*(DE113*OtherDamage*SL+UWDamage*DF113)))",
    "ES113": "IF(OR(CM113 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH113,\n  Rapid, DG113,\n  RDPM, (1+$DI113*$DJ113*$AQ$9),\n  Rend, $DN113,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK258,CA113),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM113+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113, $DB113), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR113,\n  CL, $DS113,\n  SM, $DT113,\n  SLM, $DU113,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY113*(DE113*OtherDamage*SL+UwDamage*DF113)))",
    "ET113": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN113 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM113,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN113+1, $DB113), 1),\n\n  DW, $DR113,\n  CL, $DS113,\n  SM, $DT113,\n  SLM, $DU113,\n  SL, $DQ113,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY113*(DE113*DO113*SL+UWDamage*DF113)))",
    "EU113": "IF(OR(NOT($BA$3), NOT($BA$23), $CO113 > $BA$15), \"\", 1 + 0.5*(CO113+1))",
    "EW113": "IF(DZ113=\"\", \"\", LET(\n  Now, CT113,\n  Next, DZ113,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT113),\nFactor/Cost))",
    "EX113": "IF(EA113=\"\",\"\",(EA113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU113))",
    "EY113": "IF(EB113=\"\",\"\",(EB113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV113))",
    "EZ113": "IF(EC113=\"\",\"\",(EC113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW113))",
    "FA113": "IF(ED113=\"\",\"\",(ED113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX113))",
    "FB113": "IF(EE113=\"\",\"\",(EE113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY113))",
    "FC113": "IF(EF113=\"\",\"\",(EF113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ113))",
    "FD113": "IF(EG113=\"\",\"\",(EG113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA113))",
    "FE113": "IF(EH113=\"\",\"\",(EH113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB113))",
    "FF113": "IF(EI113=\"\",\"\",(EI113/$DX113-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC113+1, 1, CC113))))",
    "FG113": "IF(EJ113=\"\",\"\",(EJ113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD113))",
    "FH113": "IF(EK113=\"\",\"\",(EK113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE113))",
    "FI113": "IF(EL113=\"\",\"\",(EL113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF113))",
    "FJ113": "IF(EM113=\"\", \"\", LET(\n  Now, CW113,\n  Next, EM113,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG113),\nFactor/Cost))",
    "FK113": "IF(EN113=\"\",\"\",(EN113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH113))",
    "FL113": "IF(EO113=\"\", \"\", LET(\n  Now, CS113,\n  Next, EO113,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI113),\nFactor/Cost))",
    "FM113": "IF(EP113=\"\",\"\",(EP113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ113))",
    "FN113": "IF(EQ113=\"\",\"\",(EQ113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK113))",
    "FO113": "IF(ER113=\"\",\"\",(ER113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL113))",
    "FP113": "IF(ES113=\"\",\"\",(ES113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM113))",
    "FQ113": "IF(ET113=\"\",\"\",(ET113/$DX113-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN113))",
    "FR113": "IF(EU113=\"\", \"\", LET(\n  Now, CX113,\n  Next, EU113,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO113),\nFactor/Cost))",
    "FT113": "IF(COLUMN(EW113:FR113) = MIN(IF(EW113:FR113=MAX(EW113:FR113), COLUMN(EW113:FR113))), 1, \"\")",
    "D114": "IF(SUM(FT113:GP113),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F114)),\"Card Mastery\",F114),G114)/$D$5,\"\")",
    "F114": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT113:GP113),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT113:GP113=1)),)\"),\"Super Crit Multi\")",
    "G114": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT113:GP113),ARRAYFORMULA(FILTER(BT113:CP113 , FT113:GP113=1)),\"\"\"\")\"),1.0)",
    "I114": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT113:GP113),ARRAYFORMULA(FILTER(EW113:FS113 , FT113:GP113=1))*D$5,\"\"\"\")\"),0.007524009509230653)",
    "K114": "IF(H114<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D114)),)",
    "BT114": "BT113+FT113",
    "BU114": "BU113+FU113",
    "BV114": "BV113+FV113",
    "BW114": "BW113+FW113",
    "BX114": "BX113+FX113",
    "BY114": "BY113+FY113",
    "BZ114": "BZ113+FZ113",
    "CA114": "CA113+GA113",
    "CB114": "CB113+GB113",
    "CC114": "CC113+GC113",
    "CD114": "CD113+GD113",
    "CE114": "CE113+GE113",
    "CF114": "CF113+GF113",
    "CG114": "CG113+GG113",
    "CH114": "CH113+GH113",
    "CI114": "CI113+GI113",
    "CJ114": "CJ113+GJ113",
    "CK114": "CK113+GK113",
    "CL114": "CL113+GL113",
    "CM114": "CM113+GM113",
    "CN114": "CN113+GN113",
    "CO114": "CO113+GO113",
    "CS114": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI114,1)",
    "CT114": "INDEX($BD$5:$BD259,BT114)",
    "CU114": "INDEX($BN$5:$BN259,CD114)",
    "CV114": "INDEX($BO$5:$BO259,CE114)",
    "CW114": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG114)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX114": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO114, 1)",
    "CY114": "LET(\n  Base, $CR$6,\n  Damage, $CT114,\n  DamageMastery, $CS114,\n  DemonMastery, $CX114,\n  SPB, $CU114,\n  ITO, $CV114,\n  Shock, $CW114,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ114": "MIN(100%, DA114)",
    "DA114": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK114*1%, 0)",
    "DB114": "LET(\n  Lab, 1+INDEX($BF$5:$BF259,BV114),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC114": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK114*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI259,BY114) + CardCritMastery)",
    "DD114": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK114*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ259,BZ114) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE114": "LET(\n  CF, $DB114,\n  CC, $CZ114,\n  SCM, $DD114,\n  SCC, $DC114,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF114": "LET(\n  CF, $DB114,\n  CC, $DA114,\n  SCM, $DD114,\n  SCC, $DC114,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG114": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH114)), 0)",
    "DH114": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ114*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE259,BU114),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI114": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG259, BW114), 1) + $AE$9)",
    "DJ114": "LET(\n  DpmLab, INDEX($BH$5:$BH259,BX114),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL114, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK114": "(1+$DI114*$DJ114*$AQ$9)",
    "DL114": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK259,CA114),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM114*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM114": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK259,CA114),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM114*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN114": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL259,CB114)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO114": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH114,\n  Rapid, DG114,\n  RDPM, DK114,\n  SuperTower, $DL114,\n  Rend, $DN114,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP114": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ114": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK114),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR114": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP114),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF114-1))",
    "DS114": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG114, DH114),0))",
    "DT114": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP114),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV114, $AR$29), 0))",
    "DU114": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK114),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM259,CC114), $DV114, $AR$29), 0))",
    "DV114": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH114), $AO$29)",
    "DW114": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM114,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114, $DB114), 1),\n\n  DW, $DR114,\n  CL, $DS114,\n  SM, $DT114,\n  SLM, $DU114,\n  SL, $DQ114,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX114": "CY114*(DE114*DO114*DQ114+DW114*DF114)",
    "DZ114": "IF(INDEX($BD$6:$BD259,BT114)=\"\", \"\", INDEX($BD$5:$BD259,BT114+1))",
    "EA114": "IF(OR($AO$25, INDEX($BE$6:$BE259,BU114)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ114)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE259,BU114+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI114*$DJ114*$AQ$9),\n  SuperTower, $DL114,\n  Rend, $DN114,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114, $DB114), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR114,\n  SM, $DT114,\n  SLM, $DU114,\n  SL, $DQ114,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM114, UltCritCard),\n\nCY114*(DE114*OtherDamage*SL+UwDamage*DF114)))",
    "EB114": "IF(INDEX($BF$6:$BF259,BV114)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF259,BV114+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ114,\n  CCUW, $DA114,\n  SCM, $DD114,\n  SCC, $DC114,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114, CF), 1),\n\n  DW, $DR114,\n  CL, $DS114,\n  SM, $DT114,\n  SLM, $DU114,\n  SL, $DQ114,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM114, UltCritCard),\n\nCY114 * (Critical * DO114 * SL + UwDamage * UWCritical)))",
    "EC114": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG259,BW114)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH114,\n  Rapid, DG114,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG259, BW114+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ114*$AQ$9),\n  SuperTower, $DL114,\n  Rend, $DN114,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM259,CC114), $DV114, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM114,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114, $DB114), 1),\n\n  DW, $DR114,\n  CL, $DS114,\n  SM, $DT114,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY114*(DE114*OtherDamage*SL+UWDamage*DF114)))",
    "ED114": "IF(OR($AO$25, INDEX($BH$6:$BH259,BX114)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH259,BX114+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL114, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI114*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM259,CC114), $DV114, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH114,\n  Rapid, DG114,\n  SuperTower, $DL114,\n  Rend, $DN114,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM114,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114, $DB114), 1),\n\n  DW, $DR114,\n  CL, $DS114,\n  SM, $DT114,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY114*(DE114*OtherDamage*SL+UWDamage*DF114)))",
    "EE114": "IF(INDEX($BI$6:$BI259,BY114)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK114, 0),\n  CF, $DB114,\n  CC, $CZ114,\n  CCUW, $DA114,\n  SCM, $DD114,\n  SCC, $AV$17+INDEX($BI$5:$BI259,BY114+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY114 * (Critical*DO114*$DQ114+DW114*UWCritical)))",
    "EF114": "IF(INDEX($BJ$6:$BJ259,BZ114)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK114*1%, 1),\n  CF, $DB114,\n  CC, $CZ114,\n  CCUW, $DA114,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ259,BZ114+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC114,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY114*(Critical*DO114*$DQ114+DW114*UWCritical)))",
    "EG114": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK259,CA114)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH114,\n  Rapid, DG114,\n  DPM, (1+$DI114*$DJ114*$AQ$9),\n  Rend, $DN114,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK259,CA114+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM114*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114, $DB114), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK259,CA114+1)-1))/(45-CM114*3),1),\n\n  SL, $DQ114,\n  DW, $DR114,\n  CL, $DS114,\n  SM, $DT114,\n  SLM, $DU114,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY114*(DE114*OtherDamage*SL+UwDamage*DF114)))",
    "EH114": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL259,CB114+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL259,CB114)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH114,\n  Rapid, DG114,\n  DPM, (1+$DI114*$DJ114*$AQ$9),\n  SuperTower, $DL114,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL259,CB114+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY114*(DE114*OtherDamage*$DQ114+DW114*DF114)))",
    "EI114": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM259,CC114)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114, $DB114), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK114),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV114, $AR$29), 0),\n\n  DW, $DR114,\n  CL, $DS114,\n  SM, $DT114,\n  SL, $DQ114,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM114, UltCritCard),\nCY114*(DE114*DO114*SL+UwDamage*DF114)))",
    "EJ114": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN259,CD114)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT114,\n  DamageMastery, $CS114,\n  DemonMastery, $CX114,\n  SPB, INDEX($BN$5:$BN259,CD114+1),\n  ITO, $CV114,\n  Shock, $CW114,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE114*DO114*$DQ114+DW114*DF114)))",
    "EK114": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO259,CE114)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT114,\n  DamageMastery, $CS114,\n  DemonMastery, $CX114,\n  SPB, $CU114,\n  ITO, INDEX($BO$5:$BO259,CE114+1),\n  Shock, $CW114,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE114*DO114*$DQ114+DW114*DF114)))",
    "EL114": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP259,CF114)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114, $DB114), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP114),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF114),\n  CL, $DS114,\n  SM, $DT114,\n  SLM, $DU114,\n  SL, $DQ114,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM114, UltCritCard),\nCY114*(DE114*DO114*SL+UwDamage*DF114)))",
    "EM114": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ259,CG114)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG114+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN114": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR259,CH114)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114, $DB114), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH114+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP114),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK114),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM259,CC114), SMHeat, $AR$29), 0),\n\n  DW, $DR114,\n  CL, $DS114,\n  SL, $DQ114,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM114, UltCritCard),\nCY114*(DE114*DO114*SL+UwDamage*DF114)))",
    "EO114": "IF(OR(CI114 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI114+1))",
    "EP114": "IF(OR($AO$25, CJ114 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ114+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE258,BU114),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL114, 1),\n  DPM, (1+$DI114*CardRangeMastery*$DJ114*$AQ$9),\n  SuperTower, $DL114,\n  Rend, $DN114,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114, $DB114), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR114,\n  SM, $DT114,\n  SLM, $DU114,\n  SL, $DQ114,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM114, UltCritCard),\n\nCY114*(DE114*OtherDamage*SL+UwDamage*DF114)))",
    "EQ114": "IF(OR(CK114 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK114+1)*1%, 1),\n  CF, $DB114,\n  CC, MIN(100%, $CZ114 + 1%),\n  CCUW, DA114 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ259,BZ114) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC114 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR114,\n  CL, $DS114,\n  SM, $DT114,\n  SLM, $DU114,\n  SL, $DQ114,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM114, UltCritCard),\n\nCY114 * (Critical*DO114*SL+UwDamage*UWCritical)))",
    "ER114": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL114 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH259,BX114),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL114+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI114*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM259,CC114), $DV114, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH114,\n  Rapid, DG114,\n  SuperTower, $DL114,\n  Rend, $DN114,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM114,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114, $DB114), 1),\n\n  DW, $DR114,\n  CL, $DS114,\n  SM, $DT114,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY114*(DE114*OtherDamage*SL+UWDamage*DF114)))",
    "ES114": "IF(OR(CM114 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH114,\n  Rapid, DG114,\n  RDPM, (1+$DI114*$DJ114*$AQ$9),\n  Rend, $DN114,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK259,CA114),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM114+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114, $DB114), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR114,\n  CL, $DS114,\n  SM, $DT114,\n  SLM, $DU114,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY114*(DE114*OtherDamage*SL+UwDamage*DF114)))",
    "ET114": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN114 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM114,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN114+1, $DB114), 1),\n\n  DW, $DR114,\n  CL, $DS114,\n  SM, $DT114,\n  SLM, $DU114,\n  SL, $DQ114,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY114*(DE114*DO114*SL+UWDamage*DF114)))",
    "EU114": "IF(OR(NOT($BA$3), NOT($BA$23), $CO114 > $BA$15), \"\", 1 + 0.5*(CO114+1))",
    "EW114": "IF(DZ114=\"\", \"\", LET(\n  Now, CT114,\n  Next, DZ114,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT114),\nFactor/Cost))",
    "EX114": "IF(EA114=\"\",\"\",(EA114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU114))",
    "EY114": "IF(EB114=\"\",\"\",(EB114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV114))",
    "EZ114": "IF(EC114=\"\",\"\",(EC114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW114))",
    "FA114": "IF(ED114=\"\",\"\",(ED114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX114))",
    "FB114": "IF(EE114=\"\",\"\",(EE114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY114))",
    "FC114": "IF(EF114=\"\",\"\",(EF114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ114))",
    "FD114": "IF(EG114=\"\",\"\",(EG114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA114))",
    "FE114": "IF(EH114=\"\",\"\",(EH114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB114))",
    "FF114": "IF(EI114=\"\",\"\",(EI114/$DX114-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC114+1, 1, CC114))))",
    "FG114": "IF(EJ114=\"\",\"\",(EJ114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD114))",
    "FH114": "IF(EK114=\"\",\"\",(EK114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE114))",
    "FI114": "IF(EL114=\"\",\"\",(EL114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF114))",
    "FJ114": "IF(EM114=\"\", \"\", LET(\n  Now, CW114,\n  Next, EM114,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG114),\nFactor/Cost))",
    "FK114": "IF(EN114=\"\",\"\",(EN114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH114))",
    "FL114": "IF(EO114=\"\", \"\", LET(\n  Now, CS114,\n  Next, EO114,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI114),\nFactor/Cost))",
    "FM114": "IF(EP114=\"\",\"\",(EP114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ114))",
    "FN114": "IF(EQ114=\"\",\"\",(EQ114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK114))",
    "FO114": "IF(ER114=\"\",\"\",(ER114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL114))",
    "FP114": "IF(ES114=\"\",\"\",(ES114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM114))",
    "FQ114": "IF(ET114=\"\",\"\",(ET114/$DX114-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN114))",
    "FR114": "IF(EU114=\"\", \"\", LET(\n  Now, CX114,\n  Next, EU114,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO114),\nFactor/Cost))",
    "FT114": "IF(COLUMN(EW114:FR114) = MIN(IF(EW114:FR114=MAX(EW114:FR114), COLUMN(EW114:FR114))), 1, \"\")",
    "D115": "IF(SUM(FT114:GP114),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F115)),\"Card Mastery\",F115),G115)/$D$5,\"\")",
    "F115": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT114:GP114),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT114:GP114=1)),)\"),\"Critical Factor\")",
    "G115": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT114:GP114),ARRAYFORMULA(FILTER(BT114:CP114 , FT114:GP114=1)),\"\"\"\")\"),28.0)",
    "I115": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT114:GP114),ARRAYFORMULA(FILTER(EW114:FS114 , FT114:GP114=1))*D$5,\"\"\"\")\"),0.007262856455676798)",
    "K115": "IF(D106,FORMAT_TIME_YEAR(SUM($D$6:$D115)),)",
    "BT115": "BT114+FT114",
    "BU115": "BU114+FU114",
    "BV115": "BV114+FV114",
    "BW115": "BW114+FW114",
    "BX115": "BX114+FX114",
    "BY115": "BY114+FY114",
    "BZ115": "BZ114+FZ114",
    "CA115": "CA114+GA114",
    "CB115": "CB114+GB114",
    "CC115": "CC114+GC114",
    "CD115": "CD114+GD114",
    "CE115": "CE114+GE114",
    "CF115": "CF114+GF114",
    "CG115": "CG114+GG114",
    "CH115": "CH114+GH114",
    "CI115": "CI114+GI114",
    "CJ115": "CJ114+GJ114",
    "CK115": "CK114+GK114",
    "CL115": "CL114+GL114",
    "CM115": "CM114+GM114",
    "CN115": "CN114+GN114",
    "CO115": "CO114+GO114",
    "CS115": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI115,1)",
    "CT115": "INDEX($BD$5:$BD260,BT115)",
    "CU115": "INDEX($BN$5:$BN260,CD115)",
    "CV115": "INDEX($BO$5:$BO260,CE115)",
    "CW115": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG115)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX115": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO115, 1)",
    "CY115": "LET(\n  Base, $CR$6,\n  Damage, $CT115,\n  DamageMastery, $CS115,\n  DemonMastery, $CX115,\n  SPB, $CU115,\n  ITO, $CV115,\n  Shock, $CW115,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ115": "MIN(100%, DA115)",
    "DA115": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK115*1%, 0)",
    "DB115": "LET(\n  Lab, 1+INDEX($BF$5:$BF260,BV115),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC115": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK115*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI260,BY115) + CardCritMastery)",
    "DD115": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK115*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ260,BZ115) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE115": "LET(\n  CF, $DB115,\n  CC, $CZ115,\n  SCM, $DD115,\n  SCC, $DC115,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF115": "LET(\n  CF, $DB115,\n  CC, $DA115,\n  SCM, $DD115,\n  SCC, $DC115,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG115": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH115)), 0)",
    "DH115": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ115*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE260,BU115),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI115": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG260, BW115), 1) + $AE$9)",
    "DJ115": "LET(\n  DpmLab, INDEX($BH$5:$BH260,BX115),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL115, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK115": "(1+$DI115*$DJ115*$AQ$9)",
    "DL115": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK260,CA115),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM115*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM115": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK260,CA115),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM115*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN115": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL260,CB115)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO115": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH115,\n  Rapid, DG115,\n  RDPM, DK115,\n  SuperTower, $DL115,\n  Rend, $DN115,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP115": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ115": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK115),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR115": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP115),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF115-1))",
    "DS115": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG115, DH115),0))",
    "DT115": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP115),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV115, $AR$29), 0))",
    "DU115": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK115),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM260,CC115), $DV115, $AR$29), 0))",
    "DV115": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH115), $AO$29)",
    "DW115": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM115,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115, $DB115), 1),\n\n  DW, $DR115,\n  CL, $DS115,\n  SM, $DT115,\n  SLM, $DU115,\n  SL, $DQ115,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX115": "CY115*(DE115*DO115*DQ115+DW115*DF115)",
    "DZ115": "IF(INDEX($BD$6:$BD260,BT115)=\"\", \"\", INDEX($BD$5:$BD260,BT115+1))",
    "EA115": "IF(OR($AO$25, INDEX($BE$6:$BE260,BU115)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ115)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE260,BU115+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI115*$DJ115*$AQ$9),\n  SuperTower, $DL115,\n  Rend, $DN115,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115, $DB115), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR115,\n  SM, $DT115,\n  SLM, $DU115,\n  SL, $DQ115,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM115, UltCritCard),\n\nCY115*(DE115*OtherDamage*SL+UwDamage*DF115)))",
    "EB115": "IF(INDEX($BF$6:$BF260,BV115)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF260,BV115+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ115,\n  CCUW, $DA115,\n  SCM, $DD115,\n  SCC, $DC115,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115, CF), 1),\n\n  DW, $DR115,\n  CL, $DS115,\n  SM, $DT115,\n  SLM, $DU115,\n  SL, $DQ115,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM115, UltCritCard),\n\nCY115 * (Critical * DO115 * SL + UwDamage * UWCritical)))",
    "EC115": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG260,BW115)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH115,\n  Rapid, DG115,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG260, BW115+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ115*$AQ$9),\n  SuperTower, $DL115,\n  Rend, $DN115,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM260,CC115), $DV115, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM115,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115, $DB115), 1),\n\n  DW, $DR115,\n  CL, $DS115,\n  SM, $DT115,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY115*(DE115*OtherDamage*SL+UWDamage*DF115)))",
    "ED115": "IF(OR($AO$25, INDEX($BH$6:$BH260,BX115)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH260,BX115+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL115, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI115*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM260,CC115), $DV115, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH115,\n  Rapid, DG115,\n  SuperTower, $DL115,\n  Rend, $DN115,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM115,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115, $DB115), 1),\n\n  DW, $DR115,\n  CL, $DS115,\n  SM, $DT115,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY115*(DE115*OtherDamage*SL+UWDamage*DF115)))",
    "EE115": "IF(INDEX($BI$6:$BI260,BY115)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK115, 0),\n  CF, $DB115,\n  CC, $CZ115,\n  CCUW, $DA115,\n  SCM, $DD115,\n  SCC, $AV$17+INDEX($BI$5:$BI260,BY115+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY115 * (Critical*DO115*$DQ115+DW115*UWCritical)))",
    "EF115": "IF(INDEX($BJ$6:$BJ260,BZ115)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK115*1%, 1),\n  CF, $DB115,\n  CC, $CZ115,\n  CCUW, $DA115,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ260,BZ115+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC115,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY115*(Critical*DO115*$DQ115+DW115*UWCritical)))",
    "EG115": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK260,CA115)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH115,\n  Rapid, DG115,\n  DPM, (1+$DI115*$DJ115*$AQ$9),\n  Rend, $DN115,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK260,CA115+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM115*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115, $DB115), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK260,CA115+1)-1))/(45-CM115*3),1),\n\n  SL, $DQ115,\n  DW, $DR115,\n  CL, $DS115,\n  SM, $DT115,\n  SLM, $DU115,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY115*(DE115*OtherDamage*SL+UwDamage*DF115)))",
    "EH115": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL260,CB115+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL260,CB115)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH115,\n  Rapid, DG115,\n  DPM, (1+$DI115*$DJ115*$AQ$9),\n  SuperTower, $DL115,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL260,CB115+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY115*(DE115*OtherDamage*$DQ115+DW115*DF115)))",
    "EI115": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM260,CC115)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115, $DB115), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK115),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV115, $AR$29), 0),\n\n  DW, $DR115,\n  CL, $DS115,\n  SM, $DT115,\n  SL, $DQ115,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM115, UltCritCard),\nCY115*(DE115*DO115*SL+UwDamage*DF115)))",
    "EJ115": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN260,CD115)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT115,\n  DamageMastery, $CS115,\n  DemonMastery, $CX115,\n  SPB, INDEX($BN$5:$BN260,CD115+1),\n  ITO, $CV115,\n  Shock, $CW115,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE115*DO115*$DQ115+DW115*DF115)))",
    "EK115": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO260,CE115)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT115,\n  DamageMastery, $CS115,\n  DemonMastery, $CX115,\n  SPB, $CU115,\n  ITO, INDEX($BO$5:$BO260,CE115+1),\n  Shock, $CW115,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE115*DO115*$DQ115+DW115*DF115)))",
    "EL115": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP260,CF115)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115, $DB115), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP115),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF115),\n  CL, $DS115,\n  SM, $DT115,\n  SLM, $DU115,\n  SL, $DQ115,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM115, UltCritCard),\nCY115*(DE115*DO115*SL+UwDamage*DF115)))",
    "EM115": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ260,CG115)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG115+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN115": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR260,CH115)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115, $DB115), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH115+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP115),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK115),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM260,CC115), SMHeat, $AR$29), 0),\n\n  DW, $DR115,\n  CL, $DS115,\n  SL, $DQ115,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM115, UltCritCard),\nCY115*(DE115*DO115*SL+UwDamage*DF115)))",
    "EO115": "IF(OR(CI115 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI115+1))",
    "EP115": "IF(OR($AO$25, CJ115 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ115+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE259,BU115),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL115, 1),\n  DPM, (1+$DI115*CardRangeMastery*$DJ115*$AQ$9),\n  SuperTower, $DL115,\n  Rend, $DN115,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115, $DB115), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR115,\n  SM, $DT115,\n  SLM, $DU115,\n  SL, $DQ115,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM115, UltCritCard),\n\nCY115*(DE115*OtherDamage*SL+UwDamage*DF115)))",
    "EQ115": "IF(OR(CK115 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK115+1)*1%, 1),\n  CF, $DB115,\n  CC, MIN(100%, $CZ115 + 1%),\n  CCUW, DA115 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ260,BZ115) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC115 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR115,\n  CL, $DS115,\n  SM, $DT115,\n  SLM, $DU115,\n  SL, $DQ115,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM115, UltCritCard),\n\nCY115 * (Critical*DO115*SL+UwDamage*UWCritical)))",
    "ER115": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL115 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH260,BX115),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL115+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI115*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM260,CC115), $DV115, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH115,\n  Rapid, DG115,\n  SuperTower, $DL115,\n  Rend, $DN115,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM115,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115, $DB115), 1),\n\n  DW, $DR115,\n  CL, $DS115,\n  SM, $DT115,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY115*(DE115*OtherDamage*SL+UWDamage*DF115)))",
    "ES115": "IF(OR(CM115 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH115,\n  Rapid, DG115,\n  RDPM, (1+$DI115*$DJ115*$AQ$9),\n  Rend, $DN115,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK260,CA115),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM115+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115, $DB115), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR115,\n  CL, $DS115,\n  SM, $DT115,\n  SLM, $DU115,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY115*(DE115*OtherDamage*SL+UwDamage*DF115)))",
    "ET115": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN115 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM115,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN115+1, $DB115), 1),\n\n  DW, $DR115,\n  CL, $DS115,\n  SM, $DT115,\n  SLM, $DU115,\n  SL, $DQ115,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY115*(DE115*DO115*SL+UWDamage*DF115)))",
    "EU115": "IF(OR(NOT($BA$3), NOT($BA$23), $CO115 > $BA$15), \"\", 1 + 0.5*(CO115+1))",
    "EW115": "IF(DZ115=\"\", \"\", LET(\n  Now, CT115,\n  Next, DZ115,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT115),\nFactor/Cost))",
    "EX115": "IF(EA115=\"\",\"\",(EA115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU115))",
    "EY115": "IF(EB115=\"\",\"\",(EB115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV115))",
    "EZ115": "IF(EC115=\"\",\"\",(EC115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW115))",
    "FA115": "IF(ED115=\"\",\"\",(ED115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX115))",
    "FB115": "IF(EE115=\"\",\"\",(EE115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY115))",
    "FC115": "IF(EF115=\"\",\"\",(EF115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ115))",
    "FD115": "IF(EG115=\"\",\"\",(EG115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA115))",
    "FE115": "IF(EH115=\"\",\"\",(EH115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB115))",
    "FF115": "IF(EI115=\"\",\"\",(EI115/$DX115-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC115+1, 1, CC115))))",
    "FG115": "IF(EJ115=\"\",\"\",(EJ115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD115))",
    "FH115": "IF(EK115=\"\",\"\",(EK115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE115))",
    "FI115": "IF(EL115=\"\",\"\",(EL115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF115))",
    "FJ115": "IF(EM115=\"\", \"\", LET(\n  Now, CW115,\n  Next, EM115,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG115),\nFactor/Cost))",
    "FK115": "IF(EN115=\"\",\"\",(EN115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH115))",
    "FL115": "IF(EO115=\"\", \"\", LET(\n  Now, CS115,\n  Next, EO115,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI115),\nFactor/Cost))",
    "FM115": "IF(EP115=\"\",\"\",(EP115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ115))",
    "FN115": "IF(EQ115=\"\",\"\",(EQ115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK115))",
    "FO115": "IF(ER115=\"\",\"\",(ER115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL115))",
    "FP115": "IF(ES115=\"\",\"\",(ES115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM115))",
    "FQ115": "IF(ET115=\"\",\"\",(ET115/$DX115-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN115))",
    "FR115": "IF(EU115=\"\", \"\", LET(\n  Now, CX115,\n  Next, EU115,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO115),\nFactor/Cost))",
    "FT115": "IF(COLUMN(EW115:FR115) = MIN(IF(EW115:FR115=MAX(EW115:FR115), COLUMN(EW115:FR115))), 1, \"\")",
    "D116": "IF(SUM(FT115:GP115),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F116)),\"Card Mastery\",F116),G116)/$D$5,\"\")",
    "F116": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT115:GP115),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT115:GP115=1)),)\"),\"Damage\")",
    "G116": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT115:GP115),ARRAYFORMULA(FILTER(BT115:CP115 , FT115:GP115=1)),\"\"\"\")\"),26.0)",
    "I116": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT115:GP115),ARRAYFORMULA(FILTER(EW115:FS115 , FT115:GP115=1))*D$5,\"\"\"\")\"),0.006938923021322777)",
    "K116": "IF(H116<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D116)),)",
    "BT116": "BT115+FT115",
    "BU116": "BU115+FU115",
    "BV116": "BV115+FV115",
    "BW116": "BW115+FW115",
    "BX116": "BX115+FX115",
    "BY116": "BY115+FY115",
    "BZ116": "BZ115+FZ115",
    "CA116": "CA115+GA115",
    "CB116": "CB115+GB115",
    "CC116": "CC115+GC115",
    "CD116": "CD115+GD115",
    "CE116": "CE115+GE115",
    "CF116": "CF115+GF115",
    "CG116": "CG115+GG115",
    "CH116": "CH115+GH115",
    "CI116": "CI115+GI115",
    "CJ116": "CJ115+GJ115",
    "CK116": "CK115+GK115",
    "CL116": "CL115+GL115",
    "CM116": "CM115+GM115",
    "CN116": "CN115+GN115",
    "CO116": "CO115+GO115",
    "CS116": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI116,1)",
    "CT116": "INDEX($BD$5:$BD261,BT116)",
    "CU116": "INDEX($BN$5:$BN261,CD116)",
    "CV116": "INDEX($BO$5:$BO261,CE116)",
    "CW116": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG116)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX116": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO116, 1)",
    "CY116": "LET(\n  Base, $CR$6,\n  Damage, $CT116,\n  DamageMastery, $CS116,\n  DemonMastery, $CX116,\n  SPB, $CU116,\n  ITO, $CV116,\n  Shock, $CW116,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ116": "MIN(100%, DA116)",
    "DA116": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK116*1%, 0)",
    "DB116": "LET(\n  Lab, 1+INDEX($BF$5:$BF261,BV116),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC116": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK116*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI261,BY116) + CardCritMastery)",
    "DD116": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK116*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ261,BZ116) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE116": "LET(\n  CF, $DB116,\n  CC, $CZ116,\n  SCM, $DD116,\n  SCC, $DC116,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF116": "LET(\n  CF, $DB116,\n  CC, $DA116,\n  SCM, $DD116,\n  SCC, $DC116,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG116": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH116)), 0)",
    "DH116": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ116*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE261,BU116),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI116": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG261, BW116), 1) + $AE$9)",
    "DJ116": "LET(\n  DpmLab, INDEX($BH$5:$BH261,BX116),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL116, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK116": "(1+$DI116*$DJ116*$AQ$9)",
    "DL116": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK261,CA116),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM116*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM116": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK261,CA116),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM116*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN116": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL261,CB116)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO116": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH116,\n  Rapid, DG116,\n  RDPM, DK116,\n  SuperTower, $DL116,\n  Rend, $DN116,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP116": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ116": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK116),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR116": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP116),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF116-1))",
    "DS116": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG116, DH116),0))",
    "DT116": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP116),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV116, $AR$29), 0))",
    "DU116": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK116),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM261,CC116), $DV116, $AR$29), 0))",
    "DV116": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH116), $AO$29)",
    "DW116": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM116,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116, $DB116), 1),\n\n  DW, $DR116,\n  CL, $DS116,\n  SM, $DT116,\n  SLM, $DU116,\n  SL, $DQ116,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX116": "CY116*(DE116*DO116*DQ116+DW116*DF116)",
    "DZ116": "IF(INDEX($BD$6:$BD261,BT116)=\"\", \"\", INDEX($BD$5:$BD261,BT116+1))",
    "EA116": "IF(OR($AO$25, INDEX($BE$6:$BE261,BU116)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ116)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE261,BU116+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI116*$DJ116*$AQ$9),\n  SuperTower, $DL116,\n  Rend, $DN116,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116, $DB116), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR116,\n  SM, $DT116,\n  SLM, $DU116,\n  SL, $DQ116,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM116, UltCritCard),\n\nCY116*(DE116*OtherDamage*SL+UwDamage*DF116)))",
    "EB116": "IF(INDEX($BF$6:$BF261,BV116)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF261,BV116+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ116,\n  CCUW, $DA116,\n  SCM, $DD116,\n  SCC, $DC116,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116, CF), 1),\n\n  DW, $DR116,\n  CL, $DS116,\n  SM, $DT116,\n  SLM, $DU116,\n  SL, $DQ116,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM116, UltCritCard),\n\nCY116 * (Critical * DO116 * SL + UwDamage * UWCritical)))",
    "EC116": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG261,BW116)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH116,\n  Rapid, DG116,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG261, BW116+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ116*$AQ$9),\n  SuperTower, $DL116,\n  Rend, $DN116,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM261,CC116), $DV116, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM116,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116, $DB116), 1),\n\n  DW, $DR116,\n  CL, $DS116,\n  SM, $DT116,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY116*(DE116*OtherDamage*SL+UWDamage*DF116)))",
    "ED116": "IF(OR($AO$25, INDEX($BH$6:$BH261,BX116)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH261,BX116+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL116, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI116*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM261,CC116), $DV116, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH116,\n  Rapid, DG116,\n  SuperTower, $DL116,\n  Rend, $DN116,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM116,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116, $DB116), 1),\n\n  DW, $DR116,\n  CL, $DS116,\n  SM, $DT116,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY116*(DE116*OtherDamage*SL+UWDamage*DF116)))",
    "EE116": "IF(INDEX($BI$6:$BI261,BY116)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK116, 0),\n  CF, $DB116,\n  CC, $CZ116,\n  CCUW, $DA116,\n  SCM, $DD116,\n  SCC, $AV$17+INDEX($BI$5:$BI261,BY116+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY116 * (Critical*DO116*$DQ116+DW116*UWCritical)))",
    "EF116": "IF(INDEX($BJ$6:$BJ261,BZ116)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK116*1%, 1),\n  CF, $DB116,\n  CC, $CZ116,\n  CCUW, $DA116,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ261,BZ116+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC116,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY116*(Critical*DO116*$DQ116+DW116*UWCritical)))",
    "EG116": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK261,CA116)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH116,\n  Rapid, DG116,\n  DPM, (1+$DI116*$DJ116*$AQ$9),\n  Rend, $DN116,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK261,CA116+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM116*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116, $DB116), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK261,CA116+1)-1))/(45-CM116*3),1),\n\n  SL, $DQ116,\n  DW, $DR116,\n  CL, $DS116,\n  SM, $DT116,\n  SLM, $DU116,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY116*(DE116*OtherDamage*SL+UwDamage*DF116)))",
    "EH116": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL261,CB116+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL261,CB116)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH116,\n  Rapid, DG116,\n  DPM, (1+$DI116*$DJ116*$AQ$9),\n  SuperTower, $DL116,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL261,CB116+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY116*(DE116*OtherDamage*$DQ116+DW116*DF116)))",
    "EI116": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM261,CC116)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116, $DB116), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK116),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV116, $AR$29), 0),\n\n  DW, $DR116,\n  CL, $DS116,\n  SM, $DT116,\n  SL, $DQ116,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM116, UltCritCard),\nCY116*(DE116*DO116*SL+UwDamage*DF116)))",
    "EJ116": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN261,CD116)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT116,\n  DamageMastery, $CS116,\n  DemonMastery, $CX116,\n  SPB, INDEX($BN$5:$BN261,CD116+1),\n  ITO, $CV116,\n  Shock, $CW116,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE116*DO116*$DQ116+DW116*DF116)))",
    "EK116": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO261,CE116)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT116,\n  DamageMastery, $CS116,\n  DemonMastery, $CX116,\n  SPB, $CU116,\n  ITO, INDEX($BO$5:$BO261,CE116+1),\n  Shock, $CW116,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE116*DO116*$DQ116+DW116*DF116)))",
    "EL116": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP261,CF116)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116, $DB116), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP116),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF116),\n  CL, $DS116,\n  SM, $DT116,\n  SLM, $DU116,\n  SL, $DQ116,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM116, UltCritCard),\nCY116*(DE116*DO116*SL+UwDamage*DF116)))",
    "EM116": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ261,CG116)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG116+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN116": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR261,CH116)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116, $DB116), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH116+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP116),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK116),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM261,CC116), SMHeat, $AR$29), 0),\n\n  DW, $DR116,\n  CL, $DS116,\n  SL, $DQ116,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM116, UltCritCard),\nCY116*(DE116*DO116*SL+UwDamage*DF116)))",
    "EO116": "IF(OR(CI116 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI116+1))",
    "EP116": "IF(OR($AO$25, CJ116 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ116+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE260,BU116),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL116, 1),\n  DPM, (1+$DI116*CardRangeMastery*$DJ116*$AQ$9),\n  SuperTower, $DL116,\n  Rend, $DN116,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116, $DB116), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR116,\n  SM, $DT116,\n  SLM, $DU116,\n  SL, $DQ116,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM116, UltCritCard),\n\nCY116*(DE116*OtherDamage*SL+UwDamage*DF116)))",
    "EQ116": "IF(OR(CK116 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK116+1)*1%, 1),\n  CF, $DB116,\n  CC, MIN(100%, $CZ116 + 1%),\n  CCUW, DA116 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ261,BZ116) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC116 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR116,\n  CL, $DS116,\n  SM, $DT116,\n  SLM, $DU116,\n  SL, $DQ116,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM116, UltCritCard),\n\nCY116 * (Critical*DO116*SL+UwDamage*UWCritical)))",
    "ER116": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL116 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH261,BX116),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL116+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI116*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM261,CC116), $DV116, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH116,\n  Rapid, DG116,\n  SuperTower, $DL116,\n  Rend, $DN116,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM116,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116, $DB116), 1),\n\n  DW, $DR116,\n  CL, $DS116,\n  SM, $DT116,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY116*(DE116*OtherDamage*SL+UWDamage*DF116)))",
    "ES116": "IF(OR(CM116 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH116,\n  Rapid, DG116,\n  RDPM, (1+$DI116*$DJ116*$AQ$9),\n  Rend, $DN116,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK261,CA116),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM116+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116, $DB116), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR116,\n  CL, $DS116,\n  SM, $DT116,\n  SLM, $DU116,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY116*(DE116*OtherDamage*SL+UwDamage*DF116)))",
    "ET116": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN116 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM116,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN116+1, $DB116), 1),\n\n  DW, $DR116,\n  CL, $DS116,\n  SM, $DT116,\n  SLM, $DU116,\n  SL, $DQ116,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY116*(DE116*DO116*SL+UWDamage*DF116)))",
    "EU116": "IF(OR(NOT($BA$3), NOT($BA$23), $CO116 > $BA$15), \"\", 1 + 0.5*(CO116+1))",
    "EW116": "IF(DZ116=\"\", \"\", LET(\n  Now, CT116,\n  Next, DZ116,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT116),\nFactor/Cost))",
    "EX116": "IF(EA116=\"\",\"\",(EA116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU116))",
    "EY116": "IF(EB116=\"\",\"\",(EB116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV116))",
    "EZ116": "IF(EC116=\"\",\"\",(EC116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW116))",
    "FA116": "IF(ED116=\"\",\"\",(ED116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX116))",
    "FB116": "IF(EE116=\"\",\"\",(EE116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY116))",
    "FC116": "IF(EF116=\"\",\"\",(EF116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ116))",
    "FD116": "IF(EG116=\"\",\"\",(EG116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA116))",
    "FE116": "IF(EH116=\"\",\"\",(EH116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB116))",
    "FF116": "IF(EI116=\"\",\"\",(EI116/$DX116-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC116+1, 1, CC116))))",
    "FG116": "IF(EJ116=\"\",\"\",(EJ116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD116))",
    "FH116": "IF(EK116=\"\",\"\",(EK116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE116))",
    "FI116": "IF(EL116=\"\",\"\",(EL116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF116))",
    "FJ116": "IF(EM116=\"\", \"\", LET(\n  Now, CW116,\n  Next, EM116,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG116),\nFactor/Cost))",
    "FK116": "IF(EN116=\"\",\"\",(EN116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH116))",
    "FL116": "IF(EO116=\"\", \"\", LET(\n  Now, CS116,\n  Next, EO116,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI116),\nFactor/Cost))",
    "FM116": "IF(EP116=\"\",\"\",(EP116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ116))",
    "FN116": "IF(EQ116=\"\",\"\",(EQ116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK116))",
    "FO116": "IF(ER116=\"\",\"\",(ER116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL116))",
    "FP116": "IF(ES116=\"\",\"\",(ES116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM116))",
    "FQ116": "IF(ET116=\"\",\"\",(ET116/$DX116-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN116))",
    "FR116": "IF(EU116=\"\", \"\", LET(\n  Now, CX116,\n  Next, EU116,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO116),\nFactor/Cost))",
    "FT116": "IF(COLUMN(EW116:FR116) = MIN(IF(EW116:FR116=MAX(EW116:FR116), COLUMN(EW116:FR116))), 1, \"\")",
    "D117": "IF(SUM(FT116:GP116),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F117)),\"Card Mastery\",F117),G117)/$D$5,\"\")",
    "F117": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT116:GP116),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT116:GP116=1)),)\"),\"Attack Speed\")",
    "G117": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT116:GP116),ARRAYFORMULA(FILTER(BT116:CP116 , FT116:GP116=1)),\"\"\"\")\"),26.0)",
    "I117": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT116:GP116),ARRAYFORMULA(FILTER(EW116:FS116 , FT116:GP116=1))*D$5,\"\"\"\")\"),0.0068233644499844865)",
    "K117": "IF(H117<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D117)),)",
    "BT117": "BT116+FT116",
    "BU117": "BU116+FU116",
    "BV117": "BV116+FV116",
    "BW117": "BW116+FW116",
    "BX117": "BX116+FX116",
    "BY117": "BY116+FY116",
    "BZ117": "BZ116+FZ116",
    "CA117": "CA116+GA116",
    "CB117": "CB116+GB116",
    "CC117": "CC116+GC116",
    "CD117": "CD116+GD116",
    "CE117": "CE116+GE116",
    "CF117": "CF116+GF116",
    "CG117": "CG116+GG116",
    "CH117": "CH116+GH116",
    "CI117": "CI116+GI116",
    "CJ117": "CJ116+GJ116",
    "CK117": "CK116+GK116",
    "CL117": "CL116+GL116",
    "CM117": "CM116+GM116",
    "CN117": "CN116+GN116",
    "CO117": "CO116+GO116",
    "CS117": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI117,1)",
    "CT117": "INDEX($BD$5:$BD262,BT117)",
    "CU117": "INDEX($BN$5:$BN262,CD117)",
    "CV117": "INDEX($BO$5:$BO262,CE117)",
    "CW117": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG117)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX117": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO117, 1)",
    "CY117": "LET(\n  Base, $CR$6,\n  Damage, $CT117,\n  DamageMastery, $CS117,\n  DemonMastery, $CX117,\n  SPB, $CU117,\n  ITO, $CV117,\n  Shock, $CW117,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ117": "MIN(100%, DA117)",
    "DA117": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK117*1%, 0)",
    "DB117": "LET(\n  Lab, 1+INDEX($BF$5:$BF262,BV117),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC117": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK117*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI262,BY117) + CardCritMastery)",
    "DD117": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK117*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ262,BZ117) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE117": "LET(\n  CF, $DB117,\n  CC, $CZ117,\n  SCM, $DD117,\n  SCC, $DC117,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF117": "LET(\n  CF, $DB117,\n  CC, $DA117,\n  SCM, $DD117,\n  SCC, $DC117,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG117": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH117)), 0)",
    "DH117": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ117*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE262,BU117),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI117": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG262, BW117), 1) + $AE$9)",
    "DJ117": "LET(\n  DpmLab, INDEX($BH$5:$BH262,BX117),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL117, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK117": "(1+$DI117*$DJ117*$AQ$9)",
    "DL117": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK262,CA117),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM117*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM117": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK262,CA117),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM117*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN117": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL262,CB117)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO117": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH117,\n  Rapid, DG117,\n  RDPM, DK117,\n  SuperTower, $DL117,\n  Rend, $DN117,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP117": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ117": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK117),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR117": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP117),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF117-1))",
    "DS117": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG117, DH117),0))",
    "DT117": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP117),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV117, $AR$29), 0))",
    "DU117": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK117),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM262,CC117), $DV117, $AR$29), 0))",
    "DV117": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH117), $AO$29)",
    "DW117": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM117,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117, $DB117), 1),\n\n  DW, $DR117,\n  CL, $DS117,\n  SM, $DT117,\n  SLM, $DU117,\n  SL, $DQ117,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX117": "CY117*(DE117*DO117*DQ117+DW117*DF117)",
    "DZ117": "IF(INDEX($BD$6:$BD262,BT117)=\"\", \"\", INDEX($BD$5:$BD262,BT117+1))",
    "EA117": "IF(OR($AO$25, INDEX($BE$6:$BE262,BU117)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ117)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE262,BU117+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI117*$DJ117*$AQ$9),\n  SuperTower, $DL117,\n  Rend, $DN117,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117, $DB117), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR117,\n  SM, $DT117,\n  SLM, $DU117,\n  SL, $DQ117,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM117, UltCritCard),\n\nCY117*(DE117*OtherDamage*SL+UwDamage*DF117)))",
    "EB117": "IF(INDEX($BF$6:$BF262,BV117)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF262,BV117+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ117,\n  CCUW, $DA117,\n  SCM, $DD117,\n  SCC, $DC117,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117, CF), 1),\n\n  DW, $DR117,\n  CL, $DS117,\n  SM, $DT117,\n  SLM, $DU117,\n  SL, $DQ117,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM117, UltCritCard),\n\nCY117 * (Critical * DO117 * SL + UwDamage * UWCritical)))",
    "EC117": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG262,BW117)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH117,\n  Rapid, DG117,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG262, BW117+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ117*$AQ$9),\n  SuperTower, $DL117,\n  Rend, $DN117,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM262,CC117), $DV117, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM117,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117, $DB117), 1),\n\n  DW, $DR117,\n  CL, $DS117,\n  SM, $DT117,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY117*(DE117*OtherDamage*SL+UWDamage*DF117)))",
    "ED117": "IF(OR($AO$25, INDEX($BH$6:$BH262,BX117)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH262,BX117+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL117, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI117*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM262,CC117), $DV117, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH117,\n  Rapid, DG117,\n  SuperTower, $DL117,\n  Rend, $DN117,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM117,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117, $DB117), 1),\n\n  DW, $DR117,\n  CL, $DS117,\n  SM, $DT117,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY117*(DE117*OtherDamage*SL+UWDamage*DF117)))",
    "EE117": "IF(INDEX($BI$6:$BI262,BY117)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK117, 0),\n  CF, $DB117,\n  CC, $CZ117,\n  CCUW, $DA117,\n  SCM, $DD117,\n  SCC, $AV$17+INDEX($BI$5:$BI262,BY117+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY117 * (Critical*DO117*$DQ117+DW117*UWCritical)))",
    "EF117": "IF(INDEX($BJ$6:$BJ262,BZ117)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK117*1%, 1),\n  CF, $DB117,\n  CC, $CZ117,\n  CCUW, $DA117,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ262,BZ117+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC117,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY117*(Critical*DO117*$DQ117+DW117*UWCritical)))",
    "EG117": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK262,CA117)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH117,\n  Rapid, DG117,\n  DPM, (1+$DI117*$DJ117*$AQ$9),\n  Rend, $DN117,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK262,CA117+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM117*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117, $DB117), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK262,CA117+1)-1))/(45-CM117*3),1),\n\n  SL, $DQ117,\n  DW, $DR117,\n  CL, $DS117,\n  SM, $DT117,\n  SLM, $DU117,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY117*(DE117*OtherDamage*SL+UwDamage*DF117)))",
    "EH117": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL262,CB117+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL262,CB117)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH117,\n  Rapid, DG117,\n  DPM, (1+$DI117*$DJ117*$AQ$9),\n  SuperTower, $DL117,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL262,CB117+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY117*(DE117*OtherDamage*$DQ117+DW117*DF117)))",
    "EI117": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM262,CC117)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117, $DB117), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK117),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV117, $AR$29), 0),\n\n  DW, $DR117,\n  CL, $DS117,\n  SM, $DT117,\n  SL, $DQ117,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM117, UltCritCard),\nCY117*(DE117*DO117*SL+UwDamage*DF117)))",
    "EJ117": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN262,CD117)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT117,\n  DamageMastery, $CS117,\n  DemonMastery, $CX117,\n  SPB, INDEX($BN$5:$BN262,CD117+1),\n  ITO, $CV117,\n  Shock, $CW117,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE117*DO117*$DQ117+DW117*DF117)))",
    "EK117": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO262,CE117)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT117,\n  DamageMastery, $CS117,\n  DemonMastery, $CX117,\n  SPB, $CU117,\n  ITO, INDEX($BO$5:$BO262,CE117+1),\n  Shock, $CW117,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE117*DO117*$DQ117+DW117*DF117)))",
    "EL117": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP262,CF117)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117, $DB117), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP117),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF117),\n  CL, $DS117,\n  SM, $DT117,\n  SLM, $DU117,\n  SL, $DQ117,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM117, UltCritCard),\nCY117*(DE117*DO117*SL+UwDamage*DF117)))",
    "EM117": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ262,CG117)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG117+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN117": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR262,CH117)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117, $DB117), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH117+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP117),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK117),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM262,CC117), SMHeat, $AR$29), 0),\n\n  DW, $DR117,\n  CL, $DS117,\n  SL, $DQ117,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM117, UltCritCard),\nCY117*(DE117*DO117*SL+UwDamage*DF117)))",
    "EO117": "IF(OR(CI117 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI117+1))",
    "EP117": "IF(OR($AO$25, CJ117 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ117+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE261,BU117),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL117, 1),\n  DPM, (1+$DI117*CardRangeMastery*$DJ117*$AQ$9),\n  SuperTower, $DL117,\n  Rend, $DN117,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117, $DB117), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR117,\n  SM, $DT117,\n  SLM, $DU117,\n  SL, $DQ117,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM117, UltCritCard),\n\nCY117*(DE117*OtherDamage*SL+UwDamage*DF117)))",
    "EQ117": "IF(OR(CK117 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK117+1)*1%, 1),\n  CF, $DB117,\n  CC, MIN(100%, $CZ117 + 1%),\n  CCUW, DA117 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ262,BZ117) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC117 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR117,\n  CL, $DS117,\n  SM, $DT117,\n  SLM, $DU117,\n  SL, $DQ117,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM117, UltCritCard),\n\nCY117 * (Critical*DO117*SL+UwDamage*UWCritical)))",
    "ER117": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL117 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH262,BX117),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL117+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI117*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM262,CC117), $DV117, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH117,\n  Rapid, DG117,\n  SuperTower, $DL117,\n  Rend, $DN117,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM117,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117, $DB117), 1),\n\n  DW, $DR117,\n  CL, $DS117,\n  SM, $DT117,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY117*(DE117*OtherDamage*SL+UWDamage*DF117)))",
    "ES117": "IF(OR(CM117 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH117,\n  Rapid, DG117,\n  RDPM, (1+$DI117*$DJ117*$AQ$9),\n  Rend, $DN117,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK262,CA117),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM117+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117, $DB117), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR117,\n  CL, $DS117,\n  SM, $DT117,\n  SLM, $DU117,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY117*(DE117*OtherDamage*SL+UwDamage*DF117)))",
    "ET117": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN117 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM117,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN117+1, $DB117), 1),\n\n  DW, $DR117,\n  CL, $DS117,\n  SM, $DT117,\n  SLM, $DU117,\n  SL, $DQ117,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY117*(DE117*DO117*SL+UWDamage*DF117)))",
    "EU117": "IF(OR(NOT($BA$3), NOT($BA$23), $CO117 > $BA$15), \"\", 1 + 0.5*(CO117+1))",
    "EW117": "IF(DZ117=\"\", \"\", LET(\n  Now, CT117,\n  Next, DZ117,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT117),\nFactor/Cost))",
    "EX117": "IF(EA117=\"\",\"\",(EA117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU117))",
    "EY117": "IF(EB117=\"\",\"\",(EB117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV117))",
    "EZ117": "IF(EC117=\"\",\"\",(EC117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW117))",
    "FA117": "IF(ED117=\"\",\"\",(ED117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX117))",
    "FB117": "IF(EE117=\"\",\"\",(EE117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY117))",
    "FC117": "IF(EF117=\"\",\"\",(EF117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ117))",
    "FD117": "IF(EG117=\"\",\"\",(EG117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA117))",
    "FE117": "IF(EH117=\"\",\"\",(EH117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB117))",
    "FF117": "IF(EI117=\"\",\"\",(EI117/$DX117-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC117+1, 1, CC117))))",
    "FG117": "IF(EJ117=\"\",\"\",(EJ117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD117))",
    "FH117": "IF(EK117=\"\",\"\",(EK117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE117))",
    "FI117": "IF(EL117=\"\",\"\",(EL117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF117))",
    "FJ117": "IF(EM117=\"\", \"\", LET(\n  Now, CW117,\n  Next, EM117,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG117),\nFactor/Cost))",
    "FK117": "IF(EN117=\"\",\"\",(EN117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH117))",
    "FL117": "IF(EO117=\"\", \"\", LET(\n  Now, CS117,\n  Next, EO117,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI117),\nFactor/Cost))",
    "FM117": "IF(EP117=\"\",\"\",(EP117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ117))",
    "FN117": "IF(EQ117=\"\",\"\",(EQ117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK117))",
    "FO117": "IF(ER117=\"\",\"\",(ER117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL117))",
    "FP117": "IF(ES117=\"\",\"\",(ES117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM117))",
    "FQ117": "IF(ET117=\"\",\"\",(ET117/$DX117-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN117))",
    "FR117": "IF(EU117=\"\", \"\", LET(\n  Now, CX117,\n  Next, EU117,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO117),\nFactor/Cost))",
    "FT117": "IF(COLUMN(EW117:FR117) = MIN(IF(EW117:FR117=MAX(EW117:FR117), COLUMN(EW117:FR117))), 1, \"\")",
    "D118": "IF(SUM(FT117:GP117),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F118)),\"Card Mastery\",F118),G118)/$D$5,\"\")",
    "F118": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT117:GP117),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT117:GP117=1)),)\"),\"Damage / Meter\")",
    "G118": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT117:GP117),ARRAYFORMULA(FILTER(BT117:CP117 , FT117:GP117=1)),\"\"\"\")\"),20.0)",
    "I118": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT117:GP117),ARRAYFORMULA(FILTER(EW117:FS117 , FT117:GP117=1))*D$5,\"\"\"\")\"),0.006665644903067017)",
    "K118": "IF(H118<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D118)),)",
    "BT118": "BT117+FT117",
    "BU118": "BU117+FU117",
    "BV118": "BV117+FV117",
    "BW118": "BW117+FW117",
    "BX118": "BX117+FX117",
    "BY118": "BY117+FY117",
    "BZ118": "BZ117+FZ117",
    "CA118": "CA117+GA117",
    "CB118": "CB117+GB117",
    "CC118": "CC117+GC117",
    "CD118": "CD117+GD117",
    "CE118": "CE117+GE117",
    "CF118": "CF117+GF117",
    "CG118": "CG117+GG117",
    "CH118": "CH117+GH117",
    "CI118": "CI117+GI117",
    "CJ118": "CJ117+GJ117",
    "CK118": "CK117+GK117",
    "CL118": "CL117+GL117",
    "CM118": "CM117+GM117",
    "CN118": "CN117+GN117",
    "CO118": "CO117+GO117",
    "CS118": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI118,1)",
    "CT118": "INDEX($BD$5:$BD263,BT118)",
    "CU118": "INDEX($BN$5:$BN263,CD118)",
    "CV118": "INDEX($BO$5:$BO263,CE118)",
    "CW118": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG118)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX118": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO118, 1)",
    "CY118": "LET(\n  Base, $CR$6,\n  Damage, $CT118,\n  DamageMastery, $CS118,\n  DemonMastery, $CX118,\n  SPB, $CU118,\n  ITO, $CV118,\n  Shock, $CW118,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ118": "MIN(100%, DA118)",
    "DA118": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK118*1%, 0)",
    "DB118": "LET(\n  Lab, 1+INDEX($BF$5:$BF263,BV118),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC118": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK118*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI263,BY118) + CardCritMastery)",
    "DD118": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK118*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ263,BZ118) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE118": "LET(\n  CF, $DB118,\n  CC, $CZ118,\n  SCM, $DD118,\n  SCC, $DC118,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF118": "LET(\n  CF, $DB118,\n  CC, $DA118,\n  SCM, $DD118,\n  SCC, $DC118,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG118": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH118)), 0)",
    "DH118": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ118*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE263,BU118),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI118": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG263, BW118), 1) + $AE$9)",
    "DJ118": "LET(\n  DpmLab, INDEX($BH$5:$BH263,BX118),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL118, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK118": "(1+$DI118*$DJ118*$AQ$9)",
    "DL118": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK263,CA118),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM118*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM118": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK263,CA118),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM118*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN118": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL263,CB118)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO118": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH118,\n  Rapid, DG118,\n  RDPM, DK118,\n  SuperTower, $DL118,\n  Rend, $DN118,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP118": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ118": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK118),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR118": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP118),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF118-1))",
    "DS118": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG118, DH118),0))",
    "DT118": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP118),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV118, $AR$29), 0))",
    "DU118": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK118),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM263,CC118), $DV118, $AR$29), 0))",
    "DV118": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH118), $AO$29)",
    "DW118": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM118,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118, $DB118), 1),\n\n  DW, $DR118,\n  CL, $DS118,\n  SM, $DT118,\n  SLM, $DU118,\n  SL, $DQ118,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX118": "CY118*(DE118*DO118*DQ118+DW118*DF118)",
    "DZ118": "IF(INDEX($BD$6:$BD263,BT118)=\"\", \"\", INDEX($BD$5:$BD263,BT118+1))",
    "EA118": "IF(OR($AO$25, INDEX($BE$6:$BE263,BU118)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ118)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE263,BU118+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI118*$DJ118*$AQ$9),\n  SuperTower, $DL118,\n  Rend, $DN118,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118, $DB118), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR118,\n  SM, $DT118,\n  SLM, $DU118,\n  SL, $DQ118,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM118, UltCritCard),\n\nCY118*(DE118*OtherDamage*SL+UwDamage*DF118)))",
    "EB118": "IF(INDEX($BF$6:$BF263,BV118)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF263,BV118+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ118,\n  CCUW, $DA118,\n  SCM, $DD118,\n  SCC, $DC118,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118, CF), 1),\n\n  DW, $DR118,\n  CL, $DS118,\n  SM, $DT118,\n  SLM, $DU118,\n  SL, $DQ118,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM118, UltCritCard),\n\nCY118 * (Critical * DO118 * SL + UwDamage * UWCritical)))",
    "EC118": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG263,BW118)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH118,\n  Rapid, DG118,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG263, BW118+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ118*$AQ$9),\n  SuperTower, $DL118,\n  Rend, $DN118,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM263,CC118), $DV118, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM118,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118, $DB118), 1),\n\n  DW, $DR118,\n  CL, $DS118,\n  SM, $DT118,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY118*(DE118*OtherDamage*SL+UWDamage*DF118)))",
    "ED118": "IF(OR($AO$25, INDEX($BH$6:$BH263,BX118)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH263,BX118+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL118, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI118*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM263,CC118), $DV118, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH118,\n  Rapid, DG118,\n  SuperTower, $DL118,\n  Rend, $DN118,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM118,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118, $DB118), 1),\n\n  DW, $DR118,\n  CL, $DS118,\n  SM, $DT118,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY118*(DE118*OtherDamage*SL+UWDamage*DF118)))",
    "EE118": "IF(INDEX($BI$6:$BI263,BY118)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK118, 0),\n  CF, $DB118,\n  CC, $CZ118,\n  CCUW, $DA118,\n  SCM, $DD118,\n  SCC, $AV$17+INDEX($BI$5:$BI263,BY118+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY118 * (Critical*DO118*$DQ118+DW118*UWCritical)))",
    "EF118": "IF(INDEX($BJ$6:$BJ263,BZ118)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK118*1%, 1),\n  CF, $DB118,\n  CC, $CZ118,\n  CCUW, $DA118,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ263,BZ118+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC118,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY118*(Critical*DO118*$DQ118+DW118*UWCritical)))",
    "EG118": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK263,CA118)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH118,\n  Rapid, DG118,\n  DPM, (1+$DI118*$DJ118*$AQ$9),\n  Rend, $DN118,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK263,CA118+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM118*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118, $DB118), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK263,CA118+1)-1))/(45-CM118*3),1),\n\n  SL, $DQ118,\n  DW, $DR118,\n  CL, $DS118,\n  SM, $DT118,\n  SLM, $DU118,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY118*(DE118*OtherDamage*SL+UwDamage*DF118)))",
    "EH118": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL263,CB118+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL263,CB118)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH118,\n  Rapid, DG118,\n  DPM, (1+$DI118*$DJ118*$AQ$9),\n  SuperTower, $DL118,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL263,CB118+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY118*(DE118*OtherDamage*$DQ118+DW118*DF118)))",
    "EI118": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM263,CC118)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118, $DB118), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK118),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV118, $AR$29), 0),\n\n  DW, $DR118,\n  CL, $DS118,\n  SM, $DT118,\n  SL, $DQ118,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM118, UltCritCard),\nCY118*(DE118*DO118*SL+UwDamage*DF118)))",
    "EJ118": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN263,CD118)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT118,\n  DamageMastery, $CS118,\n  DemonMastery, $CX118,\n  SPB, INDEX($BN$5:$BN263,CD118+1),\n  ITO, $CV118,\n  Shock, $CW118,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE118*DO118*$DQ118+DW118*DF118)))",
    "EK118": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO263,CE118)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT118,\n  DamageMastery, $CS118,\n  DemonMastery, $CX118,\n  SPB, $CU118,\n  ITO, INDEX($BO$5:$BO263,CE118+1),\n  Shock, $CW118,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE118*DO118*$DQ118+DW118*DF118)))",
    "EL118": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP263,CF118)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118, $DB118), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP118),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF118),\n  CL, $DS118,\n  SM, $DT118,\n  SLM, $DU118,\n  SL, $DQ118,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM118, UltCritCard),\nCY118*(DE118*DO118*SL+UwDamage*DF118)))",
    "EM118": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ263,CG118)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG118+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN118": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR263,CH118)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118, $DB118), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH118+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP118),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK118),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM263,CC118), SMHeat, $AR$29), 0),\n\n  DW, $DR118,\n  CL, $DS118,\n  SL, $DQ118,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM118, UltCritCard),\nCY118*(DE118*DO118*SL+UwDamage*DF118)))",
    "EO118": "IF(OR(CI118 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI118+1))",
    "EP118": "IF(OR($AO$25, CJ118 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ118+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE262,BU118),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL118, 1),\n  DPM, (1+$DI118*CardRangeMastery*$DJ118*$AQ$9),\n  SuperTower, $DL118,\n  Rend, $DN118,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118, $DB118), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR118,\n  SM, $DT118,\n  SLM, $DU118,\n  SL, $DQ118,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM118, UltCritCard),\n\nCY118*(DE118*OtherDamage*SL+UwDamage*DF118)))",
    "EQ118": "IF(OR(CK118 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK118+1)*1%, 1),\n  CF, $DB118,\n  CC, MIN(100%, $CZ118 + 1%),\n  CCUW, DA118 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ263,BZ118) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC118 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR118,\n  CL, $DS118,\n  SM, $DT118,\n  SLM, $DU118,\n  SL, $DQ118,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM118, UltCritCard),\n\nCY118 * (Critical*DO118*SL+UwDamage*UWCritical)))",
    "ER118": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL118 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH263,BX118),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL118+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI118*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM263,CC118), $DV118, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH118,\n  Rapid, DG118,\n  SuperTower, $DL118,\n  Rend, $DN118,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM118,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118, $DB118), 1),\n\n  DW, $DR118,\n  CL, $DS118,\n  SM, $DT118,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY118*(DE118*OtherDamage*SL+UWDamage*DF118)))",
    "ES118": "IF(OR(CM118 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH118,\n  Rapid, DG118,\n  RDPM, (1+$DI118*$DJ118*$AQ$9),\n  Rend, $DN118,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK263,CA118),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM118+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118, $DB118), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR118,\n  CL, $DS118,\n  SM, $DT118,\n  SLM, $DU118,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY118*(DE118*OtherDamage*SL+UwDamage*DF118)))",
    "ET118": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN118 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM118,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN118+1, $DB118), 1),\n\n  DW, $DR118,\n  CL, $DS118,\n  SM, $DT118,\n  SLM, $DU118,\n  SL, $DQ118,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY118*(DE118*DO118*SL+UWDamage*DF118)))",
    "EU118": "IF(OR(NOT($BA$3), NOT($BA$23), $CO118 > $BA$15), \"\", 1 + 0.5*(CO118+1))",
    "EW118": "IF(DZ118=\"\", \"\", LET(\n  Now, CT118,\n  Next, DZ118,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT118),\nFactor/Cost))",
    "EX118": "IF(EA118=\"\",\"\",(EA118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU118))",
    "EY118": "IF(EB118=\"\",\"\",(EB118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV118))",
    "EZ118": "IF(EC118=\"\",\"\",(EC118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW118))",
    "FA118": "IF(ED118=\"\",\"\",(ED118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX118))",
    "FB118": "IF(EE118=\"\",\"\",(EE118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY118))",
    "FC118": "IF(EF118=\"\",\"\",(EF118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ118))",
    "FD118": "IF(EG118=\"\",\"\",(EG118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA118))",
    "FE118": "IF(EH118=\"\",\"\",(EH118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB118))",
    "FF118": "IF(EI118=\"\",\"\",(EI118/$DX118-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC118+1, 1, CC118))))",
    "FG118": "IF(EJ118=\"\",\"\",(EJ118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD118))",
    "FH118": "IF(EK118=\"\",\"\",(EK118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE118))",
    "FI118": "IF(EL118=\"\",\"\",(EL118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF118))",
    "FJ118": "IF(EM118=\"\", \"\", LET(\n  Now, CW118,\n  Next, EM118,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG118),\nFactor/Cost))",
    "FK118": "IF(EN118=\"\",\"\",(EN118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH118))",
    "FL118": "IF(EO118=\"\", \"\", LET(\n  Now, CS118,\n  Next, EO118,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI118),\nFactor/Cost))",
    "FM118": "IF(EP118=\"\",\"\",(EP118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ118))",
    "FN118": "IF(EQ118=\"\",\"\",(EQ118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK118))",
    "FO118": "IF(ER118=\"\",\"\",(ER118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL118))",
    "FP118": "IF(ES118=\"\",\"\",(ES118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM118))",
    "FQ118": "IF(ET118=\"\",\"\",(ET118/$DX118-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN118))",
    "FR118": "IF(EU118=\"\", \"\", LET(\n  Now, CX118,\n  Next, EU118,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO118),\nFactor/Cost))",
    "FT118": "IF(COLUMN(EW118:FR118) = MIN(IF(EW118:FR118=MAX(EW118:FR118), COLUMN(EW118:FR118))), 1, \"\")",
    "D119": "IF(SUM(FT118:GP118),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F119)),\"Card Mastery\",F119),G119)/$D$5,\"\")",
    "F119": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT118:GP118),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT118:GP118=1)),)\"),\"Critical Factor\")",
    "G119": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT118:GP118),ARRAYFORMULA(FILTER(BT118:CP118 , FT118:GP118=1)),\"\"\"\")\"),29.0)",
    "I119": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT118:GP118),ARRAYFORMULA(FILTER(EW118:FS118 , FT118:GP118=1))*D$5,\"\"\"\")\"),0.006562591609923306)",
    "K119": "IF(H119<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D119)),)",
    "BT119": "BT118+FT118",
    "BU119": "BU118+FU118",
    "BV119": "BV118+FV118",
    "BW119": "BW118+FW118",
    "BX119": "BX118+FX118",
    "BY119": "BY118+FY118",
    "BZ119": "BZ118+FZ118",
    "CA119": "CA118+GA118",
    "CB119": "CB118+GB118",
    "CC119": "CC118+GC118",
    "CD119": "CD118+GD118",
    "CE119": "CE118+GE118",
    "CF119": "CF118+GF118",
    "CG119": "CG118+GG118",
    "CH119": "CH118+GH118",
    "CI119": "CI118+GI118",
    "CJ119": "CJ118+GJ118",
    "CK119": "CK118+GK118",
    "CL119": "CL118+GL118",
    "CM119": "CM118+GM118",
    "CN119": "CN118+GN118",
    "CO119": "CO118+GO118",
    "CS119": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI119,1)",
    "CT119": "INDEX($BD$5:$BD264,BT119)",
    "CU119": "INDEX($BN$5:$BN264,CD119)",
    "CV119": "INDEX($BO$5:$BO264,CE119)",
    "CW119": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG119)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX119": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO119, 1)",
    "CY119": "LET(\n  Base, $CR$6,\n  Damage, $CT119,\n  DamageMastery, $CS119,\n  DemonMastery, $CX119,\n  SPB, $CU119,\n  ITO, $CV119,\n  Shock, $CW119,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ119": "MIN(100%, DA119)",
    "DA119": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK119*1%, 0)",
    "DB119": "LET(\n  Lab, 1+INDEX($BF$5:$BF264,BV119),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC119": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK119*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI264,BY119) + CardCritMastery)",
    "DD119": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK119*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ264,BZ119) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE119": "LET(\n  CF, $DB119,\n  CC, $CZ119,\n  SCM, $DD119,\n  SCC, $DC119,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF119": "LET(\n  CF, $DB119,\n  CC, $DA119,\n  SCM, $DD119,\n  SCC, $DC119,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG119": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH119)), 0)",
    "DH119": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ119*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE264,BU119),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI119": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG264, BW119), 1) + $AE$9)",
    "DJ119": "LET(\n  DpmLab, INDEX($BH$5:$BH264,BX119),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL119, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK119": "(1+$DI119*$DJ119*$AQ$9)",
    "DL119": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK264,CA119),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM119*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM119": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK264,CA119),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM119*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN119": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL264,CB119)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO119": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH119,\n  Rapid, DG119,\n  RDPM, DK119,\n  SuperTower, $DL119,\n  Rend, $DN119,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP119": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ119": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK119),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR119": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP119),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF119-1))",
    "DS119": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG119, DH119),0))",
    "DT119": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP119),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV119, $AR$29), 0))",
    "DU119": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK119),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM264,CC119), $DV119, $AR$29), 0))",
    "DV119": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH119), $AO$29)",
    "DW119": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM119,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119, $DB119), 1),\n\n  DW, $DR119,\n  CL, $DS119,\n  SM, $DT119,\n  SLM, $DU119,\n  SL, $DQ119,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX119": "CY119*(DE119*DO119*DQ119+DW119*DF119)",
    "DZ119": "IF(INDEX($BD$6:$BD264,BT119)=\"\", \"\", INDEX($BD$5:$BD264,BT119+1))",
    "EA119": "IF(OR($AO$25, INDEX($BE$6:$BE264,BU119)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ119)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE264,BU119+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI119*$DJ119*$AQ$9),\n  SuperTower, $DL119,\n  Rend, $DN119,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119, $DB119), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR119,\n  SM, $DT119,\n  SLM, $DU119,\n  SL, $DQ119,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM119, UltCritCard),\n\nCY119*(DE119*OtherDamage*SL+UwDamage*DF119)))",
    "EB119": "IF(INDEX($BF$6:$BF264,BV119)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF264,BV119+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ119,\n  CCUW, $DA119,\n  SCM, $DD119,\n  SCC, $DC119,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119, CF), 1),\n\n  DW, $DR119,\n  CL, $DS119,\n  SM, $DT119,\n  SLM, $DU119,\n  SL, $DQ119,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM119, UltCritCard),\n\nCY119 * (Critical * DO119 * SL + UwDamage * UWCritical)))",
    "EC119": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG264,BW119)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH119,\n  Rapid, DG119,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG264, BW119+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ119*$AQ$9),\n  SuperTower, $DL119,\n  Rend, $DN119,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM264,CC119), $DV119, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM119,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119, $DB119), 1),\n\n  DW, $DR119,\n  CL, $DS119,\n  SM, $DT119,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY119*(DE119*OtherDamage*SL+UWDamage*DF119)))",
    "ED119": "IF(OR($AO$25, INDEX($BH$6:$BH264,BX119)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH264,BX119+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL119, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI119*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM264,CC119), $DV119, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH119,\n  Rapid, DG119,\n  SuperTower, $DL119,\n  Rend, $DN119,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM119,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119, $DB119), 1),\n\n  DW, $DR119,\n  CL, $DS119,\n  SM, $DT119,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY119*(DE119*OtherDamage*SL+UWDamage*DF119)))",
    "EE119": "IF(INDEX($BI$6:$BI264,BY119)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK119, 0),\n  CF, $DB119,\n  CC, $CZ119,\n  CCUW, $DA119,\n  SCM, $DD119,\n  SCC, $AV$17+INDEX($BI$5:$BI264,BY119+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY119 * (Critical*DO119*$DQ119+DW119*UWCritical)))",
    "EF119": "IF(INDEX($BJ$6:$BJ264,BZ119)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK119*1%, 1),\n  CF, $DB119,\n  CC, $CZ119,\n  CCUW, $DA119,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ264,BZ119+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC119,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY119*(Critical*DO119*$DQ119+DW119*UWCritical)))",
    "EG119": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK264,CA119)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH119,\n  Rapid, DG119,\n  DPM, (1+$DI119*$DJ119*$AQ$9),\n  Rend, $DN119,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK264,CA119+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM119*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119, $DB119), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK264,CA119+1)-1))/(45-CM119*3),1),\n\n  SL, $DQ119,\n  DW, $DR119,\n  CL, $DS119,\n  SM, $DT119,\n  SLM, $DU119,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY119*(DE119*OtherDamage*SL+UwDamage*DF119)))",
    "EH119": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL264,CB119+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL264,CB119)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH119,\n  Rapid, DG119,\n  DPM, (1+$DI119*$DJ119*$AQ$9),\n  SuperTower, $DL119,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL264,CB119+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY119*(DE119*OtherDamage*$DQ119+DW119*DF119)))",
    "EI119": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM264,CC119)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119, $DB119), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK119),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV119, $AR$29), 0),\n\n  DW, $DR119,\n  CL, $DS119,\n  SM, $DT119,\n  SL, $DQ119,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM119, UltCritCard),\nCY119*(DE119*DO119*SL+UwDamage*DF119)))",
    "EJ119": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN264,CD119)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT119,\n  DamageMastery, $CS119,\n  DemonMastery, $CX119,\n  SPB, INDEX($BN$5:$BN264,CD119+1),\n  ITO, $CV119,\n  Shock, $CW119,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE119*DO119*$DQ119+DW119*DF119)))",
    "EK119": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO264,CE119)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT119,\n  DamageMastery, $CS119,\n  DemonMastery, $CX119,\n  SPB, $CU119,\n  ITO, INDEX($BO$5:$BO264,CE119+1),\n  Shock, $CW119,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE119*DO119*$DQ119+DW119*DF119)))",
    "EL119": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP264,CF119)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119, $DB119), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP119),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF119),\n  CL, $DS119,\n  SM, $DT119,\n  SLM, $DU119,\n  SL, $DQ119,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM119, UltCritCard),\nCY119*(DE119*DO119*SL+UwDamage*DF119)))",
    "EM119": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ264,CG119)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG119+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN119": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR264,CH119)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119, $DB119), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH119+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP119),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK119),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM264,CC119), SMHeat, $AR$29), 0),\n\n  DW, $DR119,\n  CL, $DS119,\n  SL, $DQ119,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM119, UltCritCard),\nCY119*(DE119*DO119*SL+UwDamage*DF119)))",
    "EO119": "IF(OR(CI119 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI119+1))",
    "EP119": "IF(OR($AO$25, CJ119 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ119+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE263,BU119),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL119, 1),\n  DPM, (1+$DI119*CardRangeMastery*$DJ119*$AQ$9),\n  SuperTower, $DL119,\n  Rend, $DN119,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119, $DB119), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR119,\n  SM, $DT119,\n  SLM, $DU119,\n  SL, $DQ119,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM119, UltCritCard),\n\nCY119*(DE119*OtherDamage*SL+UwDamage*DF119)))",
    "EQ119": "IF(OR(CK119 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK119+1)*1%, 1),\n  CF, $DB119,\n  CC, MIN(100%, $CZ119 + 1%),\n  CCUW, DA119 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ264,BZ119) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC119 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR119,\n  CL, $DS119,\n  SM, $DT119,\n  SLM, $DU119,\n  SL, $DQ119,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM119, UltCritCard),\n\nCY119 * (Critical*DO119*SL+UwDamage*UWCritical)))",
    "ER119": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL119 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH264,BX119),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL119+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI119*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM264,CC119), $DV119, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH119,\n  Rapid, DG119,\n  SuperTower, $DL119,\n  Rend, $DN119,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM119,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119, $DB119), 1),\n\n  DW, $DR119,\n  CL, $DS119,\n  SM, $DT119,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY119*(DE119*OtherDamage*SL+UWDamage*DF119)))",
    "ES119": "IF(OR(CM119 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH119,\n  Rapid, DG119,\n  RDPM, (1+$DI119*$DJ119*$AQ$9),\n  Rend, $DN119,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK264,CA119),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM119+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119, $DB119), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR119,\n  CL, $DS119,\n  SM, $DT119,\n  SLM, $DU119,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY119*(DE119*OtherDamage*SL+UwDamage*DF119)))",
    "ET119": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN119 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM119,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN119+1, $DB119), 1),\n\n  DW, $DR119,\n  CL, $DS119,\n  SM, $DT119,\n  SLM, $DU119,\n  SL, $DQ119,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY119*(DE119*DO119*SL+UWDamage*DF119)))",
    "EU119": "IF(OR(NOT($BA$3), NOT($BA$23), $CO119 > $BA$15), \"\", 1 + 0.5*(CO119+1))",
    "EW119": "IF(DZ119=\"\", \"\", LET(\n  Now, CT119,\n  Next, DZ119,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT119),\nFactor/Cost))",
    "EX119": "IF(EA119=\"\",\"\",(EA119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU119))",
    "EY119": "IF(EB119=\"\",\"\",(EB119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV119))",
    "EZ119": "IF(EC119=\"\",\"\",(EC119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW119))",
    "FA119": "IF(ED119=\"\",\"\",(ED119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX119))",
    "FB119": "IF(EE119=\"\",\"\",(EE119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY119))",
    "FC119": "IF(EF119=\"\",\"\",(EF119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ119))",
    "FD119": "IF(EG119=\"\",\"\",(EG119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA119))",
    "FE119": "IF(EH119=\"\",\"\",(EH119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB119))",
    "FF119": "IF(EI119=\"\",\"\",(EI119/$DX119-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC119+1, 1, CC119))))",
    "FG119": "IF(EJ119=\"\",\"\",(EJ119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD119))",
    "FH119": "IF(EK119=\"\",\"\",(EK119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE119))",
    "FI119": "IF(EL119=\"\",\"\",(EL119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF119))",
    "FJ119": "IF(EM119=\"\", \"\", LET(\n  Now, CW119,\n  Next, EM119,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG119),\nFactor/Cost))",
    "FK119": "IF(EN119=\"\",\"\",(EN119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH119))",
    "FL119": "IF(EO119=\"\", \"\", LET(\n  Now, CS119,\n  Next, EO119,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI119),\nFactor/Cost))",
    "FM119": "IF(EP119=\"\",\"\",(EP119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ119))",
    "FN119": "IF(EQ119=\"\",\"\",(EQ119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK119))",
    "FO119": "IF(ER119=\"\",\"\",(ER119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL119))",
    "FP119": "IF(ES119=\"\",\"\",(ES119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM119))",
    "FQ119": "IF(ET119=\"\",\"\",(ET119/$DX119-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN119))",
    "FR119": "IF(EU119=\"\", \"\", LET(\n  Now, CX119,\n  Next, EU119,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO119),\nFactor/Cost))",
    "FT119": "IF(COLUMN(EW119:FR119) = MIN(IF(EW119:FR119=MAX(EW119:FR119), COLUMN(EW119:FR119))), 1, \"\")",
    "D120": "IF(SUM(FT119:GP119),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F120)),\"Card Mastery\",F120),G120)/$D$5,\"\")",
    "F120": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT119:GP119),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT119:GP119=1)),)\"),\"Standard Perks Bonus\")",
    "G120": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT119:GP119),ARRAYFORMULA(FILTER(BT119:CP119 , FT119:GP119=1)),\"\"\"\")\"),7.0)",
    "I120": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT119:GP119),ARRAYFORMULA(FILTER(EW119:FS119 , FT119:GP119=1))*D$5,\"\"\"\")\"),0.006417055106460801)",
    "K120": "IF(H120<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D120)),)",
    "BT120": "BT119+FT119",
    "BU120": "BU119+FU119",
    "BV120": "BV119+FV119",
    "BW120": "BW119+FW119",
    "BX120": "BX119+FX119",
    "BY120": "BY119+FY119",
    "BZ120": "BZ119+FZ119",
    "CA120": "CA119+GA119",
    "CB120": "CB119+GB119",
    "CC120": "CC119+GC119",
    "CD120": "CD119+GD119",
    "CE120": "CE119+GE119",
    "CF120": "CF119+GF119",
    "CG120": "CG119+GG119",
    "CH120": "CH119+GH119",
    "CI120": "CI119+GI119",
    "CJ120": "CJ119+GJ119",
    "CK120": "CK119+GK119",
    "CL120": "CL119+GL119",
    "CM120": "CM119+GM119",
    "CN120": "CN119+GN119",
    "CO120": "CO119+GO119",
    "CS120": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI120,1)",
    "CT120": "INDEX($BD$5:$BD265,BT120)",
    "CU120": "INDEX($BN$5:$BN265,CD120)",
    "CV120": "INDEX($BO$5:$BO265,CE120)",
    "CW120": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG120)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX120": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO120, 1)",
    "CY120": "LET(\n  Base, $CR$6,\n  Damage, $CT120,\n  DamageMastery, $CS120,\n  DemonMastery, $CX120,\n  SPB, $CU120,\n  ITO, $CV120,\n  Shock, $CW120,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ120": "MIN(100%, DA120)",
    "DA120": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK120*1%, 0)",
    "DB120": "LET(\n  Lab, 1+INDEX($BF$5:$BF265,BV120),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC120": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK120*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI265,BY120) + CardCritMastery)",
    "DD120": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK120*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ265,BZ120) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE120": "LET(\n  CF, $DB120,\n  CC, $CZ120,\n  SCM, $DD120,\n  SCC, $DC120,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF120": "LET(\n  CF, $DB120,\n  CC, $DA120,\n  SCM, $DD120,\n  SCC, $DC120,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG120": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH120)), 0)",
    "DH120": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ120*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE265,BU120),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI120": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG265, BW120), 1) + $AE$9)",
    "DJ120": "LET(\n  DpmLab, INDEX($BH$5:$BH265,BX120),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL120, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK120": "(1+$DI120*$DJ120*$AQ$9)",
    "DL120": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK265,CA120),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM120*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM120": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK265,CA120),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM120*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN120": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL265,CB120)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO120": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH120,\n  Rapid, DG120,\n  RDPM, DK120,\n  SuperTower, $DL120,\n  Rend, $DN120,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP120": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ120": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK120),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR120": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP120),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF120-1))",
    "DS120": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG120, DH120),0))",
    "DT120": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP120),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV120, $AR$29), 0))",
    "DU120": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK120),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM265,CC120), $DV120, $AR$29), 0))",
    "DV120": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH120), $AO$29)",
    "DW120": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM120,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120, $DB120), 1),\n\n  DW, $DR120,\n  CL, $DS120,\n  SM, $DT120,\n  SLM, $DU120,\n  SL, $DQ120,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX120": "CY120*(DE120*DO120*DQ120+DW120*DF120)",
    "DZ120": "IF(INDEX($BD$6:$BD265,BT120)=\"\", \"\", INDEX($BD$5:$BD265,BT120+1))",
    "EA120": "IF(OR($AO$25, INDEX($BE$6:$BE265,BU120)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ120)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE265,BU120+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI120*$DJ120*$AQ$9),\n  SuperTower, $DL120,\n  Rend, $DN120,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120, $DB120), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR120,\n  SM, $DT120,\n  SLM, $DU120,\n  SL, $DQ120,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM120, UltCritCard),\n\nCY120*(DE120*OtherDamage*SL+UwDamage*DF120)))",
    "EB120": "IF(INDEX($BF$6:$BF265,BV120)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF265,BV120+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ120,\n  CCUW, $DA120,\n  SCM, $DD120,\n  SCC, $DC120,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120, CF), 1),\n\n  DW, $DR120,\n  CL, $DS120,\n  SM, $DT120,\n  SLM, $DU120,\n  SL, $DQ120,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM120, UltCritCard),\n\nCY120 * (Critical * DO120 * SL + UwDamage * UWCritical)))",
    "EC120": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG265,BW120)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH120,\n  Rapid, DG120,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG265, BW120+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ120*$AQ$9),\n  SuperTower, $DL120,\n  Rend, $DN120,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM265,CC120), $DV120, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM120,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120, $DB120), 1),\n\n  DW, $DR120,\n  CL, $DS120,\n  SM, $DT120,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY120*(DE120*OtherDamage*SL+UWDamage*DF120)))",
    "ED120": "IF(OR($AO$25, INDEX($BH$6:$BH265,BX120)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH265,BX120+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL120, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI120*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM265,CC120), $DV120, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH120,\n  Rapid, DG120,\n  SuperTower, $DL120,\n  Rend, $DN120,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM120,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120, $DB120), 1),\n\n  DW, $DR120,\n  CL, $DS120,\n  SM, $DT120,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY120*(DE120*OtherDamage*SL+UWDamage*DF120)))",
    "EE120": "IF(INDEX($BI$6:$BI265,BY120)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK120, 0),\n  CF, $DB120,\n  CC, $CZ120,\n  CCUW, $DA120,\n  SCM, $DD120,\n  SCC, $AV$17+INDEX($BI$5:$BI265,BY120+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY120 * (Critical*DO120*$DQ120+DW120*UWCritical)))",
    "EF120": "IF(INDEX($BJ$6:$BJ265,BZ120)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK120*1%, 1),\n  CF, $DB120,\n  CC, $CZ120,\n  CCUW, $DA120,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ265,BZ120+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC120,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY120*(Critical*DO120*$DQ120+DW120*UWCritical)))",
    "EG120": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK265,CA120)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH120,\n  Rapid, DG120,\n  DPM, (1+$DI120*$DJ120*$AQ$9),\n  Rend, $DN120,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK265,CA120+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM120*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120, $DB120), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK265,CA120+1)-1))/(45-CM120*3),1),\n\n  SL, $DQ120,\n  DW, $DR120,\n  CL, $DS120,\n  SM, $DT120,\n  SLM, $DU120,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY120*(DE120*OtherDamage*SL+UwDamage*DF120)))",
    "EH120": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL265,CB120+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL265,CB120)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH120,\n  Rapid, DG120,\n  DPM, (1+$DI120*$DJ120*$AQ$9),\n  SuperTower, $DL120,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL265,CB120+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY120*(DE120*OtherDamage*$DQ120+DW120*DF120)))",
    "EI120": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM265,CC120)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120, $DB120), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK120),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV120, $AR$29), 0),\n\n  DW, $DR120,\n  CL, $DS120,\n  SM, $DT120,\n  SL, $DQ120,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM120, UltCritCard),\nCY120*(DE120*DO120*SL+UwDamage*DF120)))",
    "EJ120": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN265,CD120)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT120,\n  DamageMastery, $CS120,\n  DemonMastery, $CX120,\n  SPB, INDEX($BN$5:$BN265,CD120+1),\n  ITO, $CV120,\n  Shock, $CW120,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE120*DO120*$DQ120+DW120*DF120)))",
    "EK120": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO265,CE120)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT120,\n  DamageMastery, $CS120,\n  DemonMastery, $CX120,\n  SPB, $CU120,\n  ITO, INDEX($BO$5:$BO265,CE120+1),\n  Shock, $CW120,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE120*DO120*$DQ120+DW120*DF120)))",
    "EL120": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP265,CF120)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120, $DB120), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP120),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF120),\n  CL, $DS120,\n  SM, $DT120,\n  SLM, $DU120,\n  SL, $DQ120,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM120, UltCritCard),\nCY120*(DE120*DO120*SL+UwDamage*DF120)))",
    "EM120": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ265,CG120)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG120+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN120": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR265,CH120)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120, $DB120), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH120+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP120),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK120),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM265,CC120), SMHeat, $AR$29), 0),\n\n  DW, $DR120,\n  CL, $DS120,\n  SL, $DQ120,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM120, UltCritCard),\nCY120*(DE120*DO120*SL+UwDamage*DF120)))",
    "EO120": "IF(OR(CI120 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI120+1))",
    "EP120": "IF(OR($AO$25, CJ120 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ120+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE264,BU120),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL120, 1),\n  DPM, (1+$DI120*CardRangeMastery*$DJ120*$AQ$9),\n  SuperTower, $DL120,\n  Rend, $DN120,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120, $DB120), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR120,\n  SM, $DT120,\n  SLM, $DU120,\n  SL, $DQ120,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM120, UltCritCard),\n\nCY120*(DE120*OtherDamage*SL+UwDamage*DF120)))",
    "EQ120": "IF(OR(CK120 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK120+1)*1%, 1),\n  CF, $DB120,\n  CC, MIN(100%, $CZ120 + 1%),\n  CCUW, DA120 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ265,BZ120) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC120 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR120,\n  CL, $DS120,\n  SM, $DT120,\n  SLM, $DU120,\n  SL, $DQ120,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM120, UltCritCard),\n\nCY120 * (Critical*DO120*SL+UwDamage*UWCritical)))",
    "ER120": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL120 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH265,BX120),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL120+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI120*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM265,CC120), $DV120, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH120,\n  Rapid, DG120,\n  SuperTower, $DL120,\n  Rend, $DN120,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM120,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120, $DB120), 1),\n\n  DW, $DR120,\n  CL, $DS120,\n  SM, $DT120,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY120*(DE120*OtherDamage*SL+UWDamage*DF120)))",
    "ES120": "IF(OR(CM120 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH120,\n  Rapid, DG120,\n  RDPM, (1+$DI120*$DJ120*$AQ$9),\n  Rend, $DN120,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK265,CA120),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM120+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120, $DB120), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR120,\n  CL, $DS120,\n  SM, $DT120,\n  SLM, $DU120,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY120*(DE120*OtherDamage*SL+UwDamage*DF120)))",
    "ET120": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN120 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM120,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN120+1, $DB120), 1),\n\n  DW, $DR120,\n  CL, $DS120,\n  SM, $DT120,\n  SLM, $DU120,\n  SL, $DQ120,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY120*(DE120*DO120*SL+UWDamage*DF120)))",
    "EU120": "IF(OR(NOT($BA$3), NOT($BA$23), $CO120 > $BA$15), \"\", 1 + 0.5*(CO120+1))",
    "EW120": "IF(DZ120=\"\", \"\", LET(\n  Now, CT120,\n  Next, DZ120,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT120),\nFactor/Cost))",
    "EX120": "IF(EA120=\"\",\"\",(EA120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU120))",
    "EY120": "IF(EB120=\"\",\"\",(EB120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV120))",
    "EZ120": "IF(EC120=\"\",\"\",(EC120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW120))",
    "FA120": "IF(ED120=\"\",\"\",(ED120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX120))",
    "FB120": "IF(EE120=\"\",\"\",(EE120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY120))",
    "FC120": "IF(EF120=\"\",\"\",(EF120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ120))",
    "FD120": "IF(EG120=\"\",\"\",(EG120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA120))",
    "FE120": "IF(EH120=\"\",\"\",(EH120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB120))",
    "FF120": "IF(EI120=\"\",\"\",(EI120/$DX120-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC120+1, 1, CC120))))",
    "FG120": "IF(EJ120=\"\",\"\",(EJ120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD120))",
    "FH120": "IF(EK120=\"\",\"\",(EK120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE120))",
    "FI120": "IF(EL120=\"\",\"\",(EL120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF120))",
    "FJ120": "IF(EM120=\"\", \"\", LET(\n  Now, CW120,\n  Next, EM120,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG120),\nFactor/Cost))",
    "FK120": "IF(EN120=\"\",\"\",(EN120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH120))",
    "FL120": "IF(EO120=\"\", \"\", LET(\n  Now, CS120,\n  Next, EO120,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI120),\nFactor/Cost))",
    "FM120": "IF(EP120=\"\",\"\",(EP120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ120))",
    "FN120": "IF(EQ120=\"\",\"\",(EQ120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK120))",
    "FO120": "IF(ER120=\"\",\"\",(ER120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL120))",
    "FP120": "IF(ES120=\"\",\"\",(ES120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM120))",
    "FQ120": "IF(ET120=\"\",\"\",(ET120/$DX120-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN120))",
    "FR120": "IF(EU120=\"\", \"\", LET(\n  Now, CX120,\n  Next, EU120,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO120),\nFactor/Cost))",
    "FT120": "IF(COLUMN(EW120:FR120) = MIN(IF(EW120:FR120=MAX(EW120:FR120), COLUMN(EW120:FR120))), 1, \"\")",
    "D121": "IF(SUM(FT120:GP120),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F121)),\"Card Mastery\",F121),G121)/$D$5,\"\")",
    "F121": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT120:GP120),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT120:GP120=1)),)\"),\"Super Tower Bonus\")",
    "G121": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT120:GP120),ARRAYFORMULA(FILTER(BT120:CP120 , FT120:GP120=1)),\"\"\"\")\"),6.0)",
    "I121": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT120:GP120),ARRAYFORMULA(FILTER(EW120:FS120 , FT120:GP120=1))*D$5,\"\"\"\")\"),0.0063153007538150965)",
    "K121": "IF(H121<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D121)),)",
    "BT121": "BT120+FT120",
    "BU121": "BU120+FU120",
    "BV121": "BV120+FV120",
    "BW121": "BW120+FW120",
    "BX121": "BX120+FX120",
    "BY121": "BY120+FY120",
    "BZ121": "BZ120+FZ120",
    "CA121": "CA120+GA120",
    "CB121": "CB120+GB120",
    "CC121": "CC120+GC120",
    "CD121": "CD120+GD120",
    "CE121": "CE120+GE120",
    "CF121": "CF120+GF120",
    "CG121": "CG120+GG120",
    "CH121": "CH120+GH120",
    "CI121": "CI120+GI120",
    "CJ121": "CJ120+GJ120",
    "CK121": "CK120+GK120",
    "CL121": "CL120+GL120",
    "CM121": "CM120+GM120",
    "CN121": "CN120+GN120",
    "CO121": "CO120+GO120",
    "CS121": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI121,1)",
    "CT121": "INDEX($BD$5:$BD266,BT121)",
    "CU121": "INDEX($BN$5:$BN266,CD121)",
    "CV121": "INDEX($BO$5:$BO266,CE121)",
    "CW121": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG121)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX121": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO121, 1)",
    "CY121": "LET(\n  Base, $CR$6,\n  Damage, $CT121,\n  DamageMastery, $CS121,\n  DemonMastery, $CX121,\n  SPB, $CU121,\n  ITO, $CV121,\n  Shock, $CW121,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ121": "MIN(100%, DA121)",
    "DA121": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK121*1%, 0)",
    "DB121": "LET(\n  Lab, 1+INDEX($BF$5:$BF266,BV121),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC121": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK121*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI266,BY121) + CardCritMastery)",
    "DD121": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK121*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ266,BZ121) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE121": "LET(\n  CF, $DB121,\n  CC, $CZ121,\n  SCM, $DD121,\n  SCC, $DC121,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF121": "LET(\n  CF, $DB121,\n  CC, $DA121,\n  SCM, $DD121,\n  SCC, $DC121,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG121": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH121)), 0)",
    "DH121": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ121*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE266,BU121),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI121": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG266, BW121), 1) + $AE$9)",
    "DJ121": "LET(\n  DpmLab, INDEX($BH$5:$BH266,BX121),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL121, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK121": "(1+$DI121*$DJ121*$AQ$9)",
    "DL121": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK266,CA121),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM121*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM121": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK266,CA121),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM121*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN121": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL266,CB121)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO121": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH121,\n  Rapid, DG121,\n  RDPM, DK121,\n  SuperTower, $DL121,\n  Rend, $DN121,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP121": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ121": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK121),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR121": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP121),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF121-1))",
    "DS121": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG121, DH121),0))",
    "DT121": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP121),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV121, $AR$29), 0))",
    "DU121": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK121),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM266,CC121), $DV121, $AR$29), 0))",
    "DV121": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH121), $AO$29)",
    "DW121": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM121,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121, $DB121), 1),\n\n  DW, $DR121,\n  CL, $DS121,\n  SM, $DT121,\n  SLM, $DU121,\n  SL, $DQ121,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX121": "CY121*(DE121*DO121*DQ121+DW121*DF121)",
    "DZ121": "IF(INDEX($BD$6:$BD266,BT121)=\"\", \"\", INDEX($BD$5:$BD266,BT121+1))",
    "EA121": "IF(OR($AO$25, INDEX($BE$6:$BE266,BU121)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ121)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE266,BU121+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI121*$DJ121*$AQ$9),\n  SuperTower, $DL121,\n  Rend, $DN121,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121, $DB121), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR121,\n  SM, $DT121,\n  SLM, $DU121,\n  SL, $DQ121,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM121, UltCritCard),\n\nCY121*(DE121*OtherDamage*SL+UwDamage*DF121)))",
    "EB121": "IF(INDEX($BF$6:$BF266,BV121)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF266,BV121+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ121,\n  CCUW, $DA121,\n  SCM, $DD121,\n  SCC, $DC121,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121, CF), 1),\n\n  DW, $DR121,\n  CL, $DS121,\n  SM, $DT121,\n  SLM, $DU121,\n  SL, $DQ121,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM121, UltCritCard),\n\nCY121 * (Critical * DO121 * SL + UwDamage * UWCritical)))",
    "EC121": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG266,BW121)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH121,\n  Rapid, DG121,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG266, BW121+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ121*$AQ$9),\n  SuperTower, $DL121,\n  Rend, $DN121,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM266,CC121), $DV121, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM121,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121, $DB121), 1),\n\n  DW, $DR121,\n  CL, $DS121,\n  SM, $DT121,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY121*(DE121*OtherDamage*SL+UWDamage*DF121)))",
    "ED121": "IF(OR($AO$25, INDEX($BH$6:$BH266,BX121)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH266,BX121+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL121, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI121*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM266,CC121), $DV121, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH121,\n  Rapid, DG121,\n  SuperTower, $DL121,\n  Rend, $DN121,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM121,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121, $DB121), 1),\n\n  DW, $DR121,\n  CL, $DS121,\n  SM, $DT121,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY121*(DE121*OtherDamage*SL+UWDamage*DF121)))",
    "EE121": "IF(INDEX($BI$6:$BI266,BY121)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK121, 0),\n  CF, $DB121,\n  CC, $CZ121,\n  CCUW, $DA121,\n  SCM, $DD121,\n  SCC, $AV$17+INDEX($BI$5:$BI266,BY121+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY121 * (Critical*DO121*$DQ121+DW121*UWCritical)))",
    "EF121": "IF(INDEX($BJ$6:$BJ266,BZ121)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK121*1%, 1),\n  CF, $DB121,\n  CC, $CZ121,\n  CCUW, $DA121,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ266,BZ121+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC121,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY121*(Critical*DO121*$DQ121+DW121*UWCritical)))",
    "EG121": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK266,CA121)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH121,\n  Rapid, DG121,\n  DPM, (1+$DI121*$DJ121*$AQ$9),\n  Rend, $DN121,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK266,CA121+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM121*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121, $DB121), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK266,CA121+1)-1))/(45-CM121*3),1),\n\n  SL, $DQ121,\n  DW, $DR121,\n  CL, $DS121,\n  SM, $DT121,\n  SLM, $DU121,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY121*(DE121*OtherDamage*SL+UwDamage*DF121)))",
    "EH121": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL266,CB121+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL266,CB121)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH121,\n  Rapid, DG121,\n  DPM, (1+$DI121*$DJ121*$AQ$9),\n  SuperTower, $DL121,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL266,CB121+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY121*(DE121*OtherDamage*$DQ121+DW121*DF121)))",
    "EI121": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM266,CC121)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121, $DB121), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK121),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV121, $AR$29), 0),\n\n  DW, $DR121,\n  CL, $DS121,\n  SM, $DT121,\n  SL, $DQ121,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM121, UltCritCard),\nCY121*(DE121*DO121*SL+UwDamage*DF121)))",
    "EJ121": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN266,CD121)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT121,\n  DamageMastery, $CS121,\n  DemonMastery, $CX121,\n  SPB, INDEX($BN$5:$BN266,CD121+1),\n  ITO, $CV121,\n  Shock, $CW121,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE121*DO121*$DQ121+DW121*DF121)))",
    "EK121": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO266,CE121)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT121,\n  DamageMastery, $CS121,\n  DemonMastery, $CX121,\n  SPB, $CU121,\n  ITO, INDEX($BO$5:$BO266,CE121+1),\n  Shock, $CW121,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE121*DO121*$DQ121+DW121*DF121)))",
    "EL121": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP266,CF121)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121, $DB121), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP121),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF121),\n  CL, $DS121,\n  SM, $DT121,\n  SLM, $DU121,\n  SL, $DQ121,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM121, UltCritCard),\nCY121*(DE121*DO121*SL+UwDamage*DF121)))",
    "EM121": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ266,CG121)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG121+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN121": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR266,CH121)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121, $DB121), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH121+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP121),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK121),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM266,CC121), SMHeat, $AR$29), 0),\n\n  DW, $DR121,\n  CL, $DS121,\n  SL, $DQ121,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM121, UltCritCard),\nCY121*(DE121*DO121*SL+UwDamage*DF121)))",
    "EO121": "IF(OR(CI121 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI121+1))",
    "EP121": "IF(OR($AO$25, CJ121 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ121+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE265,BU121),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL121, 1),\n  DPM, (1+$DI121*CardRangeMastery*$DJ121*$AQ$9),\n  SuperTower, $DL121,\n  Rend, $DN121,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121, $DB121), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR121,\n  SM, $DT121,\n  SLM, $DU121,\n  SL, $DQ121,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM121, UltCritCard),\n\nCY121*(DE121*OtherDamage*SL+UwDamage*DF121)))",
    "EQ121": "IF(OR(CK121 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK121+1)*1%, 1),\n  CF, $DB121,\n  CC, MIN(100%, $CZ121 + 1%),\n  CCUW, DA121 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ266,BZ121) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC121 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR121,\n  CL, $DS121,\n  SM, $DT121,\n  SLM, $DU121,\n  SL, $DQ121,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM121, UltCritCard),\n\nCY121 * (Critical*DO121*SL+UwDamage*UWCritical)))",
    "ER121": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL121 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH266,BX121),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL121+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI121*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM266,CC121), $DV121, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH121,\n  Rapid, DG121,\n  SuperTower, $DL121,\n  Rend, $DN121,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM121,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121, $DB121), 1),\n\n  DW, $DR121,\n  CL, $DS121,\n  SM, $DT121,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY121*(DE121*OtherDamage*SL+UWDamage*DF121)))",
    "ES121": "IF(OR(CM121 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH121,\n  Rapid, DG121,\n  RDPM, (1+$DI121*$DJ121*$AQ$9),\n  Rend, $DN121,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK266,CA121),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM121+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121, $DB121), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR121,\n  CL, $DS121,\n  SM, $DT121,\n  SLM, $DU121,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY121*(DE121*OtherDamage*SL+UwDamage*DF121)))",
    "ET121": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN121 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM121,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN121+1, $DB121), 1),\n\n  DW, $DR121,\n  CL, $DS121,\n  SM, $DT121,\n  SLM, $DU121,\n  SL, $DQ121,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY121*(DE121*DO121*SL+UWDamage*DF121)))",
    "EU121": "IF(OR(NOT($BA$3), NOT($BA$23), $CO121 > $BA$15), \"\", 1 + 0.5*(CO121+1))",
    "EW121": "IF(DZ121=\"\", \"\", LET(\n  Now, CT121,\n  Next, DZ121,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT121),\nFactor/Cost))",
    "EX121": "IF(EA121=\"\",\"\",(EA121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU121))",
    "EY121": "IF(EB121=\"\",\"\",(EB121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV121))",
    "EZ121": "IF(EC121=\"\",\"\",(EC121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW121))",
    "FA121": "IF(ED121=\"\",\"\",(ED121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX121))",
    "FB121": "IF(EE121=\"\",\"\",(EE121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY121))",
    "FC121": "IF(EF121=\"\",\"\",(EF121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ121))",
    "FD121": "IF(EG121=\"\",\"\",(EG121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA121))",
    "FE121": "IF(EH121=\"\",\"\",(EH121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB121))",
    "FF121": "IF(EI121=\"\",\"\",(EI121/$DX121-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC121+1, 1, CC121))))",
    "FG121": "IF(EJ121=\"\",\"\",(EJ121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD121))",
    "FH121": "IF(EK121=\"\",\"\",(EK121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE121))",
    "FI121": "IF(EL121=\"\",\"\",(EL121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF121))",
    "FJ121": "IF(EM121=\"\", \"\", LET(\n  Now, CW121,\n  Next, EM121,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG121),\nFactor/Cost))",
    "FK121": "IF(EN121=\"\",\"\",(EN121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH121))",
    "FL121": "IF(EO121=\"\", \"\", LET(\n  Now, CS121,\n  Next, EO121,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI121),\nFactor/Cost))",
    "FM121": "IF(EP121=\"\",\"\",(EP121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ121))",
    "FN121": "IF(EQ121=\"\",\"\",(EQ121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK121))",
    "FO121": "IF(ER121=\"\",\"\",(ER121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL121))",
    "FP121": "IF(ES121=\"\",\"\",(ES121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM121))",
    "FQ121": "IF(ET121=\"\",\"\",(ET121/$DX121-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN121))",
    "FR121": "IF(EU121=\"\", \"\", LET(\n  Now, CX121,\n  Next, EU121,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO121),\nFactor/Cost))",
    "FT121": "IF(COLUMN(EW121:FR121) = MIN(IF(EW121:FR121=MAX(EW121:FR121), COLUMN(EW121:FR121))), 1, \"\")",
    "D122": "IF(SUM(FT121:GP121),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F122)),\"Card Mastery\",F122),G122)/$D$5,\"\")",
    "F122": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT121:GP121),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT121:GP121=1)),)\"),\"Damage\")",
    "G122": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT121:GP121),ARRAYFORMULA(FILTER(BT121:CP121 , FT121:GP121=1)),\"\"\"\")\"),27.0)",
    "I122": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT121:GP121),ARRAYFORMULA(FILTER(EW121:FS121 , FT121:GP121=1))*D$5,\"\"\"\")\"),0.006247071685147553)",
    "K122": "IF(H122<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D122)),)",
    "BT122": "BT121+FT121",
    "BU122": "BU121+FU121",
    "BV122": "BV121+FV121",
    "BW122": "BW121+FW121",
    "BX122": "BX121+FX121",
    "BY122": "BY121+FY121",
    "BZ122": "BZ121+FZ121",
    "CA122": "CA121+GA121",
    "CB122": "CB121+GB121",
    "CC122": "CC121+GC121",
    "CD122": "CD121+GD121",
    "CE122": "CE121+GE121",
    "CF122": "CF121+GF121",
    "CG122": "CG121+GG121",
    "CH122": "CH121+GH121",
    "CI122": "CI121+GI121",
    "CJ122": "CJ121+GJ121",
    "CK122": "CK121+GK121",
    "CL122": "CL121+GL121",
    "CM122": "CM121+GM121",
    "CN122": "CN121+GN121",
    "CO122": "CO121+GO121",
    "CS122": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI122,1)",
    "CT122": "INDEX($BD$5:$BD267,BT122)",
    "CU122": "INDEX($BN$5:$BN267,CD122)",
    "CV122": "INDEX($BO$5:$BO267,CE122)",
    "CW122": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG122)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX122": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO122, 1)",
    "CY122": "LET(\n  Base, $CR$6,\n  Damage, $CT122,\n  DamageMastery, $CS122,\n  DemonMastery, $CX122,\n  SPB, $CU122,\n  ITO, $CV122,\n  Shock, $CW122,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ122": "MIN(100%, DA122)",
    "DA122": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK122*1%, 0)",
    "DB122": "LET(\n  Lab, 1+INDEX($BF$5:$BF267,BV122),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC122": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK122*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI267,BY122) + CardCritMastery)",
    "DD122": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK122*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ267,BZ122) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE122": "LET(\n  CF, $DB122,\n  CC, $CZ122,\n  SCM, $DD122,\n  SCC, $DC122,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF122": "LET(\n  CF, $DB122,\n  CC, $DA122,\n  SCM, $DD122,\n  SCC, $DC122,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG122": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH122)), 0)",
    "DH122": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ122*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE267,BU122),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI122": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG267, BW122), 1) + $AE$9)",
    "DJ122": "LET(\n  DpmLab, INDEX($BH$5:$BH267,BX122),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL122, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK122": "(1+$DI122*$DJ122*$AQ$9)",
    "DL122": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK267,CA122),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM122*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM122": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK267,CA122),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM122*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN122": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL267,CB122)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO122": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH122,\n  Rapid, DG122,\n  RDPM, DK122,\n  SuperTower, $DL122,\n  Rend, $DN122,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP122": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ122": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK122),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR122": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP122),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF122-1))",
    "DS122": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG122, DH122),0))",
    "DT122": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP122),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV122, $AR$29), 0))",
    "DU122": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK122),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM267,CC122), $DV122, $AR$29), 0))",
    "DV122": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH122), $AO$29)",
    "DW122": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM122,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122, $DB122), 1),\n\n  DW, $DR122,\n  CL, $DS122,\n  SM, $DT122,\n  SLM, $DU122,\n  SL, $DQ122,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX122": "CY122*(DE122*DO122*DQ122+DW122*DF122)",
    "DZ122": "IF(INDEX($BD$6:$BD267,BT122)=\"\", \"\", INDEX($BD$5:$BD267,BT122+1))",
    "EA122": "IF(OR($AO$25, INDEX($BE$6:$BE267,BU122)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ122)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE267,BU122+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI122*$DJ122*$AQ$9),\n  SuperTower, $DL122,\n  Rend, $DN122,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122, $DB122), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR122,\n  SM, $DT122,\n  SLM, $DU122,\n  SL, $DQ122,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM122, UltCritCard),\n\nCY122*(DE122*OtherDamage*SL+UwDamage*DF122)))",
    "EB122": "IF(INDEX($BF$6:$BF267,BV122)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF267,BV122+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ122,\n  CCUW, $DA122,\n  SCM, $DD122,\n  SCC, $DC122,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122, CF), 1),\n\n  DW, $DR122,\n  CL, $DS122,\n  SM, $DT122,\n  SLM, $DU122,\n  SL, $DQ122,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM122, UltCritCard),\n\nCY122 * (Critical * DO122 * SL + UwDamage * UWCritical)))",
    "EC122": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG267,BW122)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH122,\n  Rapid, DG122,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG267, BW122+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ122*$AQ$9),\n  SuperTower, $DL122,\n  Rend, $DN122,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM267,CC122), $DV122, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM122,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122, $DB122), 1),\n\n  DW, $DR122,\n  CL, $DS122,\n  SM, $DT122,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY122*(DE122*OtherDamage*SL+UWDamage*DF122)))",
    "ED122": "IF(OR($AO$25, INDEX($BH$6:$BH267,BX122)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH267,BX122+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL122, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI122*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM267,CC122), $DV122, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH122,\n  Rapid, DG122,\n  SuperTower, $DL122,\n  Rend, $DN122,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM122,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122, $DB122), 1),\n\n  DW, $DR122,\n  CL, $DS122,\n  SM, $DT122,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY122*(DE122*OtherDamage*SL+UWDamage*DF122)))",
    "EE122": "IF(INDEX($BI$6:$BI267,BY122)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK122, 0),\n  CF, $DB122,\n  CC, $CZ122,\n  CCUW, $DA122,\n  SCM, $DD122,\n  SCC, $AV$17+INDEX($BI$5:$BI267,BY122+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY122 * (Critical*DO122*$DQ122+DW122*UWCritical)))",
    "EF122": "IF(INDEX($BJ$6:$BJ267,BZ122)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK122*1%, 1),\n  CF, $DB122,\n  CC, $CZ122,\n  CCUW, $DA122,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ267,BZ122+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC122,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY122*(Critical*DO122*$DQ122+DW122*UWCritical)))",
    "EG122": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK267,CA122)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH122,\n  Rapid, DG122,\n  DPM, (1+$DI122*$DJ122*$AQ$9),\n  Rend, $DN122,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK267,CA122+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM122*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122, $DB122), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK267,CA122+1)-1))/(45-CM122*3),1),\n\n  SL, $DQ122,\n  DW, $DR122,\n  CL, $DS122,\n  SM, $DT122,\n  SLM, $DU122,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY122*(DE122*OtherDamage*SL+UwDamage*DF122)))",
    "EH122": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL267,CB122+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL267,CB122)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH122,\n  Rapid, DG122,\n  DPM, (1+$DI122*$DJ122*$AQ$9),\n  SuperTower, $DL122,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL267,CB122+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY122*(DE122*OtherDamage*$DQ122+DW122*DF122)))",
    "EI122": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM267,CC122)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122, $DB122), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK122),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV122, $AR$29), 0),\n\n  DW, $DR122,\n  CL, $DS122,\n  SM, $DT122,\n  SL, $DQ122,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM122, UltCritCard),\nCY122*(DE122*DO122*SL+UwDamage*DF122)))",
    "EJ122": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN267,CD122)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT122,\n  DamageMastery, $CS122,\n  DemonMastery, $CX122,\n  SPB, INDEX($BN$5:$BN267,CD122+1),\n  ITO, $CV122,\n  Shock, $CW122,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE122*DO122*$DQ122+DW122*DF122)))",
    "EK122": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO267,CE122)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT122,\n  DamageMastery, $CS122,\n  DemonMastery, $CX122,\n  SPB, $CU122,\n  ITO, INDEX($BO$5:$BO267,CE122+1),\n  Shock, $CW122,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE122*DO122*$DQ122+DW122*DF122)))",
    "EL122": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP267,CF122)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122, $DB122), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP122),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF122),\n  CL, $DS122,\n  SM, $DT122,\n  SLM, $DU122,\n  SL, $DQ122,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM122, UltCritCard),\nCY122*(DE122*DO122*SL+UwDamage*DF122)))",
    "EM122": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ267,CG122)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG122+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN122": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR267,CH122)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122, $DB122), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH122+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP122),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK122),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM267,CC122), SMHeat, $AR$29), 0),\n\n  DW, $DR122,\n  CL, $DS122,\n  SL, $DQ122,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM122, UltCritCard),\nCY122*(DE122*DO122*SL+UwDamage*DF122)))",
    "EO122": "IF(OR(CI122 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI122+1))",
    "EP122": "IF(OR($AO$25, CJ122 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ122+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE266,BU122),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL122, 1),\n  DPM, (1+$DI122*CardRangeMastery*$DJ122*$AQ$9),\n  SuperTower, $DL122,\n  Rend, $DN122,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122, $DB122), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR122,\n  SM, $DT122,\n  SLM, $DU122,\n  SL, $DQ122,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM122, UltCritCard),\n\nCY122*(DE122*OtherDamage*SL+UwDamage*DF122)))",
    "EQ122": "IF(OR(CK122 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK122+1)*1%, 1),\n  CF, $DB122,\n  CC, MIN(100%, $CZ122 + 1%),\n  CCUW, DA122 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ267,BZ122) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC122 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR122,\n  CL, $DS122,\n  SM, $DT122,\n  SLM, $DU122,\n  SL, $DQ122,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM122, UltCritCard),\n\nCY122 * (Critical*DO122*SL+UwDamage*UWCritical)))",
    "ER122": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL122 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH267,BX122),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL122+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI122*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM267,CC122), $DV122, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH122,\n  Rapid, DG122,\n  SuperTower, $DL122,\n  Rend, $DN122,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM122,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122, $DB122), 1),\n\n  DW, $DR122,\n  CL, $DS122,\n  SM, $DT122,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY122*(DE122*OtherDamage*SL+UWDamage*DF122)))",
    "ES122": "IF(OR(CM122 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH122,\n  Rapid, DG122,\n  RDPM, (1+$DI122*$DJ122*$AQ$9),\n  Rend, $DN122,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK267,CA122),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM122+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122, $DB122), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR122,\n  CL, $DS122,\n  SM, $DT122,\n  SLM, $DU122,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY122*(DE122*OtherDamage*SL+UwDamage*DF122)))",
    "ET122": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN122 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM122,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN122+1, $DB122), 1),\n\n  DW, $DR122,\n  CL, $DS122,\n  SM, $DT122,\n  SLM, $DU122,\n  SL, $DQ122,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY122*(DE122*DO122*SL+UWDamage*DF122)))",
    "EU122": "IF(OR(NOT($BA$3), NOT($BA$23), $CO122 > $BA$15), \"\", 1 + 0.5*(CO122+1))",
    "EW122": "IF(DZ122=\"\", \"\", LET(\n  Now, CT122,\n  Next, DZ122,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT122),\nFactor/Cost))",
    "EX122": "IF(EA122=\"\",\"\",(EA122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU122))",
    "EY122": "IF(EB122=\"\",\"\",(EB122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV122))",
    "EZ122": "IF(EC122=\"\",\"\",(EC122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW122))",
    "FA122": "IF(ED122=\"\",\"\",(ED122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX122))",
    "FB122": "IF(EE122=\"\",\"\",(EE122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY122))",
    "FC122": "IF(EF122=\"\",\"\",(EF122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ122))",
    "FD122": "IF(EG122=\"\",\"\",(EG122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA122))",
    "FE122": "IF(EH122=\"\",\"\",(EH122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB122))",
    "FF122": "IF(EI122=\"\",\"\",(EI122/$DX122-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC122+1, 1, CC122))))",
    "FG122": "IF(EJ122=\"\",\"\",(EJ122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD122))",
    "FH122": "IF(EK122=\"\",\"\",(EK122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE122))",
    "FI122": "IF(EL122=\"\",\"\",(EL122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF122))",
    "FJ122": "IF(EM122=\"\", \"\", LET(\n  Now, CW122,\n  Next, EM122,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG122),\nFactor/Cost))",
    "FK122": "IF(EN122=\"\",\"\",(EN122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH122))",
    "FL122": "IF(EO122=\"\", \"\", LET(\n  Now, CS122,\n  Next, EO122,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI122),\nFactor/Cost))",
    "FM122": "IF(EP122=\"\",\"\",(EP122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ122))",
    "FN122": "IF(EQ122=\"\",\"\",(EQ122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK122))",
    "FO122": "IF(ER122=\"\",\"\",(ER122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL122))",
    "FP122": "IF(ES122=\"\",\"\",(ES122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM122))",
    "FQ122": "IF(ET122=\"\",\"\",(ET122/$DX122-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN122))",
    "FR122": "IF(EU122=\"\", \"\", LET(\n  Now, CX122,\n  Next, EU122,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO122),\nFactor/Cost))",
    "FT122": "IF(COLUMN(EW122:FR122) = MIN(IF(EW122:FR122=MAX(EW122:FR122), COLUMN(EW122:FR122))), 1, \"\")",
    "D123": "IF(SUM(FT122:GP122),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F123)),\"Card Mastery\",F123),G123)/$D$5,\"\")",
    "F123": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT122:GP122),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT122:GP122=1)),)\"),\"Attack Speed\")",
    "G123": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT122:GP122),ARRAYFORMULA(FILTER(BT122:CP122 , FT122:GP122=1)),\"\"\"\")\"),27.0)",
    "I123": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT122:GP122),ARRAYFORMULA(FILTER(EW122:FS122 , FT122:GP122=1))*D$5,\"\"\"\")\"),0.006135969269368463)",
    "K123": "IF(H123<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D123)),)",
    "BT123": "BT122+FT122",
    "BU123": "BU122+FU122",
    "BV123": "BV122+FV122",
    "BW123": "BW122+FW122",
    "BX123": "BX122+FX122",
    "BY123": "BY122+FY122",
    "BZ123": "BZ122+FZ122",
    "CA123": "CA122+GA122",
    "CB123": "CB122+GB122",
    "CC123": "CC122+GC122",
    "CD123": "CD122+GD122",
    "CE123": "CE122+GE122",
    "CF123": "CF122+GF122",
    "CG123": "CG122+GG122",
    "CH123": "CH122+GH122",
    "CI123": "CI122+GI122",
    "CJ123": "CJ122+GJ122",
    "CK123": "CK122+GK122",
    "CL123": "CL122+GL122",
    "CM123": "CM122+GM122",
    "CN123": "CN122+GN122",
    "CO123": "CO122+GO122",
    "CS123": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI123,1)",
    "CT123": "INDEX($BD$5:$BD268,BT123)",
    "CU123": "INDEX($BN$5:$BN268,CD123)",
    "CV123": "INDEX($BO$5:$BO268,CE123)",
    "CW123": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG123)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX123": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO123, 1)",
    "CY123": "LET(\n  Base, $CR$6,\n  Damage, $CT123,\n  DamageMastery, $CS123,\n  DemonMastery, $CX123,\n  SPB, $CU123,\n  ITO, $CV123,\n  Shock, $CW123,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ123": "MIN(100%, DA123)",
    "DA123": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK123*1%, 0)",
    "DB123": "LET(\n  Lab, 1+INDEX($BF$5:$BF268,BV123),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC123": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK123*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI268,BY123) + CardCritMastery)",
    "DD123": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK123*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ268,BZ123) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE123": "LET(\n  CF, $DB123,\n  CC, $CZ123,\n  SCM, $DD123,\n  SCC, $DC123,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF123": "LET(\n  CF, $DB123,\n  CC, $DA123,\n  SCM, $DD123,\n  SCC, $DC123,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG123": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH123)), 0)",
    "DH123": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ123*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE268,BU123),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI123": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG268, BW123), 1) + $AE$9)",
    "DJ123": "LET(\n  DpmLab, INDEX($BH$5:$BH268,BX123),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL123, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK123": "(1+$DI123*$DJ123*$AQ$9)",
    "DL123": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK268,CA123),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM123*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM123": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK268,CA123),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM123*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN123": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL268,CB123)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO123": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH123,\n  Rapid, DG123,\n  RDPM, DK123,\n  SuperTower, $DL123,\n  Rend, $DN123,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP123": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ123": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK123),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR123": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP123),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF123-1))",
    "DS123": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG123, DH123),0))",
    "DT123": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP123),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV123, $AR$29), 0))",
    "DU123": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK123),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM268,CC123), $DV123, $AR$29), 0))",
    "DV123": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH123), $AO$29)",
    "DW123": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM123,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123, $DB123), 1),\n\n  DW, $DR123,\n  CL, $DS123,\n  SM, $DT123,\n  SLM, $DU123,\n  SL, $DQ123,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX123": "CY123*(DE123*DO123*DQ123+DW123*DF123)",
    "DZ123": "IF(INDEX($BD$6:$BD268,BT123)=\"\", \"\", INDEX($BD$5:$BD268,BT123+1))",
    "EA123": "IF(OR($AO$25, INDEX($BE$6:$BE268,BU123)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ123)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE268,BU123+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI123*$DJ123*$AQ$9),\n  SuperTower, $DL123,\n  Rend, $DN123,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123, $DB123), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR123,\n  SM, $DT123,\n  SLM, $DU123,\n  SL, $DQ123,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM123, UltCritCard),\n\nCY123*(DE123*OtherDamage*SL+UwDamage*DF123)))",
    "EB123": "IF(INDEX($BF$6:$BF268,BV123)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF268,BV123+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ123,\n  CCUW, $DA123,\n  SCM, $DD123,\n  SCC, $DC123,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123, CF), 1),\n\n  DW, $DR123,\n  CL, $DS123,\n  SM, $DT123,\n  SLM, $DU123,\n  SL, $DQ123,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM123, UltCritCard),\n\nCY123 * (Critical * DO123 * SL + UwDamage * UWCritical)))",
    "EC123": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG268,BW123)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH123,\n  Rapid, DG123,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG268, BW123+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ123*$AQ$9),\n  SuperTower, $DL123,\n  Rend, $DN123,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM268,CC123), $DV123, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM123,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123, $DB123), 1),\n\n  DW, $DR123,\n  CL, $DS123,\n  SM, $DT123,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY123*(DE123*OtherDamage*SL+UWDamage*DF123)))",
    "ED123": "IF(OR($AO$25, INDEX($BH$6:$BH268,BX123)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH268,BX123+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL123, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI123*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM268,CC123), $DV123, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH123,\n  Rapid, DG123,\n  SuperTower, $DL123,\n  Rend, $DN123,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM123,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123, $DB123), 1),\n\n  DW, $DR123,\n  CL, $DS123,\n  SM, $DT123,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY123*(DE123*OtherDamage*SL+UWDamage*DF123)))",
    "EE123": "IF(INDEX($BI$6:$BI268,BY123)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK123, 0),\n  CF, $DB123,\n  CC, $CZ123,\n  CCUW, $DA123,\n  SCM, $DD123,\n  SCC, $AV$17+INDEX($BI$5:$BI268,BY123+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY123 * (Critical*DO123*$DQ123+DW123*UWCritical)))",
    "EF123": "IF(INDEX($BJ$6:$BJ268,BZ123)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK123*1%, 1),\n  CF, $DB123,\n  CC, $CZ123,\n  CCUW, $DA123,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ268,BZ123+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC123,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY123*(Critical*DO123*$DQ123+DW123*UWCritical)))",
    "EG123": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK268,CA123)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH123,\n  Rapid, DG123,\n  DPM, (1+$DI123*$DJ123*$AQ$9),\n  Rend, $DN123,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK268,CA123+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM123*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123, $DB123), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK268,CA123+1)-1))/(45-CM123*3),1),\n\n  SL, $DQ123,\n  DW, $DR123,\n  CL, $DS123,\n  SM, $DT123,\n  SLM, $DU123,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY123*(DE123*OtherDamage*SL+UwDamage*DF123)))",
    "EH123": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL268,CB123+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL268,CB123)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH123,\n  Rapid, DG123,\n  DPM, (1+$DI123*$DJ123*$AQ$9),\n  SuperTower, $DL123,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL268,CB123+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY123*(DE123*OtherDamage*$DQ123+DW123*DF123)))",
    "EI123": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM268,CC123)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123, $DB123), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK123),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV123, $AR$29), 0),\n\n  DW, $DR123,\n  CL, $DS123,\n  SM, $DT123,\n  SL, $DQ123,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM123, UltCritCard),\nCY123*(DE123*DO123*SL+UwDamage*DF123)))",
    "EJ123": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN268,CD123)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT123,\n  DamageMastery, $CS123,\n  DemonMastery, $CX123,\n  SPB, INDEX($BN$5:$BN268,CD123+1),\n  ITO, $CV123,\n  Shock, $CW123,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE123*DO123*$DQ123+DW123*DF123)))",
    "EK123": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO268,CE123)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT123,\n  DamageMastery, $CS123,\n  DemonMastery, $CX123,\n  SPB, $CU123,\n  ITO, INDEX($BO$5:$BO268,CE123+1),\n  Shock, $CW123,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE123*DO123*$DQ123+DW123*DF123)))",
    "EL123": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP268,CF123)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123, $DB123), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP123),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF123),\n  CL, $DS123,\n  SM, $DT123,\n  SLM, $DU123,\n  SL, $DQ123,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM123, UltCritCard),\nCY123*(DE123*DO123*SL+UwDamage*DF123)))",
    "EM123": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ268,CG123)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG123+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN123": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR268,CH123)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123, $DB123), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH123+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP123),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK123),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM268,CC123), SMHeat, $AR$29), 0),\n\n  DW, $DR123,\n  CL, $DS123,\n  SL, $DQ123,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM123, UltCritCard),\nCY123*(DE123*DO123*SL+UwDamage*DF123)))",
    "EO123": "IF(OR(CI123 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI123+1))",
    "EP123": "IF(OR($AO$25, CJ123 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ123+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE267,BU123),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL123, 1),\n  DPM, (1+$DI123*CardRangeMastery*$DJ123*$AQ$9),\n  SuperTower, $DL123,\n  Rend, $DN123,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123, $DB123), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR123,\n  SM, $DT123,\n  SLM, $DU123,\n  SL, $DQ123,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM123, UltCritCard),\n\nCY123*(DE123*OtherDamage*SL+UwDamage*DF123)))",
    "EQ123": "IF(OR(CK123 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK123+1)*1%, 1),\n  CF, $DB123,\n  CC, MIN(100%, $CZ123 + 1%),\n  CCUW, DA123 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ268,BZ123) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC123 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR123,\n  CL, $DS123,\n  SM, $DT123,\n  SLM, $DU123,\n  SL, $DQ123,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM123, UltCritCard),\n\nCY123 * (Critical*DO123*SL+UwDamage*UWCritical)))",
    "ER123": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL123 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH268,BX123),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL123+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI123*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM268,CC123), $DV123, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH123,\n  Rapid, DG123,\n  SuperTower, $DL123,\n  Rend, $DN123,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM123,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123, $DB123), 1),\n\n  DW, $DR123,\n  CL, $DS123,\n  SM, $DT123,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY123*(DE123*OtherDamage*SL+UWDamage*DF123)))",
    "ES123": "IF(OR(CM123 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH123,\n  Rapid, DG123,\n  RDPM, (1+$DI123*$DJ123*$AQ$9),\n  Rend, $DN123,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK268,CA123),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM123+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123, $DB123), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR123,\n  CL, $DS123,\n  SM, $DT123,\n  SLM, $DU123,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY123*(DE123*OtherDamage*SL+UwDamage*DF123)))",
    "ET123": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN123 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM123,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN123+1, $DB123), 1),\n\n  DW, $DR123,\n  CL, $DS123,\n  SM, $DT123,\n  SLM, $DU123,\n  SL, $DQ123,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY123*(DE123*DO123*SL+UWDamage*DF123)))",
    "EU123": "IF(OR(NOT($BA$3), NOT($BA$23), $CO123 > $BA$15), \"\", 1 + 0.5*(CO123+1))",
    "EW123": "IF(DZ123=\"\", \"\", LET(\n  Now, CT123,\n  Next, DZ123,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT123),\nFactor/Cost))",
    "EX123": "IF(EA123=\"\",\"\",(EA123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU123))",
    "EY123": "IF(EB123=\"\",\"\",(EB123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV123))",
    "EZ123": "IF(EC123=\"\",\"\",(EC123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW123))",
    "FA123": "IF(ED123=\"\",\"\",(ED123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX123))",
    "FB123": "IF(EE123=\"\",\"\",(EE123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY123))",
    "FC123": "IF(EF123=\"\",\"\",(EF123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ123))",
    "FD123": "IF(EG123=\"\",\"\",(EG123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA123))",
    "FE123": "IF(EH123=\"\",\"\",(EH123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB123))",
    "FF123": "IF(EI123=\"\",\"\",(EI123/$DX123-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC123+1, 1, CC123))))",
    "FG123": "IF(EJ123=\"\",\"\",(EJ123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD123))",
    "FH123": "IF(EK123=\"\",\"\",(EK123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE123))",
    "FI123": "IF(EL123=\"\",\"\",(EL123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF123))",
    "FJ123": "IF(EM123=\"\", \"\", LET(\n  Now, CW123,\n  Next, EM123,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG123),\nFactor/Cost))",
    "FK123": "IF(EN123=\"\",\"\",(EN123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH123))",
    "FL123": "IF(EO123=\"\", \"\", LET(\n  Now, CS123,\n  Next, EO123,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI123),\nFactor/Cost))",
    "FM123": "IF(EP123=\"\",\"\",(EP123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ123))",
    "FN123": "IF(EQ123=\"\",\"\",(EQ123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK123))",
    "FO123": "IF(ER123=\"\",\"\",(ER123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL123))",
    "FP123": "IF(ES123=\"\",\"\",(ES123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM123))",
    "FQ123": "IF(ET123=\"\",\"\",(ET123/$DX123-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN123))",
    "FR123": "IF(EU123=\"\", \"\", LET(\n  Now, CX123,\n  Next, EU123,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO123),\nFactor/Cost))",
    "FT123": "IF(COLUMN(EW123:FR123) = MIN(IF(EW123:FR123=MAX(EW123:FR123), COLUMN(EW123:FR123))), 1, \"\")",
    "D124": "IF(SUM(FT123:GP123),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F124)),\"Card Mastery\",F124),G124)/$D$5,\"\")",
    "F124": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT123:GP123),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT123:GP123=1)),)\"),\"Improve Trade-off Perks\")",
    "G124": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT123:GP123),ARRAYFORMULA(FILTER(BT123:CP123 , FT123:GP123=1)),\"\"\"\")\"),2.0)",
    "I124": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT123:GP123),ARRAYFORMULA(FILTER(EW123:FS123 , FT123:GP123=1))*D$5,\"\"\"\")\"),0.006108580009671924)",
    "K124": "IF(H124<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D124)),)",
    "BT124": "BT123+FT123",
    "BU124": "BU123+FU123",
    "BV124": "BV123+FV123",
    "BW124": "BW123+FW123",
    "BX124": "BX123+FX123",
    "BY124": "BY123+FY123",
    "BZ124": "BZ123+FZ123",
    "CA124": "CA123+GA123",
    "CB124": "CB123+GB123",
    "CC124": "CC123+GC123",
    "CD124": "CD123+GD123",
    "CE124": "CE123+GE123",
    "CF124": "CF123+GF123",
    "CG124": "CG123+GG123",
    "CH124": "CH123+GH123",
    "CI124": "CI123+GI123",
    "CJ124": "CJ123+GJ123",
    "CK124": "CK123+GK123",
    "CL124": "CL123+GL123",
    "CM124": "CM123+GM123",
    "CN124": "CN123+GN123",
    "CO124": "CO123+GO123",
    "CS124": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI124,1)",
    "CT124": "INDEX($BD$5:$BD269,BT124)",
    "CU124": "INDEX($BN$5:$BN269,CD124)",
    "CV124": "INDEX($BO$5:$BO269,CE124)",
    "CW124": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG124)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX124": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO124, 1)",
    "CY124": "LET(\n  Base, $CR$6,\n  Damage, $CT124,\n  DamageMastery, $CS124,\n  DemonMastery, $CX124,\n  SPB, $CU124,\n  ITO, $CV124,\n  Shock, $CW124,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ124": "MIN(100%, DA124)",
    "DA124": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK124*1%, 0)",
    "DB124": "LET(\n  Lab, 1+INDEX($BF$5:$BF269,BV124),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC124": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK124*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI269,BY124) + CardCritMastery)",
    "DD124": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK124*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ269,BZ124) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE124": "LET(\n  CF, $DB124,\n  CC, $CZ124,\n  SCM, $DD124,\n  SCC, $DC124,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF124": "LET(\n  CF, $DB124,\n  CC, $DA124,\n  SCM, $DD124,\n  SCC, $DC124,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG124": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH124)), 0)",
    "DH124": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ124*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE269,BU124),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI124": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG269, BW124), 1) + $AE$9)",
    "DJ124": "LET(\n  DpmLab, INDEX($BH$5:$BH269,BX124),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL124, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK124": "(1+$DI124*$DJ124*$AQ$9)",
    "DL124": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK269,CA124),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM124*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM124": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK269,CA124),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM124*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN124": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL269,CB124)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO124": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH124,\n  Rapid, DG124,\n  RDPM, DK124,\n  SuperTower, $DL124,\n  Rend, $DN124,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP124": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ124": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK124),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR124": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP124),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF124-1))",
    "DS124": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG124, DH124),0))",
    "DT124": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP124),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV124, $AR$29), 0))",
    "DU124": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK124),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM269,CC124), $DV124, $AR$29), 0))",
    "DV124": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH124), $AO$29)",
    "DW124": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM124,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124, $DB124), 1),\n\n  DW, $DR124,\n  CL, $DS124,\n  SM, $DT124,\n  SLM, $DU124,\n  SL, $DQ124,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX124": "CY124*(DE124*DO124*DQ124+DW124*DF124)",
    "DZ124": "IF(INDEX($BD$6:$BD269,BT124)=\"\", \"\", INDEX($BD$5:$BD269,BT124+1))",
    "EA124": "IF(OR($AO$25, INDEX($BE$6:$BE269,BU124)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ124)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE269,BU124+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI124*$DJ124*$AQ$9),\n  SuperTower, $DL124,\n  Rend, $DN124,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124, $DB124), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR124,\n  SM, $DT124,\n  SLM, $DU124,\n  SL, $DQ124,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM124, UltCritCard),\n\nCY124*(DE124*OtherDamage*SL+UwDamage*DF124)))",
    "EB124": "IF(INDEX($BF$6:$BF269,BV124)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF269,BV124+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ124,\n  CCUW, $DA124,\n  SCM, $DD124,\n  SCC, $DC124,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124, CF), 1),\n\n  DW, $DR124,\n  CL, $DS124,\n  SM, $DT124,\n  SLM, $DU124,\n  SL, $DQ124,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM124, UltCritCard),\n\nCY124 * (Critical * DO124 * SL + UwDamage * UWCritical)))",
    "EC124": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG269,BW124)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH124,\n  Rapid, DG124,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG269, BW124+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ124*$AQ$9),\n  SuperTower, $DL124,\n  Rend, $DN124,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM269,CC124), $DV124, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM124,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124, $DB124), 1),\n\n  DW, $DR124,\n  CL, $DS124,\n  SM, $DT124,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY124*(DE124*OtherDamage*SL+UWDamage*DF124)))",
    "ED124": "IF(OR($AO$25, INDEX($BH$6:$BH269,BX124)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH269,BX124+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL124, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI124*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM269,CC124), $DV124, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH124,\n  Rapid, DG124,\n  SuperTower, $DL124,\n  Rend, $DN124,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM124,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124, $DB124), 1),\n\n  DW, $DR124,\n  CL, $DS124,\n  SM, $DT124,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY124*(DE124*OtherDamage*SL+UWDamage*DF124)))",
    "EE124": "IF(INDEX($BI$6:$BI269,BY124)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK124, 0),\n  CF, $DB124,\n  CC, $CZ124,\n  CCUW, $DA124,\n  SCM, $DD124,\n  SCC, $AV$17+INDEX($BI$5:$BI269,BY124+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY124 * (Critical*DO124*$DQ124+DW124*UWCritical)))",
    "EF124": "IF(INDEX($BJ$6:$BJ269,BZ124)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK124*1%, 1),\n  CF, $DB124,\n  CC, $CZ124,\n  CCUW, $DA124,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ269,BZ124+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC124,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY124*(Critical*DO124*$DQ124+DW124*UWCritical)))",
    "EG124": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK269,CA124)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH124,\n  Rapid, DG124,\n  DPM, (1+$DI124*$DJ124*$AQ$9),\n  Rend, $DN124,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK269,CA124+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM124*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124, $DB124), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK269,CA124+1)-1))/(45-CM124*3),1),\n\n  SL, $DQ124,\n  DW, $DR124,\n  CL, $DS124,\n  SM, $DT124,\n  SLM, $DU124,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY124*(DE124*OtherDamage*SL+UwDamage*DF124)))",
    "EH124": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL269,CB124+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL269,CB124)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH124,\n  Rapid, DG124,\n  DPM, (1+$DI124*$DJ124*$AQ$9),\n  SuperTower, $DL124,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL269,CB124+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY124*(DE124*OtherDamage*$DQ124+DW124*DF124)))",
    "EI124": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM269,CC124)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124, $DB124), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK124),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV124, $AR$29), 0),\n\n  DW, $DR124,\n  CL, $DS124,\n  SM, $DT124,\n  SL, $DQ124,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM124, UltCritCard),\nCY124*(DE124*DO124*SL+UwDamage*DF124)))",
    "EJ124": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN269,CD124)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT124,\n  DamageMastery, $CS124,\n  DemonMastery, $CX124,\n  SPB, INDEX($BN$5:$BN269,CD124+1),\n  ITO, $CV124,\n  Shock, $CW124,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE124*DO124*$DQ124+DW124*DF124)))",
    "EK124": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO269,CE124)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT124,\n  DamageMastery, $CS124,\n  DemonMastery, $CX124,\n  SPB, $CU124,\n  ITO, INDEX($BO$5:$BO269,CE124+1),\n  Shock, $CW124,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE124*DO124*$DQ124+DW124*DF124)))",
    "EL124": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP269,CF124)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124, $DB124), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP124),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF124),\n  CL, $DS124,\n  SM, $DT124,\n  SLM, $DU124,\n  SL, $DQ124,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM124, UltCritCard),\nCY124*(DE124*DO124*SL+UwDamage*DF124)))",
    "EM124": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ269,CG124)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG124+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN124": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR269,CH124)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124, $DB124), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH124+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP124),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK124),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM269,CC124), SMHeat, $AR$29), 0),\n\n  DW, $DR124,\n  CL, $DS124,\n  SL, $DQ124,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM124, UltCritCard),\nCY124*(DE124*DO124*SL+UwDamage*DF124)))",
    "EO124": "IF(OR(CI124 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI124+1))",
    "EP124": "IF(OR($AO$25, CJ124 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ124+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE268,BU124),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL124, 1),\n  DPM, (1+$DI124*CardRangeMastery*$DJ124*$AQ$9),\n  SuperTower, $DL124,\n  Rend, $DN124,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124, $DB124), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR124,\n  SM, $DT124,\n  SLM, $DU124,\n  SL, $DQ124,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM124, UltCritCard),\n\nCY124*(DE124*OtherDamage*SL+UwDamage*DF124)))",
    "EQ124": "IF(OR(CK124 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK124+1)*1%, 1),\n  CF, $DB124,\n  CC, MIN(100%, $CZ124 + 1%),\n  CCUW, DA124 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ269,BZ124) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC124 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR124,\n  CL, $DS124,\n  SM, $DT124,\n  SLM, $DU124,\n  SL, $DQ124,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM124, UltCritCard),\n\nCY124 * (Critical*DO124*SL+UwDamage*UWCritical)))",
    "ER124": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL124 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH269,BX124),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL124+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI124*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM269,CC124), $DV124, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH124,\n  Rapid, DG124,\n  SuperTower, $DL124,\n  Rend, $DN124,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM124,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124, $DB124), 1),\n\n  DW, $DR124,\n  CL, $DS124,\n  SM, $DT124,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY124*(DE124*OtherDamage*SL+UWDamage*DF124)))",
    "ES124": "IF(OR(CM124 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH124,\n  Rapid, DG124,\n  RDPM, (1+$DI124*$DJ124*$AQ$9),\n  Rend, $DN124,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK269,CA124),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM124+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124, $DB124), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR124,\n  CL, $DS124,\n  SM, $DT124,\n  SLM, $DU124,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY124*(DE124*OtherDamage*SL+UwDamage*DF124)))",
    "ET124": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN124 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM124,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN124+1, $DB124), 1),\n\n  DW, $DR124,\n  CL, $DS124,\n  SM, $DT124,\n  SLM, $DU124,\n  SL, $DQ124,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY124*(DE124*DO124*SL+UWDamage*DF124)))",
    "EU124": "IF(OR(NOT($BA$3), NOT($BA$23), $CO124 > $BA$15), \"\", 1 + 0.5*(CO124+1))",
    "EW124": "IF(DZ124=\"\", \"\", LET(\n  Now, CT124,\n  Next, DZ124,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT124),\nFactor/Cost))",
    "EX124": "IF(EA124=\"\",\"\",(EA124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU124))",
    "EY124": "IF(EB124=\"\",\"\",(EB124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV124))",
    "EZ124": "IF(EC124=\"\",\"\",(EC124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW124))",
    "FA124": "IF(ED124=\"\",\"\",(ED124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX124))",
    "FB124": "IF(EE124=\"\",\"\",(EE124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY124))",
    "FC124": "IF(EF124=\"\",\"\",(EF124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ124))",
    "FD124": "IF(EG124=\"\",\"\",(EG124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA124))",
    "FE124": "IF(EH124=\"\",\"\",(EH124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB124))",
    "FF124": "IF(EI124=\"\",\"\",(EI124/$DX124-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC124+1, 1, CC124))))",
    "FG124": "IF(EJ124=\"\",\"\",(EJ124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD124))",
    "FH124": "IF(EK124=\"\",\"\",(EK124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE124))",
    "FI124": "IF(EL124=\"\",\"\",(EL124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF124))",
    "FJ124": "IF(EM124=\"\", \"\", LET(\n  Now, CW124,\n  Next, EM124,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG124),\nFactor/Cost))",
    "FK124": "IF(EN124=\"\",\"\",(EN124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH124))",
    "FL124": "IF(EO124=\"\", \"\", LET(\n  Now, CS124,\n  Next, EO124,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI124),\nFactor/Cost))",
    "FM124": "IF(EP124=\"\",\"\",(EP124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ124))",
    "FN124": "IF(EQ124=\"\",\"\",(EQ124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK124))",
    "FO124": "IF(ER124=\"\",\"\",(ER124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL124))",
    "FP124": "IF(ES124=\"\",\"\",(ES124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM124))",
    "FQ124": "IF(ET124=\"\",\"\",(ET124/$DX124-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN124))",
    "FR124": "IF(EU124=\"\", \"\", LET(\n  Now, CX124,\n  Next, EU124,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO124),\nFactor/Cost))",
    "FT124": "IF(COLUMN(EW124:FR124) = MIN(IF(EW124:FR124=MAX(EW124:FR124), COLUMN(EW124:FR124))), 1, \"\")",
    "D125": "IF(SUM(FT124:GP124),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F125)),\"Card Mastery\",F125),G125)/$D$5,\"\")",
    "F125": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT124:GP124),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT124:GP124=1)),)\"),\"Critical Factor\")",
    "G125": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT124:GP124),ARRAYFORMULA(FILTER(BT124:CP124 , FT124:GP124=1)),\"\"\"\")\"),30.0)",
    "I125": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT124:GP124),ARRAYFORMULA(FILTER(EW124:FS124 , FT124:GP124=1))*D$5,\"\"\"\")\"),0.005947858763437079)",
    "K125": "IF(D116,FORMAT_TIME_YEAR(SUM($D$6:$D125)),)",
    "BT125": "BT124+FT124",
    "BU125": "BU124+FU124",
    "BV125": "BV124+FV124",
    "BW125": "BW124+FW124",
    "BX125": "BX124+FX124",
    "BY125": "BY124+FY124",
    "BZ125": "BZ124+FZ124",
    "CA125": "CA124+GA124",
    "CB125": "CB124+GB124",
    "CC125": "CC124+GC124",
    "CD125": "CD124+GD124",
    "CE125": "CE124+GE124",
    "CF125": "CF124+GF124",
    "CG125": "CG124+GG124",
    "CH125": "CH124+GH124",
    "CI125": "CI124+GI124",
    "CJ125": "CJ124+GJ124",
    "CK125": "CK124+GK124",
    "CL125": "CL124+GL124",
    "CM125": "CM124+GM124",
    "CN125": "CN124+GN124",
    "CO125": "CO124+GO124",
    "CS125": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI125,1)",
    "CT125": "INDEX($BD$5:$BD270,BT125)",
    "CU125": "INDEX($BN$5:$BN270,CD125)",
    "CV125": "INDEX($BO$5:$BO270,CE125)",
    "CW125": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG125)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX125": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO125, 1)",
    "CY125": "LET(\n  Base, $CR$6,\n  Damage, $CT125,\n  DamageMastery, $CS125,\n  DemonMastery, $CX125,\n  SPB, $CU125,\n  ITO, $CV125,\n  Shock, $CW125,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ125": "MIN(100%, DA125)",
    "DA125": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK125*1%, 0)",
    "DB125": "LET(\n  Lab, 1+INDEX($BF$5:$BF270,BV125),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC125": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK125*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI270,BY125) + CardCritMastery)",
    "DD125": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK125*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ270,BZ125) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE125": "LET(\n  CF, $DB125,\n  CC, $CZ125,\n  SCM, $DD125,\n  SCC, $DC125,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF125": "LET(\n  CF, $DB125,\n  CC, $DA125,\n  SCM, $DD125,\n  SCC, $DC125,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG125": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH125)), 0)",
    "DH125": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ125*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE270,BU125),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI125": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG270, BW125), 1) + $AE$9)",
    "DJ125": "LET(\n  DpmLab, INDEX($BH$5:$BH270,BX125),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL125, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK125": "(1+$DI125*$DJ125*$AQ$9)",
    "DL125": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK270,CA125),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM125*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM125": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK270,CA125),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM125*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN125": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL270,CB125)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO125": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH125,\n  Rapid, DG125,\n  RDPM, DK125,\n  SuperTower, $DL125,\n  Rend, $DN125,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP125": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ125": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK125),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR125": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP125),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF125-1))",
    "DS125": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG125, DH125),0))",
    "DT125": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP125),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV125, $AR$29), 0))",
    "DU125": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK125),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM270,CC125), $DV125, $AR$29), 0))",
    "DV125": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH125), $AO$29)",
    "DW125": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM125,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125, $DB125), 1),\n\n  DW, $DR125,\n  CL, $DS125,\n  SM, $DT125,\n  SLM, $DU125,\n  SL, $DQ125,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX125": "CY125*(DE125*DO125*DQ125+DW125*DF125)",
    "DZ125": "IF(INDEX($BD$6:$BD270,BT125)=\"\", \"\", INDEX($BD$5:$BD270,BT125+1))",
    "EA125": "IF(OR($AO$25, INDEX($BE$6:$BE270,BU125)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ125)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE270,BU125+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI125*$DJ125*$AQ$9),\n  SuperTower, $DL125,\n  Rend, $DN125,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125, $DB125), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR125,\n  SM, $DT125,\n  SLM, $DU125,\n  SL, $DQ125,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM125, UltCritCard),\n\nCY125*(DE125*OtherDamage*SL+UwDamage*DF125)))",
    "EB125": "IF(INDEX($BF$6:$BF270,BV125)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF270,BV125+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ125,\n  CCUW, $DA125,\n  SCM, $DD125,\n  SCC, $DC125,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125, CF), 1),\n\n  DW, $DR125,\n  CL, $DS125,\n  SM, $DT125,\n  SLM, $DU125,\n  SL, $DQ125,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM125, UltCritCard),\n\nCY125 * (Critical * DO125 * SL + UwDamage * UWCritical)))",
    "EC125": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG270,BW125)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH125,\n  Rapid, DG125,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG270, BW125+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ125*$AQ$9),\n  SuperTower, $DL125,\n  Rend, $DN125,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM270,CC125), $DV125, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM125,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125, $DB125), 1),\n\n  DW, $DR125,\n  CL, $DS125,\n  SM, $DT125,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY125*(DE125*OtherDamage*SL+UWDamage*DF125)))",
    "ED125": "IF(OR($AO$25, INDEX($BH$6:$BH270,BX125)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH270,BX125+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL125, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI125*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM270,CC125), $DV125, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH125,\n  Rapid, DG125,\n  SuperTower, $DL125,\n  Rend, $DN125,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM125,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125, $DB125), 1),\n\n  DW, $DR125,\n  CL, $DS125,\n  SM, $DT125,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY125*(DE125*OtherDamage*SL+UWDamage*DF125)))",
    "EE125": "IF(INDEX($BI$6:$BI270,BY125)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK125, 0),\n  CF, $DB125,\n  CC, $CZ125,\n  CCUW, $DA125,\n  SCM, $DD125,\n  SCC, $AV$17+INDEX($BI$5:$BI270,BY125+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY125 * (Critical*DO125*$DQ125+DW125*UWCritical)))",
    "EF125": "IF(INDEX($BJ$6:$BJ270,BZ125)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK125*1%, 1),\n  CF, $DB125,\n  CC, $CZ125,\n  CCUW, $DA125,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ270,BZ125+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC125,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY125*(Critical*DO125*$DQ125+DW125*UWCritical)))",
    "EG125": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK270,CA125)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH125,\n  Rapid, DG125,\n  DPM, (1+$DI125*$DJ125*$AQ$9),\n  Rend, $DN125,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK270,CA125+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM125*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125, $DB125), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK270,CA125+1)-1))/(45-CM125*3),1),\n\n  SL, $DQ125,\n  DW, $DR125,\n  CL, $DS125,\n  SM, $DT125,\n  SLM, $DU125,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY125*(DE125*OtherDamage*SL+UwDamage*DF125)))",
    "EH125": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL270,CB125+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL270,CB125)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH125,\n  Rapid, DG125,\n  DPM, (1+$DI125*$DJ125*$AQ$9),\n  SuperTower, $DL125,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL270,CB125+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY125*(DE125*OtherDamage*$DQ125+DW125*DF125)))",
    "EI125": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM270,CC125)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125, $DB125), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK125),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV125, $AR$29), 0),\n\n  DW, $DR125,\n  CL, $DS125,\n  SM, $DT125,\n  SL, $DQ125,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM125, UltCritCard),\nCY125*(DE125*DO125*SL+UwDamage*DF125)))",
    "EJ125": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN270,CD125)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT125,\n  DamageMastery, $CS125,\n  DemonMastery, $CX125,\n  SPB, INDEX($BN$5:$BN270,CD125+1),\n  ITO, $CV125,\n  Shock, $CW125,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE125*DO125*$DQ125+DW125*DF125)))",
    "EK125": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO270,CE125)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT125,\n  DamageMastery, $CS125,\n  DemonMastery, $CX125,\n  SPB, $CU125,\n  ITO, INDEX($BO$5:$BO270,CE125+1),\n  Shock, $CW125,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE125*DO125*$DQ125+DW125*DF125)))",
    "EL125": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP270,CF125)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125, $DB125), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP125),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF125),\n  CL, $DS125,\n  SM, $DT125,\n  SLM, $DU125,\n  SL, $DQ125,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM125, UltCritCard),\nCY125*(DE125*DO125*SL+UwDamage*DF125)))",
    "EM125": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ270,CG125)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG125+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN125": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR270,CH125)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125, $DB125), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH125+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP125),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK125),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM270,CC125), SMHeat, $AR$29), 0),\n\n  DW, $DR125,\n  CL, $DS125,\n  SL, $DQ125,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM125, UltCritCard),\nCY125*(DE125*DO125*SL+UwDamage*DF125)))",
    "EO125": "IF(OR(CI125 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI125+1))",
    "EP125": "IF(OR($AO$25, CJ125 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ125+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE269,BU125),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL125, 1),\n  DPM, (1+$DI125*CardRangeMastery*$DJ125*$AQ$9),\n  SuperTower, $DL125,\n  Rend, $DN125,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125, $DB125), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR125,\n  SM, $DT125,\n  SLM, $DU125,\n  SL, $DQ125,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM125, UltCritCard),\n\nCY125*(DE125*OtherDamage*SL+UwDamage*DF125)))",
    "EQ125": "IF(OR(CK125 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK125+1)*1%, 1),\n  CF, $DB125,\n  CC, MIN(100%, $CZ125 + 1%),\n  CCUW, DA125 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ270,BZ125) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC125 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR125,\n  CL, $DS125,\n  SM, $DT125,\n  SLM, $DU125,\n  SL, $DQ125,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM125, UltCritCard),\n\nCY125 * (Critical*DO125*SL+UwDamage*UWCritical)))",
    "ER125": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL125 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH270,BX125),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL125+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI125*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM270,CC125), $DV125, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH125,\n  Rapid, DG125,\n  SuperTower, $DL125,\n  Rend, $DN125,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM125,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125, $DB125), 1),\n\n  DW, $DR125,\n  CL, $DS125,\n  SM, $DT125,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY125*(DE125*OtherDamage*SL+UWDamage*DF125)))",
    "ES125": "IF(OR(CM125 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH125,\n  Rapid, DG125,\n  RDPM, (1+$DI125*$DJ125*$AQ$9),\n  Rend, $DN125,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK270,CA125),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM125+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125, $DB125), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR125,\n  CL, $DS125,\n  SM, $DT125,\n  SLM, $DU125,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY125*(DE125*OtherDamage*SL+UwDamage*DF125)))",
    "ET125": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN125 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM125,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN125+1, $DB125), 1),\n\n  DW, $DR125,\n  CL, $DS125,\n  SM, $DT125,\n  SLM, $DU125,\n  SL, $DQ125,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY125*(DE125*DO125*SL+UWDamage*DF125)))",
    "EU125": "IF(OR(NOT($BA$3), NOT($BA$23), $CO125 > $BA$15), \"\", 1 + 0.5*(CO125+1))",
    "EW125": "IF(DZ125=\"\", \"\", LET(\n  Now, CT125,\n  Next, DZ125,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT125),\nFactor/Cost))",
    "EX125": "IF(EA125=\"\",\"\",(EA125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU125))",
    "EY125": "IF(EB125=\"\",\"\",(EB125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV125))",
    "EZ125": "IF(EC125=\"\",\"\",(EC125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW125))",
    "FA125": "IF(ED125=\"\",\"\",(ED125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX125))",
    "FB125": "IF(EE125=\"\",\"\",(EE125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY125))",
    "FC125": "IF(EF125=\"\",\"\",(EF125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ125))",
    "FD125": "IF(EG125=\"\",\"\",(EG125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA125))",
    "FE125": "IF(EH125=\"\",\"\",(EH125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB125))",
    "FF125": "IF(EI125=\"\",\"\",(EI125/$DX125-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC125+1, 1, CC125))))",
    "FG125": "IF(EJ125=\"\",\"\",(EJ125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD125))",
    "FH125": "IF(EK125=\"\",\"\",(EK125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE125))",
    "FI125": "IF(EL125=\"\",\"\",(EL125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF125))",
    "FJ125": "IF(EM125=\"\", \"\", LET(\n  Now, CW125,\n  Next, EM125,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG125),\nFactor/Cost))",
    "FK125": "IF(EN125=\"\",\"\",(EN125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH125))",
    "FL125": "IF(EO125=\"\", \"\", LET(\n  Now, CS125,\n  Next, EO125,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI125),\nFactor/Cost))",
    "FM125": "IF(EP125=\"\",\"\",(EP125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ125))",
    "FN125": "IF(EQ125=\"\",\"\",(EQ125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK125))",
    "FO125": "IF(ER125=\"\",\"\",(ER125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL125))",
    "FP125": "IF(ES125=\"\",\"\",(ES125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM125))",
    "FQ125": "IF(ET125=\"\",\"\",(ET125/$DX125-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN125))",
    "FR125": "IF(EU125=\"\", \"\", LET(\n  Now, CX125,\n  Next, EU125,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO125),\nFactor/Cost))",
    "FT125": "IF(COLUMN(EW125:FR125) = MIN(IF(EW125:FR125=MAX(EW125:FR125), COLUMN(EW125:FR125))), 1, \"\")",
    "D126": "IF(SUM(FT125:GP125),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F126)),\"Card Mastery\",F126),G126)/$D$5,\"\")",
    "F126": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT125:GP125),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT125:GP125=1)),)\"),\"Damage / Meter\")",
    "G126": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT125:GP125),ARRAYFORMULA(FILTER(BT125:CP125 , FT125:GP125=1)),\"\"\"\")\"),21.0)",
    "I126": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT125:GP125),ARRAYFORMULA(FILTER(EW125:FS125 , FT125:GP125=1))*D$5,\"\"\"\")\"),0.005884350001327612)",
    "K126": "IF(H126<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D126)),)",
    "BT126": "BT125+FT125",
    "BU126": "BU125+FU125",
    "BV126": "BV125+FV125",
    "BW126": "BW125+FW125",
    "BX126": "BX125+FX125",
    "BY126": "BY125+FY125",
    "BZ126": "BZ125+FZ125",
    "CA126": "CA125+GA125",
    "CB126": "CB125+GB125",
    "CC126": "CC125+GC125",
    "CD126": "CD125+GD125",
    "CE126": "CE125+GE125",
    "CF126": "CF125+GF125",
    "CG126": "CG125+GG125",
    "CH126": "CH125+GH125",
    "CI126": "CI125+GI125",
    "CJ126": "CJ125+GJ125",
    "CK126": "CK125+GK125",
    "CL126": "CL125+GL125",
    "CM126": "CM125+GM125",
    "CN126": "CN125+GN125",
    "CO126": "CO125+GO125",
    "CS126": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI126,1)",
    "CT126": "INDEX($BD$5:$BD271,BT126)",
    "CU126": "INDEX($BN$5:$BN271,CD126)",
    "CV126": "INDEX($BO$5:$BO271,CE126)",
    "CW126": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG126)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX126": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO126, 1)",
    "CY126": "LET(\n  Base, $CR$6,\n  Damage, $CT126,\n  DamageMastery, $CS126,\n  DemonMastery, $CX126,\n  SPB, $CU126,\n  ITO, $CV126,\n  Shock, $CW126,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ126": "MIN(100%, DA126)",
    "DA126": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK126*1%, 0)",
    "DB126": "LET(\n  Lab, 1+INDEX($BF$5:$BF271,BV126),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC126": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK126*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI271,BY126) + CardCritMastery)",
    "DD126": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK126*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ271,BZ126) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE126": "LET(\n  CF, $DB126,\n  CC, $CZ126,\n  SCM, $DD126,\n  SCC, $DC126,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF126": "LET(\n  CF, $DB126,\n  CC, $DA126,\n  SCM, $DD126,\n  SCC, $DC126,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG126": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH126)), 0)",
    "DH126": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ126*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE271,BU126),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI126": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG271, BW126), 1) + $AE$9)",
    "DJ126": "LET(\n  DpmLab, INDEX($BH$5:$BH271,BX126),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL126, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK126": "(1+$DI126*$DJ126*$AQ$9)",
    "DL126": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK271,CA126),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM126*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM126": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK271,CA126),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM126*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN126": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL271,CB126)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO126": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH126,\n  Rapid, DG126,\n  RDPM, DK126,\n  SuperTower, $DL126,\n  Rend, $DN126,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP126": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ126": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK126),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR126": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP126),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF126-1))",
    "DS126": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG126, DH126),0))",
    "DT126": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP126),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV126, $AR$29), 0))",
    "DU126": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK126),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM271,CC126), $DV126, $AR$29), 0))",
    "DV126": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH126), $AO$29)",
    "DW126": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM126,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126, $DB126), 1),\n\n  DW, $DR126,\n  CL, $DS126,\n  SM, $DT126,\n  SLM, $DU126,\n  SL, $DQ126,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX126": "CY126*(DE126*DO126*DQ126+DW126*DF126)",
    "DZ126": "IF(INDEX($BD$6:$BD271,BT126)=\"\", \"\", INDEX($BD$5:$BD271,BT126+1))",
    "EA126": "IF(OR($AO$25, INDEX($BE$6:$BE271,BU126)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ126)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE271,BU126+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI126*$DJ126*$AQ$9),\n  SuperTower, $DL126,\n  Rend, $DN126,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126, $DB126), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR126,\n  SM, $DT126,\n  SLM, $DU126,\n  SL, $DQ126,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM126, UltCritCard),\n\nCY126*(DE126*OtherDamage*SL+UwDamage*DF126)))",
    "EB126": "IF(INDEX($BF$6:$BF271,BV126)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF271,BV126+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ126,\n  CCUW, $DA126,\n  SCM, $DD126,\n  SCC, $DC126,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126, CF), 1),\n\n  DW, $DR126,\n  CL, $DS126,\n  SM, $DT126,\n  SLM, $DU126,\n  SL, $DQ126,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM126, UltCritCard),\n\nCY126 * (Critical * DO126 * SL + UwDamage * UWCritical)))",
    "EC126": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG271,BW126)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH126,\n  Rapid, DG126,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG271, BW126+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ126*$AQ$9),\n  SuperTower, $DL126,\n  Rend, $DN126,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM271,CC126), $DV126, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM126,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126, $DB126), 1),\n\n  DW, $DR126,\n  CL, $DS126,\n  SM, $DT126,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY126*(DE126*OtherDamage*SL+UWDamage*DF126)))",
    "ED126": "IF(OR($AO$25, INDEX($BH$6:$BH271,BX126)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH271,BX126+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL126, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI126*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM271,CC126), $DV126, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH126,\n  Rapid, DG126,\n  SuperTower, $DL126,\n  Rend, $DN126,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM126,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126, $DB126), 1),\n\n  DW, $DR126,\n  CL, $DS126,\n  SM, $DT126,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY126*(DE126*OtherDamage*SL+UWDamage*DF126)))",
    "EE126": "IF(INDEX($BI$6:$BI271,BY126)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK126, 0),\n  CF, $DB126,\n  CC, $CZ126,\n  CCUW, $DA126,\n  SCM, $DD126,\n  SCC, $AV$17+INDEX($BI$5:$BI271,BY126+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY126 * (Critical*DO126*$DQ126+DW126*UWCritical)))",
    "EF126": "IF(INDEX($BJ$6:$BJ271,BZ126)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK126*1%, 1),\n  CF, $DB126,\n  CC, $CZ126,\n  CCUW, $DA126,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ271,BZ126+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC126,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY126*(Critical*DO126*$DQ126+DW126*UWCritical)))",
    "EG126": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK271,CA126)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH126,\n  Rapid, DG126,\n  DPM, (1+$DI126*$DJ126*$AQ$9),\n  Rend, $DN126,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK271,CA126+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM126*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126, $DB126), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK271,CA126+1)-1))/(45-CM126*3),1),\n\n  SL, $DQ126,\n  DW, $DR126,\n  CL, $DS126,\n  SM, $DT126,\n  SLM, $DU126,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY126*(DE126*OtherDamage*SL+UwDamage*DF126)))",
    "EH126": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL271,CB126+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL271,CB126)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH126,\n  Rapid, DG126,\n  DPM, (1+$DI126*$DJ126*$AQ$9),\n  SuperTower, $DL126,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL271,CB126+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY126*(DE126*OtherDamage*$DQ126+DW126*DF126)))",
    "EI126": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM271,CC126)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126, $DB126), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK126),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV126, $AR$29), 0),\n\n  DW, $DR126,\n  CL, $DS126,\n  SM, $DT126,\n  SL, $DQ126,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM126, UltCritCard),\nCY126*(DE126*DO126*SL+UwDamage*DF126)))",
    "EJ126": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN271,CD126)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT126,\n  DamageMastery, $CS126,\n  DemonMastery, $CX126,\n  SPB, INDEX($BN$5:$BN271,CD126+1),\n  ITO, $CV126,\n  Shock, $CW126,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE126*DO126*$DQ126+DW126*DF126)))",
    "EK126": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO271,CE126)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT126,\n  DamageMastery, $CS126,\n  DemonMastery, $CX126,\n  SPB, $CU126,\n  ITO, INDEX($BO$5:$BO271,CE126+1),\n  Shock, $CW126,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE126*DO126*$DQ126+DW126*DF126)))",
    "EL126": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP271,CF126)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126, $DB126), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP126),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF126),\n  CL, $DS126,\n  SM, $DT126,\n  SLM, $DU126,\n  SL, $DQ126,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM126, UltCritCard),\nCY126*(DE126*DO126*SL+UwDamage*DF126)))",
    "EM126": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ271,CG126)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG126+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN126": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR271,CH126)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126, $DB126), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH126+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP126),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK126),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM271,CC126), SMHeat, $AR$29), 0),\n\n  DW, $DR126,\n  CL, $DS126,\n  SL, $DQ126,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM126, UltCritCard),\nCY126*(DE126*DO126*SL+UwDamage*DF126)))",
    "EO126": "IF(OR(CI126 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI126+1))",
    "EP126": "IF(OR($AO$25, CJ126 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ126+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE270,BU126),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL126, 1),\n  DPM, (1+$DI126*CardRangeMastery*$DJ126*$AQ$9),\n  SuperTower, $DL126,\n  Rend, $DN126,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126, $DB126), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR126,\n  SM, $DT126,\n  SLM, $DU126,\n  SL, $DQ126,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM126, UltCritCard),\n\nCY126*(DE126*OtherDamage*SL+UwDamage*DF126)))",
    "EQ126": "IF(OR(CK126 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK126+1)*1%, 1),\n  CF, $DB126,\n  CC, MIN(100%, $CZ126 + 1%),\n  CCUW, DA126 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ271,BZ126) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC126 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR126,\n  CL, $DS126,\n  SM, $DT126,\n  SLM, $DU126,\n  SL, $DQ126,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM126, UltCritCard),\n\nCY126 * (Critical*DO126*SL+UwDamage*UWCritical)))",
    "ER126": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL126 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH271,BX126),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL126+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI126*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM271,CC126), $DV126, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH126,\n  Rapid, DG126,\n  SuperTower, $DL126,\n  Rend, $DN126,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM126,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126, $DB126), 1),\n\n  DW, $DR126,\n  CL, $DS126,\n  SM, $DT126,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY126*(DE126*OtherDamage*SL+UWDamage*DF126)))",
    "ES126": "IF(OR(CM126 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH126,\n  Rapid, DG126,\n  RDPM, (1+$DI126*$DJ126*$AQ$9),\n  Rend, $DN126,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK271,CA126),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM126+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126, $DB126), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR126,\n  CL, $DS126,\n  SM, $DT126,\n  SLM, $DU126,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY126*(DE126*OtherDamage*SL+UwDamage*DF126)))",
    "ET126": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN126 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM126,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN126+1, $DB126), 1),\n\n  DW, $DR126,\n  CL, $DS126,\n  SM, $DT126,\n  SLM, $DU126,\n  SL, $DQ126,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY126*(DE126*DO126*SL+UWDamage*DF126)))",
    "EU126": "IF(OR(NOT($BA$3), NOT($BA$23), $CO126 > $BA$15), \"\", 1 + 0.5*(CO126+1))",
    "EW126": "IF(DZ126=\"\", \"\", LET(\n  Now, CT126,\n  Next, DZ126,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT126),\nFactor/Cost))",
    "EX126": "IF(EA126=\"\",\"\",(EA126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU126))",
    "EY126": "IF(EB126=\"\",\"\",(EB126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV126))",
    "EZ126": "IF(EC126=\"\",\"\",(EC126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW126))",
    "FA126": "IF(ED126=\"\",\"\",(ED126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX126))",
    "FB126": "IF(EE126=\"\",\"\",(EE126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY126))",
    "FC126": "IF(EF126=\"\",\"\",(EF126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ126))",
    "FD126": "IF(EG126=\"\",\"\",(EG126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA126))",
    "FE126": "IF(EH126=\"\",\"\",(EH126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB126))",
    "FF126": "IF(EI126=\"\",\"\",(EI126/$DX126-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC126+1, 1, CC126))))",
    "FG126": "IF(EJ126=\"\",\"\",(EJ126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD126))",
    "FH126": "IF(EK126=\"\",\"\",(EK126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE126))",
    "FI126": "IF(EL126=\"\",\"\",(EL126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF126))",
    "FJ126": "IF(EM126=\"\", \"\", LET(\n  Now, CW126,\n  Next, EM126,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG126),\nFactor/Cost))",
    "FK126": "IF(EN126=\"\",\"\",(EN126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH126))",
    "FL126": "IF(EO126=\"\", \"\", LET(\n  Now, CS126,\n  Next, EO126,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI126),\nFactor/Cost))",
    "FM126": "IF(EP126=\"\",\"\",(EP126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ126))",
    "FN126": "IF(EQ126=\"\",\"\",(EQ126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK126))",
    "FO126": "IF(ER126=\"\",\"\",(ER126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL126))",
    "FP126": "IF(ES126=\"\",\"\",(ES126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM126))",
    "FQ126": "IF(ET126=\"\",\"\",(ET126/$DX126-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN126))",
    "FR126": "IF(EU126=\"\", \"\", LET(\n  Now, CX126,\n  Next, EU126,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO126),\nFactor/Cost))",
    "FT126": "IF(COLUMN(EW126:FR126) = MIN(IF(EW126:FR126=MAX(EW126:FR126), COLUMN(EW126:FR126))), 1, \"\")",
    "D127": "IF(SUM(FT126:GP126),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F127)),\"Card Mastery\",F127),G127)/$D$5,\"\")",
    "F127": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT126:GP126),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT126:GP126=1)),)\"),\"Damage\")",
    "G127": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT126:GP126),ARRAYFORMULA(FILTER(BT126:CP126 , FT126:GP126=1)),\"\"\"\")\"),28.0)",
    "I127": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT126:GP126),ARRAYFORMULA(FILTER(EW126:FS126 , FT126:GP126=1))*D$5,\"\"\"\")\"),0.0056448230308780165)",
    "K127": "IF(H127<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D127)),)",
    "BT127": "BT126+FT126",
    "BU127": "BU126+FU126",
    "BV127": "BV126+FV126",
    "BW127": "BW126+FW126",
    "BX127": "BX126+FX126",
    "BY127": "BY126+FY126",
    "BZ127": "BZ126+FZ126",
    "CA127": "CA126+GA126",
    "CB127": "CB126+GB126",
    "CC127": "CC126+GC126",
    "CD127": "CD126+GD126",
    "CE127": "CE126+GE126",
    "CF127": "CF126+GF126",
    "CG127": "CG126+GG126",
    "CH127": "CH126+GH126",
    "CI127": "CI126+GI126",
    "CJ127": "CJ126+GJ126",
    "CK127": "CK126+GK126",
    "CL127": "CL126+GL126",
    "CM127": "CM126+GM126",
    "CN127": "CN126+GN126",
    "CO127": "CO126+GO126",
    "CS127": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI127,1)",
    "CT127": "INDEX($BD$5:$BD272,BT127)",
    "CU127": "INDEX($BN$5:$BN272,CD127)",
    "CV127": "INDEX($BO$5:$BO272,CE127)",
    "CW127": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG127)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX127": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO127, 1)",
    "CY127": "LET(\n  Base, $CR$6,\n  Damage, $CT127,\n  DamageMastery, $CS127,\n  DemonMastery, $CX127,\n  SPB, $CU127,\n  ITO, $CV127,\n  Shock, $CW127,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ127": "MIN(100%, DA127)",
    "DA127": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK127*1%, 0)",
    "DB127": "LET(\n  Lab, 1+INDEX($BF$5:$BF272,BV127),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC127": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK127*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI272,BY127) + CardCritMastery)",
    "DD127": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK127*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ272,BZ127) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE127": "LET(\n  CF, $DB127,\n  CC, $CZ127,\n  SCM, $DD127,\n  SCC, $DC127,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF127": "LET(\n  CF, $DB127,\n  CC, $DA127,\n  SCM, $DD127,\n  SCC, $DC127,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG127": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH127)), 0)",
    "DH127": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ127*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE272,BU127),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI127": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG272, BW127), 1) + $AE$9)",
    "DJ127": "LET(\n  DpmLab, INDEX($BH$5:$BH272,BX127),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL127, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK127": "(1+$DI127*$DJ127*$AQ$9)",
    "DL127": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK272,CA127),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM127*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM127": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK272,CA127),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM127*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN127": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL272,CB127)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO127": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH127,\n  Rapid, DG127,\n  RDPM, DK127,\n  SuperTower, $DL127,\n  Rend, $DN127,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP127": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ127": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK127),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR127": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP127),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF127-1))",
    "DS127": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG127, DH127),0))",
    "DT127": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP127),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV127, $AR$29), 0))",
    "DU127": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK127),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM272,CC127), $DV127, $AR$29), 0))",
    "DV127": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH127), $AO$29)",
    "DW127": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM127,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127, $DB127), 1),\n\n  DW, $DR127,\n  CL, $DS127,\n  SM, $DT127,\n  SLM, $DU127,\n  SL, $DQ127,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX127": "CY127*(DE127*DO127*DQ127+DW127*DF127)",
    "DZ127": "IF(INDEX($BD$6:$BD272,BT127)=\"\", \"\", INDEX($BD$5:$BD272,BT127+1))",
    "EA127": "IF(OR($AO$25, INDEX($BE$6:$BE272,BU127)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ127)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE272,BU127+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI127*$DJ127*$AQ$9),\n  SuperTower, $DL127,\n  Rend, $DN127,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127, $DB127), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR127,\n  SM, $DT127,\n  SLM, $DU127,\n  SL, $DQ127,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM127, UltCritCard),\n\nCY127*(DE127*OtherDamage*SL+UwDamage*DF127)))",
    "EB127": "IF(INDEX($BF$6:$BF272,BV127)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF272,BV127+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ127,\n  CCUW, $DA127,\n  SCM, $DD127,\n  SCC, $DC127,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127, CF), 1),\n\n  DW, $DR127,\n  CL, $DS127,\n  SM, $DT127,\n  SLM, $DU127,\n  SL, $DQ127,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM127, UltCritCard),\n\nCY127 * (Critical * DO127 * SL + UwDamage * UWCritical)))",
    "EC127": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG272,BW127)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH127,\n  Rapid, DG127,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG272, BW127+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ127*$AQ$9),\n  SuperTower, $DL127,\n  Rend, $DN127,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM272,CC127), $DV127, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM127,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127, $DB127), 1),\n\n  DW, $DR127,\n  CL, $DS127,\n  SM, $DT127,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY127*(DE127*OtherDamage*SL+UWDamage*DF127)))",
    "ED127": "IF(OR($AO$25, INDEX($BH$6:$BH272,BX127)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH272,BX127+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL127, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI127*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM272,CC127), $DV127, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH127,\n  Rapid, DG127,\n  SuperTower, $DL127,\n  Rend, $DN127,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM127,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127, $DB127), 1),\n\n  DW, $DR127,\n  CL, $DS127,\n  SM, $DT127,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY127*(DE127*OtherDamage*SL+UWDamage*DF127)))",
    "EE127": "IF(INDEX($BI$6:$BI272,BY127)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK127, 0),\n  CF, $DB127,\n  CC, $CZ127,\n  CCUW, $DA127,\n  SCM, $DD127,\n  SCC, $AV$17+INDEX($BI$5:$BI272,BY127+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY127 * (Critical*DO127*$DQ127+DW127*UWCritical)))",
    "EF127": "IF(INDEX($BJ$6:$BJ272,BZ127)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK127*1%, 1),\n  CF, $DB127,\n  CC, $CZ127,\n  CCUW, $DA127,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ272,BZ127+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC127,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY127*(Critical*DO127*$DQ127+DW127*UWCritical)))",
    "EG127": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK272,CA127)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH127,\n  Rapid, DG127,\n  DPM, (1+$DI127*$DJ127*$AQ$9),\n  Rend, $DN127,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK272,CA127+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM127*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127, $DB127), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK272,CA127+1)-1))/(45-CM127*3),1),\n\n  SL, $DQ127,\n  DW, $DR127,\n  CL, $DS127,\n  SM, $DT127,\n  SLM, $DU127,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY127*(DE127*OtherDamage*SL+UwDamage*DF127)))",
    "EH127": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL272,CB127+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL272,CB127)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH127,\n  Rapid, DG127,\n  DPM, (1+$DI127*$DJ127*$AQ$9),\n  SuperTower, $DL127,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL272,CB127+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY127*(DE127*OtherDamage*$DQ127+DW127*DF127)))",
    "EI127": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM272,CC127)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127, $DB127), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK127),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV127, $AR$29), 0),\n\n  DW, $DR127,\n  CL, $DS127,\n  SM, $DT127,\n  SL, $DQ127,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM127, UltCritCard),\nCY127*(DE127*DO127*SL+UwDamage*DF127)))",
    "EJ127": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN272,CD127)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT127,\n  DamageMastery, $CS127,\n  DemonMastery, $CX127,\n  SPB, INDEX($BN$5:$BN272,CD127+1),\n  ITO, $CV127,\n  Shock, $CW127,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE127*DO127*$DQ127+DW127*DF127)))",
    "EK127": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO272,CE127)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT127,\n  DamageMastery, $CS127,\n  DemonMastery, $CX127,\n  SPB, $CU127,\n  ITO, INDEX($BO$5:$BO272,CE127+1),\n  Shock, $CW127,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE127*DO127*$DQ127+DW127*DF127)))",
    "EL127": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP272,CF127)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127, $DB127), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP127),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF127),\n  CL, $DS127,\n  SM, $DT127,\n  SLM, $DU127,\n  SL, $DQ127,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM127, UltCritCard),\nCY127*(DE127*DO127*SL+UwDamage*DF127)))",
    "EM127": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ272,CG127)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG127+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN127": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR272,CH127)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127, $DB127), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH127+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP127),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK127),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM272,CC127), SMHeat, $AR$29), 0),\n\n  DW, $DR127,\n  CL, $DS127,\n  SL, $DQ127,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM127, UltCritCard),\nCY127*(DE127*DO127*SL+UwDamage*DF127)))",
    "EO127": "IF(OR(CI127 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI127+1))",
    "EP127": "IF(OR($AO$25, CJ127 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ127+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE271,BU127),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL127, 1),\n  DPM, (1+$DI127*CardRangeMastery*$DJ127*$AQ$9),\n  SuperTower, $DL127,\n  Rend, $DN127,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127, $DB127), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR127,\n  SM, $DT127,\n  SLM, $DU127,\n  SL, $DQ127,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM127, UltCritCard),\n\nCY127*(DE127*OtherDamage*SL+UwDamage*DF127)))",
    "EQ127": "IF(OR(CK127 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK127+1)*1%, 1),\n  CF, $DB127,\n  CC, MIN(100%, $CZ127 + 1%),\n  CCUW, DA127 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ272,BZ127) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC127 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR127,\n  CL, $DS127,\n  SM, $DT127,\n  SLM, $DU127,\n  SL, $DQ127,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM127, UltCritCard),\n\nCY127 * (Critical*DO127*SL+UwDamage*UWCritical)))",
    "ER127": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL127 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH272,BX127),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL127+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI127*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM272,CC127), $DV127, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH127,\n  Rapid, DG127,\n  SuperTower, $DL127,\n  Rend, $DN127,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM127,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127, $DB127), 1),\n\n  DW, $DR127,\n  CL, $DS127,\n  SM, $DT127,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY127*(DE127*OtherDamage*SL+UWDamage*DF127)))",
    "ES127": "IF(OR(CM127 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH127,\n  Rapid, DG127,\n  RDPM, (1+$DI127*$DJ127*$AQ$9),\n  Rend, $DN127,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK272,CA127),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM127+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127, $DB127), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR127,\n  CL, $DS127,\n  SM, $DT127,\n  SLM, $DU127,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY127*(DE127*OtherDamage*SL+UwDamage*DF127)))",
    "ET127": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN127 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM127,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN127+1, $DB127), 1),\n\n  DW, $DR127,\n  CL, $DS127,\n  SM, $DT127,\n  SLM, $DU127,\n  SL, $DQ127,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY127*(DE127*DO127*SL+UWDamage*DF127)))",
    "EU127": "IF(OR(NOT($BA$3), NOT($BA$23), $CO127 > $BA$15), \"\", 1 + 0.5*(CO127+1))",
    "EW127": "IF(DZ127=\"\", \"\", LET(\n  Now, CT127,\n  Next, DZ127,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT127),\nFactor/Cost))",
    "EX127": "IF(EA127=\"\",\"\",(EA127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU127))",
    "EY127": "IF(EB127=\"\",\"\",(EB127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV127))",
    "EZ127": "IF(EC127=\"\",\"\",(EC127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW127))",
    "FA127": "IF(ED127=\"\",\"\",(ED127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX127))",
    "FB127": "IF(EE127=\"\",\"\",(EE127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY127))",
    "FC127": "IF(EF127=\"\",\"\",(EF127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ127))",
    "FD127": "IF(EG127=\"\",\"\",(EG127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA127))",
    "FE127": "IF(EH127=\"\",\"\",(EH127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB127))",
    "FF127": "IF(EI127=\"\",\"\",(EI127/$DX127-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC127+1, 1, CC127))))",
    "FG127": "IF(EJ127=\"\",\"\",(EJ127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD127))",
    "FH127": "IF(EK127=\"\",\"\",(EK127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE127))",
    "FI127": "IF(EL127=\"\",\"\",(EL127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF127))",
    "FJ127": "IF(EM127=\"\", \"\", LET(\n  Now, CW127,\n  Next, EM127,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG127),\nFactor/Cost))",
    "FK127": "IF(EN127=\"\",\"\",(EN127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH127))",
    "FL127": "IF(EO127=\"\", \"\", LET(\n  Now, CS127,\n  Next, EO127,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI127),\nFactor/Cost))",
    "FM127": "IF(EP127=\"\",\"\",(EP127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ127))",
    "FN127": "IF(EQ127=\"\",\"\",(EQ127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK127))",
    "FO127": "IF(ER127=\"\",\"\",(ER127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL127))",
    "FP127": "IF(ES127=\"\",\"\",(ES127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM127))",
    "FQ127": "IF(ET127=\"\",\"\",(ET127/$DX127-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN127))",
    "FR127": "IF(EU127=\"\", \"\", LET(\n  Now, CX127,\n  Next, EU127,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO127),\nFactor/Cost))",
    "FT127": "IF(COLUMN(EW127:FR127) = MIN(IF(EW127:FR127=MAX(EW127:FR127), COLUMN(EW127:FR127))), 1, \"\")",
    "D128": "IF(SUM(FT127:GP127),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F128)),\"Card Mastery\",F128),G128)/$D$5,\"\")",
    "F128": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT127:GP127),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT127:GP127=1)),)\"),\"Attack Speed\")",
    "G128": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT127:GP127),ARRAYFORMULA(FILTER(BT127:CP127 , FT127:GP127=1)),\"\"\"\")\"),28.0)",
    "I128": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT127:GP127),ARRAYFORMULA(FILTER(EW127:FS127 , FT127:GP127=1))*D$5,\"\"\"\")\"),0.005538012958269929)",
    "K128": "IF(H128<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D128)),)",
    "BT128": "BT127+FT127",
    "BU128": "BU127+FU127",
    "BV128": "BV127+FV127",
    "BW128": "BW127+FW127",
    "BX128": "BX127+FX127",
    "BY128": "BY127+FY127",
    "BZ128": "BZ127+FZ127",
    "CA128": "CA127+GA127",
    "CB128": "CB127+GB127",
    "CC128": "CC127+GC127",
    "CD128": "CD127+GD127",
    "CE128": "CE127+GE127",
    "CF128": "CF127+GF127",
    "CG128": "CG127+GG127",
    "CH128": "CH127+GH127",
    "CI128": "CI127+GI127",
    "CJ128": "CJ127+GJ127",
    "CK128": "CK127+GK127",
    "CL128": "CL127+GL127",
    "CM128": "CM127+GM127",
    "CN128": "CN127+GN127",
    "CO128": "CO127+GO127",
    "CS128": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI128,1)",
    "CT128": "INDEX($BD$5:$BD273,BT128)",
    "CU128": "INDEX($BN$5:$BN273,CD128)",
    "CV128": "INDEX($BO$5:$BO273,CE128)",
    "CW128": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG128)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX128": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO128, 1)",
    "CY128": "LET(\n  Base, $CR$6,\n  Damage, $CT128,\n  DamageMastery, $CS128,\n  DemonMastery, $CX128,\n  SPB, $CU128,\n  ITO, $CV128,\n  Shock, $CW128,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ128": "MIN(100%, DA128)",
    "DA128": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK128*1%, 0)",
    "DB128": "LET(\n  Lab, 1+INDEX($BF$5:$BF273,BV128),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC128": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK128*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI273,BY128) + CardCritMastery)",
    "DD128": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK128*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ273,BZ128) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE128": "LET(\n  CF, $DB128,\n  CC, $CZ128,\n  SCM, $DD128,\n  SCC, $DC128,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF128": "LET(\n  CF, $DB128,\n  CC, $DA128,\n  SCM, $DD128,\n  SCC, $DC128,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG128": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH128)), 0)",
    "DH128": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ128*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE273,BU128),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI128": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG273, BW128), 1) + $AE$9)",
    "DJ128": "LET(\n  DpmLab, INDEX($BH$5:$BH273,BX128),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL128, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK128": "(1+$DI128*$DJ128*$AQ$9)",
    "DL128": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK273,CA128),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM128*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM128": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK273,CA128),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM128*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN128": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL273,CB128)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO128": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH128,\n  Rapid, DG128,\n  RDPM, DK128,\n  SuperTower, $DL128,\n  Rend, $DN128,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP128": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ128": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK128),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR128": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP128),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF128-1))",
    "DS128": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG128, DH128),0))",
    "DT128": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP128),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV128, $AR$29), 0))",
    "DU128": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK128),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM273,CC128), $DV128, $AR$29), 0))",
    "DV128": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH128), $AO$29)",
    "DW128": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM128,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128, $DB128), 1),\n\n  DW, $DR128,\n  CL, $DS128,\n  SM, $DT128,\n  SLM, $DU128,\n  SL, $DQ128,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX128": "CY128*(DE128*DO128*DQ128+DW128*DF128)",
    "DZ128": "IF(INDEX($BD$6:$BD273,BT128)=\"\", \"\", INDEX($BD$5:$BD273,BT128+1))",
    "EA128": "IF(OR($AO$25, INDEX($BE$6:$BE273,BU128)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ128)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE273,BU128+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI128*$DJ128*$AQ$9),\n  SuperTower, $DL128,\n  Rend, $DN128,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128, $DB128), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR128,\n  SM, $DT128,\n  SLM, $DU128,\n  SL, $DQ128,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM128, UltCritCard),\n\nCY128*(DE128*OtherDamage*SL+UwDamage*DF128)))",
    "EB128": "IF(INDEX($BF$6:$BF273,BV128)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF273,BV128+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ128,\n  CCUW, $DA128,\n  SCM, $DD128,\n  SCC, $DC128,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128, CF), 1),\n\n  DW, $DR128,\n  CL, $DS128,\n  SM, $DT128,\n  SLM, $DU128,\n  SL, $DQ128,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM128, UltCritCard),\n\nCY128 * (Critical * DO128 * SL + UwDamage * UWCritical)))",
    "EC128": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG273,BW128)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH128,\n  Rapid, DG128,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG273, BW128+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ128*$AQ$9),\n  SuperTower, $DL128,\n  Rend, $DN128,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM273,CC128), $DV128, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM128,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128, $DB128), 1),\n\n  DW, $DR128,\n  CL, $DS128,\n  SM, $DT128,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY128*(DE128*OtherDamage*SL+UWDamage*DF128)))",
    "ED128": "IF(OR($AO$25, INDEX($BH$6:$BH273,BX128)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH273,BX128+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL128, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI128*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM273,CC128), $DV128, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH128,\n  Rapid, DG128,\n  SuperTower, $DL128,\n  Rend, $DN128,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM128,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128, $DB128), 1),\n\n  DW, $DR128,\n  CL, $DS128,\n  SM, $DT128,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY128*(DE128*OtherDamage*SL+UWDamage*DF128)))",
    "EE128": "IF(INDEX($BI$6:$BI273,BY128)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK128, 0),\n  CF, $DB128,\n  CC, $CZ128,\n  CCUW, $DA128,\n  SCM, $DD128,\n  SCC, $AV$17+INDEX($BI$5:$BI273,BY128+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY128 * (Critical*DO128*$DQ128+DW128*UWCritical)))",
    "EF128": "IF(INDEX($BJ$6:$BJ273,BZ128)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK128*1%, 1),\n  CF, $DB128,\n  CC, $CZ128,\n  CCUW, $DA128,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ273,BZ128+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC128,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY128*(Critical*DO128*$DQ128+DW128*UWCritical)))",
    "EG128": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK273,CA128)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH128,\n  Rapid, DG128,\n  DPM, (1+$DI128*$DJ128*$AQ$9),\n  Rend, $DN128,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK273,CA128+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM128*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128, $DB128), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK273,CA128+1)-1))/(45-CM128*3),1),\n\n  SL, $DQ128,\n  DW, $DR128,\n  CL, $DS128,\n  SM, $DT128,\n  SLM, $DU128,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY128*(DE128*OtherDamage*SL+UwDamage*DF128)))",
    "EH128": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL273,CB128+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL273,CB128)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH128,\n  Rapid, DG128,\n  DPM, (1+$DI128*$DJ128*$AQ$9),\n  SuperTower, $DL128,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL273,CB128+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY128*(DE128*OtherDamage*$DQ128+DW128*DF128)))",
    "EI128": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM273,CC128)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128, $DB128), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK128),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV128, $AR$29), 0),\n\n  DW, $DR128,\n  CL, $DS128,\n  SM, $DT128,\n  SL, $DQ128,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM128, UltCritCard),\nCY128*(DE128*DO128*SL+UwDamage*DF128)))",
    "EJ128": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN273,CD128)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT128,\n  DamageMastery, $CS128,\n  DemonMastery, $CX128,\n  SPB, INDEX($BN$5:$BN273,CD128+1),\n  ITO, $CV128,\n  Shock, $CW128,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE128*DO128*$DQ128+DW128*DF128)))",
    "EK128": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO273,CE128)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT128,\n  DamageMastery, $CS128,\n  DemonMastery, $CX128,\n  SPB, $CU128,\n  ITO, INDEX($BO$5:$BO273,CE128+1),\n  Shock, $CW128,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE128*DO128*$DQ128+DW128*DF128)))",
    "EL128": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP273,CF128)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128, $DB128), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP128),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF128),\n  CL, $DS128,\n  SM, $DT128,\n  SLM, $DU128,\n  SL, $DQ128,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM128, UltCritCard),\nCY128*(DE128*DO128*SL+UwDamage*DF128)))",
    "EM128": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ273,CG128)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG128+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN128": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR273,CH128)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128, $DB128), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH128+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP128),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK128),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM273,CC128), SMHeat, $AR$29), 0),\n\n  DW, $DR128,\n  CL, $DS128,\n  SL, $DQ128,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM128, UltCritCard),\nCY128*(DE128*DO128*SL+UwDamage*DF128)))",
    "EO128": "IF(OR(CI128 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI128+1))",
    "EP128": "IF(OR($AO$25, CJ128 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ128+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE272,BU128),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL128, 1),\n  DPM, (1+$DI128*CardRangeMastery*$DJ128*$AQ$9),\n  SuperTower, $DL128,\n  Rend, $DN128,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128, $DB128), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR128,\n  SM, $DT128,\n  SLM, $DU128,\n  SL, $DQ128,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM128, UltCritCard),\n\nCY128*(DE128*OtherDamage*SL+UwDamage*DF128)))",
    "EQ128": "IF(OR(CK128 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK128+1)*1%, 1),\n  CF, $DB128,\n  CC, MIN(100%, $CZ128 + 1%),\n  CCUW, DA128 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ273,BZ128) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC128 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR128,\n  CL, $DS128,\n  SM, $DT128,\n  SLM, $DU128,\n  SL, $DQ128,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM128, UltCritCard),\n\nCY128 * (Critical*DO128*SL+UwDamage*UWCritical)))",
    "ER128": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL128 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH273,BX128),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL128+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI128*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM273,CC128), $DV128, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH128,\n  Rapid, DG128,\n  SuperTower, $DL128,\n  Rend, $DN128,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM128,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128, $DB128), 1),\n\n  DW, $DR128,\n  CL, $DS128,\n  SM, $DT128,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY128*(DE128*OtherDamage*SL+UWDamage*DF128)))",
    "ES128": "IF(OR(CM128 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH128,\n  Rapid, DG128,\n  RDPM, (1+$DI128*$DJ128*$AQ$9),\n  Rend, $DN128,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK273,CA128),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM128+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128, $DB128), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR128,\n  CL, $DS128,\n  SM, $DT128,\n  SLM, $DU128,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY128*(DE128*OtherDamage*SL+UwDamage*DF128)))",
    "ET128": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN128 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM128,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN128+1, $DB128), 1),\n\n  DW, $DR128,\n  CL, $DS128,\n  SM, $DT128,\n  SLM, $DU128,\n  SL, $DQ128,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY128*(DE128*DO128*SL+UWDamage*DF128)))",
    "EU128": "IF(OR(NOT($BA$3), NOT($BA$23), $CO128 > $BA$15), \"\", 1 + 0.5*(CO128+1))",
    "EW128": "IF(DZ128=\"\", \"\", LET(\n  Now, CT128,\n  Next, DZ128,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT128),\nFactor/Cost))",
    "EX128": "IF(EA128=\"\",\"\",(EA128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU128))",
    "EY128": "IF(EB128=\"\",\"\",(EB128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV128))",
    "EZ128": "IF(EC128=\"\",\"\",(EC128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW128))",
    "FA128": "IF(ED128=\"\",\"\",(ED128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX128))",
    "FB128": "IF(EE128=\"\",\"\",(EE128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY128))",
    "FC128": "IF(EF128=\"\",\"\",(EF128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ128))",
    "FD128": "IF(EG128=\"\",\"\",(EG128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA128))",
    "FE128": "IF(EH128=\"\",\"\",(EH128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB128))",
    "FF128": "IF(EI128=\"\",\"\",(EI128/$DX128-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC128+1, 1, CC128))))",
    "FG128": "IF(EJ128=\"\",\"\",(EJ128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD128))",
    "FH128": "IF(EK128=\"\",\"\",(EK128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE128))",
    "FI128": "IF(EL128=\"\",\"\",(EL128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF128))",
    "FJ128": "IF(EM128=\"\", \"\", LET(\n  Now, CW128,\n  Next, EM128,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG128),\nFactor/Cost))",
    "FK128": "IF(EN128=\"\",\"\",(EN128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH128))",
    "FL128": "IF(EO128=\"\", \"\", LET(\n  Now, CS128,\n  Next, EO128,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI128),\nFactor/Cost))",
    "FM128": "IF(EP128=\"\",\"\",(EP128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ128))",
    "FN128": "IF(EQ128=\"\",\"\",(EQ128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK128))",
    "FO128": "IF(ER128=\"\",\"\",(ER128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL128))",
    "FP128": "IF(ES128=\"\",\"\",(ES128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM128))",
    "FQ128": "IF(ET128=\"\",\"\",(ET128/$DX128-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN128))",
    "FR128": "IF(EU128=\"\", \"\", LET(\n  Now, CX128,\n  Next, EU128,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO128),\nFactor/Cost))",
    "FT128": "IF(COLUMN(EW128:FR128) = MIN(IF(EW128:FR128=MAX(EW128:FR128), COLUMN(EW128:FR128))), 1, \"\")",
    "D129": "IF(SUM(FT128:GP128),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F129)),\"Card Mastery\",F129),G129)/$D$5,\"\")",
    "F129": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT128:GP128),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT128:GP128=1)),)\"),\"Critical Factor\")",
    "G129": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT128:GP128),ARRAYFORMULA(FILTER(BT128:CP128 , FT128:GP128=1)),\"\"\"\")\"),31.0)",
    "I129": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT128:GP128),ARRAYFORMULA(FILTER(EW128:FS128 , FT128:GP128=1))*D$5,\"\"\"\")\"),0.005407340772278568)",
    "K129": "IF(H129<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D129)),)",
    "BT129": "BT128+FT128",
    "BU129": "BU128+FU128",
    "BV129": "BV128+FV128",
    "BW129": "BW128+FW128",
    "BX129": "BX128+FX128",
    "BY129": "BY128+FY128",
    "BZ129": "BZ128+FZ128",
    "CA129": "CA128+GA128",
    "CB129": "CB128+GB128",
    "CC129": "CC128+GC128",
    "CD129": "CD128+GD128",
    "CE129": "CE128+GE128",
    "CF129": "CF128+GF128",
    "CG129": "CG128+GG128",
    "CH129": "CH128+GH128",
    "CI129": "CI128+GI128",
    "CJ129": "CJ128+GJ128",
    "CK129": "CK128+GK128",
    "CL129": "CL128+GL128",
    "CM129": "CM128+GM128",
    "CN129": "CN128+GN128",
    "CO129": "CO128+GO128",
    "CS129": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI129,1)",
    "CT129": "INDEX($BD$5:$BD274,BT129)",
    "CU129": "INDEX($BN$5:$BN274,CD129)",
    "CV129": "INDEX($BO$5:$BO274,CE129)",
    "CW129": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG129)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX129": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO129, 1)",
    "CY129": "LET(\n  Base, $CR$6,\n  Damage, $CT129,\n  DamageMastery, $CS129,\n  DemonMastery, $CX129,\n  SPB, $CU129,\n  ITO, $CV129,\n  Shock, $CW129,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ129": "MIN(100%, DA129)",
    "DA129": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK129*1%, 0)",
    "DB129": "LET(\n  Lab, 1+INDEX($BF$5:$BF274,BV129),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC129": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK129*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI274,BY129) + CardCritMastery)",
    "DD129": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK129*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ274,BZ129) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE129": "LET(\n  CF, $DB129,\n  CC, $CZ129,\n  SCM, $DD129,\n  SCC, $DC129,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF129": "LET(\n  CF, $DB129,\n  CC, $DA129,\n  SCM, $DD129,\n  SCC, $DC129,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG129": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH129)), 0)",
    "DH129": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ129*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE274,BU129),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI129": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG274, BW129), 1) + $AE$9)",
    "DJ129": "LET(\n  DpmLab, INDEX($BH$5:$BH274,BX129),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL129, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK129": "(1+$DI129*$DJ129*$AQ$9)",
    "DL129": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK274,CA129),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM129*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM129": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK274,CA129),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM129*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN129": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL274,CB129)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO129": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH129,\n  Rapid, DG129,\n  RDPM, DK129,\n  SuperTower, $DL129,\n  Rend, $DN129,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP129": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ129": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK129),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR129": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP129),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF129-1))",
    "DS129": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG129, DH129),0))",
    "DT129": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP129),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV129, $AR$29), 0))",
    "DU129": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK129),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM274,CC129), $DV129, $AR$29), 0))",
    "DV129": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH129), $AO$29)",
    "DW129": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM129,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129, $DB129), 1),\n\n  DW, $DR129,\n  CL, $DS129,\n  SM, $DT129,\n  SLM, $DU129,\n  SL, $DQ129,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX129": "CY129*(DE129*DO129*DQ129+DW129*DF129)",
    "DZ129": "IF(INDEX($BD$6:$BD274,BT129)=\"\", \"\", INDEX($BD$5:$BD274,BT129+1))",
    "EA129": "IF(OR($AO$25, INDEX($BE$6:$BE274,BU129)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ129)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE274,BU129+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI129*$DJ129*$AQ$9),\n  SuperTower, $DL129,\n  Rend, $DN129,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129, $DB129), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR129,\n  SM, $DT129,\n  SLM, $DU129,\n  SL, $DQ129,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM129, UltCritCard),\n\nCY129*(DE129*OtherDamage*SL+UwDamage*DF129)))",
    "EB129": "IF(INDEX($BF$6:$BF274,BV129)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF274,BV129+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ129,\n  CCUW, $DA129,\n  SCM, $DD129,\n  SCC, $DC129,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129, CF), 1),\n\n  DW, $DR129,\n  CL, $DS129,\n  SM, $DT129,\n  SLM, $DU129,\n  SL, $DQ129,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM129, UltCritCard),\n\nCY129 * (Critical * DO129 * SL + UwDamage * UWCritical)))",
    "EC129": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG274,BW129)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH129,\n  Rapid, DG129,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG274, BW129+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ129*$AQ$9),\n  SuperTower, $DL129,\n  Rend, $DN129,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM274,CC129), $DV129, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM129,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129, $DB129), 1),\n\n  DW, $DR129,\n  CL, $DS129,\n  SM, $DT129,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY129*(DE129*OtherDamage*SL+UWDamage*DF129)))",
    "ED129": "IF(OR($AO$25, INDEX($BH$6:$BH274,BX129)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH274,BX129+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL129, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI129*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM274,CC129), $DV129, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH129,\n  Rapid, DG129,\n  SuperTower, $DL129,\n  Rend, $DN129,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM129,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129, $DB129), 1),\n\n  DW, $DR129,\n  CL, $DS129,\n  SM, $DT129,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY129*(DE129*OtherDamage*SL+UWDamage*DF129)))",
    "EE129": "IF(INDEX($BI$6:$BI274,BY129)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK129, 0),\n  CF, $DB129,\n  CC, $CZ129,\n  CCUW, $DA129,\n  SCM, $DD129,\n  SCC, $AV$17+INDEX($BI$5:$BI274,BY129+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY129 * (Critical*DO129*$DQ129+DW129*UWCritical)))",
    "EF129": "IF(INDEX($BJ$6:$BJ274,BZ129)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK129*1%, 1),\n  CF, $DB129,\n  CC, $CZ129,\n  CCUW, $DA129,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ274,BZ129+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC129,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY129*(Critical*DO129*$DQ129+DW129*UWCritical)))",
    "EG129": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK274,CA129)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH129,\n  Rapid, DG129,\n  DPM, (1+$DI129*$DJ129*$AQ$9),\n  Rend, $DN129,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK274,CA129+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM129*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129, $DB129), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK274,CA129+1)-1))/(45-CM129*3),1),\n\n  SL, $DQ129,\n  DW, $DR129,\n  CL, $DS129,\n  SM, $DT129,\n  SLM, $DU129,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY129*(DE129*OtherDamage*SL+UwDamage*DF129)))",
    "EH129": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL274,CB129+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL274,CB129)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH129,\n  Rapid, DG129,\n  DPM, (1+$DI129*$DJ129*$AQ$9),\n  SuperTower, $DL129,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL274,CB129+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY129*(DE129*OtherDamage*$DQ129+DW129*DF129)))",
    "EI129": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM274,CC129)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129, $DB129), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK129),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV129, $AR$29), 0),\n\n  DW, $DR129,\n  CL, $DS129,\n  SM, $DT129,\n  SL, $DQ129,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM129, UltCritCard),\nCY129*(DE129*DO129*SL+UwDamage*DF129)))",
    "EJ129": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN274,CD129)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT129,\n  DamageMastery, $CS129,\n  DemonMastery, $CX129,\n  SPB, INDEX($BN$5:$BN274,CD129+1),\n  ITO, $CV129,\n  Shock, $CW129,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE129*DO129*$DQ129+DW129*DF129)))",
    "EK129": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO274,CE129)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT129,\n  DamageMastery, $CS129,\n  DemonMastery, $CX129,\n  SPB, $CU129,\n  ITO, INDEX($BO$5:$BO274,CE129+1),\n  Shock, $CW129,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE129*DO129*$DQ129+DW129*DF129)))",
    "EL129": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP274,CF129)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129, $DB129), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP129),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF129),\n  CL, $DS129,\n  SM, $DT129,\n  SLM, $DU129,\n  SL, $DQ129,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM129, UltCritCard),\nCY129*(DE129*DO129*SL+UwDamage*DF129)))",
    "EM129": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ274,CG129)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG129+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN129": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR274,CH129)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129, $DB129), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH129+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP129),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK129),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM274,CC129), SMHeat, $AR$29), 0),\n\n  DW, $DR129,\n  CL, $DS129,\n  SL, $DQ129,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM129, UltCritCard),\nCY129*(DE129*DO129*SL+UwDamage*DF129)))",
    "EO129": "IF(OR(CI129 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI129+1))",
    "EP129": "IF(OR($AO$25, CJ129 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ129+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE273,BU129),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL129, 1),\n  DPM, (1+$DI129*CardRangeMastery*$DJ129*$AQ$9),\n  SuperTower, $DL129,\n  Rend, $DN129,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129, $DB129), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR129,\n  SM, $DT129,\n  SLM, $DU129,\n  SL, $DQ129,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM129, UltCritCard),\n\nCY129*(DE129*OtherDamage*SL+UwDamage*DF129)))",
    "EQ129": "IF(OR(CK129 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK129+1)*1%, 1),\n  CF, $DB129,\n  CC, MIN(100%, $CZ129 + 1%),\n  CCUW, DA129 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ274,BZ129) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC129 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR129,\n  CL, $DS129,\n  SM, $DT129,\n  SLM, $DU129,\n  SL, $DQ129,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM129, UltCritCard),\n\nCY129 * (Critical*DO129*SL+UwDamage*UWCritical)))",
    "ER129": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL129 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH274,BX129),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL129+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI129*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM274,CC129), $DV129, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH129,\n  Rapid, DG129,\n  SuperTower, $DL129,\n  Rend, $DN129,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM129,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129, $DB129), 1),\n\n  DW, $DR129,\n  CL, $DS129,\n  SM, $DT129,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY129*(DE129*OtherDamage*SL+UWDamage*DF129)))",
    "ES129": "IF(OR(CM129 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH129,\n  Rapid, DG129,\n  RDPM, (1+$DI129*$DJ129*$AQ$9),\n  Rend, $DN129,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK274,CA129),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM129+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129, $DB129), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR129,\n  CL, $DS129,\n  SM, $DT129,\n  SLM, $DU129,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY129*(DE129*OtherDamage*SL+UwDamage*DF129)))",
    "ET129": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN129 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM129,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN129+1, $DB129), 1),\n\n  DW, $DR129,\n  CL, $DS129,\n  SM, $DT129,\n  SLM, $DU129,\n  SL, $DQ129,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY129*(DE129*DO129*SL+UWDamage*DF129)))",
    "EU129": "IF(OR(NOT($BA$3), NOT($BA$23), $CO129 > $BA$15), \"\", 1 + 0.5*(CO129+1))",
    "EW129": "IF(DZ129=\"\", \"\", LET(\n  Now, CT129,\n  Next, DZ129,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT129),\nFactor/Cost))",
    "EX129": "IF(EA129=\"\",\"\",(EA129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU129))",
    "EY129": "IF(EB129=\"\",\"\",(EB129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV129))",
    "EZ129": "IF(EC129=\"\",\"\",(EC129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW129))",
    "FA129": "IF(ED129=\"\",\"\",(ED129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX129))",
    "FB129": "IF(EE129=\"\",\"\",(EE129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY129))",
    "FC129": "IF(EF129=\"\",\"\",(EF129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ129))",
    "FD129": "IF(EG129=\"\",\"\",(EG129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA129))",
    "FE129": "IF(EH129=\"\",\"\",(EH129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB129))",
    "FF129": "IF(EI129=\"\",\"\",(EI129/$DX129-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC129+1, 1, CC129))))",
    "FG129": "IF(EJ129=\"\",\"\",(EJ129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD129))",
    "FH129": "IF(EK129=\"\",\"\",(EK129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE129))",
    "FI129": "IF(EL129=\"\",\"\",(EL129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF129))",
    "FJ129": "IF(EM129=\"\", \"\", LET(\n  Now, CW129,\n  Next, EM129,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG129),\nFactor/Cost))",
    "FK129": "IF(EN129=\"\",\"\",(EN129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH129))",
    "FL129": "IF(EO129=\"\", \"\", LET(\n  Now, CS129,\n  Next, EO129,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI129),\nFactor/Cost))",
    "FM129": "IF(EP129=\"\",\"\",(EP129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ129))",
    "FN129": "IF(EQ129=\"\",\"\",(EQ129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK129))",
    "FO129": "IF(ER129=\"\",\"\",(ER129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL129))",
    "FP129": "IF(ES129=\"\",\"\",(ES129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM129))",
    "FQ129": "IF(ET129=\"\",\"\",(ET129/$DX129-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN129))",
    "FR129": "IF(EU129=\"\", \"\", LET(\n  Now, CX129,\n  Next, EU129,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO129),\nFactor/Cost))",
    "FT129": "IF(COLUMN(EW129:FR129) = MIN(IF(EW129:FR129=MAX(EW129:FR129), COLUMN(EW129:FR129))), 1, \"\")",
    "D130": "IF(SUM(FT129:GP129),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F130)),\"Card Mastery\",F130),G130)/$D$5,\"\")",
    "F130": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT129:GP129),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT129:GP129=1)),)\"),\"Damage / Meter\")",
    "G130": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT129:GP129),ARRAYFORMULA(FILTER(BT129:CP129 , FT129:GP129=1)),\"\"\"\")\"),22.0)",
    "I130": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT129:GP129),ARRAYFORMULA(FILTER(EW129:FS129 , FT129:GP129=1))*D$5,\"\"\"\")\"),0.0052194874796193174)",
    "K130": "IF(H130<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D130)),)",
    "BT130": "BT129+FT129",
    "BU130": "BU129+FU129",
    "BV130": "BV129+FV129",
    "BW130": "BW129+FW129",
    "BX130": "BX129+FX129",
    "BY130": "BY129+FY129",
    "BZ130": "BZ129+FZ129",
    "CA130": "CA129+GA129",
    "CB130": "CB129+GB129",
    "CC130": "CC129+GC129",
    "CD130": "CD129+GD129",
    "CE130": "CE129+GE129",
    "CF130": "CF129+GF129",
    "CG130": "CG129+GG129",
    "CH130": "CH129+GH129",
    "CI130": "CI129+GI129",
    "CJ130": "CJ129+GJ129",
    "CK130": "CK129+GK129",
    "CL130": "CL129+GL129",
    "CM130": "CM129+GM129",
    "CN130": "CN129+GN129",
    "CO130": "CO129+GO129",
    "CS130": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI130,1)",
    "CT130": "INDEX($BD$5:$BD275,BT130)",
    "CU130": "INDEX($BN$5:$BN275,CD130)",
    "CV130": "INDEX($BO$5:$BO275,CE130)",
    "CW130": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG130)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX130": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO130, 1)",
    "CY130": "LET(\n  Base, $CR$6,\n  Damage, $CT130,\n  DamageMastery, $CS130,\n  DemonMastery, $CX130,\n  SPB, $CU130,\n  ITO, $CV130,\n  Shock, $CW130,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ130": "MIN(100%, DA130)",
    "DA130": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK130*1%, 0)",
    "DB130": "LET(\n  Lab, 1+INDEX($BF$5:$BF275,BV130),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC130": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK130*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI275,BY130) + CardCritMastery)",
    "DD130": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK130*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ275,BZ130) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE130": "LET(\n  CF, $DB130,\n  CC, $CZ130,\n  SCM, $DD130,\n  SCC, $DC130,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF130": "LET(\n  CF, $DB130,\n  CC, $DA130,\n  SCM, $DD130,\n  SCC, $DC130,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG130": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH130)), 0)",
    "DH130": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ130*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE275,BU130),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI130": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG275, BW130), 1) + $AE$9)",
    "DJ130": "LET(\n  DpmLab, INDEX($BH$5:$BH275,BX130),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL130, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK130": "(1+$DI130*$DJ130*$AQ$9)",
    "DL130": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK275,CA130),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM130*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM130": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK275,CA130),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM130*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN130": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL275,CB130)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO130": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH130,\n  Rapid, DG130,\n  RDPM, DK130,\n  SuperTower, $DL130,\n  Rend, $DN130,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP130": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ130": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK130),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR130": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP130),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF130-1))",
    "DS130": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG130, DH130),0))",
    "DT130": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP130),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV130, $AR$29), 0))",
    "DU130": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK130),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM275,CC130), $DV130, $AR$29), 0))",
    "DV130": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH130), $AO$29)",
    "DW130": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM130,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130, $DB130), 1),\n\n  DW, $DR130,\n  CL, $DS130,\n  SM, $DT130,\n  SLM, $DU130,\n  SL, $DQ130,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX130": "CY130*(DE130*DO130*DQ130+DW130*DF130)",
    "DZ130": "IF(INDEX($BD$6:$BD275,BT130)=\"\", \"\", INDEX($BD$5:$BD275,BT130+1))",
    "EA130": "IF(OR($AO$25, INDEX($BE$6:$BE275,BU130)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ130)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE275,BU130+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI130*$DJ130*$AQ$9),\n  SuperTower, $DL130,\n  Rend, $DN130,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130, $DB130), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR130,\n  SM, $DT130,\n  SLM, $DU130,\n  SL, $DQ130,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM130, UltCritCard),\n\nCY130*(DE130*OtherDamage*SL+UwDamage*DF130)))",
    "EB130": "IF(INDEX($BF$6:$BF275,BV130)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF275,BV130+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ130,\n  CCUW, $DA130,\n  SCM, $DD130,\n  SCC, $DC130,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130, CF), 1),\n\n  DW, $DR130,\n  CL, $DS130,\n  SM, $DT130,\n  SLM, $DU130,\n  SL, $DQ130,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM130, UltCritCard),\n\nCY130 * (Critical * DO130 * SL + UwDamage * UWCritical)))",
    "EC130": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG275,BW130)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH130,\n  Rapid, DG130,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG275, BW130+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ130*$AQ$9),\n  SuperTower, $DL130,\n  Rend, $DN130,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM275,CC130), $DV130, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM130,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130, $DB130), 1),\n\n  DW, $DR130,\n  CL, $DS130,\n  SM, $DT130,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY130*(DE130*OtherDamage*SL+UWDamage*DF130)))",
    "ED130": "IF(OR($AO$25, INDEX($BH$6:$BH275,BX130)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH275,BX130+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL130, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI130*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM275,CC130), $DV130, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH130,\n  Rapid, DG130,\n  SuperTower, $DL130,\n  Rend, $DN130,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM130,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130, $DB130), 1),\n\n  DW, $DR130,\n  CL, $DS130,\n  SM, $DT130,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY130*(DE130*OtherDamage*SL+UWDamage*DF130)))",
    "EE130": "IF(INDEX($BI$6:$BI275,BY130)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK130, 0),\n  CF, $DB130,\n  CC, $CZ130,\n  CCUW, $DA130,\n  SCM, $DD130,\n  SCC, $AV$17+INDEX($BI$5:$BI275,BY130+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY130 * (Critical*DO130*$DQ130+DW130*UWCritical)))",
    "EF130": "IF(INDEX($BJ$6:$BJ275,BZ130)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK130*1%, 1),\n  CF, $DB130,\n  CC, $CZ130,\n  CCUW, $DA130,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ275,BZ130+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC130,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY130*(Critical*DO130*$DQ130+DW130*UWCritical)))",
    "EG130": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK275,CA130)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH130,\n  Rapid, DG130,\n  DPM, (1+$DI130*$DJ130*$AQ$9),\n  Rend, $DN130,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK275,CA130+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM130*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130, $DB130), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK275,CA130+1)-1))/(45-CM130*3),1),\n\n  SL, $DQ130,\n  DW, $DR130,\n  CL, $DS130,\n  SM, $DT130,\n  SLM, $DU130,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY130*(DE130*OtherDamage*SL+UwDamage*DF130)))",
    "EH130": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL275,CB130+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL275,CB130)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH130,\n  Rapid, DG130,\n  DPM, (1+$DI130*$DJ130*$AQ$9),\n  SuperTower, $DL130,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL275,CB130+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY130*(DE130*OtherDamage*$DQ130+DW130*DF130)))",
    "EI130": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM275,CC130)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130, $DB130), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK130),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV130, $AR$29), 0),\n\n  DW, $DR130,\n  CL, $DS130,\n  SM, $DT130,\n  SL, $DQ130,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM130, UltCritCard),\nCY130*(DE130*DO130*SL+UwDamage*DF130)))",
    "EJ130": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN275,CD130)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT130,\n  DamageMastery, $CS130,\n  DemonMastery, $CX130,\n  SPB, INDEX($BN$5:$BN275,CD130+1),\n  ITO, $CV130,\n  Shock, $CW130,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE130*DO130*$DQ130+DW130*DF130)))",
    "EK130": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO275,CE130)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT130,\n  DamageMastery, $CS130,\n  DemonMastery, $CX130,\n  SPB, $CU130,\n  ITO, INDEX($BO$5:$BO275,CE130+1),\n  Shock, $CW130,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE130*DO130*$DQ130+DW130*DF130)))",
    "EL130": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP275,CF130)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130, $DB130), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP130),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF130),\n  CL, $DS130,\n  SM, $DT130,\n  SLM, $DU130,\n  SL, $DQ130,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM130, UltCritCard),\nCY130*(DE130*DO130*SL+UwDamage*DF130)))",
    "EM130": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ275,CG130)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG130+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN130": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR275,CH130)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130, $DB130), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH130+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP130),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK130),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM275,CC130), SMHeat, $AR$29), 0),\n\n  DW, $DR130,\n  CL, $DS130,\n  SL, $DQ130,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM130, UltCritCard),\nCY130*(DE130*DO130*SL+UwDamage*DF130)))",
    "EO130": "IF(OR(CI130 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI130+1))",
    "EP130": "IF(OR($AO$25, CJ130 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ130+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE274,BU130),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL130, 1),\n  DPM, (1+$DI130*CardRangeMastery*$DJ130*$AQ$9),\n  SuperTower, $DL130,\n  Rend, $DN130,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130, $DB130), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR130,\n  SM, $DT130,\n  SLM, $DU130,\n  SL, $DQ130,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM130, UltCritCard),\n\nCY130*(DE130*OtherDamage*SL+UwDamage*DF130)))",
    "EQ130": "IF(OR(CK130 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK130+1)*1%, 1),\n  CF, $DB130,\n  CC, MIN(100%, $CZ130 + 1%),\n  CCUW, DA130 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ275,BZ130) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC130 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR130,\n  CL, $DS130,\n  SM, $DT130,\n  SLM, $DU130,\n  SL, $DQ130,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM130, UltCritCard),\n\nCY130 * (Critical*DO130*SL+UwDamage*UWCritical)))",
    "ER130": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL130 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH275,BX130),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL130+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI130*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM275,CC130), $DV130, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH130,\n  Rapid, DG130,\n  SuperTower, $DL130,\n  Rend, $DN130,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM130,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130, $DB130), 1),\n\n  DW, $DR130,\n  CL, $DS130,\n  SM, $DT130,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY130*(DE130*OtherDamage*SL+UWDamage*DF130)))",
    "ES130": "IF(OR(CM130 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH130,\n  Rapid, DG130,\n  RDPM, (1+$DI130*$DJ130*$AQ$9),\n  Rend, $DN130,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK275,CA130),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM130+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130, $DB130), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR130,\n  CL, $DS130,\n  SM, $DT130,\n  SLM, $DU130,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY130*(DE130*OtherDamage*SL+UwDamage*DF130)))",
    "ET130": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN130 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM130,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN130+1, $DB130), 1),\n\n  DW, $DR130,\n  CL, $DS130,\n  SM, $DT130,\n  SLM, $DU130,\n  SL, $DQ130,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY130*(DE130*DO130*SL+UWDamage*DF130)))",
    "EU130": "IF(OR(NOT($BA$3), NOT($BA$23), $CO130 > $BA$15), \"\", 1 + 0.5*(CO130+1))",
    "EW130": "IF(DZ130=\"\", \"\", LET(\n  Now, CT130,\n  Next, DZ130,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT130),\nFactor/Cost))",
    "EX130": "IF(EA130=\"\",\"\",(EA130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU130))",
    "EY130": "IF(EB130=\"\",\"\",(EB130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV130))",
    "EZ130": "IF(EC130=\"\",\"\",(EC130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW130))",
    "FA130": "IF(ED130=\"\",\"\",(ED130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX130))",
    "FB130": "IF(EE130=\"\",\"\",(EE130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY130))",
    "FC130": "IF(EF130=\"\",\"\",(EF130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ130))",
    "FD130": "IF(EG130=\"\",\"\",(EG130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA130))",
    "FE130": "IF(EH130=\"\",\"\",(EH130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB130))",
    "FF130": "IF(EI130=\"\",\"\",(EI130/$DX130-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC130+1, 1, CC130))))",
    "FG130": "IF(EJ130=\"\",\"\",(EJ130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD130))",
    "FH130": "IF(EK130=\"\",\"\",(EK130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE130))",
    "FI130": "IF(EL130=\"\",\"\",(EL130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF130))",
    "FJ130": "IF(EM130=\"\", \"\", LET(\n  Now, CW130,\n  Next, EM130,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG130),\nFactor/Cost))",
    "FK130": "IF(EN130=\"\",\"\",(EN130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH130))",
    "FL130": "IF(EO130=\"\", \"\", LET(\n  Now, CS130,\n  Next, EO130,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI130),\nFactor/Cost))",
    "FM130": "IF(EP130=\"\",\"\",(EP130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ130))",
    "FN130": "IF(EQ130=\"\",\"\",(EQ130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK130))",
    "FO130": "IF(ER130=\"\",\"\",(ER130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL130))",
    "FP130": "IF(ES130=\"\",\"\",(ES130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM130))",
    "FQ130": "IF(ET130=\"\",\"\",(ET130/$DX130-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN130))",
    "FR130": "IF(EU130=\"\", \"\", LET(\n  Now, CX130,\n  Next, EU130,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO130),\nFactor/Cost))",
    "FT130": "IF(COLUMN(EW130:FR130) = MIN(IF(EW130:FR130=MAX(EW130:FR130), COLUMN(EW130:FR130))), 1, \"\")",
    "D131": "IF(SUM(FT130:GP130),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F131)),\"Card Mastery\",F131),G131)/$D$5,\"\")",
    "F131": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT130:GP130),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT130:GP130=1)),)\"),\"Damage\")",
    "G131": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT130:GP130),ARRAYFORMULA(FILTER(BT130:CP130 , FT130:GP130=1)),\"\"\"\")\"),29.0)",
    "I131": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT130:GP130),ARRAYFORMULA(FILTER(EW130:FS130 , FT130:GP130=1))*D$5,\"\"\"\")\"),0.00511683438512705)",
    "K131": "IF(H131<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D131)),)",
    "BT131": "BT130+FT130",
    "BU131": "BU130+FU130",
    "BV131": "BV130+FV130",
    "BW131": "BW130+FW130",
    "BX131": "BX130+FX130",
    "BY131": "BY130+FY130",
    "BZ131": "BZ130+FZ130",
    "CA131": "CA130+GA130",
    "CB131": "CB130+GB130",
    "CC131": "CC130+GC130",
    "CD131": "CD130+GD130",
    "CE131": "CE130+GE130",
    "CF131": "CF130+GF130",
    "CG131": "CG130+GG130",
    "CH131": "CH130+GH130",
    "CI131": "CI130+GI130",
    "CJ131": "CJ130+GJ130",
    "CK131": "CK130+GK130",
    "CL131": "CL130+GL130",
    "CM131": "CM130+GM130",
    "CN131": "CN130+GN130",
    "CO131": "CO130+GO130",
    "CS131": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI131,1)",
    "CT131": "INDEX($BD$5:$BD276,BT131)",
    "CU131": "INDEX($BN$5:$BN276,CD131)",
    "CV131": "INDEX($BO$5:$BO276,CE131)",
    "CW131": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG131)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX131": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO131, 1)",
    "CY131": "LET(\n  Base, $CR$6,\n  Damage, $CT131,\n  DamageMastery, $CS131,\n  DemonMastery, $CX131,\n  SPB, $CU131,\n  ITO, $CV131,\n  Shock, $CW131,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ131": "MIN(100%, DA131)",
    "DA131": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK131*1%, 0)",
    "DB131": "LET(\n  Lab, 1+INDEX($BF$5:$BF276,BV131),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC131": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK131*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI276,BY131) + CardCritMastery)",
    "DD131": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK131*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ276,BZ131) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE131": "LET(\n  CF, $DB131,\n  CC, $CZ131,\n  SCM, $DD131,\n  SCC, $DC131,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF131": "LET(\n  CF, $DB131,\n  CC, $DA131,\n  SCM, $DD131,\n  SCC, $DC131,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG131": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH131)), 0)",
    "DH131": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ131*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE276,BU131),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI131": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG276, BW131), 1) + $AE$9)",
    "DJ131": "LET(\n  DpmLab, INDEX($BH$5:$BH276,BX131),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL131, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK131": "(1+$DI131*$DJ131*$AQ$9)",
    "DL131": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK276,CA131),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM131*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM131": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK276,CA131),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM131*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN131": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL276,CB131)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO131": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH131,\n  Rapid, DG131,\n  RDPM, DK131,\n  SuperTower, $DL131,\n  Rend, $DN131,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP131": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ131": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK131),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR131": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP131),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF131-1))",
    "DS131": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG131, DH131),0))",
    "DT131": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP131),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV131, $AR$29), 0))",
    "DU131": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK131),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM276,CC131), $DV131, $AR$29), 0))",
    "DV131": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH131), $AO$29)",
    "DW131": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM131,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131, $DB131), 1),\n\n  DW, $DR131,\n  CL, $DS131,\n  SM, $DT131,\n  SLM, $DU131,\n  SL, $DQ131,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX131": "CY131*(DE131*DO131*DQ131+DW131*DF131)",
    "DZ131": "IF(INDEX($BD$6:$BD276,BT131)=\"\", \"\", INDEX($BD$5:$BD276,BT131+1))",
    "EA131": "IF(OR($AO$25, INDEX($BE$6:$BE276,BU131)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ131)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE276,BU131+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI131*$DJ131*$AQ$9),\n  SuperTower, $DL131,\n  Rend, $DN131,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131, $DB131), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR131,\n  SM, $DT131,\n  SLM, $DU131,\n  SL, $DQ131,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM131, UltCritCard),\n\nCY131*(DE131*OtherDamage*SL+UwDamage*DF131)))",
    "EB131": "IF(INDEX($BF$6:$BF276,BV131)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF276,BV131+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ131,\n  CCUW, $DA131,\n  SCM, $DD131,\n  SCC, $DC131,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131, CF), 1),\n\n  DW, $DR131,\n  CL, $DS131,\n  SM, $DT131,\n  SLM, $DU131,\n  SL, $DQ131,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM131, UltCritCard),\n\nCY131 * (Critical * DO131 * SL + UwDamage * UWCritical)))",
    "EC131": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG276,BW131)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH131,\n  Rapid, DG131,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG276, BW131+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ131*$AQ$9),\n  SuperTower, $DL131,\n  Rend, $DN131,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM276,CC131), $DV131, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM131,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131, $DB131), 1),\n\n  DW, $DR131,\n  CL, $DS131,\n  SM, $DT131,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY131*(DE131*OtherDamage*SL+UWDamage*DF131)))",
    "ED131": "IF(OR($AO$25, INDEX($BH$6:$BH276,BX131)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH276,BX131+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL131, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI131*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM276,CC131), $DV131, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH131,\n  Rapid, DG131,\n  SuperTower, $DL131,\n  Rend, $DN131,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM131,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131, $DB131), 1),\n\n  DW, $DR131,\n  CL, $DS131,\n  SM, $DT131,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY131*(DE131*OtherDamage*SL+UWDamage*DF131)))",
    "EE131": "IF(INDEX($BI$6:$BI276,BY131)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK131, 0),\n  CF, $DB131,\n  CC, $CZ131,\n  CCUW, $DA131,\n  SCM, $DD131,\n  SCC, $AV$17+INDEX($BI$5:$BI276,BY131+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY131 * (Critical*DO131*$DQ131+DW131*UWCritical)))",
    "EF131": "IF(INDEX($BJ$6:$BJ276,BZ131)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK131*1%, 1),\n  CF, $DB131,\n  CC, $CZ131,\n  CCUW, $DA131,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ276,BZ131+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC131,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY131*(Critical*DO131*$DQ131+DW131*UWCritical)))",
    "EG131": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK276,CA131)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH131,\n  Rapid, DG131,\n  DPM, (1+$DI131*$DJ131*$AQ$9),\n  Rend, $DN131,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK276,CA131+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM131*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131, $DB131), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK276,CA131+1)-1))/(45-CM131*3),1),\n\n  SL, $DQ131,\n  DW, $DR131,\n  CL, $DS131,\n  SM, $DT131,\n  SLM, $DU131,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY131*(DE131*OtherDamage*SL+UwDamage*DF131)))",
    "EH131": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL276,CB131+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL276,CB131)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH131,\n  Rapid, DG131,\n  DPM, (1+$DI131*$DJ131*$AQ$9),\n  SuperTower, $DL131,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL276,CB131+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY131*(DE131*OtherDamage*$DQ131+DW131*DF131)))",
    "EI131": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM276,CC131)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131, $DB131), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK131),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV131, $AR$29), 0),\n\n  DW, $DR131,\n  CL, $DS131,\n  SM, $DT131,\n  SL, $DQ131,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM131, UltCritCard),\nCY131*(DE131*DO131*SL+UwDamage*DF131)))",
    "EJ131": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN276,CD131)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT131,\n  DamageMastery, $CS131,\n  DemonMastery, $CX131,\n  SPB, INDEX($BN$5:$BN276,CD131+1),\n  ITO, $CV131,\n  Shock, $CW131,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE131*DO131*$DQ131+DW131*DF131)))",
    "EK131": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO276,CE131)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT131,\n  DamageMastery, $CS131,\n  DemonMastery, $CX131,\n  SPB, $CU131,\n  ITO, INDEX($BO$5:$BO276,CE131+1),\n  Shock, $CW131,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE131*DO131*$DQ131+DW131*DF131)))",
    "EL131": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP276,CF131)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131, $DB131), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP131),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF131),\n  CL, $DS131,\n  SM, $DT131,\n  SLM, $DU131,\n  SL, $DQ131,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM131, UltCritCard),\nCY131*(DE131*DO131*SL+UwDamage*DF131)))",
    "EM131": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ276,CG131)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG131+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN131": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR276,CH131)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131, $DB131), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH131+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP131),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK131),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM276,CC131), SMHeat, $AR$29), 0),\n\n  DW, $DR131,\n  CL, $DS131,\n  SL, $DQ131,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM131, UltCritCard),\nCY131*(DE131*DO131*SL+UwDamage*DF131)))",
    "EO131": "IF(OR(CI131 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI131+1))",
    "EP131": "IF(OR($AO$25, CJ131 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ131+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE275,BU131),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL131, 1),\n  DPM, (1+$DI131*CardRangeMastery*$DJ131*$AQ$9),\n  SuperTower, $DL131,\n  Rend, $DN131,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131, $DB131), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR131,\n  SM, $DT131,\n  SLM, $DU131,\n  SL, $DQ131,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM131, UltCritCard),\n\nCY131*(DE131*OtherDamage*SL+UwDamage*DF131)))",
    "EQ131": "IF(OR(CK131 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK131+1)*1%, 1),\n  CF, $DB131,\n  CC, MIN(100%, $CZ131 + 1%),\n  CCUW, DA131 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ276,BZ131) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC131 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR131,\n  CL, $DS131,\n  SM, $DT131,\n  SLM, $DU131,\n  SL, $DQ131,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM131, UltCritCard),\n\nCY131 * (Critical*DO131*SL+UwDamage*UWCritical)))",
    "ER131": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL131 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH276,BX131),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL131+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI131*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM276,CC131), $DV131, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH131,\n  Rapid, DG131,\n  SuperTower, $DL131,\n  Rend, $DN131,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM131,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131, $DB131), 1),\n\n  DW, $DR131,\n  CL, $DS131,\n  SM, $DT131,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY131*(DE131*OtherDamage*SL+UWDamage*DF131)))",
    "ES131": "IF(OR(CM131 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH131,\n  Rapid, DG131,\n  RDPM, (1+$DI131*$DJ131*$AQ$9),\n  Rend, $DN131,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK276,CA131),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM131+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131, $DB131), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR131,\n  CL, $DS131,\n  SM, $DT131,\n  SLM, $DU131,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY131*(DE131*OtherDamage*SL+UwDamage*DF131)))",
    "ET131": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN131 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM131,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN131+1, $DB131), 1),\n\n  DW, $DR131,\n  CL, $DS131,\n  SM, $DT131,\n  SLM, $DU131,\n  SL, $DQ131,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY131*(DE131*DO131*SL+UWDamage*DF131)))",
    "EU131": "IF(OR(NOT($BA$3), NOT($BA$23), $CO131 > $BA$15), \"\", 1 + 0.5*(CO131+1))",
    "EW131": "IF(DZ131=\"\", \"\", LET(\n  Now, CT131,\n  Next, DZ131,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT131),\nFactor/Cost))",
    "EX131": "IF(EA131=\"\",\"\",(EA131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU131))",
    "EY131": "IF(EB131=\"\",\"\",(EB131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV131))",
    "EZ131": "IF(EC131=\"\",\"\",(EC131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW131))",
    "FA131": "IF(ED131=\"\",\"\",(ED131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX131))",
    "FB131": "IF(EE131=\"\",\"\",(EE131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY131))",
    "FC131": "IF(EF131=\"\",\"\",(EF131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ131))",
    "FD131": "IF(EG131=\"\",\"\",(EG131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA131))",
    "FE131": "IF(EH131=\"\",\"\",(EH131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB131))",
    "FF131": "IF(EI131=\"\",\"\",(EI131/$DX131-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC131+1, 1, CC131))))",
    "FG131": "IF(EJ131=\"\",\"\",(EJ131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD131))",
    "FH131": "IF(EK131=\"\",\"\",(EK131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE131))",
    "FI131": "IF(EL131=\"\",\"\",(EL131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF131))",
    "FJ131": "IF(EM131=\"\", \"\", LET(\n  Now, CW131,\n  Next, EM131,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG131),\nFactor/Cost))",
    "FK131": "IF(EN131=\"\",\"\",(EN131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH131))",
    "FL131": "IF(EO131=\"\", \"\", LET(\n  Now, CS131,\n  Next, EO131,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI131),\nFactor/Cost))",
    "FM131": "IF(EP131=\"\",\"\",(EP131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ131))",
    "FN131": "IF(EQ131=\"\",\"\",(EQ131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK131))",
    "FO131": "IF(ER131=\"\",\"\",(ER131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL131))",
    "FP131": "IF(ES131=\"\",\"\",(ES131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM131))",
    "FQ131": "IF(ET131=\"\",\"\",(ET131/$DX131-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN131))",
    "FR131": "IF(EU131=\"\", \"\", LET(\n  Now, CX131,\n  Next, EU131,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO131),\nFactor/Cost))",
    "FT131": "IF(COLUMN(EW131:FR131) = MIN(IF(EW131:FR131=MAX(EW131:FR131), COLUMN(EW131:FR131))), 1, \"\")",
    "D132": "IF(SUM(FT131:GP131),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F132)),\"Card Mastery\",F132),G132)/$D$5,\"\")",
    "F132": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT131:GP131),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT131:GP131=1)),)\"),\"Attack Speed\")",
    "G132": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT131:GP131),ARRAYFORMULA(FILTER(BT131:CP131 , FT131:GP131=1)),\"\"\"\")\"),29.0)",
    "I132": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT131:GP131),ARRAYFORMULA(FILTER(EW131:FS131 , FT131:GP131=1))*D$5,\"\"\"\")\"),0.005014232323581183)",
    "K132": "IF(H132<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D132)),)",
    "BT132": "BT131+FT131",
    "BU132": "BU131+FU131",
    "BV132": "BV131+FV131",
    "BW132": "BW131+FW131",
    "BX132": "BX131+FX131",
    "BY132": "BY131+FY131",
    "BZ132": "BZ131+FZ131",
    "CA132": "CA131+GA131",
    "CB132": "CB131+GB131",
    "CC132": "CC131+GC131",
    "CD132": "CD131+GD131",
    "CE132": "CE131+GE131",
    "CF132": "CF131+GF131",
    "CG132": "CG131+GG131",
    "CH132": "CH131+GH131",
    "CI132": "CI131+GI131",
    "CJ132": "CJ131+GJ131",
    "CK132": "CK131+GK131",
    "CL132": "CL131+GL131",
    "CM132": "CM131+GM131",
    "CN132": "CN131+GN131",
    "CO132": "CO131+GO131",
    "CS132": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI132,1)",
    "CT132": "INDEX($BD$5:$BD277,BT132)",
    "CU132": "INDEX($BN$5:$BN277,CD132)",
    "CV132": "INDEX($BO$5:$BO277,CE132)",
    "CW132": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG132)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX132": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO132, 1)",
    "CY132": "LET(\n  Base, $CR$6,\n  Damage, $CT132,\n  DamageMastery, $CS132,\n  DemonMastery, $CX132,\n  SPB, $CU132,\n  ITO, $CV132,\n  Shock, $CW132,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ132": "MIN(100%, DA132)",
    "DA132": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK132*1%, 0)",
    "DB132": "LET(\n  Lab, 1+INDEX($BF$5:$BF277,BV132),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC132": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK132*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI277,BY132) + CardCritMastery)",
    "DD132": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK132*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ277,BZ132) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE132": "LET(\n  CF, $DB132,\n  CC, $CZ132,\n  SCM, $DD132,\n  SCC, $DC132,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF132": "LET(\n  CF, $DB132,\n  CC, $DA132,\n  SCM, $DD132,\n  SCC, $DC132,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG132": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH132)), 0)",
    "DH132": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ132*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE277,BU132),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI132": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG277, BW132), 1) + $AE$9)",
    "DJ132": "LET(\n  DpmLab, INDEX($BH$5:$BH277,BX132),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL132, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK132": "(1+$DI132*$DJ132*$AQ$9)",
    "DL132": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK277,CA132),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM132*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM132": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK277,CA132),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM132*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN132": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL277,CB132)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO132": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH132,\n  Rapid, DG132,\n  RDPM, DK132,\n  SuperTower, $DL132,\n  Rend, $DN132,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP132": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ132": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK132),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR132": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP132),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF132-1))",
    "DS132": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG132, DH132),0))",
    "DT132": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP132),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV132, $AR$29), 0))",
    "DU132": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK132),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM277,CC132), $DV132, $AR$29), 0))",
    "DV132": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH132), $AO$29)",
    "DW132": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM132,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132, $DB132), 1),\n\n  DW, $DR132,\n  CL, $DS132,\n  SM, $DT132,\n  SLM, $DU132,\n  SL, $DQ132,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX132": "CY132*(DE132*DO132*DQ132+DW132*DF132)",
    "DZ132": "IF(INDEX($BD$6:$BD277,BT132)=\"\", \"\", INDEX($BD$5:$BD277,BT132+1))",
    "EA132": "IF(OR($AO$25, INDEX($BE$6:$BE277,BU132)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ132)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE277,BU132+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI132*$DJ132*$AQ$9),\n  SuperTower, $DL132,\n  Rend, $DN132,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132, $DB132), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR132,\n  SM, $DT132,\n  SLM, $DU132,\n  SL, $DQ132,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM132, UltCritCard),\n\nCY132*(DE132*OtherDamage*SL+UwDamage*DF132)))",
    "EB132": "IF(INDEX($BF$6:$BF277,BV132)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF277,BV132+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ132,\n  CCUW, $DA132,\n  SCM, $DD132,\n  SCC, $DC132,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132, CF), 1),\n\n  DW, $DR132,\n  CL, $DS132,\n  SM, $DT132,\n  SLM, $DU132,\n  SL, $DQ132,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM132, UltCritCard),\n\nCY132 * (Critical * DO132 * SL + UwDamage * UWCritical)))",
    "EC132": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG277,BW132)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH132,\n  Rapid, DG132,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG277, BW132+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ132*$AQ$9),\n  SuperTower, $DL132,\n  Rend, $DN132,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM277,CC132), $DV132, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM132,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132, $DB132), 1),\n\n  DW, $DR132,\n  CL, $DS132,\n  SM, $DT132,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY132*(DE132*OtherDamage*SL+UWDamage*DF132)))",
    "ED132": "IF(OR($AO$25, INDEX($BH$6:$BH277,BX132)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH277,BX132+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL132, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI132*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM277,CC132), $DV132, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH132,\n  Rapid, DG132,\n  SuperTower, $DL132,\n  Rend, $DN132,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM132,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132, $DB132), 1),\n\n  DW, $DR132,\n  CL, $DS132,\n  SM, $DT132,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY132*(DE132*OtherDamage*SL+UWDamage*DF132)))",
    "EE132": "IF(INDEX($BI$6:$BI277,BY132)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK132, 0),\n  CF, $DB132,\n  CC, $CZ132,\n  CCUW, $DA132,\n  SCM, $DD132,\n  SCC, $AV$17+INDEX($BI$5:$BI277,BY132+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY132 * (Critical*DO132*$DQ132+DW132*UWCritical)))",
    "EF132": "IF(INDEX($BJ$6:$BJ277,BZ132)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK132*1%, 1),\n  CF, $DB132,\n  CC, $CZ132,\n  CCUW, $DA132,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ277,BZ132+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC132,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY132*(Critical*DO132*$DQ132+DW132*UWCritical)))",
    "EG132": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK277,CA132)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH132,\n  Rapid, DG132,\n  DPM, (1+$DI132*$DJ132*$AQ$9),\n  Rend, $DN132,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK277,CA132+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM132*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132, $DB132), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK277,CA132+1)-1))/(45-CM132*3),1),\n\n  SL, $DQ132,\n  DW, $DR132,\n  CL, $DS132,\n  SM, $DT132,\n  SLM, $DU132,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY132*(DE132*OtherDamage*SL+UwDamage*DF132)))",
    "EH132": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL277,CB132+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL277,CB132)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH132,\n  Rapid, DG132,\n  DPM, (1+$DI132*$DJ132*$AQ$9),\n  SuperTower, $DL132,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL277,CB132+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY132*(DE132*OtherDamage*$DQ132+DW132*DF132)))",
    "EI132": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM277,CC132)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132, $DB132), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK132),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV132, $AR$29), 0),\n\n  DW, $DR132,\n  CL, $DS132,\n  SM, $DT132,\n  SL, $DQ132,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM132, UltCritCard),\nCY132*(DE132*DO132*SL+UwDamage*DF132)))",
    "EJ132": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN277,CD132)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT132,\n  DamageMastery, $CS132,\n  DemonMastery, $CX132,\n  SPB, INDEX($BN$5:$BN277,CD132+1),\n  ITO, $CV132,\n  Shock, $CW132,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE132*DO132*$DQ132+DW132*DF132)))",
    "EK132": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO277,CE132)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT132,\n  DamageMastery, $CS132,\n  DemonMastery, $CX132,\n  SPB, $CU132,\n  ITO, INDEX($BO$5:$BO277,CE132+1),\n  Shock, $CW132,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE132*DO132*$DQ132+DW132*DF132)))",
    "EL132": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP277,CF132)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132, $DB132), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP132),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF132),\n  CL, $DS132,\n  SM, $DT132,\n  SLM, $DU132,\n  SL, $DQ132,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM132, UltCritCard),\nCY132*(DE132*DO132*SL+UwDamage*DF132)))",
    "EM132": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ277,CG132)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG132+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN132": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR277,CH132)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132, $DB132), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH132+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP132),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK132),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM277,CC132), SMHeat, $AR$29), 0),\n\n  DW, $DR132,\n  CL, $DS132,\n  SL, $DQ132,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM132, UltCritCard),\nCY132*(DE132*DO132*SL+UwDamage*DF132)))",
    "EO132": "IF(OR(CI132 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI132+1))",
    "EP132": "IF(OR($AO$25, CJ132 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ132+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE276,BU132),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL132, 1),\n  DPM, (1+$DI132*CardRangeMastery*$DJ132*$AQ$9),\n  SuperTower, $DL132,\n  Rend, $DN132,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132, $DB132), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR132,\n  SM, $DT132,\n  SLM, $DU132,\n  SL, $DQ132,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM132, UltCritCard),\n\nCY132*(DE132*OtherDamage*SL+UwDamage*DF132)))",
    "EQ132": "IF(OR(CK132 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK132+1)*1%, 1),\n  CF, $DB132,\n  CC, MIN(100%, $CZ132 + 1%),\n  CCUW, DA132 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ277,BZ132) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC132 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR132,\n  CL, $DS132,\n  SM, $DT132,\n  SLM, $DU132,\n  SL, $DQ132,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM132, UltCritCard),\n\nCY132 * (Critical*DO132*SL+UwDamage*UWCritical)))",
    "ER132": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL132 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH277,BX132),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL132+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI132*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM277,CC132), $DV132, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH132,\n  Rapid, DG132,\n  SuperTower, $DL132,\n  Rend, $DN132,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM132,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132, $DB132), 1),\n\n  DW, $DR132,\n  CL, $DS132,\n  SM, $DT132,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY132*(DE132*OtherDamage*SL+UWDamage*DF132)))",
    "ES132": "IF(OR(CM132 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH132,\n  Rapid, DG132,\n  RDPM, (1+$DI132*$DJ132*$AQ$9),\n  Rend, $DN132,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK277,CA132),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM132+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132, $DB132), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR132,\n  CL, $DS132,\n  SM, $DT132,\n  SLM, $DU132,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY132*(DE132*OtherDamage*SL+UwDamage*DF132)))",
    "ET132": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN132 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM132,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN132+1, $DB132), 1),\n\n  DW, $DR132,\n  CL, $DS132,\n  SM, $DT132,\n  SLM, $DU132,\n  SL, $DQ132,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY132*(DE132*DO132*SL+UWDamage*DF132)))",
    "EU132": "IF(OR(NOT($BA$3), NOT($BA$23), $CO132 > $BA$15), \"\", 1 + 0.5*(CO132+1))",
    "EW132": "IF(DZ132=\"\", \"\", LET(\n  Now, CT132,\n  Next, DZ132,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT132),\nFactor/Cost))",
    "EX132": "IF(EA132=\"\",\"\",(EA132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU132))",
    "EY132": "IF(EB132=\"\",\"\",(EB132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV132))",
    "EZ132": "IF(EC132=\"\",\"\",(EC132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW132))",
    "FA132": "IF(ED132=\"\",\"\",(ED132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX132))",
    "FB132": "IF(EE132=\"\",\"\",(EE132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY132))",
    "FC132": "IF(EF132=\"\",\"\",(EF132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ132))",
    "FD132": "IF(EG132=\"\",\"\",(EG132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA132))",
    "FE132": "IF(EH132=\"\",\"\",(EH132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB132))",
    "FF132": "IF(EI132=\"\",\"\",(EI132/$DX132-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC132+1, 1, CC132))))",
    "FG132": "IF(EJ132=\"\",\"\",(EJ132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD132))",
    "FH132": "IF(EK132=\"\",\"\",(EK132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE132))",
    "FI132": "IF(EL132=\"\",\"\",(EL132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF132))",
    "FJ132": "IF(EM132=\"\", \"\", LET(\n  Now, CW132,\n  Next, EM132,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG132),\nFactor/Cost))",
    "FK132": "IF(EN132=\"\",\"\",(EN132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH132))",
    "FL132": "IF(EO132=\"\", \"\", LET(\n  Now, CS132,\n  Next, EO132,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI132),\nFactor/Cost))",
    "FM132": "IF(EP132=\"\",\"\",(EP132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ132))",
    "FN132": "IF(EQ132=\"\",\"\",(EQ132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK132))",
    "FO132": "IF(ER132=\"\",\"\",(ER132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL132))",
    "FP132": "IF(ES132=\"\",\"\",(ES132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM132))",
    "FQ132": "IF(ET132=\"\",\"\",(ET132/$DX132-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN132))",
    "FR132": "IF(EU132=\"\", \"\", LET(\n  Now, CX132,\n  Next, EU132,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO132),\nFactor/Cost))",
    "FT132": "IF(COLUMN(EW132:FR132) = MIN(IF(EW132:FR132=MAX(EW132:FR132), COLUMN(EW132:FR132))), 1, \"\")",
    "D133": "IF(SUM(FT132:GP132),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F133)),\"Card Mastery\",F133),G133)/$D$5,\"\")",
    "F133": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT132:GP132),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT132:GP132=1)),)\"),\"Super Tower Bonus\")",
    "G133": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT132:GP132),ARRAYFORMULA(FILTER(BT132:CP132 , FT132:GP132=1)),\"\"\"\")\"),7.0)",
    "I133": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT132:GP132),ARRAYFORMULA(FILTER(EW132:FS132 , FT132:GP132=1))*D$5,\"\"\"\")\"),0.004977788479538623)",
    "K133": "IF(H133<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D133)),)",
    "BT133": "BT132+FT132",
    "BU133": "BU132+FU132",
    "BV133": "BV132+FV132",
    "BW133": "BW132+FW132",
    "BX133": "BX132+FX132",
    "BY133": "BY132+FY132",
    "BZ133": "BZ132+FZ132",
    "CA133": "CA132+GA132",
    "CB133": "CB132+GB132",
    "CC133": "CC132+GC132",
    "CD133": "CD132+GD132",
    "CE133": "CE132+GE132",
    "CF133": "CF132+GF132",
    "CG133": "CG132+GG132",
    "CH133": "CH132+GH132",
    "CI133": "CI132+GI132",
    "CJ133": "CJ132+GJ132",
    "CK133": "CK132+GK132",
    "CL133": "CL132+GL132",
    "CM133": "CM132+GM132",
    "CN133": "CN132+GN132",
    "CO133": "CO132+GO132",
    "CS133": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI133,1)",
    "CT133": "INDEX($BD$5:$BD278,BT133)",
    "CU133": "INDEX($BN$5:$BN278,CD133)",
    "CV133": "INDEX($BO$5:$BO278,CE133)",
    "CW133": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG133)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX133": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO133, 1)",
    "CY133": "LET(\n  Base, $CR$6,\n  Damage, $CT133,\n  DamageMastery, $CS133,\n  DemonMastery, $CX133,\n  SPB, $CU133,\n  ITO, $CV133,\n  Shock, $CW133,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ133": "MIN(100%, DA133)",
    "DA133": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK133*1%, 0)",
    "DB133": "LET(\n  Lab, 1+INDEX($BF$5:$BF278,BV133),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC133": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK133*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI278,BY133) + CardCritMastery)",
    "DD133": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK133*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ278,BZ133) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE133": "LET(\n  CF, $DB133,\n  CC, $CZ133,\n  SCM, $DD133,\n  SCC, $DC133,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF133": "LET(\n  CF, $DB133,\n  CC, $DA133,\n  SCM, $DD133,\n  SCC, $DC133,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG133": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH133)), 0)",
    "DH133": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ133*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE278,BU133),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI133": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG278, BW133), 1) + $AE$9)",
    "DJ133": "LET(\n  DpmLab, INDEX($BH$5:$BH278,BX133),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL133, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK133": "(1+$DI133*$DJ133*$AQ$9)",
    "DL133": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK278,CA133),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM133*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM133": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK278,CA133),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM133*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN133": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL278,CB133)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO133": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH133,\n  Rapid, DG133,\n  RDPM, DK133,\n  SuperTower, $DL133,\n  Rend, $DN133,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP133": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ133": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK133),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR133": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP133),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF133-1))",
    "DS133": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG133, DH133),0))",
    "DT133": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP133),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV133, $AR$29), 0))",
    "DU133": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK133),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM278,CC133), $DV133, $AR$29), 0))",
    "DV133": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH133), $AO$29)",
    "DW133": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM133,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133, $DB133), 1),\n\n  DW, $DR133,\n  CL, $DS133,\n  SM, $DT133,\n  SLM, $DU133,\n  SL, $DQ133,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX133": "CY133*(DE133*DO133*DQ133+DW133*DF133)",
    "DZ133": "IF(INDEX($BD$6:$BD278,BT133)=\"\", \"\", INDEX($BD$5:$BD278,BT133+1))",
    "EA133": "IF(OR($AO$25, INDEX($BE$6:$BE278,BU133)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ133)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE278,BU133+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI133*$DJ133*$AQ$9),\n  SuperTower, $DL133,\n  Rend, $DN133,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133, $DB133), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR133,\n  SM, $DT133,\n  SLM, $DU133,\n  SL, $DQ133,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM133, UltCritCard),\n\nCY133*(DE133*OtherDamage*SL+UwDamage*DF133)))",
    "EB133": "IF(INDEX($BF$6:$BF278,BV133)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF278,BV133+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ133,\n  CCUW, $DA133,\n  SCM, $DD133,\n  SCC, $DC133,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133, CF), 1),\n\n  DW, $DR133,\n  CL, $DS133,\n  SM, $DT133,\n  SLM, $DU133,\n  SL, $DQ133,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM133, UltCritCard),\n\nCY133 * (Critical * DO133 * SL + UwDamage * UWCritical)))",
    "EC133": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG278,BW133)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH133,\n  Rapid, DG133,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG278, BW133+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ133*$AQ$9),\n  SuperTower, $DL133,\n  Rend, $DN133,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM278,CC133), $DV133, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM133,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133, $DB133), 1),\n\n  DW, $DR133,\n  CL, $DS133,\n  SM, $DT133,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY133*(DE133*OtherDamage*SL+UWDamage*DF133)))",
    "ED133": "IF(OR($AO$25, INDEX($BH$6:$BH278,BX133)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH278,BX133+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL133, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI133*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM278,CC133), $DV133, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH133,\n  Rapid, DG133,\n  SuperTower, $DL133,\n  Rend, $DN133,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM133,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133, $DB133), 1),\n\n  DW, $DR133,\n  CL, $DS133,\n  SM, $DT133,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY133*(DE133*OtherDamage*SL+UWDamage*DF133)))",
    "EE133": "IF(INDEX($BI$6:$BI278,BY133)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK133, 0),\n  CF, $DB133,\n  CC, $CZ133,\n  CCUW, $DA133,\n  SCM, $DD133,\n  SCC, $AV$17+INDEX($BI$5:$BI278,BY133+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY133 * (Critical*DO133*$DQ133+DW133*UWCritical)))",
    "EF133": "IF(INDEX($BJ$6:$BJ278,BZ133)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK133*1%, 1),\n  CF, $DB133,\n  CC, $CZ133,\n  CCUW, $DA133,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ278,BZ133+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC133,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY133*(Critical*DO133*$DQ133+DW133*UWCritical)))",
    "EG133": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK278,CA133)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH133,\n  Rapid, DG133,\n  DPM, (1+$DI133*$DJ133*$AQ$9),\n  Rend, $DN133,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK278,CA133+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM133*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133, $DB133), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK278,CA133+1)-1))/(45-CM133*3),1),\n\n  SL, $DQ133,\n  DW, $DR133,\n  CL, $DS133,\n  SM, $DT133,\n  SLM, $DU133,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY133*(DE133*OtherDamage*SL+UwDamage*DF133)))",
    "EH133": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL278,CB133+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL278,CB133)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH133,\n  Rapid, DG133,\n  DPM, (1+$DI133*$DJ133*$AQ$9),\n  SuperTower, $DL133,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL278,CB133+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY133*(DE133*OtherDamage*$DQ133+DW133*DF133)))",
    "EI133": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM278,CC133)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133, $DB133), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK133),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV133, $AR$29), 0),\n\n  DW, $DR133,\n  CL, $DS133,\n  SM, $DT133,\n  SL, $DQ133,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM133, UltCritCard),\nCY133*(DE133*DO133*SL+UwDamage*DF133)))",
    "EJ133": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN278,CD133)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT133,\n  DamageMastery, $CS133,\n  DemonMastery, $CX133,\n  SPB, INDEX($BN$5:$BN278,CD133+1),\n  ITO, $CV133,\n  Shock, $CW133,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE133*DO133*$DQ133+DW133*DF133)))",
    "EK133": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO278,CE133)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT133,\n  DamageMastery, $CS133,\n  DemonMastery, $CX133,\n  SPB, $CU133,\n  ITO, INDEX($BO$5:$BO278,CE133+1),\n  Shock, $CW133,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE133*DO133*$DQ133+DW133*DF133)))",
    "EL133": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP278,CF133)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133, $DB133), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP133),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF133),\n  CL, $DS133,\n  SM, $DT133,\n  SLM, $DU133,\n  SL, $DQ133,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM133, UltCritCard),\nCY133*(DE133*DO133*SL+UwDamage*DF133)))",
    "EM133": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ278,CG133)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG133+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN133": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR278,CH133)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133, $DB133), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH133+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP133),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK133),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM278,CC133), SMHeat, $AR$29), 0),\n\n  DW, $DR133,\n  CL, $DS133,\n  SL, $DQ133,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM133, UltCritCard),\nCY133*(DE133*DO133*SL+UwDamage*DF133)))",
    "EO133": "IF(OR(CI133 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI133+1))",
    "EP133": "IF(OR($AO$25, CJ133 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ133+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE277,BU133),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL133, 1),\n  DPM, (1+$DI133*CardRangeMastery*$DJ133*$AQ$9),\n  SuperTower, $DL133,\n  Rend, $DN133,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133, $DB133), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR133,\n  SM, $DT133,\n  SLM, $DU133,\n  SL, $DQ133,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM133, UltCritCard),\n\nCY133*(DE133*OtherDamage*SL+UwDamage*DF133)))",
    "EQ133": "IF(OR(CK133 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK133+1)*1%, 1),\n  CF, $DB133,\n  CC, MIN(100%, $CZ133 + 1%),\n  CCUW, DA133 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ278,BZ133) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC133 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR133,\n  CL, $DS133,\n  SM, $DT133,\n  SLM, $DU133,\n  SL, $DQ133,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM133, UltCritCard),\n\nCY133 * (Critical*DO133*SL+UwDamage*UWCritical)))",
    "ER133": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL133 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH278,BX133),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL133+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI133*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM278,CC133), $DV133, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH133,\n  Rapid, DG133,\n  SuperTower, $DL133,\n  Rend, $DN133,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM133,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133, $DB133), 1),\n\n  DW, $DR133,\n  CL, $DS133,\n  SM, $DT133,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY133*(DE133*OtherDamage*SL+UWDamage*DF133)))",
    "ES133": "IF(OR(CM133 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH133,\n  Rapid, DG133,\n  RDPM, (1+$DI133*$DJ133*$AQ$9),\n  Rend, $DN133,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK278,CA133),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM133+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133, $DB133), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR133,\n  CL, $DS133,\n  SM, $DT133,\n  SLM, $DU133,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY133*(DE133*OtherDamage*SL+UwDamage*DF133)))",
    "ET133": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN133 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM133,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN133+1, $DB133), 1),\n\n  DW, $DR133,\n  CL, $DS133,\n  SM, $DT133,\n  SLM, $DU133,\n  SL, $DQ133,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY133*(DE133*DO133*SL+UWDamage*DF133)))",
    "EU133": "IF(OR(NOT($BA$3), NOT($BA$23), $CO133 > $BA$15), \"\", 1 + 0.5*(CO133+1))",
    "EW133": "IF(DZ133=\"\", \"\", LET(\n  Now, CT133,\n  Next, DZ133,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT133),\nFactor/Cost))",
    "EX133": "IF(EA133=\"\",\"\",(EA133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU133))",
    "EY133": "IF(EB133=\"\",\"\",(EB133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV133))",
    "EZ133": "IF(EC133=\"\",\"\",(EC133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW133))",
    "FA133": "IF(ED133=\"\",\"\",(ED133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX133))",
    "FB133": "IF(EE133=\"\",\"\",(EE133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY133))",
    "FC133": "IF(EF133=\"\",\"\",(EF133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ133))",
    "FD133": "IF(EG133=\"\",\"\",(EG133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA133))",
    "FE133": "IF(EH133=\"\",\"\",(EH133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB133))",
    "FF133": "IF(EI133=\"\",\"\",(EI133/$DX133-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC133+1, 1, CC133))))",
    "FG133": "IF(EJ133=\"\",\"\",(EJ133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD133))",
    "FH133": "IF(EK133=\"\",\"\",(EK133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE133))",
    "FI133": "IF(EL133=\"\",\"\",(EL133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF133))",
    "FJ133": "IF(EM133=\"\", \"\", LET(\n  Now, CW133,\n  Next, EM133,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG133),\nFactor/Cost))",
    "FK133": "IF(EN133=\"\",\"\",(EN133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH133))",
    "FL133": "IF(EO133=\"\", \"\", LET(\n  Now, CS133,\n  Next, EO133,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI133),\nFactor/Cost))",
    "FM133": "IF(EP133=\"\",\"\",(EP133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ133))",
    "FN133": "IF(EQ133=\"\",\"\",(EQ133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK133))",
    "FO133": "IF(ER133=\"\",\"\",(ER133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL133))",
    "FP133": "IF(ES133=\"\",\"\",(ES133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM133))",
    "FQ133": "IF(ET133=\"\",\"\",(ET133/$DX133-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN133))",
    "FR133": "IF(EU133=\"\", \"\", LET(\n  Now, CX133,\n  Next, EU133,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO133),\nFactor/Cost))",
    "FT133": "IF(COLUMN(EW133:FR133) = MIN(IF(EW133:FR133=MAX(EW133:FR133), COLUMN(EW133:FR133))), 1, \"\")",
    "D134": "IF(SUM(FT133:GP133),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F134)),\"Card Mastery\",F134),G134)/$D$5,\"\")",
    "F134": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT133:GP133),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT133:GP133=1)),)\"),\"Super Crit Multi\")",
    "G134": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT133:GP133),ARRAYFORMULA(FILTER(BT133:CP133 , FT133:GP133=1)),\"\"\"\")\"),2.0)",
    "I134": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT133:GP133),ARRAYFORMULA(FILTER(EW133:FS133 , FT133:GP133=1))*D$5,\"\"\"\")\"),0.004973285347813443)",
    "K134": "IF(H134<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D134)),)",
    "BT134": "BT133+FT133",
    "BU134": "BU133+FU133",
    "BV134": "BV133+FV133",
    "BW134": "BW133+FW133",
    "BX134": "BX133+FX133",
    "BY134": "BY133+FY133",
    "BZ134": "BZ133+FZ133",
    "CA134": "CA133+GA133",
    "CB134": "CB133+GB133",
    "CC134": "CC133+GC133",
    "CD134": "CD133+GD133",
    "CE134": "CE133+GE133",
    "CF134": "CF133+GF133",
    "CG134": "CG133+GG133",
    "CH134": "CH133+GH133",
    "CI134": "CI133+GI133",
    "CJ134": "CJ133+GJ133",
    "CK134": "CK133+GK133",
    "CL134": "CL133+GL133",
    "CM134": "CM133+GM133",
    "CN134": "CN133+GN133",
    "CO134": "CO133+GO133",
    "CS134": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI134,1)",
    "CT134": "INDEX($BD$5:$BD279,BT134)",
    "CU134": "INDEX($BN$5:$BN279,CD134)",
    "CV134": "INDEX($BO$5:$BO279,CE134)",
    "CW134": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG134)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX134": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO134, 1)",
    "CY134": "LET(\n  Base, $CR$6,\n  Damage, $CT134,\n  DamageMastery, $CS134,\n  DemonMastery, $CX134,\n  SPB, $CU134,\n  ITO, $CV134,\n  Shock, $CW134,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ134": "MIN(100%, DA134)",
    "DA134": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK134*1%, 0)",
    "DB134": "LET(\n  Lab, 1+INDEX($BF$5:$BF279,BV134),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC134": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK134*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI279,BY134) + CardCritMastery)",
    "DD134": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK134*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ279,BZ134) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE134": "LET(\n  CF, $DB134,\n  CC, $CZ134,\n  SCM, $DD134,\n  SCC, $DC134,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF134": "LET(\n  CF, $DB134,\n  CC, $DA134,\n  SCM, $DD134,\n  SCC, $DC134,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG134": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH134)), 0)",
    "DH134": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ134*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE279,BU134),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI134": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG279, BW134), 1) + $AE$9)",
    "DJ134": "LET(\n  DpmLab, INDEX($BH$5:$BH279,BX134),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL134, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK134": "(1+$DI134*$DJ134*$AQ$9)",
    "DL134": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK279,CA134),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM134*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM134": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK279,CA134),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM134*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN134": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL279,CB134)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO134": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH134,\n  Rapid, DG134,\n  RDPM, DK134,\n  SuperTower, $DL134,\n  Rend, $DN134,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP134": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ134": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK134),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR134": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP134),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF134-1))",
    "DS134": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG134, DH134),0))",
    "DT134": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP134),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV134, $AR$29), 0))",
    "DU134": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK134),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM279,CC134), $DV134, $AR$29), 0))",
    "DV134": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH134), $AO$29)",
    "DW134": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM134,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134, $DB134), 1),\n\n  DW, $DR134,\n  CL, $DS134,\n  SM, $DT134,\n  SLM, $DU134,\n  SL, $DQ134,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX134": "CY134*(DE134*DO134*DQ134+DW134*DF134)",
    "DZ134": "IF(INDEX($BD$6:$BD279,BT134)=\"\", \"\", INDEX($BD$5:$BD279,BT134+1))",
    "EA134": "IF(OR($AO$25, INDEX($BE$6:$BE279,BU134)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ134)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE279,BU134+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI134*$DJ134*$AQ$9),\n  SuperTower, $DL134,\n  Rend, $DN134,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134, $DB134), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR134,\n  SM, $DT134,\n  SLM, $DU134,\n  SL, $DQ134,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM134, UltCritCard),\n\nCY134*(DE134*OtherDamage*SL+UwDamage*DF134)))",
    "EB134": "IF(INDEX($BF$6:$BF279,BV134)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF279,BV134+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ134,\n  CCUW, $DA134,\n  SCM, $DD134,\n  SCC, $DC134,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134, CF), 1),\n\n  DW, $DR134,\n  CL, $DS134,\n  SM, $DT134,\n  SLM, $DU134,\n  SL, $DQ134,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM134, UltCritCard),\n\nCY134 * (Critical * DO134 * SL + UwDamage * UWCritical)))",
    "EC134": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG279,BW134)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH134,\n  Rapid, DG134,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG279, BW134+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ134*$AQ$9),\n  SuperTower, $DL134,\n  Rend, $DN134,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM279,CC134), $DV134, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM134,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134, $DB134), 1),\n\n  DW, $DR134,\n  CL, $DS134,\n  SM, $DT134,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY134*(DE134*OtherDamage*SL+UWDamage*DF134)))",
    "ED134": "IF(OR($AO$25, INDEX($BH$6:$BH279,BX134)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH279,BX134+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL134, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI134*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM279,CC134), $DV134, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH134,\n  Rapid, DG134,\n  SuperTower, $DL134,\n  Rend, $DN134,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM134,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134, $DB134), 1),\n\n  DW, $DR134,\n  CL, $DS134,\n  SM, $DT134,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY134*(DE134*OtherDamage*SL+UWDamage*DF134)))",
    "EE134": "IF(INDEX($BI$6:$BI279,BY134)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK134, 0),\n  CF, $DB134,\n  CC, $CZ134,\n  CCUW, $DA134,\n  SCM, $DD134,\n  SCC, $AV$17+INDEX($BI$5:$BI279,BY134+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY134 * (Critical*DO134*$DQ134+DW134*UWCritical)))",
    "EF134": "IF(INDEX($BJ$6:$BJ279,BZ134)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK134*1%, 1),\n  CF, $DB134,\n  CC, $CZ134,\n  CCUW, $DA134,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ279,BZ134+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC134,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY134*(Critical*DO134*$DQ134+DW134*UWCritical)))",
    "EG134": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK279,CA134)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH134,\n  Rapid, DG134,\n  DPM, (1+$DI134*$DJ134*$AQ$9),\n  Rend, $DN134,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK279,CA134+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM134*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134, $DB134), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK279,CA134+1)-1))/(45-CM134*3),1),\n\n  SL, $DQ134,\n  DW, $DR134,\n  CL, $DS134,\n  SM, $DT134,\n  SLM, $DU134,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY134*(DE134*OtherDamage*SL+UwDamage*DF134)))",
    "EH134": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL279,CB134+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL279,CB134)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH134,\n  Rapid, DG134,\n  DPM, (1+$DI134*$DJ134*$AQ$9),\n  SuperTower, $DL134,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL279,CB134+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY134*(DE134*OtherDamage*$DQ134+DW134*DF134)))",
    "EI134": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM279,CC134)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134, $DB134), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK134),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV134, $AR$29), 0),\n\n  DW, $DR134,\n  CL, $DS134,\n  SM, $DT134,\n  SL, $DQ134,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM134, UltCritCard),\nCY134*(DE134*DO134*SL+UwDamage*DF134)))",
    "EJ134": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN279,CD134)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT134,\n  DamageMastery, $CS134,\n  DemonMastery, $CX134,\n  SPB, INDEX($BN$5:$BN279,CD134+1),\n  ITO, $CV134,\n  Shock, $CW134,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE134*DO134*$DQ134+DW134*DF134)))",
    "EK134": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO279,CE134)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT134,\n  DamageMastery, $CS134,\n  DemonMastery, $CX134,\n  SPB, $CU134,\n  ITO, INDEX($BO$5:$BO279,CE134+1),\n  Shock, $CW134,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE134*DO134*$DQ134+DW134*DF134)))",
    "EL134": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP279,CF134)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134, $DB134), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP134),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF134),\n  CL, $DS134,\n  SM, $DT134,\n  SLM, $DU134,\n  SL, $DQ134,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM134, UltCritCard),\nCY134*(DE134*DO134*SL+UwDamage*DF134)))",
    "EM134": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ279,CG134)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG134+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN134": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR279,CH134)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134, $DB134), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH134+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP134),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK134),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM279,CC134), SMHeat, $AR$29), 0),\n\n  DW, $DR134,\n  CL, $DS134,\n  SL, $DQ134,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM134, UltCritCard),\nCY134*(DE134*DO134*SL+UwDamage*DF134)))",
    "EO134": "IF(OR(CI134 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI134+1))",
    "EP134": "IF(OR($AO$25, CJ134 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ134+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE278,BU134),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL134, 1),\n  DPM, (1+$DI134*CardRangeMastery*$DJ134*$AQ$9),\n  SuperTower, $DL134,\n  Rend, $DN134,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134, $DB134), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR134,\n  SM, $DT134,\n  SLM, $DU134,\n  SL, $DQ134,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM134, UltCritCard),\n\nCY134*(DE134*OtherDamage*SL+UwDamage*DF134)))",
    "EQ134": "IF(OR(CK134 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK134+1)*1%, 1),\n  CF, $DB134,\n  CC, MIN(100%, $CZ134 + 1%),\n  CCUW, DA134 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ279,BZ134) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC134 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR134,\n  CL, $DS134,\n  SM, $DT134,\n  SLM, $DU134,\n  SL, $DQ134,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM134, UltCritCard),\n\nCY134 * (Critical*DO134*SL+UwDamage*UWCritical)))",
    "ER134": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL134 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH279,BX134),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL134+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI134*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM279,CC134), $DV134, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH134,\n  Rapid, DG134,\n  SuperTower, $DL134,\n  Rend, $DN134,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM134,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134, $DB134), 1),\n\n  DW, $DR134,\n  CL, $DS134,\n  SM, $DT134,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY134*(DE134*OtherDamage*SL+UWDamage*DF134)))",
    "ES134": "IF(OR(CM134 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH134,\n  Rapid, DG134,\n  RDPM, (1+$DI134*$DJ134*$AQ$9),\n  Rend, $DN134,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK279,CA134),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM134+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134, $DB134), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR134,\n  CL, $DS134,\n  SM, $DT134,\n  SLM, $DU134,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY134*(DE134*OtherDamage*SL+UwDamage*DF134)))",
    "ET134": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN134 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM134,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN134+1, $DB134), 1),\n\n  DW, $DR134,\n  CL, $DS134,\n  SM, $DT134,\n  SLM, $DU134,\n  SL, $DQ134,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY134*(DE134*DO134*SL+UWDamage*DF134)))",
    "EU134": "IF(OR(NOT($BA$3), NOT($BA$23), $CO134 > $BA$15), \"\", 1 + 0.5*(CO134+1))",
    "EW134": "IF(DZ134=\"\", \"\", LET(\n  Now, CT134,\n  Next, DZ134,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT134),\nFactor/Cost))",
    "EX134": "IF(EA134=\"\",\"\",(EA134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU134))",
    "EY134": "IF(EB134=\"\",\"\",(EB134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV134))",
    "EZ134": "IF(EC134=\"\",\"\",(EC134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW134))",
    "FA134": "IF(ED134=\"\",\"\",(ED134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX134))",
    "FB134": "IF(EE134=\"\",\"\",(EE134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY134))",
    "FC134": "IF(EF134=\"\",\"\",(EF134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ134))",
    "FD134": "IF(EG134=\"\",\"\",(EG134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA134))",
    "FE134": "IF(EH134=\"\",\"\",(EH134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB134))",
    "FF134": "IF(EI134=\"\",\"\",(EI134/$DX134-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC134+1, 1, CC134))))",
    "FG134": "IF(EJ134=\"\",\"\",(EJ134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD134))",
    "FH134": "IF(EK134=\"\",\"\",(EK134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE134))",
    "FI134": "IF(EL134=\"\",\"\",(EL134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF134))",
    "FJ134": "IF(EM134=\"\", \"\", LET(\n  Now, CW134,\n  Next, EM134,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG134),\nFactor/Cost))",
    "FK134": "IF(EN134=\"\",\"\",(EN134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH134))",
    "FL134": "IF(EO134=\"\", \"\", LET(\n  Now, CS134,\n  Next, EO134,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI134),\nFactor/Cost))",
    "FM134": "IF(EP134=\"\",\"\",(EP134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ134))",
    "FN134": "IF(EQ134=\"\",\"\",(EQ134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK134))",
    "FO134": "IF(ER134=\"\",\"\",(ER134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL134))",
    "FP134": "IF(ES134=\"\",\"\",(ES134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM134))",
    "FQ134": "IF(ET134=\"\",\"\",(ET134/$DX134-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN134))",
    "FR134": "IF(EU134=\"\", \"\", LET(\n  Now, CX134,\n  Next, EU134,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO134),\nFactor/Cost))",
    "FT134": "IF(COLUMN(EW134:FR134) = MIN(IF(EW134:FR134=MAX(EW134:FR134), COLUMN(EW134:FR134))), 1, \"\")",
    "D135": "IF(SUM(FT134:GP134),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F135)),\"Card Mastery\",F135),G135)/$D$5,\"\")",
    "F135": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT134:GP134),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT134:GP134=1)),)\"),\"Critical Factor\")",
    "G135": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT134:GP134),ARRAYFORMULA(FILTER(BT134:CP134 , FT134:GP134=1)),\"\"\"\")\"),32.0)",
    "I135": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT134:GP134),ARRAYFORMULA(FILTER(EW134:FS134 , FT134:GP134=1))*D$5,\"\"\"\")\"),0.004929134880714419)",
    "K135": "IF(D126,FORMAT_TIME_YEAR(SUM($D$6:$D135)),)",
    "BT135": "BT134+FT134",
    "BU135": "BU134+FU134",
    "BV135": "BV134+FV134",
    "BW135": "BW134+FW134",
    "BX135": "BX134+FX134",
    "BY135": "BY134+FY134",
    "BZ135": "BZ134+FZ134",
    "CA135": "CA134+GA134",
    "CB135": "CB134+GB134",
    "CC135": "CC134+GC134",
    "CD135": "CD134+GD134",
    "CE135": "CE134+GE134",
    "CF135": "CF134+GF134",
    "CG135": "CG134+GG134",
    "CH135": "CH134+GH134",
    "CI135": "CI134+GI134",
    "CJ135": "CJ134+GJ134",
    "CK135": "CK134+GK134",
    "CL135": "CL134+GL134",
    "CM135": "CM134+GM134",
    "CN135": "CN134+GN134",
    "CO135": "CO134+GO134",
    "CS135": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI135,1)",
    "CT135": "INDEX($BD$5:$BD280,BT135)",
    "CU135": "INDEX($BN$5:$BN280,CD135)",
    "CV135": "INDEX($BO$5:$BO280,CE135)",
    "CW135": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG135)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX135": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO135, 1)",
    "CY135": "LET(\n  Base, $CR$6,\n  Damage, $CT135,\n  DamageMastery, $CS135,\n  DemonMastery, $CX135,\n  SPB, $CU135,\n  ITO, $CV135,\n  Shock, $CW135,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ135": "MIN(100%, DA135)",
    "DA135": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK135*1%, 0)",
    "DB135": "LET(\n  Lab, 1+INDEX($BF$5:$BF280,BV135),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC135": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK135*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI280,BY135) + CardCritMastery)",
    "DD135": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK135*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ280,BZ135) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE135": "LET(\n  CF, $DB135,\n  CC, $CZ135,\n  SCM, $DD135,\n  SCC, $DC135,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF135": "LET(\n  CF, $DB135,\n  CC, $DA135,\n  SCM, $DD135,\n  SCC, $DC135,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG135": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH135)), 0)",
    "DH135": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ135*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE280,BU135),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI135": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG280, BW135), 1) + $AE$9)",
    "DJ135": "LET(\n  DpmLab, INDEX($BH$5:$BH280,BX135),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL135, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK135": "(1+$DI135*$DJ135*$AQ$9)",
    "DL135": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK280,CA135),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM135*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM135": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK280,CA135),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM135*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN135": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL280,CB135)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO135": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH135,\n  Rapid, DG135,\n  RDPM, DK135,\n  SuperTower, $DL135,\n  Rend, $DN135,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP135": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ135": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK135),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR135": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP135),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF135-1))",
    "DS135": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG135, DH135),0))",
    "DT135": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP135),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV135, $AR$29), 0))",
    "DU135": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK135),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM280,CC135), $DV135, $AR$29), 0))",
    "DV135": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH135), $AO$29)",
    "DW135": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM135,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135, $DB135), 1),\n\n  DW, $DR135,\n  CL, $DS135,\n  SM, $DT135,\n  SLM, $DU135,\n  SL, $DQ135,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX135": "CY135*(DE135*DO135*DQ135+DW135*DF135)",
    "DZ135": "IF(INDEX($BD$6:$BD280,BT135)=\"\", \"\", INDEX($BD$5:$BD280,BT135+1))",
    "EA135": "IF(OR($AO$25, INDEX($BE$6:$BE280,BU135)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ135)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE280,BU135+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI135*$DJ135*$AQ$9),\n  SuperTower, $DL135,\n  Rend, $DN135,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135, $DB135), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR135,\n  SM, $DT135,\n  SLM, $DU135,\n  SL, $DQ135,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM135, UltCritCard),\n\nCY135*(DE135*OtherDamage*SL+UwDamage*DF135)))",
    "EB135": "IF(INDEX($BF$6:$BF280,BV135)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF280,BV135+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ135,\n  CCUW, $DA135,\n  SCM, $DD135,\n  SCC, $DC135,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135, CF), 1),\n\n  DW, $DR135,\n  CL, $DS135,\n  SM, $DT135,\n  SLM, $DU135,\n  SL, $DQ135,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM135, UltCritCard),\n\nCY135 * (Critical * DO135 * SL + UwDamage * UWCritical)))",
    "EC135": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG280,BW135)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH135,\n  Rapid, DG135,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG280, BW135+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ135*$AQ$9),\n  SuperTower, $DL135,\n  Rend, $DN135,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM280,CC135), $DV135, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM135,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135, $DB135), 1),\n\n  DW, $DR135,\n  CL, $DS135,\n  SM, $DT135,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY135*(DE135*OtherDamage*SL+UWDamage*DF135)))",
    "ED135": "IF(OR($AO$25, INDEX($BH$6:$BH280,BX135)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH280,BX135+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL135, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI135*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM280,CC135), $DV135, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH135,\n  Rapid, DG135,\n  SuperTower, $DL135,\n  Rend, $DN135,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM135,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135, $DB135), 1),\n\n  DW, $DR135,\n  CL, $DS135,\n  SM, $DT135,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY135*(DE135*OtherDamage*SL+UWDamage*DF135)))",
    "EE135": "IF(INDEX($BI$6:$BI280,BY135)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK135, 0),\n  CF, $DB135,\n  CC, $CZ135,\n  CCUW, $DA135,\n  SCM, $DD135,\n  SCC, $AV$17+INDEX($BI$5:$BI280,BY135+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY135 * (Critical*DO135*$DQ135+DW135*UWCritical)))",
    "EF135": "IF(INDEX($BJ$6:$BJ280,BZ135)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK135*1%, 1),\n  CF, $DB135,\n  CC, $CZ135,\n  CCUW, $DA135,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ280,BZ135+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC135,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY135*(Critical*DO135*$DQ135+DW135*UWCritical)))",
    "EG135": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK280,CA135)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH135,\n  Rapid, DG135,\n  DPM, (1+$DI135*$DJ135*$AQ$9),\n  Rend, $DN135,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK280,CA135+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM135*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135, $DB135), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK280,CA135+1)-1))/(45-CM135*3),1),\n\n  SL, $DQ135,\n  DW, $DR135,\n  CL, $DS135,\n  SM, $DT135,\n  SLM, $DU135,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY135*(DE135*OtherDamage*SL+UwDamage*DF135)))",
    "EH135": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL280,CB135+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL280,CB135)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH135,\n  Rapid, DG135,\n  DPM, (1+$DI135*$DJ135*$AQ$9),\n  SuperTower, $DL135,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL280,CB135+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY135*(DE135*OtherDamage*$DQ135+DW135*DF135)))",
    "EI135": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM280,CC135)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135, $DB135), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK135),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV135, $AR$29), 0),\n\n  DW, $DR135,\n  CL, $DS135,\n  SM, $DT135,\n  SL, $DQ135,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM135, UltCritCard),\nCY135*(DE135*DO135*SL+UwDamage*DF135)))",
    "EJ135": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN280,CD135)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT135,\n  DamageMastery, $CS135,\n  DemonMastery, $CX135,\n  SPB, INDEX($BN$5:$BN280,CD135+1),\n  ITO, $CV135,\n  Shock, $CW135,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE135*DO135*$DQ135+DW135*DF135)))",
    "EK135": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO280,CE135)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT135,\n  DamageMastery, $CS135,\n  DemonMastery, $CX135,\n  SPB, $CU135,\n  ITO, INDEX($BO$5:$BO280,CE135+1),\n  Shock, $CW135,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE135*DO135*$DQ135+DW135*DF135)))",
    "EL135": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP280,CF135)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135, $DB135), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP135),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF135),\n  CL, $DS135,\n  SM, $DT135,\n  SLM, $DU135,\n  SL, $DQ135,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM135, UltCritCard),\nCY135*(DE135*DO135*SL+UwDamage*DF135)))",
    "EM135": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ280,CG135)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG135+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN135": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR280,CH135)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135, $DB135), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH135+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP135),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK135),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM280,CC135), SMHeat, $AR$29), 0),\n\n  DW, $DR135,\n  CL, $DS135,\n  SL, $DQ135,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM135, UltCritCard),\nCY135*(DE135*DO135*SL+UwDamage*DF135)))",
    "EO135": "IF(OR(CI135 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI135+1))",
    "EP135": "IF(OR($AO$25, CJ135 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ135+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE279,BU135),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL135, 1),\n  DPM, (1+$DI135*CardRangeMastery*$DJ135*$AQ$9),\n  SuperTower, $DL135,\n  Rend, $DN135,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135, $DB135), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR135,\n  SM, $DT135,\n  SLM, $DU135,\n  SL, $DQ135,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM135, UltCritCard),\n\nCY135*(DE135*OtherDamage*SL+UwDamage*DF135)))",
    "EQ135": "IF(OR(CK135 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK135+1)*1%, 1),\n  CF, $DB135,\n  CC, MIN(100%, $CZ135 + 1%),\n  CCUW, DA135 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ280,BZ135) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC135 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR135,\n  CL, $DS135,\n  SM, $DT135,\n  SLM, $DU135,\n  SL, $DQ135,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM135, UltCritCard),\n\nCY135 * (Critical*DO135*SL+UwDamage*UWCritical)))",
    "ER135": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL135 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH280,BX135),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL135+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI135*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM280,CC135), $DV135, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH135,\n  Rapid, DG135,\n  SuperTower, $DL135,\n  Rend, $DN135,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM135,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135, $DB135), 1),\n\n  DW, $DR135,\n  CL, $DS135,\n  SM, $DT135,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY135*(DE135*OtherDamage*SL+UWDamage*DF135)))",
    "ES135": "IF(OR(CM135 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH135,\n  Rapid, DG135,\n  RDPM, (1+$DI135*$DJ135*$AQ$9),\n  Rend, $DN135,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK280,CA135),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM135+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135, $DB135), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR135,\n  CL, $DS135,\n  SM, $DT135,\n  SLM, $DU135,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY135*(DE135*OtherDamage*SL+UwDamage*DF135)))",
    "ET135": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN135 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM135,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN135+1, $DB135), 1),\n\n  DW, $DR135,\n  CL, $DS135,\n  SM, $DT135,\n  SLM, $DU135,\n  SL, $DQ135,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY135*(DE135*DO135*SL+UWDamage*DF135)))",
    "EU135": "IF(OR(NOT($BA$3), NOT($BA$23), $CO135 > $BA$15), \"\", 1 + 0.5*(CO135+1))",
    "EW135": "IF(DZ135=\"\", \"\", LET(\n  Now, CT135,\n  Next, DZ135,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT135),\nFactor/Cost))",
    "EX135": "IF(EA135=\"\",\"\",(EA135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU135))",
    "EY135": "IF(EB135=\"\",\"\",(EB135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV135))",
    "EZ135": "IF(EC135=\"\",\"\",(EC135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW135))",
    "FA135": "IF(ED135=\"\",\"\",(ED135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX135))",
    "FB135": "IF(EE135=\"\",\"\",(EE135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY135))",
    "FC135": "IF(EF135=\"\",\"\",(EF135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ135))",
    "FD135": "IF(EG135=\"\",\"\",(EG135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA135))",
    "FE135": "IF(EH135=\"\",\"\",(EH135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB135))",
    "FF135": "IF(EI135=\"\",\"\",(EI135/$DX135-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC135+1, 1, CC135))))",
    "FG135": "IF(EJ135=\"\",\"\",(EJ135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD135))",
    "FH135": "IF(EK135=\"\",\"\",(EK135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE135))",
    "FI135": "IF(EL135=\"\",\"\",(EL135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF135))",
    "FJ135": "IF(EM135=\"\", \"\", LET(\n  Now, CW135,\n  Next, EM135,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG135),\nFactor/Cost))",
    "FK135": "IF(EN135=\"\",\"\",(EN135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH135))",
    "FL135": "IF(EO135=\"\", \"\", LET(\n  Now, CS135,\n  Next, EO135,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI135),\nFactor/Cost))",
    "FM135": "IF(EP135=\"\",\"\",(EP135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ135))",
    "FN135": "IF(EQ135=\"\",\"\",(EQ135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK135))",
    "FO135": "IF(ER135=\"\",\"\",(ER135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL135))",
    "FP135": "IF(ES135=\"\",\"\",(ES135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM135))",
    "FQ135": "IF(ET135=\"\",\"\",(ET135/$DX135-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN135))",
    "FR135": "IF(EU135=\"\", \"\", LET(\n  Now, CX135,\n  Next, EU135,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO135),\nFactor/Cost))",
    "FT135": "IF(COLUMN(EW135:FR135) = MIN(IF(EW135:FR135=MAX(EW135:FR135), COLUMN(EW135:FR135))), 1, \"\")",
    "D136": "IF(SUM(FT135:GP135),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F136)),\"Card Mastery\",F136),G136)/$D$5,\"\")",
    "F136": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT135:GP135),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT135:GP135=1)),)\"),\"Standard Perks Bonus\")",
    "G136": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT135:GP135),ARRAYFORMULA(FILTER(BT135:CP135 , FT135:GP135=1)),\"\"\"\")\"),8.0)",
    "I136": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT135:GP135),ARRAYFORMULA(FILTER(EW135:FS135 , FT135:GP135=1))*D$5,\"\"\"\")\"),0.00482018048898059)",
    "K136": "IF(H136<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D136)),)",
    "BT136": "BT135+FT135",
    "BU136": "BU135+FU135",
    "BV136": "BV135+FV135",
    "BW136": "BW135+FW135",
    "BX136": "BX135+FX135",
    "BY136": "BY135+FY135",
    "BZ136": "BZ135+FZ135",
    "CA136": "CA135+GA135",
    "CB136": "CB135+GB135",
    "CC136": "CC135+GC135",
    "CD136": "CD135+GD135",
    "CE136": "CE135+GE135",
    "CF136": "CF135+GF135",
    "CG136": "CG135+GG135",
    "CH136": "CH135+GH135",
    "CI136": "CI135+GI135",
    "CJ136": "CJ135+GJ135",
    "CK136": "CK135+GK135",
    "CL136": "CL135+GL135",
    "CM136": "CM135+GM135",
    "CN136": "CN135+GN135",
    "CO136": "CO135+GO135",
    "CS136": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI136,1)",
    "CT136": "INDEX($BD$5:$BD281,BT136)",
    "CU136": "INDEX($BN$5:$BN281,CD136)",
    "CV136": "INDEX($BO$5:$BO281,CE136)",
    "CW136": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG136)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX136": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO136, 1)",
    "CY136": "LET(\n  Base, $CR$6,\n  Damage, $CT136,\n  DamageMastery, $CS136,\n  DemonMastery, $CX136,\n  SPB, $CU136,\n  ITO, $CV136,\n  Shock, $CW136,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ136": "MIN(100%, DA136)",
    "DA136": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK136*1%, 0)",
    "DB136": "LET(\n  Lab, 1+INDEX($BF$5:$BF281,BV136),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC136": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK136*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI281,BY136) + CardCritMastery)",
    "DD136": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK136*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ281,BZ136) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE136": "LET(\n  CF, $DB136,\n  CC, $CZ136,\n  SCM, $DD136,\n  SCC, $DC136,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF136": "LET(\n  CF, $DB136,\n  CC, $DA136,\n  SCM, $DD136,\n  SCC, $DC136,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG136": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH136)), 0)",
    "DH136": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ136*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE281,BU136),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI136": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG281, BW136), 1) + $AE$9)",
    "DJ136": "LET(\n  DpmLab, INDEX($BH$5:$BH281,BX136),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL136, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK136": "(1+$DI136*$DJ136*$AQ$9)",
    "DL136": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK281,CA136),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM136*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM136": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK281,CA136),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM136*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN136": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL281,CB136)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO136": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH136,\n  Rapid, DG136,\n  RDPM, DK136,\n  SuperTower, $DL136,\n  Rend, $DN136,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP136": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ136": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK136),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR136": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP136),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF136-1))",
    "DS136": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG136, DH136),0))",
    "DT136": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP136),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV136, $AR$29), 0))",
    "DU136": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK136),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM281,CC136), $DV136, $AR$29), 0))",
    "DV136": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH136), $AO$29)",
    "DW136": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM136,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136, $DB136), 1),\n\n  DW, $DR136,\n  CL, $DS136,\n  SM, $DT136,\n  SLM, $DU136,\n  SL, $DQ136,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX136": "CY136*(DE136*DO136*DQ136+DW136*DF136)",
    "DZ136": "IF(INDEX($BD$6:$BD281,BT136)=\"\", \"\", INDEX($BD$5:$BD281,BT136+1))",
    "EA136": "IF(OR($AO$25, INDEX($BE$6:$BE281,BU136)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ136)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE281,BU136+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI136*$DJ136*$AQ$9),\n  SuperTower, $DL136,\n  Rend, $DN136,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136, $DB136), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR136,\n  SM, $DT136,\n  SLM, $DU136,\n  SL, $DQ136,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM136, UltCritCard),\n\nCY136*(DE136*OtherDamage*SL+UwDamage*DF136)))",
    "EB136": "IF(INDEX($BF$6:$BF281,BV136)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF281,BV136+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ136,\n  CCUW, $DA136,\n  SCM, $DD136,\n  SCC, $DC136,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136, CF), 1),\n\n  DW, $DR136,\n  CL, $DS136,\n  SM, $DT136,\n  SLM, $DU136,\n  SL, $DQ136,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM136, UltCritCard),\n\nCY136 * (Critical * DO136 * SL + UwDamage * UWCritical)))",
    "EC136": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG281,BW136)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH136,\n  Rapid, DG136,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG281, BW136+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ136*$AQ$9),\n  SuperTower, $DL136,\n  Rend, $DN136,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM281,CC136), $DV136, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM136,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136, $DB136), 1),\n\n  DW, $DR136,\n  CL, $DS136,\n  SM, $DT136,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY136*(DE136*OtherDamage*SL+UWDamage*DF136)))",
    "ED136": "IF(OR($AO$25, INDEX($BH$6:$BH281,BX136)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH281,BX136+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL136, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI136*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM281,CC136), $DV136, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH136,\n  Rapid, DG136,\n  SuperTower, $DL136,\n  Rend, $DN136,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM136,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136, $DB136), 1),\n\n  DW, $DR136,\n  CL, $DS136,\n  SM, $DT136,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY136*(DE136*OtherDamage*SL+UWDamage*DF136)))",
    "EE136": "IF(INDEX($BI$6:$BI281,BY136)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK136, 0),\n  CF, $DB136,\n  CC, $CZ136,\n  CCUW, $DA136,\n  SCM, $DD136,\n  SCC, $AV$17+INDEX($BI$5:$BI281,BY136+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY136 * (Critical*DO136*$DQ136+DW136*UWCritical)))",
    "EF136": "IF(INDEX($BJ$6:$BJ281,BZ136)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK136*1%, 1),\n  CF, $DB136,\n  CC, $CZ136,\n  CCUW, $DA136,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ281,BZ136+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC136,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY136*(Critical*DO136*$DQ136+DW136*UWCritical)))",
    "EG136": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK281,CA136)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH136,\n  Rapid, DG136,\n  DPM, (1+$DI136*$DJ136*$AQ$9),\n  Rend, $DN136,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK281,CA136+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM136*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136, $DB136), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK281,CA136+1)-1))/(45-CM136*3),1),\n\n  SL, $DQ136,\n  DW, $DR136,\n  CL, $DS136,\n  SM, $DT136,\n  SLM, $DU136,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY136*(DE136*OtherDamage*SL+UwDamage*DF136)))",
    "EH136": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL281,CB136+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL281,CB136)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH136,\n  Rapid, DG136,\n  DPM, (1+$DI136*$DJ136*$AQ$9),\n  SuperTower, $DL136,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL281,CB136+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY136*(DE136*OtherDamage*$DQ136+DW136*DF136)))",
    "EI136": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM281,CC136)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136, $DB136), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK136),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV136, $AR$29), 0),\n\n  DW, $DR136,\n  CL, $DS136,\n  SM, $DT136,\n  SL, $DQ136,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM136, UltCritCard),\nCY136*(DE136*DO136*SL+UwDamage*DF136)))",
    "EJ136": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN281,CD136)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT136,\n  DamageMastery, $CS136,\n  DemonMastery, $CX136,\n  SPB, INDEX($BN$5:$BN281,CD136+1),\n  ITO, $CV136,\n  Shock, $CW136,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE136*DO136*$DQ136+DW136*DF136)))",
    "EK136": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO281,CE136)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT136,\n  DamageMastery, $CS136,\n  DemonMastery, $CX136,\n  SPB, $CU136,\n  ITO, INDEX($BO$5:$BO281,CE136+1),\n  Shock, $CW136,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE136*DO136*$DQ136+DW136*DF136)))",
    "EL136": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP281,CF136)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136, $DB136), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP136),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF136),\n  CL, $DS136,\n  SM, $DT136,\n  SLM, $DU136,\n  SL, $DQ136,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM136, UltCritCard),\nCY136*(DE136*DO136*SL+UwDamage*DF136)))",
    "EM136": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ281,CG136)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG136+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN136": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR281,CH136)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136, $DB136), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH136+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP136),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK136),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM281,CC136), SMHeat, $AR$29), 0),\n\n  DW, $DR136,\n  CL, $DS136,\n  SL, $DQ136,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM136, UltCritCard),\nCY136*(DE136*DO136*SL+UwDamage*DF136)))",
    "EO136": "IF(OR(CI136 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI136+1))",
    "EP136": "IF(OR($AO$25, CJ136 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ136+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE280,BU136),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL136, 1),\n  DPM, (1+$DI136*CardRangeMastery*$DJ136*$AQ$9),\n  SuperTower, $DL136,\n  Rend, $DN136,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136, $DB136), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR136,\n  SM, $DT136,\n  SLM, $DU136,\n  SL, $DQ136,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM136, UltCritCard),\n\nCY136*(DE136*OtherDamage*SL+UwDamage*DF136)))",
    "EQ136": "IF(OR(CK136 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK136+1)*1%, 1),\n  CF, $DB136,\n  CC, MIN(100%, $CZ136 + 1%),\n  CCUW, DA136 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ281,BZ136) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC136 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR136,\n  CL, $DS136,\n  SM, $DT136,\n  SLM, $DU136,\n  SL, $DQ136,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM136, UltCritCard),\n\nCY136 * (Critical*DO136*SL+UwDamage*UWCritical)))",
    "ER136": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL136 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH281,BX136),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL136+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI136*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM281,CC136), $DV136, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH136,\n  Rapid, DG136,\n  SuperTower, $DL136,\n  Rend, $DN136,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM136,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136, $DB136), 1),\n\n  DW, $DR136,\n  CL, $DS136,\n  SM, $DT136,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY136*(DE136*OtherDamage*SL+UWDamage*DF136)))",
    "ES136": "IF(OR(CM136 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH136,\n  Rapid, DG136,\n  RDPM, (1+$DI136*$DJ136*$AQ$9),\n  Rend, $DN136,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK281,CA136),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM136+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136, $DB136), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR136,\n  CL, $DS136,\n  SM, $DT136,\n  SLM, $DU136,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY136*(DE136*OtherDamage*SL+UwDamage*DF136)))",
    "ET136": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN136 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM136,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN136+1, $DB136), 1),\n\n  DW, $DR136,\n  CL, $DS136,\n  SM, $DT136,\n  SLM, $DU136,\n  SL, $DQ136,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY136*(DE136*DO136*SL+UWDamage*DF136)))",
    "EU136": "IF(OR(NOT($BA$3), NOT($BA$23), $CO136 > $BA$15), \"\", 1 + 0.5*(CO136+1))",
    "EW136": "IF(DZ136=\"\", \"\", LET(\n  Now, CT136,\n  Next, DZ136,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT136),\nFactor/Cost))",
    "EX136": "IF(EA136=\"\",\"\",(EA136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU136))",
    "EY136": "IF(EB136=\"\",\"\",(EB136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV136))",
    "EZ136": "IF(EC136=\"\",\"\",(EC136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW136))",
    "FA136": "IF(ED136=\"\",\"\",(ED136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX136))",
    "FB136": "IF(EE136=\"\",\"\",(EE136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY136))",
    "FC136": "IF(EF136=\"\",\"\",(EF136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ136))",
    "FD136": "IF(EG136=\"\",\"\",(EG136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA136))",
    "FE136": "IF(EH136=\"\",\"\",(EH136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB136))",
    "FF136": "IF(EI136=\"\",\"\",(EI136/$DX136-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC136+1, 1, CC136))))",
    "FG136": "IF(EJ136=\"\",\"\",(EJ136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD136))",
    "FH136": "IF(EK136=\"\",\"\",(EK136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE136))",
    "FI136": "IF(EL136=\"\",\"\",(EL136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF136))",
    "FJ136": "IF(EM136=\"\", \"\", LET(\n  Now, CW136,\n  Next, EM136,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG136),\nFactor/Cost))",
    "FK136": "IF(EN136=\"\",\"\",(EN136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH136))",
    "FL136": "IF(EO136=\"\", \"\", LET(\n  Now, CS136,\n  Next, EO136,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI136),\nFactor/Cost))",
    "FM136": "IF(EP136=\"\",\"\",(EP136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ136))",
    "FN136": "IF(EQ136=\"\",\"\",(EQ136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK136))",
    "FO136": "IF(ER136=\"\",\"\",(ER136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL136))",
    "FP136": "IF(ES136=\"\",\"\",(ES136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM136))",
    "FQ136": "IF(ET136=\"\",\"\",(ET136/$DX136-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN136))",
    "FR136": "IF(EU136=\"\", \"\", LET(\n  Now, CX136,\n  Next, EU136,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO136),\nFactor/Cost))",
    "FT136": "IF(COLUMN(EW136:FR136) = MIN(IF(EW136:FR136=MAX(EW136:FR136), COLUMN(EW136:FR136))), 1, \"\")",
    "D137": "IF(SUM(FT136:GP136),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F137)),\"Card Mastery\",F137),G137)/$D$5,\"\")",
    "F137": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT136:GP136),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT136:GP136=1)),)\"),\"Damage / Meter\")",
    "G137": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT136:GP136),ARRAYFORMULA(FILTER(BT136:CP136 , FT136:GP136=1)),\"\"\"\")\"),23.0)",
    "I137": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT136:GP136),ARRAYFORMULA(FILTER(EW136:FS136 , FT136:GP136=1))*D$5,\"\"\"\")\"),0.00466177763203043)",
    "K137": "IF(H137<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D137)),)",
    "BT137": "BT136+FT136",
    "BU137": "BU136+FU136",
    "BV137": "BV136+FV136",
    "BW137": "BW136+FW136",
    "BX137": "BX136+FX136",
    "BY137": "BY136+FY136",
    "BZ137": "BZ136+FZ136",
    "CA137": "CA136+GA136",
    "CB137": "CB136+GB136",
    "CC137": "CC136+GC136",
    "CD137": "CD136+GD136",
    "CE137": "CE136+GE136",
    "CF137": "CF136+GF136",
    "CG137": "CG136+GG136",
    "CH137": "CH136+GH136",
    "CI137": "CI136+GI136",
    "CJ137": "CJ136+GJ136",
    "CK137": "CK136+GK136",
    "CL137": "CL136+GL136",
    "CM137": "CM136+GM136",
    "CN137": "CN136+GN136",
    "CO137": "CO136+GO136",
    "CS137": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI137,1)",
    "CT137": "INDEX($BD$5:$BD282,BT137)",
    "CU137": "INDEX($BN$5:$BN282,CD137)",
    "CV137": "INDEX($BO$5:$BO282,CE137)",
    "CW137": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG137)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX137": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO137, 1)",
    "CY137": "LET(\n  Base, $CR$6,\n  Damage, $CT137,\n  DamageMastery, $CS137,\n  DemonMastery, $CX137,\n  SPB, $CU137,\n  ITO, $CV137,\n  Shock, $CW137,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ137": "MIN(100%, DA137)",
    "DA137": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK137*1%, 0)",
    "DB137": "LET(\n  Lab, 1+INDEX($BF$5:$BF282,BV137),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC137": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK137*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI282,BY137) + CardCritMastery)",
    "DD137": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK137*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ282,BZ137) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE137": "LET(\n  CF, $DB137,\n  CC, $CZ137,\n  SCM, $DD137,\n  SCC, $DC137,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF137": "LET(\n  CF, $DB137,\n  CC, $DA137,\n  SCM, $DD137,\n  SCC, $DC137,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG137": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH137)), 0)",
    "DH137": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ137*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE282,BU137),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI137": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG282, BW137), 1) + $AE$9)",
    "DJ137": "LET(\n  DpmLab, INDEX($BH$5:$BH282,BX137),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL137, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK137": "(1+$DI137*$DJ137*$AQ$9)",
    "DL137": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK282,CA137),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM137*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM137": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK282,CA137),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM137*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN137": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL282,CB137)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO137": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH137,\n  Rapid, DG137,\n  RDPM, DK137,\n  SuperTower, $DL137,\n  Rend, $DN137,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP137": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ137": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK137),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR137": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP137),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF137-1))",
    "DS137": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG137, DH137),0))",
    "DT137": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP137),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV137, $AR$29), 0))",
    "DU137": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK137),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM282,CC137), $DV137, $AR$29), 0))",
    "DV137": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH137), $AO$29)",
    "DW137": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM137,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137, $DB137), 1),\n\n  DW, $DR137,\n  CL, $DS137,\n  SM, $DT137,\n  SLM, $DU137,\n  SL, $DQ137,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX137": "CY137*(DE137*DO137*DQ137+DW137*DF137)",
    "DZ137": "IF(INDEX($BD$6:$BD282,BT137)=\"\", \"\", INDEX($BD$5:$BD282,BT137+1))",
    "EA137": "IF(OR($AO$25, INDEX($BE$6:$BE282,BU137)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ137)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE282,BU137+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI137*$DJ137*$AQ$9),\n  SuperTower, $DL137,\n  Rend, $DN137,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137, $DB137), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR137,\n  SM, $DT137,\n  SLM, $DU137,\n  SL, $DQ137,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM137, UltCritCard),\n\nCY137*(DE137*OtherDamage*SL+UwDamage*DF137)))",
    "EB137": "IF(INDEX($BF$6:$BF282,BV137)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF282,BV137+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ137,\n  CCUW, $DA137,\n  SCM, $DD137,\n  SCC, $DC137,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137, CF), 1),\n\n  DW, $DR137,\n  CL, $DS137,\n  SM, $DT137,\n  SLM, $DU137,\n  SL, $DQ137,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM137, UltCritCard),\n\nCY137 * (Critical * DO137 * SL + UwDamage * UWCritical)))",
    "EC137": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG282,BW137)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH137,\n  Rapid, DG137,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG282, BW137+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ137*$AQ$9),\n  SuperTower, $DL137,\n  Rend, $DN137,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM282,CC137), $DV137, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM137,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137, $DB137), 1),\n\n  DW, $DR137,\n  CL, $DS137,\n  SM, $DT137,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY137*(DE137*OtherDamage*SL+UWDamage*DF137)))",
    "ED137": "IF(OR($AO$25, INDEX($BH$6:$BH282,BX137)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH282,BX137+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL137, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI137*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM282,CC137), $DV137, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH137,\n  Rapid, DG137,\n  SuperTower, $DL137,\n  Rend, $DN137,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM137,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137, $DB137), 1),\n\n  DW, $DR137,\n  CL, $DS137,\n  SM, $DT137,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY137*(DE137*OtherDamage*SL+UWDamage*DF137)))",
    "EE137": "IF(INDEX($BI$6:$BI282,BY137)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK137, 0),\n  CF, $DB137,\n  CC, $CZ137,\n  CCUW, $DA137,\n  SCM, $DD137,\n  SCC, $AV$17+INDEX($BI$5:$BI282,BY137+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY137 * (Critical*DO137*$DQ137+DW137*UWCritical)))",
    "EF137": "IF(INDEX($BJ$6:$BJ282,BZ137)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK137*1%, 1),\n  CF, $DB137,\n  CC, $CZ137,\n  CCUW, $DA137,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ282,BZ137+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC137,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY137*(Critical*DO137*$DQ137+DW137*UWCritical)))",
    "EG137": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK282,CA137)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH137,\n  Rapid, DG137,\n  DPM, (1+$DI137*$DJ137*$AQ$9),\n  Rend, $DN137,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK282,CA137+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM137*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137, $DB137), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK282,CA137+1)-1))/(45-CM137*3),1),\n\n  SL, $DQ137,\n  DW, $DR137,\n  CL, $DS137,\n  SM, $DT137,\n  SLM, $DU137,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY137*(DE137*OtherDamage*SL+UwDamage*DF137)))",
    "EH137": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL282,CB137+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL282,CB137)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH137,\n  Rapid, DG137,\n  DPM, (1+$DI137*$DJ137*$AQ$9),\n  SuperTower, $DL137,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL282,CB137+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY137*(DE137*OtherDamage*$DQ137+DW137*DF137)))",
    "EI137": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM282,CC137)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137, $DB137), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK137),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV137, $AR$29), 0),\n\n  DW, $DR137,\n  CL, $DS137,\n  SM, $DT137,\n  SL, $DQ137,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM137, UltCritCard),\nCY137*(DE137*DO137*SL+UwDamage*DF137)))",
    "EJ137": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN282,CD137)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT137,\n  DamageMastery, $CS137,\n  DemonMastery, $CX137,\n  SPB, INDEX($BN$5:$BN282,CD137+1),\n  ITO, $CV137,\n  Shock, $CW137,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE137*DO137*$DQ137+DW137*DF137)))",
    "EK137": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO282,CE137)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT137,\n  DamageMastery, $CS137,\n  DemonMastery, $CX137,\n  SPB, $CU137,\n  ITO, INDEX($BO$5:$BO282,CE137+1),\n  Shock, $CW137,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE137*DO137*$DQ137+DW137*DF137)))",
    "EL137": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP282,CF137)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137, $DB137), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP137),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF137),\n  CL, $DS137,\n  SM, $DT137,\n  SLM, $DU137,\n  SL, $DQ137,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM137, UltCritCard),\nCY137*(DE137*DO137*SL+UwDamage*DF137)))",
    "EM137": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ282,CG137)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG137+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN137": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR282,CH137)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137, $DB137), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH137+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP137),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK137),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM282,CC137), SMHeat, $AR$29), 0),\n\n  DW, $DR137,\n  CL, $DS137,\n  SL, $DQ137,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM137, UltCritCard),\nCY137*(DE137*DO137*SL+UwDamage*DF137)))",
    "EO137": "IF(OR(CI137 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI137+1))",
    "EP137": "IF(OR($AO$25, CJ137 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ137+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE281,BU137),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL137, 1),\n  DPM, (1+$DI137*CardRangeMastery*$DJ137*$AQ$9),\n  SuperTower, $DL137,\n  Rend, $DN137,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137, $DB137), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR137,\n  SM, $DT137,\n  SLM, $DU137,\n  SL, $DQ137,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM137, UltCritCard),\n\nCY137*(DE137*OtherDamage*SL+UwDamage*DF137)))",
    "EQ137": "IF(OR(CK137 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK137+1)*1%, 1),\n  CF, $DB137,\n  CC, MIN(100%, $CZ137 + 1%),\n  CCUW, DA137 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ282,BZ137) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC137 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR137,\n  CL, $DS137,\n  SM, $DT137,\n  SLM, $DU137,\n  SL, $DQ137,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM137, UltCritCard),\n\nCY137 * (Critical*DO137*SL+UwDamage*UWCritical)))",
    "ER137": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL137 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH282,BX137),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL137+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI137*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM282,CC137), $DV137, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH137,\n  Rapid, DG137,\n  SuperTower, $DL137,\n  Rend, $DN137,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM137,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137, $DB137), 1),\n\n  DW, $DR137,\n  CL, $DS137,\n  SM, $DT137,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY137*(DE137*OtherDamage*SL+UWDamage*DF137)))",
    "ES137": "IF(OR(CM137 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH137,\n  Rapid, DG137,\n  RDPM, (1+$DI137*$DJ137*$AQ$9),\n  Rend, $DN137,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK282,CA137),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM137+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137, $DB137), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR137,\n  CL, $DS137,\n  SM, $DT137,\n  SLM, $DU137,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY137*(DE137*OtherDamage*SL+UwDamage*DF137)))",
    "ET137": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN137 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM137,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN137+1, $DB137), 1),\n\n  DW, $DR137,\n  CL, $DS137,\n  SM, $DT137,\n  SLM, $DU137,\n  SL, $DQ137,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY137*(DE137*DO137*SL+UWDamage*DF137)))",
    "EU137": "IF(OR(NOT($BA$3), NOT($BA$23), $CO137 > $BA$15), \"\", 1 + 0.5*(CO137+1))",
    "EW137": "IF(DZ137=\"\", \"\", LET(\n  Now, CT137,\n  Next, DZ137,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT137),\nFactor/Cost))",
    "EX137": "IF(EA137=\"\",\"\",(EA137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU137))",
    "EY137": "IF(EB137=\"\",\"\",(EB137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV137))",
    "EZ137": "IF(EC137=\"\",\"\",(EC137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW137))",
    "FA137": "IF(ED137=\"\",\"\",(ED137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX137))",
    "FB137": "IF(EE137=\"\",\"\",(EE137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY137))",
    "FC137": "IF(EF137=\"\",\"\",(EF137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ137))",
    "FD137": "IF(EG137=\"\",\"\",(EG137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA137))",
    "FE137": "IF(EH137=\"\",\"\",(EH137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB137))",
    "FF137": "IF(EI137=\"\",\"\",(EI137/$DX137-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC137+1, 1, CC137))))",
    "FG137": "IF(EJ137=\"\",\"\",(EJ137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD137))",
    "FH137": "IF(EK137=\"\",\"\",(EK137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE137))",
    "FI137": "IF(EL137=\"\",\"\",(EL137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF137))",
    "FJ137": "IF(EM137=\"\", \"\", LET(\n  Now, CW137,\n  Next, EM137,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG137),\nFactor/Cost))",
    "FK137": "IF(EN137=\"\",\"\",(EN137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH137))",
    "FL137": "IF(EO137=\"\", \"\", LET(\n  Now, CS137,\n  Next, EO137,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI137),\nFactor/Cost))",
    "FM137": "IF(EP137=\"\",\"\",(EP137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ137))",
    "FN137": "IF(EQ137=\"\",\"\",(EQ137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK137))",
    "FO137": "IF(ER137=\"\",\"\",(ER137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL137))",
    "FP137": "IF(ES137=\"\",\"\",(ES137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM137))",
    "FQ137": "IF(ET137=\"\",\"\",(ET137/$DX137-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN137))",
    "FR137": "IF(EU137=\"\", \"\", LET(\n  Now, CX137,\n  Next, EU137,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO137),\nFactor/Cost))",
    "FT137": "IF(COLUMN(EW137:FR137) = MIN(IF(EW137:FR137=MAX(EW137:FR137), COLUMN(EW137:FR137))), 1, \"\")",
    "D138": "IF(SUM(FT137:GP137),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F138)),\"Card Mastery\",F138),G138)/$D$5,\"\")",
    "F138": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT137:GP137),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT137:GP137=1)),)\"),\"Damage\")",
    "G138": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT137:GP137),ARRAYFORMULA(FILTER(BT137:CP137 , FT137:GP137=1)),\"\"\"\")\"),30.0)",
    "I138": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT137:GP137),ARRAYFORMULA(FILTER(EW137:FS137 , FT137:GP137=1))*D$5,\"\"\"\")\"),0.004652334890573232)",
    "K138": "IF(H138<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D138)),)",
    "BT138": "BT137+FT137",
    "BU138": "BU137+FU137",
    "BV138": "BV137+FV137",
    "BW138": "BW137+FW137",
    "BX138": "BX137+FX137",
    "BY138": "BY137+FY137",
    "BZ138": "BZ137+FZ137",
    "CA138": "CA137+GA137",
    "CB138": "CB137+GB137",
    "CC138": "CC137+GC137",
    "CD138": "CD137+GD137",
    "CE138": "CE137+GE137",
    "CF138": "CF137+GF137",
    "CG138": "CG137+GG137",
    "CH138": "CH137+GH137",
    "CI138": "CI137+GI137",
    "CJ138": "CJ137+GJ137",
    "CK138": "CK137+GK137",
    "CL138": "CL137+GL137",
    "CM138": "CM137+GM137",
    "CN138": "CN137+GN137",
    "CO138": "CO137+GO137",
    "CS138": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI138,1)",
    "CT138": "INDEX($BD$5:$BD283,BT138)",
    "CU138": "INDEX($BN$5:$BN283,CD138)",
    "CV138": "INDEX($BO$5:$BO283,CE138)",
    "CW138": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG138)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX138": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO138, 1)",
    "CY138": "LET(\n  Base, $CR$6,\n  Damage, $CT138,\n  DamageMastery, $CS138,\n  DemonMastery, $CX138,\n  SPB, $CU138,\n  ITO, $CV138,\n  Shock, $CW138,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ138": "MIN(100%, DA138)",
    "DA138": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK138*1%, 0)",
    "DB138": "LET(\n  Lab, 1+INDEX($BF$5:$BF283,BV138),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC138": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK138*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI283,BY138) + CardCritMastery)",
    "DD138": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK138*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ283,BZ138) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE138": "LET(\n  CF, $DB138,\n  CC, $CZ138,\n  SCM, $DD138,\n  SCC, $DC138,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF138": "LET(\n  CF, $DB138,\n  CC, $DA138,\n  SCM, $DD138,\n  SCC, $DC138,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG138": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH138)), 0)",
    "DH138": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ138*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE283,BU138),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI138": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG283, BW138), 1) + $AE$9)",
    "DJ138": "LET(\n  DpmLab, INDEX($BH$5:$BH283,BX138),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL138, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK138": "(1+$DI138*$DJ138*$AQ$9)",
    "DL138": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK283,CA138),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM138*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM138": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK283,CA138),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM138*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN138": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL283,CB138)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO138": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH138,\n  Rapid, DG138,\n  RDPM, DK138,\n  SuperTower, $DL138,\n  Rend, $DN138,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP138": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ138": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK138),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR138": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP138),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF138-1))",
    "DS138": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG138, DH138),0))",
    "DT138": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP138),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV138, $AR$29), 0))",
    "DU138": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK138),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM283,CC138), $DV138, $AR$29), 0))",
    "DV138": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH138), $AO$29)",
    "DW138": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM138,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138, $DB138), 1),\n\n  DW, $DR138,\n  CL, $DS138,\n  SM, $DT138,\n  SLM, $DU138,\n  SL, $DQ138,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX138": "CY138*(DE138*DO138*DQ138+DW138*DF138)",
    "DZ138": "IF(INDEX($BD$6:$BD283,BT138)=\"\", \"\", INDEX($BD$5:$BD283,BT138+1))",
    "EA138": "IF(OR($AO$25, INDEX($BE$6:$BE283,BU138)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ138)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE283,BU138+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI138*$DJ138*$AQ$9),\n  SuperTower, $DL138,\n  Rend, $DN138,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138, $DB138), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR138,\n  SM, $DT138,\n  SLM, $DU138,\n  SL, $DQ138,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM138, UltCritCard),\n\nCY138*(DE138*OtherDamage*SL+UwDamage*DF138)))",
    "EB138": "IF(INDEX($BF$6:$BF283,BV138)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF283,BV138+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ138,\n  CCUW, $DA138,\n  SCM, $DD138,\n  SCC, $DC138,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138, CF), 1),\n\n  DW, $DR138,\n  CL, $DS138,\n  SM, $DT138,\n  SLM, $DU138,\n  SL, $DQ138,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM138, UltCritCard),\n\nCY138 * (Critical * DO138 * SL + UwDamage * UWCritical)))",
    "EC138": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG283,BW138)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH138,\n  Rapid, DG138,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG283, BW138+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ138*$AQ$9),\n  SuperTower, $DL138,\n  Rend, $DN138,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM283,CC138), $DV138, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM138,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138, $DB138), 1),\n\n  DW, $DR138,\n  CL, $DS138,\n  SM, $DT138,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY138*(DE138*OtherDamage*SL+UWDamage*DF138)))",
    "ED138": "IF(OR($AO$25, INDEX($BH$6:$BH283,BX138)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH283,BX138+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL138, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI138*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM283,CC138), $DV138, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH138,\n  Rapid, DG138,\n  SuperTower, $DL138,\n  Rend, $DN138,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM138,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138, $DB138), 1),\n\n  DW, $DR138,\n  CL, $DS138,\n  SM, $DT138,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY138*(DE138*OtherDamage*SL+UWDamage*DF138)))",
    "EE138": "IF(INDEX($BI$6:$BI283,BY138)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK138, 0),\n  CF, $DB138,\n  CC, $CZ138,\n  CCUW, $DA138,\n  SCM, $DD138,\n  SCC, $AV$17+INDEX($BI$5:$BI283,BY138+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY138 * (Critical*DO138*$DQ138+DW138*UWCritical)))",
    "EF138": "IF(INDEX($BJ$6:$BJ283,BZ138)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK138*1%, 1),\n  CF, $DB138,\n  CC, $CZ138,\n  CCUW, $DA138,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ283,BZ138+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC138,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY138*(Critical*DO138*$DQ138+DW138*UWCritical)))",
    "EG138": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK283,CA138)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH138,\n  Rapid, DG138,\n  DPM, (1+$DI138*$DJ138*$AQ$9),\n  Rend, $DN138,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK283,CA138+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM138*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138, $DB138), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK283,CA138+1)-1))/(45-CM138*3),1),\n\n  SL, $DQ138,\n  DW, $DR138,\n  CL, $DS138,\n  SM, $DT138,\n  SLM, $DU138,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY138*(DE138*OtherDamage*SL+UwDamage*DF138)))",
    "EH138": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL283,CB138+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL283,CB138)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH138,\n  Rapid, DG138,\n  DPM, (1+$DI138*$DJ138*$AQ$9),\n  SuperTower, $DL138,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL283,CB138+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY138*(DE138*OtherDamage*$DQ138+DW138*DF138)))",
    "EI138": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM283,CC138)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138, $DB138), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK138),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV138, $AR$29), 0),\n\n  DW, $DR138,\n  CL, $DS138,\n  SM, $DT138,\n  SL, $DQ138,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM138, UltCritCard),\nCY138*(DE138*DO138*SL+UwDamage*DF138)))",
    "EJ138": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN283,CD138)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT138,\n  DamageMastery, $CS138,\n  DemonMastery, $CX138,\n  SPB, INDEX($BN$5:$BN283,CD138+1),\n  ITO, $CV138,\n  Shock, $CW138,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE138*DO138*$DQ138+DW138*DF138)))",
    "EK138": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO283,CE138)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT138,\n  DamageMastery, $CS138,\n  DemonMastery, $CX138,\n  SPB, $CU138,\n  ITO, INDEX($BO$5:$BO283,CE138+1),\n  Shock, $CW138,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE138*DO138*$DQ138+DW138*DF138)))",
    "EL138": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP283,CF138)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138, $DB138), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP138),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF138),\n  CL, $DS138,\n  SM, $DT138,\n  SLM, $DU138,\n  SL, $DQ138,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM138, UltCritCard),\nCY138*(DE138*DO138*SL+UwDamage*DF138)))",
    "EM138": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ283,CG138)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG138+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN138": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR283,CH138)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138, $DB138), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH138+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP138),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK138),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM283,CC138), SMHeat, $AR$29), 0),\n\n  DW, $DR138,\n  CL, $DS138,\n  SL, $DQ138,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM138, UltCritCard),\nCY138*(DE138*DO138*SL+UwDamage*DF138)))",
    "EO138": "IF(OR(CI138 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI138+1))",
    "EP138": "IF(OR($AO$25, CJ138 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ138+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE282,BU138),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL138, 1),\n  DPM, (1+$DI138*CardRangeMastery*$DJ138*$AQ$9),\n  SuperTower, $DL138,\n  Rend, $DN138,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138, $DB138), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR138,\n  SM, $DT138,\n  SLM, $DU138,\n  SL, $DQ138,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM138, UltCritCard),\n\nCY138*(DE138*OtherDamage*SL+UwDamage*DF138)))",
    "EQ138": "IF(OR(CK138 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK138+1)*1%, 1),\n  CF, $DB138,\n  CC, MIN(100%, $CZ138 + 1%),\n  CCUW, DA138 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ283,BZ138) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC138 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR138,\n  CL, $DS138,\n  SM, $DT138,\n  SLM, $DU138,\n  SL, $DQ138,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM138, UltCritCard),\n\nCY138 * (Critical*DO138*SL+UwDamage*UWCritical)))",
    "ER138": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL138 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH283,BX138),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL138+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI138*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM283,CC138), $DV138, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH138,\n  Rapid, DG138,\n  SuperTower, $DL138,\n  Rend, $DN138,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM138,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138, $DB138), 1),\n\n  DW, $DR138,\n  CL, $DS138,\n  SM, $DT138,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY138*(DE138*OtherDamage*SL+UWDamage*DF138)))",
    "ES138": "IF(OR(CM138 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH138,\n  Rapid, DG138,\n  RDPM, (1+$DI138*$DJ138*$AQ$9),\n  Rend, $DN138,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK283,CA138),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM138+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138, $DB138), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR138,\n  CL, $DS138,\n  SM, $DT138,\n  SLM, $DU138,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY138*(DE138*OtherDamage*SL+UwDamage*DF138)))",
    "ET138": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN138 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM138,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN138+1, $DB138), 1),\n\n  DW, $DR138,\n  CL, $DS138,\n  SM, $DT138,\n  SLM, $DU138,\n  SL, $DQ138,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY138*(DE138*DO138*SL+UWDamage*DF138)))",
    "EU138": "IF(OR(NOT($BA$3), NOT($BA$23), $CO138 > $BA$15), \"\", 1 + 0.5*(CO138+1))",
    "EW138": "IF(DZ138=\"\", \"\", LET(\n  Now, CT138,\n  Next, DZ138,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT138),\nFactor/Cost))",
    "EX138": "IF(EA138=\"\",\"\",(EA138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU138))",
    "EY138": "IF(EB138=\"\",\"\",(EB138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV138))",
    "EZ138": "IF(EC138=\"\",\"\",(EC138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW138))",
    "FA138": "IF(ED138=\"\",\"\",(ED138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX138))",
    "FB138": "IF(EE138=\"\",\"\",(EE138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY138))",
    "FC138": "IF(EF138=\"\",\"\",(EF138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ138))",
    "FD138": "IF(EG138=\"\",\"\",(EG138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA138))",
    "FE138": "IF(EH138=\"\",\"\",(EH138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB138))",
    "FF138": "IF(EI138=\"\",\"\",(EI138/$DX138-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC138+1, 1, CC138))))",
    "FG138": "IF(EJ138=\"\",\"\",(EJ138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD138))",
    "FH138": "IF(EK138=\"\",\"\",(EK138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE138))",
    "FI138": "IF(EL138=\"\",\"\",(EL138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF138))",
    "FJ138": "IF(EM138=\"\", \"\", LET(\n  Now, CW138,\n  Next, EM138,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG138),\nFactor/Cost))",
    "FK138": "IF(EN138=\"\",\"\",(EN138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH138))",
    "FL138": "IF(EO138=\"\", \"\", LET(\n  Now, CS138,\n  Next, EO138,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI138),\nFactor/Cost))",
    "FM138": "IF(EP138=\"\",\"\",(EP138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ138))",
    "FN138": "IF(EQ138=\"\",\"\",(EQ138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK138))",
    "FO138": "IF(ER138=\"\",\"\",(ER138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL138))",
    "FP138": "IF(ES138=\"\",\"\",(ES138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM138))",
    "FQ138": "IF(ET138=\"\",\"\",(ET138/$DX138-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN138))",
    "FR138": "IF(EU138=\"\", \"\", LET(\n  Now, CX138,\n  Next, EU138,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO138),\nFactor/Cost))",
    "FT138": "IF(COLUMN(EW138:FR138) = MIN(IF(EW138:FR138=MAX(EW138:FR138), COLUMN(EW138:FR138))), 1, \"\")",
    "D139": "IF(SUM(FT138:GP138),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F139)),\"Card Mastery\",F139),G139)/$D$5,\"\")",
    "F139": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT138:GP138),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT138:GP138=1)),)\"),\"Attack Speed\")",
    "G139": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT138:GP138),ARRAYFORMULA(FILTER(BT138:CP138 , FT138:GP138=1)),\"\"\"\")\"),30.0)",
    "I139": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT138:GP138),ARRAYFORMULA(FILTER(EW138:FS138 , FT138:GP138=1))*D$5,\"\"\"\")\"),0.0045538808644191775)",
    "K139": "IF(H139<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D139)),)",
    "BT139": "BT138+FT138",
    "BU139": "BU138+FU138",
    "BV139": "BV138+FV138",
    "BW139": "BW138+FW138",
    "BX139": "BX138+FX138",
    "BY139": "BY138+FY138",
    "BZ139": "BZ138+FZ138",
    "CA139": "CA138+GA138",
    "CB139": "CB138+GB138",
    "CC139": "CC138+GC138",
    "CD139": "CD138+GD138",
    "CE139": "CE138+GE138",
    "CF139": "CF138+GF138",
    "CG139": "CG138+GG138",
    "CH139": "CH138+GH138",
    "CI139": "CI138+GI138",
    "CJ139": "CJ138+GJ138",
    "CK139": "CK138+GK138",
    "CL139": "CL138+GL138",
    "CM139": "CM138+GM138",
    "CN139": "CN138+GN138",
    "CO139": "CO138+GO138",
    "CS139": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI139,1)",
    "CT139": "INDEX($BD$5:$BD284,BT139)",
    "CU139": "INDEX($BN$5:$BN284,CD139)",
    "CV139": "INDEX($BO$5:$BO284,CE139)",
    "CW139": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG139)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX139": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO139, 1)",
    "CY139": "LET(\n  Base, $CR$6,\n  Damage, $CT139,\n  DamageMastery, $CS139,\n  DemonMastery, $CX139,\n  SPB, $CU139,\n  ITO, $CV139,\n  Shock, $CW139,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ139": "MIN(100%, DA139)",
    "DA139": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK139*1%, 0)",
    "DB139": "LET(\n  Lab, 1+INDEX($BF$5:$BF284,BV139),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC139": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK139*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI284,BY139) + CardCritMastery)",
    "DD139": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK139*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ284,BZ139) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE139": "LET(\n  CF, $DB139,\n  CC, $CZ139,\n  SCM, $DD139,\n  SCC, $DC139,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF139": "LET(\n  CF, $DB139,\n  CC, $DA139,\n  SCM, $DD139,\n  SCC, $DC139,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG139": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH139)), 0)",
    "DH139": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ139*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE284,BU139),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI139": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG284, BW139), 1) + $AE$9)",
    "DJ139": "LET(\n  DpmLab, INDEX($BH$5:$BH284,BX139),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL139, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK139": "(1+$DI139*$DJ139*$AQ$9)",
    "DL139": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK284,CA139),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM139*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM139": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK284,CA139),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM139*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN139": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL284,CB139)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO139": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH139,\n  Rapid, DG139,\n  RDPM, DK139,\n  SuperTower, $DL139,\n  Rend, $DN139,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP139": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ139": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK139),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR139": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP139),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF139-1))",
    "DS139": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG139, DH139),0))",
    "DT139": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP139),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV139, $AR$29), 0))",
    "DU139": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK139),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM284,CC139), $DV139, $AR$29), 0))",
    "DV139": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH139), $AO$29)",
    "DW139": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM139,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139, $DB139), 1),\n\n  DW, $DR139,\n  CL, $DS139,\n  SM, $DT139,\n  SLM, $DU139,\n  SL, $DQ139,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX139": "CY139*(DE139*DO139*DQ139+DW139*DF139)",
    "DZ139": "IF(INDEX($BD$6:$BD284,BT139)=\"\", \"\", INDEX($BD$5:$BD284,BT139+1))",
    "EA139": "IF(OR($AO$25, INDEX($BE$6:$BE284,BU139)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ139)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE284,BU139+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI139*$DJ139*$AQ$9),\n  SuperTower, $DL139,\n  Rend, $DN139,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139, $DB139), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR139,\n  SM, $DT139,\n  SLM, $DU139,\n  SL, $DQ139,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM139, UltCritCard),\n\nCY139*(DE139*OtherDamage*SL+UwDamage*DF139)))",
    "EB139": "IF(INDEX($BF$6:$BF284,BV139)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF284,BV139+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ139,\n  CCUW, $DA139,\n  SCM, $DD139,\n  SCC, $DC139,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139, CF), 1),\n\n  DW, $DR139,\n  CL, $DS139,\n  SM, $DT139,\n  SLM, $DU139,\n  SL, $DQ139,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM139, UltCritCard),\n\nCY139 * (Critical * DO139 * SL + UwDamage * UWCritical)))",
    "EC139": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG284,BW139)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH139,\n  Rapid, DG139,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG284, BW139+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ139*$AQ$9),\n  SuperTower, $DL139,\n  Rend, $DN139,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM284,CC139), $DV139, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM139,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139, $DB139), 1),\n\n  DW, $DR139,\n  CL, $DS139,\n  SM, $DT139,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY139*(DE139*OtherDamage*SL+UWDamage*DF139)))",
    "ED139": "IF(OR($AO$25, INDEX($BH$6:$BH284,BX139)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH284,BX139+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL139, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI139*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM284,CC139), $DV139, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH139,\n  Rapid, DG139,\n  SuperTower, $DL139,\n  Rend, $DN139,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM139,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139, $DB139), 1),\n\n  DW, $DR139,\n  CL, $DS139,\n  SM, $DT139,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY139*(DE139*OtherDamage*SL+UWDamage*DF139)))",
    "EE139": "IF(INDEX($BI$6:$BI284,BY139)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK139, 0),\n  CF, $DB139,\n  CC, $CZ139,\n  CCUW, $DA139,\n  SCM, $DD139,\n  SCC, $AV$17+INDEX($BI$5:$BI284,BY139+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY139 * (Critical*DO139*$DQ139+DW139*UWCritical)))",
    "EF139": "IF(INDEX($BJ$6:$BJ284,BZ139)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK139*1%, 1),\n  CF, $DB139,\n  CC, $CZ139,\n  CCUW, $DA139,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ284,BZ139+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC139,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY139*(Critical*DO139*$DQ139+DW139*UWCritical)))",
    "EG139": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK284,CA139)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH139,\n  Rapid, DG139,\n  DPM, (1+$DI139*$DJ139*$AQ$9),\n  Rend, $DN139,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK284,CA139+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM139*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139, $DB139), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK284,CA139+1)-1))/(45-CM139*3),1),\n\n  SL, $DQ139,\n  DW, $DR139,\n  CL, $DS139,\n  SM, $DT139,\n  SLM, $DU139,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY139*(DE139*OtherDamage*SL+UwDamage*DF139)))",
    "EH139": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL284,CB139+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL284,CB139)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH139,\n  Rapid, DG139,\n  DPM, (1+$DI139*$DJ139*$AQ$9),\n  SuperTower, $DL139,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL284,CB139+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY139*(DE139*OtherDamage*$DQ139+DW139*DF139)))",
    "EI139": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM284,CC139)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139, $DB139), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK139),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV139, $AR$29), 0),\n\n  DW, $DR139,\n  CL, $DS139,\n  SM, $DT139,\n  SL, $DQ139,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM139, UltCritCard),\nCY139*(DE139*DO139*SL+UwDamage*DF139)))",
    "EJ139": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN284,CD139)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT139,\n  DamageMastery, $CS139,\n  DemonMastery, $CX139,\n  SPB, INDEX($BN$5:$BN284,CD139+1),\n  ITO, $CV139,\n  Shock, $CW139,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE139*DO139*$DQ139+DW139*DF139)))",
    "EK139": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO284,CE139)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT139,\n  DamageMastery, $CS139,\n  DemonMastery, $CX139,\n  SPB, $CU139,\n  ITO, INDEX($BO$5:$BO284,CE139+1),\n  Shock, $CW139,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE139*DO139*$DQ139+DW139*DF139)))",
    "EL139": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP284,CF139)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139, $DB139), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP139),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF139),\n  CL, $DS139,\n  SM, $DT139,\n  SLM, $DU139,\n  SL, $DQ139,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM139, UltCritCard),\nCY139*(DE139*DO139*SL+UwDamage*DF139)))",
    "EM139": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ284,CG139)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG139+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN139": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR284,CH139)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139, $DB139), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH139+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP139),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK139),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM284,CC139), SMHeat, $AR$29), 0),\n\n  DW, $DR139,\n  CL, $DS139,\n  SL, $DQ139,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM139, UltCritCard),\nCY139*(DE139*DO139*SL+UwDamage*DF139)))",
    "EO139": "IF(OR(CI139 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI139+1))",
    "EP139": "IF(OR($AO$25, CJ139 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ139+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE283,BU139),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL139, 1),\n  DPM, (1+$DI139*CardRangeMastery*$DJ139*$AQ$9),\n  SuperTower, $DL139,\n  Rend, $DN139,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139, $DB139), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR139,\n  SM, $DT139,\n  SLM, $DU139,\n  SL, $DQ139,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM139, UltCritCard),\n\nCY139*(DE139*OtherDamage*SL+UwDamage*DF139)))",
    "EQ139": "IF(OR(CK139 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK139+1)*1%, 1),\n  CF, $DB139,\n  CC, MIN(100%, $CZ139 + 1%),\n  CCUW, DA139 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ284,BZ139) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC139 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR139,\n  CL, $DS139,\n  SM, $DT139,\n  SLM, $DU139,\n  SL, $DQ139,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM139, UltCritCard),\n\nCY139 * (Critical*DO139*SL+UwDamage*UWCritical)))",
    "ER139": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL139 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH284,BX139),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL139+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI139*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM284,CC139), $DV139, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH139,\n  Rapid, DG139,\n  SuperTower, $DL139,\n  Rend, $DN139,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM139,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139, $DB139), 1),\n\n  DW, $DR139,\n  CL, $DS139,\n  SM, $DT139,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY139*(DE139*OtherDamage*SL+UWDamage*DF139)))",
    "ES139": "IF(OR(CM139 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH139,\n  Rapid, DG139,\n  RDPM, (1+$DI139*$DJ139*$AQ$9),\n  Rend, $DN139,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK284,CA139),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM139+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139, $DB139), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR139,\n  CL, $DS139,\n  SM, $DT139,\n  SLM, $DU139,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY139*(DE139*OtherDamage*SL+UwDamage*DF139)))",
    "ET139": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN139 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM139,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN139+1, $DB139), 1),\n\n  DW, $DR139,\n  CL, $DS139,\n  SM, $DT139,\n  SLM, $DU139,\n  SL, $DQ139,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY139*(DE139*DO139*SL+UWDamage*DF139)))",
    "EU139": "IF(OR(NOT($BA$3), NOT($BA$23), $CO139 > $BA$15), \"\", 1 + 0.5*(CO139+1))",
    "EW139": "IF(DZ139=\"\", \"\", LET(\n  Now, CT139,\n  Next, DZ139,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT139),\nFactor/Cost))",
    "EX139": "IF(EA139=\"\",\"\",(EA139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU139))",
    "EY139": "IF(EB139=\"\",\"\",(EB139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV139))",
    "EZ139": "IF(EC139=\"\",\"\",(EC139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW139))",
    "FA139": "IF(ED139=\"\",\"\",(ED139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX139))",
    "FB139": "IF(EE139=\"\",\"\",(EE139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY139))",
    "FC139": "IF(EF139=\"\",\"\",(EF139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ139))",
    "FD139": "IF(EG139=\"\",\"\",(EG139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA139))",
    "FE139": "IF(EH139=\"\",\"\",(EH139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB139))",
    "FF139": "IF(EI139=\"\",\"\",(EI139/$DX139-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC139+1, 1, CC139))))",
    "FG139": "IF(EJ139=\"\",\"\",(EJ139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD139))",
    "FH139": "IF(EK139=\"\",\"\",(EK139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE139))",
    "FI139": "IF(EL139=\"\",\"\",(EL139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF139))",
    "FJ139": "IF(EM139=\"\", \"\", LET(\n  Now, CW139,\n  Next, EM139,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG139),\nFactor/Cost))",
    "FK139": "IF(EN139=\"\",\"\",(EN139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH139))",
    "FL139": "IF(EO139=\"\", \"\", LET(\n  Now, CS139,\n  Next, EO139,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI139),\nFactor/Cost))",
    "FM139": "IF(EP139=\"\",\"\",(EP139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ139))",
    "FN139": "IF(EQ139=\"\",\"\",(EQ139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK139))",
    "FO139": "IF(ER139=\"\",\"\",(ER139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL139))",
    "FP139": "IF(ES139=\"\",\"\",(ES139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM139))",
    "FQ139": "IF(ET139=\"\",\"\",(ET139/$DX139-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN139))",
    "FR139": "IF(EU139=\"\", \"\", LET(\n  Now, CX139,\n  Next, EU139,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO139),\nFactor/Cost))",
    "FT139": "IF(COLUMN(EW139:FR139) = MIN(IF(EW139:FR139=MAX(EW139:FR139), COLUMN(EW139:FR139))), 1, \"\")",
    "D140": "IF(SUM(FT139:GP139),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F140)),\"Card Mastery\",F140),G140)/$D$5,\"\")",
    "F140": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT139:GP139),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT139:GP139=1)),)\"),\"Critical Factor\")",
    "G140": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT139:GP139),ARRAYFORMULA(FILTER(BT139:CP139 , FT139:GP139=1)),\"\"\"\")\"),33.0)",
    "I140": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT139:GP139),ARRAYFORMULA(FILTER(EW139:FS139 , FT139:GP139=1))*D$5,\"\"\"\")\"),0.0045061509962441276)",
    "K140": "IF(H140<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D140)),)",
    "BT140": "BT139+FT139",
    "BU140": "BU139+FU139",
    "BV140": "BV139+FV139",
    "BW140": "BW139+FW139",
    "BX140": "BX139+FX139",
    "BY140": "BY139+FY139",
    "BZ140": "BZ139+FZ139",
    "CA140": "CA139+GA139",
    "CB140": "CB139+GB139",
    "CC140": "CC139+GC139",
    "CD140": "CD139+GD139",
    "CE140": "CE139+GE139",
    "CF140": "CF139+GF139",
    "CG140": "CG139+GG139",
    "CH140": "CH139+GH139",
    "CI140": "CI139+GI139",
    "CJ140": "CJ139+GJ139",
    "CK140": "CK139+GK139",
    "CL140": "CL139+GL139",
    "CM140": "CM139+GM139",
    "CN140": "CN139+GN139",
    "CO140": "CO139+GO139",
    "CS140": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI140,1)",
    "CT140": "INDEX($BD$5:$BD285,BT140)",
    "CU140": "INDEX($BN$5:$BN285,CD140)",
    "CV140": "INDEX($BO$5:$BO285,CE140)",
    "CW140": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG140)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX140": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO140, 1)",
    "CY140": "LET(\n  Base, $CR$6,\n  Damage, $CT140,\n  DamageMastery, $CS140,\n  DemonMastery, $CX140,\n  SPB, $CU140,\n  ITO, $CV140,\n  Shock, $CW140,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ140": "MIN(100%, DA140)",
    "DA140": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK140*1%, 0)",
    "DB140": "LET(\n  Lab, 1+INDEX($BF$5:$BF285,BV140),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC140": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK140*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI285,BY140) + CardCritMastery)",
    "DD140": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK140*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ285,BZ140) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE140": "LET(\n  CF, $DB140,\n  CC, $CZ140,\n  SCM, $DD140,\n  SCC, $DC140,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF140": "LET(\n  CF, $DB140,\n  CC, $DA140,\n  SCM, $DD140,\n  SCC, $DC140,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG140": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH140)), 0)",
    "DH140": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ140*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE285,BU140),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI140": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG285, BW140), 1) + $AE$9)",
    "DJ140": "LET(\n  DpmLab, INDEX($BH$5:$BH285,BX140),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL140, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK140": "(1+$DI140*$DJ140*$AQ$9)",
    "DL140": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK285,CA140),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM140*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM140": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK285,CA140),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM140*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN140": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL285,CB140)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO140": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH140,\n  Rapid, DG140,\n  RDPM, DK140,\n  SuperTower, $DL140,\n  Rend, $DN140,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP140": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ140": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK140),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR140": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP140),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF140-1))",
    "DS140": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG140, DH140),0))",
    "DT140": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP140),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV140, $AR$29), 0))",
    "DU140": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK140),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM285,CC140), $DV140, $AR$29), 0))",
    "DV140": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH140), $AO$29)",
    "DW140": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM140,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140, $DB140), 1),\n\n  DW, $DR140,\n  CL, $DS140,\n  SM, $DT140,\n  SLM, $DU140,\n  SL, $DQ140,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX140": "CY140*(DE140*DO140*DQ140+DW140*DF140)",
    "DZ140": "IF(INDEX($BD$6:$BD285,BT140)=\"\", \"\", INDEX($BD$5:$BD285,BT140+1))",
    "EA140": "IF(OR($AO$25, INDEX($BE$6:$BE285,BU140)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ140)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE285,BU140+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI140*$DJ140*$AQ$9),\n  SuperTower, $DL140,\n  Rend, $DN140,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140, $DB140), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR140,\n  SM, $DT140,\n  SLM, $DU140,\n  SL, $DQ140,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM140, UltCritCard),\n\nCY140*(DE140*OtherDamage*SL+UwDamage*DF140)))",
    "EB140": "IF(INDEX($BF$6:$BF285,BV140)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF285,BV140+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ140,\n  CCUW, $DA140,\n  SCM, $DD140,\n  SCC, $DC140,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140, CF), 1),\n\n  DW, $DR140,\n  CL, $DS140,\n  SM, $DT140,\n  SLM, $DU140,\n  SL, $DQ140,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM140, UltCritCard),\n\nCY140 * (Critical * DO140 * SL + UwDamage * UWCritical)))",
    "EC140": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG285,BW140)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH140,\n  Rapid, DG140,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG285, BW140+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ140*$AQ$9),\n  SuperTower, $DL140,\n  Rend, $DN140,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM285,CC140), $DV140, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM140,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140, $DB140), 1),\n\n  DW, $DR140,\n  CL, $DS140,\n  SM, $DT140,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY140*(DE140*OtherDamage*SL+UWDamage*DF140)))",
    "ED140": "IF(OR($AO$25, INDEX($BH$6:$BH285,BX140)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH285,BX140+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL140, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI140*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM285,CC140), $DV140, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH140,\n  Rapid, DG140,\n  SuperTower, $DL140,\n  Rend, $DN140,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM140,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140, $DB140), 1),\n\n  DW, $DR140,\n  CL, $DS140,\n  SM, $DT140,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY140*(DE140*OtherDamage*SL+UWDamage*DF140)))",
    "EE140": "IF(INDEX($BI$6:$BI285,BY140)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK140, 0),\n  CF, $DB140,\n  CC, $CZ140,\n  CCUW, $DA140,\n  SCM, $DD140,\n  SCC, $AV$17+INDEX($BI$5:$BI285,BY140+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY140 * (Critical*DO140*$DQ140+DW140*UWCritical)))",
    "EF140": "IF(INDEX($BJ$6:$BJ285,BZ140)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK140*1%, 1),\n  CF, $DB140,\n  CC, $CZ140,\n  CCUW, $DA140,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ285,BZ140+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC140,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY140*(Critical*DO140*$DQ140+DW140*UWCritical)))",
    "EG140": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK285,CA140)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH140,\n  Rapid, DG140,\n  DPM, (1+$DI140*$DJ140*$AQ$9),\n  Rend, $DN140,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK285,CA140+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM140*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140, $DB140), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK285,CA140+1)-1))/(45-CM140*3),1),\n\n  SL, $DQ140,\n  DW, $DR140,\n  CL, $DS140,\n  SM, $DT140,\n  SLM, $DU140,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY140*(DE140*OtherDamage*SL+UwDamage*DF140)))",
    "EH140": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL285,CB140+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL285,CB140)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH140,\n  Rapid, DG140,\n  DPM, (1+$DI140*$DJ140*$AQ$9),\n  SuperTower, $DL140,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL285,CB140+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY140*(DE140*OtherDamage*$DQ140+DW140*DF140)))",
    "EI140": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM285,CC140)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140, $DB140), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK140),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV140, $AR$29), 0),\n\n  DW, $DR140,\n  CL, $DS140,\n  SM, $DT140,\n  SL, $DQ140,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM140, UltCritCard),\nCY140*(DE140*DO140*SL+UwDamage*DF140)))",
    "EJ140": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN285,CD140)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT140,\n  DamageMastery, $CS140,\n  DemonMastery, $CX140,\n  SPB, INDEX($BN$5:$BN285,CD140+1),\n  ITO, $CV140,\n  Shock, $CW140,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE140*DO140*$DQ140+DW140*DF140)))",
    "EK140": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO285,CE140)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT140,\n  DamageMastery, $CS140,\n  DemonMastery, $CX140,\n  SPB, $CU140,\n  ITO, INDEX($BO$5:$BO285,CE140+1),\n  Shock, $CW140,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE140*DO140*$DQ140+DW140*DF140)))",
    "EL140": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP285,CF140)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140, $DB140), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP140),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF140),\n  CL, $DS140,\n  SM, $DT140,\n  SLM, $DU140,\n  SL, $DQ140,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM140, UltCritCard),\nCY140*(DE140*DO140*SL+UwDamage*DF140)))",
    "EM140": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ285,CG140)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG140+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN140": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR285,CH140)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140, $DB140), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH140+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP140),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK140),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM285,CC140), SMHeat, $AR$29), 0),\n\n  DW, $DR140,\n  CL, $DS140,\n  SL, $DQ140,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM140, UltCritCard),\nCY140*(DE140*DO140*SL+UwDamage*DF140)))",
    "EO140": "IF(OR(CI140 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI140+1))",
    "EP140": "IF(OR($AO$25, CJ140 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ140+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE284,BU140),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL140, 1),\n  DPM, (1+$DI140*CardRangeMastery*$DJ140*$AQ$9),\n  SuperTower, $DL140,\n  Rend, $DN140,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140, $DB140), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR140,\n  SM, $DT140,\n  SLM, $DU140,\n  SL, $DQ140,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM140, UltCritCard),\n\nCY140*(DE140*OtherDamage*SL+UwDamage*DF140)))",
    "EQ140": "IF(OR(CK140 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK140+1)*1%, 1),\n  CF, $DB140,\n  CC, MIN(100%, $CZ140 + 1%),\n  CCUW, DA140 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ285,BZ140) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC140 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR140,\n  CL, $DS140,\n  SM, $DT140,\n  SLM, $DU140,\n  SL, $DQ140,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM140, UltCritCard),\n\nCY140 * (Critical*DO140*SL+UwDamage*UWCritical)))",
    "ER140": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL140 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH285,BX140),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL140+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI140*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM285,CC140), $DV140, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH140,\n  Rapid, DG140,\n  SuperTower, $DL140,\n  Rend, $DN140,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM140,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140, $DB140), 1),\n\n  DW, $DR140,\n  CL, $DS140,\n  SM, $DT140,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY140*(DE140*OtherDamage*SL+UWDamage*DF140)))",
    "ES140": "IF(OR(CM140 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH140,\n  Rapid, DG140,\n  RDPM, (1+$DI140*$DJ140*$AQ$9),\n  Rend, $DN140,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK285,CA140),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM140+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140, $DB140), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR140,\n  CL, $DS140,\n  SM, $DT140,\n  SLM, $DU140,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY140*(DE140*OtherDamage*SL+UwDamage*DF140)))",
    "ET140": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN140 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM140,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN140+1, $DB140), 1),\n\n  DW, $DR140,\n  CL, $DS140,\n  SM, $DT140,\n  SLM, $DU140,\n  SL, $DQ140,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY140*(DE140*DO140*SL+UWDamage*DF140)))",
    "EU140": "IF(OR(NOT($BA$3), NOT($BA$23), $CO140 > $BA$15), \"\", 1 + 0.5*(CO140+1))",
    "EW140": "IF(DZ140=\"\", \"\", LET(\n  Now, CT140,\n  Next, DZ140,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT140),\nFactor/Cost))",
    "EX140": "IF(EA140=\"\",\"\",(EA140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU140))",
    "EY140": "IF(EB140=\"\",\"\",(EB140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV140))",
    "EZ140": "IF(EC140=\"\",\"\",(EC140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW140))",
    "FA140": "IF(ED140=\"\",\"\",(ED140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX140))",
    "FB140": "IF(EE140=\"\",\"\",(EE140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY140))",
    "FC140": "IF(EF140=\"\",\"\",(EF140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ140))",
    "FD140": "IF(EG140=\"\",\"\",(EG140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA140))",
    "FE140": "IF(EH140=\"\",\"\",(EH140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB140))",
    "FF140": "IF(EI140=\"\",\"\",(EI140/$DX140-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC140+1, 1, CC140))))",
    "FG140": "IF(EJ140=\"\",\"\",(EJ140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD140))",
    "FH140": "IF(EK140=\"\",\"\",(EK140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE140))",
    "FI140": "IF(EL140=\"\",\"\",(EL140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF140))",
    "FJ140": "IF(EM140=\"\", \"\", LET(\n  Now, CW140,\n  Next, EM140,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG140),\nFactor/Cost))",
    "FK140": "IF(EN140=\"\",\"\",(EN140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH140))",
    "FL140": "IF(EO140=\"\", \"\", LET(\n  Now, CS140,\n  Next, EO140,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI140),\nFactor/Cost))",
    "FM140": "IF(EP140=\"\",\"\",(EP140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ140))",
    "FN140": "IF(EQ140=\"\",\"\",(EQ140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK140))",
    "FO140": "IF(ER140=\"\",\"\",(ER140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL140))",
    "FP140": "IF(ES140=\"\",\"\",(ES140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM140))",
    "FQ140": "IF(ET140=\"\",\"\",(ET140/$DX140-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN140))",
    "FR140": "IF(EU140=\"\", \"\", LET(\n  Now, CX140,\n  Next, EU140,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO140),\nFactor/Cost))",
    "FT140": "IF(COLUMN(EW140:FR140) = MIN(IF(EW140:FR140=MAX(EW140:FR140), COLUMN(EW140:FR140))), 1, \"\")",
    "D141": "IF(SUM(FT140:GP140),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F141)),\"Card Mastery\",F141),G141)/$D$5,\"\")",
    "F141": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT140:GP140),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT140:GP140=1)),)\"),\"Improve Trade-off Perks\")",
    "G141": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT140:GP140),ARRAYFORMULA(FILTER(BT140:CP140 , FT140:GP140=1)),\"\"\"\")\"),3.0)",
    "I141": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT140:GP140),ARRAYFORMULA(FILTER(EW140:FS140 , FT140:GP140=1))*D$5,\"\"\"\")\"),0.004439511653718075)",
    "K141": "IF(H141<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D141)),)",
    "BT141": "BT140+FT140",
    "BU141": "BU140+FU140",
    "BV141": "BV140+FV140",
    "BW141": "BW140+FW140",
    "BX141": "BX140+FX140",
    "BY141": "BY140+FY140",
    "BZ141": "BZ140+FZ140",
    "CA141": "CA140+GA140",
    "CB141": "CB140+GB140",
    "CC141": "CC140+GC140",
    "CD141": "CD140+GD140",
    "CE141": "CE140+GE140",
    "CF141": "CF140+GF140",
    "CG141": "CG140+GG140",
    "CH141": "CH140+GH140",
    "CI141": "CI140+GI140",
    "CJ141": "CJ140+GJ140",
    "CK141": "CK140+GK140",
    "CL141": "CL140+GL140",
    "CM141": "CM140+GM140",
    "CN141": "CN140+GN140",
    "CO141": "CO140+GO140",
    "CS141": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI141,1)",
    "CT141": "INDEX($BD$5:$BD286,BT141)",
    "CU141": "INDEX($BN$5:$BN286,CD141)",
    "CV141": "INDEX($BO$5:$BO286,CE141)",
    "CW141": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG141)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX141": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO141, 1)",
    "CY141": "LET(\n  Base, $CR$6,\n  Damage, $CT141,\n  DamageMastery, $CS141,\n  DemonMastery, $CX141,\n  SPB, $CU141,\n  ITO, $CV141,\n  Shock, $CW141,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ141": "MIN(100%, DA141)",
    "DA141": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK141*1%, 0)",
    "DB141": "LET(\n  Lab, 1+INDEX($BF$5:$BF286,BV141),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC141": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK141*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI286,BY141) + CardCritMastery)",
    "DD141": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK141*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ286,BZ141) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE141": "LET(\n  CF, $DB141,\n  CC, $CZ141,\n  SCM, $DD141,\n  SCC, $DC141,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF141": "LET(\n  CF, $DB141,\n  CC, $DA141,\n  SCM, $DD141,\n  SCC, $DC141,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG141": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH141)), 0)",
    "DH141": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ141*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE286,BU141),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI141": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG286, BW141), 1) + $AE$9)",
    "DJ141": "LET(\n  DpmLab, INDEX($BH$5:$BH286,BX141),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL141, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK141": "(1+$DI141*$DJ141*$AQ$9)",
    "DL141": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK286,CA141),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM141*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM141": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK286,CA141),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM141*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN141": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL286,CB141)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO141": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH141,\n  Rapid, DG141,\n  RDPM, DK141,\n  SuperTower, $DL141,\n  Rend, $DN141,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP141": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ141": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK141),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR141": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP141),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF141-1))",
    "DS141": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG141, DH141),0))",
    "DT141": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP141),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV141, $AR$29), 0))",
    "DU141": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK141),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM286,CC141), $DV141, $AR$29), 0))",
    "DV141": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH141), $AO$29)",
    "DW141": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM141,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141, $DB141), 1),\n\n  DW, $DR141,\n  CL, $DS141,\n  SM, $DT141,\n  SLM, $DU141,\n  SL, $DQ141,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX141": "CY141*(DE141*DO141*DQ141+DW141*DF141)",
    "DZ141": "IF(INDEX($BD$6:$BD286,BT141)=\"\", \"\", INDEX($BD$5:$BD286,BT141+1))",
    "EA141": "IF(OR($AO$25, INDEX($BE$6:$BE286,BU141)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ141)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE286,BU141+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI141*$DJ141*$AQ$9),\n  SuperTower, $DL141,\n  Rend, $DN141,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141, $DB141), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR141,\n  SM, $DT141,\n  SLM, $DU141,\n  SL, $DQ141,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM141, UltCritCard),\n\nCY141*(DE141*OtherDamage*SL+UwDamage*DF141)))",
    "EB141": "IF(INDEX($BF$6:$BF286,BV141)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF286,BV141+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ141,\n  CCUW, $DA141,\n  SCM, $DD141,\n  SCC, $DC141,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141, CF), 1),\n\n  DW, $DR141,\n  CL, $DS141,\n  SM, $DT141,\n  SLM, $DU141,\n  SL, $DQ141,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM141, UltCritCard),\n\nCY141 * (Critical * DO141 * SL + UwDamage * UWCritical)))",
    "EC141": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG286,BW141)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH141,\n  Rapid, DG141,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG286, BW141+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ141*$AQ$9),\n  SuperTower, $DL141,\n  Rend, $DN141,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM286,CC141), $DV141, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM141,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141, $DB141), 1),\n\n  DW, $DR141,\n  CL, $DS141,\n  SM, $DT141,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY141*(DE141*OtherDamage*SL+UWDamage*DF141)))",
    "ED141": "IF(OR($AO$25, INDEX($BH$6:$BH286,BX141)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH286,BX141+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL141, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI141*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM286,CC141), $DV141, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH141,\n  Rapid, DG141,\n  SuperTower, $DL141,\n  Rend, $DN141,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM141,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141, $DB141), 1),\n\n  DW, $DR141,\n  CL, $DS141,\n  SM, $DT141,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY141*(DE141*OtherDamage*SL+UWDamage*DF141)))",
    "EE141": "IF(INDEX($BI$6:$BI286,BY141)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK141, 0),\n  CF, $DB141,\n  CC, $CZ141,\n  CCUW, $DA141,\n  SCM, $DD141,\n  SCC, $AV$17+INDEX($BI$5:$BI286,BY141+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY141 * (Critical*DO141*$DQ141+DW141*UWCritical)))",
    "EF141": "IF(INDEX($BJ$6:$BJ286,BZ141)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK141*1%, 1),\n  CF, $DB141,\n  CC, $CZ141,\n  CCUW, $DA141,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ286,BZ141+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC141,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY141*(Critical*DO141*$DQ141+DW141*UWCritical)))",
    "EG141": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK286,CA141)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH141,\n  Rapid, DG141,\n  DPM, (1+$DI141*$DJ141*$AQ$9),\n  Rend, $DN141,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK286,CA141+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM141*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141, $DB141), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK286,CA141+1)-1))/(45-CM141*3),1),\n\n  SL, $DQ141,\n  DW, $DR141,\n  CL, $DS141,\n  SM, $DT141,\n  SLM, $DU141,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY141*(DE141*OtherDamage*SL+UwDamage*DF141)))",
    "EH141": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL286,CB141+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL286,CB141)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH141,\n  Rapid, DG141,\n  DPM, (1+$DI141*$DJ141*$AQ$9),\n  SuperTower, $DL141,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL286,CB141+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY141*(DE141*OtherDamage*$DQ141+DW141*DF141)))",
    "EI141": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM286,CC141)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141, $DB141), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK141),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV141, $AR$29), 0),\n\n  DW, $DR141,\n  CL, $DS141,\n  SM, $DT141,\n  SL, $DQ141,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM141, UltCritCard),\nCY141*(DE141*DO141*SL+UwDamage*DF141)))",
    "EJ141": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN286,CD141)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT141,\n  DamageMastery, $CS141,\n  DemonMastery, $CX141,\n  SPB, INDEX($BN$5:$BN286,CD141+1),\n  ITO, $CV141,\n  Shock, $CW141,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE141*DO141*$DQ141+DW141*DF141)))",
    "EK141": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO286,CE141)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT141,\n  DamageMastery, $CS141,\n  DemonMastery, $CX141,\n  SPB, $CU141,\n  ITO, INDEX($BO$5:$BO286,CE141+1),\n  Shock, $CW141,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE141*DO141*$DQ141+DW141*DF141)))",
    "EL141": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP286,CF141)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141, $DB141), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP141),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF141),\n  CL, $DS141,\n  SM, $DT141,\n  SLM, $DU141,\n  SL, $DQ141,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM141, UltCritCard),\nCY141*(DE141*DO141*SL+UwDamage*DF141)))",
    "EM141": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ286,CG141)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG141+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN141": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR286,CH141)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141, $DB141), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH141+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP141),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK141),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM286,CC141), SMHeat, $AR$29), 0),\n\n  DW, $DR141,\n  CL, $DS141,\n  SL, $DQ141,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM141, UltCritCard),\nCY141*(DE141*DO141*SL+UwDamage*DF141)))",
    "EO141": "IF(OR(CI141 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI141+1))",
    "EP141": "IF(OR($AO$25, CJ141 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ141+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE285,BU141),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL141, 1),\n  DPM, (1+$DI141*CardRangeMastery*$DJ141*$AQ$9),\n  SuperTower, $DL141,\n  Rend, $DN141,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141, $DB141), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR141,\n  SM, $DT141,\n  SLM, $DU141,\n  SL, $DQ141,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM141, UltCritCard),\n\nCY141*(DE141*OtherDamage*SL+UwDamage*DF141)))",
    "EQ141": "IF(OR(CK141 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK141+1)*1%, 1),\n  CF, $DB141,\n  CC, MIN(100%, $CZ141 + 1%),\n  CCUW, DA141 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ286,BZ141) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC141 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR141,\n  CL, $DS141,\n  SM, $DT141,\n  SLM, $DU141,\n  SL, $DQ141,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM141, UltCritCard),\n\nCY141 * (Critical*DO141*SL+UwDamage*UWCritical)))",
    "ER141": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL141 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH286,BX141),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL141+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI141*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM286,CC141), $DV141, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH141,\n  Rapid, DG141,\n  SuperTower, $DL141,\n  Rend, $DN141,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM141,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141, $DB141), 1),\n\n  DW, $DR141,\n  CL, $DS141,\n  SM, $DT141,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY141*(DE141*OtherDamage*SL+UWDamage*DF141)))",
    "ES141": "IF(OR(CM141 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH141,\n  Rapid, DG141,\n  RDPM, (1+$DI141*$DJ141*$AQ$9),\n  Rend, $DN141,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK286,CA141),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM141+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141, $DB141), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR141,\n  CL, $DS141,\n  SM, $DT141,\n  SLM, $DU141,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY141*(DE141*OtherDamage*SL+UwDamage*DF141)))",
    "ET141": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN141 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM141,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN141+1, $DB141), 1),\n\n  DW, $DR141,\n  CL, $DS141,\n  SM, $DT141,\n  SLM, $DU141,\n  SL, $DQ141,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY141*(DE141*DO141*SL+UWDamage*DF141)))",
    "EU141": "IF(OR(NOT($BA$3), NOT($BA$23), $CO141 > $BA$15), \"\", 1 + 0.5*(CO141+1))",
    "EW141": "IF(DZ141=\"\", \"\", LET(\n  Now, CT141,\n  Next, DZ141,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT141),\nFactor/Cost))",
    "EX141": "IF(EA141=\"\",\"\",(EA141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU141))",
    "EY141": "IF(EB141=\"\",\"\",(EB141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV141))",
    "EZ141": "IF(EC141=\"\",\"\",(EC141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW141))",
    "FA141": "IF(ED141=\"\",\"\",(ED141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX141))",
    "FB141": "IF(EE141=\"\",\"\",(EE141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY141))",
    "FC141": "IF(EF141=\"\",\"\",(EF141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ141))",
    "FD141": "IF(EG141=\"\",\"\",(EG141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA141))",
    "FE141": "IF(EH141=\"\",\"\",(EH141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB141))",
    "FF141": "IF(EI141=\"\",\"\",(EI141/$DX141-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC141+1, 1, CC141))))",
    "FG141": "IF(EJ141=\"\",\"\",(EJ141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD141))",
    "FH141": "IF(EK141=\"\",\"\",(EK141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE141))",
    "FI141": "IF(EL141=\"\",\"\",(EL141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF141))",
    "FJ141": "IF(EM141=\"\", \"\", LET(\n  Now, CW141,\n  Next, EM141,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG141),\nFactor/Cost))",
    "FK141": "IF(EN141=\"\",\"\",(EN141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH141))",
    "FL141": "IF(EO141=\"\", \"\", LET(\n  Now, CS141,\n  Next, EO141,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI141),\nFactor/Cost))",
    "FM141": "IF(EP141=\"\",\"\",(EP141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ141))",
    "FN141": "IF(EQ141=\"\",\"\",(EQ141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK141))",
    "FO141": "IF(ER141=\"\",\"\",(ER141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL141))",
    "FP141": "IF(ES141=\"\",\"\",(ES141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM141))",
    "FQ141": "IF(ET141=\"\",\"\",(ET141/$DX141-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN141))",
    "FR141": "IF(EU141=\"\", \"\", LET(\n  Now, CX141,\n  Next, EU141,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO141),\nFactor/Cost))",
    "FT141": "IF(COLUMN(EW141:FR141) = MIN(IF(EW141:FR141=MAX(EW141:FR141), COLUMN(EW141:FR141))), 1, \"\")",
    "D142": "IF(SUM(FT141:GP141),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F142)),\"Card Mastery\",F142),G142)/$D$5,\"\")",
    "F142": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT141:GP141),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT141:GP141=1)),)\"),\"Damage\")",
    "G142": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT141:GP141),ARRAYFORMULA(FILTER(BT141:CP141 , FT141:GP141=1)),\"\"\"\")\"),31.0)",
    "I142": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT141:GP141),ARRAYFORMULA(FILTER(EW141:FS141 , FT141:GP141=1))*D$5,\"\"\"\")\"),0.004242281404666494)",
    "K142": "IF(H142<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D142)),)",
    "BT142": "BT141+FT141",
    "BU142": "BU141+FU141",
    "BV142": "BV141+FV141",
    "BW142": "BW141+FW141",
    "BX142": "BX141+FX141",
    "BY142": "BY141+FY141",
    "BZ142": "BZ141+FZ141",
    "CA142": "CA141+GA141",
    "CB142": "CB141+GB141",
    "CC142": "CC141+GC141",
    "CD142": "CD141+GD141",
    "CE142": "CE141+GE141",
    "CF142": "CF141+GF141",
    "CG142": "CG141+GG141",
    "CH142": "CH141+GH141",
    "CI142": "CI141+GI141",
    "CJ142": "CJ141+GJ141",
    "CK142": "CK141+GK141",
    "CL142": "CL141+GL141",
    "CM142": "CM141+GM141",
    "CN142": "CN141+GN141",
    "CO142": "CO141+GO141",
    "CS142": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI142,1)",
    "CT142": "INDEX($BD$5:$BD287,BT142)",
    "CU142": "INDEX($BN$5:$BN287,CD142)",
    "CV142": "INDEX($BO$5:$BO287,CE142)",
    "CW142": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG142)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX142": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO142, 1)",
    "CY142": "LET(\n  Base, $CR$6,\n  Damage, $CT142,\n  DamageMastery, $CS142,\n  DemonMastery, $CX142,\n  SPB, $CU142,\n  ITO, $CV142,\n  Shock, $CW142,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ142": "MIN(100%, DA142)",
    "DA142": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK142*1%, 0)",
    "DB142": "LET(\n  Lab, 1+INDEX($BF$5:$BF287,BV142),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC142": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK142*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI287,BY142) + CardCritMastery)",
    "DD142": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK142*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ287,BZ142) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE142": "LET(\n  CF, $DB142,\n  CC, $CZ142,\n  SCM, $DD142,\n  SCC, $DC142,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF142": "LET(\n  CF, $DB142,\n  CC, $DA142,\n  SCM, $DD142,\n  SCC, $DC142,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG142": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH142)), 0)",
    "DH142": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ142*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE287,BU142),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI142": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG287, BW142), 1) + $AE$9)",
    "DJ142": "LET(\n  DpmLab, INDEX($BH$5:$BH287,BX142),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL142, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK142": "(1+$DI142*$DJ142*$AQ$9)",
    "DL142": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK287,CA142),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM142*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM142": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK287,CA142),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM142*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN142": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL287,CB142)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO142": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH142,\n  Rapid, DG142,\n  RDPM, DK142,\n  SuperTower, $DL142,\n  Rend, $DN142,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP142": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ142": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK142),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR142": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP142),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF142-1))",
    "DS142": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG142, DH142),0))",
    "DT142": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP142),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV142, $AR$29), 0))",
    "DU142": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK142),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM287,CC142), $DV142, $AR$29), 0))",
    "DV142": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH142), $AO$29)",
    "DW142": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM142,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142, $DB142), 1),\n\n  DW, $DR142,\n  CL, $DS142,\n  SM, $DT142,\n  SLM, $DU142,\n  SL, $DQ142,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX142": "CY142*(DE142*DO142*DQ142+DW142*DF142)",
    "DZ142": "IF(INDEX($BD$6:$BD287,BT142)=\"\", \"\", INDEX($BD$5:$BD287,BT142+1))",
    "EA142": "IF(OR($AO$25, INDEX($BE$6:$BE287,BU142)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ142)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE287,BU142+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI142*$DJ142*$AQ$9),\n  SuperTower, $DL142,\n  Rend, $DN142,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142, $DB142), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR142,\n  SM, $DT142,\n  SLM, $DU142,\n  SL, $DQ142,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM142, UltCritCard),\n\nCY142*(DE142*OtherDamage*SL+UwDamage*DF142)))",
    "EB142": "IF(INDEX($BF$6:$BF287,BV142)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF287,BV142+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ142,\n  CCUW, $DA142,\n  SCM, $DD142,\n  SCC, $DC142,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142, CF), 1),\n\n  DW, $DR142,\n  CL, $DS142,\n  SM, $DT142,\n  SLM, $DU142,\n  SL, $DQ142,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM142, UltCritCard),\n\nCY142 * (Critical * DO142 * SL + UwDamage * UWCritical)))",
    "EC142": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG287,BW142)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH142,\n  Rapid, DG142,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG287, BW142+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ142*$AQ$9),\n  SuperTower, $DL142,\n  Rend, $DN142,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM287,CC142), $DV142, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM142,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142, $DB142), 1),\n\n  DW, $DR142,\n  CL, $DS142,\n  SM, $DT142,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY142*(DE142*OtherDamage*SL+UWDamage*DF142)))",
    "ED142": "IF(OR($AO$25, INDEX($BH$6:$BH287,BX142)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH287,BX142+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL142, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI142*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM287,CC142), $DV142, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH142,\n  Rapid, DG142,\n  SuperTower, $DL142,\n  Rend, $DN142,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM142,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142, $DB142), 1),\n\n  DW, $DR142,\n  CL, $DS142,\n  SM, $DT142,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY142*(DE142*OtherDamage*SL+UWDamage*DF142)))",
    "EE142": "IF(INDEX($BI$6:$BI287,BY142)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK142, 0),\n  CF, $DB142,\n  CC, $CZ142,\n  CCUW, $DA142,\n  SCM, $DD142,\n  SCC, $AV$17+INDEX($BI$5:$BI287,BY142+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY142 * (Critical*DO142*$DQ142+DW142*UWCritical)))",
    "EF142": "IF(INDEX($BJ$6:$BJ287,BZ142)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK142*1%, 1),\n  CF, $DB142,\n  CC, $CZ142,\n  CCUW, $DA142,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ287,BZ142+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC142,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY142*(Critical*DO142*$DQ142+DW142*UWCritical)))",
    "EG142": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK287,CA142)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH142,\n  Rapid, DG142,\n  DPM, (1+$DI142*$DJ142*$AQ$9),\n  Rend, $DN142,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK287,CA142+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM142*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142, $DB142), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK287,CA142+1)-1))/(45-CM142*3),1),\n\n  SL, $DQ142,\n  DW, $DR142,\n  CL, $DS142,\n  SM, $DT142,\n  SLM, $DU142,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY142*(DE142*OtherDamage*SL+UwDamage*DF142)))",
    "EH142": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL287,CB142+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL287,CB142)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH142,\n  Rapid, DG142,\n  DPM, (1+$DI142*$DJ142*$AQ$9),\n  SuperTower, $DL142,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL287,CB142+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY142*(DE142*OtherDamage*$DQ142+DW142*DF142)))",
    "EI142": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM287,CC142)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142, $DB142), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK142),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV142, $AR$29), 0),\n\n  DW, $DR142,\n  CL, $DS142,\n  SM, $DT142,\n  SL, $DQ142,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM142, UltCritCard),\nCY142*(DE142*DO142*SL+UwDamage*DF142)))",
    "EJ142": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN287,CD142)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT142,\n  DamageMastery, $CS142,\n  DemonMastery, $CX142,\n  SPB, INDEX($BN$5:$BN287,CD142+1),\n  ITO, $CV142,\n  Shock, $CW142,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE142*DO142*$DQ142+DW142*DF142)))",
    "EK142": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO287,CE142)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT142,\n  DamageMastery, $CS142,\n  DemonMastery, $CX142,\n  SPB, $CU142,\n  ITO, INDEX($BO$5:$BO287,CE142+1),\n  Shock, $CW142,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE142*DO142*$DQ142+DW142*DF142)))",
    "EL142": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP287,CF142)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142, $DB142), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP142),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF142),\n  CL, $DS142,\n  SM, $DT142,\n  SLM, $DU142,\n  SL, $DQ142,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM142, UltCritCard),\nCY142*(DE142*DO142*SL+UwDamage*DF142)))",
    "EM142": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ287,CG142)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG142+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN142": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR287,CH142)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142, $DB142), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH142+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP142),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK142),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM287,CC142), SMHeat, $AR$29), 0),\n\n  DW, $DR142,\n  CL, $DS142,\n  SL, $DQ142,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM142, UltCritCard),\nCY142*(DE142*DO142*SL+UwDamage*DF142)))",
    "EO142": "IF(OR(CI142 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI142+1))",
    "EP142": "IF(OR($AO$25, CJ142 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ142+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE286,BU142),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL142, 1),\n  DPM, (1+$DI142*CardRangeMastery*$DJ142*$AQ$9),\n  SuperTower, $DL142,\n  Rend, $DN142,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142, $DB142), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR142,\n  SM, $DT142,\n  SLM, $DU142,\n  SL, $DQ142,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM142, UltCritCard),\n\nCY142*(DE142*OtherDamage*SL+UwDamage*DF142)))",
    "EQ142": "IF(OR(CK142 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK142+1)*1%, 1),\n  CF, $DB142,\n  CC, MIN(100%, $CZ142 + 1%),\n  CCUW, DA142 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ287,BZ142) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC142 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR142,\n  CL, $DS142,\n  SM, $DT142,\n  SLM, $DU142,\n  SL, $DQ142,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM142, UltCritCard),\n\nCY142 * (Critical*DO142*SL+UwDamage*UWCritical)))",
    "ER142": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL142 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH287,BX142),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL142+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI142*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM287,CC142), $DV142, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH142,\n  Rapid, DG142,\n  SuperTower, $DL142,\n  Rend, $DN142,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM142,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142, $DB142), 1),\n\n  DW, $DR142,\n  CL, $DS142,\n  SM, $DT142,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY142*(DE142*OtherDamage*SL+UWDamage*DF142)))",
    "ES142": "IF(OR(CM142 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH142,\n  Rapid, DG142,\n  RDPM, (1+$DI142*$DJ142*$AQ$9),\n  Rend, $DN142,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK287,CA142),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM142+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142, $DB142), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR142,\n  CL, $DS142,\n  SM, $DT142,\n  SLM, $DU142,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY142*(DE142*OtherDamage*SL+UwDamage*DF142)))",
    "ET142": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN142 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM142,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN142+1, $DB142), 1),\n\n  DW, $DR142,\n  CL, $DS142,\n  SM, $DT142,\n  SLM, $DU142,\n  SL, $DQ142,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY142*(DE142*DO142*SL+UWDamage*DF142)))",
    "EU142": "IF(OR(NOT($BA$3), NOT($BA$23), $CO142 > $BA$15), \"\", 1 + 0.5*(CO142+1))",
    "EW142": "IF(DZ142=\"\", \"\", LET(\n  Now, CT142,\n  Next, DZ142,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT142),\nFactor/Cost))",
    "EX142": "IF(EA142=\"\",\"\",(EA142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU142))",
    "EY142": "IF(EB142=\"\",\"\",(EB142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV142))",
    "EZ142": "IF(EC142=\"\",\"\",(EC142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW142))",
    "FA142": "IF(ED142=\"\",\"\",(ED142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX142))",
    "FB142": "IF(EE142=\"\",\"\",(EE142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY142))",
    "FC142": "IF(EF142=\"\",\"\",(EF142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ142))",
    "FD142": "IF(EG142=\"\",\"\",(EG142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA142))",
    "FE142": "IF(EH142=\"\",\"\",(EH142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB142))",
    "FF142": "IF(EI142=\"\",\"\",(EI142/$DX142-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC142+1, 1, CC142))))",
    "FG142": "IF(EJ142=\"\",\"\",(EJ142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD142))",
    "FH142": "IF(EK142=\"\",\"\",(EK142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE142))",
    "FI142": "IF(EL142=\"\",\"\",(EL142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF142))",
    "FJ142": "IF(EM142=\"\", \"\", LET(\n  Now, CW142,\n  Next, EM142,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG142),\nFactor/Cost))",
    "FK142": "IF(EN142=\"\",\"\",(EN142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH142))",
    "FL142": "IF(EO142=\"\", \"\", LET(\n  Now, CS142,\n  Next, EO142,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI142),\nFactor/Cost))",
    "FM142": "IF(EP142=\"\",\"\",(EP142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ142))",
    "FN142": "IF(EQ142=\"\",\"\",(EQ142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK142))",
    "FO142": "IF(ER142=\"\",\"\",(ER142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL142))",
    "FP142": "IF(ES142=\"\",\"\",(ES142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM142))",
    "FQ142": "IF(ET142=\"\",\"\",(ET142/$DX142-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN142))",
    "FR142": "IF(EU142=\"\", \"\", LET(\n  Now, CX142,\n  Next, EU142,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO142),\nFactor/Cost))",
    "FT142": "IF(COLUMN(EW142:FR142) = MIN(IF(EW142:FR142=MAX(EW142:FR142), COLUMN(EW142:FR142))), 1, \"\")",
    "D143": "IF(SUM(FT142:GP142),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F143)),\"Card Mastery\",F143),G143)/$D$5,\"\")",
    "F143": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT142:GP142),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT142:GP142=1)),)\"),\"Damage / Meter\")",
    "G143": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT142:GP142),ARRAYFORMULA(FILTER(BT142:CP142 , FT142:GP142=1)),\"\"\"\")\"),24.0)",
    "I143": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT142:GP142),ARRAYFORMULA(FILTER(EW142:FS142 , FT142:GP142=1))*D$5,\"\"\"\")\"),0.004174750000063609)",
    "K143": "IF(H143<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D143)),)",
    "BT143": "BT142+FT142",
    "BU143": "BU142+FU142",
    "BV143": "BV142+FV142",
    "BW143": "BW142+FW142",
    "BX143": "BX142+FX142",
    "BY143": "BY142+FY142",
    "BZ143": "BZ142+FZ142",
    "CA143": "CA142+GA142",
    "CB143": "CB142+GB142",
    "CC143": "CC142+GC142",
    "CD143": "CD142+GD142",
    "CE143": "CE142+GE142",
    "CF143": "CF142+GF142",
    "CG143": "CG142+GG142",
    "CH143": "CH142+GH142",
    "CI143": "CI142+GI142",
    "CJ143": "CJ142+GJ142",
    "CK143": "CK142+GK142",
    "CL143": "CL142+GL142",
    "CM143": "CM142+GM142",
    "CN143": "CN142+GN142",
    "CO143": "CO142+GO142",
    "CS143": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI143,1)",
    "CT143": "INDEX($BD$5:$BD288,BT143)",
    "CU143": "INDEX($BN$5:$BN288,CD143)",
    "CV143": "INDEX($BO$5:$BO288,CE143)",
    "CW143": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG143)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX143": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO143, 1)",
    "CY143": "LET(\n  Base, $CR$6,\n  Damage, $CT143,\n  DamageMastery, $CS143,\n  DemonMastery, $CX143,\n  SPB, $CU143,\n  ITO, $CV143,\n  Shock, $CW143,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ143": "MIN(100%, DA143)",
    "DA143": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK143*1%, 0)",
    "DB143": "LET(\n  Lab, 1+INDEX($BF$5:$BF288,BV143),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC143": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK143*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI288,BY143) + CardCritMastery)",
    "DD143": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK143*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ288,BZ143) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE143": "LET(\n  CF, $DB143,\n  CC, $CZ143,\n  SCM, $DD143,\n  SCC, $DC143,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF143": "LET(\n  CF, $DB143,\n  CC, $DA143,\n  SCM, $DD143,\n  SCC, $DC143,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG143": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH143)), 0)",
    "DH143": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ143*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE288,BU143),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI143": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG288, BW143), 1) + $AE$9)",
    "DJ143": "LET(\n  DpmLab, INDEX($BH$5:$BH288,BX143),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL143, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK143": "(1+$DI143*$DJ143*$AQ$9)",
    "DL143": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK288,CA143),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM143*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM143": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK288,CA143),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM143*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN143": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL288,CB143)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO143": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH143,\n  Rapid, DG143,\n  RDPM, DK143,\n  SuperTower, $DL143,\n  Rend, $DN143,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP143": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ143": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK143),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR143": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP143),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF143-1))",
    "DS143": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG143, DH143),0))",
    "DT143": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP143),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV143, $AR$29), 0))",
    "DU143": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK143),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM288,CC143), $DV143, $AR$29), 0))",
    "DV143": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH143), $AO$29)",
    "DW143": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM143,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143, $DB143), 1),\n\n  DW, $DR143,\n  CL, $DS143,\n  SM, $DT143,\n  SLM, $DU143,\n  SL, $DQ143,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX143": "CY143*(DE143*DO143*DQ143+DW143*DF143)",
    "DZ143": "IF(INDEX($BD$6:$BD288,BT143)=\"\", \"\", INDEX($BD$5:$BD288,BT143+1))",
    "EA143": "IF(OR($AO$25, INDEX($BE$6:$BE288,BU143)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ143)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE288,BU143+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI143*$DJ143*$AQ$9),\n  SuperTower, $DL143,\n  Rend, $DN143,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143, $DB143), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR143,\n  SM, $DT143,\n  SLM, $DU143,\n  SL, $DQ143,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM143, UltCritCard),\n\nCY143*(DE143*OtherDamage*SL+UwDamage*DF143)))",
    "EB143": "IF(INDEX($BF$6:$BF288,BV143)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF288,BV143+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ143,\n  CCUW, $DA143,\n  SCM, $DD143,\n  SCC, $DC143,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143, CF), 1),\n\n  DW, $DR143,\n  CL, $DS143,\n  SM, $DT143,\n  SLM, $DU143,\n  SL, $DQ143,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM143, UltCritCard),\n\nCY143 * (Critical * DO143 * SL + UwDamage * UWCritical)))",
    "EC143": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG288,BW143)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH143,\n  Rapid, DG143,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG288, BW143+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ143*$AQ$9),\n  SuperTower, $DL143,\n  Rend, $DN143,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM288,CC143), $DV143, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM143,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143, $DB143), 1),\n\n  DW, $DR143,\n  CL, $DS143,\n  SM, $DT143,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY143*(DE143*OtherDamage*SL+UWDamage*DF143)))",
    "ED143": "IF(OR($AO$25, INDEX($BH$6:$BH288,BX143)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH288,BX143+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL143, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI143*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM288,CC143), $DV143, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH143,\n  Rapid, DG143,\n  SuperTower, $DL143,\n  Rend, $DN143,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM143,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143, $DB143), 1),\n\n  DW, $DR143,\n  CL, $DS143,\n  SM, $DT143,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY143*(DE143*OtherDamage*SL+UWDamage*DF143)))",
    "EE143": "IF(INDEX($BI$6:$BI288,BY143)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK143, 0),\n  CF, $DB143,\n  CC, $CZ143,\n  CCUW, $DA143,\n  SCM, $DD143,\n  SCC, $AV$17+INDEX($BI$5:$BI288,BY143+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY143 * (Critical*DO143*$DQ143+DW143*UWCritical)))",
    "EF143": "IF(INDEX($BJ$6:$BJ288,BZ143)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK143*1%, 1),\n  CF, $DB143,\n  CC, $CZ143,\n  CCUW, $DA143,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ288,BZ143+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC143,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY143*(Critical*DO143*$DQ143+DW143*UWCritical)))",
    "EG143": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK288,CA143)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH143,\n  Rapid, DG143,\n  DPM, (1+$DI143*$DJ143*$AQ$9),\n  Rend, $DN143,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK288,CA143+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM143*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143, $DB143), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK288,CA143+1)-1))/(45-CM143*3),1),\n\n  SL, $DQ143,\n  DW, $DR143,\n  CL, $DS143,\n  SM, $DT143,\n  SLM, $DU143,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY143*(DE143*OtherDamage*SL+UwDamage*DF143)))",
    "EH143": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL288,CB143+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL288,CB143)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH143,\n  Rapid, DG143,\n  DPM, (1+$DI143*$DJ143*$AQ$9),\n  SuperTower, $DL143,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL288,CB143+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY143*(DE143*OtherDamage*$DQ143+DW143*DF143)))",
    "EI143": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM288,CC143)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143, $DB143), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK143),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV143, $AR$29), 0),\n\n  DW, $DR143,\n  CL, $DS143,\n  SM, $DT143,\n  SL, $DQ143,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM143, UltCritCard),\nCY143*(DE143*DO143*SL+UwDamage*DF143)))",
    "EJ143": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN288,CD143)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT143,\n  DamageMastery, $CS143,\n  DemonMastery, $CX143,\n  SPB, INDEX($BN$5:$BN288,CD143+1),\n  ITO, $CV143,\n  Shock, $CW143,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE143*DO143*$DQ143+DW143*DF143)))",
    "EK143": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO288,CE143)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT143,\n  DamageMastery, $CS143,\n  DemonMastery, $CX143,\n  SPB, $CU143,\n  ITO, INDEX($BO$5:$BO288,CE143+1),\n  Shock, $CW143,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE143*DO143*$DQ143+DW143*DF143)))",
    "EL143": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP288,CF143)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143, $DB143), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP143),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF143),\n  CL, $DS143,\n  SM, $DT143,\n  SLM, $DU143,\n  SL, $DQ143,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM143, UltCritCard),\nCY143*(DE143*DO143*SL+UwDamage*DF143)))",
    "EM143": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ288,CG143)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG143+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN143": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR288,CH143)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143, $DB143), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH143+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP143),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK143),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM288,CC143), SMHeat, $AR$29), 0),\n\n  DW, $DR143,\n  CL, $DS143,\n  SL, $DQ143,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM143, UltCritCard),\nCY143*(DE143*DO143*SL+UwDamage*DF143)))",
    "EO143": "IF(OR(CI143 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI143+1))",
    "EP143": "IF(OR($AO$25, CJ143 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ143+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE287,BU143),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL143, 1),\n  DPM, (1+$DI143*CardRangeMastery*$DJ143*$AQ$9),\n  SuperTower, $DL143,\n  Rend, $DN143,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143, $DB143), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR143,\n  SM, $DT143,\n  SLM, $DU143,\n  SL, $DQ143,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM143, UltCritCard),\n\nCY143*(DE143*OtherDamage*SL+UwDamage*DF143)))",
    "EQ143": "IF(OR(CK143 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK143+1)*1%, 1),\n  CF, $DB143,\n  CC, MIN(100%, $CZ143 + 1%),\n  CCUW, DA143 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ288,BZ143) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC143 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR143,\n  CL, $DS143,\n  SM, $DT143,\n  SLM, $DU143,\n  SL, $DQ143,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM143, UltCritCard),\n\nCY143 * (Critical*DO143*SL+UwDamage*UWCritical)))",
    "ER143": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL143 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH288,BX143),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL143+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI143*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM288,CC143), $DV143, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH143,\n  Rapid, DG143,\n  SuperTower, $DL143,\n  Rend, $DN143,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM143,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143, $DB143), 1),\n\n  DW, $DR143,\n  CL, $DS143,\n  SM, $DT143,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY143*(DE143*OtherDamage*SL+UWDamage*DF143)))",
    "ES143": "IF(OR(CM143 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH143,\n  Rapid, DG143,\n  RDPM, (1+$DI143*$DJ143*$AQ$9),\n  Rend, $DN143,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK288,CA143),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM143+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143, $DB143), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR143,\n  CL, $DS143,\n  SM, $DT143,\n  SLM, $DU143,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY143*(DE143*OtherDamage*SL+UwDamage*DF143)))",
    "ET143": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN143 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM143,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN143+1, $DB143), 1),\n\n  DW, $DR143,\n  CL, $DS143,\n  SM, $DT143,\n  SLM, $DU143,\n  SL, $DQ143,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY143*(DE143*DO143*SL+UWDamage*DF143)))",
    "EU143": "IF(OR(NOT($BA$3), NOT($BA$23), $CO143 > $BA$15), \"\", 1 + 0.5*(CO143+1))",
    "EW143": "IF(DZ143=\"\", \"\", LET(\n  Now, CT143,\n  Next, DZ143,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT143),\nFactor/Cost))",
    "EX143": "IF(EA143=\"\",\"\",(EA143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU143))",
    "EY143": "IF(EB143=\"\",\"\",(EB143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV143))",
    "EZ143": "IF(EC143=\"\",\"\",(EC143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW143))",
    "FA143": "IF(ED143=\"\",\"\",(ED143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX143))",
    "FB143": "IF(EE143=\"\",\"\",(EE143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY143))",
    "FC143": "IF(EF143=\"\",\"\",(EF143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ143))",
    "FD143": "IF(EG143=\"\",\"\",(EG143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA143))",
    "FE143": "IF(EH143=\"\",\"\",(EH143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB143))",
    "FF143": "IF(EI143=\"\",\"\",(EI143/$DX143-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC143+1, 1, CC143))))",
    "FG143": "IF(EJ143=\"\",\"\",(EJ143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD143))",
    "FH143": "IF(EK143=\"\",\"\",(EK143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE143))",
    "FI143": "IF(EL143=\"\",\"\",(EL143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF143))",
    "FJ143": "IF(EM143=\"\", \"\", LET(\n  Now, CW143,\n  Next, EM143,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG143),\nFactor/Cost))",
    "FK143": "IF(EN143=\"\",\"\",(EN143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH143))",
    "FL143": "IF(EO143=\"\", \"\", LET(\n  Now, CS143,\n  Next, EO143,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI143),\nFactor/Cost))",
    "FM143": "IF(EP143=\"\",\"\",(EP143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ143))",
    "FN143": "IF(EQ143=\"\",\"\",(EQ143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK143))",
    "FO143": "IF(ER143=\"\",\"\",(ER143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL143))",
    "FP143": "IF(ES143=\"\",\"\",(ES143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM143))",
    "FQ143": "IF(ET143=\"\",\"\",(ET143/$DX143-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN143))",
    "FR143": "IF(EU143=\"\", \"\", LET(\n  Now, CX143,\n  Next, EU143,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO143),\nFactor/Cost))",
    "FT143": "IF(COLUMN(EW143:FR143) = MIN(IF(EW143:FR143=MAX(EW143:FR143), COLUMN(EW143:FR143))), 1, \"\")",
    "D144": "IF(SUM(FT143:GP143),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F144)),\"Card Mastery\",F144),G144)/$D$5,\"\")",
    "F144": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT143:GP143),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT143:GP143=1)),)\"),\"Attack Speed\")",
    "G144": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT143:GP143),ARRAYFORMULA(FILTER(BT143:CP143 , FT143:GP143=1)),\"\"\"\")\"),31.0)",
    "I144": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT143:GP143),ARRAYFORMULA(FILTER(EW143:FS143 , FT143:GP143=1))*D$5,\"\"\"\")\"),0.004147766024403829)",
    "K144": "IF(H144<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D144)),)",
    "BT144": "BT143+FT143",
    "BU144": "BU143+FU143",
    "BV144": "BV143+FV143",
    "BW144": "BW143+FW143",
    "BX144": "BX143+FX143",
    "BY144": "BY143+FY143",
    "BZ144": "BZ143+FZ143",
    "CA144": "CA143+GA143",
    "CB144": "CB143+GB143",
    "CC144": "CC143+GC143",
    "CD144": "CD143+GD143",
    "CE144": "CE143+GE143",
    "CF144": "CF143+GF143",
    "CG144": "CG143+GG143",
    "CH144": "CH143+GH143",
    "CI144": "CI143+GI143",
    "CJ144": "CJ143+GJ143",
    "CK144": "CK143+GK143",
    "CL144": "CL143+GL143",
    "CM144": "CM143+GM143",
    "CN144": "CN143+GN143",
    "CO144": "CO143+GO143",
    "CS144": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI144,1)",
    "CT144": "INDEX($BD$5:$BD289,BT144)",
    "CU144": "INDEX($BN$5:$BN289,CD144)",
    "CV144": "INDEX($BO$5:$BO289,CE144)",
    "CW144": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG144)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX144": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO144, 1)",
    "CY144": "LET(\n  Base, $CR$6,\n  Damage, $CT144,\n  DamageMastery, $CS144,\n  DemonMastery, $CX144,\n  SPB, $CU144,\n  ITO, $CV144,\n  Shock, $CW144,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ144": "MIN(100%, DA144)",
    "DA144": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK144*1%, 0)",
    "DB144": "LET(\n  Lab, 1+INDEX($BF$5:$BF289,BV144),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC144": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK144*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI289,BY144) + CardCritMastery)",
    "DD144": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK144*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ289,BZ144) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE144": "LET(\n  CF, $DB144,\n  CC, $CZ144,\n  SCM, $DD144,\n  SCC, $DC144,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF144": "LET(\n  CF, $DB144,\n  CC, $DA144,\n  SCM, $DD144,\n  SCC, $DC144,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG144": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH144)), 0)",
    "DH144": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ144*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE289,BU144),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI144": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG289, BW144), 1) + $AE$9)",
    "DJ144": "LET(\n  DpmLab, INDEX($BH$5:$BH289,BX144),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL144, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK144": "(1+$DI144*$DJ144*$AQ$9)",
    "DL144": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK289,CA144),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM144*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM144": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK289,CA144),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM144*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN144": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL289,CB144)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO144": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH144,\n  Rapid, DG144,\n  RDPM, DK144,\n  SuperTower, $DL144,\n  Rend, $DN144,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP144": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ144": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK144),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR144": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP144),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF144-1))",
    "DS144": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG144, DH144),0))",
    "DT144": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP144),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV144, $AR$29), 0))",
    "DU144": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK144),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM289,CC144), $DV144, $AR$29), 0))",
    "DV144": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH144), $AO$29)",
    "DW144": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM144,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144, $DB144), 1),\n\n  DW, $DR144,\n  CL, $DS144,\n  SM, $DT144,\n  SLM, $DU144,\n  SL, $DQ144,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX144": "CY144*(DE144*DO144*DQ144+DW144*DF144)",
    "DZ144": "IF(INDEX($BD$6:$BD289,BT144)=\"\", \"\", INDEX($BD$5:$BD289,BT144+1))",
    "EA144": "IF(OR($AO$25, INDEX($BE$6:$BE289,BU144)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ144)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE289,BU144+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI144*$DJ144*$AQ$9),\n  SuperTower, $DL144,\n  Rend, $DN144,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144, $DB144), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR144,\n  SM, $DT144,\n  SLM, $DU144,\n  SL, $DQ144,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM144, UltCritCard),\n\nCY144*(DE144*OtherDamage*SL+UwDamage*DF144)))",
    "EB144": "IF(INDEX($BF$6:$BF289,BV144)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF289,BV144+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ144,\n  CCUW, $DA144,\n  SCM, $DD144,\n  SCC, $DC144,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144, CF), 1),\n\n  DW, $DR144,\n  CL, $DS144,\n  SM, $DT144,\n  SLM, $DU144,\n  SL, $DQ144,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM144, UltCritCard),\n\nCY144 * (Critical * DO144 * SL + UwDamage * UWCritical)))",
    "EC144": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG289,BW144)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH144,\n  Rapid, DG144,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG289, BW144+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ144*$AQ$9),\n  SuperTower, $DL144,\n  Rend, $DN144,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM289,CC144), $DV144, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM144,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144, $DB144), 1),\n\n  DW, $DR144,\n  CL, $DS144,\n  SM, $DT144,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY144*(DE144*OtherDamage*SL+UWDamage*DF144)))",
    "ED144": "IF(OR($AO$25, INDEX($BH$6:$BH289,BX144)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH289,BX144+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL144, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI144*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM289,CC144), $DV144, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH144,\n  Rapid, DG144,\n  SuperTower, $DL144,\n  Rend, $DN144,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM144,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144, $DB144), 1),\n\n  DW, $DR144,\n  CL, $DS144,\n  SM, $DT144,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY144*(DE144*OtherDamage*SL+UWDamage*DF144)))",
    "EE144": "IF(INDEX($BI$6:$BI289,BY144)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK144, 0),\n  CF, $DB144,\n  CC, $CZ144,\n  CCUW, $DA144,\n  SCM, $DD144,\n  SCC, $AV$17+INDEX($BI$5:$BI289,BY144+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY144 * (Critical*DO144*$DQ144+DW144*UWCritical)))",
    "EF144": "IF(INDEX($BJ$6:$BJ289,BZ144)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK144*1%, 1),\n  CF, $DB144,\n  CC, $CZ144,\n  CCUW, $DA144,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ289,BZ144+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC144,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY144*(Critical*DO144*$DQ144+DW144*UWCritical)))",
    "EG144": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK289,CA144)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH144,\n  Rapid, DG144,\n  DPM, (1+$DI144*$DJ144*$AQ$9),\n  Rend, $DN144,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK289,CA144+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM144*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144, $DB144), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK289,CA144+1)-1))/(45-CM144*3),1),\n\n  SL, $DQ144,\n  DW, $DR144,\n  CL, $DS144,\n  SM, $DT144,\n  SLM, $DU144,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY144*(DE144*OtherDamage*SL+UwDamage*DF144)))",
    "EH144": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL289,CB144+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL289,CB144)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH144,\n  Rapid, DG144,\n  DPM, (1+$DI144*$DJ144*$AQ$9),\n  SuperTower, $DL144,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL289,CB144+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY144*(DE144*OtherDamage*$DQ144+DW144*DF144)))",
    "EI144": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM289,CC144)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144, $DB144), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK144),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV144, $AR$29), 0),\n\n  DW, $DR144,\n  CL, $DS144,\n  SM, $DT144,\n  SL, $DQ144,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM144, UltCritCard),\nCY144*(DE144*DO144*SL+UwDamage*DF144)))",
    "EJ144": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN289,CD144)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT144,\n  DamageMastery, $CS144,\n  DemonMastery, $CX144,\n  SPB, INDEX($BN$5:$BN289,CD144+1),\n  ITO, $CV144,\n  Shock, $CW144,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE144*DO144*$DQ144+DW144*DF144)))",
    "EK144": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO289,CE144)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT144,\n  DamageMastery, $CS144,\n  DemonMastery, $CX144,\n  SPB, $CU144,\n  ITO, INDEX($BO$5:$BO289,CE144+1),\n  Shock, $CW144,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE144*DO144*$DQ144+DW144*DF144)))",
    "EL144": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP289,CF144)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144, $DB144), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP144),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF144),\n  CL, $DS144,\n  SM, $DT144,\n  SLM, $DU144,\n  SL, $DQ144,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM144, UltCritCard),\nCY144*(DE144*DO144*SL+UwDamage*DF144)))",
    "EM144": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ289,CG144)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG144+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN144": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR289,CH144)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144, $DB144), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH144+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP144),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK144),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM289,CC144), SMHeat, $AR$29), 0),\n\n  DW, $DR144,\n  CL, $DS144,\n  SL, $DQ144,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM144, UltCritCard),\nCY144*(DE144*DO144*SL+UwDamage*DF144)))",
    "EO144": "IF(OR(CI144 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI144+1))",
    "EP144": "IF(OR($AO$25, CJ144 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ144+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE288,BU144),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL144, 1),\n  DPM, (1+$DI144*CardRangeMastery*$DJ144*$AQ$9),\n  SuperTower, $DL144,\n  Rend, $DN144,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144, $DB144), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR144,\n  SM, $DT144,\n  SLM, $DU144,\n  SL, $DQ144,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM144, UltCritCard),\n\nCY144*(DE144*OtherDamage*SL+UwDamage*DF144)))",
    "EQ144": "IF(OR(CK144 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK144+1)*1%, 1),\n  CF, $DB144,\n  CC, MIN(100%, $CZ144 + 1%),\n  CCUW, DA144 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ289,BZ144) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC144 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR144,\n  CL, $DS144,\n  SM, $DT144,\n  SLM, $DU144,\n  SL, $DQ144,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM144, UltCritCard),\n\nCY144 * (Critical*DO144*SL+UwDamage*UWCritical)))",
    "ER144": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL144 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH289,BX144),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL144+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI144*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM289,CC144), $DV144, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH144,\n  Rapid, DG144,\n  SuperTower, $DL144,\n  Rend, $DN144,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM144,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144, $DB144), 1),\n\n  DW, $DR144,\n  CL, $DS144,\n  SM, $DT144,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY144*(DE144*OtherDamage*SL+UWDamage*DF144)))",
    "ES144": "IF(OR(CM144 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH144,\n  Rapid, DG144,\n  RDPM, (1+$DI144*$DJ144*$AQ$9),\n  Rend, $DN144,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK289,CA144),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM144+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144, $DB144), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR144,\n  CL, $DS144,\n  SM, $DT144,\n  SLM, $DU144,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY144*(DE144*OtherDamage*SL+UwDamage*DF144)))",
    "ET144": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN144 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM144,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN144+1, $DB144), 1),\n\n  DW, $DR144,\n  CL, $DS144,\n  SM, $DT144,\n  SLM, $DU144,\n  SL, $DQ144,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY144*(DE144*DO144*SL+UWDamage*DF144)))",
    "EU144": "IF(OR(NOT($BA$3), NOT($BA$23), $CO144 > $BA$15), \"\", 1 + 0.5*(CO144+1))",
    "EW144": "IF(DZ144=\"\", \"\", LET(\n  Now, CT144,\n  Next, DZ144,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT144),\nFactor/Cost))",
    "EX144": "IF(EA144=\"\",\"\",(EA144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU144))",
    "EY144": "IF(EB144=\"\",\"\",(EB144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV144))",
    "EZ144": "IF(EC144=\"\",\"\",(EC144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW144))",
    "FA144": "IF(ED144=\"\",\"\",(ED144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX144))",
    "FB144": "IF(EE144=\"\",\"\",(EE144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY144))",
    "FC144": "IF(EF144=\"\",\"\",(EF144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ144))",
    "FD144": "IF(EG144=\"\",\"\",(EG144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA144))",
    "FE144": "IF(EH144=\"\",\"\",(EH144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB144))",
    "FF144": "IF(EI144=\"\",\"\",(EI144/$DX144-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC144+1, 1, CC144))))",
    "FG144": "IF(EJ144=\"\",\"\",(EJ144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD144))",
    "FH144": "IF(EK144=\"\",\"\",(EK144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE144))",
    "FI144": "IF(EL144=\"\",\"\",(EL144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF144))",
    "FJ144": "IF(EM144=\"\", \"\", LET(\n  Now, CW144,\n  Next, EM144,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG144),\nFactor/Cost))",
    "FK144": "IF(EN144=\"\",\"\",(EN144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH144))",
    "FL144": "IF(EO144=\"\", \"\", LET(\n  Now, CS144,\n  Next, EO144,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI144),\nFactor/Cost))",
    "FM144": "IF(EP144=\"\",\"\",(EP144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ144))",
    "FN144": "IF(EQ144=\"\",\"\",(EQ144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK144))",
    "FO144": "IF(ER144=\"\",\"\",(ER144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL144))",
    "FP144": "IF(ES144=\"\",\"\",(ES144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM144))",
    "FQ144": "IF(ET144=\"\",\"\",(ET144/$DX144-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN144))",
    "FR144": "IF(EU144=\"\", \"\", LET(\n  Now, CX144,\n  Next, EU144,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO144),\nFactor/Cost))",
    "FT144": "IF(COLUMN(EW144:FR144) = MIN(IF(EW144:FR144=MAX(EW144:FR144), COLUMN(EW144:FR144))), 1, \"\")",
    "D145": "IF(SUM(FT144:GP144),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F145)),\"Card Mastery\",F145),G145)/$D$5,\"\")",
    "F145": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT144:GP144),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT144:GP144=1)),)\"),\"Critical Factor\")",
    "G145": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT144:GP144),ARRAYFORMULA(FILTER(BT144:CP144 , FT144:GP144=1)),\"\"\"\")\"),34.0)",
    "I145": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT144:GP144),ARRAYFORMULA(FILTER(EW144:FS144 , FT144:GP144=1))*D$5,\"\"\"\")\"),0.004128546040398)",
    "K145": "IF(D136,FORMAT_TIME_YEAR(SUM($D$6:$D145)),)",
    "BT145": "BT144+FT144",
    "BU145": "BU144+FU144",
    "BV145": "BV144+FV144",
    "BW145": "BW144+FW144",
    "BX145": "BX144+FX144",
    "BY145": "BY144+FY144",
    "BZ145": "BZ144+FZ144",
    "CA145": "CA144+GA144",
    "CB145": "CB144+GB144",
    "CC145": "CC144+GC144",
    "CD145": "CD144+GD144",
    "CE145": "CE144+GE144",
    "CF145": "CF144+GF144",
    "CG145": "CG144+GG144",
    "CH145": "CH144+GH144",
    "CI145": "CI144+GI144",
    "CJ145": "CJ144+GJ144",
    "CK145": "CK144+GK144",
    "CL145": "CL144+GL144",
    "CM145": "CM144+GM144",
    "CN145": "CN144+GN144",
    "CO145": "CO144+GO144",
    "CS145": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI145,1)",
    "CT145": "INDEX($BD$5:$BD290,BT145)",
    "CU145": "INDEX($BN$5:$BN290,CD145)",
    "CV145": "INDEX($BO$5:$BO290,CE145)",
    "CW145": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG145)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX145": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO145, 1)",
    "CY145": "LET(\n  Base, $CR$6,\n  Damage, $CT145,\n  DamageMastery, $CS145,\n  DemonMastery, $CX145,\n  SPB, $CU145,\n  ITO, $CV145,\n  Shock, $CW145,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ145": "MIN(100%, DA145)",
    "DA145": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK145*1%, 0)",
    "DB145": "LET(\n  Lab, 1+INDEX($BF$5:$BF290,BV145),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC145": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK145*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI290,BY145) + CardCritMastery)",
    "DD145": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK145*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ290,BZ145) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE145": "LET(\n  CF, $DB145,\n  CC, $CZ145,\n  SCM, $DD145,\n  SCC, $DC145,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF145": "LET(\n  CF, $DB145,\n  CC, $DA145,\n  SCM, $DD145,\n  SCC, $DC145,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG145": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH145)), 0)",
    "DH145": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ145*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE290,BU145),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI145": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG290, BW145), 1) + $AE$9)",
    "DJ145": "LET(\n  DpmLab, INDEX($BH$5:$BH290,BX145),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL145, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK145": "(1+$DI145*$DJ145*$AQ$9)",
    "DL145": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK290,CA145),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM145*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM145": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK290,CA145),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM145*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN145": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL290,CB145)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO145": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH145,\n  Rapid, DG145,\n  RDPM, DK145,\n  SuperTower, $DL145,\n  Rend, $DN145,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP145": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ145": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK145),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR145": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP145),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF145-1))",
    "DS145": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG145, DH145),0))",
    "DT145": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP145),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV145, $AR$29), 0))",
    "DU145": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK145),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM290,CC145), $DV145, $AR$29), 0))",
    "DV145": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH145), $AO$29)",
    "DW145": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM145,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145, $DB145), 1),\n\n  DW, $DR145,\n  CL, $DS145,\n  SM, $DT145,\n  SLM, $DU145,\n  SL, $DQ145,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX145": "CY145*(DE145*DO145*DQ145+DW145*DF145)",
    "DZ145": "IF(INDEX($BD$6:$BD290,BT145)=\"\", \"\", INDEX($BD$5:$BD290,BT145+1))",
    "EA145": "IF(OR($AO$25, INDEX($BE$6:$BE290,BU145)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ145)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE290,BU145+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI145*$DJ145*$AQ$9),\n  SuperTower, $DL145,\n  Rend, $DN145,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145, $DB145), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR145,\n  SM, $DT145,\n  SLM, $DU145,\n  SL, $DQ145,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM145, UltCritCard),\n\nCY145*(DE145*OtherDamage*SL+UwDamage*DF145)))",
    "EB145": "IF(INDEX($BF$6:$BF290,BV145)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF290,BV145+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ145,\n  CCUW, $DA145,\n  SCM, $DD145,\n  SCC, $DC145,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145, CF), 1),\n\n  DW, $DR145,\n  CL, $DS145,\n  SM, $DT145,\n  SLM, $DU145,\n  SL, $DQ145,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM145, UltCritCard),\n\nCY145 * (Critical * DO145 * SL + UwDamage * UWCritical)))",
    "EC145": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG290,BW145)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH145,\n  Rapid, DG145,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG290, BW145+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ145*$AQ$9),\n  SuperTower, $DL145,\n  Rend, $DN145,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM290,CC145), $DV145, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM145,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145, $DB145), 1),\n\n  DW, $DR145,\n  CL, $DS145,\n  SM, $DT145,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY145*(DE145*OtherDamage*SL+UWDamage*DF145)))",
    "ED145": "IF(OR($AO$25, INDEX($BH$6:$BH290,BX145)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH290,BX145+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL145, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI145*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM290,CC145), $DV145, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH145,\n  Rapid, DG145,\n  SuperTower, $DL145,\n  Rend, $DN145,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM145,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145, $DB145), 1),\n\n  DW, $DR145,\n  CL, $DS145,\n  SM, $DT145,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY145*(DE145*OtherDamage*SL+UWDamage*DF145)))",
    "EE145": "IF(INDEX($BI$6:$BI290,BY145)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK145, 0),\n  CF, $DB145,\n  CC, $CZ145,\n  CCUW, $DA145,\n  SCM, $DD145,\n  SCC, $AV$17+INDEX($BI$5:$BI290,BY145+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY145 * (Critical*DO145*$DQ145+DW145*UWCritical)))",
    "EF145": "IF(INDEX($BJ$6:$BJ290,BZ145)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK145*1%, 1),\n  CF, $DB145,\n  CC, $CZ145,\n  CCUW, $DA145,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ290,BZ145+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC145,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY145*(Critical*DO145*$DQ145+DW145*UWCritical)))",
    "EG145": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK290,CA145)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH145,\n  Rapid, DG145,\n  DPM, (1+$DI145*$DJ145*$AQ$9),\n  Rend, $DN145,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK290,CA145+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM145*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145, $DB145), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK290,CA145+1)-1))/(45-CM145*3),1),\n\n  SL, $DQ145,\n  DW, $DR145,\n  CL, $DS145,\n  SM, $DT145,\n  SLM, $DU145,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY145*(DE145*OtherDamage*SL+UwDamage*DF145)))",
    "EH145": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL290,CB145+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL290,CB145)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH145,\n  Rapid, DG145,\n  DPM, (1+$DI145*$DJ145*$AQ$9),\n  SuperTower, $DL145,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL290,CB145+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY145*(DE145*OtherDamage*$DQ145+DW145*DF145)))",
    "EI145": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM290,CC145)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145, $DB145), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK145),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV145, $AR$29), 0),\n\n  DW, $DR145,\n  CL, $DS145,\n  SM, $DT145,\n  SL, $DQ145,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM145, UltCritCard),\nCY145*(DE145*DO145*SL+UwDamage*DF145)))",
    "EJ145": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN290,CD145)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT145,\n  DamageMastery, $CS145,\n  DemonMastery, $CX145,\n  SPB, INDEX($BN$5:$BN290,CD145+1),\n  ITO, $CV145,\n  Shock, $CW145,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE145*DO145*$DQ145+DW145*DF145)))",
    "EK145": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO290,CE145)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT145,\n  DamageMastery, $CS145,\n  DemonMastery, $CX145,\n  SPB, $CU145,\n  ITO, INDEX($BO$5:$BO290,CE145+1),\n  Shock, $CW145,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE145*DO145*$DQ145+DW145*DF145)))",
    "EL145": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP290,CF145)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145, $DB145), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP145),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF145),\n  CL, $DS145,\n  SM, $DT145,\n  SLM, $DU145,\n  SL, $DQ145,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM145, UltCritCard),\nCY145*(DE145*DO145*SL+UwDamage*DF145)))",
    "EM145": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ290,CG145)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG145+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN145": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR290,CH145)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145, $DB145), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH145+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP145),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK145),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM290,CC145), SMHeat, $AR$29), 0),\n\n  DW, $DR145,\n  CL, $DS145,\n  SL, $DQ145,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM145, UltCritCard),\nCY145*(DE145*DO145*SL+UwDamage*DF145)))",
    "EO145": "IF(OR(CI145 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI145+1))",
    "EP145": "IF(OR($AO$25, CJ145 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ145+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE289,BU145),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL145, 1),\n  DPM, (1+$DI145*CardRangeMastery*$DJ145*$AQ$9),\n  SuperTower, $DL145,\n  Rend, $DN145,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145, $DB145), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR145,\n  SM, $DT145,\n  SLM, $DU145,\n  SL, $DQ145,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM145, UltCritCard),\n\nCY145*(DE145*OtherDamage*SL+UwDamage*DF145)))",
    "EQ145": "IF(OR(CK145 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK145+1)*1%, 1),\n  CF, $DB145,\n  CC, MIN(100%, $CZ145 + 1%),\n  CCUW, DA145 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ290,BZ145) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC145 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR145,\n  CL, $DS145,\n  SM, $DT145,\n  SLM, $DU145,\n  SL, $DQ145,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM145, UltCritCard),\n\nCY145 * (Critical*DO145*SL+UwDamage*UWCritical)))",
    "ER145": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL145 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH290,BX145),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL145+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI145*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM290,CC145), $DV145, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH145,\n  Rapid, DG145,\n  SuperTower, $DL145,\n  Rend, $DN145,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM145,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145, $DB145), 1),\n\n  DW, $DR145,\n  CL, $DS145,\n  SM, $DT145,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY145*(DE145*OtherDamage*SL+UWDamage*DF145)))",
    "ES145": "IF(OR(CM145 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH145,\n  Rapid, DG145,\n  RDPM, (1+$DI145*$DJ145*$AQ$9),\n  Rend, $DN145,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK290,CA145),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM145+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145, $DB145), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR145,\n  CL, $DS145,\n  SM, $DT145,\n  SLM, $DU145,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY145*(DE145*OtherDamage*SL+UwDamage*DF145)))",
    "ET145": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN145 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM145,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN145+1, $DB145), 1),\n\n  DW, $DR145,\n  CL, $DS145,\n  SM, $DT145,\n  SLM, $DU145,\n  SL, $DQ145,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY145*(DE145*DO145*SL+UWDamage*DF145)))",
    "EU145": "IF(OR(NOT($BA$3), NOT($BA$23), $CO145 > $BA$15), \"\", 1 + 0.5*(CO145+1))",
    "EW145": "IF(DZ145=\"\", \"\", LET(\n  Now, CT145,\n  Next, DZ145,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT145),\nFactor/Cost))",
    "EX145": "IF(EA145=\"\",\"\",(EA145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU145))",
    "EY145": "IF(EB145=\"\",\"\",(EB145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV145))",
    "EZ145": "IF(EC145=\"\",\"\",(EC145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW145))",
    "FA145": "IF(ED145=\"\",\"\",(ED145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX145))",
    "FB145": "IF(EE145=\"\",\"\",(EE145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY145))",
    "FC145": "IF(EF145=\"\",\"\",(EF145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ145))",
    "FD145": "IF(EG145=\"\",\"\",(EG145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA145))",
    "FE145": "IF(EH145=\"\",\"\",(EH145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB145))",
    "FF145": "IF(EI145=\"\",\"\",(EI145/$DX145-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC145+1, 1, CC145))))",
    "FG145": "IF(EJ145=\"\",\"\",(EJ145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD145))",
    "FH145": "IF(EK145=\"\",\"\",(EK145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE145))",
    "FI145": "IF(EL145=\"\",\"\",(EL145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF145))",
    "FJ145": "IF(EM145=\"\", \"\", LET(\n  Now, CW145,\n  Next, EM145,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG145),\nFactor/Cost))",
    "FK145": "IF(EN145=\"\",\"\",(EN145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH145))",
    "FL145": "IF(EO145=\"\", \"\", LET(\n  Now, CS145,\n  Next, EO145,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI145),\nFactor/Cost))",
    "FM145": "IF(EP145=\"\",\"\",(EP145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ145))",
    "FN145": "IF(EQ145=\"\",\"\",(EQ145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK145))",
    "FO145": "IF(ER145=\"\",\"\",(ER145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL145))",
    "FP145": "IF(ES145=\"\",\"\",(ES145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM145))",
    "FQ145": "IF(ET145=\"\",\"\",(ET145/$DX145-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN145))",
    "FR145": "IF(EU145=\"\", \"\", LET(\n  Now, CX145,\n  Next, EU145,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO145),\nFactor/Cost))",
    "FT145": "IF(COLUMN(EW145:FR145) = MIN(IF(EW145:FR145=MAX(EW145:FR145), COLUMN(EW145:FR145))), 1, \"\")",
    "D146": "IF(SUM(FT145:GP145),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F146)),\"Card Mastery\",F146),G146)/$D$5,\"\")",
    "F146": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT145:GP145),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT145:GP145=1)),)\"),\"Super Tower Bonus\")",
    "G146": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT145:GP145),ARRAYFORMULA(FILTER(BT145:CP145 , FT145:GP145=1)),\"\"\"\")\"),8.0)",
    "I146": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT145:GP145),ARRAYFORMULA(FILTER(EW145:FS145 , FT145:GP145=1))*D$5,\"\"\"\")\"),0.003964080165792113)",
    "K146": "IF(H146<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D146)),)",
    "BT146": "BT145+FT145",
    "BU146": "BU145+FU145",
    "BV146": "BV145+FV145",
    "BW146": "BW145+FW145",
    "BX146": "BX145+FX145",
    "BY146": "BY145+FY145",
    "BZ146": "BZ145+FZ145",
    "CA146": "CA145+GA145",
    "CB146": "CB145+GB145",
    "CC146": "CC145+GC145",
    "CD146": "CD145+GD145",
    "CE146": "CE145+GE145",
    "CF146": "CF145+GF145",
    "CG146": "CG145+GG145",
    "CH146": "CH145+GH145",
    "CI146": "CI145+GI145",
    "CJ146": "CJ145+GJ145",
    "CK146": "CK145+GK145",
    "CL146": "CL145+GL145",
    "CM146": "CM145+GM145",
    "CN146": "CN145+GN145",
    "CO146": "CO145+GO145",
    "CS146": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI146,1)",
    "CT146": "INDEX($BD$5:$BD291,BT146)",
    "CU146": "INDEX($BN$5:$BN291,CD146)",
    "CV146": "INDEX($BO$5:$BO291,CE146)",
    "CW146": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG146)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX146": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO146, 1)",
    "CY146": "LET(\n  Base, $CR$6,\n  Damage, $CT146,\n  DamageMastery, $CS146,\n  DemonMastery, $CX146,\n  SPB, $CU146,\n  ITO, $CV146,\n  Shock, $CW146,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ146": "MIN(100%, DA146)",
    "DA146": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK146*1%, 0)",
    "DB146": "LET(\n  Lab, 1+INDEX($BF$5:$BF291,BV146),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC146": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK146*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI291,BY146) + CardCritMastery)",
    "DD146": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK146*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ291,BZ146) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE146": "LET(\n  CF, $DB146,\n  CC, $CZ146,\n  SCM, $DD146,\n  SCC, $DC146,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF146": "LET(\n  CF, $DB146,\n  CC, $DA146,\n  SCM, $DD146,\n  SCC, $DC146,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG146": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH146)), 0)",
    "DH146": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ146*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE291,BU146),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI146": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG291, BW146), 1) + $AE$9)",
    "DJ146": "LET(\n  DpmLab, INDEX($BH$5:$BH291,BX146),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL146, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK146": "(1+$DI146*$DJ146*$AQ$9)",
    "DL146": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK291,CA146),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM146*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM146": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK291,CA146),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM146*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN146": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL291,CB146)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO146": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH146,\n  Rapid, DG146,\n  RDPM, DK146,\n  SuperTower, $DL146,\n  Rend, $DN146,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP146": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ146": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK146),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR146": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP146),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF146-1))",
    "DS146": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG146, DH146),0))",
    "DT146": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP146),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV146, $AR$29), 0))",
    "DU146": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK146),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM291,CC146), $DV146, $AR$29), 0))",
    "DV146": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH146), $AO$29)",
    "DW146": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM146,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146, $DB146), 1),\n\n  DW, $DR146,\n  CL, $DS146,\n  SM, $DT146,\n  SLM, $DU146,\n  SL, $DQ146,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX146": "CY146*(DE146*DO146*DQ146+DW146*DF146)",
    "DZ146": "IF(INDEX($BD$6:$BD291,BT146)=\"\", \"\", INDEX($BD$5:$BD291,BT146+1))",
    "EA146": "IF(OR($AO$25, INDEX($BE$6:$BE291,BU146)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ146)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE291,BU146+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI146*$DJ146*$AQ$9),\n  SuperTower, $DL146,\n  Rend, $DN146,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146, $DB146), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR146,\n  SM, $DT146,\n  SLM, $DU146,\n  SL, $DQ146,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM146, UltCritCard),\n\nCY146*(DE146*OtherDamage*SL+UwDamage*DF146)))",
    "EB146": "IF(INDEX($BF$6:$BF291,BV146)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF291,BV146+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ146,\n  CCUW, $DA146,\n  SCM, $DD146,\n  SCC, $DC146,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146, CF), 1),\n\n  DW, $DR146,\n  CL, $DS146,\n  SM, $DT146,\n  SLM, $DU146,\n  SL, $DQ146,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM146, UltCritCard),\n\nCY146 * (Critical * DO146 * SL + UwDamage * UWCritical)))",
    "EC146": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG291,BW146)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH146,\n  Rapid, DG146,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG291, BW146+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ146*$AQ$9),\n  SuperTower, $DL146,\n  Rend, $DN146,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM291,CC146), $DV146, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM146,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146, $DB146), 1),\n\n  DW, $DR146,\n  CL, $DS146,\n  SM, $DT146,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY146*(DE146*OtherDamage*SL+UWDamage*DF146)))",
    "ED146": "IF(OR($AO$25, INDEX($BH$6:$BH291,BX146)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH291,BX146+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL146, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI146*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM291,CC146), $DV146, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH146,\n  Rapid, DG146,\n  SuperTower, $DL146,\n  Rend, $DN146,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM146,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146, $DB146), 1),\n\n  DW, $DR146,\n  CL, $DS146,\n  SM, $DT146,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY146*(DE146*OtherDamage*SL+UWDamage*DF146)))",
    "EE146": "IF(INDEX($BI$6:$BI291,BY146)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK146, 0),\n  CF, $DB146,\n  CC, $CZ146,\n  CCUW, $DA146,\n  SCM, $DD146,\n  SCC, $AV$17+INDEX($BI$5:$BI291,BY146+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY146 * (Critical*DO146*$DQ146+DW146*UWCritical)))",
    "EF146": "IF(INDEX($BJ$6:$BJ291,BZ146)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK146*1%, 1),\n  CF, $DB146,\n  CC, $CZ146,\n  CCUW, $DA146,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ291,BZ146+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC146,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY146*(Critical*DO146*$DQ146+DW146*UWCritical)))",
    "EG146": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK291,CA146)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH146,\n  Rapid, DG146,\n  DPM, (1+$DI146*$DJ146*$AQ$9),\n  Rend, $DN146,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK291,CA146+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM146*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146, $DB146), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK291,CA146+1)-1))/(45-CM146*3),1),\n\n  SL, $DQ146,\n  DW, $DR146,\n  CL, $DS146,\n  SM, $DT146,\n  SLM, $DU146,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY146*(DE146*OtherDamage*SL+UwDamage*DF146)))",
    "EH146": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL291,CB146+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL291,CB146)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH146,\n  Rapid, DG146,\n  DPM, (1+$DI146*$DJ146*$AQ$9),\n  SuperTower, $DL146,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL291,CB146+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY146*(DE146*OtherDamage*$DQ146+DW146*DF146)))",
    "EI146": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM291,CC146)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146, $DB146), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK146),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV146, $AR$29), 0),\n\n  DW, $DR146,\n  CL, $DS146,\n  SM, $DT146,\n  SL, $DQ146,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM146, UltCritCard),\nCY146*(DE146*DO146*SL+UwDamage*DF146)))",
    "EJ146": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN291,CD146)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT146,\n  DamageMastery, $CS146,\n  DemonMastery, $CX146,\n  SPB, INDEX($BN$5:$BN291,CD146+1),\n  ITO, $CV146,\n  Shock, $CW146,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE146*DO146*$DQ146+DW146*DF146)))",
    "EK146": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO291,CE146)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT146,\n  DamageMastery, $CS146,\n  DemonMastery, $CX146,\n  SPB, $CU146,\n  ITO, INDEX($BO$5:$BO291,CE146+1),\n  Shock, $CW146,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE146*DO146*$DQ146+DW146*DF146)))",
    "EL146": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP291,CF146)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146, $DB146), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP146),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF146),\n  CL, $DS146,\n  SM, $DT146,\n  SLM, $DU146,\n  SL, $DQ146,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM146, UltCritCard),\nCY146*(DE146*DO146*SL+UwDamage*DF146)))",
    "EM146": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ291,CG146)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG146+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN146": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR291,CH146)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146, $DB146), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH146+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP146),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK146),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM291,CC146), SMHeat, $AR$29), 0),\n\n  DW, $DR146,\n  CL, $DS146,\n  SL, $DQ146,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM146, UltCritCard),\nCY146*(DE146*DO146*SL+UwDamage*DF146)))",
    "EO146": "IF(OR(CI146 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI146+1))",
    "EP146": "IF(OR($AO$25, CJ146 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ146+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE290,BU146),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL146, 1),\n  DPM, (1+$DI146*CardRangeMastery*$DJ146*$AQ$9),\n  SuperTower, $DL146,\n  Rend, $DN146,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146, $DB146), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR146,\n  SM, $DT146,\n  SLM, $DU146,\n  SL, $DQ146,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM146, UltCritCard),\n\nCY146*(DE146*OtherDamage*SL+UwDamage*DF146)))",
    "EQ146": "IF(OR(CK146 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK146+1)*1%, 1),\n  CF, $DB146,\n  CC, MIN(100%, $CZ146 + 1%),\n  CCUW, DA146 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ291,BZ146) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC146 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR146,\n  CL, $DS146,\n  SM, $DT146,\n  SLM, $DU146,\n  SL, $DQ146,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM146, UltCritCard),\n\nCY146 * (Critical*DO146*SL+UwDamage*UWCritical)))",
    "ER146": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL146 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH291,BX146),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL146+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI146*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM291,CC146), $DV146, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH146,\n  Rapid, DG146,\n  SuperTower, $DL146,\n  Rend, $DN146,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM146,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146, $DB146), 1),\n\n  DW, $DR146,\n  CL, $DS146,\n  SM, $DT146,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY146*(DE146*OtherDamage*SL+UWDamage*DF146)))",
    "ES146": "IF(OR(CM146 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH146,\n  Rapid, DG146,\n  RDPM, (1+$DI146*$DJ146*$AQ$9),\n  Rend, $DN146,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK291,CA146),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM146+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146, $DB146), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR146,\n  CL, $DS146,\n  SM, $DT146,\n  SLM, $DU146,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY146*(DE146*OtherDamage*SL+UwDamage*DF146)))",
    "ET146": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN146 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM146,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN146+1, $DB146), 1),\n\n  DW, $DR146,\n  CL, $DS146,\n  SM, $DT146,\n  SLM, $DU146,\n  SL, $DQ146,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY146*(DE146*DO146*SL+UWDamage*DF146)))",
    "EU146": "IF(OR(NOT($BA$3), NOT($BA$23), $CO146 > $BA$15), \"\", 1 + 0.5*(CO146+1))",
    "EW146": "IF(DZ146=\"\", \"\", LET(\n  Now, CT146,\n  Next, DZ146,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT146),\nFactor/Cost))",
    "EX146": "IF(EA146=\"\",\"\",(EA146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU146))",
    "EY146": "IF(EB146=\"\",\"\",(EB146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV146))",
    "EZ146": "IF(EC146=\"\",\"\",(EC146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW146))",
    "FA146": "IF(ED146=\"\",\"\",(ED146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX146))",
    "FB146": "IF(EE146=\"\",\"\",(EE146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY146))",
    "FC146": "IF(EF146=\"\",\"\",(EF146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ146))",
    "FD146": "IF(EG146=\"\",\"\",(EG146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA146))",
    "FE146": "IF(EH146=\"\",\"\",(EH146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB146))",
    "FF146": "IF(EI146=\"\",\"\",(EI146/$DX146-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC146+1, 1, CC146))))",
    "FG146": "IF(EJ146=\"\",\"\",(EJ146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD146))",
    "FH146": "IF(EK146=\"\",\"\",(EK146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE146))",
    "FI146": "IF(EL146=\"\",\"\",(EL146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF146))",
    "FJ146": "IF(EM146=\"\", \"\", LET(\n  Now, CW146,\n  Next, EM146,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG146),\nFactor/Cost))",
    "FK146": "IF(EN146=\"\",\"\",(EN146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH146))",
    "FL146": "IF(EO146=\"\", \"\", LET(\n  Now, CS146,\n  Next, EO146,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI146),\nFactor/Cost))",
    "FM146": "IF(EP146=\"\",\"\",(EP146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ146))",
    "FN146": "IF(EQ146=\"\",\"\",(EQ146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK146))",
    "FO146": "IF(ER146=\"\",\"\",(ER146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL146))",
    "FP146": "IF(ES146=\"\",\"\",(ES146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM146))",
    "FQ146": "IF(ET146=\"\",\"\",(ET146/$DX146-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN146))",
    "FR146": "IF(EU146=\"\", \"\", LET(\n  Now, CX146,\n  Next, EU146,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO146),\nFactor/Cost))",
    "FT146": "IF(COLUMN(EW146:FR146) = MIN(IF(EW146:FR146=MAX(EW146:FR146), COLUMN(EW146:FR146))), 1, \"\")",
    "D147": "IF(SUM(FT146:GP146),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F147)),\"Card Mastery\",F147),G147)/$D$5,\"\")",
    "F147": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT146:GP146),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT146:GP146=1)),)\"),\"Damage\")",
    "G147": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT146:GP146),ARRAYFORMULA(FILTER(BT146:CP146 , FT146:GP146=1)),\"\"\"\")\"),32.0)",
    "I147": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT146:GP146),ARRAYFORMULA(FILTER(EW146:FS146 , FT146:GP146=1))*D$5,\"\"\"\")\"),0.0038790699929692027)",
    "K147": "IF(H147<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D147)),)",
    "BT147": "BT146+FT146",
    "BU147": "BU146+FU146",
    "BV147": "BV146+FV146",
    "BW147": "BW146+FW146",
    "BX147": "BX146+FX146",
    "BY147": "BY146+FY146",
    "BZ147": "BZ146+FZ146",
    "CA147": "CA146+GA146",
    "CB147": "CB146+GB146",
    "CC147": "CC146+GC146",
    "CD147": "CD146+GD146",
    "CE147": "CE146+GE146",
    "CF147": "CF146+GF146",
    "CG147": "CG146+GG146",
    "CH147": "CH146+GH146",
    "CI147": "CI146+GI146",
    "CJ147": "CJ146+GJ146",
    "CK147": "CK146+GK146",
    "CL147": "CL146+GL146",
    "CM147": "CM146+GM146",
    "CN147": "CN146+GN146",
    "CO147": "CO146+GO146",
    "CS147": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI147,1)",
    "CT147": "INDEX($BD$5:$BD292,BT147)",
    "CU147": "INDEX($BN$5:$BN292,CD147)",
    "CV147": "INDEX($BO$5:$BO292,CE147)",
    "CW147": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG147)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX147": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO147, 1)",
    "CY147": "LET(\n  Base, $CR$6,\n  Damage, $CT147,\n  DamageMastery, $CS147,\n  DemonMastery, $CX147,\n  SPB, $CU147,\n  ITO, $CV147,\n  Shock, $CW147,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ147": "MIN(100%, DA147)",
    "DA147": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK147*1%, 0)",
    "DB147": "LET(\n  Lab, 1+INDEX($BF$5:$BF292,BV147),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC147": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK147*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI292,BY147) + CardCritMastery)",
    "DD147": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK147*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ292,BZ147) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE147": "LET(\n  CF, $DB147,\n  CC, $CZ147,\n  SCM, $DD147,\n  SCC, $DC147,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF147": "LET(\n  CF, $DB147,\n  CC, $DA147,\n  SCM, $DD147,\n  SCC, $DC147,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG147": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH147)), 0)",
    "DH147": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ147*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE292,BU147),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI147": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG292, BW147), 1) + $AE$9)",
    "DJ147": "LET(\n  DpmLab, INDEX($BH$5:$BH292,BX147),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL147, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK147": "(1+$DI147*$DJ147*$AQ$9)",
    "DL147": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK292,CA147),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM147*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM147": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK292,CA147),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM147*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN147": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL292,CB147)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO147": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH147,\n  Rapid, DG147,\n  RDPM, DK147,\n  SuperTower, $DL147,\n  Rend, $DN147,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP147": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ147": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK147),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR147": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP147),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF147-1))",
    "DS147": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG147, DH147),0))",
    "DT147": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP147),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV147, $AR$29), 0))",
    "DU147": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK147),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM292,CC147), $DV147, $AR$29), 0))",
    "DV147": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH147), $AO$29)",
    "DW147": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM147,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147, $DB147), 1),\n\n  DW, $DR147,\n  CL, $DS147,\n  SM, $DT147,\n  SLM, $DU147,\n  SL, $DQ147,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX147": "CY147*(DE147*DO147*DQ147+DW147*DF147)",
    "DZ147": "IF(INDEX($BD$6:$BD292,BT147)=\"\", \"\", INDEX($BD$5:$BD292,BT147+1))",
    "EA147": "IF(OR($AO$25, INDEX($BE$6:$BE292,BU147)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ147)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE292,BU147+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI147*$DJ147*$AQ$9),\n  SuperTower, $DL147,\n  Rend, $DN147,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147, $DB147), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR147,\n  SM, $DT147,\n  SLM, $DU147,\n  SL, $DQ147,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM147, UltCritCard),\n\nCY147*(DE147*OtherDamage*SL+UwDamage*DF147)))",
    "EB147": "IF(INDEX($BF$6:$BF292,BV147)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF292,BV147+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ147,\n  CCUW, $DA147,\n  SCM, $DD147,\n  SCC, $DC147,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147, CF), 1),\n\n  DW, $DR147,\n  CL, $DS147,\n  SM, $DT147,\n  SLM, $DU147,\n  SL, $DQ147,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM147, UltCritCard),\n\nCY147 * (Critical * DO147 * SL + UwDamage * UWCritical)))",
    "EC147": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG292,BW147)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH147,\n  Rapid, DG147,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG292, BW147+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ147*$AQ$9),\n  SuperTower, $DL147,\n  Rend, $DN147,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM292,CC147), $DV147, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM147,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147, $DB147), 1),\n\n  DW, $DR147,\n  CL, $DS147,\n  SM, $DT147,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY147*(DE147*OtherDamage*SL+UWDamage*DF147)))",
    "ED147": "IF(OR($AO$25, INDEX($BH$6:$BH292,BX147)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH292,BX147+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL147, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI147*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM292,CC147), $DV147, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH147,\n  Rapid, DG147,\n  SuperTower, $DL147,\n  Rend, $DN147,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM147,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147, $DB147), 1),\n\n  DW, $DR147,\n  CL, $DS147,\n  SM, $DT147,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY147*(DE147*OtherDamage*SL+UWDamage*DF147)))",
    "EE147": "IF(INDEX($BI$6:$BI292,BY147)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK147, 0),\n  CF, $DB147,\n  CC, $CZ147,\n  CCUW, $DA147,\n  SCM, $DD147,\n  SCC, $AV$17+INDEX($BI$5:$BI292,BY147+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY147 * (Critical*DO147*$DQ147+DW147*UWCritical)))",
    "EF147": "IF(INDEX($BJ$6:$BJ292,BZ147)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK147*1%, 1),\n  CF, $DB147,\n  CC, $CZ147,\n  CCUW, $DA147,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ292,BZ147+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC147,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY147*(Critical*DO147*$DQ147+DW147*UWCritical)))",
    "EG147": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK292,CA147)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH147,\n  Rapid, DG147,\n  DPM, (1+$DI147*$DJ147*$AQ$9),\n  Rend, $DN147,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK292,CA147+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM147*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147, $DB147), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK292,CA147+1)-1))/(45-CM147*3),1),\n\n  SL, $DQ147,\n  DW, $DR147,\n  CL, $DS147,\n  SM, $DT147,\n  SLM, $DU147,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY147*(DE147*OtherDamage*SL+UwDamage*DF147)))",
    "EH147": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL292,CB147+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL292,CB147)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH147,\n  Rapid, DG147,\n  DPM, (1+$DI147*$DJ147*$AQ$9),\n  SuperTower, $DL147,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL292,CB147+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY147*(DE147*OtherDamage*$DQ147+DW147*DF147)))",
    "EI147": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM292,CC147)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147, $DB147), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK147),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV147, $AR$29), 0),\n\n  DW, $DR147,\n  CL, $DS147,\n  SM, $DT147,\n  SL, $DQ147,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM147, UltCritCard),\nCY147*(DE147*DO147*SL+UwDamage*DF147)))",
    "EJ147": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN292,CD147)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT147,\n  DamageMastery, $CS147,\n  DemonMastery, $CX147,\n  SPB, INDEX($BN$5:$BN292,CD147+1),\n  ITO, $CV147,\n  Shock, $CW147,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE147*DO147*$DQ147+DW147*DF147)))",
    "EK147": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO292,CE147)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT147,\n  DamageMastery, $CS147,\n  DemonMastery, $CX147,\n  SPB, $CU147,\n  ITO, INDEX($BO$5:$BO292,CE147+1),\n  Shock, $CW147,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE147*DO147*$DQ147+DW147*DF147)))",
    "EL147": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP292,CF147)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147, $DB147), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP147),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF147),\n  CL, $DS147,\n  SM, $DT147,\n  SLM, $DU147,\n  SL, $DQ147,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM147, UltCritCard),\nCY147*(DE147*DO147*SL+UwDamage*DF147)))",
    "EM147": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ292,CG147)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG147+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN147": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR292,CH147)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147, $DB147), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH147+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP147),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK147),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM292,CC147), SMHeat, $AR$29), 0),\n\n  DW, $DR147,\n  CL, $DS147,\n  SL, $DQ147,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM147, UltCritCard),\nCY147*(DE147*DO147*SL+UwDamage*DF147)))",
    "EO147": "IF(OR(CI147 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI147+1))",
    "EP147": "IF(OR($AO$25, CJ147 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ147+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE291,BU147),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL147, 1),\n  DPM, (1+$DI147*CardRangeMastery*$DJ147*$AQ$9),\n  SuperTower, $DL147,\n  Rend, $DN147,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147, $DB147), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR147,\n  SM, $DT147,\n  SLM, $DU147,\n  SL, $DQ147,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM147, UltCritCard),\n\nCY147*(DE147*OtherDamage*SL+UwDamage*DF147)))",
    "EQ147": "IF(OR(CK147 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK147+1)*1%, 1),\n  CF, $DB147,\n  CC, MIN(100%, $CZ147 + 1%),\n  CCUW, DA147 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ292,BZ147) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC147 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR147,\n  CL, $DS147,\n  SM, $DT147,\n  SLM, $DU147,\n  SL, $DQ147,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM147, UltCritCard),\n\nCY147 * (Critical*DO147*SL+UwDamage*UWCritical)))",
    "ER147": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL147 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH292,BX147),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL147+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI147*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM292,CC147), $DV147, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH147,\n  Rapid, DG147,\n  SuperTower, $DL147,\n  Rend, $DN147,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM147,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147, $DB147), 1),\n\n  DW, $DR147,\n  CL, $DS147,\n  SM, $DT147,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY147*(DE147*OtherDamage*SL+UWDamage*DF147)))",
    "ES147": "IF(OR(CM147 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH147,\n  Rapid, DG147,\n  RDPM, (1+$DI147*$DJ147*$AQ$9),\n  Rend, $DN147,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK292,CA147),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM147+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147, $DB147), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR147,\n  CL, $DS147,\n  SM, $DT147,\n  SLM, $DU147,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY147*(DE147*OtherDamage*SL+UwDamage*DF147)))",
    "ET147": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN147 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM147,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN147+1, $DB147), 1),\n\n  DW, $DR147,\n  CL, $DS147,\n  SM, $DT147,\n  SLM, $DU147,\n  SL, $DQ147,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY147*(DE147*DO147*SL+UWDamage*DF147)))",
    "EU147": "IF(OR(NOT($BA$3), NOT($BA$23), $CO147 > $BA$15), \"\", 1 + 0.5*(CO147+1))",
    "EW147": "IF(DZ147=\"\", \"\", LET(\n  Now, CT147,\n  Next, DZ147,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT147),\nFactor/Cost))",
    "EX147": "IF(EA147=\"\",\"\",(EA147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU147))",
    "EY147": "IF(EB147=\"\",\"\",(EB147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV147))",
    "EZ147": "IF(EC147=\"\",\"\",(EC147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW147))",
    "FA147": "IF(ED147=\"\",\"\",(ED147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX147))",
    "FB147": "IF(EE147=\"\",\"\",(EE147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY147))",
    "FC147": "IF(EF147=\"\",\"\",(EF147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ147))",
    "FD147": "IF(EG147=\"\",\"\",(EG147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA147))",
    "FE147": "IF(EH147=\"\",\"\",(EH147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB147))",
    "FF147": "IF(EI147=\"\",\"\",(EI147/$DX147-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC147+1, 1, CC147))))",
    "FG147": "IF(EJ147=\"\",\"\",(EJ147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD147))",
    "FH147": "IF(EK147=\"\",\"\",(EK147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE147))",
    "FI147": "IF(EL147=\"\",\"\",(EL147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF147))",
    "FJ147": "IF(EM147=\"\", \"\", LET(\n  Now, CW147,\n  Next, EM147,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG147),\nFactor/Cost))",
    "FK147": "IF(EN147=\"\",\"\",(EN147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH147))",
    "FL147": "IF(EO147=\"\", \"\", LET(\n  Now, CS147,\n  Next, EO147,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI147),\nFactor/Cost))",
    "FM147": "IF(EP147=\"\",\"\",(EP147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ147))",
    "FN147": "IF(EQ147=\"\",\"\",(EQ147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK147))",
    "FO147": "IF(ER147=\"\",\"\",(ER147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL147))",
    "FP147": "IF(ES147=\"\",\"\",(ES147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM147))",
    "FQ147": "IF(ET147=\"\",\"\",(ET147/$DX147-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN147))",
    "FR147": "IF(EU147=\"\", \"\", LET(\n  Now, CX147,\n  Next, EU147,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO147),\nFactor/Cost))",
    "FT147": "IF(COLUMN(EW147:FR147) = MIN(IF(EW147:FR147=MAX(EW147:FR147), COLUMN(EW147:FR147))), 1, \"\")",
    "D148": "IF(SUM(FT147:GP147),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F148)),\"Card Mastery\",F148),G148)/$D$5,\"\")",
    "F148": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT147:GP147),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT147:GP147=1)),)\"),\"Critical Factor\")",
    "G148": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT147:GP147),ARRAYFORMULA(FILTER(BT147:CP147 , FT147:GP147=1)),\"\"\"\")\"),35.0)",
    "I148": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT147:GP147),ARRAYFORMULA(FILTER(EW147:FS147 , FT147:GP147=1))*D$5,\"\"\"\")\"),0.003791695847374518)",
    "K148": "IF(H148<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D148)),)",
    "BT148": "BT147+FT147",
    "BU148": "BU147+FU147",
    "BV148": "BV147+FV147",
    "BW148": "BW147+FW147",
    "BX148": "BX147+FX147",
    "BY148": "BY147+FY147",
    "BZ148": "BZ147+FZ147",
    "CA148": "CA147+GA147",
    "CB148": "CB147+GB147",
    "CC148": "CC147+GC147",
    "CD148": "CD147+GD147",
    "CE148": "CE147+GE147",
    "CF148": "CF147+GF147",
    "CG148": "CG147+GG147",
    "CH148": "CH147+GH147",
    "CI148": "CI147+GI147",
    "CJ148": "CJ147+GJ147",
    "CK148": "CK147+GK147",
    "CL148": "CL147+GL147",
    "CM148": "CM147+GM147",
    "CN148": "CN147+GN147",
    "CO148": "CO147+GO147",
    "CS148": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI148,1)",
    "CT148": "INDEX($BD$5:$BD293,BT148)",
    "CU148": "INDEX($BN$5:$BN293,CD148)",
    "CV148": "INDEX($BO$5:$BO293,CE148)",
    "CW148": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG148)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX148": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO148, 1)",
    "CY148": "LET(\n  Base, $CR$6,\n  Damage, $CT148,\n  DamageMastery, $CS148,\n  DemonMastery, $CX148,\n  SPB, $CU148,\n  ITO, $CV148,\n  Shock, $CW148,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ148": "MIN(100%, DA148)",
    "DA148": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK148*1%, 0)",
    "DB148": "LET(\n  Lab, 1+INDEX($BF$5:$BF293,BV148),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC148": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK148*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI293,BY148) + CardCritMastery)",
    "DD148": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK148*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ293,BZ148) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE148": "LET(\n  CF, $DB148,\n  CC, $CZ148,\n  SCM, $DD148,\n  SCC, $DC148,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF148": "LET(\n  CF, $DB148,\n  CC, $DA148,\n  SCM, $DD148,\n  SCC, $DC148,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG148": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH148)), 0)",
    "DH148": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ148*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE293,BU148),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI148": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG293, BW148), 1) + $AE$9)",
    "DJ148": "LET(\n  DpmLab, INDEX($BH$5:$BH293,BX148),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL148, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK148": "(1+$DI148*$DJ148*$AQ$9)",
    "DL148": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK293,CA148),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM148*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM148": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK293,CA148),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM148*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN148": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL293,CB148)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO148": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH148,\n  Rapid, DG148,\n  RDPM, DK148,\n  SuperTower, $DL148,\n  Rend, $DN148,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP148": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ148": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK148),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR148": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP148),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF148-1))",
    "DS148": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG148, DH148),0))",
    "DT148": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP148),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV148, $AR$29), 0))",
    "DU148": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK148),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM293,CC148), $DV148, $AR$29), 0))",
    "DV148": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH148), $AO$29)",
    "DW148": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM148,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148, $DB148), 1),\n\n  DW, $DR148,\n  CL, $DS148,\n  SM, $DT148,\n  SLM, $DU148,\n  SL, $DQ148,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX148": "CY148*(DE148*DO148*DQ148+DW148*DF148)",
    "DZ148": "IF(INDEX($BD$6:$BD293,BT148)=\"\", \"\", INDEX($BD$5:$BD293,BT148+1))",
    "EA148": "IF(OR($AO$25, INDEX($BE$6:$BE293,BU148)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ148)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE293,BU148+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI148*$DJ148*$AQ$9),\n  SuperTower, $DL148,\n  Rend, $DN148,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148, $DB148), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR148,\n  SM, $DT148,\n  SLM, $DU148,\n  SL, $DQ148,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM148, UltCritCard),\n\nCY148*(DE148*OtherDamage*SL+UwDamage*DF148)))",
    "EB148": "IF(INDEX($BF$6:$BF293,BV148)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF293,BV148+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ148,\n  CCUW, $DA148,\n  SCM, $DD148,\n  SCC, $DC148,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148, CF), 1),\n\n  DW, $DR148,\n  CL, $DS148,\n  SM, $DT148,\n  SLM, $DU148,\n  SL, $DQ148,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM148, UltCritCard),\n\nCY148 * (Critical * DO148 * SL + UwDamage * UWCritical)))",
    "EC148": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG293,BW148)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH148,\n  Rapid, DG148,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG293, BW148+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ148*$AQ$9),\n  SuperTower, $DL148,\n  Rend, $DN148,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM293,CC148), $DV148, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM148,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148, $DB148), 1),\n\n  DW, $DR148,\n  CL, $DS148,\n  SM, $DT148,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY148*(DE148*OtherDamage*SL+UWDamage*DF148)))",
    "ED148": "IF(OR($AO$25, INDEX($BH$6:$BH293,BX148)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH293,BX148+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL148, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI148*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM293,CC148), $DV148, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH148,\n  Rapid, DG148,\n  SuperTower, $DL148,\n  Rend, $DN148,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM148,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148, $DB148), 1),\n\n  DW, $DR148,\n  CL, $DS148,\n  SM, $DT148,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY148*(DE148*OtherDamage*SL+UWDamage*DF148)))",
    "EE148": "IF(INDEX($BI$6:$BI293,BY148)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK148, 0),\n  CF, $DB148,\n  CC, $CZ148,\n  CCUW, $DA148,\n  SCM, $DD148,\n  SCC, $AV$17+INDEX($BI$5:$BI293,BY148+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY148 * (Critical*DO148*$DQ148+DW148*UWCritical)))",
    "EF148": "IF(INDEX($BJ$6:$BJ293,BZ148)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK148*1%, 1),\n  CF, $DB148,\n  CC, $CZ148,\n  CCUW, $DA148,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ293,BZ148+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC148,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY148*(Critical*DO148*$DQ148+DW148*UWCritical)))",
    "EG148": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK293,CA148)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH148,\n  Rapid, DG148,\n  DPM, (1+$DI148*$DJ148*$AQ$9),\n  Rend, $DN148,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK293,CA148+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM148*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148, $DB148), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK293,CA148+1)-1))/(45-CM148*3),1),\n\n  SL, $DQ148,\n  DW, $DR148,\n  CL, $DS148,\n  SM, $DT148,\n  SLM, $DU148,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY148*(DE148*OtherDamage*SL+UwDamage*DF148)))",
    "EH148": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL293,CB148+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL293,CB148)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH148,\n  Rapid, DG148,\n  DPM, (1+$DI148*$DJ148*$AQ$9),\n  SuperTower, $DL148,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL293,CB148+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY148*(DE148*OtherDamage*$DQ148+DW148*DF148)))",
    "EI148": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM293,CC148)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148, $DB148), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK148),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV148, $AR$29), 0),\n\n  DW, $DR148,\n  CL, $DS148,\n  SM, $DT148,\n  SL, $DQ148,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM148, UltCritCard),\nCY148*(DE148*DO148*SL+UwDamage*DF148)))",
    "EJ148": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN293,CD148)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT148,\n  DamageMastery, $CS148,\n  DemonMastery, $CX148,\n  SPB, INDEX($BN$5:$BN293,CD148+1),\n  ITO, $CV148,\n  Shock, $CW148,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE148*DO148*$DQ148+DW148*DF148)))",
    "EK148": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO293,CE148)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT148,\n  DamageMastery, $CS148,\n  DemonMastery, $CX148,\n  SPB, $CU148,\n  ITO, INDEX($BO$5:$BO293,CE148+1),\n  Shock, $CW148,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE148*DO148*$DQ148+DW148*DF148)))",
    "EL148": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP293,CF148)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148, $DB148), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP148),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF148),\n  CL, $DS148,\n  SM, $DT148,\n  SLM, $DU148,\n  SL, $DQ148,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM148, UltCritCard),\nCY148*(DE148*DO148*SL+UwDamage*DF148)))",
    "EM148": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ293,CG148)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG148+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN148": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR293,CH148)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148, $DB148), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH148+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP148),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK148),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM293,CC148), SMHeat, $AR$29), 0),\n\n  DW, $DR148,\n  CL, $DS148,\n  SL, $DQ148,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM148, UltCritCard),\nCY148*(DE148*DO148*SL+UwDamage*DF148)))",
    "EO148": "IF(OR(CI148 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI148+1))",
    "EP148": "IF(OR($AO$25, CJ148 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ148+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE292,BU148),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL148, 1),\n  DPM, (1+$DI148*CardRangeMastery*$DJ148*$AQ$9),\n  SuperTower, $DL148,\n  Rend, $DN148,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148, $DB148), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR148,\n  SM, $DT148,\n  SLM, $DU148,\n  SL, $DQ148,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM148, UltCritCard),\n\nCY148*(DE148*OtherDamage*SL+UwDamage*DF148)))",
    "EQ148": "IF(OR(CK148 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK148+1)*1%, 1),\n  CF, $DB148,\n  CC, MIN(100%, $CZ148 + 1%),\n  CCUW, DA148 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ293,BZ148) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC148 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR148,\n  CL, $DS148,\n  SM, $DT148,\n  SLM, $DU148,\n  SL, $DQ148,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM148, UltCritCard),\n\nCY148 * (Critical*DO148*SL+UwDamage*UWCritical)))",
    "ER148": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL148 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH293,BX148),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL148+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI148*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM293,CC148), $DV148, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH148,\n  Rapid, DG148,\n  SuperTower, $DL148,\n  Rend, $DN148,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM148,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148, $DB148), 1),\n\n  DW, $DR148,\n  CL, $DS148,\n  SM, $DT148,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY148*(DE148*OtherDamage*SL+UWDamage*DF148)))",
    "ES148": "IF(OR(CM148 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH148,\n  Rapid, DG148,\n  RDPM, (1+$DI148*$DJ148*$AQ$9),\n  Rend, $DN148,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK293,CA148),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM148+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148, $DB148), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR148,\n  CL, $DS148,\n  SM, $DT148,\n  SLM, $DU148,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY148*(DE148*OtherDamage*SL+UwDamage*DF148)))",
    "ET148": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN148 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM148,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN148+1, $DB148), 1),\n\n  DW, $DR148,\n  CL, $DS148,\n  SM, $DT148,\n  SLM, $DU148,\n  SL, $DQ148,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY148*(DE148*DO148*SL+UWDamage*DF148)))",
    "EU148": "IF(OR(NOT($BA$3), NOT($BA$23), $CO148 > $BA$15), \"\", 1 + 0.5*(CO148+1))",
    "EW148": "IF(DZ148=\"\", \"\", LET(\n  Now, CT148,\n  Next, DZ148,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT148),\nFactor/Cost))",
    "EX148": "IF(EA148=\"\",\"\",(EA148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU148))",
    "EY148": "IF(EB148=\"\",\"\",(EB148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV148))",
    "EZ148": "IF(EC148=\"\",\"\",(EC148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW148))",
    "FA148": "IF(ED148=\"\",\"\",(ED148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX148))",
    "FB148": "IF(EE148=\"\",\"\",(EE148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY148))",
    "FC148": "IF(EF148=\"\",\"\",(EF148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ148))",
    "FD148": "IF(EG148=\"\",\"\",(EG148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA148))",
    "FE148": "IF(EH148=\"\",\"\",(EH148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB148))",
    "FF148": "IF(EI148=\"\",\"\",(EI148/$DX148-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC148+1, 1, CC148))))",
    "FG148": "IF(EJ148=\"\",\"\",(EJ148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD148))",
    "FH148": "IF(EK148=\"\",\"\",(EK148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE148))",
    "FI148": "IF(EL148=\"\",\"\",(EL148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF148))",
    "FJ148": "IF(EM148=\"\", \"\", LET(\n  Now, CW148,\n  Next, EM148,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG148),\nFactor/Cost))",
    "FK148": "IF(EN148=\"\",\"\",(EN148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH148))",
    "FL148": "IF(EO148=\"\", \"\", LET(\n  Now, CS148,\n  Next, EO148,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI148),\nFactor/Cost))",
    "FM148": "IF(EP148=\"\",\"\",(EP148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ148))",
    "FN148": "IF(EQ148=\"\",\"\",(EQ148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK148))",
    "FO148": "IF(ER148=\"\",\"\",(ER148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL148))",
    "FP148": "IF(ES148=\"\",\"\",(ES148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM148))",
    "FQ148": "IF(ET148=\"\",\"\",(ET148/$DX148-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN148))",
    "FR148": "IF(EU148=\"\", \"\", LET(\n  Now, CX148,\n  Next, EU148,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO148),\nFactor/Cost))",
    "FT148": "IF(COLUMN(EW148:FR148) = MIN(IF(EW148:FR148=MAX(EW148:FR148), COLUMN(EW148:FR148))), 1, \"\")",
    "D149": "IF(SUM(FT148:GP148),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F149)),\"Card Mastery\",F149),G149)/$D$5,\"\")",
    "F149": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT148:GP148),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT148:GP148=1)),)\"),\"Attack Speed\")",
    "G149": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT148:GP148),ARRAYFORMULA(FILTER(BT148:CP148 , FT148:GP148=1)),\"\"\"\")\"),32.0)",
    "I149": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT148:GP148),ARRAYFORMULA(FILTER(EW148:FS148 , FT148:GP148=1))*D$5,\"\"\"\")\"),0.003788353812301768)",
    "K149": "IF(H149<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D149)),)",
    "BT149": "BT148+FT148",
    "BU149": "BU148+FU148",
    "BV149": "BV148+FV148",
    "BW149": "BW148+FW148",
    "BX149": "BX148+FX148",
    "BY149": "BY148+FY148",
    "BZ149": "BZ148+FZ148",
    "CA149": "CA148+GA148",
    "CB149": "CB148+GB148",
    "CC149": "CC148+GC148",
    "CD149": "CD148+GD148",
    "CE149": "CE148+GE148",
    "CF149": "CF148+GF148",
    "CG149": "CG148+GG148",
    "CH149": "CH148+GH148",
    "CI149": "CI148+GI148",
    "CJ149": "CJ148+GJ148",
    "CK149": "CK148+GK148",
    "CL149": "CL148+GL148",
    "CM149": "CM148+GM148",
    "CN149": "CN148+GN148",
    "CO149": "CO148+GO148",
    "CS149": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI149,1)",
    "CT149": "INDEX($BD$5:$BD294,BT149)",
    "CU149": "INDEX($BN$5:$BN294,CD149)",
    "CV149": "INDEX($BO$5:$BO294,CE149)",
    "CW149": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG149)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX149": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO149, 1)",
    "CY149": "LET(\n  Base, $CR$6,\n  Damage, $CT149,\n  DamageMastery, $CS149,\n  DemonMastery, $CX149,\n  SPB, $CU149,\n  ITO, $CV149,\n  Shock, $CW149,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ149": "MIN(100%, DA149)",
    "DA149": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK149*1%, 0)",
    "DB149": "LET(\n  Lab, 1+INDEX($BF$5:$BF294,BV149),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC149": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK149*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI294,BY149) + CardCritMastery)",
    "DD149": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK149*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ294,BZ149) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE149": "LET(\n  CF, $DB149,\n  CC, $CZ149,\n  SCM, $DD149,\n  SCC, $DC149,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF149": "LET(\n  CF, $DB149,\n  CC, $DA149,\n  SCM, $DD149,\n  SCC, $DC149,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG149": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH149)), 0)",
    "DH149": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ149*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE294,BU149),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI149": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG294, BW149), 1) + $AE$9)",
    "DJ149": "LET(\n  DpmLab, INDEX($BH$5:$BH294,BX149),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL149, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK149": "(1+$DI149*$DJ149*$AQ$9)",
    "DL149": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK294,CA149),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM149*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM149": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK294,CA149),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM149*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN149": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL294,CB149)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO149": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH149,\n  Rapid, DG149,\n  RDPM, DK149,\n  SuperTower, $DL149,\n  Rend, $DN149,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP149": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ149": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK149),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR149": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP149),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF149-1))",
    "DS149": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG149, DH149),0))",
    "DT149": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP149),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV149, $AR$29), 0))",
    "DU149": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK149),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM294,CC149), $DV149, $AR$29), 0))",
    "DV149": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH149), $AO$29)",
    "DW149": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM149,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149, $DB149), 1),\n\n  DW, $DR149,\n  CL, $DS149,\n  SM, $DT149,\n  SLM, $DU149,\n  SL, $DQ149,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX149": "CY149*(DE149*DO149*DQ149+DW149*DF149)",
    "DZ149": "IF(INDEX($BD$6:$BD294,BT149)=\"\", \"\", INDEX($BD$5:$BD294,BT149+1))",
    "EA149": "IF(OR($AO$25, INDEX($BE$6:$BE294,BU149)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ149)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE294,BU149+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI149*$DJ149*$AQ$9),\n  SuperTower, $DL149,\n  Rend, $DN149,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149, $DB149), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR149,\n  SM, $DT149,\n  SLM, $DU149,\n  SL, $DQ149,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM149, UltCritCard),\n\nCY149*(DE149*OtherDamage*SL+UwDamage*DF149)))",
    "EB149": "IF(INDEX($BF$6:$BF294,BV149)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF294,BV149+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ149,\n  CCUW, $DA149,\n  SCM, $DD149,\n  SCC, $DC149,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149, CF), 1),\n\n  DW, $DR149,\n  CL, $DS149,\n  SM, $DT149,\n  SLM, $DU149,\n  SL, $DQ149,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM149, UltCritCard),\n\nCY149 * (Critical * DO149 * SL + UwDamage * UWCritical)))",
    "EC149": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG294,BW149)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH149,\n  Rapid, DG149,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG294, BW149+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ149*$AQ$9),\n  SuperTower, $DL149,\n  Rend, $DN149,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM294,CC149), $DV149, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM149,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149, $DB149), 1),\n\n  DW, $DR149,\n  CL, $DS149,\n  SM, $DT149,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY149*(DE149*OtherDamage*SL+UWDamage*DF149)))",
    "ED149": "IF(OR($AO$25, INDEX($BH$6:$BH294,BX149)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH294,BX149+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL149, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI149*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM294,CC149), $DV149, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH149,\n  Rapid, DG149,\n  SuperTower, $DL149,\n  Rend, $DN149,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM149,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149, $DB149), 1),\n\n  DW, $DR149,\n  CL, $DS149,\n  SM, $DT149,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY149*(DE149*OtherDamage*SL+UWDamage*DF149)))",
    "EE149": "IF(INDEX($BI$6:$BI294,BY149)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK149, 0),\n  CF, $DB149,\n  CC, $CZ149,\n  CCUW, $DA149,\n  SCM, $DD149,\n  SCC, $AV$17+INDEX($BI$5:$BI294,BY149+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY149 * (Critical*DO149*$DQ149+DW149*UWCritical)))",
    "EF149": "IF(INDEX($BJ$6:$BJ294,BZ149)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK149*1%, 1),\n  CF, $DB149,\n  CC, $CZ149,\n  CCUW, $DA149,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ294,BZ149+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC149,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY149*(Critical*DO149*$DQ149+DW149*UWCritical)))",
    "EG149": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK294,CA149)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH149,\n  Rapid, DG149,\n  DPM, (1+$DI149*$DJ149*$AQ$9),\n  Rend, $DN149,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK294,CA149+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM149*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149, $DB149), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK294,CA149+1)-1))/(45-CM149*3),1),\n\n  SL, $DQ149,\n  DW, $DR149,\n  CL, $DS149,\n  SM, $DT149,\n  SLM, $DU149,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY149*(DE149*OtherDamage*SL+UwDamage*DF149)))",
    "EH149": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL294,CB149+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL294,CB149)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH149,\n  Rapid, DG149,\n  DPM, (1+$DI149*$DJ149*$AQ$9),\n  SuperTower, $DL149,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL294,CB149+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY149*(DE149*OtherDamage*$DQ149+DW149*DF149)))",
    "EI149": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM294,CC149)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149, $DB149), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK149),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV149, $AR$29), 0),\n\n  DW, $DR149,\n  CL, $DS149,\n  SM, $DT149,\n  SL, $DQ149,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM149, UltCritCard),\nCY149*(DE149*DO149*SL+UwDamage*DF149)))",
    "EJ149": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN294,CD149)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT149,\n  DamageMastery, $CS149,\n  DemonMastery, $CX149,\n  SPB, INDEX($BN$5:$BN294,CD149+1),\n  ITO, $CV149,\n  Shock, $CW149,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE149*DO149*$DQ149+DW149*DF149)))",
    "EK149": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO294,CE149)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT149,\n  DamageMastery, $CS149,\n  DemonMastery, $CX149,\n  SPB, $CU149,\n  ITO, INDEX($BO$5:$BO294,CE149+1),\n  Shock, $CW149,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE149*DO149*$DQ149+DW149*DF149)))",
    "EL149": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP294,CF149)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149, $DB149), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP149),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF149),\n  CL, $DS149,\n  SM, $DT149,\n  SLM, $DU149,\n  SL, $DQ149,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM149, UltCritCard),\nCY149*(DE149*DO149*SL+UwDamage*DF149)))",
    "EM149": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ294,CG149)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG149+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN149": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR294,CH149)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149, $DB149), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH149+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP149),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK149),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM294,CC149), SMHeat, $AR$29), 0),\n\n  DW, $DR149,\n  CL, $DS149,\n  SL, $DQ149,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM149, UltCritCard),\nCY149*(DE149*DO149*SL+UwDamage*DF149)))",
    "EO149": "IF(OR(CI149 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI149+1))",
    "EP149": "IF(OR($AO$25, CJ149 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ149+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE293,BU149),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL149, 1),\n  DPM, (1+$DI149*CardRangeMastery*$DJ149*$AQ$9),\n  SuperTower, $DL149,\n  Rend, $DN149,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149, $DB149), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR149,\n  SM, $DT149,\n  SLM, $DU149,\n  SL, $DQ149,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM149, UltCritCard),\n\nCY149*(DE149*OtherDamage*SL+UwDamage*DF149)))",
    "EQ149": "IF(OR(CK149 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK149+1)*1%, 1),\n  CF, $DB149,\n  CC, MIN(100%, $CZ149 + 1%),\n  CCUW, DA149 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ294,BZ149) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC149 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR149,\n  CL, $DS149,\n  SM, $DT149,\n  SLM, $DU149,\n  SL, $DQ149,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM149, UltCritCard),\n\nCY149 * (Critical*DO149*SL+UwDamage*UWCritical)))",
    "ER149": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL149 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH294,BX149),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL149+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI149*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM294,CC149), $DV149, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH149,\n  Rapid, DG149,\n  SuperTower, $DL149,\n  Rend, $DN149,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM149,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149, $DB149), 1),\n\n  DW, $DR149,\n  CL, $DS149,\n  SM, $DT149,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY149*(DE149*OtherDamage*SL+UWDamage*DF149)))",
    "ES149": "IF(OR(CM149 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH149,\n  Rapid, DG149,\n  RDPM, (1+$DI149*$DJ149*$AQ$9),\n  Rend, $DN149,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK294,CA149),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM149+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149, $DB149), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR149,\n  CL, $DS149,\n  SM, $DT149,\n  SLM, $DU149,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY149*(DE149*OtherDamage*SL+UwDamage*DF149)))",
    "ET149": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN149 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM149,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN149+1, $DB149), 1),\n\n  DW, $DR149,\n  CL, $DS149,\n  SM, $DT149,\n  SLM, $DU149,\n  SL, $DQ149,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY149*(DE149*DO149*SL+UWDamage*DF149)))",
    "EU149": "IF(OR(NOT($BA$3), NOT($BA$23), $CO149 > $BA$15), \"\", 1 + 0.5*(CO149+1))",
    "EW149": "IF(DZ149=\"\", \"\", LET(\n  Now, CT149,\n  Next, DZ149,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT149),\nFactor/Cost))",
    "EX149": "IF(EA149=\"\",\"\",(EA149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU149))",
    "EY149": "IF(EB149=\"\",\"\",(EB149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV149))",
    "EZ149": "IF(EC149=\"\",\"\",(EC149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW149))",
    "FA149": "IF(ED149=\"\",\"\",(ED149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX149))",
    "FB149": "IF(EE149=\"\",\"\",(EE149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY149))",
    "FC149": "IF(EF149=\"\",\"\",(EF149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ149))",
    "FD149": "IF(EG149=\"\",\"\",(EG149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA149))",
    "FE149": "IF(EH149=\"\",\"\",(EH149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB149))",
    "FF149": "IF(EI149=\"\",\"\",(EI149/$DX149-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC149+1, 1, CC149))))",
    "FG149": "IF(EJ149=\"\",\"\",(EJ149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD149))",
    "FH149": "IF(EK149=\"\",\"\",(EK149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE149))",
    "FI149": "IF(EL149=\"\",\"\",(EL149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF149))",
    "FJ149": "IF(EM149=\"\", \"\", LET(\n  Now, CW149,\n  Next, EM149,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG149),\nFactor/Cost))",
    "FK149": "IF(EN149=\"\",\"\",(EN149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH149))",
    "FL149": "IF(EO149=\"\", \"\", LET(\n  Now, CS149,\n  Next, EO149,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI149),\nFactor/Cost))",
    "FM149": "IF(EP149=\"\",\"\",(EP149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ149))",
    "FN149": "IF(EQ149=\"\",\"\",(EQ149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK149))",
    "FO149": "IF(ER149=\"\",\"\",(ER149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL149))",
    "FP149": "IF(ES149=\"\",\"\",(ES149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM149))",
    "FQ149": "IF(ET149=\"\",\"\",(ET149/$DX149-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN149))",
    "FR149": "IF(EU149=\"\", \"\", LET(\n  Now, CX149,\n  Next, EU149,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO149),\nFactor/Cost))",
    "FT149": "IF(COLUMN(EW149:FR149) = MIN(IF(EW149:FR149=MAX(EW149:FR149), COLUMN(EW149:FR149))), 1, \"\")",
    "D150": "IF(SUM(FT149:GP149),LABDURATION_SINGLE_ADJUSTED(IF(ISNUMBER(SEARCH(\"Mastery\",F150)),\"Card Mastery\",F150),G150)/$D$5,\"\")",
    "F150": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT149:GP149),ARRAYFORMULA(FILTER(FT$4:GP$4 , FT149:GP149=1)),)\"),\"Damage / Meter\")",
    "G150": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT149:GP149),ARRAYFORMULA(FILTER(BT149:CP149 , FT149:GP149=1)),\"\"\"\")\"),25.0)",
    "I150": "IFERROR(__xludf.DUMMYFUNCTION(\"IF(SUM(FT149:GP149),ARRAYFORMULA(FILTER(EW149:FS149 , FT149:GP149=1))*D$5,\"\"\"\")\"),0.003759242480757783)",
    "K150": "IF(H150<>\"\",FORMAT_TIME_YEAR(SUM($D$6:$D150)),)",
    "BT150": "BT149+FT149",
    "BU150": "BU149+FU149",
    "BV150": "BV149+FV149",
    "BW150": "BW149+FW149",
    "BX150": "BX149+FX149",
    "BY150": "BY149+FY149",
    "BZ150": "BZ149+FZ149",
    "CA150": "CA149+GA149",
    "CB150": "CB149+GB149",
    "CC150": "CC149+GC149",
    "CD150": "CD149+GD149",
    "CE150": "CE149+GE149",
    "CF150": "CF149+GF149",
    "CG150": "CG149+GG149",
    "CH150": "CH149+GH149",
    "CI150": "CI149+GI149",
    "CJ150": "CJ149+GJ149",
    "CK150": "CK149+GK149",
    "CL150": "CL149+GL149",
    "CM150": "CM149+GM149",
    "CN150": "CN149+GN149",
    "CO150": "CO149+GO149",
    "CS150": "IF(AND($BA$5,$BA$3, $BA$17),1+0.4*CI150,1)",
    "CT150": "INDEX($BD$5:$BD295,BT150)",
    "CU150": "INDEX($BN$5:$BN295,CD150)",
    "CV150": "INDEX($BO$5:$BO295,CE150)",
    "CW150": "LET(\n  HasDC, $AN$27>0,\nIF(AND($AH$27,$AH$34),(1+INDEX($BQ$5:$BQ$19,CG150)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1), 1))",
    "CX150": "IF(AND($BA$3,$BA$23), 1 + 0.5*CO150, 1)",
    "CY150": "LET(\n  Base, $CR$6,\n  Damage, $CT150,\n  DamageMastery, $CS150,\n  DemonMastery, $CX150,\n  SPB, $CU150,\n  ITO, $CV150,\n  Shock, $CW150,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\nBase * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO *Shock)",
    "CZ150": "MIN(100%, DA150)",
    "DA150": "$AV$8 + IF(AND($BA$3,$BA$8,$BA$19), CK150*1%, 0)",
    "DB150": "LET(\n  Lab, 1+INDEX($BF$5:$BF295,BV150),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n($AV$7 * Lab + Substat) * Relics * WSPlus)\n",
    "DC150": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), CK150*1%, 0),\n\n$AV$17+INDEX($BI$5:$BI295,BY150) + CardCritMastery)",
    "DD150": "LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK150*1%, 1),\n\n(($AN$18 * INDEX($BJ$5:$BJ295,BZ150) + $AE$12) * $AQ$18) * CardCritMastery)",
    "DE150": "LET(\n  CF, $DB150,\n  CC, $CZ150,\n  SCM, $DD150,\n  SCC, $DC150,\n\n(1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM))",
    "DF150": "LET(\n  CF, $DB150,\n  CC, $DA150,\n  SCM, $DD150,\n  SCC, $DC150,\n\n(1+CC*CF)*(1+CC*SCC*SCM))",
    "DG150": "1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*DH150)), 0)",
    "DH150": "LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+CJ150*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE295,BU150),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\nBULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd))",
    "DI150": "($AV$9 * IF($AH$9,INDEX($BG$5:$BG295, BW150), 1) + $AE$9)",
    "DJ150": "LET(\n  DpmLab, INDEX($BH$5:$BH295,BX150),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL150, 1),\n\n\n(DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault)",
    "DK150": "(1+$DI150*$DJ150*$AQ$9)",
    "DL150": "LET(\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK295,CA150),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM150*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n\nIF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1))",
    "DM150": "LET(\n  HasST, AND($BA$3,$BA$10),\n  STLab, INDEX($BK$5:$BK295,CA150),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM150*3,\n\nIF(AND(HasST,$BA$21),1+(15 * (35%*STBonus-1))/STCooldown,1))",
    "DN150": "LET(\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL295,CB150)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n  CappedRend)",
    "DO150": "LET(\n  Multishot, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH150,\n  Rapid, DG150,\n  RDPM, DK150,\n  SuperTower, $DL150,\n  Rend, $DN150,\nMultishot * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend)",
    "DP150": "LET(\n  WdReco, AV$20+$AK$20,\n  WdRecoBoss, IF(EQ($AI$21, 1), (WdReco*($AQ$21-1)+100%)/$AQ$21, WdReco),\n  PackageTimeGain, -IF(AE$35, AE$35*WdRecoBoss,0),\n1-PackageTimeGain/(CR$15+PackageTimeGain)\n)",
    "DQ150": "LET(\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK150),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n\nIF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1))",
    "DR150": "LET(\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP150),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\nEP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF150-1))",
    "DS150": "LET(\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\nIF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, $CR$9*CR$11*DG150, DH150),0))",
    "DT150": "LET(\n  SMDamage, STAT_UW_SM_FINAL_DMG($AI$35, $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP150),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n\nIF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, $DV150, $AR$29), 0))",
    "DU150": "LET(\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK150),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n\nIF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM295,CC150), $DV150, $AR$29), 0))",
    "DV150": "EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH150), $AO$29)",
    "DW150": "LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM150,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150, $DB150), 1),\n\n  DW, $DR150,\n  CL, $DS150,\n  SM, $DT150,\n  SLM, $DU150,\n  SL, $DQ150,\nEP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard))",
    "DX150": "CY150*(DE150*DO150*DQ150+DW150*DF150)",
    "DY150": "LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150+1, $DB150), 1),\n\n  DW, $DR150,\n  CL, $DS150,\n  SM, $DT150,\n  SLM, $DU150,\n  SL, $CR160,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM150, UltCritCard),\n  HideCondition, OR(NOT($AH$35), NOT($BA$3), NOT($BA$11), NOT($BA$22), CN150 > $BA$15),\nIF(HideCondition, \"\", CY150*(DE150*DO150*CR$15+UwDamage*DF150)))",
    "DZ150": "IF(INDEX($BD$6:$BD295,BT150)=\"\", \"\", INDEX($BD$5:$BD295,BT150+1))",
    "EA150": "IF(OR($AO$25, INDEX($BE$6:$BE295,BU150)=\"\"), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ150)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE295,BU150+1),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  DPM, (1+$DI150*$DJ150*$AQ$9),\n  SuperTower, $DL150,\n  Rend, $DN150,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150, $DB150), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n  DW, $DR150,\n  SM, $DT150,\n  SLM, $DU150,\n  SL, $DQ150,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM150, UltCritCard),\n\nCY150*(DE150*OtherDamage*SL+UwDamage*DF150)))",
    "EB150": "IF(INDEX($BF$6:$BF295,BV150)=\"\", \"\", LET(\n  Lab, 1+INDEX($BF$5:$BF295,BV150+1),\n  Substat, $AE$8,\n  Relics, 1+$AR$7,\n  WSPlus, $AQ$7,\n\n  CF, ($AV$7 * Lab + Substat) * Relics * WSPlus,\n\n  CC, $CZ150,\n  CCUW, $DA150,\n  SCM, $DD150,\n  SCC, $DC150,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150, CF), 1),\n\n  DW, $DR150,\n  CL, $DS150,\n  SM, $DT150,\n  SLM, $DU150,\n  SL, $DQ150,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM150, UltCritCard),\n\nCY150 * (Critical * DO150 * SL + UwDamage * UWCritical)))",
    "EC150": "IF(OR($AO$25, NOT($AH$9),INDEX($BG$6:$BG295,BW150)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH150,\n  Rapid, DG150,\n  Range, ($AV$9 * IF($AH$9,INDEX($BG$5:$BG295, BW150+1), 1) + $AE$9),\n  RDPM, (1+Range*$DJ150*$AQ$9),\n  SuperTower, $DL150,\n  Rend, $DN150,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM295,CC150), $DV150, $AR$29), 0),\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM150,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150, $DB150), 1),\n\n  DW, $DR150,\n  CL, $DS150,\n  SM, $DT150,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY150*(DE150*OtherDamage*SL+UWDamage*DF150)))",
    "ED150": "IF(OR($AO$25, INDEX($BH$6:$BH295,BX150)=\"\", EQ($AL$10, 0)), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH295,BX150+1),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL150, 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI150*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM295,CC150), $DV150, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH150,\n  Rapid, DG150,\n  SuperTower, $DL150,\n  Rend, $DN150,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM150,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150, $DB150), 1),\n\n  DW, $DR150,\n  CL, $DS150,\n  SM, $DT150,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY150*(DE150*OtherDamage*SL+UWDamage*DF150)))",
    "EE150": "IF(INDEX($BI$6:$BI295,BY150)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1%*CK150, 0),\n  CF, $DB150,\n  CC, $CZ150,\n  CCUW, $DA150,\n  SCM, $DD150,\n  SCC, $AV$17+INDEX($BI$5:$BI295,BY150+1) + CardCritMastery,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY150 * (Critical*DO150*$DQ150+DW150*UWCritical)))",
    "EF150": "IF(INDEX($BJ$6:$BJ295,BZ150)=\"\", \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+CK150*1%, 1),\n  CF, $DB150,\n  CC, $CZ150,\n  CCUW, $DA150,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ295,BZ150+1) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC150,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\nCY150*(Critical*DO150*$DQ150+DW150*UWCritical)))",
    "EG150": "IF(OR(AND($AO$25, NOT($BA$21)), INDEX($BK$6:$BK295,CA150)=\"\",NOT($BA$3),NOT($BA$10)), \"\", LET(\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH150,\n  Rapid, DG150,\n  DPM, (1+$DI150*$DJ150*$AQ$9),\n  Rend, $DN150,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK295,CA150+1),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-CM150*3,\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150, $DB150), 1),\n  CardStUwMastery, IF(AND($BA$3,$BA$10,$BA$21),1+(15 * (35%*$AZ$10*INDEX($BK$5:$BK295,CA150+1)-1))/(45-CM150*3),1),\n\n  SL, $DQ150,\n  DW, $DR150,\n  CL, $DS150,\n  SM, $DT150,\n  SLM, $DU150,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\nCY150*(DE150*OtherDamage*SL+UwDamage*DF150)))",
    "EH150": "IF(OR($AO$25, AND($BA$38<>\"\", $BA$38 < ($AE$13+INDEX($BL$5:$BL295,CB150+1)/100)*$AQ$19), NOT($AH$19),INDEX($BL$6:$BL295,CB150)=\"\"), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH150,\n  Rapid, DG150,\n  DPM, (1+$DI150*$DJ150*$AQ$9),\n  SuperTower, $DL150,\n  Rend, IF($AH$19, ($AE$13+INDEX($BL$5:$BL295,CB150+1)/100)*$AQ$19, 1),\n  CappedRend, IF($BA$38<>\"\", MIN($BA$38,Rend), Rend),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * CappedRend,\nCY150*(DE150*OtherDamage*$DQ150+DW150*DF150)))",
    "EI150": "IF(OR(NOT(AND($AH$36,$AH$37)), INDEX($BM$6:$BM295,CC150)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150, $DB150), 1),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK150),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, 2, $DV150, $AR$29), 0),\n\n  DW, $DR150,\n  CL, $DS150,\n  SM, $DT150,\n  SL, $DQ150,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM150, UltCritCard),\nCY150*(DE150*DO150*SL+UwDamage*DF150)))",
    "EJ150": "IF(OR(NOT(AND($BA$26, $BA$28)), INDEX($BN$6:$BN295,CD150)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT150,\n  DamageMastery, $CS150,\n  DemonMastery, $CX150,\n  SPB, INDEX($BN$5:$BN295,CD150+1),\n  ITO, $CV150,\n  Shock, $CW150,\n  DamagePerk, (1+0.15*$AY$28)*SPB,\n  DamageTO, IF(AND($BA$26,$BA$30),1.5*ITO,1),\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE150*DO150*$DQ150+DW150*DF150)))",
    "EK150": "IF(OR(NOT(AND($BA$26, $BA$30)), INDEX($BO$6:$BO295,CE150)=\"\"), \"\", LET(\n  Base, $CR$6,\n  Damage, $CT150,\n  DamageMastery, $CS150,\n  DemonMastery, $CX150,\n  SPB, $CU150,\n  ITO, INDEX($BO$5:$BO295,CE150+1),\n  Shock, $CW150,\n  DamagePerk, IF(AND($BA$26,$BA$28),(1+0.15*$AY$28)*SPB,1),\n  DamageTO, 1.5*ITO,\n\n  BaseDamage, Base * Damage * DamageMastery * DemonMastery * DamagePerk * DamageTO * Shock,\n\nBaseDamage * (DE150*DO150*$DQ150+DW150*DF150)))",
    "EL150": "IF(OR(NOT($AH$33), INDEX($BP$6:$BP295,CF150)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150, $DB150), 1),\n\n  DWDamage, STAT_UW_DW_FINAL_DMG($AI$33, $AE$22),\n  DWQuant, STAT_UW_DW_FINAL_QTY($AJ$33, $AE$23, AND($BA$32,$BA$26)),\n  DWCooldown, STAT_UW_DW_FINAL_CD($AK$33, $AE$24, $DP150),\n  DWKillWall, IF(ISNUMBER($AL$33), $AL$33*DWQuant*$BA$39, 1),\n\n  DW, EP_DW_DPS($AH$33, DWDamage, DWKillWall, DWCooldown, CF150),\n  CL, $DS150,\n  SM, $DT150,\n  SLM, $DU150,\n  SL, $DQ150,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM150, UltCritCard),\nCY150*(DE150*DO150*SL+UwDamage*DF150)))",
    "EM150": "IF(OR(NOT($AH$27), NOT($AH$34), INDEX($BQ$6:$BQ295,CG150)=\"\"), \"\", LET(\n  HasDC, $AN$27>0,\n(1+INDEX($BQ$5:$BQ$19,CG150+1)*IF(HasDC, 2, 1))*IF(HasDC, $AN$27, 1)))",
    "EN150": "IF(OR(NOT($AH$35), INDEX($BR$6:$BR295,CH150)=\"\"), \"\", LET(\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150, $DB150), 1),\n\n  SMHeat, EP_UW_SM_HEATUP(INDEX($BR$5:$BR$30,CH150+1), $AO$29),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n  SMQuant, STAT_UW_SM_FINAL_QTY($AJ$35, $AE$28, AND($BA$34,$BA$26)),\n  SMCooldown, STAT_UW_SM_FINAL_CD($AK$35, $AE$29, $DP150),\n  SMCoverFire, STAT_UW_SM_FINAL_CF(SMDamage, $AL$35),\n    SM, IF($AH$35, EP_SM_DPS(SMDamage, SMQuant, SMCooldown, SMCoverFire, SMHeat, $AR$29), 0),\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, DK150),\n  SLDamage, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLDamage, INDEX($BM$5:$BM295,CC150), SMHeat, $AR$29), 0),\n\n  DW, $DR150,\n  CL, $DS150,\n  SL, $DQ150,\n\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM150, UltCritCard),\nCY150*(DE150*DO150*SL+UwDamage*DF150)))",
    "EO150": "IF(OR(CI150 > $BA$15, NOT($BA$3), NOT($BA$5), NOT($BA$17)), \"\", 1+0.4*(CI150+1))",
    "EP150": "IF(OR($AO$25, CJ150 > $BA$15, NOT($BA$3), NOT($BA$6), NOT($BA$18)), \"\", LET(\n  BaseAspd, $AV$6,\n  CardAspdMastery, IF(AND($BA$3,$BA$6,$BA$18),1+(CJ150+1)*0.03,1),\n  LabAspd, 1+INDEX($BE$5:$BE294,BU150),\n  SubstatAspd, $AE$6,\n  WsPlusAspd, $AQ$6,\n  RelicAspd, 1+$AR$6,\n  AtkSpeed, BULLET_PER_SECOND((BaseAspd*CardAspdMastery*LabAspd+SubstatAspd)*WsPlusAspd*RelicAspd),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  Rapid, 1-$AT$13+IF($AT$13>0, 4*$AT$13*$AT$14/($AT$14+1/($AT$13*AtkSpeed)), 0),\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*CL150, 1),\n  DPM, (1+$DI150*CardRangeMastery*$DJ150*$AQ$9),\n  SuperTower, $DL150,\n  Rend, $DN150,\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150, $DB150), 1),\n\n  HasDC, $AN$27<>\"No\",\n  CLDamage, STAT_UW_CL_FINAL_DMG($AI$34, $AE$30, AND($BA$35,$BA$26)),\n  CLQuant, STAT_UW_CL_FINAL_QTY($AJ$34, $AE$31, HasDC),\n  CLChance, STAT_UW_CL_FINAL_CH($AK$34, $AE$32),\n  CL, IF($AH$34, EP_CL_DPS(CLDamage, CLQuant, CLChance, BaseOther*CR$11*Rapid, AtkSpeed),0),\n\n\n  DW, $DR150,\n  SM, $DT150,\n  SLM, $DU150,\n  SL, $DQ150,\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * DPM * SuperTower * Rend,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM150, UltCritCard),\n\nCY150*(DE150*OtherDamage*SL+UwDamage*DF150)))",
    "EQ150": "IF(OR(CK150 > $BA$15, NOT($BA$3), NOT($BA$8), NOT($BA$19)), \"\", LET(\n  CardCritMastery, IF(AND($BA$3,$BA$8,$BA$19), 1+(CK150+1)*1%, 1),\n  CF, $DB150,\n  CC, MIN(100%, $CZ150 + 1%),\n  CCUW, DA150 + 1%,\n  SCM, (($AN$18 * INDEX($BJ$5:$BJ295,BZ150) + $AE$12) * $AQ$18) * CardCritMastery,\n  SCC, $DC150 + 1%,\n  Critical, (1-CC)+(CC*CF*(1-SCC)+CC*CF*SCC*SCM),\n  UWCritical, (1+CCUW*CF)*(1+CCUW*SCC*SCM),\n\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150, CF), 1),\n  UwAdditionalDamage, $CR$14,\n\n  DW, $DR150,\n  CL, $DS150,\n  SM, $DT150,\n  SLM, $DU150,\n  SL, $DQ150,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, $DM150, UltCritCard),\n\nCY150 * (Critical*DO150*SL+UwDamage*UWCritical)))",
    "ER150": "IF(OR($AO$25, NOT($BA$3), NOT($BA$9), NOT($BA$20), CL150 > $BA$15), \"\", LET(\n  DpmLab, INDEX($BH$5:$BH295,BX150),\n  DpmWs, $AN$10,\n  DpmWsp, $AQ$10,\n  DpmSubstat, $AE$10,\n  DpmRelic, 1+$AR$10,\n  DpmVault, 1+$AS$10,\n  CardRangeMastery, IF(AND($BA$3,$BA$9,$BA$20), 1+0.2*(CL150+1), 1),\n    DamageMeter, (DpmLab * DpmWs + DpmSubstat) * DpmRelic * DpmWsp * CardRangeMastery * DpmVault,\n    RDPM, (1+$DI150*DamageMeter*$AQ$9),\n\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SlCoverage, EP_UW_SL_COVERAGE(SLQuant, SlAngle),\n    SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  SMDamage, STAT_UW_SM_FINAL_DMG(IF($AH$35, $AI$35, 10), $AE$27),\n    SLM, IF(AND($AH$36, $AH$37), EP_SLM_DPS(SMDamage, SLBonus, INDEX($BM$5:$BM295,CC150), $DV150, $AR$29), 0),\n\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH150,\n  Rapid, DG150,\n  SuperTower, $DL150,\n  Rend, $DN150,\n\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM150,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150, $DB150), 1),\n\n  DW, $DR150,\n  CL, $DS150,\n  SM, $DT150,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY150*(DE150*OtherDamage*SL+UWDamage*DF150)))",
    "ES150": "IF(OR(CM150 > $BA$15, NOT($BA$3),NOT($BA$10),NOT($BA$21)), \"\", LET(\n  BaseOther, $CR$9,\n  Bounce, $CR$10,\n  AtkSpeed, $DH150,\n  Rapid, DG150,\n  RDPM, (1+$DI150*$DJ150*$AQ$9),\n  Rend, $DN150,\n\n  HasST, AND($BA$3,$BA$10),\n  HasSL, $AH$37,\n  STLab, INDEX($BK$5:$BK295,CA150),\n  STBonus, $AZ$10 * STLab,\n  STCooldown, 45-(CM150+1)*3,\n\n  SLLightRange, STAT_UW_SL_FINAL_LR($AL$37, RDPM),\n  SlBonus, STAT_UW_SL_FINAL_DMG($AI$37, SLLightRange, $AE$25, $AR$31, $AS$31, AND($BA$26,$BA$33)),\n  SLQuant, $AK$37,\n  SlAngle, STAT_UW_SL_FINAL_ANGLE($AJ$37, $AE$26),\n  SlCoverage, IF(HasSL, EP_UW_SL_COVERAGE(SLQuant, SlAngle), 0),\n\n  ST_SLBonus, 1+(35%*(STBonus-1)),\n\n  SuperTower, IF(HasST,1+(15 * (STBonus * (1+ (ST_SLBonus-1) * SLCoverage) -1))/STCooldown,1),\n  SuperTowerUW, IF(AND(HasST, $BA$21), 1+(15 * (35%*STBonus-1))/STCooldown, 1),\n\n  UwAdditionalDamage, $CR$14,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150, $DB150), 1),\n\n  SL, IF($AH$37, EP_SL_FINAL_BONUS(SlCoverage, SlBonus), 1),\n\n  DW, $DR150,\n  CL, $DS150,\n  SM, $DT150,\n  SLM, $DU150,\n  UwDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, SuperTowerUW, UltCritCard),\n\n  OtherDamage, BaseOther * Bounce * AtkSpeed * Rapid * RDPM * SuperTower * Rend,\nCY150*(DE150*OtherDamage*SL+UwDamage*DF150)))",
    "ET150": "IF(OR(NOT($BA$3), NOT($BA$11), NOT($BA$22), CN150 > $BA$15), \"\",\n LET(\n  UwAdditionalDamage, $CR$14,\n  StMastery, DM150,\n  UltCritCard, IF(AND($BA$3,$BA$11), STAT_CARD_ULTCRIT_DMG(RIGHT($AY$11,1), CN150+1, $DB150), 1),\n\n  DW, $DR150,\n  CL, $DS150,\n  SM, $DT150,\n  SLM, $DU150,\n  SL, $DQ150,\n    UWDamage, EP_UW_TOTAL_DAMAGE(DW, CL, SM, SLM, SL, UwAdditionalDamage, StMastery, UltCritCard),\n\nCY150*(DE150*DO150*SL+UWDamage*DF150)))",
    "EU150": "IF(OR(NOT($BA$3), NOT($BA$23), $CO150 > $BA$15), \"\", 1 + 0.5*(CO150+1))",
    "EW150": "IF(DZ150=\"\", \"\", LET(\n  Now, CT150,\n  Next, DZ150,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(EW$4,BT150),\nFactor/Cost))",
    "EX150": "IF(EA150=\"\",\"\",(EA150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(EX$4,BU150))",
    "EY150": "IF(EB150=\"\",\"\",(EB150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(EY$4,BV150))",
    "EZ150": "IF(EC150=\"\",\"\",(EC150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(EZ$4,BW150))",
    "FA150": "IF(ED150=\"\",\"\",(ED150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(FA$4,BX150))",
    "FB150": "IF(EE150=\"\",\"\",(EE150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(FB$4,BY150))",
    "FC150": "IF(EF150=\"\",\"\",(EF150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(FC$4,BZ150))",
    "FD150": "IF(EG150=\"\",\"\",(EG150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(FD$4,CA150))",
    "FE150": "IF(EH150=\"\",\"\",(EH150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(FE$4,CB150))",
    "FF150": "IF(EI150=\"\",\"\",(EI150/$DX150-1)/SUM(LABDURATION_SINGLE_ADJUSTED(FF$4, SEQUENCE(18-CC150+1, 1, CC150))))",
    "FG150": "IF(EJ150=\"\",\"\",(EJ150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(FG$4,CD150))",
    "FH150": "IF(EK150=\"\",\"\",(EK150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(FH$4,CE150))",
    "FI150": "IF(EL150=\"\",\"\",(EL150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(FI$4,CF150))",
    "FJ150": "IF(EM150=\"\", \"\", LET(\n  Now, CW150,\n  Next, EM150,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(FJ$4,CG150),\nFactor/Cost))",
    "FK150": "IF(EN150=\"\",\"\",(EN150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(FK$4,CH150))",
    "FL150": "IF(EO150=\"\", \"\", LET(\n  Now, CS150,\n  Next, EO150,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CI150),\nFactor/Cost))",
    "FM150": "IF(EP150=\"\",\"\",(EP150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CJ150))",
    "FN150": "IF(EQ150=\"\",\"\",(EQ150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CK150))",
    "FO150": "IF(ER150=\"\",\"\",(ER150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CL150))",
    "FP150": "IF(ES150=\"\",\"\",(ES150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CM150))",
    "FQ150": "IF(ET150=\"\",\"\",(ET150/$DX150-1)/LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CN150))",
    "FR150": "IF(EU150=\"\", \"\", LET(\n  Now, CX150,\n  Next, EU150,\n  Factor, Next/Now-1,\n  Cost, LABDURATION_SINGLE_ADJUSTED(\"Card Mastery\",CO150),\nFactor/Cost))",
    "FT150": "IF(COLUMN(EW150:FR150) = MIN(IF(EW150:FR150=MAX(EW150:FR150), COLUMN(EW150:FR150))), 1, \"\")"
  },
  "values": {
    "FH1": "<<<",
    "K2": "Curve represent the effective value increase in the next 30 upgrades",
    "C3": "Damage",
    "E3": " ↓ Damage Lab PATH  ↓",
    "F3": "The Effective Damage Lab Path (0.25.7) (Time focused)",
    "AA3": "Total Lab Time",
    "AC3": "Modules",
    "AG3": "Farming",
    "AI3": "Lab",
    "AL3": "Workshop ($)",
    "AO3": "Workshop+",
    "AR3": "Relics",
    "AS3": "Vault",
    "AT3": "Total Value",
    "AU3": "Math Value",
    "AV3": "Nolab Value",
    "AX3": "Cards",
    "BA3": true,
    "BC3": "Increment:",
    "BD3": 0.02,
    "BE3": 0.02,
    "BF3": 0.03,
    "BG3": 0.02,
    "BH3": 0.02,
    "BI3": 0.001,
    "BJ3": 0.02,
    "BK3": 0.03,
    "BL3": 25,
    "BM3": -1,
    "BN3": 0.01,
    "BO3": 0.01,
    "BP3": 1.5,
    "BQ3": 0.04,
    "BR3": 1.5,
    "BT3": "LAB PATH UPDATE RUNNING",
    "CQ3": "eDamage Calculation",
    "EW3": "TIME USAGE VS eDamage GAIN",
    "FT3": "LAB PATH UPDATE MATRIX",
    "C4": "Attack Speed",
    "F4": "Lab",
    "G4": "Level",
    "H4": "Duration",
    "I4": "EDMG progress / day",
    "J4": "EDMG after this upgrade",
    "K4": "Running Time",
    "M4": "Lab",
    "N4": "Level",
    "O4": "Cost",
    "P4": "EDMG progress / stone",
    "Q4": "EDMG after this upgrade",
    "AC4": "Cannon",
    "AI4": "Current",
    "AJ4": "Max",
    "AK4": "Value",
    "AL4": "Current",
    "AM4": "Max",
    "AN4": "Value",
    "AO4": "Current",
    "AP4": "Max",
    "AQ4": "Value",
    "AR4": "Current",
    "AS4": "Current",
    "AX4": "Name",
    "AY4": "Level",
    "AZ4": "Value",
    "BA4": "Active",
    "BD4": "Damage",
    "BE4": "Attack Speed",
    "BF4": "Critical Factor",
    "BG4": "Range",
    "BH4": "Damage / Meter",
    "BI4": "Super Crit Chance",
    "BJ4": "Super Crit Multi",
    "BK4": "Super Tower Bonus",
    "BL4": "Max Rend Armor Multiplier",
    "BM4": "Spotlight Missiles",
    "BN4": "Standard Perks Bonus",
    "BO4": "Improve Trade-off Perks",
    "BP4": "Death Wave Damage Amplifier",
    "BQ4": "Shock Multiplier",
    "BR4": "Missile Amplifier",
    "BT4": "Damage",
    "BU4": "Atk Speed",
    "BV4": "Crit. F",
    "BW4": "Range",
    "BX4": "Damage / Meter",
    "BY4": "SCrit Chance",
    "BZ4": "SCrit Mult.",
    "CA4": "S.T. Bonus",
    "CB4": "Rend A Mult.",
    "CC4": "SLM",
    "CD4": "Std Perk",
    "CE4": "To Perk",
    "CF4": "Death Wave Damage Amplifier",
    "CG4": "Shock Multiplier",
    "CH4": "Missile Amplifier",
    "CI4": "Damage Mastery",
    "CJ4": "Attack Speed Mastery",
    "CK4": "Critical Chance Mastery",
    "CL4": "Range Mastery",
    "CM4": "Super Tower Mastery",
    "CN4": "Ultimate Crit Mastery",
    "CO4": "Demon Mode Mastery",
    "CQ4": "Constant Name",
    "CR4": "Constant Value",
    "CS4": "Damage Mastery",
    "CT4": "Damage",
    "CU4": "Standard Perks Bonus",
    "CV4": "Improve Trade-off Perks",
    "CW4": "Shock Multiplier",
    "CX4": "DM Mastery",
    "CY4": "Base",
    "CZ4": "Critical Chance",
    "DA4": "UW Crit Chance",
    "DB4": "Critical Factor",
    "DC4": "Super Crit Chance",
    "DD4": "Super Crit Multi",
    "DE4": "Crit",
    "DF4": "UW Crit",
    "DG4": "Rapid Fire",
    "DH4": "Attack Speed",
    "DI4": "Range",
    "DJ4": "Damage / Meter",
    "DK4": "RDPM",
    "DL4": "Super Tower Bonus",
    "DM4": "ST UW",
    "DN4": "Max Rend Armor Multiplier",
    "DO4": "BulletDmgMulti",
    "DP4": "Avg Time Boost",
    "DQ4": "SL",
    "DR4": "DW",
    "DS4": "CL",
    "DT4": "SM",
    "DU4": "SLM",
    "DV4": "SM Heatup",
    "DW4": "UWs",
    "DX4": "eDamage",
    "DZ4": "Damage",
    "EA4": "Attack Speed",
    "EB4": "Critical Factor",
    "EC4": "Range",
    "ED4": "Damage / Meter",
    "EE4": "SCrit Chance",
    "EF4": "SCrit Mult.",
    "EG4": "S.T. Bonus",
    "EH4": "Max Rend Armor Multiplier",
    "EI4": "Spotlight Missiles",
    "EJ4": "Std Perks",
    "EK4": "TO Perks",
    "EL4": "Death Wave Damage Amplifier",
    "EM4": "Shock Multiplier",
    "EN4": "Missile Amplifier",
    "EO4": "Damage Mastery",
    "EP4": "Attack Speed Mastery",
    "EQ4": "Critical Chance Mastery",
    "ER4": "Range Mastery",
    "ES4": "Super Tower Mastery",
    "ET4": "Ultimate Crit Mastery",
    "EU4": "Demon Mode Mastery",
    "EW4": "Damage",
    "EX4": "Attack Speed",
    "EY4": "Critical Factor",
    "EZ4": "Range",
    "FA4": "Damage / Meter",
    "FB4": "Super Crit Chance",
    "FC4": "Super Crit Multi",
    "FD4": "Super Tower Bonus",
    "FE4": "Max Rend Armor Multiplier",
    "FF4": "Spotlight Missiles",
    "FG4": "Standard Perks Bonus",
    "FH4": "Improve Trade-off Perks",
    "FI4": "Death Wave Damage Amplifier",
    "FJ4": "Shock Multiplier",
    "FK4": "Missile Amplifier",
    "FL4": "Damage Mastery",
    "FM4": "Attack Speed Mastery",
    "FN4": "Critical Chance Mastery",
    "FO4": "Range Mastery",
    "FP4": "Super Tower Mastery",
    "FQ4": "Ultimate Crit Mastery",
    "FR4": "Demon Mode Mastery",
    "FT4": "Damage",
    "FU4": "Attack Speed",
    "FV4": "Critical Factor",
    "FW4": "Range",
    "FX4": "Damage / Meter",
    "FY4": "Super Crit Chance",
    "FZ4": "Super Crit Multi",
    "GA4": "Super Tower Bonus",
    "GB4": "Max Rend Armor Multiplier",
    "GC4": "Spotlight Missiles",
    "GD4": "Standard Perks Bonus",
    "GE4": "Improve Trade-off Perks",
    "GF4": "Death Wave Damage Amplifier",
    "GG4": "Shock Multiplier",
    "GH4": "Missile Amplifier",
    "GI4": "Damage Mastery",
    "GJ4": "Attack Speed Mastery",
    "GK4": "Critical Chance Mastery",
    "GL4": "Range Mastery",
    "GM4": "Super Tower Mastery",
    "GN4": "Ultimate Crit Mastery",
    "GO4": "Demon Mode Mastery",
    "C5": "Critical Factor",
    "K5": "x1",
    "AA5": "Current eDmg/sec",
    "AC5": "Substat Compared To:",
    "AE5": "Next Tier",
    "AG5": "Damage",
    "AM5": 6000,
    "AP5": 300,
    "AX5": "Damage",
    "BA5": true,
    "BC5": 0,
    "BD5": 1,
    "BE5": 0,
    "BF5": 0,
    "BG5": 1,
    "BH5": 1,
    "BI5": 0,
    "BJ5": 1,
    "BK5": 1,
    "BL5": 800,
    "BM5": 20,
    "BN5": 1,
    "BO5": 1,
    "BP5": 5,
    "BQ5": 0.1,
    "BR5": 1,
    "CQ5": "Damage",
    "FU5": "",
    "FV5": 1,
    "FW5": "",
    "FX5": "",
    "FY5": "",
    "FZ5": "",
    "GA5": "",
    "GB5": "",
    "GC5": "",
    "GD5": "",
    "GE5": "",
    "GF5": "",
    "GG5": "",
    "GH5": "",
    "GI5": "",
    "GJ5": "",
    "GK5": "",
    "GL5": "",
    "GM5": "",
    "GN5": "",
    "GO5": "",
    "C6": "Range",
    "M6": "CL Damage",
    "N6": 2,
    "O6": 5,
    "P6": 0.012870738535908765,
    "Q6": "57.26 B",
    "R6": "5 ⧌",
    "AC6": "Attack Speed",
    "AG6": "Attack Speed ⚠️",
    "AM6": 99,
    "AP6": 50,
    "AX6": "Attack Speed",
    "BA6": true,
    "CQ6": "Base Nonlab Dmg",
    "FU6": 1,
    "FV6": "",
    "FW6": "",
    "FX6": "",
    "FY6": "",
    "FZ6": "",
    "GA6": "",
    "GB6": "",
    "GC6": "",
    "GD6": "",
    "GE6": "",
    "GF6": "",
    "GG6": "",
    "GH6": "",
    "GI6": "",
    "GJ6": "",
    "GK6": "",
    "GL6": "",
    "GM6": "",
    "GN6": "",
    "GO6": "",
    "C7": "Damage / Meter",
    "H7": "0d  0h  0m",
    "J7": "55.43 B",
    "M7": "CL Damage",
    "N7": 3,
    "O7": 11,
    "P7": 0.010779182018322286,
    "Q7": "64.05 B",
    "R7": "16 ⧌",
    "AC7": "Critical Chance",
    "AG7": "Critical Factor",
    "AM7": 150,
    "AP7": 300,
    "AX7": "Berserker",
    "AZ7": 8,
    "BA7": true,
    "FU7": "",
    "FV7": "",
    "FW7": "",
    "FX7": "",
    "FY7": "",
    "FZ7": "",
    "GA7": "",
    "GB7": "",
    "GC7": "",
    "GD7": "",
    "GE7": "",
    "GF7": "",
    "GG7": "",
    "GH7": "",
    "GI7": "",
    "GJ7": "",
    "GK7": "",
    "GL7": "",
    "GM7": "",
    "GN7": "",
    "GO7": "",
    "C8": "Super Crit Chance",
    "H8": "0d  0h  0m",
    "J8": "56.54 B",
    "M8": "CL Damage",
    "N8": 4,
    "O8": 17,
    "P8": 0.01247084864824396,
    "Q8": "77.63 B",
    "R8": "33 ⧌",
    "AC8": "Critical Factor",
    "AG8": "Critical Chance",
    "AI8": "-",
    "AM8": 79,
    "AX8": "Critical Chance",
    "BA8": true,
    "CQ8": "BulletDmgMulti",
    "FU8": "",
    "FV8": "",
    "FW8": "",
    "FX8": 1,
    "FY8": "",
    "FZ8": "",
    "GA8": "",
    "GB8": "",
    "GC8": "",
    "GD8": "",
    "GE8": "",
    "GF8": "",
    "GG8": "",
    "GH8": "",
    "GI8": "",
    "GJ8": "",
    "GK8": "",
    "GL8": "",
    "GM8": "",
    "GN8": "",
    "GO8": "",
    "C9": "Super Crit Multi",
    "H9": "0d  0h  0m",
    "J9": "56.97 B",
    "M9": "CL Chance",
    "N9": 2,
    "O9": 8,
    "P9": 0.01475891764999926,
    "Q9": "86.8 B",
    "R9": "41 ⧌",
    "AC9": "Attack Range",
    "AG9": "Range",
    "AH9": false,
    "AJ9": 80,
    "AM9": 79,
    "AO9": "Damage at % range :",
    "AQ9": 0.25,
    "AR9": "-",
    "AX9": "Range",
    "BA9": true,
    "CQ9": "Multishot",
    "FU9": "",
    "FV9": 1,
    "FW9": "",
    "FX9": "",
    "FY9": "",
    "FZ9": "",
    "GA9": "",
    "GB9": "",
    "GC9": "",
    "GD9": "",
    "GE9": "",
    "GF9": "",
    "GG9": "",
    "GH9": "",
    "GI9": "",
    "GJ9": "",
    "GK9": "",
    "GL9": "",
    "GM9": "",
    "GN9": "",
    "GO9": "",
    "C10": "Super Tower Bonus",
    "H10": "0d  0h  6m",
    "J10": "58.62 B",
    "M10": "CL Damage",
    "N10": 5,
    "O10": 23,
    "P10": 0.011053421654623979,
    "Q10": "108.86 B",
    "R10": "64 ⧌",
    "AC10": "Damage / Meter",
    "AG10": "Damage / Meter",
    "AJ10": 99,
    "AM10": 200,
    "AP10": 300,
    "AX10": "Super Tower",
    "BA10": true,
    "CQ10": "BS BA",
    "FU10": 1,
    "FV10": "",
    "FW10": "",
    "FX10": "",
    "FY10": "",
    "FZ10": "",
    "GA10": "",
    "GB10": "",
    "GC10": "",
    "GD10": "",
    "GE10": "",
    "GF10": "",
    "GG10": "",
    "GH10": "",
    "GI10": "",
    "GJ10": "",
    "GK10": "",
    "GL10": "",
    "GM10": "",
    "GN10": "",
    "GO10": "",
    "C11": "Max Rend Armor Multiplier",
    "H11": "0d  0h  6m",
    "J11": "59.79 B",
    "M11": "CL Quantity",
    "N11": 2,
    "O11": 30,
    "P11": 0.011824005789057639,
    "Q11": "147.48 B",
    "R11": "94 ⧌",
    "AC11": "Super Crit Chance",
    "AG11": "Multishot Chance",
    "AI11": "-",
    "AM11": 99,
    "AR11": "-",
    "AX11": "Ultimate Crit",
    "BA11": true,
    "CQ11": "BS no BA",
    "FU11": "",
    "FV11": "",
    "FW11": "",
    "FX11": "",
    "FY11": "",
    "FZ11": "",
    "GA11": "",
    "GB11": "",
    "GC11": "",
    "GD11": "",
    "GE11": "",
    "GF11": "",
    "GG11": "",
    "GH11": "",
    "GI11": "",
    "GJ11": "",
    "GK11": "",
    "GL11": "",
    "GM11": "",
    "GN11": "",
    "GO11": "",
    "C12": "Spotlight Missiles",
    "H12": "0d  0h  6m",
    "J12": "60.96 B",
    "M12": "CL Damage",
    "N12": 6,
    "O12": 29,
    "P12": 0.013414472258764683,
    "Q12": "204.85 B",
    "R12": "123 ⧌",
    "AC12": "Super Crit Multi",
    "AG12": "Multishot Targets",
    "AI12": "-",
    "AM12": 7,
    "AR12": "-",
    "AX12": "Package Chance",
    "BA12": true,
    "FU12": "",
    "FV12": 1,
    "FW12": "",
    "FX12": "",
    "FY12": "",
    "FZ12": "",
    "GA12": "",
    "GB12": "",
    "GC12": "",
    "GD12": "",
    "GE12": "",
    "GF12": "",
    "GG12": "",
    "GH12": "",
    "GI12": "",
    "GJ12": "",
    "GK12": "",
    "GL12": "",
    "GM12": "",
    "GN12": "",
    "GO12": "",
    "C13": "Standard Perks Bonus",
    "H13": "0d  0h 16m",
    "J13": "62.68 B",
    "M13": "CL Damage",
    "N13": 7,
    "O13": 35,
    "P13": 0.010002421562984086,
    "Q13": "276.57 B",
    "R13": "158 ⧌",
    "AC13": "Max Rend Armor Multi",
    "AG13": "Rapid Fire Chance",
    "AI13": "-",
    "AM13": 85,
    "AR13": "-",
    "AX13": "Wave Accelerator",
    "BA13": true,
    "CQ13": "UW",
    "FU13": "",
    "FV13": "",
    "FW13": "",
    "FX13": 1,
    "FY13": "",
    "FZ13": "",
    "GA13": "",
    "GB13": "",
    "GC13": "",
    "GD13": "",
    "GE13": "",
    "GF13": "",
    "GG13": "",
    "GH13": "",
    "GI13": "",
    "GJ13": "",
    "GK13": "",
    "GL13": "",
    "GM13": "",
    "GN13": "",
    "GO13": "",
    "C14": "Improve Trade-off Perks",
    "H14": "0d  0h  6m",
    "J14": "63.16 B",
    "M14": "CL Damage",
    "N14": 8,
    "O14": 41,
    "P14": 0.008854343057810937,
    "Q14": "376.97 B",
    "R14": "199 ⧌",
    "AC14": "MultiShot Chance",
    "AG14": "Rapid Fire Duration",
    "AI14": "-",
    "AM14": 99,
    "AR14": "-",
    "CQ14": "UW Damage",
    "FU14": 1,
    "FV14": "",
    "FW14": "",
    "FX14": "",
    "FY14": "",
    "FZ14": "",
    "GA14": "",
    "GB14": "",
    "GC14": "",
    "GD14": "",
    "GE14": "",
    "GF14": "",
    "GG14": "",
    "GH14": "",
    "GI14": "",
    "GJ14": "",
    "GK14": "",
    "GL14": "",
    "GM14": "",
    "GN14": "",
    "GO14": "",
    "C15": "Death Wave Damage Amplifier",
    "H15": "0d  0h 16m",
    "J15": "64.39 B",
    "M15": "CL Chance",
    "N15": 3,
    "O15": 26,
    "P15": 0.0077672941696988245,
    "Q15": "453.1 B",
    "R15": "225 ⧌",
    "AC15": "Multishot Targets",
    "AG15": "Bounce Shot Chance",
    "AI15": "-",
    "AM15": 85,
    "AO15": "Astral Deliverance",
    "AR15": "-",
    "AX15": "Cards+",
    "AY15": " Stop labs at lvl:",
    "BA15": 1,
    "CQ15": "Wave dur.",
    "FU15": "",
    "FV15": "",
    "FW15": "",
    "FX15": "",
    "FY15": "",
    "FZ15": "",
    "GA15": "",
    "GB15": "",
    "GC15": "",
    "GD15": "",
    "GE15": "",
    "GF15": "",
    "GG15": "",
    "GH15": "",
    "GI15": "",
    "GJ15": "",
    "GK15": "",
    "GL15": "",
    "GM15": "",
    "GN15": "",
    "GO15": "",
    "C16": "Shock Multiplier",
    "H16": "0d  0h 16m",
    "J16": "65.62 B",
    "M16": "CL Damage",
    "N16": 9,
    "O16": 47,
    "P16": 0.007046099737944664,
    "Q16": "603.16 B",
    "R16": "272 ⧌",
    "AC16": "Rapid Fire Chance",
    "AG16": "Bounce Shot Targets",
    "AI16": "-",
    "AM16": 7,
    "AR16": "-",
    "AX16": "Name",
    "AY16": "Value",
    "AZ16": "ROI / ⧌",
    "BA16": "Active",
    "FU16": "",
    "FV16": 1,
    "FW16": "",
    "FX16": "",
    "FY16": "",
    "FZ16": "",
    "GA16": "",
    "GB16": "",
    "GC16": "",
    "GD16": "",
    "GE16": "",
    "GF16": "",
    "GG16": "",
    "GH16": "",
    "GI16": "",
    "GJ16": "",
    "GK16": "",
    "GL16": "",
    "GM16": "",
    "GN16": "",
    "GO16": "",
    "C17": "Missile Amplifier",
    "H17": "0d  0h 31m",
    "J17": "67.42 B",
    "M17": "CL Damage",
    "N17": 10,
    "O17": 53,
    "P17": 0.0060745217754715804,
    "Q17": "797.34 B",
    "R17": "325 ⧌",
    "AC17": "Rapid Fire Duration",
    "AG17": "Super Crit Chance",
    "AM17": 100,
    "AX17": "Damage",
    "FU17": 1,
    "FV17": "",
    "FW17": "",
    "FX17": "",
    "FY17": "",
    "FZ17": "",
    "GA17": "",
    "GB17": "",
    "GC17": "",
    "GD17": "",
    "GE17": "",
    "GF17": "",
    "GG17": "",
    "GH17": "",
    "GI17": "",
    "GJ17": "",
    "GK17": "",
    "GL17": "",
    "GM17": "",
    "GN17": "",
    "GO17": "",
    "C18": "Mastery",
    "H18": "0d  0h 31m",
    "J18": "68.71 B",
    "M18": "CL Damage",
    "N18": 11,
    "O18": 61,
    "P18": 0.005081343599265841,
    "Q18": "1.04 T",
    "R18": "386 ⧌",
    "AC18": "Bounce Shot Chance",
    "AG18": "Super Crit Multiplier",
    "AM18": 120,
    "AP18": 300,
    "AR18": "-",
    "AX18": "Attack Speed",
    "FU18": "",
    "FV18": "",
    "FW18": "",
    "FX18": "",
    "FY18": "",
    "FZ18": "",
    "GA18": "",
    "GB18": "",
    "GC18": "",
    "GD18": "",
    "GE18": "",
    "GF18": "",
    "GG18": "",
    "GH18": "",
    "GI18": "",
    "GJ18": "",
    "GK18": "",
    "GL18": "",
    "GM18": "",
    "GN18": "",
    "GO18": "",
    "H19": "0d  0h 31m",
    "J19": "70 B",
    "M19": "CL Quantity",
    "N19": 3,
    "O19": 75,
    "P19": 0.004897061006258946,
    "Q19": "1.43 T",
    "R19": "461 ⧌",
    "AC19": "Bounce Shot Targets",
    "AG19": "Max Rend Mult ⚠️",
    "AL19": "-",
    "AP19": 300,
    "AR19": "-",
    "AX19": "Critical Chance",
    "FU19": "",
    "FV19": 1,
    "FW19": "",
    "FX19": "",
    "FY19": "",
    "FZ19": "",
    "GA19": "",
    "GB19": "",
    "GC19": "",
    "GD19": "",
    "GE19": "",
    "GF19": "",
    "GG19": "",
    "GH19": "",
    "GI19": "",
    "GJ19": "",
    "GK19": "",
    "GL19": "",
    "GM19": "",
    "GN19": "",
    "GO19": "",
    "C20": "DW Damage",
    "H20": "0d  0h 52m",
    "J20": "71.87 B",
    "M20": "CL Damage",
    "N20": 12,
    "O20": 71,
    "P20": 0.0042186471703059385,
    "Q20": "1.86 T",
    "R20": "532 ⧌",
    "AC20": "Core",
    "AG20": "Recovery Package Chance",
    "AJ20": 20,
    "AM20": 60,
    "AO20": "-",
    "AP20": "-",
    "AQ20": "-",
    "AR20": "-",
    "AX20": "Range (DPM)",
    "FU20": "",
    "FV20": "",
    "FW20": "",
    "FX20": 1,
    "FY20": "",
    "FZ20": "",
    "GA20": "",
    "GB20": "",
    "GC20": "",
    "GD20": "",
    "GE20": "",
    "GF20": "",
    "GG20": "",
    "GH20": "",
    "GI20": "",
    "GJ20": "",
    "GK20": "",
    "GL20": "",
    "GM20": "",
    "GN20": "",
    "GO20": "",
    "C21": "DW Quantity",
    "H21": "0d  0h 16m",
    "J21": "72.42 B",
    "M21": "CL Chance",
    "N21": 4,
    "O21": 44,
    "P21": 0.0041532639468079635,
    "Q21": "2.2 T",
    "R21": "576 ⧌",
    "AC21": "Substat Compared To:",
    "AE21": "Next Tier",
    "AG21": "Package After Boss",
    "AJ21": 1,
    "AK21": "-",
    "AL21": "-",
    "AM21": "-",
    "AN21": "-",
    "AQ21": 10,
    "AR21": "-",
    "AX21": "Super Tower",
    "FU21": 1,
    "FV21": "",
    "FW21": "",
    "FX21": "",
    "FY21": "",
    "FZ21": "",
    "GA21": "",
    "GB21": "",
    "GC21": "",
    "GD21": "",
    "GE21": "",
    "GF21": "",
    "GG21": "",
    "GH21": "",
    "GI21": "",
    "GJ21": "",
    "GK21": "",
    "GL21": "",
    "GM21": "",
    "GN21": "",
    "GO21": "",
    "C22": "DW Cooldown",
    "H22": "0d  0h 52m",
    "J22": "73.77 B",
    "M22": "CL Damage",
    "N22": 13,
    "O22": 84,
    "P22": 0.0033846315408659505,
    "Q22": "2.82 T",
    "R22": "660 ⧌",
    "AC22": "Death Wave - Damage",
    "AG22": "Shockwave Frequency",
    "AI22": "-",
    "AM22": 40,
    "AO22": "-",
    "AR22": "-",
    "AV22": "NOT USED",
    "AX22": "Ultimate Crit",
    "FU22": "",
    "FV22": "",
    "FW22": "",
    "FX22": "",
    "FY22": "",
    "FZ22": "",
    "GA22": "",
    "GB22": "",
    "GC22": "",
    "GD22": "",
    "GE22": "",
    "GF22": "",
    "GG22": "",
    "GH22": "",
    "GI22": "",
    "GJ22": "",
    "GK22": "",
    "GL22": "",
    "GM22": "",
    "GN22": "",
    "GO22": "",
    "C23": "DW Kill Wall",
    "H23": "0d  0h 52m",
    "J23": "75.14 B",
    "M23": "CL Damage",
    "N23": 14,
    "O23": 100,
    "P23": 0.0027285288784387783,
    "Q23": "3.59 T",
    "R23": "760 ⧌",
    "AC23": "Death Wave - Quantity",
    "AG23": "Super Tower",
    "AX23": "Demon Mode ⚠️",
    "FU23": "",
    "FV23": 1,
    "FW23": "",
    "FX23": "",
    "FY23": "",
    "FZ23": "",
    "GA23": "",
    "GB23": "",
    "GC23": "",
    "GD23": "",
    "GE23": "",
    "GF23": "",
    "GG23": "",
    "GH23": "",
    "GI23": "",
    "GJ23": "",
    "GK23": "",
    "GL23": "",
    "GM23": "",
    "GN23": "",
    "GO23": "",
    "C24": "CL Damage",
    "H24": "0d  1h 20m",
    "J24": "77.09 B",
    "M24": "CL Chance",
    "N24": 5,
    "O24": 62,
    "P24": 0.0025132764594602655,
    "Q24": "4.15 T",
    "R24": "822 ⧌",
    "AC24": "Death Wave - Cooldown",
    "AG24": "Standard Perk Bonus",
    "AM24": "Hide UW Cooldown",
    "AO24": false,
    "AX24": "Wave Accelerator",
    "AY24": "?",
    "FU24": "",
    "FV24": "",
    "FW24": "",
    "FX24": 1,
    "FY24": "",
    "FZ24": "",
    "GA24": "",
    "GB24": "",
    "GC24": "",
    "GD24": "",
    "GE24": "",
    "GF24": "",
    "GG24": "",
    "GH24": "",
    "GI24": "",
    "GJ24": "",
    "GK24": "",
    "GL24": "",
    "GM24": "",
    "GN24": "",
    "GO24": "",
    "C25": "CL Quantity",
    "H25": "0d  0h 31m",
    "J25": "77.67 B",
    "M25": "CL Damage",
    "N25": 15,
    "O25": 120,
    "P25": 0.002194746060599249,
    "Q25": "5.24 T",
    "R25": "942 ⧌",
    "AC25": "Spotlight - Bonus",
    "AG25": "Improved Trade-Off Perks",
    "AM25": "Hide non-UW Labs",
    "AO25": false,
    "FU25": 1,
    "FV25": "",
    "FW25": "",
    "FX25": "",
    "FY25": "",
    "FZ25": "",
    "GA25": "",
    "GB25": "",
    "GC25": "",
    "GD25": "",
    "GE25": "",
    "GF25": "",
    "GG25": "",
    "GH25": "",
    "GI25": "",
    "GJ25": "",
    "GK25": "",
    "GL25": "",
    "GM25": "",
    "GN25": "",
    "GO25": "",
    "C26": "CL Chance",
    "H26": "0d  1h 20m",
    "J26": "79.1 B",
    "M26": "CL Quantity",
    "N26": 4,
    "O26": 150,
    "P26": 0.0018352130541249333,
    "Q26": "6.68 T",
    "R26": "1.09 K ⧌",
    "AC26": "Spotlight - Angle",
    "AG26": "Death Wave Damage Ampl.",
    "AJ26": 30,
    "AX26": "Perks",
    "FU26": "",
    "FV26": "",
    "FW26": "",
    "FX26": "",
    "FY26": "",
    "FZ26": "",
    "GA26": "",
    "GB26": "",
    "GC26": "",
    "GD26": "",
    "GE26": "",
    "GF26": "",
    "GG26": "",
    "GH26": "",
    "GI26": "",
    "GJ26": "",
    "GK26": "",
    "GL26": "",
    "GM26": "",
    "GN26": "",
    "GO26": "",
    "C27": "SM Damage",
    "H27": "0d  1h 20m",
    "J27": "80.54 B",
    "M27": "CL Damage",
    "N27": 16,
    "O27": 144,
    "P27": 0.0017406160992433223,
    "Q27": "8.36 T",
    "R27": "1.24 K ⧌",
    "AC27": "Smart Missiles - Damage",
    "AG27": "Shock Mult ⚠️",
    "AH27": false,
    "AJ27": 14,
    "AL27": "Dimension Core",
    "AX27": "Name",
    "AY27": "Level",
    "AZ27": "Value",
    "BA27": "Active",
    "FU27": "",
    "FV27": 1,
    "FW27": "",
    "FX27": "",
    "FY27": "",
    "FZ27": "",
    "GA27": "",
    "GB27": "",
    "GC27": "",
    "GD27": "",
    "GE27": "",
    "GF27": "",
    "GG27": "",
    "GH27": "",
    "GI27": "",
    "GJ27": "",
    "GK27": "",
    "GL27": "",
    "GM27": "",
    "GN27": "",
    "GO27": "",
    "C28": "SM Quantity",
    "H28": "0d  1h 56m",
    "J28": "82.58 B",
    "M28": "CL Chance",
    "N28": 6,
    "O28": 80,
    "P28": 0.0016949429895883662,
    "Q28": "9.49 T",
    "R28": "1.32 K ⧌",
    "AC28": "Smart Missiles - Quantity",
    "AG28": "Shock Chance",
    "AJ28": 30,
    "AL28": "Avg hits required to reach max Shock Multiplier :",
    "AX28": "Damage",
    "AY28": 5,
    "BA28": true,
    "FU28": "",
    "FV28": 1,
    "FW28": "",
    "FX28": "",
    "FY28": "",
    "FZ28": "",
    "GA28": "",
    "GB28": "",
    "GC28": "",
    "GD28": "",
    "GE28": "",
    "GF28": "",
    "GG28": "",
    "GH28": "",
    "GI28": "",
    "GJ28": "",
    "GK28": "",
    "GL28": "",
    "GM28": "",
    "GN28": "",
    "GO28": "",
    "C29": "SM Cooldown",
    "H29": "0d  2h 39m",
    "J29": "84.62 B",
    "M29": "CL Damage",
    "N29": 17,
    "O29": 174,
    "P29": 0.0014037946674581192,
    "Q29": "11.81 T",
    "R29": "1.49 K ⧌",
    "AC29": "Smart Missiles - Cooldown",
    "AG29": "Missile Amplifier ⚠️",
    "AJ29": 25,
    "AL29": "Hits on same target",
    "AO29": 2,
    "AP29": "Enemies inside SM Area",
    "AR29": 1,
    "AX29": "Bounce Shot",
    "AY29": 3,
    "BA29": true,
    "FU29": 1,
    "FV29": "",
    "FW29": "",
    "FX29": "",
    "FY29": "",
    "FZ29": "",
    "GA29": "",
    "GB29": "",
    "GC29": "",
    "GD29": "",
    "GE29": "",
    "GF29": "",
    "GG29": "",
    "GH29": "",
    "GI29": "",
    "GJ29": "",
    "GK29": "",
    "GL29": "",
    "GM29": "",
    "GN29": "",
    "GO29": "",
    "C30": "SM Cover Fire",
    "H30": "0d  1h 56m",
    "J30": "86.14 B",
    "M30": "CL Chance",
    "N30": 7,
    "O30": 98,
    "P30": 0.0012196078334089768,
    "Q30": "13.22 T",
    "R30": "1.59 K ⧌",
    "AC30": "Chain Lightning - Damage",
    "BA30": true,
    "FU30": "",
    "FV30": "",
    "FW30": "",
    "FX30": "",
    "FY30": "",
    "FZ30": "",
    "GA30": "",
    "GB30": "",
    "GC30": "",
    "GD30": "",
    "GE30": "",
    "GF30": "",
    "GG30": "",
    "GH30": "",
    "GI30": "",
    "GJ30": "",
    "GK30": "",
    "GL30": "",
    "GM30": "",
    "GN30": "",
    "GO30": "",
    "C31": "SL Damage",
    "H31": "0d  1h 56m",
    "J31": "87.68 B",
    "M31": "CL Damage",
    "N31": 18,
    "O31": 210,
    "P31": 0.001122248700261117,
    "Q31": "16.33 T",
    "R31": "1.8 K ⧌",
    "AC31": "Chain Lightning - Quantity",
    "AG31": "Bullet Damage %",
    "AI31": "UWs",
    "BA31": true,
    "FU31": "",
    "FV31": "",
    "FW31": "",
    "FX31": 1,
    "FY31": "",
    "FZ31": "",
    "GA31": "",
    "GB31": "",
    "GC31": "",
    "GD31": "",
    "GE31": "",
    "GF31": "",
    "GG31": "",
    "GH31": "",
    "GI31": "",
    "GJ31": "",
    "GK31": "",
    "GL31": "",
    "GM31": "",
    "GN31": "",
    "GO31": "",
    "C32": "SL Angle",
    "H32": "0d  0h 52m",
    "J32": "88.34 B",
    "M32": "CL Chance",
    "N32": 8,
    "O32": 116,
    "P32": 0.0009209833158921934,
    "Q32": "18.08 T",
    "R32": "1.91 K ⧌",
    "AC32": "Chain Lightning - Chance",
    "AG32": "UW* Damage %",
    "AI32": "Damage",
    "AJ32": "#",
    "AX32": "Death Wave Quantity",
    "AZ32": "+1",
    "BA32": true,
    "FU32": "",
    "FV32": 1,
    "FW32": "",
    "FX32": "",
    "FY32": "",
    "FZ32": "",
    "GA32": "",
    "GB32": "",
    "GC32": "",
    "GD32": "",
    "GE32": "",
    "GF32": "",
    "GG32": "",
    "GH32": "",
    "GI32": "",
    "GJ32": "",
    "GK32": "",
    "GL32": "",
    "GM32": "",
    "GN32": "",
    "GO32": "",
    "C33": "SL Quantity",
    "H33": "0d  3h 31m",
    "J33": "90.48 B",
    "M33": "CL Damage",
    "N33": 19,
    "O33": 252,
    "P33": 0.0009097905907765064,
    "Q33": "22.23 T",
    "R33": "2.17 K ⧌",
    "AC33": "Generator",
    "AE33": "-",
    "AG33": "Death Wave",
    "AX33": "Spotlight Damage Bonus",
    "AZ33": "x1.5",
    "BA33": true,
    "FU33": 1,
    "FV33": "",
    "FW33": "",
    "FX33": "",
    "FY33": "",
    "FZ33": "",
    "GA33": "",
    "GB33": "",
    "GC33": "",
    "GD33": "",
    "GE33": "",
    "GF33": "",
    "GG33": "",
    "GH33": "",
    "GI33": "",
    "GJ33": "",
    "GK33": "",
    "GL33": "",
    "GM33": "",
    "GN33": "",
    "GO33": "",
    "C34": "SL Light Range",
    "H34": "0d  2h 39m",
    "J34": "92.07 B",
    "M34": "CL Damage",
    "N34": 20,
    "O34": 302,
    "P34": 0.0007437930430833657,
    "Q34": "27.22 T",
    "R34": "2.47 K ⧌",
    "AC34": "Substat Compared To:",
    "AE34": "Next Tier",
    "AG34": "Chain Lightning",
    "AX34": "Smart Missile Quantity",
    "AZ34": "+4",
    "BA34": true,
    "FU34": "",
    "FV34": "",
    "FW34": "",
    "FX34": "",
    "FY34": "",
    "FZ34": "",
    "GA34": "",
    "GB34": "",
    "GC34": "",
    "GD34": "",
    "GE34": "",
    "GF34": "",
    "GG34": "",
    "GH34": "",
    "GI34": "",
    "GJ34": "",
    "GK34": "",
    "GL34": "",
    "GM34": "",
    "GN34": "",
    "GO34": "",
    "H35": "0d  2h 39m",
    "J35": "93.69 B",
    "M35": "CL Chance",
    "N35": 9,
    "O35": 134,
    "P35": 0.0007209462909604407,
    "Q35": "29.85 T",
    "R35": "2.6 K ⧌",
    "AC35": "Galaxy Compressor",
    "AG35": "Smart Missiles",
    "AN35": "<!> SM Damage heatup and Radius should be selected manually",
    "AX35": "Chain Lightning Damage",
    "AZ35": "x2",
    "BA35": true,
    "FU35": "",
    "FV35": "",
    "FW35": "",
    "FX35": "",
    "FY35": "",
    "FZ35": "",
    "GA35": "",
    "GB35": "",
    "GC35": "",
    "GD35": 1,
    "GE35": "",
    "GF35": "",
    "GG35": "",
    "GH35": "",
    "GI35": "",
    "GJ35": "",
    "GK35": "",
    "GL35": "",
    "GM35": "",
    "GN35": "",
    "GO35": "",
    "C36": "Damage +",
    "H36": "0d  1h 39m",
    "J36": "94.62 B",
    "M36": "CL Damage",
    "N36": 21,
    "O36": 362,
    "P36": 0.0006019849044959716,
    "Q36": "36.35 T",
    "R36": "2.96 K ⧌",
    "AC36": "Package Chance",
    "AG36": "Spotlight Missiles ⚠️",
    "AH36": true,
    "AJ36": "-",
    "FU36": "",
    "FV36": "",
    "FW36": "",
    "FX36": 1,
    "FY36": "",
    "FZ36": "",
    "GA36": "",
    "GB36": "",
    "GC36": "",
    "GD36": "",
    "GE36": "",
    "GF36": "",
    "GG36": "",
    "GH36": "",
    "GI36": "",
    "GJ36": "",
    "GK36": "",
    "GL36": "",
    "GM36": "",
    "GN36": "",
    "GO36": "",
    "C37": "Rend Armor +",
    "H37": "0d  1h 20m",
    "J37": "95.33 B",
    "M37": "CL Chance",
    "N37": 10,
    "O37": 152,
    "P37": 0.0005797435583686578,
    "Q37": "39.55 T",
    "R37": "3.12 K ⧌",
    "AD37": "             ",
    "AG37": "Spotlight",
    "AX37": "User Specific Guess",
    "FU37": "",
    "FV37": 1,
    "FW37": "",
    "FX37": "",
    "FY37": "",
    "FZ37": "",
    "GA37": "",
    "GB37": "",
    "GC37": "",
    "GD37": "",
    "GE37": "",
    "GF37": "",
    "GG37": "",
    "GH37": "",
    "GI37": "",
    "GJ37": "",
    "GK37": "",
    "GL37": "",
    "GM37": "",
    "GN37": "",
    "GO37": "",
    "C38": "Critical Factor +",
    "H38": "0d  4h 32m",
    "J38": "97.58 B",
    "M38": "CL Quantity",
    "N38": 5,
    "O38": 400,
    "P38": 0.0005428314054793126,
    "Q38": "48.14 T",
    "R38": "3.52 K ⧌",
    "AX38": "Rend Usually caps at (blank if no cap)",
    "FU38": 1,
    "FV38": "",
    "FW38": "",
    "FX38": "",
    "FY38": "",
    "FZ38": "",
    "GA38": "",
    "GB38": "",
    "GC38": "",
    "GD38": "",
    "GE38": "",
    "GF38": "",
    "GG38": "",
    "GH38": "",
    "GI38": "",
    "GJ38": "",
    "GK38": "",
    "GL38": "",
    "GM38": "",
    "GN38": "",
    "GO38": "",
    "C39": "Damage/Meter +",
    "H39": "0d  3h 31m",
    "J39": "99.27 B",
    "M39": "CL Damage",
    "N39": 22,
    "O39": 434,
    "P39": 0.0004923612988481168,
    "Q39": "58.43 T",
    "R39": "3.95 K ⧌",
    "AG39": "⚠️ Be carefull about UW sync if you follow blindly the paths",
    "AX39": "DW Kill Wall enemy hit count per EW",
    "BA39": 20,
    "FU39": "",
    "FV39": "",
    "FW39": "",
    "FX39": "",
    "FY39": "",
    "FZ39": "",
    "GA39": "",
    "GB39": "",
    "GC39": "",
    "GD39": "",
    "GE39": "",
    "GF39": "",
    "GG39": "",
    "GH39": "",
    "GI39": "",
    "GJ39": "",
    "GK39": "",
    "GL39": "",
    "GM39": "",
    "GN39": "",
    "GO39": "",
    "C40": "Super Crit Mult +",
    "H40": "0d  3h 31m",
    "J40": "100.98 B",
    "M40": "CL Chance",
    "N40": 11,
    "O40": 170,
    "P40": 0.00047656325218203583,
    "Q40": "63.16 T",
    "R40": "4.12 K ⧌",
    "FU40": "",
    "FV40": 1,
    "FW40": "",
    "FX40": "",
    "FY40": "",
    "FZ40": "",
    "GA40": "",
    "GB40": "",
    "GC40": "",
    "GD40": "",
    "GE40": "",
    "GF40": "",
    "GG40": "",
    "GH40": "",
    "GI40": "",
    "GJ40": "",
    "GK40": "",
    "GL40": "",
    "GM40": "",
    "GN40": "",
    "GO40": "",
    "C41": "Attack Speed +",
    "H41": "0d  5h 43m",
    "J41": "103.31 B",
    "M41": "CL Damage",
    "N41": 23,
    "O41": 525,
    "P41": 0.0003998738563407764,
    "Q41": "76.42 T",
    "R41": "4.65 K ⧌",
    "FU41": "",
    "FV41": "",
    "FW41": "",
    "FX41": 1,
    "FY41": "",
    "FZ41": "",
    "GA41": "",
    "GB41": "",
    "GC41": "",
    "GD41": "",
    "GE41": "",
    "GF41": "",
    "GG41": "",
    "GH41": "",
    "GI41": "",
    "GJ41": "",
    "GK41": "",
    "GL41": "",
    "GM41": "",
    "GN41": "",
    "GO41": "",
    "H42": "0d  1h 56m",
    "J42": "104.07 B",
    "M42": "CL Chance",
    "N42": 12,
    "O42": 188,
    "P42": 0.0003986904216308786,
    "Q42": "82.15 T",
    "R42": "4.83 K ⧌",
    "FU42": 1,
    "FV42": "",
    "FW42": "",
    "FX42": "",
    "FY42": "",
    "FZ42": "",
    "GA42": "",
    "GB42": "",
    "GC42": "",
    "GD42": "",
    "GE42": "",
    "GF42": "",
    "GG42": "",
    "GH42": "",
    "GI42": "",
    "GJ42": "",
    "GK42": "",
    "GL42": "",
    "GM42": "",
    "GN42": "",
    "GO42": "",
    "H43": "0d  4h 32m",
    "J43": "105.84 B",
    "M43": "CL Chance",
    "N43": 13,
    "O43": 206,
    "P43": 0.00033848282107224066,
    "Q43": "87.88 T",
    "R43": "5.04 K ⧌",
    "FU43": "",
    "FV43": "",
    "FW43": "",
    "FX43": "",
    "FY43": "",
    "FZ43": "",
    "GA43": "",
    "GB43": "",
    "GC43": "",
    "GD43": "",
    "GE43": "",
    "GF43": "",
    "GG43": "",
    "GH43": "",
    "GI43": "",
    "GJ43": "",
    "GK43": "",
    "GL43": "",
    "GM43": "",
    "GN43": "",
    "GO43": "",
    "H44": "0d  4h 32m",
    "J44": "107.63 B",
    "M44": "CL Damage",
    "N44": 24,
    "O44": 636,
    "P44": 0.0003227068855325198,
    "Q44": "105.92 T",
    "R44": "5.68 K ⧌",
    "FU44": "",
    "FV44": 1,
    "FW44": "",
    "FX44": "",
    "FY44": "",
    "FZ44": "",
    "GA44": "",
    "GB44": "",
    "GC44": "",
    "GD44": "",
    "GE44": "",
    "GF44": "",
    "GG44": "",
    "GH44": "",
    "GI44": "",
    "GJ44": "",
    "GK44": "",
    "GL44": "",
    "GM44": "",
    "GN44": "",
    "GO44": "",
    "H45": "0d  7h  3m",
    "J45": "110.07 B",
    "M45": "CL Chance",
    "N45": 14,
    "O45": 224,
    "P45": 0.00029101965888194456,
    "Q45": "112.82 T",
    "R45": "5.9 K ⧌",
    "FU45": "",
    "FV45": "",
    "FW45": "",
    "FX45": "",
    "FY45": "",
    "FZ45": "",
    "GA45": 1,
    "GB45": "",
    "GC45": "",
    "GD45": "",
    "GE45": "",
    "GF45": "",
    "GG45": "",
    "GH45": "",
    "GI45": "",
    "GJ45": "",
    "GK45": "",
    "GL45": "",
    "GM45": "",
    "GN45": "",
    "GO45": "",
    "H46": "0d  4h 59m",
    "J46": "111.67 B",
    "M46": "CL Damage",
    "N46": 25,
    "O46": 767,
    "P46": 0.0002637423208759828,
    "Q46": "135.65 T",
    "R46": "6.67 K ⧌",
    "FU46": 1,
    "FV46": "",
    "FW46": "",
    "FX46": "",
    "FY46": "",
    "FZ46": "",
    "GA46": "",
    "GB46": "",
    "GC46": "",
    "GD46": "",
    "GE46": "",
    "GF46": "",
    "GG46": "",
    "GH46": "",
    "GI46": "",
    "GJ46": "",
    "GK46": "",
    "GL46": "",
    "GM46": "",
    "GN46": "",
    "GO46": "",
    "H47": "0d  5h 43m",
    "J47": "113.53 B",
    "M47": "CL Chance",
    "N47": 15,
    "O47": 242,
    "P47": 0.000252905953410984,
    "Q47": "143.95 T",
    "R47": "6.91 K ⧌",
    "FU47": "",
    "FV47": "",
    "FW47": "",
    "FX47": "",
    "FY47": "",
    "FZ47": "",
    "GA47": "",
    "GB47": "",
    "GC47": "",
    "GD47": "",
    "GE47": "",
    "GF47": "",
    "GG47": "",
    "GH47": "",
    "GI47": "",
    "GJ47": "",
    "GK47": "",
    "GL47": "",
    "GM47": "",
    "GN47": "",
    "GO47": "",
    "H48": "0d  5h 43m",
    "J48": "115.43 B",
    "M48": "CL Chance",
    "N48": 16,
    "O48": 260,
    "P48": 0.00022182092051695917,
    "Q48": "152.25 T",
    "R48": "7.17 K ⧌",
    "FU48": "",
    "FV48": "",
    "FW48": "",
    "FX48": 1,
    "FY48": "",
    "FZ48": "",
    "GA48": "",
    "GB48": "",
    "GC48": "",
    "GD48": "",
    "GE48": "",
    "GF48": "",
    "GG48": "",
    "GH48": "",
    "GI48": "",
    "GJ48": "",
    "GK48": "",
    "GL48": "",
    "GM48": "",
    "GN48": "",
    "GO48": "",
    "H49": "0d  2h 39m",
    "J49": "116.27 B",
    "M49": "CL Damage",
    "N49": 26,
    "O49": 923,
    "P49": 0.00021624568534873612,
    "Q49": "182.64 T",
    "R49": "8.09 K ⧌",
    "FU49": "",
    "FV49": 1,
    "FW49": "",
    "FX49": "",
    "FY49": "",
    "FZ49": "",
    "GA49": "",
    "GB49": "",
    "GC49": "",
    "GD49": "",
    "GE49": "",
    "GF49": "",
    "GG49": "",
    "GH49": "",
    "GI49": "",
    "GJ49": "",
    "GK49": "",
    "GL49": "",
    "GM49": "",
    "GN49": "",
    "GO49": "",
    "H50": "0d  8h 34m",
    "J50": "118.84 B",
    "M50": "CL Damage",
    "N50": 27,
    "O50": 1109,
    "P50": 0.00017681155703370293,
    "Q50": "218.45 T",
    "R50": "9.2 K ⧌",
    "FU50": 1,
    "FV50": "",
    "FW50": "",
    "FX50": "",
    "FY50": "",
    "FZ50": "",
    "GA50": "",
    "GB50": "",
    "GC50": "",
    "GD50": "",
    "GE50": "",
    "GF50": "",
    "GG50": "",
    "GH50": "",
    "GI50": "",
    "GJ50": "",
    "GK50": "",
    "GL50": "",
    "GM50": "",
    "GN50": "",
    "GO50": "",
    "H51": "0d  7h  3m",
    "J51": "120.79 B",
    "M51": "CL Damage",
    "N51": 28,
    "O51": 1295,
    "P51": 0.0001496942734737638,
    "Q51": "260.8 T",
    "R51": "10.5 K ⧌",
    "FU51": "",
    "FV51": "",
    "FW51": "",
    "FX51": "",
    "FY51": "",
    "FZ51": "",
    "GA51": "",
    "GB51": "",
    "GC51": "",
    "GD51": "",
    "GE51": "",
    "GF51": "",
    "GG51": "",
    "GH51": "",
    "GI51": "",
    "GJ51": "",
    "GK51": "",
    "GL51": "",
    "GM51": "",
    "GN51": "",
    "GO51": "",
    "H52": "0d  7h  3m",
    "J52": "122.77 B",
    "M52": "CL Damage",
    "N52": 29,
    "O52": 1521,
    "P52": 0.00012603202694710838,
    "Q52": "310.79 T",
    "R52": "12.02 K ⧌",
    "FU52": "",
    "FV52": 1,
    "FW52": "",
    "FX52": "",
    "FY52": "",
    "FZ52": "",
    "GA52": "",
    "GB52": "",
    "GC52": "",
    "GD52": "",
    "GE52": "",
    "GF52": "",
    "GG52": "",
    "GH52": "",
    "GI52": "",
    "GJ52": "",
    "GK52": "",
    "GL52": "",
    "GM52": "",
    "GN52": "",
    "GO52": "",
    "H53": "0d 10h 15m",
    "J53": "125.43 B",
    "M53": "CL Damage",
    "N53": 30,
    "O53": 1787,
    "P53": 0.00010590138604824552,
    "Q53": "369.61 T",
    "R53": "13.8 K ⧌",
    "FU53": "",
    "FV53": "",
    "FW53": "",
    "FX53": 1,
    "FY53": "",
    "FZ53": "",
    "GA53": "",
    "GB53": "",
    "GC53": "",
    "GD53": "",
    "GE53": "",
    "GF53": "",
    "GG53": "",
    "GH53": "",
    "GI53": "",
    "GJ53": "",
    "GK53": "",
    "GL53": "",
    "GM53": "",
    "GN53": "",
    "GO53": "",
    "H54": "0d  3h 31m",
    "J54": "126.34 B",
    "M54": "CL Damage",
    "N54": 31,
    "O54": 2103,
    "P54": 0.00008912071497875472,
    "Q54": "438.88 T",
    "R54": "15.91 K ⧌",
    "FU54": "",
    "FV54": "",
    "FW54": "",
    "FX54": "",
    "FY54": "",
    "FZ54": "",
    "GA54": "",
    "GB54": "",
    "GC54": "",
    "GD54": "",
    "GE54": "",
    "GF54": "",
    "GG54": "",
    "GH54": "",
    "GI54": "",
    "GJ54": "",
    "GK54": "",
    "GL54": "",
    "GM54": "",
    "GN54": "",
    "GO54": "",
    "H55": "0d  8h 34m",
    "J55": "128.38 B",
    "M55": "CL Damage",
    "N55": 32,
    "O55": 2469,
    "P55": 0.00007514573668643686,
    "Q55": "520.31 T",
    "R55": "18.38 K ⧌",
    "FU55": 1,
    "FV55": "",
    "FW55": "",
    "FX55": "",
    "FY55": "",
    "FZ55": "",
    "GA55": "",
    "GB55": "",
    "GC55": "",
    "GD55": "",
    "GE55": "",
    "GF55": "",
    "GG55": "",
    "GH55": "",
    "GI55": "",
    "GJ55": "",
    "GK55": "",
    "GL55": "",
    "GM55": "",
    "GN55": "",
    "GO55": "",
    "H56": "0d  8h 34m",
    "J56": "130.45 B",
    "M56": "DW Damage",
    "N56": 7,
    "O56": 35,
    "P56": 2.3331492547486376e-9,
    "Q56": "520.31 T",
    "R56": "18.41 K ⧌",
    "FU56": "",
    "FV56": "",
    "FW56": "",
    "FX56": "",
    "FY56": "",
    "FZ56": "",
    "GA56": "",
    "GB56": "",
    "GC56": "",
    "GD56": 1,
    "GE56": "",
    "GF56": "",
    "GG56": "",
    "GH56": "",
    "GI56": "",
    "GJ56": "",
    "GK56": "",
    "GL56": "",
    "GM56": "",
    "GN56": "",
    "GO56": "",
    "H57": "0d  5h 34m",
    "J57": "131.74 B",
    "M57": "DW Damage",
    "N57": 8,
    "O57": 41,
    "P57": 2.7883976645275044e-9,
    "Q57": "520.31 T",
    "R57": "18.45 K ⧌",
    "FU57": "",
    "FV57": 1,
    "FW57": "",
    "FX57": "",
    "FY57": "",
    "FZ57": "",
    "GA57": "",
    "GB57": "",
    "GC57": "",
    "GD57": "",
    "GE57": "",
    "GF57": "",
    "GG57": "",
    "GH57": "",
    "GI57": "",
    "GJ57": "",
    "GK57": "",
    "GL57": "",
    "GM57": "",
    "GN57": "",
    "GO57": "",
    "H58": "0d 12h  7m",
    "J58": "134.53 B",
    "M58": "DW Damage",
    "N58": 9,
    "O58": 47,
    "P58": 2.9536670934141796e-9,
    "Q58": "520.31 T",
    "R58": "18.5 K ⧌",
    "FU58": "",
    "FV58": "",
    "FW58": "",
    "FX58": 1,
    "FY58": "",
    "FZ58": "",
    "GA58": "",
    "GB58": "",
    "GC58": "",
    "GD58": "",
    "GE58": "",
    "GF58": "",
    "GG58": "",
    "GH58": "",
    "GI58": "",
    "GJ58": "",
    "GK58": "",
    "GL58": "",
    "GM58": "",
    "GN58": "",
    "GO58": "",
    "H59": "0d  4h 32m",
    "J59": "135.5 B",
    "M59": "DW Damage",
    "N59": 10,
    "O59": 53,
    "P59": 3.389668537471058e-9,
    "Q59": "520.31 T",
    "R59": "18.55 K ⧌",
    "FU59": "",
    "FV59": "",
    "FW59": "",
    "FX59": "",
    "FY59": "",
    "FZ59": "",
    "GA59": "",
    "GB59": "",
    "GC59": "",
    "GD59": "",
    "GE59": "",
    "GF59": "",
    "GG59": "",
    "GH59": "",
    "GI59": "",
    "GJ59": "",
    "GK59": "",
    "GL59": "",
    "GM59": "",
    "GN59": "",
    "GO59": "",
    "H60": "0d 10h 15m",
    "J60": "137.65 B",
    "M60": "DW Damage",
    "N60": 11,
    "O60": 61,
    "P60": 3.748336220645271e-9,
    "Q60": "520.31 T",
    "R60": "18.61 K ⧌",
    "FU60": 1,
    "FV60": "",
    "FW60": "",
    "FX60": "",
    "FY60": "",
    "FZ60": "",
    "GA60": "",
    "GB60": "",
    "GC60": "",
    "GD60": "",
    "GE60": "",
    "GF60": "",
    "GG60": "",
    "GH60": "",
    "GI60": "",
    "GJ60": "",
    "GK60": "",
    "GL60": "",
    "GM60": "",
    "GN60": "",
    "GO60": "",
    "H61": "0d 10h 15m",
    "J61": "139.83 B",
    "M61": "DW Damage",
    "N61": 12,
    "O61": 71,
    "P61": 4.0255010060854335e-9,
    "Q61": "520.31 T",
    "R61": "18.68 K ⧌",
    "FU61": "",
    "FV61": 1,
    "FW61": "",
    "FX61": "",
    "FY61": "",
    "FZ61": "",
    "GA61": "",
    "GB61": "",
    "GC61": "",
    "GD61": "",
    "GE61": "",
    "GF61": "",
    "GG61": "",
    "GH61": "",
    "GI61": "",
    "GJ61": "",
    "GK61": "",
    "GL61": "",
    "GM61": "",
    "GN61": "",
    "GO61": "",
    "H62": "0d 14h 10m",
    "J62": "142.73 B",
    "M62": "DW Damage",
    "N62": 13,
    "O62": 84,
    "P62": 4.180221446770105e-9,
    "Q62": "520.31 T",
    "R62": "18.77 K ⧌",
    "FU62": "",
    "FV62": "",
    "FW62": "",
    "FX62": "",
    "FY62": "",
    "FZ62": "",
    "GA62": "",
    "GB62": "",
    "GC62": "",
    "GD62": "",
    "GE62": "",
    "GF62": "",
    "GG62": "",
    "GH62": "",
    "GI62": "",
    "GJ62": "",
    "GK62": "",
    "GL62": "",
    "GM62": "",
    "GN62": "",
    "GO62": "",
    "H63": "0d 12h  7m",
    "J63": "144.96 B",
    "M63": "DW Damage",
    "N63": 14,
    "O63": 100,
    "P63": 4.327985894114761e-9,
    "Q63": "520.31 T",
    "R63": "18.87 K ⧌",
    "FU63": 1,
    "FV63": "",
    "FW63": "",
    "FX63": "",
    "FY63": "",
    "FZ63": "",
    "GA63": "",
    "GB63": "",
    "GC63": "",
    "GD63": "",
    "GE63": "",
    "GF63": "",
    "GG63": "",
    "GH63": "",
    "GI63": "",
    "GJ63": "",
    "GK63": "",
    "GL63": "",
    "GM63": "",
    "GN63": "",
    "GO63": "",
    "H64": "0d 12h  7m",
    "J64": "147.22 B",
    "M64": "DW Damage",
    "N64": 15,
    "O64": 120,
    "P64": 4.423254111133682e-9,
    "Q64": "520.31 T",
    "R64": "18.99 K ⧌",
    "FU64": "",
    "FV64": "",
    "FW64": "",
    "FX64": 1,
    "FY64": "",
    "FZ64": "",
    "GA64": "",
    "GB64": "",
    "GC64": "",
    "GD64": "",
    "GE64": "",
    "GF64": "",
    "GG64": "",
    "GH64": "",
    "GI64": "",
    "GJ64": "",
    "GK64": "",
    "GL64": "",
    "GM64": "",
    "GN64": "",
    "GO64": "",
    "H65": "0d  5h 43m",
    "J65": "148.28 B",
    "M65": "DW Damage",
    "N65": 16,
    "O65": 144,
    "P65": 4.423251761778404e-9,
    "Q65": "520.31 T",
    "R65": "19.13 K ⧌",
    "FU65": "",
    "FV65": 1,
    "FW65": "",
    "FX65": "",
    "FY65": "",
    "FZ65": "",
    "GA65": "",
    "GB65": "",
    "GC65": "",
    "GD65": "",
    "GE65": "",
    "GF65": "",
    "GG65": "",
    "GH65": "",
    "GI65": "",
    "GJ65": "",
    "GK65": "",
    "GL65": "",
    "GM65": "",
    "GN65": "",
    "GO65": "",
    "H66": "0d 16h 25m",
    "J66": "151.29 B",
    "M66": "DW Damage",
    "N66": 17,
    "O66": 174,
    "P66": 4.458447212950867e-9,
    "Q66": "520.31 T",
    "R66": "19.31 K ⧌",
    "FU66": "",
    "FV66": "",
    "FW66": "",
    "FX66": "",
    "FY66": "",
    "FZ66": "",
    "GA66": "",
    "GB66": "",
    "GC66": "",
    "GD66": "",
    "GE66": "",
    "GF66": "",
    "GG66": "",
    "GH66": "",
    "GI66": "",
    "GJ66": "",
    "GK66": "",
    "GL66": "",
    "GM66": "",
    "GN66": "",
    "GO66": "",
    "H67": "0d 14h 10m",
    "J67": "153.62 B",
    "M67": "DW Damage",
    "N67": 18,
    "O67": 210,
    "P67": 4.4329669321573396e-9,
    "Q67": "520.31 T",
    "R67": "19.52 K ⧌",
    "FU67": 1,
    "FV67": "",
    "FW67": "",
    "FX67": "",
    "FY67": "",
    "FZ67": "",
    "GA67": "",
    "GB67": "",
    "GC67": "",
    "GD67": "",
    "GE67": "",
    "GF67": "",
    "GG67": "",
    "GH67": "",
    "GI67": "",
    "GJ67": "",
    "GK67": "",
    "GL67": "",
    "GM67": "",
    "GN67": "",
    "GO67": "",
    "H68": "0d 14h 10m",
    "J68": "155.97 B",
    "M68": "DW Damage",
    "N68": 19,
    "O68": 254,
    "P68": 4.082992057313554e-9,
    "Q68": "520.31 T",
    "R68": "19.77 K ⧌",
    "FU68": "",
    "FV68": "",
    "FW68": "",
    "FX68": "",
    "FY68": "",
    "FZ68": "",
    "GA68": 1,
    "GB68": "",
    "GC68": "",
    "GD68": "",
    "GE68": "",
    "GF68": "",
    "GG68": "",
    "GH68": "",
    "GI68": "",
    "GJ68": "",
    "GK68": "",
    "GL68": "",
    "GM68": "",
    "GN68": "",
    "GO68": "",
    "H69": "0d 13h 21m",
    "J69": "158.22 B",
    "M69": "DW Damage",
    "N69": 20,
    "O69": 308,
    "P69": 4.082987823741045e-9,
    "Q69": "520.31 T",
    "R69": "20.08 K ⧌",
    "FU69": "",
    "FV69": 1,
    "FW69": "",
    "FX69": "",
    "FY69": "",
    "FZ69": "",
    "GA69": "",
    "GB69": "",
    "GC69": "",
    "GD69": "",
    "GE69": "",
    "GF69": "",
    "GG69": "",
    "GH69": "",
    "GI69": "",
    "GJ69": "",
    "GK69": "",
    "GL69": "",
    "GM69": "",
    "GN69": "",
    "GO69": "",
    "H70": "0d 18h 52m",
    "J70": "161.38 B",
    "M70": "DW Damage",
    "N70": 21,
    "O70": 374,
    "P70": 4.082982688726316e-9,
    "Q70": "520.31 T",
    "R70": "20.45 K ⧌",
    "FU70": "",
    "FV70": "",
    "FW70": "",
    "FX70": "",
    "FY70": "",
    "FZ70": "",
    "GA70": "",
    "GB70": "",
    "GC70": "",
    "GD70": 1,
    "GE70": "",
    "GF70": "",
    "GG70": "",
    "GH70": "",
    "GI70": "",
    "GJ70": "",
    "GK70": "",
    "GL70": "",
    "GM70": "",
    "GN70": "",
    "GO70": "",
    "H71": "0d  9h 39m",
    "J71": "162.96 B",
    "M71": "DW Damage",
    "N71": 22,
    "O71": 452,
    "P71": 4.08297645398418e-9,
    "Q71": "520.31 T",
    "R71": "20.9 K ⧌",
    "FU71": "",
    "FV71": "",
    "FW71": "",
    "FX71": 1,
    "FY71": "",
    "FZ71": "",
    "GA71": "",
    "GB71": "",
    "GC71": "",
    "GD71": "",
    "GE71": "",
    "GF71": "",
    "GG71": "",
    "GH71": "",
    "GI71": "",
    "GJ71": "",
    "GK71": "",
    "GL71": "",
    "GM71": "",
    "GN71": "",
    "GO71": "",
    "H72": "0d  7h  3m",
    "J72": "164.12 B",
    "M72": "DW Damage",
    "N72": 23,
    "O72": 558,
    "P72": 4.082968918358166e-9,
    "Q72": "520.31 T",
    "R72": "21.46 K ⧌",
    "FU72": "",
    "FV72": "",
    "FW72": "",
    "FX72": "",
    "FY72": "",
    "FZ72": "",
    "GA72": "",
    "GB72": "",
    "GC72": "",
    "GD72": "",
    "GE72": "",
    "GF72": "",
    "GG72": "",
    "GH72": "",
    "GI72": "",
    "GJ72": "",
    "GK72": "",
    "GL72": "",
    "GM72": "",
    "GN72": "",
    "GO72": "",
    "H73": "0d 16h 25m",
    "J73": "166.61 B",
    "M73": "DW Damage",
    "N73": 24,
    "O73": 694,
    "P73": 4.082959616576116e-9,
    "Q73": "520.32 T",
    "R73": "22.16 K ⧌",
    "FU73": 1,
    "FV73": "",
    "FW73": "",
    "FX73": "",
    "FY73": "",
    "FZ73": "",
    "GA73": "",
    "GB73": "",
    "GC73": "",
    "GD73": "",
    "GE73": "",
    "GF73": "",
    "GG73": "",
    "GH73": "",
    "GI73": "",
    "GJ73": "",
    "GK73": "",
    "GL73": "",
    "GM73": "",
    "GN73": "",
    "GO73": "",
    "H74": "0d 16h 25m",
    "J74": "169.12 B",
    "M74": "DW Cooldown",
    "N74": 13,
    "O74": 184,
    "P74": 4.723990615351781e-9,
    "Q74": "520.32 T",
    "R74": "22.34 K ⧌",
    "FU74": "",
    "FV74": 1,
    "FW74": "",
    "FX74": "",
    "FY74": "",
    "FZ74": "",
    "GA74": "",
    "GB74": "",
    "GC74": "",
    "GD74": "",
    "GE74": "",
    "GF74": "",
    "GG74": "",
    "GH74": "",
    "GI74": "",
    "GJ74": "",
    "GK74": "",
    "GL74": "",
    "GM74": "",
    "GN74": "",
    "GO74": "",
    "H75": "0d 21h 31m",
    "J75": "172.43 B",
    "M75": "DW Cooldown",
    "N75": 14,
    "O75": 200,
    "P75": 4.85736965760708e-9,
    "Q75": "520.32 T",
    "R75": "22.54 K ⧌",
    "FU75": "",
    "FV75": "",
    "FW75": "",
    "FX75": 1,
    "FY75": "",
    "FZ75": "",
    "GA75": "",
    "GB75": "",
    "GC75": "",
    "GD75": "",
    "GE75": "",
    "GF75": "",
    "GG75": "",
    "GH75": "",
    "GI75": "",
    "GJ75": "",
    "GK75": "",
    "GL75": "",
    "GM75": "",
    "GN75": "",
    "GO75": "",
    "H76": "0d  8h 34m",
    "J76": "173.65 B",
    "M76": "DW Cooldown",
    "N76": 15,
    "O76": 216,
    "P76": 5.05975514470053e-9,
    "Q76": "520.32 T",
    "R76": "22.76 K ⧌",
    "FU76": "",
    "FV76": "",
    "FW76": "",
    "FX76": "",
    "FY76": "",
    "FZ76": "",
    "GA76": "",
    "GB76": "",
    "GC76": "",
    "GD76": "",
    "GE76": "",
    "GF76": "",
    "GG76": "",
    "GH76": "",
    "GI76": "",
    "GJ76": "",
    "GK76": "",
    "GL76": "",
    "GM76": "",
    "GN76": "",
    "GO76": "",
    "H77": "0d 18h 52m",
    "J77": "176.24 B",
    "M77": "DW Cooldown",
    "N77": 16,
    "O77": 232,
    "P77": 5.338908213992843e-9,
    "Q77": "520.32 T",
    "R77": "22.99 K ⧌",
    "FU77": "",
    "FV77": 1,
    "FW77": "",
    "FX77": "",
    "FY77": "",
    "FZ77": "",
    "GA77": "",
    "GB77": "",
    "GC77": "",
    "GD77": "",
    "GE77": "",
    "GF77": "",
    "GG77": "",
    "GH77": "",
    "GI77": "",
    "GJ77": "",
    "GK77": "",
    "GL77": "",
    "GM77": "",
    "GN77": "",
    "GO77": "",
    "H78": "1d  0h 22m",
    "J78": "179.63 B",
    "M78": "DW Cooldown",
    "N78": 17,
    "O78": 248,
    "P78": 5.707950099135524e-9,
    "Q78": "520.32 T",
    "R78": "23.24 K ⧌",
    "FU78": 1,
    "FV78": "",
    "FW78": "",
    "FX78": "",
    "FY78": "",
    "FZ78": "",
    "GA78": "",
    "GB78": "",
    "GC78": "",
    "GD78": "",
    "GE78": "",
    "GF78": "",
    "GG78": "",
    "GH78": "",
    "GI78": "",
    "GJ78": "",
    "GK78": "",
    "GL78": "",
    "GM78": "",
    "GN78": "",
    "GO78": "",
    "H79": "0d 18h 52m",
    "J79": "182.29 B",
    "M79": "DW Cooldown",
    "N79": 18,
    "O79": 264,
    "P79": 6.186930159268408e-9,
    "Q79": "520.32 T",
    "R79": "23.5 K ⧌",
    "FU79": "",
    "FV79": 1,
    "FW79": "",
    "FX79": "",
    "FY79": "",
    "FZ79": "",
    "GA79": "",
    "GB79": "",
    "GC79": "",
    "GD79": "",
    "GE79": "",
    "GF79": "",
    "GG79": "",
    "GH79": "",
    "GI79": "",
    "GJ79": "",
    "GK79": "",
    "GL79": "",
    "GM79": "",
    "GN79": "",
    "GO79": "",
    "H80": "1d  3h 26m",
    "J80": "185.72 B",
    "M80": "DW Cooldown",
    "N80": 19,
    "O80": 280,
    "P80": 6.805612061201925e-9,
    "Q80": "520.32 T",
    "R80": "23.78 K ⧌",
    "FU80": "",
    "FV80": "",
    "FW80": "",
    "FX80": 1,
    "FY80": "",
    "FZ80": "",
    "GA80": "",
    "GB80": "",
    "GC80": "",
    "GD80": "",
    "GE80": "",
    "GF80": "",
    "GG80": "",
    "GH80": "",
    "GI80": "",
    "GJ80": "",
    "GK80": "",
    "GL80": "",
    "GM80": "",
    "GN80": "",
    "GO80": "",
    "H81": "0d 10h 15m",
    "J81": "187.03 B",
    "M81": "DW Cooldown",
    "N81": 20,
    "O81": 346,
    "P81": 6.508770544370245e-9,
    "Q81": "520.32 T",
    "R81": "24.13 K ⧌",
    "FU81": "",
    "FV81": "",
    "FW81": "",
    "FX81": "",
    "FY81": "",
    "FZ81": "",
    "GA81": "",
    "GB81": "",
    "GC81": "",
    "GD81": "",
    "GE81": "",
    "GF81": "",
    "GG81": "",
    "GH81": "",
    "GI81": "",
    "GJ81": "",
    "GK81": "",
    "GL81": "",
    "GM81": "",
    "GN81": "",
    "GO81": "",
    "H82": "0d 21h 31m",
    "J82": "189.78 B",
    "M82": "DW Damage",
    "N82": 25,
    "O82": 880,
    "P82": 7.052284562386097e-9,
    "Q82": "520.32 T",
    "R82": "25.01 K ⧌",
    "FU82": "",
    "FV82": "",
    "FW82": "",
    "FX82": "",
    "FY82": "",
    "FZ82": "",
    "GA82": "",
    "GB82": "",
    "GC82": "",
    "GD82": 1,
    "GE82": "",
    "GF82": "",
    "GG82": "",
    "GH82": "",
    "GI82": "",
    "GJ82": "",
    "GK82": "",
    "GL82": "",
    "GM82": "",
    "GN82": "",
    "GO82": "",
    "H83": "0d 14h 14m",
    "J83": "191.62 B",
    "M83": "DW Damage",
    "N83": 26,
    "O83": 1126,
    "P83": 7.052240796071449e-9,
    "Q83": "520.33 T",
    "R83": "26.13 K ⧌",
    "FU83": 1,
    "FV83": "",
    "FW83": "",
    "FX83": "",
    "FY83": "",
    "FZ83": "",
    "GA83": "",
    "GB83": "",
    "GC83": "",
    "GD83": "",
    "GE83": "",
    "GF83": "",
    "GG83": "",
    "GH83": "",
    "GI83": "",
    "GJ83": "",
    "GK83": "",
    "GL83": "",
    "GM83": "",
    "GN83": "",
    "GO83": "",
    "H84": "0d 21h 31m",
    "J84": "194.42 B",
    "M84": "DW Cooldown",
    "N84": 21,
    "O84": 512,
    "P84": 8.041143523609962e-9,
    "Q84": "520.33 T",
    "R84": "26.64 K ⧌",
    "FU84": "",
    "FV84": "",
    "FW84": "",
    "FX84": "",
    "FY84": "",
    "FZ84": "",
    "GA84": 1,
    "GB84": "",
    "GC84": "",
    "GD84": "",
    "GE84": "",
    "GF84": "",
    "GG84": "",
    "GH84": "",
    "GI84": "",
    "GJ84": "",
    "GK84": "",
    "GL84": "",
    "GM84": "",
    "GN84": "",
    "GO84": "",
    "H85": "0d 21h 53m",
    "J85": "197.19 B",
    "M85": "DW Damage",
    "N85": 27,
    "O85": 1432,
    "P85": 7.779039972698769e-9,
    "Q85": "520.34 T",
    "R85": "28.08 K ⧌",
    "FU85": "",
    "FV85": 1,
    "FW85": "",
    "FX85": "",
    "FY85": "",
    "FZ85": "",
    "GA85": "",
    "GB85": "",
    "GC85": "",
    "GD85": "",
    "GE85": "",
    "GF85": "",
    "GG85": "",
    "GH85": "",
    "GI85": "",
    "GJ85": "",
    "GK85": "",
    "GL85": "",
    "GM85": "",
    "GN85": "",
    "GO85": "",
    "H86": "1d  6h 44m",
    "J86": "200.84 B",
    "M86": "DW Damage",
    "N86": 28,
    "O86": 1813,
    "P86": 7.761563625919284e-9,
    "Q86": "520.34 T",
    "R86": "29.89 K ⧌",
    "FU86": "",
    "FV86": "",
    "FW86": "",
    "FX86": "",
    "FY86": "",
    "FZ86": "",
    "GA86": "",
    "GB86": "",
    "GC86": "",
    "GD86": "",
    "GE86": "",
    "GF86": "",
    "GG86": "",
    "GH86": "",
    "GI86": "",
    "GJ86": "",
    "GK86": "",
    "GL86": "",
    "GM86": "",
    "GN86": "",
    "GO86": "",
    "H87": "1d  0h 22m",
    "J87": "203.75 B",
    "M87": "DW Damage",
    "N87": 29,
    "O87": 2269,
    "P87": 7.753757003972573e-9,
    "Q87": "520.35 T",
    "R87": "32.16 K ⧌",
    "FU87": 1,
    "FV87": "",
    "FW87": "",
    "FX87": "",
    "FY87": "",
    "FZ87": "",
    "GA87": "",
    "GB87": "",
    "GC87": "",
    "GD87": "",
    "GE87": "",
    "GF87": "",
    "GG87": "",
    "GH87": "",
    "GI87": "",
    "GJ87": "",
    "GK87": "",
    "GL87": "",
    "GM87": "",
    "GN87": "",
    "GO87": "",
    "H88": "1d  0h 22m",
    "J88": "206.67 B",
    "M88": "DW Damage",
    "N88": 30,
    "O88": 2800,
    "P88": 7.757039296372805e-9,
    "Q88": "520.36 T",
    "R88": "34.96 K ⧌",
    "FU88": "",
    "FV88": "",
    "FW88": "",
    "FX88": 1,
    "FY88": "",
    "FZ88": "",
    "GA88": "",
    "GB88": "",
    "GC88": "",
    "GD88": "",
    "GE88": "",
    "GF88": "",
    "GG88": "",
    "GH88": "",
    "GI88": "",
    "GJ88": "",
    "GK88": "",
    "GL88": "",
    "GM88": "",
    "GN88": "",
    "GO88": "",
    "H89": "0d 12h  7m",
    "J89": "208.12 B",
    "M89": "DW Damage",
    "N89": 31,
    "O89": 4081,
    "P89": 7.75877154748045e-9,
    "Q89": "520.38 T",
    "R89": "39.04 K ⧌",
    "FU89": "",
    "FV89": 1,
    "FW89": "",
    "FX89": "",
    "FY89": "",
    "FZ89": "",
    "GA89": "",
    "GB89": "",
    "GC89": "",
    "GD89": "",
    "GE89": "",
    "GF89": "",
    "GG89": "",
    "GH89": "",
    "GI89": "",
    "GJ89": "",
    "GK89": "",
    "GL89": "",
    "GM89": "",
    "GN89": "",
    "GO89": "",
    "H90": "1d 10h 14m",
    "J90": "211.9 B",
    "N90": "",
    "O90": "",
    "P90": "",
    "Q90": "",
    "R90": "",
    "FU90": "",
    "FV90": "",
    "FW90": "",
    "FX90": "",
    "FY90": "",
    "FZ90": "",
    "GA90": "",
    "GB90": "",
    "GC90": "",
    "GD90": "",
    "GE90": "",
    "GF90": "",
    "GG90": "",
    "GH90": "",
    "GI90": "",
    "GJ90": "",
    "GK90": "",
    "GL90": "",
    "GM90": "",
    "GN90": "",
    "GO90": "",
    "H91": "1d  3h 26m",
    "J91": "214.93 B",
    "N91": "",
    "O91": "",
    "P91": "",
    "Q91": "",
    "R91": "",
    "FU91": 1,
    "FV91": "",
    "FW91": "",
    "FX91": "",
    "FY91": "",
    "FZ91": "",
    "GA91": "",
    "GB91": "",
    "GC91": "",
    "GD91": "",
    "GE91": "",
    "GF91": "",
    "GG91": "",
    "GH91": "",
    "GI91": "",
    "GJ91": "",
    "GK91": "",
    "GL91": "",
    "GM91": "",
    "GN91": "",
    "GO91": "",
    "H92": "1d  3h 26m",
    "J92": "217.97 B",
    "N92": "",
    "O92": "",
    "P92": "",
    "Q92": "",
    "R92": "",
    "FU92": "",
    "FV92": "",
    "FW92": "",
    "FX92": 1,
    "FY92": "",
    "FZ92": "",
    "GA92": "",
    "GB92": "",
    "GC92": "",
    "GD92": "",
    "GE92": "",
    "GF92": "",
    "GG92": "",
    "GH92": "",
    "GI92": "",
    "GJ92": "",
    "GK92": "",
    "GL92": "",
    "GM92": "",
    "GN92": "",
    "GO92": "",
    "H93": "0d 14h 10m",
    "J93": "219.48 B",
    "N93": "",
    "O93": "",
    "P93": "",
    "Q93": "",
    "R93": "",
    "FU93": "",
    "FV93": "",
    "FW93": "",
    "FX93": "",
    "FY93": "",
    "FZ93": "",
    "GA93": "",
    "GB93": "",
    "GC93": "",
    "GD93": 1,
    "GE93": "",
    "GF93": "",
    "GG93": "",
    "GH93": "",
    "GI93": "",
    "GJ93": "",
    "GK93": "",
    "GL93": "",
    "GM93": "",
    "GN93": "",
    "GO93": "",
    "H94": "0d 19h 42m",
    "J94": "221.59 B",
    "N94": "",
    "O94": "",
    "P94": "",
    "Q94": "",
    "R94": "",
    "FU94": "",
    "FV94": 1,
    "FW94": "",
    "FX94": "",
    "FY94": "",
    "FZ94": "",
    "GA94": "",
    "GB94": "",
    "GC94": "",
    "GD94": "",
    "GE94": "",
    "GF94": "",
    "GG94": "",
    "GH94": "",
    "GI94": "",
    "GJ94": "",
    "GK94": "",
    "GL94": "",
    "GM94": "",
    "GN94": "",
    "GO94": "",
    "H95": "1d 13h 58m",
    "J95": "225.55 B",
    "N95": "",
    "O95": "",
    "P95": "",
    "Q95": "",
    "R95": "",
    "FU95": "",
    "FV95": "",
    "FW95": "",
    "FX95": "",
    "FY95": "",
    "FZ95": "",
    "GA95": "",
    "GB95": "",
    "GC95": "",
    "GD95": "",
    "GE95": "",
    "GF95": "",
    "GG95": "",
    "GH95": "",
    "GI95": "",
    "GJ95": "",
    "GK95": "",
    "GL95": "",
    "GM95": "",
    "GN95": "",
    "GO95": "",
    "H96": "1d  6h 44m",
    "J96": "228.73 B",
    "N96": "",
    "O96": "",
    "P96": "",
    "Q96": "",
    "R96": "",
    "FU96": "",
    "FV96": "",
    "FW96": "",
    "FX96": "",
    "FY96": "",
    "FZ96": "",
    "GA96": 1,
    "GB96": "",
    "GC96": "",
    "GD96": "",
    "GE96": "",
    "GF96": "",
    "GG96": "",
    "GH96": "",
    "GI96": "",
    "GJ96": "",
    "GK96": "",
    "GL96": "",
    "GM96": "",
    "GN96": "",
    "GO96": "",
    "H97": "1d  6h 54m",
    "J97": "231.94 B",
    "N97": "",
    "O97": "",
    "P97": "",
    "Q97": "",
    "R97": "",
    "FU97": 1,
    "FV97": "",
    "FW97": "",
    "FX97": "",
    "FY97": "",
    "FZ97": "",
    "GA97": "",
    "GB97": "",
    "GC97": "",
    "GD97": "",
    "GE97": "",
    "GF97": "",
    "GG97": "",
    "GH97": "",
    "GI97": "",
    "GJ97": "",
    "GK97": "",
    "GL97": "",
    "GM97": "",
    "GN97": "",
    "GO97": "",
    "H98": "1d  6h 44m",
    "J98": "235.17 B",
    "N98": "",
    "O98": "",
    "P98": "",
    "Q98": "",
    "R98": "",
    "FU98": "",
    "FV98": "",
    "FW98": "",
    "FX98": 1,
    "FY98": "",
    "FZ98": "",
    "GA98": "",
    "GB98": "",
    "GC98": "",
    "GD98": "",
    "GE98": "",
    "GF98": "",
    "GG98": "",
    "GH98": "",
    "GI98": "",
    "GJ98": "",
    "GK98": "",
    "GL98": "",
    "GM98": "",
    "GN98": "",
    "GO98": "",
    "H99": "0d 16h 25m",
    "J99": "236.79 B",
    "N99": "",
    "O99": "",
    "P99": "",
    "Q99": "",
    "R99": "",
    "FU99": "",
    "FV99": 1,
    "FW99": "",
    "FX99": "",
    "FY99": "",
    "FZ99": "",
    "GA99": "",
    "GB99": "",
    "GC99": "",
    "GD99": "",
    "GE99": "",
    "GF99": "",
    "GG99": "",
    "GH99": "",
    "GI99": "",
    "GJ99": "",
    "GK99": "",
    "GL99": "",
    "GM99": "",
    "GN99": "",
    "GO99": "",
    "H100": "1d 17h 56m",
    "J100": "240.95 B",
    "N100": "",
    "O100": "",
    "P100": "",
    "Q100": "",
    "R100": "",
    "FU100": "",
    "FV100": "",
    "FW100": "",
    "FX100": "",
    "FY100": "",
    "FZ100": "",
    "GA100": "",
    "GB100": "",
    "GC100": "",
    "GD100": "",
    "GE100": "",
    "GF100": "",
    "GG100": "",
    "GH100": "",
    "GI100": "",
    "GJ100": "",
    "GK100": "",
    "GL100": "",
    "GM100": "",
    "GN100": "",
    "GO100": "",
    "H101": "1d 10h 14m",
    "J101": "244.3 B",
    "N101": "",
    "O101": "",
    "P101": "",
    "Q101": "",
    "R101": "",
    "FU101": 1,
    "FV101": "",
    "FW101": "",
    "FX101": "",
    "FY101": "",
    "FZ101": "",
    "GA101": "",
    "GB101": "",
    "GC101": "",
    "GD101": "",
    "GE101": "",
    "GF101": "",
    "GG101": "",
    "GH101": "",
    "GI101": "",
    "GJ101": "",
    "GK101": "",
    "GL101": "",
    "GM101": "",
    "GN101": "",
    "GO101": "",
    "H102": "1d 10h 14m",
    "J102": "247.65 B",
    "N102": "",
    "O102": "",
    "P102": "",
    "Q102": "",
    "R102": "",
    "FU102": "",
    "FV102": "",
    "FW102": "",
    "FX102": "",
    "FY102": "",
    "FZ102": "",
    "GA102": "",
    "GB102": "",
    "GC102": "",
    "GD102": "",
    "GE102": 1,
    "GF102": "",
    "GG102": "",
    "GH102": "",
    "GI102": "",
    "GJ102": "",
    "GK102": "",
    "GL102": "",
    "GM102": "",
    "GN102": "",
    "GO102": "",
    "H103": "1d  0h 59m",
    "J103": "250.12 B",
    "N103": "",
    "O103": "",
    "P103": "",
    "Q103": "",
    "R103": "",
    "FU103": "",
    "FV103": 1,
    "FW103": "",
    "FX103": "",
    "FY103": "",
    "FZ103": "",
    "GA103": "",
    "GB103": "",
    "GC103": "",
    "GD103": "",
    "GE103": "",
    "GF103": "",
    "GG103": "",
    "GH103": "",
    "GI103": "",
    "GJ103": "",
    "GK103": "",
    "GL103": "",
    "GM103": "",
    "GN103": "",
    "GO103": "",
    "H104": "1d 22h  7m",
    "J104": "254.44 B",
    "N104": "",
    "O104": "",
    "P104": "",
    "Q104": "",
    "R104": "",
    "FU104": "",
    "FV104": "",
    "FW104": "",
    "FX104": 1,
    "FY104": "",
    "FZ104": "",
    "GA104": "",
    "GB104": "",
    "GC104": "",
    "GD104": "",
    "GE104": "",
    "GF104": "",
    "GG104": "",
    "GH104": "",
    "GI104": "",
    "GJ104": "",
    "GK104": "",
    "GL104": "",
    "GM104": "",
    "GN104": "",
    "GO104": "",
    "H105": "0d 18h 52m",
    "J105": "256.19 B",
    "N105": "",
    "O105": "",
    "P105": "",
    "Q105": "",
    "R105": "",
    "FU105": "",
    "FV105": "",
    "FW105": "",
    "FX105": "",
    "FY105": "",
    "FZ105": "",
    "GA105": "",
    "GB105": "",
    "GC105": "",
    "GD105": "",
    "GE105": "",
    "GF105": "",
    "GG105": "",
    "GH105": "",
    "GI105": "",
    "GJ105": "",
    "GK105": "",
    "GL105": "",
    "GM105": "",
    "GN105": "",
    "GO105": "",
    "H106": "1d 13h 58m",
    "J106": "259.69 B",
    "N106": "",
    "O106": "",
    "P106": "",
    "Q106": "",
    "R106": "",
    "FU106": "",
    "FV106": "",
    "FW106": "",
    "FX106": "",
    "FY106": "",
    "FZ106": "",
    "GA106": "",
    "GB106": "",
    "GC106": "",
    "GD106": 1,
    "GE106": "",
    "GF106": "",
    "GG106": "",
    "GH106": "",
    "GI106": "",
    "GJ106": "",
    "GK106": "",
    "GL106": "",
    "GM106": "",
    "GN106": "",
    "GO106": "",
    "H107": "1d  2h 32m",
    "J107": "262.17 B",
    "N107": "",
    "O107": "",
    "P107": "",
    "Q107": "",
    "R107": "",
    "FU107": 1,
    "FV107": "",
    "FW107": "",
    "FX107": "",
    "FY107": "",
    "FZ107": "",
    "GA107": "",
    "GB107": "",
    "GC107": "",
    "GD107": "",
    "GE107": "",
    "GF107": "",
    "GG107": "",
    "GH107": "",
    "GI107": "",
    "GJ107": "",
    "GK107": "",
    "GL107": "",
    "GM107": "",
    "GN107": "",
    "GO107": "",
    "H108": "1d 13h 58m",
    "J108": "265.71 B",
    "N108": "",
    "O108": "",
    "P108": "",
    "Q108": "",
    "R108": "",
    "FU108": "",
    "FV108": "",
    "FW108": "",
    "FX108": "",
    "FY108": "",
    "FZ108": "",
    "GA108": 1,
    "GB108": "",
    "GC108": "",
    "GD108": "",
    "GE108": "",
    "GF108": "",
    "GG108": "",
    "GH108": "",
    "GI108": "",
    "GJ108": "",
    "GK108": "",
    "GL108": "",
    "GM108": "",
    "GN108": "",
    "GO108": "",
    "H109": "1d 16h 49m",
    "J109": "269.4 B",
    "N109": "",
    "O109": "",
    "P109": "",
    "Q109": "",
    "R109": "",
    "FU109": "",
    "FV109": 1,
    "FW109": "",
    "FX109": "",
    "FY109": "",
    "FZ109": "",
    "GA109": "",
    "GB109": "",
    "GC109": "",
    "GD109": "",
    "GE109": "",
    "GF109": "",
    "GG109": "",
    "GH109": "",
    "GI109": "",
    "GJ109": "",
    "GK109": "",
    "GL109": "",
    "GM109": "",
    "GN109": "",
    "GO109": "",
    "H110": "2d  2h 33m",
    "J110": "273.97 B",
    "N110": "",
    "O110": "",
    "P110": "",
    "Q110": "",
    "R110": "",
    "FU110": "",
    "FV110": "",
    "FW110": "",
    "FX110": "",
    "FY110": "",
    "FZ110": "",
    "GA110": "",
    "GB110": "",
    "GC110": "",
    "GD110": "",
    "GE110": "",
    "GF110": "",
    "GG110": "",
    "GH110": "",
    "GI110": "",
    "GJ110": "",
    "GK110": "",
    "GL110": "",
    "GM110": "",
    "GN110": "",
    "GO110": "",
    "H111": "1d 17h 56m",
    "J111": "277.67 B",
    "N111": "",
    "O111": "",
    "P111": "",
    "Q111": "",
    "R111": "",
    "FU111": 1,
    "FV111": "",
    "FW111": "",
    "FX111": "",
    "FY111": "",
    "FZ111": "",
    "GA111": "",
    "GB111": "",
    "GC111": "",
    "GD111": "",
    "GE111": "",
    "GF111": "",
    "GG111": "",
    "GH111": "",
    "GI111": "",
    "GJ111": "",
    "GK111": "",
    "GL111": "",
    "GM111": "",
    "GN111": "",
    "GO111": "",
    "H112": "1d 17h 56m",
    "J112": "281.37 B",
    "N112": "",
    "O112": "",
    "P112": "",
    "Q112": "",
    "R112": "",
    "FU112": "",
    "FV112": "",
    "FW112": "",
    "FX112": 1,
    "FY112": "",
    "FZ112": "",
    "GA112": "",
    "GB112": "",
    "GC112": "",
    "GD112": "",
    "GE112": "",
    "GF112": "",
    "GG112": "",
    "GH112": "",
    "GI112": "",
    "GJ112": "",
    "GK112": "",
    "GL112": "",
    "GM112": "",
    "GN112": "",
    "GO112": "",
    "H113": "0d 21h 31m",
    "J113": "283.29 B",
    "N113": "",
    "O113": "",
    "P113": "",
    "Q113": "",
    "R113": "",
    "FU113": "",
    "FV113": "",
    "FW113": "",
    "FX113": "",
    "FY113": "",
    "FZ113": 1,
    "GA113": "",
    "GB113": "",
    "GC113": "",
    "GD113": "",
    "GE113": "",
    "GF113": "",
    "GG113": "",
    "GH113": "",
    "GI113": "",
    "GJ113": "",
    "GK113": "",
    "GL113": "",
    "GM113": "",
    "GN113": "",
    "GO113": "",
    "H114": "1d  3h 46m",
    "J114": "285.75 B",
    "N114": "",
    "O114": "",
    "P114": "",
    "Q114": "",
    "R114": "",
    "FU114": "",
    "FV114": 1,
    "FW114": "",
    "FX114": "",
    "FY114": "",
    "FZ114": "",
    "GA114": "",
    "GB114": "",
    "GC114": "",
    "GD114": "",
    "GE114": "",
    "GF114": "",
    "GG114": "",
    "GH114": "",
    "GI114": "",
    "GJ114": "",
    "GK114": "",
    "GL114": "",
    "GM114": "",
    "GN114": "",
    "GO114": "",
    "H115": "2d  7h 13m",
    "J115": "290.53 B",
    "FU115": "",
    "FV115": "",
    "FW115": "",
    "FX115": "",
    "FY115": "",
    "FZ115": "",
    "GA115": "",
    "GB115": "",
    "GC115": "",
    "GD115": "",
    "GE115": "",
    "GF115": "",
    "GG115": "",
    "GH115": "",
    "GI115": "",
    "GJ115": "",
    "GK115": "",
    "GL115": "",
    "GM115": "",
    "GN115": "",
    "GO115": "",
    "H116": "1d 22h  7m",
    "J116": "294.4 B",
    "FU116": 1,
    "FV116": "",
    "FW116": "",
    "FX116": "",
    "FY116": "",
    "FZ116": "",
    "GA116": "",
    "GB116": "",
    "GC116": "",
    "GD116": "",
    "GE116": "",
    "GF116": "",
    "GG116": "",
    "GH116": "",
    "GI116": "",
    "GJ116": "",
    "GK116": "",
    "GL116": "",
    "GM116": "",
    "GN116": "",
    "GO116": "",
    "H117": "1d 22h  7m",
    "J117": "298.26 B",
    "FU117": "",
    "FV117": "",
    "FW117": "",
    "FX117": 1,
    "FY117": "",
    "FZ117": "",
    "GA117": "",
    "GB117": "",
    "GC117": "",
    "GD117": "",
    "GE117": "",
    "GF117": "",
    "GG117": "",
    "GH117": "",
    "GI117": "",
    "GJ117": "",
    "GK117": "",
    "GL117": "",
    "GM117": "",
    "GN117": "",
    "GO117": "",
    "H118": "1d  0h 22m",
    "J118": "300.28 B",
    "FU118": "",
    "FV118": 1,
    "FW118": "",
    "FX118": "",
    "FY118": "",
    "FZ118": "",
    "GA118": "",
    "GB118": "",
    "GC118": "",
    "GD118": "",
    "GE118": "",
    "GF118": "",
    "GG118": "",
    "GH118": "",
    "GI118": "",
    "GJ118": "",
    "GK118": "",
    "GL118": "",
    "GM118": "",
    "GN118": "",
    "GO118": "",
    "H119": "2d 12h  8m",
    "J119": "305.22 B",
    "FU119": "",
    "FV119": "",
    "FW119": "",
    "FX119": "",
    "FY119": "",
    "FZ119": "",
    "GA119": "",
    "GB119": "",
    "GC119": "",
    "GD119": 1,
    "GE119": "",
    "GF119": "",
    "GG119": "",
    "GH119": "",
    "GI119": "",
    "GJ119": "",
    "GK119": "",
    "GL119": "",
    "GM119": "",
    "GN119": "",
    "GO119": "",
    "H120": "1d 11h 17m",
    "J120": "308.1 B",
    "FU120": "",
    "FV120": "",
    "FW120": "",
    "FX120": "",
    "FY120": "",
    "FZ120": "",
    "GA120": 1,
    "GB120": "",
    "GC120": "",
    "GD120": "",
    "GE120": "",
    "GF120": "",
    "GG120": "",
    "GH120": "",
    "GI120": "",
    "GJ120": "",
    "GK120": "",
    "GL120": "",
    "GM120": "",
    "GN120": "",
    "GO120": "",
    "H121": "2d  4h  6m",
    "J121": "312.32 B",
    "FU121": "",
    "FV121": "",
    "FW121": "",
    "FX121": "",
    "FY121": "",
    "FZ121": "",
    "GA121": "",
    "GB121": "",
    "GC121": "",
    "GD121": "",
    "GE121": "",
    "GF121": "",
    "GG121": "",
    "GH121": "",
    "GI121": "",
    "GJ121": "",
    "GK121": "",
    "GL121": "",
    "GM121": "",
    "GN121": "",
    "GO121": "",
    "H122": "2d  2h 33m",
    "J122": "316.43 B",
    "FU122": 1,
    "FV122": "",
    "FW122": "",
    "FX122": "",
    "FY122": "",
    "FZ122": "",
    "GA122": "",
    "GB122": "",
    "GC122": "",
    "GD122": "",
    "GE122": "",
    "GF122": "",
    "GG122": "",
    "GH122": "",
    "GI122": "",
    "GJ122": "",
    "GK122": "",
    "GL122": "",
    "GM122": "",
    "GN122": "",
    "GO122": "",
    "H123": "2d  2h 33m",
    "J123": "320.52 B",
    "FU123": "",
    "FV123": "",
    "FW123": "",
    "FX123": "",
    "FY123": "",
    "FZ123": "",
    "GA123": "",
    "GB123": "",
    "GC123": "",
    "GD123": "",
    "GE123": 1,
    "GF123": "",
    "GG123": "",
    "GH123": "",
    "GI123": "",
    "GJ123": "",
    "GK123": "",
    "GL123": "",
    "GM123": "",
    "GN123": "",
    "GO123": "",
    "H124": "1d 14h 54m",
    "J124": "323.69 B",
    "FU124": "",
    "FV124": 1,
    "FW124": "",
    "FX124": "",
    "FY124": "",
    "FZ124": "",
    "GA124": "",
    "GB124": "",
    "GC124": "",
    "GD124": "",
    "GE124": "",
    "GF124": "",
    "GG124": "",
    "GH124": "",
    "GI124": "",
    "GJ124": "",
    "GK124": "",
    "GL124": "",
    "GM124": "",
    "GN124": "",
    "GO124": "",
    "H125": "2d 17h 18m",
    "J125": "328.93 B",
    "FU125": "",
    "FV125": "",
    "FW125": "",
    "FX125": 1,
    "FY125": "",
    "FZ125": "",
    "GA125": "",
    "GB125": "",
    "GC125": "",
    "GD125": "",
    "GE125": "",
    "GF125": "",
    "GG125": "",
    "GH125": "",
    "GI125": "",
    "GJ125": "",
    "GK125": "",
    "GL125": "",
    "GM125": "",
    "GN125": "",
    "GO125": "",
    "H126": "1d  3h 27m",
    "J126": "331.14 B",
    "FU126": "",
    "FV126": "",
    "FW126": "",
    "FX126": "",
    "FY126": "",
    "FZ126": "",
    "GA126": "",
    "GB126": "",
    "GC126": "",
    "GD126": "",
    "GE126": "",
    "GF126": "",
    "GG126": "",
    "GH126": "",
    "GI126": "",
    "GJ126": "",
    "GK126": "",
    "GL126": "",
    "GM126": "",
    "GN126": "",
    "GO126": "",
    "H127": "2d  7h 13m",
    "J127": "335.44 B",
    "FU127": 1,
    "FV127": "",
    "FW127": "",
    "FX127": "",
    "FY127": "",
    "FZ127": "",
    "GA127": "",
    "GB127": "",
    "GC127": "",
    "GD127": "",
    "GE127": "",
    "GF127": "",
    "GG127": "",
    "GH127": "",
    "GI127": "",
    "GJ127": "",
    "GK127": "",
    "GL127": "",
    "GM127": "",
    "GN127": "",
    "GO127": "",
    "H128": "2d  7h 13m",
    "J128": "339.72 B",
    "FU128": "",
    "FV128": 1,
    "FW128": "",
    "FX128": "",
    "FY128": "",
    "FZ128": "",
    "GA128": "",
    "GB128": "",
    "GC128": "",
    "GD128": "",
    "GE128": "",
    "GF128": "",
    "GG128": "",
    "GH128": "",
    "GI128": "",
    "GJ128": "",
    "GK128": "",
    "GL128": "",
    "GM128": "",
    "GN128": "",
    "GO128": "",
    "H129": "2d 22h 43m",
    "J129": "345.13 B",
    "FU129": "",
    "FV129": "",
    "FW129": "",
    "FX129": 1,
    "FY129": "",
    "FZ129": "",
    "GA129": "",
    "GB129": "",
    "GC129": "",
    "GD129": "",
    "GE129": "",
    "GF129": "",
    "GG129": "",
    "GH129": "",
    "GI129": "",
    "GJ129": "",
    "GK129": "",
    "GL129": "",
    "GM129": "",
    "GN129": "",
    "GO129": "",
    "H130": "1d  6h 44m",
    "J130": "347.44 B",
    "FU130": "",
    "FV130": "",
    "FW130": "",
    "FX130": "",
    "FY130": "",
    "FZ130": "",
    "GA130": "",
    "GB130": "",
    "GC130": "",
    "GD130": "",
    "GE130": "",
    "GF130": "",
    "GG130": "",
    "GH130": "",
    "GI130": "",
    "GJ130": "",
    "GK130": "",
    "GL130": "",
    "GM130": "",
    "GN130": "",
    "GO130": "",
    "H131": "2d 12h  8m",
    "J131": "351.89 B",
    "FU131": 1,
    "FV131": "",
    "FW131": "",
    "FX131": "",
    "FY131": "",
    "FZ131": "",
    "GA131": "",
    "GB131": "",
    "GC131": "",
    "GD131": "",
    "GE131": "",
    "GF131": "",
    "GG131": "",
    "GH131": "",
    "GI131": "",
    "GJ131": "",
    "GK131": "",
    "GL131": "",
    "GM131": "",
    "GN131": "",
    "GO131": "",
    "H132": "2d 12h  8m",
    "J132": "356.31 B",
    "FU132": "",
    "FV132": "",
    "FW132": "",
    "FX132": "",
    "FY132": "",
    "FZ132": "",
    "GA132": 1,
    "GB132": "",
    "GC132": "",
    "GD132": "",
    "GE132": "",
    "GF132": "",
    "GG132": "",
    "GH132": "",
    "GI132": "",
    "GJ132": "",
    "GK132": "",
    "GL132": "",
    "GM132": "",
    "GN132": "",
    "GO132": "",
    "H133": "2d 17h 17m",
    "J133": "361.14 B",
    "FU133": "",
    "FV133": "",
    "FW133": "",
    "FX133": "",
    "FY133": "",
    "FZ133": 1,
    "GA133": "",
    "GB133": "",
    "GC133": "",
    "GD133": "",
    "GE133": "",
    "GF133": "",
    "GG133": "",
    "GH133": "",
    "GI133": "",
    "GJ133": "",
    "GK133": "",
    "GL133": "",
    "GM133": "",
    "GN133": "",
    "GO133": "",
    "H134": "1d 17h 41m",
    "J134": "364.26 B",
    "FU134": "",
    "FV134": 1,
    "FW134": "",
    "FX134": "",
    "FY134": "",
    "FZ134": "",
    "GA134": "",
    "GB134": "",
    "GC134": "",
    "GD134": "",
    "GE134": "",
    "GF134": "",
    "GG134": "",
    "GH134": "",
    "GI134": "",
    "GJ134": "",
    "GK134": "",
    "GL134": "",
    "GM134": "",
    "GN134": "",
    "GO134": "",
    "H135": "3d  4h 23m",
    "J135": "369.97 B",
    "FU135": "",
    "FV135": "",
    "FW135": "",
    "FX135": "",
    "FY135": "",
    "FZ135": "",
    "GA135": "",
    "GB135": "",
    "GC135": "",
    "GD135": 1,
    "GE135": "",
    "GF135": "",
    "GG135": "",
    "GH135": "",
    "GI135": "",
    "GJ135": "",
    "GK135": "",
    "GL135": "",
    "GM135": "",
    "GN135": "",
    "GO135": "",
    "H136": "1d 22h 32m",
    "J136": "373.43 B",
    "FU136": "",
    "FV136": "",
    "FW136": "",
    "FX136": 1,
    "FY136": "",
    "FZ136": "",
    "GA136": "",
    "GB136": "",
    "GC136": "",
    "GD136": "",
    "GE136": "",
    "GF136": "",
    "GG136": "",
    "GH136": "",
    "GI136": "",
    "GJ136": "",
    "GK136": "",
    "GL136": "",
    "GM136": "",
    "GN136": "",
    "GO136": "",
    "H137": "1d 10h 14m",
    "J137": "375.91 B",
    "FU137": "",
    "FV137": "",
    "FW137": "",
    "FX137": "",
    "FY137": "",
    "FZ137": "",
    "GA137": "",
    "GB137": "",
    "GC137": "",
    "GD137": "",
    "GE137": "",
    "GF137": "",
    "GG137": "",
    "GH137": "",
    "GI137": "",
    "GJ137": "",
    "GK137": "",
    "GL137": "",
    "GM137": "",
    "GN137": "",
    "GO137": "",
    "H138": "2d 17h 18m",
    "J138": "380.67 B",
    "FU138": 1,
    "FV138": "",
    "FW138": "",
    "FX138": "",
    "FY138": "",
    "FZ138": "",
    "GA138": "",
    "GB138": "",
    "GC138": "",
    "GD138": "",
    "GE138": "",
    "GF138": "",
    "GG138": "",
    "GH138": "",
    "GI138": "",
    "GJ138": "",
    "GK138": "",
    "GL138": "",
    "GM138": "",
    "GN138": "",
    "GO138": "",
    "H139": "2d 17h 18m",
    "J139": "385.39 B",
    "FU139": "",
    "FV139": 1,
    "FW139": "",
    "FX139": "",
    "FY139": "",
    "FZ139": "",
    "GA139": "",
    "GB139": "",
    "GC139": "",
    "GD139": "",
    "GE139": "",
    "GF139": "",
    "GG139": "",
    "GH139": "",
    "GI139": "",
    "GJ139": "",
    "GK139": "",
    "GL139": "",
    "GM139": "",
    "GN139": "",
    "GO139": "",
    "H140": "3d 10h 18m",
    "J140": "391.34 B",
    "FU140": "",
    "FV140": "",
    "FW140": "",
    "FX140": "",
    "FY140": "",
    "FZ140": "",
    "GA140": "",
    "GB140": "",
    "GC140": "",
    "GD140": "",
    "GE140": 1,
    "GF140": "",
    "GG140": "",
    "GH140": "",
    "GI140": "",
    "GJ140": "",
    "GK140": "",
    "GL140": "",
    "GM140": "",
    "GN140": "",
    "GO140": "",
    "H141": "2d  5h  0m",
    "J141": "395.18 B",
    "FU141": "",
    "FV141": "",
    "FW141": "",
    "FX141": "",
    "FY141": "",
    "FZ141": "",
    "GA141": "",
    "GB141": "",
    "GC141": "",
    "GD141": "",
    "GE141": "",
    "GF141": "",
    "GG141": "",
    "GH141": "",
    "GI141": "",
    "GJ141": "",
    "GK141": "",
    "GL141": "",
    "GM141": "",
    "GN141": "",
    "GO141": "",
    "H142": "2d 22h 43m",
    "J142": "400.12 B",
    "FU142": "",
    "FV142": "",
    "FW142": "",
    "FX142": 1,
    "FY142": "",
    "FZ142": "",
    "GA142": "",
    "GB142": "",
    "GC142": "",
    "GD142": "",
    "GE142": "",
    "GF142": "",
    "GG142": "",
    "GH142": "",
    "GI142": "",
    "GJ142": "",
    "GK142": "",
    "GL142": "",
    "GM142": "",
    "GN142": "",
    "GO142": "",
    "H143": "1d 13h 58m",
    "J143": "402.76 B",
    "FU143": 1,
    "FV143": "",
    "FW143": "",
    "FX143": "",
    "FY143": "",
    "FZ143": "",
    "GA143": "",
    "GB143": "",
    "GC143": "",
    "GD143": "",
    "GE143": "",
    "GF143": "",
    "GG143": "",
    "GH143": "",
    "GI143": "",
    "GJ143": "",
    "GK143": "",
    "GL143": "",
    "GM143": "",
    "GN143": "",
    "GO143": "",
    "H144": "2d 22h 43m",
    "J144": "407.68 B",
    "FU144": "",
    "FV144": 1,
    "FW144": "",
    "FX144": "",
    "FY144": "",
    "FZ144": "",
    "GA144": "",
    "GB144": "",
    "GC144": "",
    "GD144": "",
    "GE144": "",
    "GF144": "",
    "GG144": "",
    "GH144": "",
    "GI144": "",
    "GJ144": "",
    "GK144": "",
    "GL144": "",
    "GM144": "",
    "GN144": "",
    "GO144": "",
    "H145": "3d 16h 30m",
    "J145": "413.89 B",
    "FU145": "",
    "FV145": "",
    "FW145": "",
    "FX145": "",
    "FY145": "",
    "FZ145": "",
    "GA145": 1,
    "GB145": "",
    "GC145": "",
    "GD145": "",
    "GE145": "",
    "GF145": "",
    "GG145": "",
    "GH145": "",
    "GI145": "",
    "GJ145": "",
    "GK145": "",
    "GL145": "",
    "GM145": "",
    "GN145": "",
    "GO145": "",
    "H146": "3d  8h 58m",
    "J146": "419.43 B",
    "FU146": "",
    "FV146": "",
    "FW146": "",
    "FX146": "",
    "FY146": "",
    "FZ146": "",
    "GA146": "",
    "GB146": "",
    "GC146": "",
    "GD146": "",
    "GE146": "",
    "GF146": "",
    "GG146": "",
    "GH146": "",
    "GI146": "",
    "GJ146": "",
    "GK146": "",
    "GL146": "",
    "GM146": "",
    "GN146": "",
    "GO146": "",
    "H147": "3d  4h 23m",
    "J147": "424.6 B",
    "FU147": "",
    "FV147": 1,
    "FW147": "",
    "FX147": "",
    "FY147": "",
    "FZ147": "",
    "GA147": "",
    "GB147": "",
    "GC147": "",
    "GD147": "",
    "GE147": "",
    "GF147": "",
    "GG147": "",
    "GH147": "",
    "GI147": "",
    "GJ147": "",
    "GK147": "",
    "GL147": "",
    "GM147": "",
    "GN147": "",
    "GO147": "",
    "H148": "3d 22h 57m",
    "J148": "430.97 B",
    "FU148": 1,
    "FV148": "",
    "FW148": "",
    "FX148": "",
    "FY148": "",
    "FZ148": "",
    "GA148": "",
    "GB148": "",
    "GC148": "",
    "GD148": "",
    "GE148": "",
    "GF148": "",
    "GG148": "",
    "GH148": "",
    "GI148": "",
    "GJ148": "",
    "GK148": "",
    "GL148": "",
    "GM148": "",
    "GN148": "",
    "GO148": "",
    "H149": "3d  4h 23m",
    "J149": "436.17 B",
    "FU149": "",
    "FV149": "",
    "FW149": "",
    "FX149": 1,
    "FY149": "",
    "FZ149": "",
    "GA149": "",
    "GB149": "",
    "GC149": "",
    "GD149": "",
    "GE149": "",
    "GF149": "",
    "GG149": "",
    "GH149": "",
    "GI149": "",
    "GJ149": "",
    "GK149": "",
    "GL149": "",
    "GM149": "",
    "GN149": "",
    "GO149": "",
    "H150": "1d 17h 56m",
    "J150": "439.03 B",
    "FU150": "",
    "FV150": "",
    "FW150": "",
    "FX150": "",
    "FY150": "",
    "FZ150": 1,
    "GA150": "",
    "GB150": "",
    "GC150": "",
    "GD150": "",
    "GE150": "",
    "GF150": "",
    "GG150": "",
    "GH150": "",
    "GI150": "",
    "GJ150": "",
    "GK150": "",
    "GL150": "",
    "GM150": "",
    "GN150": "",
    "GO150": ""
  },
  "formula_count": 16315,
  "value_count": 4464
}